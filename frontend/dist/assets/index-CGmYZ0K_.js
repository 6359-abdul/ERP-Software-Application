const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DDgX67mz.js","assets/vendor-DJxZ0Ldf.js","assets/ui-BsEHV9Sx.js"])))=>i.map(i=>d[i]);
var IO=Object.defineProperty;var LO=(e,t,r)=>t in e?IO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ig=(e,t,r)=>LO(e,typeof t!="symbol"?t+"":t,r);import{r as Hp,a as DO,g as lo,b as YA,c as L0}from"./vendor-DJxZ0Ldf.js";import{r as y,a as P2,R as MO,b as gd}from"./ui-BsEHV9Sx.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Lg={exports:{}},cf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e5;function RO(){if(e5)return cf;e5=1;var e=Hp(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(o,c,u){var f,d={},p=null,h=null;u!==void 0&&(p=""+u),c.key!==void 0&&(p=""+c.key),c.ref!==void 0&&(h=c.ref);for(f in c)n.call(c,f)&&!i.hasOwnProperty(f)&&(d[f]=c[f]);if(o&&o.defaultProps)for(f in c=o.defaultProps,c)d[f]===void 0&&(d[f]=c[f]);return{$$typeof:t,type:o,key:p,ref:h,props:d,_owner:a.current}}return cf.Fragment=r,cf.jsx=s,cf.jsxs=s,cf}var t5;function BO(){return t5||(t5=1,Lg.exports=RO()),Lg.exports}var l=BO(),D0={},r5;function UO(){if(r5)return D0;r5=1;var e=DO();return D0.createRoot=e.createRoot,D0.hydrateRoot=e.hydrateRoot,D0}var zO=UO();const $O=lo(zO),WO=()=>{const e="https://school-erp-backend.onrender.com/api";return e.endsWith("/api")?e:`${e}/api`},KA=WO(),HO=({onLoginSuccess:e})=>{const[t,r]=y.useState(""),[n,a]=y.useState(""),[i,s]=y.useState(""),[o,c]=y.useState(!1),u=async f=>{var d,p;f.preventDefault(),s(""),c(!0);try{localStorage.removeItem("branch"),localStorage.removeItem("location"),localStorage.removeItem("academicYear"),localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("currentBranch"),localStorage.removeItem("currentLocation");const h=await YA.post(`${KA}/users/login`,{username:t,password:n});console.log("Login successful:",h.data),console.log("Login successful:",h.data);try{h.data.token?(localStorage.setItem("token",h.data.token),console.log("Token saved to localStorage")):console.warn("No token found in login response"),h.data.user&&(localStorage.setItem("user",JSON.stringify(h.data.user)),console.log("User saved to localStorage"))}catch(m){console.warn("Could not persist to localStorage",m)}e(h.data.user),c(!1)}catch(h){console.error(h);const m=((p=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:p.error)||(h==null?void 0:h.message)||"Invalid username or password";s(m),c(!1)}};return l.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 p-4",children:l.jsx("div",{className:"w-full max-w-sm mx-auto bg-white rounded-lg shadow-md",children:l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"text-center space-y-4 mb-8",children:[l.jsx("img",{src:"https://www.mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS Education Academy Logo",className:"mx-auto h-12 object-contain"}),l.jsx("p",{className:"text-gray-500",children:"Admin Login"})]}),l.jsxs("form",{className:"space-y-6",onSubmit:u,children:[l.jsxs("div",{className:"border border-gray-300 rounded-md",children:[l.jsxs("div",{className:"px-3 py-2 border-b border-gray-300",children:[l.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Username"}),l.jsx("input",{type:"text",required:!0,value:t,onChange:f=>r(f.target.value),className:"block w-full p-0 border-0 bg-transparent focus:ring-0 sm:text-sm"})]}),l.jsxs("div",{className:"px-3 py-2",children:[l.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Password"}),l.jsx("input",{type:"password",required:!0,value:n,onChange:f=>a(f.target.value),className:"block w-full p-0 border-0 bg-transparent focus:ring-0 sm:text-sm"})]})]}),i&&l.jsx("p",{className:"text-center text-sm text-red-600 pt-2",children:i}),l.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 px-4 text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-60",children:o?"Logging in...":"Login"})]})]})})})},qO=({className:e})=>l.jsx("svg",{className:e,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M4 6h16M4 12h16m-7 6h7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Nl=({className:e})=>l.jsx("svg",{className:e,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),vs=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z"})}),GO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})}),Th=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})}),XA=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),O2=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"})}),Y1=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM6.24 5h11.52l.83 1H5.42l.82-1zM5 19V8h14v11H5zm11-5.5-3.5 2-3.5-2V6h7v7.5z"})}),VO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"})}),YO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),JA=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})}),ZA=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 1a9 9 0 0 0-9 9v7c0 1.66 1.34 3 3 3h3v-8H5v-2c0-3.87 3.13-7 7-7s7 3.13 7 7v2h-4v8h3c1.66 0 3-1.34 3-3v-7a9 9 0 0 0-9-9z"})}),KO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M13.66 7.5h-3.23l-.67 2h3.22c.9 0 1.63.74 1.63 1.64 0 .91-.73 1.64-1.63 1.64h-1.88l-2.02 5.06H6.18L8.21 13h1.89c.47 0 .86-.39.86-.86s-.39-.86-.86-.86H8.21l.67-2H12c.47 0 .86-.39.86-.86s-.39-.86-.86-.86H9.55L10.22 5h4.11l-1.34 2.5H13.66zM20 4H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.11-.9-2-2-2z"})}),Ph=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"})}),kf=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"})}),n5=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),XO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"})}),QA=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),K1=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),ej=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),JO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})}),ZO=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}),Ee=YA.create({baseURL:KA,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});Ee.interceptors.request.use(e=>{var i;const t=localStorage.getItem("user"),r=localStorage.getItem("academicYear"),n=localStorage.getItem("currentBranch"),a=localStorage.getItem("token");if(a&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${a}`),t)try{const s=JSON.parse(t);n&&!n.toLowerCase().startsWith("all")?(e.headers=e.headers||{},e.headers["X-Branch"]=n):!n&&s.branch&&!s.branch.toLowerCase().startsWith("all")&&(e.headers=e.headers||{},e.headers["X-Branch"]=s.branch),s.location&&(e.headers=e.headers||{},e.headers["X-Location"]=s.location)}catch(s){console.error("Error parsing user data from localStorage:",s)}if(!((i=e.headers)!=null&&i["X-Academic-Year"])){const s=r||localStorage.getItem("academicYear");s&&(e.headers=e.headers||{},e.headers["X-Academic-Year"]=s)}return e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));Ee.interceptors.response.use(e=>e,async e=>{var r,n,a,i,s;const t=e.config;return((r=e.response)==null?void 0:r.status)===401&&!t._retry?(t._retry=!0,localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("currentBranch"),localStorage.removeItem("academicYear"),window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject({...e,message:"Session expired. Please login again."})):(((n=e.response)==null?void 0:n.status)===403&&console.error("Access forbidden:",e.response.data),((a=e.response)==null?void 0:a.status)===404&&console.error("Resource not found:",(i=e.config)==null?void 0:i.url),((s=e.response)==null?void 0:s.status)===500&&console.error("Server error:",e.response.data),e.response?Promise.reject(e):(console.error("Network error - backend might be down:",e.message),Promise.reject({...e,message:"Cannot connect to server. Please check your internet connection."})))});const QO=({toggleSidebar:e,navigateTo:t,onLogout:r,goBack:n,goForward:a,canGoBack:i,canGoForward:s})=>{var A;const o=JSON.parse(localStorage.getItem("user")||"{}"),[c,u]=y.useState(!1),[f,d]=y.useState(!1),[p,h]=y.useState(!1),[m,g]=y.useState(!1),[x,b]=y.useState(localStorage.getItem("currentLocation")||"All"),[S,_]=y.useState([]),[E,O]=y.useState([]),[F,M]=y.useState([]);y.useEffect(()=>{o.role==="Admin"&&Ee.get("/branches").then(I=>{I.data.branches&&_(I.data.branches)}).catch(I=>console.error("Header branch fetch error:",I))},[]);let C=((A=o==null?void 0:o.allowed_branches)==null?void 0:A.map(I=>I.branch_name))||[];if(o.role==="Admin"&&S.length>0)x==="All"?(C=S.map(I=>I.branch_name),C=["All",...C]):(C=S.filter(P=>{const L=(P.location_code||"").toUpperCase(),R=F.find(J=>J.code.toUpperCase()===L);return(R?R.name:"Hyderabad")===x}).map(P=>P.branch_name),C.length>1?C=["Select Branch",...C]:C.length===0&&(C=[]));else{C.length===0&&(o!=null&&o.branch&&(C=[o.branch]),(o==null?void 0:o.role)==="Admin"&&(C=["All",...C]));const I=C.length>1,P=C.includes("All")||(o==null?void 0:o.role)==="Admin";I&&!C.includes("All Branches")&&P&&(C=["All Branches",...C.filter(L=>L!=="All")])}const k=o&&(o.role==="Admin"||C.length>1),[W,D]=y.useState(localStorage.getItem("academicYear")||""),[j,H]=y.useState(()=>localStorage.getItem("currentBranch")||o.branch||"All"),U=I=>{localStorage.setItem("academicYear",I),D(I),u(!1),window.location.reload()},Y=I=>{localStorage.setItem("currentLocation",I),b(I),g(!1);let P="All";if(I!=="All"&&S.length>0){const L=S.filter(R=>{const G=(R.location_code||"").toUpperCase(),J=F.find(Q=>Q.code.toUpperCase()===G);return(J?J.name:"Hyderabad")===I});L.length>0&&(P=L[0].branch_name)}else P="All";localStorage.setItem("currentBranch",P),H(P),window.location.reload()},X=I=>{const P=I==="All Branches"?"All":I;localStorage.setItem("currentBranch",P),H(P),h(!1),window.location.reload()},[Z,K]=y.useState([]);y.useEffect(()=>{Ee.get("/org/academic-years").then(I=>{const P=I.data.academic_years||[];if(K(P.map(R=>R.name)),!localStorage.getItem("academicYear")&&P.length>0){const R=P[0].name;localStorage.setItem("academicYear",R),D(R)}}).catch(I=>console.error("Failed to load academic years in Header",I))},[]);const z=Z.length>0?Z:[],[se,xe]=y.useState(["All"]);return y.useEffect(()=>{o.role==="Admin"&&Ee.get("/org/locations").then(I=>{const P=I.data.locations||[];M(P);const L=P.map(R=>R.name);xe(["All",...L])}).catch(I=>console.error("Failed to load locations in Header",I))},[o.role]),l.jsx("header",{className:"bg-green-700 text-white shadow-md z-20",children:l.jsx("nav",{className:"container-fluid mx-auto px-4",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:e,className:"text-white hover:bg-green-600 p-2 rounded-md focus:outline-none md:hidden mr-2",children:l.jsx(qO,{className:"w-6 h-6"})}),l.jsx("a",{href:"#",onClick:()=>t("dashboard"),className:"flex items-center space-x-3",children:l.jsx("img",{src:"https://www.mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS Education Academy Logo",className:"h-12"})}),l.jsx("div",{className:"hidden md:flex items-center ml-4"})]}),l.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4",children:[o.role==="Admin"&&l.jsxs("div",{className:"relative mr-2",children:[l.jsxs("button",{onClick:()=>g(!m),onBlur:()=>setTimeout(()=>g(!1),200),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{className:"font-semibold",children:x==="All"?"All Locations":x}),l.jsx(Nl,{className:"w-4 h-4"})]}),m&&l.jsx("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:se.map(I=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),Y(I)},className:`block px-4 py-2 text-sm hover:bg-gray-100 ${x===I?"font-bold text-green-700 bg-green-100":""}`,children:I==="All"?"All Locations":I})},I))})]}),k?l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>h(!p),onBlur:()=>setTimeout(()=>h(!1),200),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{className:"font-semibold",children:j==="All"?"All Branches":j}),l.jsx(Nl,{className:"w-4 h-4"})]}),p&&l.jsx("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700 max-h-60 overflow-auto",children:C.map(I=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),X(I==="All Branches"?"All":I)},className:`block px-4 py-2 text-sm hover:bg-gray-100 ${j===(I==="All Branches"?"All":I)?"font-bold text-green-700":""}`,children:I})},I))})]}):l.jsx("div",{className:"flex items-center space-x-1 p-2 rounded-md",children:l.jsx("span",{className:"font-semibold",children:j==="All"?"All Branches":j})}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>u(!c),onBlur:()=>setTimeout(()=>u(!1),150),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{children:W}),l.jsx(Nl,{className:"w-4 h-4"})]}),c&&l.jsx("ul",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:z.map(I=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:P=>{P.preventDefault(),U(I)},className:"block px-4 py-2 text-sm hover:bg-gray-100",children:I})},I))})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>d(!f),onBlur:()=>setTimeout(()=>d(!1),150),className:"flex items-center space-x-2 focus:outline-none hover:bg-green-600 p-1 rounded-md",children:[l.jsx("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpve8QCCPBiCCxagjx5ei3qUSB_7UyDEepfg&s",alt:"Profile",className:"w-8 h-8 rounded-full object-cover"}),l.jsx("span",{className:"hidden md:inline",children:JSON.parse(localStorage.getItem("user")||"{}").username||"User"}),l.jsx(Nl,{className:"w-4 h-4"})]}),f&&l.jsxs("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:[l.jsx("li",{children:l.jsxs("a",{href:"#",onClick:I=>{I.preventDefault(),t("profile"),d(!1)},className:"flex items-center px-4 py-2 text-sm hover:bg-gray-100",children:[l.jsx(vs,{className:"w-4 h-4 mr-2"})," Profile"]})}),l.jsx("li",{children:l.jsxs("button",{onClick:r,className:"w-full text-left flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none",children:[l.jsx(GO,{className:"w-4 h-4 mr-2"})," Logout"]})})]})]})]})]})})})},eF=[{title:"Dashboard",icon:l.jsx(O2,{className:"w-5 h-5"}),page:"dashboard"},{title:"Academic",icon:l.jsx(Y1,{className:"w-5 h-5"}),page:"academic"},{title:"Financial",icon:l.jsx(VO,{className:"w-5 h-5"}),page:"fee"},{title:"Administration",icon:l.jsx(YO,{className:"w-5 h-5"}),page:"administration"},{title:"Setup Your School",icon:l.jsx(JA,{className:"w-5 h-5"}),page:"setup"}],tF=({isOpen:e,toggleSidebar:t,navigateTo:r,currentPage:n})=>l.jsxs("aside",{className:`flex-shrink-0 bg-white border-r border-gray-200 flex flex-col transition-all duration-300 ${e?"w-64":"w-0 overflow-hidden md:w-20"} md:relative absolute h-full z-10 md:z-auto`,children:[l.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[l.jsx("span",{className:`font-semibold text-violet-700 ${!e&&"md:hidden"}`,children:"Menu"}),l.jsx("button",{onClick:t,className:"p-2 rounded-md hover:bg-gray-100 focus:outline-none",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-600",children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.875 12.0003C1.875 11.7019 1.99353 11.4157 2.2045 11.2048C2.41548 10.9938 2.70163 10.8753 3 10.8753H18.285L14.205 6.79526C14.0063 6.582 13.8981 6.29993 13.9032 6.00847C13.9084 5.71702 14.0264 5.43894 14.2326 5.23283C14.4387 5.02671 14.7168 4.90864 15.0082 4.9035C15.2997 4.89835 15.5817 5.00654 15.795 5.20526L21.795 11.2053C22.0057 11.4162 22.124 11.7021 22.124 12.0003C22.124 12.2984 22.0057 12.5843 21.795 12.7953L15.795 18.7953C15.692 18.9058 15.5678 18.9944 15.4298 19.0559C15.2918 19.1174 15.1428 19.1505 14.9918 19.1531C14.8407 19.1558 14.6907 19.128 14.5506 19.0714C14.4105 19.0149 14.2833 18.9306 14.1764 18.8238C14.0696 18.717 13.9854 18.5897 13.9288 18.4497C13.8722 18.3096 13.8444 18.1595 13.8471 18.0085C13.8498 17.8574 13.8828 17.7084 13.9443 17.5705C14.0058 17.4325 14.0945 17.3083 14.205 17.2053L18.285 13.1253H3C2.70163 13.1253 2.41548 13.0067 2.2045 12.7958C1.99353 12.5848 1.875 12.2986 1.875 12.0003Z",fill:"#464646"})})})]}),l.jsx("div",{className:"p-4",children:l.jsxs("p",{className:"text-sm text-gray-500",children:["School Code: ",l.jsx("span",{className:"font-semibold text-gray-800",children:"msacademy"})]})}),l.jsxs("nav",{className:"flex-1 px-2 space-y-1 overflow-y-auto",children:[eF.map(a=>l.jsxs("a",{href:"#",onClick:i=>{i.preventDefault(),r(a.page)},className:`flex items-center p-2 text-sm font-medium rounded-md group ${a.page===n?"bg-green-100 text-green-800":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[a.icon,l.jsx("span",{className:`ml-3 whitespace-nowrap ${!e&&"md:hidden"}`,children:a.title})]},a.title)),l.jsxs("div",{className:`pt-4 mt-4 border-t border-gray-200 ${!e&&"md:hidden"}`,children:[l.jsxs("a",{href:"#",className:"flex items-center p-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[l.jsx(ZA,{className:"w-5 h-5"}),l.jsx("span",{className:"ml-3",children:"Staff Support"})]}),l.jsxs("a",{href:"#",onClick:a=>{a.preventDefault(),r("profile")},className:"flex items-center p-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[l.jsx(vs,{className:"w-5 h-5"}),l.jsx("span",{className:"ml-3",children:"My Details"})]})]})]})]}),tj=y.createContext(void 0),rF=()=>[],nF=({children:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,s]=y.useState(null);y.useEffect(()=>{if(!localStorage.getItem("token")){a(!1);return}a(!0),Ee.get("/students").then(f=>{r(f.data.students||[]),s(null)}).catch(()=>s("Failed to load student data")).finally(()=>a(!1))},[]);const o=async u=>{r(f=>{const d=f.length?Math.max(...f.map(p=>p.sr))+1:1;return[{...u,sr:d,feeInstallments:u.feeInstallments||rF()},...f]})},c=async(u,f)=>{r(d=>d.map(p=>p.admNo===u?{...p,...f}:p))};return l.jsx(tj.Provider,{value:{students:t,loading:n,error:i,addStudent:o,updateStudent:c},children:e})},aF=()=>{const e=y.useContext(tj);if(!e)throw new Error("useSchool must be used inside SchoolProvider");return e},a5=({title:e,value:t,icon:r,color:n})=>l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center space-x-4 border-l-4",style:{borderColor:n},children:[l.jsx("div",{className:"p-3 rounded-full",style:{backgroundColor:`${n}1A`,color:n},children:r}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:e}),l.jsx("p",{className:"text-xl font-semibold text-gray-800",children:t})]})]}),iF=()=>{const{students:e}=aF(),t=(localStorage.getItem("currentBranch")||"All").trim(),r=t.toLowerCase(),n=!r||r.startsWith("all"),i=JSON.parse(localStorage.getItem("user")||"{}").allowed_branches||[];let s=t;if(Array.isArray(i)){const d=i.find(p=>String(p.branch_id)===t);d&&(s=d.branch_name)}const o=n?e:e.filter(d=>{const p=(d.branch||"").toLowerCase().trim();return p===r||p===s.toLowerCase().trim()}),c=o.length,u=o.reduce((d,p)=>{const h=(p.feeInstallments||[]).filter(m=>!m.paid).reduce((m,g)=>m+(g.payable||0),0);return d+h},0),f=d=>`₹${d.toLocaleString("en-IN")}`;return l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[l.jsx(a5,{title:"Total Students",value:c,icon:l.jsx(vs,{className:"w-6 h-6"}),color:"#4f46e5"}),l.jsx(a5,{title:"Total Fee Dues",value:f(u),icon:l.jsx(KO,{className:"w-6 h-6"}),color:"#db2777"})]})},sF=({navigateTo:e})=>{var u;const t=[{name:"Fee",icon:"https://cdn-icons-png.flaticon.com/512/1001/1001096.png",page:"fee"},{name:"Admission",icon:"https://cdn-icons-png.flaticon.com/512/3063/3063820.png",page:"dashboard"},{name:"Account",icon:"https://cdn-icons-png.flaticon.com/512/272/272997.png",page:"dashboard"},{name:"Student",icon:"https://cdn-icons-png.flaticon.com/512/921/921347.png",page:"dashboard"},{name:"Staff",icon:"https://cdn-icons-png.flaticon.com/512/2940/2940626.png",page:"dashboard"}],r=localStorage.getItem("user"),n=r?JSON.parse(r):null;let a=[];n!=null&&n.allowed_branches&&Array.isArray(n.allowed_branches)&&(a=n.allowed_branches.map(f=>({id:String(f.branch_id),name:f.branch_name}))),a.length===0&&(n!=null&&n.branch)&&(a=[{id:n.branch,name:n.branch}]);const i=(n==null?void 0:n.role)==="Admin",s=a.some(f=>f.id==="All"||f.name==="All");i&&!s&&(a=[{id:"All",name:"All Branches"},...a]),a.length>1;const[o,c]=y.useState(()=>{const f=localStorage.getItem("currentBranch");return f||(i?"All":a.length>0?a[0].id:"All")});return(u=a.find(f=>f.id===o))!=null&&u.name,l.jsx("div",{className:"bg-white shadow-sm",children:l.jsx("div",{className:"container-fluid mx-auto px-4",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap",children:[l.jsx("div",{className:"py-4 flex items-center",children:l.jsxs("h2",{className:"text-xl text-gray-800 mr-4",children:["Welcome, ",l.jsx("span",{className:"font-semibold",children:(n==null?void 0:n.username)||"User"})]})}),l.jsx("div",{className:"flex items-center space-x-1 sm:space-x-4 overflow-x-auto py-2",children:t.map((f,d)=>l.jsxs("a",{href:"#",onClick:p=>{p.preventDefault(),e(f.page)},className:"flex-shrink-0 text-center p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 w-24",children:[l.jsx("img",{src:f.icon,alt:f.name,className:"h-8 w-8 mx-auto object-contain"}),l.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:f.name})]},d))})]})})})},oF=()=>l.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[l.jsx(iF,{}),l.jsx("div",{className:"relative max-w-sm mx-auto",children:l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"})})]}),lF=({navigateTo:e})=>l.jsxs(l.Fragment,{children:[l.jsx(sF,{navigateTo:e}),l.jsx(oF,{})]}),cF=()=>{const[e,t]=y.useState("AUDIT-MN"),[r,n]=y.useState(""),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState(""),[f,d]=y.useState(""),[p,h]=y.useState(""),[m,g]=y.useState(""),[x,b]=y.useState(""),[S,_]=y.useState("User"),[E,O]=y.useState(""),[F,M]=y.useState([]),[C,k]=y.useState([]),[W,D]=y.useState([]),[j,H]=y.useState({type:"",msg:""}),[U,Y]=y.useState(!1);y.useEffect(()=>{const K=JSON.parse(localStorage.getItem("user")||"{}"),z=localStorage.getItem("currentBranch");(async()=>{try{const[xe,A]=await Promise.all([Ee.get("/branches"),Ee.get("/org/locations")]);M(xe.data.branches||[]),D(A.data.locations||[])}catch(xe){console.error("Failed to fetch branches/locations",xe)}})(),K.role==="Admin"?z&&z!=="All"?k([z]):Y(!1):K.branch&&(k([K.branch]),Y(!0))},[]),y.useEffect(()=>{if(C.includes("All")){O("All");return}if(C.length===1&&W.length>0){const K=F.find(z=>z.branch_code.toLowerCase()===C[0].toLowerCase()||z.branch_name.toLowerCase()===C[0].toLowerCase());if(K){const z=(K.location_code||"").toUpperCase(),se=W.find(xe=>xe.code.toUpperCase()===z);se&&O(se.name)}}else C.length===0?O(""):C.length>1&&O("Multiple")},[C,F,W]);const X=K=>{if(U)return;if(K==="All"){C.includes("All")?k([]):k(["All"]);return}let z=C.filter(se=>se!=="All");C.includes(K)?z=z.filter(se=>se!==K):z.push(K),k(z)},Z=async K=>{var se,xe;if(K.preventDefault(),H({type:"",msg:""}),!m||!x){H({type:"error",msg:"Username and Password are required."});return}const z={username:m,password:x,branches:C.length>0?C:S==="Admin"?["All"]:[],branch:C[0]||"North",location:E,role:S};console.log("Sending Add User Payload:",z);try{await Ee.post("/users/add",z),H({type:"success",msg:"User created successfully!"}),g(""),b(""),k([]),_("User")}catch(A){const I=((xe=(se=A.response)==null?void 0:se.data)==null?void 0:xe.error)||"Failed to create user.";H({type:"error",msg:I})}};return l.jsxs("div",{className:"container mx-auto p-4 md:p-6",children:[l.jsx("div",{className:"mb-6",children:l.jsx("h4",{className:"text-xl font-semibold text-gray-700",children:"CHANGE USERNAME/PASSWORD"})}),l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsx("form",{children:l.jsxs("div",{className:"space-y-4 border border-gray-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Change Username"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtuserName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",id:"txtuserName",name:"txtuserName",maxLength:100,value:e,onChange:K=>t(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})}),l.jsx("form",{children:l.jsxs("div",{className:"space-y-4 border border-green-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Change Password"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtNewPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"password",id:"txtNewPassword",name:"txtNewPassword",maxLength:99,value:r,onChange:K=>n(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtConfirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),l.jsx("input",{type:"password",id:"txtConfirmPassword",name:"txtConfirmPassword",maxLength:20,value:a,onChange:K=>i(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save Password"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})}),l.jsx("form",{className:"lg:col-span-2",children:l.jsxs("div",{className:"space-y-4 border border-gray-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Teacher Detail"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtteacherfirstname",className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"txtteacherfirstname",name:"txtteacherfirstname",maxLength:100,value:s,onChange:K=>o(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtteacherLastName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"txtteacherLastName",name:"txtteacherLastName",maxLength:100,value:c,onChange:K=>u(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtteacheremail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",id:"txtteacheremail",name:"txtteacheremail",maxLength:100,value:f,onChange:K=>d(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtTMobile",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile"}),l.jsx("input",{type:"tel",id:"txtTMobile",name:"txtTMobile",maxLength:100,value:p,onChange:K=>h(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})})]}),l.jsx("div",{className:"mt-8",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-blue-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Add User (Admin Only)"}),j.msg&&l.jsx("div",{className:`p-4 mb-4 rounded-md ${j.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:j.msg}),l.jsxs("form",{onSubmit:Z,children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"newUserName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"newUserName",value:m,onChange:K=>g(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter username"})]}),l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"newUserPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"password",id:"newUserPassword",value:x,onChange:K=>b(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allowed Branches"}),l.jsxs("div",{className:"border border-gray-300 rounded-md p-2 h-32 overflow-y-auto bg-white",children:[l.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[l.jsx("input",{type:"checkbox",checked:C.includes("All"),onChange:()=>X("All")}),l.jsx("span",{className:"text-sm",children:"All Branches"})]}),F.map(K=>l.jsxs("div",{className:"flex items-center space-x-2 p-1 border-t border-gray-100",children:[l.jsx("input",{type:"checkbox",checked:C.includes(K.branch_code),onChange:()=>X(K.branch_code),disabled:U||C.includes("All")}),l.jsx("span",{className:"text-sm",children:K.branch_name})]},K.branch_code))]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select multiple or All"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newUserLocation",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),l.jsx("input",{type:"text",id:"newUserLocation",value:E,onChange:K=>O(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newUserRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),l.jsxs("select",{id:"newUserRole",value:S,onChange:K=>_(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"User",children:"User"}),l.jsx("option",{value:"Admin",children:"Admin"})]})]})]}),l.jsx("div",{className:"mt-6",children:l.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create User"})})]})]})})]})]})},uF=({navigateTo:e})=>{const[t,r]=y.useState(null),n=u=>{r(t===u?null:u)},a=()=>{setTimeout(()=>r(null),150)},i=u=>{u==="Fee Type"?e("fee-type"):u==="Create Class Fee Structure"?e("class-fee-structure"):u==="Fee Installments"?e("fee-installments"):u==="Assign Special Fee Type"?e("assign-special-fee"):u==="Concession Template"?e("concession-master"):u==="Update Student Fee Structure"&&e("update-student-fee-structure"),r(null)},s="px-4 py-2 text-sm border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",o={feeMasters:["Fee Type","Fee Installments","Assign Special Fee Type","Create Class Fee Structure","Update Student Fee Structure"],concession:[{name:"Concession Template",action:()=>e("concession-master")},{name:"Set Student Concession",action:()=>e("student-concession")},{name:"Paid Concession Report",action:()=>console.log("Paid Concession Report")},{name:"Expected Concession Report",action:()=>console.log("Expected Concession Report")}],refund:["Refund/TC Requests","Refund Fee","Refundable Fees Refund Report","Refundable Fees Deposit Report","Refund Report","Refund Cancel Report","Adjust Fee","Adjust Fee Report","Nullify Fee","Nullify Fee Report"]},c=(u,f)=>l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>n(u),onBlur:a,className:`${s} flex items-center capitalize`,children:[u.replace(/([A-Z])/g," $1").trim()," ",l.jsx(Nl,{className:"w-4 h-4 ml-1"})]}),t===u&&l.jsx("ul",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700 border max-h-60 overflow-y-auto",children:f.map((d,p)=>{const h=typeof d=="string"?d:d.name,m=typeof d=="string"?()=>i(d):d.action;return l.jsx("li",{children:l.jsx("a",{href:"#",onClick:g=>{g.preventDefault(),m()},className:"block px-4 py-2 text-sm hover:bg-gray-100",children:h})},p)})})]});return l.jsxs("div",{children:[l.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:l.jsxs("div",{className:"container-fluid mx-auto flex justify-between items-center p-4",children:[l.jsxs("h2",{className:"text-2xl font-semibold text-slate-900 flex items-center",children:[l.jsx("span",{className:"text-blue-600 mr-2",children:"₹"})," Fee Management"]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c("feeMasters",o.feeMasters),l.jsx("button",{className:"px-4 py-2 text-sm border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",onClick:()=>e("fee-reports"),children:"Fee Reports"}),l.jsx("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors shadow-sm",onClick:()=>{console.log("Fee Payment button clicked, navigating to take-fee"),e("take-fee")},children:"Take Fee"}),c("concession",o.concession),c("refund",o.refund)]})]})}),l.jsx("div",{className:"container mx-auto p-6",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[l.jsx("div",{className:"text-slate-400 mb-4",children:l.jsx("svg",{className:"w-24 h-24 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("h3",{className:"text-2xl font-semibold text-slate-900 mb-2",children:"Fee Management Dashboard"}),l.jsx("p",{className:"text-slate-600 mb-6",children:'Click "Take Fee" button above to collect fees from students.'}),l.jsx("button",{onClick:()=>e("take-fee"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors shadow-sm font-medium",children:"Collect Due Fees"})]})})]})},fF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),[a,i]=y.useState({fee_type:"",category:"",fee_type_group:"",type:"Installment",display_name:"",is_refundable:!1,description:"",branch:"All",academic_year:localStorage.getItem("academicYear")||""}),[s,o]=y.useState(null),[c,u]=y.useState([]),[f,d]=y.useState(""),[p,h]=y.useState(new Set),[m,g]=y.useState(!1),[x,b]=y.useState(!1),S=y.useRef(null);y.useEffect(()=>{function Y(X){S.current&&!S.current.contains(X.target)&&g(!1)}return document.addEventListener("mousedown",Y),()=>{document.removeEventListener("mousedown",Y)}},[]),y.useEffect(()=>{const Y=JSON.parse(localStorage.getItem("user")||"{}");let X=localStorage.getItem("currentBranch")||"All";Y.role!=="Admin"&&Y.branch&&Y.branch!=="All"&&Y.branch!=="All Branches"&&(X=Y.branch),i(Z=>({...Z,branch:X})),_(),X&&X!=="All"&&X!=="All Branches"&&Ee.get("/branches").then(Z=>{const K=Z.data.branches||Z.data||[],z=K.map(xe=>({id:xe.id,name:xe.branch_name,location_name:xe.location_name||"Unknown Location"}));u(z);const se=K.find(xe=>xe.branch_name.toLowerCase()===X.toLowerCase());se&&d(se.id)}).catch(Z=>console.error("Error fetching branches:",Z))},[]);const _=async()=>{try{const X=(await Ee.get("/fee-types")).data,Z=Array.isArray(X)?X:X.fee_types||[],K=JSON.parse(localStorage.getItem("user")||"{}");let z=localStorage.getItem("currentBranch")||"All";K.role!=="Admin"&&K.branch&&K.branch!=="All"&&K.branch!=="All Branches"&&(z=K.branch);const se=z==="All"||z==="All Branches"?Z:Z.filter(xe=>!xe.branch||xe.branch==="All"||xe.branch===z);t(se)}catch(Y){console.error("Error fetching fee types:",Y)}},E=Y=>{const{name:X,value:Z,type:K}=Y.target;if(K==="checkbox"){const z=Y.target.checked;i(se=>({...se,[X]:z}))}else i(z=>({...z,[X]:Z}))},O=async Y=>{Y.preventDefault();try{const X=JSON.parse(localStorage.getItem("user")||"{}");let Z=localStorage.getItem("currentBranch")||"All";X.role!=="Admin"&&X.branch&&X.branch!=="All"&&X.branch!=="All Branches"&&(Z=X.branch);const K={...a,branch:a.branch||Z||"All"};s?await Ee.put(`/fee-types/${s}`,K):await Ee.post("/fee-types",K),C(),_()}catch(X){console.error("Error saving fee type:",X),alert("Error saving fee type. Please try again.")}},F=Y=>{i(Y),o(Y.id||null),n(!0)},M=async Y=>{if(window.confirm("Are you sure you want to delete this fee type?"))try{await Ee.delete(`/fee-types/${Y}`),_()}catch(X){console.error("Error deleting fee type:",X),alert("Error deleting fee type. Please try again.")}},C=()=>{i({fee_type:"",category:"",fee_type_group:"",type:"Installment",display_name:"",is_refundable:!1,description:"",branch:localStorage.getItem("currentBranch")||"All",academic_year:localStorage.getItem("academicYear")||""}),o(null),n(!1)},k=Y=>{const X=new Set(p);X.has(Y)?X.delete(Y):X.add(Y),h(X)},W=async()=>{var Y,X;if(p.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy Fee Types to ${p.size} branches?`)){b(!0);try{await Ee.post("/fees/copy-fee-types",{source_branch_id:f,target_branch_ids:Array.from(p),academic_year:localStorage.getItem("academicYear")||""}),alert("Fee Types copied successfully!"),h(new Set),g(!1)}catch(Z){console.error("Copy failed",Z),alert(((X=(Y=Z.response)==null?void 0:Y.data)==null?void 0:X.error)||"Failed to copy fee types.")}finally{b(!1)}}},D=c.filter(Y=>String(Y.id)!==String(f)&&Y.name!=="All Branches"&&Y.name!=="All"),j={};D.forEach(Y=>{j[Y.location_name]||(j[Y.location_name]=[]),j[Y.location_name].push(Y)});const H=localStorage.getItem("currentBranch"),U=H&&H!=="All"&&H!=="All Branches";return l.jsxs("div",{className:"container mx-auto p-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Fee Types"}),l.jsxs("div",{className:"flex gap-2",children:[U&&l.jsxs("div",{className:"relative",ref:S,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>g(!m),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),m&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(j).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(j).map(Y=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:Y}),l.jsx("div",{className:"py-1",children:j[Y].map(X=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:p.has(String(X.id)),onChange:()=>k(String(X.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:X.name})]},X.id))})]},Y)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[p.size," selected"]}),l.jsx("button",{onClick:W,disabled:x||p.size===0,className:`px-3 py-1 text-xs text-white rounded ${x||p.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:x?"Copying...":"Confirm Copy"})]})]})]}),l.jsxs("button",{onClick:()=>n(!r),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md flex items-center gap-2",children:[l.jsx("span",{children:"⊕"})," Add New Fee Type"]})]})]})}),r&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:s?"Edit Fee Type":"Add New Fee Type"}),l.jsxs("form",{onSubmit:O,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Fee Type ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"fee_type",value:a.fee_type,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"e.g., Transport Fee"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Category"}),l.jsxs("select",{name:"category",value:a.category,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Fee category"}),l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Tuition",children:"Tuition"}),l.jsx("option",{value:"Transport",children:"Transport"}),l.jsx("option",{value:"Hostel",children:"Hostel"}),l.jsx("option",{value:"Library",children:"Library"}),l.jsx("option",{value:"Sports",children:"Sports"}),l.jsx("option",{value:"Examination",children:"Examination"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsx("input",{type:"text",name:"branch",value:a.branch,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("input",{type:"text",name:"academic_year",value:a.academic_year,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type Group"}),l.jsxs("select",{name:"fee_type_group",value:a.fee_type_group,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Fee Type Group"}),l.jsx("option",{value:"Standard",children:"Standard"}),l.jsx("option",{value:"Special",children:"Special"}),l.jsx("option",{value:"Optional",children:"Optional"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),l.jsx("input",{type:"text",name:"display_name",value:a.display_name,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Display name for receipts"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),l.jsxs("select",{name:"type",value:a.type,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"Installment",children:"Installment"}),l.jsx("option",{value:"One-Time",children:"One-Time"})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_refundable",id:"is_refundable",checked:a.is_refundable,onChange:E,className:"w-4 h-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500"}),l.jsx("label",{htmlFor:"is_refundable",className:"ml-2 text-sm text-gray-700",children:"Is Fee Refundable?"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("textarea",{name:"description",value:a.description,onChange:E,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Optional description"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:C,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Reset"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-md",children:"✓ Save Fee Type"})]})]})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type Group"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Display Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Refundable"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:'No fee types found. Click "Add New Fee Type" to create one.'})}):e.map(Y=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Y.fee_type}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${!Y.branch||Y.branch==="All"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Y.branch||"All"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.category||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.fee_type_group||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:Y.type})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.display_name||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Y.is_refundable?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:Y.is_refundable?"Yes":"No"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>F(Y),className:"text-blue-600 hover:text-blue-900 px-3 py-1 bg-blue-50 rounded",children:"✎ Edit"}),l.jsx("button",{onClick:()=>Y.id&&M(Y.id),className:"text-red-600 hover:text-red-900 px-3 py-1 bg-red-50 rounded",children:"🗑 Delete"})]})})]},Y.id))})]})})})]})},dF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState(["Standard"]),[s,o]=y.useState(""),[c,u]=y.useState(localStorage.getItem("academicYear")||""),[f,d]=y.useState("Standard"),[p,h]=y.useState(""),[m,g]=y.useState("Hyderabad"),[x,b]=y.useState(!1),[S,_]=y.useState([]),[E,O]=y.useState([]),[F,M]=y.useState(!1),[C,k]=y.useState(!1),[W,D]=y.useState("All"),[j,H]=y.useState(!1),[U,Y]=y.useState([]),[X,Z]=y.useState(""),[K,z]=y.useState(new Set),[se,xe]=y.useState(!1),[A,I]=y.useState(!1),P=y.useRef(null);y.useEffect(()=>{function ve(ye){P.current&&!P.current.contains(ye.target)&&xe(!1)}return document.addEventListener("mousedown",ve),()=>{document.removeEventListener("mousedown",ve)}},[]),y.useEffect(()=>{const ve=JSON.parse(localStorage.getItem("user")||"{}");b(ve.role==="Admin"),ve.location&&g(ve.location);let ye=localStorage.getItem("currentBranch")||"All";ve.role!=="Admin"&&ve.branch&&ve.branch!=="All"&&ve.branch!=="All Branches"&&(ye=ve.branch),D(ye),H(ye==="All"||ye==="All Branches");const ze=localStorage.getItem("currentLocation");Ee.get("/branches").then($e=>{const Ue=$e.data.branches||$e.data||[],Xe=Ue.map(Qe=>({id:Qe.id,name:Qe.branch_name,location_name:Qe.location_name||"Unknown Location"}));if(Y(Xe),ye&&ye!=="All"&&ye!=="All Branches"){const Qe=Ue.find(bt=>bt.branch_name.toLowerCase()===ye.toLowerCase());if(Qe){Z(Qe.id);const bt={HYD:"Hyderabad",MUM:"Mumbai"},Dt=(Qe.location_code||"").toUpperCase();let kt=bt[Dt]||"Hyderabad";g(kt)}}else g(ze&&ze!=="All"?ze:"All")}).catch($e=>console.error("Error fetching branch info:",$e)),L(),G()},[]);const L=async()=>{try{const ve=await Ee.get("/fee-types");t(ve.data.fee_types||[])}catch(ve){console.error("Error fetching fee types:",ve)}};y.useEffect(()=>{s&&c&&R()},[s,c,m,W]);const R=async()=>{try{const ve=W,ye=ve==="All Branches"||ve==="All"?"All":ve,ze=(await Ee.get("/class-fee-structure",{params:{class:s,academic_year:c,branch:ye,location:m}})).data.fee_structures;if(ze&&ze.length>0){const $e=[],Ue=[];ze.forEach(Xe=>{const Qe={id:Xe.id,fee_type_id:Xe.fee_type_id,fee_type_name:Xe.fee_type_name,total_amount:Xe.total_amount,is_new_admission:Xe.is_new_admission,installments:Xe.installments};Xe.is_new_admission?$e.push(Qe):Ue.push(Qe),Xe.fee_group&&d(Xe.fee_group)}),_($e),O(Ue)}else _([]),O([])}catch(ve){console.error("Error fetching existing fee structures:",ve)}},G=async()=>{try{const ye=(await Ee.get("/classes")).data.classes.map(Ce=>Ce.class_name);n(ye)}catch(ve){console.error("Error fetching classes:",ve)}},J=async(ve,ye,Ce)=>{if(j){alert("Please select a specific branch to add fee structures.");return}const ze=e.find(Qe=>Qe.id===ve);if(!ze)return;if((Ce?S:E).some(Qe=>Qe.fee_type_id===ve)){alert(`Fee type "${ze.fee_type}" already exists in the list.`);return}let Ue=[];if(ze.type==="Installment")try{const Qe=localStorage.getItem("currentBranch")||"All",bt=Qe==="All Branches"||Qe==="All"?"All":Qe,kt=(await Ee.get("/installment-schedule",{params:{fee_type_id:ve,branch:bt}})).data.installments||[];if(kt.length>0){const wt=kt.length,it=Math.floor(ye/wt/10)*10,Ae=ye-it*wt;Ue=kt.map((tt,at)=>({month:tt.title,amount:at===0?it+Ae:it,month_order:tt.installment_no}))}else{alert("Installments not created for this fee type. Please configure installments first.");return}}catch(Qe){console.error("Error fetching installments:",Qe),alert("Error fetching installment schedule. Please try again.");return}const Xe={fee_type_id:ve,fee_type_name:ze.fee_type,total_amount:ye,is_new_admission:Ce,installments:Ue};Ce?_([...S,Xe]):O([...E,Xe])},q=async(ve,ye)=>{var $e,Ue;const ze=(ye?S:E)[ve];if(ze.id){if(!window.confirm("Are you sure you want to delete this fee structure? This will also remove it from all students in this class."))return;try{await Ee.delete(`/class-fee-structure/${ze.id}`),alert("Fee structure deleted successfully from database and student records!")}catch(Qe){console.error("Error deleting fee structure:",Qe),alert(`Error: ${((Ue=($e=Qe.response)==null?void 0:$e.data)==null?void 0:Ue.error)||"Failed to delete fee structure"}`);return}}ye?_(S.filter((Xe,Qe)=>Qe!==ve)):O(E.filter((Xe,Qe)=>Qe!==ve))},Q=(ve,ye)=>{const Ce=ye?[...S]:[...E],ze=Ce[ve];if(ze.installments.length===0)return;const $e=ze.total_amount,Ue=ze.installments.length,Xe=Math.floor($e/Ue/10)*10,Qe=$e-Xe*Ue,bt=ze.installments.map((Dt,kt)=>({...Dt,amount:kt===0?Xe+Qe:Xe}));ze.installments=bt,ye?_(Ce):O(Ce)},fe=(ve,ye,Ce,ze)=>{const $e=ze?[...S]:[...E];$e[ve].installments[ye].amount=Ce;const Ue=$e[ve].installments.reduce((Xe,Qe)=>Xe+Qe.amount,0);$e[ve].total_amount=Ue,ze?_($e):O($e)},V=async()=>{var $e,Ue;if(j){alert("Class Fee Structure cannot be created at All Branches level. Please select a specific branch.");return}if(!s||!c){alert("Please select class and academic year");return}const ve=[...S,...E],ye=W,ze={class:s,academic_year:c,fee_group:f,branch:ye==="All Branches"||ye==="All"?"All":ye,location:m,fees:ve.map(Xe=>{let Qe=0;return Xe.installments&&Xe.installments.length>0&&(Qe=Xe.installments[0].amount),{id:Xe.id,fee_type_id:Xe.fee_type_id,total_amount:Xe.total_amount,monthly_amount:Qe,is_new_admission:Xe.is_new_admission,installments:Xe.installments,location:m}})};try{await Ee.post("/class-fee-structure",ze),alert("Fee structure saved successfully!"),Oe()}catch(Xe){console.error("Error saving fee structure:",Xe);const Qe=((Ue=($e=Xe.response)==null?void 0:$e.data)==null?void 0:Ue.error)||"Failed to save fee structure";alert(`Error: ${Qe}`)}},Oe=()=>{_([]),O([]),M(!1),k(!1)},Te=ve=>{const ye=new Set(K);ye.has(ve)?ye.delete(ve):ye.add(ve),z(ye)},be=async()=>{var ve,ye;if(K.size===0){alert("Please select at least one branch to copy to.");return}if(!s){alert("Please select a class first.");return}if(confirm(`Are you sure you want to copy fee structure for ${s} to ${K.size} branches?
(Merge Mode: Only missing fee types will be added)`)){I(!0);try{await Ee.post("/fees/copy-class-fee-structure",{source_branch_id:X,target_branch_ids:Array.from(K),academic_year:c,class:s}),alert("Fee structure copied successfully!"),z(new Set),xe(!1)}catch(Ce){console.error("Copy failed",Ce),alert(((ye=(ve=Ce.response)==null?void 0:ve.data)==null?void 0:ye.error)||"Failed to copy fee structure.")}finally{I(!1)}}},re=U.filter(ve=>String(ve.id)!==String(X)&&ve.name!=="All Branches"&&ve.name!=="All"),we={};return re.forEach(ve=>{we[ve.location_name]||(we[ve.location_name]=[]),we[ve.location_name].push(ve)}),l.jsx("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Create Class Fee Structure"}),j&&l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-yellow-700",children:[l.jsx("span",{className:"font-bold",children:'Cannot create fee structure in "All Branches" mode.'}),l.jsx("br",{}),"Please select a specific branch from the header to create or modify fee structures."]})})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),l.jsxs("select",{value:s,onChange:ve=>o(ve.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Class"}),r.map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year *"}),l.jsx("input",{type:"text",value:c,readOnly:!0,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fee for New Admissions"}),l.jsx("button",{onClick:()=>M(!F),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:F?"Cancel":"+ Add Fee"})]}),F&&l.jsx(i5,{feeTypes:e,onAdd:(ve,ye)=>{J(ve,ye,!0),M(!1)}}),l.jsx(s5,{fees:S,onRemove:ve=>q(ve,!0),onUpdateInstallment:(ve,ye,Ce)=>fe(ve,ye,Ce,!0),onRecalculate:ve=>Q(ve,!0)})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fee Structure for Existing Students"}),l.jsx("button",{onClick:()=>k(!C),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:C?"Cancel":"+ Add Fee"})]}),C&&l.jsx(i5,{feeTypes:e,onAdd:(ve,ye)=>{J(ve,ye,!1),k(!1)}}),l.jsx(s5,{fees:E,onRemove:ve=>q(ve,!1),onUpdateInstallment:(ve,ye,Ce)=>fe(ve,ye,Ce,!1),onRecalculate:ve=>Q(ve,!1)})]}),l.jsxs("div",{className:"flex justify-between items-center gap-4 mt-8 pt-4 border-t",children:[l.jsx("div",{children:!j&&s&&l.jsxs("div",{className:"relative",ref:P,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>xe(!se),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),se&&l.jsxs("div",{className:"absolute bottom-12 left-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(we).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(we).map(ve=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:ve}),l.jsx("div",{className:"py-1",children:we[ve].map(ye=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:K.has(String(ye.id)),onChange:()=>Te(String(ye.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:ye.name})]},ye.id))})]},ve)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[K.size," selected"]}),l.jsx("button",{onClick:be,disabled:A||K.size===0,className:`px-3 py-1 text-xs text-white rounded ${A||K.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:A?"Copying...":"Confirm Copy"})]})]})]})}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:Oe,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Reset"}),l.jsx("button",{onClick:V,className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 shadow-md",children:"Save Fee Structure"})]})]})]})})},i5=({feeTypes:e,onAdd:t})=>{const[r,n]=y.useState(""),[a,i]=y.useState(""),s=()=>{r&&a&&(t(parseInt(r),parseFloat(a)),n(""),i(""))};return l.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4 border border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:r,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[l.jsx("option",{value:"",children:"Select Fee Type"}),e.map(o=>l.jsxs("option",{value:o.id,children:[o.fee_type," (",o.type,")"]},o.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),l.jsx("input",{type:"number",value:a,onChange:o=>i(o.target.value),placeholder:"12000",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Add Fee"})})]})})},s5=({fees:e,onRemove:t,onUpdateInstallment:r,onRecalculate:n})=>e.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No fees added yet"}):l.jsx("div",{className:"space-y-4",children:e.map((a,i)=>l.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-50 px-4 py-3 flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800",children:a.fee_type_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Total: ₹",a.total_amount.toLocaleString()]})]}),l.jsxs("div",{className:"flex gap-2",children:[a.installments.length>0&&l.jsx("button",{onClick:()=>n(i),className:"px-3 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 text-sm",title:"Recalculate installments based on total amount",children:"Recalculate"}),l.jsx("button",{onClick:()=>t(i),className:"px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-sm",children:"Remove"})]})]}),a.installments.length>0&&l.jsxs("div",{className:"p-4 bg-white",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Monthly Installments:"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:a.installments.map((s,o)=>l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-xs text-gray-600 mb-1",children:s.month}),l.jsx("input",{type:"number",value:s.amount,onChange:c=>r(i,o,parseFloat(c.target.value)||0),className:"px-2 py-1 border border-gray-300 rounded text-sm"})]},o))})]})]},i))}),hF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState([]),[s,o]=y.useState(""),[c,u]=y.useState(""),[f,d]=y.useState("All"),[p,h]=y.useState(!1),[m,g]=y.useState(localStorage.getItem("academicYear")||""),[x,b]=y.useState(!1),[S,_]=y.useState([]),[E,O]=y.useState([]),[F,M]=y.useState([]),[C,k]=y.useState(!1),[W,D]=y.useState(!1),[j,H]=y.useState(null),[U,Y]=y.useState(new Set);y.useEffect(()=>{const L=JSON.parse(localStorage.getItem("user")||"{}"),R=localStorage.getItem("currentBranch");h(L.role==="Admin"),L.role==="Admin"?R&&R!=="All"?(d(R),b(!0)):(d("All"),b(!1)):L.branch&&(d(L.branch),b(!0)),X()},[]),y.useEffect(()=>{K()},[s]),y.useEffect(()=>{s?Z(s):n([])},[s]),y.useEffect(()=>{s&&c?z():_([])},[s,c,f]);const X=async()=>{try{const L=await Ee.get("/classes");if(L.data&&Array.isArray(L.data.classes)){const R=L.data.classes.map(G=>String(G.class_name));t([...new Set(R)])}else t([])}catch(L){console.error("Error fetching classes:",L),H("Failed to load classes.")}},Z=async L=>{try{const R=await Ee.get(`/sections?class=${L}`);R.data&&Array.isArray(R.data.sections)?n(R.data.sections):n(["A","B","C","D"])}catch(R){console.error("Error fetching sections:",R),n(["A","B","C","D"])}},K=async()=>{try{let R=(await Ee.get("/fee-types")).data.fee_types||[];if(s)try{const J=(await Ee.get("/class-fee-structure",{params:{class:s,academic_year:m}})).data.fee_structures||[],q=new Set;J.forEach(Q=>{q.add(Q.fee_type_id)}),Y(q)}catch(G){console.error("Error fetching class fee structure for filtering:",G),Y(new Set)}else Y(new Set);i(R.filter(G=>G.fee_type!=="Tuition Fee"))}catch(L){console.error("Error fetching fee types:",L),H("Failed to load fee types.")}},z=async()=>{if(!(!s||!c)){k(!0),H(null);try{const L=await Ee.get("/students",{params:{class:s,section:c,branch:f}});L.data&&Array.isArray(L.data.students)?_(L.data.students):_([]),O([])}catch(L){console.error("Error fetching students:",L),H("Failed to load students.")}finally{k(!1)}}},se=L=>{L.target.checked?O(S.map(R=>R.student_id)):O([])},xe=L=>{E.includes(L)?O(E.filter(R=>R!==L)):O([...E,L])},A=(L,R)=>{M(R?[...F,{fee_type_id:L,amount:0}]:F.filter(G=>G.fee_type_id!==L))},I=(L,R)=>{const G=parseFloat(R)||0;M(F.map(J=>J.fee_type_id===L?{...J,amount:G}:J))},P=async()=>{var G,J;if(E.length===0){alert("Please select at least one student");return}if(F.length===0){alert("Please select at least one fee type");return}const L=F.filter(q=>U.has(q.fee_type_id));if(L.length>0){const q=L.map(Q=>{const fe=a.find(V=>V.id===Q.fee_type_id);return fe?fe.fee_type:"Unknown Fee"}).join(", ");alert(`The following fees are already assigned in the Class Fee Structure and cannot be assigned again: ${q}`);return}if(F.filter(q=>q.amount<=0).length>0){alert("Please enter valid amounts for all selected fees");return}if(window.confirm(`Assign selected fees to ${E.length} students?`)){D(!0);try{const q={student_ids:E,fee_assignments:F.map(fe=>({fee_type_id:fe.fee_type_id,amount:fe.amount,academic_year:m}))},Q=await Ee.post("/fees/assign-special",q);alert(`Success! ${Q.data.assigned_count} fees assigned. ${Q.data.skipped_count} skipped (duplicates).`),M([]),O([])}catch(q){console.error("Error assigning fees:",q),alert(`Error: ${((J=(G=q.response)==null?void 0:G.data)==null?void 0:J.error)||"Failed to assign fees"}`)}finally{D(!1)}}};return j?l.jsxs("div",{className:"p-6 text-red-600",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Error"}),l.jsx("p",{children:j}),l.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-blue-500 text-white px-4 py-2 rounded",children:"Retry"})]}):l.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[l.jsx("h2",{className:"text-2xl font-bold mb-6 text-[#4318FF]",children:"Assign Special Fee Type"}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm mb-6 flex flex-wrap gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsxs("select",{className:"border rounded-lg px-3 py-2 w-40",value:s,onChange:L=>o(L.target.value),children:[l.jsx("option",{value:"",children:"Select Class"}),e.map(L=>l.jsx("option",{value:L,children:L},L))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsxs("select",{className:"border rounded-lg px-3 py-2 w-40",value:c,onChange:L=>u(L.target.value),children:[l.jsx("option",{value:"",children:"Select Section"}),r.map(L=>l.jsx("option",{value:L,children:L},L))]})]})]}),l.jsxs("div",{className:"flex gap-6",children:[l.jsxs("div",{className:"w-1/3 bg-white p-4 rounded-xl shadow-sm h-fit",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Special Fee Type"}),l.jsx("button",{className:"bg-green-500 text-white px-2 py-1 rounded text-sm",children:"+ Add Special Fee Type"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between font-medium text-gray-500 text-sm pb-2 border-b",children:[l.jsx("span",{children:"Fee Type"}),l.jsx("span",{children:"Amount"})]}),a.length===0?l.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No special fee types found."}):a.map(L=>{const R=F.some(J=>J.fee_type_id===L.id),G=F.find(J=>J.fee_type_id===L.id);return l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:R,onChange:J=>A(L.id,J.target.checked),className:"w-4 h-4 text-[#4318FF]"}),l.jsx("span",{children:L.display_name||L.fee_type})]}),R&&l.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",placeholder:"0",value:(G==null?void 0:G.amount)||"",onChange:J=>I(L.id,J.target.value)})]},L.id)})]}),l.jsx("div",{className:"mt-6 flex justify-end",children:l.jsx("button",{className:`px-6 py-2 rounded-lg text-white font-medium ${E.length>0&&F.length>0?"bg-green-500 hover:bg-green-600":"bg-gray-300 cursor-not-allowed"}`,onClick:P,disabled:E.length===0||F.length===0||W,children:W?"Assigning...":"Assign >"})})]}),l.jsxs("div",{className:"w-2/3 bg-white p-4 rounded-xl shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Student List"}),l.jsx("input",{type:"text",placeholder:"Search",className:"border rounded-lg px-3 py-1 text-sm"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b text-gray-500 text-sm",children:[l.jsx("th",{className:"p-2 w-10",children:l.jsx("input",{type:"checkbox",onChange:se,checked:S.length>0&&E.length===S.length})}),l.jsx("th",{className:"p-2",children:"Admission No."}),l.jsx("th",{className:"p-2",children:"Name"}),l.jsx("th",{className:"p-2",children:"Class"}),l.jsx("th",{className:"p-2",children:"Father Mobile"})]})}),l.jsx("tbody",{children:C?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-500",children:"Loading students..."})}):S.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-500",children:"No students found. Select Class and Section to load."})}):S.map(L=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-2",children:l.jsx("input",{type:"checkbox",checked:E.includes(L.student_id),onChange:()=>xe(L.student_id)})}),l.jsx("td",{className:"p-2",children:L.admission_no}),l.jsx("td",{className:"p-2 font-medium",children:L.name}),l.jsxs("td",{className:"p-2",children:[L.class," ",L.section]}),l.jsx("td",{className:"p-2",children:L.fatherMobile})]},L.student_id))})]})})]})]})]})},pF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState([]),[s,o]=y.useState({installment_no:1,title:"",start_date:"",end_date:"",last_pay_date:"",is_admission:!1,description:"",fee_type_id:null,branch:"",location:"",academic_year:""}),[c,u]=y.useState(!1),[f,d]=y.useState({fee_type_id:"",count:12,start_month_idx:1,year:new Date().getFullYear()+1,start_installment_no:3,branch:"",location:"",academic_year:""}),[p,h]=y.useState(null),[m,g]=y.useState(!1),[x,b]=y.useState("All"),[S,_]=y.useState([]),[E,O]=y.useState(""),[F,M]=y.useState(new Set),[C,k]=y.useState(!1),[W,D]=y.useState(!1),[j,H]=y.useState(""),U=y.useRef(null);y.useEffect(()=>{function Q(fe){U.current&&!U.current.contains(fe.target)&&k(!1)}return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[]),y.useEffect(()=>{const Q=JSON.parse(localStorage.getItem("user")||"{}"),fe=Q.role==="Admin";g(fe);let V=localStorage.getItem("currentBranch")||"All";!fe&&Q.branch&&Q.branch!=="All"&&Q.branch!=="All Branches"&&(V=Q.branch);const Oe=localStorage.getItem("currentLocation"),Te=Q.location||"Hyderabad",be=V==="All"||V==="All Branches";let re="All";be?Oe&&Oe!=="All"?re=Oe:re="All":re=Te,b(re);const we=localStorage.getItem("academicYear")||"";o(ve=>({...ve,branch:V,location:re==="All"?"Hyderabad":re,academic_year:we})),d(ve=>({...ve,branch:V,location:re==="All"?"Hyderabad":re,academic_year:we})),be?(b("All"),o(ve=>({...ve,location:"All"})),d(ve=>({...ve,location:"All"}))):Ee.get("/branches").then(ve=>{const ye=ve.data.branches||[],Ce=ye.map($e=>({id:$e.id,name:$e.branch_name,location_name:$e.location_name||"Unknown Location"}));_(Ce);const ze=ye.find($e=>$e.branch_name.toLowerCase()===V.toLowerCase());if(ze){const $e={HYD:"Hyderabad",MUM:"Mumbai"},Ue=(ze.location_code||"").toUpperCase();let Xe=$e[Ue]||Te;b(Xe),o(Qe=>({...Qe,location:Xe})),O(ze.id)}}).catch(ve=>console.error("Error fetching branch info:",ve))},[]),y.useEffect(()=>{X()},[x]),y.useEffect(()=>{Z(),Y()},[]);const Y=async()=>{var Q;try{const V=((Q=(await Ee.get("/org/academic-years")).data.academic_years)==null?void 0:Q.map(Oe=>Oe.name))||[];i(V)}catch(fe){console.error("Error fetching academic years:",fe),i([])}};y.useEffect(()=>{p||o(Q=>({...Q,installment_no:e.length+1}))},[e,p]);const X=async()=>{try{const Q=JSON.parse(localStorage.getItem("user")||"{}");let fe=localStorage.getItem("currentBranch")||"All";Q.role!=="Admin"&&Q.branch&&Q.branch!=="All"&&Q.branch!=="All Branches"&&(fe=Q.branch);const V=fe==="All Branches"||fe==="All"?"All":fe,Oe=await Ee.get("/installment-schedule",{params:{branch:V,location:x}});t(Oe.data.installments||[])}catch(Q){console.error("Error fetching installments:",Q)}},Z=async()=>{try{const Q=await Ee.get("/fee-types");n(Q.data.fee_types||[])}catch(Q){console.error("Error fetching fee types:",Q)}},K=Q=>{const{name:fe,value:V,type:Oe}=Q.target,be=Q.target.checked;o(re=>({...re,[fe]:Oe==="checkbox"?be:V}))},z=async Q=>{if(Q.preventDefault(),!s.title||!s.start_date||!s.end_date||!s.last_pay_date){alert("Please fill all required fields");return}const fe=localStorage.getItem("currentBranch")||"All",V={...s,installment_no:parseInt(s.installment_no.toString()),fee_type_id:s.fee_type_id?parseInt(s.fee_type_id.toString()):null,branch:s.branch||fe,location:s.location||"Hyderabad",academic_year:s.academic_year||""};try{p?(await Ee.put(`/installment-schedule/${p}`,V),alert("Installment updated successfully!")):(await Ee.post("/installment-schedule",V),alert("Installment created successfully!")),X(),A()}catch(Oe){console.error("Error saving installment:",Oe),alert("Failed to save installment")}},se=Q=>{o({installment_no:Q.installment_no,title:Q.title,start_date:Q.start_date,end_date:Q.end_date,last_pay_date:Q.last_pay_date,is_admission:Q.is_admission,description:Q.description||"",fee_type_id:Q.fee_type_id||null,branch:Q.branch||"All",location:Q.location||"Hyderabad",academic_year:Q.academic_year||""}),h(Q.id||null),u(!1)},xe=async Q=>{if(confirm("Are you sure you want to delete this installment?"))try{await Ee.delete(`/installment-schedule/${Q}`),alert("Installment deleted successfully!"),X()}catch(fe){console.error("Error deleting installment:",fe),alert("Failed to delete installment")}},A=()=>{o({installment_no:e.length+1,title:"",start_date:"",end_date:"",last_pay_date:"",is_admission:!1,description:"",fee_type_id:null,branch:localStorage.getItem("currentBranch")||"All",location:"Hyderabad",academic_year:""}),h(null)},I=Q=>{const fe=new Set(F);fe.has(Q)?fe.delete(Q):fe.add(Q),M(fe)},P=async()=>{var Q,fe;if(F.size===0){alert("Please select at least one branch to copy to.");return}if(!j){alert("Please select a Fee Type to copy installments for.");return}if(confirm(`Are you sure you want to copy installments for the selected fee type to ${F.size} branches?`)){D(!0);try{await Ee.post("/fees/copy-installments",{source_branch_id:E,target_branch_ids:Array.from(F),source_fee_type_id:j,academic_year:localStorage.getItem("academicYear")||""}),alert("Installments copied successfully!"),M(new Set),H(""),k(!1)}catch(V){console.error("Copy failed",V),alert(((fe=(Q=V.response)==null?void 0:Q.data)==null?void 0:fe.error)||"Failed to copy installments.")}finally{D(!1)}}},L=S.filter(Q=>String(Q.id)!==String(E)&&Q.name!=="All Branches"&&Q.name!=="All"),R={};L.forEach(Q=>{R[Q.location_name]||(R[Q.location_name]=[]),R[Q.location_name].push(Q)});const G=localStorage.getItem("currentBranch"),J=G&&G!=="All"&&G!=="All Branches",q=r.filter(Q=>Q.branch==="All"||Q.branch===G);return l.jsx("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Fee Installments"})}),J&&l.jsxs("div",{className:"relative",ref:U,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>k(!C),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),C&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsxs("div",{className:"mb-2 p-2 border-b bg-gray-50",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Select Fee Type to Copy:"}),l.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-2 py-1",value:j,onChange:Q=>H(Q.target.value),children:[l.jsx("option",{value:"",children:"-- Select Fee Type --"}),q.map(Q=>l.jsxs("option",{value:Q.id,children:[Q.fee_type," (",Q.type,")"]},Q.id))]})]}),l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b px-2",children:"Select Target Branches"}),Object.keys(R).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(R).map(Q=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:Q}),l.jsx("div",{className:"py-1",children:R[Q].map(fe=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:F.has(String(fe.id)),onChange:()=>I(String(fe.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:fe.name})]},fe.id))})]},Q)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white p-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[F.size," selected"]}),l.jsx("button",{onClick:P,disabled:W||F.size===0||!j,className:`px-3 py-1 text-xs text-white rounded ${W||F.size===0||!j?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:W?"Copying...":"Confirm Copy"})]})]})]})]}),l.jsxs("div",{className:"mb-6 bg-gray-50 p-6 rounded-lg border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:p?"Edit Installment":"Add New Installment"}),l.jsxs("form",{onSubmit:z,children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{name:"fee_type_id",value:s.fee_type_id||"",onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[l.jsx("option",{value:"",children:"Select FeeType"}),r.filter(Q=>{const fe=s.branch||localStorage.getItem("currentBranch")||"All";return!Q.branch||Q.branch==="All"||Q.branch===fe}).map(Q=>l.jsx("option",{value:Q.id,children:Q.fee_type},Q.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installment No *"}),l.jsx("input",{type:"number",name:"installment_no",value:s.installment_no,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),l.jsx("input",{type:"text",name:"title",value:s.title,onChange:K,placeholder:"e.g., April Fee",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),l.jsx("input",{type:"date",name:"start_date",value:s.start_date,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),l.jsx("input",{type:"date",name:"end_date",value:s.end_date,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Pay Date *"}),l.jsx("input",{type:"date",name:"last_pay_date",value:s.last_pay_date,onChange:K,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:l.jsxs("div",{className:"md:col-span-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsxs("select",{name:"academic_year",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-violet-500",value:s.academic_year,onChange:K,children:[l.jsx("option",{value:"",children:"Select Year"}),a.map(Q=>l.jsx("option",{value:Q,children:Q},Q))]})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("textarea",{name:"description",value:s.description,onChange:K,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Optional description"})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{type:"submit",className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-500",children:p?"Update":"Save"}),l.jsx("button",{type:"button",onClick:A,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none",children:"Reset"})]})]})]}),l.jsxs("div",{className:"overflow-x-auto",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Fee Installments"}),l.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"No."}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Fee Type"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Title"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Start Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"End Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Last Pay Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Branch"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b",children:"Action"})]})}),l.jsx("tbody",{children:e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No installments added yet"})}):e.map(Q=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:Q.installment_no}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-b",children:Q.fee_type_name||"-"}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:[Q.title,Q.is_admission&&l.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded",children:"Admission"})]}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.start_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.end_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.last_pay_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-b",children:Q.branch||"All"}),l.jsx("td",{className:"px-4 py-3 text-center border-b",children:l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:()=>se(Q),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"✏️ Edit"}),l.jsx("button",{onClick:()=>xe(Q.id),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm",children:"🗑️ Delete"})]})})]},Q.id))})]})]})]})})},rj=({onClose:e,receiptData:t})=>{const{studentName:r,admissionNo:n,className:a,receiptNo:i,paymentDate:s,paymentMode:o,paymentNote:c,items:u,amount:f,concession:d,payable:p}=t,h=()=>{var E;const g=document.querySelector(".printable-receipt");if(!g)return;const x=Array.from(document.styleSheets).map(O=>{try{return Array.from(O.cssRules).map(F=>F.cssText).join("")}catch{return console.warn("Could not read CSS rules from stylesheet:",O.href),""}}).join(`
`),b=((E=document.querySelector('link[href^="https://fonts.googleapis.com"]'))==null?void 0:E.outerHTML)||"",S=g.innerHTML,_=window.open("","","height=800,width=800");if(!_){alert("Could not open print window. Please disable pop-up blockers.");return}_.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Fee Receipt</title>
            ${b}
            <style>
                ${x}
                body { 
                    font-family: 'Poppins', sans-serif; 
                    -webkit-print-color-adjust: exact; /* Important for Chrome */
                    color-adjust: exact; /* Standard */
                }
                @media print {
                  body { margin: 0; }
                  .no-print { display: none !important; }
                }
            </style>
        </head>
        <body>
            ${S}
        </body>
        </html>
    `),_.document.close(),setTimeout(()=>{_.focus(),_.print(),_.close()},500)},m=g=>g?new Date(g+"T00:00:00").toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).replace(/ /g,"-"):"";return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"printable-receipt p-8 text-gray-800 bg-white",children:[l.jsxs("div",{className:"flex items-center justify-start mb-4",children:[l.jsx("img",{src:"https://mshifzacademy.com/assets/images/ms-logo.jpg",alt:"School Logo",className:"h-16 mr-4"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-black",children:"MS Education Academy"}),l.jsx("p",{className:"text-md text-gray-600",children:"Fee Receipt"})]})]}),l.jsx("hr",{className:"my-6"}),l.jsxs("div",{className:"flex justify-between text-sm mb-8",children:[l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Student Name:"})," ",r]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Admission No:"})," ",n]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Class:"})," ",a]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Receipt No:"})," ",i]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Payment Date:"})," ",m(s)]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Payment Mode:"})," ",o]})]})]}),l.jsxs("table",{className:"w-full text-sm text-left mb-8",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider",children:"SR. NO"}),l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider",children:"FEE DETAILS"}),l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider text-right",children:"AMOUNT"})]})}),l.jsx("tbody",{children:u.map((g,x)=>l.jsxs("tr",{className:"border-b",children:[l.jsx("td",{className:"px-4 py-3",children:x+1}),l.jsx("td",{className:"px-4 py-3 font-medium",children:g.title}),l.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["₹",g.payable.toLocaleString("en-IN")]})]},g.title))})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"text-sm",children:c&&l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Note:"})," ",c]})}),l.jsxs("div",{className:"w-1/3 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",f.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Concession:"}),l.jsxs("span",{className:"font-mono text-right",children:["- ₹",d.toLocaleString("en-IN")]})]}),l.jsx("hr",{className:"my-2"}),l.jsxs("div",{className:"flex justify-between font-bold text-base",children:[l.jsx("span",{children:"Net Payable:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",p.toLocaleString("en-IN")]})]})]})]}),l.jsx("div",{className:"text-center text-xs text-gray-400 mt-12",children:"This is a computer-generated receipt."})]}),l.jsxs("div",{className:"p-6 pt-0 flex justify-end space-x-4 no-print",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-sm font-semibold text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400",children:"Close"}),l.jsx("button",{onClick:h,className:"px-6 py-2 text-sm font-semibold text-white bg-violet-700 rounded-md hover:bg-violet-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Print"})]})]})})},mF=({navigateTo:e})=>{const[t,r]=y.useState(null);return l.jsx("div",{className:"bg-white",style:{borderTop:"4px solid #6d28d9"}})},M0=({title:e,value:t,bgColor:r,textColor:n,icon:a})=>l.jsxs("div",{className:`p-2 rounded-lg text-center ${r}`,children:[l.jsx("p",{className:`text-xs font-semibold ${n}`,children:e}),l.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[a,l.jsx("p",{className:`font-bold text-lg ${n}`,children:t})]})]}),gF=({installment:e,isSelected:t,onSelect:r,isDisabled:n})=>{const{sr:a,title:i,payable:s,paid:o,paidAmount:c,dueAmount:u,concession:f}=e,d=u!==void 0?u:s-(c||0),p=!o&&(c||0)>0,h=o||d<=0;let m=`Payable = ${s}`;f&&f>0&&(m+=`, Concession = ${f}`);let g="bg-white hover:bg-gray-50";return h?(m=`Payable = ${s}`,f&&f>0&&(m+=`, Concession = ${f}`),m+=`, Paid = ${c||s-(f||0)}, Due = 0`,g="bg-green-100 text-green-800 hover:bg-green-200"):p?(m=`Payable = ${s}`,f&&f>0&&(m+=`, Concession = ${f}`),m+=`, Paid = ${c}, Due = ${d}`,g="bg-red-50 text-red-800 hover:bg-red-100"):d>0&&(m=`Payable = ${s}`,f&&f>0&&(m+=`, Concession = ${f}`),m+=`, Due = ${d}`,g="bg-red-50 text-red-800 hover:bg-red-100"),t&&(g+=" bg-violet-100"),n&&(g+=" opacity-50 cursor-not-allowed"),l.jsxs("tr",{className:g,children:[l.jsx("td",{className:"border px-2 py-2 text-center",children:h?l.jsx("span",{className:"text-green-600 font-bold",children:"✔"}):l.jsx("input",{type:"checkbox",checked:t,onChange:()=>!n&&r(a),disabled:n,className:"h-4 w-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500 disabled:opacity-50 disabled:cursor-not-allowed"})}),l.jsx("td",{className:"border px-2 py-2 text-center text-sm text-gray-600",children:a}),l.jsx("td",{className:"border px-2 py-2 text-sm text-gray-800",children:i}),l.jsx("td",{className:"border px-2 py-2 text-xs text-gray-500",children:m})]})},xF=({navigateTo:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState([]),[i,s]=y.useState(""),[o,c]=y.useState(""),[u,f]=y.useState(null),[d,p]=y.useState(""),h=y.useMemo(()=>t.find(Ae=>Ae.student_id===u),[t,u]),[m,g]=y.useState([]),[x,b]=y.useState({totalPaids:0,totalDue:0,currentDue:0}),[S,_]=y.useState([]),[E,O]=y.useState("0"),[F,M]=y.useState(0),[C,k]=y.useState({}),[W,D]=y.useState("0"),[j,H]=y.useState([]),[U,Y]=y.useState([]),[X,Z]=y.useState(""),[K,z]=y.useState(!1),[se,xe]=y.useState([]),A=async()=>{if(h)try{const Ae=await Ee.get(`/fees/payments/${h.student_id}`);xe(Ae.data),z(!0)}catch(Ae){console.error("Error fetching payment history:",Ae),alert("Failed to fetch payment history.")}},I=async Ae=>{var tt,at;if(window.confirm("Are you sure you want to delete this payment? This will revert the fee status."))try{if(await Ee.delete(`/fees/payment/${Ae}`),alert("Payment deleted successfully."),A(),h){const Ct=localStorage.getItem("currentBranch")||"All",_t=Ct==="All Branches"||Ct==="All"?"All":Ct,xt=await Ee.get(`/fees/student-details/${h.student_id}?branch=${_t}`);g(xt.data.installments||[])}}catch(Ct){console.error("Error deleting payment:",Ct),alert(((at=(tt=Ct.response)==null?void 0:tt.data)==null?void 0:at.error)||"Failed to delete payment.")}},P=Ae=>{const tt=se.filter(Nt=>Nt.receipt_no===Ae);if(tt.length===0)return;const at=tt.reduce((Nt,kr)=>Nt+parseFloat(kr.amount_paid),0),Ct=tt.reduce((Nt,kr)=>Nt+parseFloat(kr.concession_amount),0),_t=at+Ct,xt=tt.map((Nt,kr)=>({sr:kr+1,title:Nt.installment==="One-Time"||!Nt.installment?Nt.fee_type:`${Nt.fee_type} - ${Nt.installment}`,payable:parseFloat(Nt.amount_paid)+parseFloat(Nt.concession_amount),dueAmount:0,paidAmount:parseFloat(Nt.amount_paid),concession:parseFloat(Nt.concession_amount),paid:!0})),fn={studentName:h==null?void 0:h.name,admissionNo:h==null?void 0:h.admNo,className:h==null?void 0:h.class,receiptNo:Ae,paymentDate:tt[0].payment_date,paymentMode:tt[0].mode,paymentNote:"",items:xt,amount:_t,concession:Ct,payable:at};Q(fn),J(!0)},L=y.useMemo(()=>X?m.filter(Ae=>Ae.fee_type_id===Number(X)):[],[m,X]);y.useEffect(()=>{(async()=>{try{const tt=await Ee.get("/fee-types"),at=tt.data.fee_types||tt.data;Y(Array.isArray(at)?at:[])}catch(tt){console.error("Error fetching fee types:",tt)}})()},[]);const R=async Ae=>{const tt=Ae.target.value;if(Z(tt),!tt||!h)return;const at=Number(tt);m.some(_t=>_t.fee_type_id===at)||window.confirm("This fee type is not assigned to the student.")};y.useEffect(()=>{(async()=>{try{const tt=await Ee.get("/concessions");H(tt.data.concessions)}catch(tt){console.error("Error fetching concessions:",tt)}})()},[]);const[G,J]=y.useState(!1),[q,Q]=y.useState(null),[fe,V]=y.useState(""),[Oe,Te]=y.useState(""),[be,re]=y.useState("Cash"),[we,ve]=y.useState(new Date().toISOString().split("T")[0]),[ye,Ce]=y.useState(!1);y.useEffect(()=>{const Ae=localStorage.getItem("user");if(Ae){const tt=JSON.parse(Ae);Ce(tt.role==="Admin")}},[]),y.useEffect(()=>{(async()=>{try{const at=(await Ee.get("/classes")).data.classes.map(Ct=>String(Ct.class_name));a([...new Set(at)])}catch(tt){console.error("Error fetching classes:",tt)}})()},[]),y.useEffect(()=>{(async()=>{try{const tt=new URLSearchParams;i&&tt.append("class",i),o&&tt.append("section",o),d&&tt.append("search",d);const at=localStorage.getItem("currentBranch")||"All";tt.append("branch",at==="All Branches"||at==="All"?"All":at);const _t=(await Ee.get(`/fees/students?${tt.toString()}`)).data;r(Array.isArray(_t)?_t:_t.students||[])}catch(tt){console.error("Error fetching students:",tt),r([])}})()},[i,o,d]),y.useEffect(()=>{(async()=>{if(h)try{const tt=localStorage.getItem("currentBranch")||"All",at=tt==="All Branches"||tt==="All"?"All":tt,Ct=await Ee.get(`/fees/student-details/${h.student_id}?branch=${at}`);g(Ct.data.installments||[])}catch(tt){console.error("Error fetching installments:",tt),g([])}else g([]);Dt(),O("0"),M(0),k({})})()},[h]),y.useEffect(()=>{if(!m||m.length===0){b({totalPaids:0,totalDue:0,currentDue:0});return}const Ae=m.filter(_t=>_t.paid).reduce((_t,xt)=>_t+(xt.paidAmount||xt.payable),0),tt=m.filter(_t=>!_t.paid),at=tt.reduce((_t,xt)=>_t+xt.payable,0),Ct=tt.length>0?tt[0].payable:0;b({totalPaids:Ae,totalDue:at,currentDue:Ct})},[m]);const ze=Ae=>{_(tt=>tt.includes(Ae)?tt.filter(Ct=>Ct<Ae):[...tt,Ae].sort((Ct,_t)=>Ct-_t))},$e=()=>{if(E==="0"){M(0),k({});return}const Ae=j.find(xt=>xt.title===E);if(!Ae){M(0),k({});return}let tt=0;const at={},Ct=m.filter(xt=>S.includes(xt.sr));console.log("DEBUG: Applying Concession:",Ae),console.log("DEBUG: Selected Items:",Ct);const _t=[];for(const xt of Ct){const fn=Ae.items.find(Nt=>Nt.fee_type_id===xt.fee_type_id);if(console.log(`DEBUG: Checking item ${xt.title} (FeeTypeID: ${xt.fee_type_id}) -> Match:`,fn),fn){if((xt.concession||0)>0){console.log(`DEBUG: Skipping ${xt.title} - Already has concession: ${xt.concession}`);continue}if(xt.due_date&&we>xt.due_date){console.log(`DEBUG: Skipping ${xt.title} - Payment Date (${we}) is after Due Date (${xt.due_date})`),_t.push(`${xt.title} (Due: ${xt.due_date})`);continue}const Nt=xt.dueAmount!==void 0&&xt.dueAmount>0?xt.dueAmount:xt.payable;let kr=0;Ae.is_percentage?kr=Nt*(fn.percentage/100):kr=Math.min(Nt,fn.percentage),kr=Math.round(kr),at[xt.sr]=kr,tt+=kr}}console.log("DEBUG: Total Discount:",tt),k(at),M(tt),_t.length>0&&alert(`Concession was NOT applied to the following installments because the Payment Date (${we}) is after the Due Date:

- ${_t.join(`
- `)}`)},Ue=m.filter(Ae=>S.includes(Ae.sr)),Xe=Ue.reduce((Ae,tt)=>{const at=tt.dueAmount!==void 0&&tt.dueAmount>0?tt.dueAmount:tt.payable;return Ae+at},0),Qe=Xe-F,bt=Qe-Number(W);y.useEffect(()=>{D(String(Qe>0?Qe:0))},[Qe,S]);const Dt=()=>{_([]),O("0"),M(0),k({}),D("0"),V(""),Te(""),re("Cash"),ve(new Date().toISOString().split("T")[0])},kt=async()=>{var Ae,tt;if(!h||Ue.length===0){alert("Please select a student and at least one installment to pay.");return}if(!fe.trim()){alert("Please enter School Receipt No");return}try{let at=Number(W);const Ct=Ue.map(Et=>{const Kt=C[Et.sr]||0;let Li=Et.dueAmount!==void 0&&Et.dueAmount>0?Et.dueAmount:Et.payable;const Zr=Math.max(0,Li-Kt),wa=Math.min(Zr,at);return at-=wa,{student_fee_id:Et.student_fee_id,amount:wa,concession_amount:Kt}}),_t=localStorage.getItem("currentBranch")||"All",xt=_t==="All Branches"||_t==="All"?"All":_t,Nt=(await Ee.post(`/fees/payment?branch=${xt}`,{student_id:h.student_id,amount_paid:Number(W),payment_mode:be,payment_date:we,note:Oe,receipt_no:fe,fee_allocations:Ct})).data.receipt_no,kr={studentName:h.name,admissionNo:h.admNo,className:h.class,receiptNo:Nt,paymentDate:we,paymentMode:be,paymentNote:Oe,items:Ue,amount:Xe,concession:F,payable:Number(W)};Q(kr),J(!0);const ir=new URLSearchParams;i&&ir.append("class",i),o&&ir.append("section",o),ir.append("branch",xt);const ba=(await Ee.get(`/fees/students?${ir}`)).data;r(Array.isArray(ba)?ba:ba.students||[]);const or=await Ee.get(`/fees/student-details/${h.student_id}?branch=${xt}`);g(or.data.installments||[])}catch(at){console.error("Error recording payment:",at),alert(((tt=(Ae=at.response)==null?void 0:Ae.data)==null?void 0:tt.error)||"Failed to record payment")}},wt=()=>{J(!1),Q(null),Dt()},it=()=>l.jsx("span",{className:"font-sans",children:"₹"});return l.jsxs("div",{className:"container-fluid mx-auto bg-gray-50",children:[l.jsx(mF,{navigateTo:e}),l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[l.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[l.jsx(it,{})," Take Fee"]}),l.jsxs("div",{className:"p-4 border rounded-lg shadow-sm bg-violet-50/50 space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[l.jsx("input",{type:"text",placeholder:"Search Adm No or Name...",value:d,onChange:Ae=>p(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm"}),l.jsxs("select",{value:i,onChange:Ae=>{s(Ae.target.value),c("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Class --"}),n.map(Ae=>l.jsx("option",{value:Ae,children:Ae},Ae))]}),l.jsxs("select",{value:o,onChange:Ae=>c(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Section --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]}),l.jsxs("select",{value:X,onChange:R,disabled:!h,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Fee Type --"}),U.map(Ae=>l.jsx("option",{value:Ae.id,children:Ae.fee_type},Ae.id))]})]}),l.jsx("div",{children:l.jsxs("select",{value:u||"",onChange:Ae=>f(Number(Ae.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Student --"}),t.map(Ae=>l.jsxs("option",{value:Ae.student_id,children:[Ae.name," (",Ae.admNo,")"]},Ae.student_id))]})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{className:"text-sm px-3 py-1.5 border rounded-md hover:bg-gray-100",children:"Download QR"}),l.jsx("button",{className:"text-sm px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Student"})]})]}),h&&l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:[l.jsx(M0,{title:"Total Paids",value:x.totalPaids.toLocaleString(),bgColor:"bg-green-100",textColor:"text-green-800",icon:l.jsx(it,{})}),l.jsx(M0,{title:"Current Due",value:x.currentDue.toLocaleString(),bgColor:"bg-blue-100",textColor:"text-blue-800",icon:l.jsx(it,{})}),l.jsx(M0,{title:"Total Due",value:x.totalDue.toLocaleString(),bgColor:"bg-orange-100",textColor:"text-orange-800",icon:l.jsx(it,{})}),l.jsx(M0,{title:"Refund Amount",value:"0",bgColor:"bg-red-100",textColor:"text-red-800",icon:l.jsx(it,{})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h4",{className:"font-semibold text-gray-700",children:["Details ",l.jsx("a",{href:"#",className:"text-blue-500 text-sm font-normal hover:underline",children:"show student details  "})]}),l.jsx("div",{className:"flex items-center space-x-2"})]}),l.jsxs("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-blue-500 text-white px-4 py-2 flex justify-between items-center",children:[l.jsxs("h4",{className:"font-semibold relative",children:["Installment",m.length>0&&l.jsx("span",{className:"absolute -top-2 -right-5 bg-orange-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:m.length})]}),l.jsx("button",{onClick:A,className:"bg-orange-400 text-white px-3 py-1 text-sm rounded-md hover:bg-orange-500",children:"Print / Cancel"})]}),l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-100 sticky top-0",children:l.jsxs("tr",{className:"bg-gray-100 sticky top-0",children:[l.jsx("th",{className:"px-2 py-2 border w-12"}),l.jsx("th",{className:"px-2 py-2 border w-12",children:"Sr."}),l.jsx("th",{className:"px-2 py-2 border text-left",children:"Title"}),l.jsx("th",{className:"px-2 py-2 border text-left",children:"Details"})]})}),l.jsx("tbody",{children:h?L.length>0?L.map((Ae,tt)=>{const at=Ae.paid;let Ct=!1;return at?Ct=!1:L.slice(0,tt).every(xt=>xt.paid||S.includes(xt.sr))||(Ct=!0),l.jsx(gF,{installment:Ae,isSelected:S.includes(Ae.sr),onSelect:ze,isDisabled:Ct},Ae.sr)}):l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"text-center p-4 text-gray-500",children:"No installments found for this fee type."})}):l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"text-center p-4 text-gray-500",children:"Please select a student to view installments."})})})]})})]})]}),l.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[l.jsxs("div",{className:"border rounded-lg p-4 space-y-3 bg-gray-50/50 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("h3",{className:"font-semibold text-gray-800",children:["Fee Structure ",l.jsx("a",{href:"#",className:"text-blue-500 text-sm font-normal hover:underline",children:"Get Help"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsxs("select",{value:E,onChange:Ae=>O(Ae.target.value),className:"text-sm border rounded-l-md p-1.5 focus:ring-violet-500 focus:border-violet-500",disabled:!h,children:[l.jsx("option",{value:"0",children:"Select Concession"}),j.filter(Ae=>Ae.show_in_payment).map((Ae,tt)=>l.jsx("option",{value:Ae.title,children:Ae.title},tt))]}),l.jsx("button",{onClick:$e,className:"bg-green-500 text-white px-3 py-1.5 text-sm rounded-r-md hover:bg-green-600",disabled:!h,children:"Apply"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm bg-white",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100",children:[l.jsx("th",{className:"border p-2 w-10",children:l.jsx("button",{className:"w-6 h-6 bg-green-500 text-white rounded hover:bg-green-600 flex items-center justify-center text-sm",children:"+"})}),l.jsx("th",{className:"border p-2 text-left font-medium text-gray-600",children:"Title"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Payable"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Paid"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Due"}),l.jsx("th",{className:"border p-2 w-32 font-medium text-gray-600",children:"+ Extra Charge"})]})}),l.jsx("tbody",{children:Ue.length>0?Ue.map(Ae=>{const tt=Ae.dueAmount!==void 0&&Ae.dueAmount>0?Ae.dueAmount:Ae.payable,at=Ae.paidAmount||0,Ct=Ae.dueAmount||0;return l.jsxs("tr",{children:[l.jsx("td",{className:"border p-2"}),l.jsx("td",{className:"border p-2",children:Ae.title}),l.jsx("td",{className:"border p-2 text-right",children:tt.toFixed(0)}),l.jsx("td",{className:"border p-2 text-right",children:at.toFixed(0)}),l.jsx("td",{className:"border p-2 text-right",children:Ct.toFixed(0)}),l.jsx("td",{className:"border p-2"})]},Ae.sr)}):l.jsx("tr",{children:l.jsx("td",{className:"border p-2 h-8 text-center text-gray-400",colSpan:6,children:"Select installments to pay"})})})]})}),l.jsxs("div",{className:"space-y-2 pt-4",children:[l.jsxs("div",{className:"flex justify-between items-center text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Amount"}),l.jsx("span",{className:"font-semibold text-gray-800",children:Xe.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Concession"}),l.jsx("span",{className:"font-semibold text-gray-800",children:F.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold border-t pt-2",children:[l.jsx("span",{className:"text-gray-800",children:"Payable(Amount - Concession)"}),l.jsx("span",{className:"font-semibold text-gray-800",children:Qe.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[l.jsx("span",{className:"text-gray-600",children:"Paid"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"text",value:W,onChange:Ae=>D(Ae.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-right focus:outline-none focus:ring-violet-500 focus:border-violet-500"}),l.jsx("button",{className:"ml-2 px-3 py-1 bg-green-500 text-white rounded-md text-lg font-bold hover:bg-green-600",children:"="})]})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-red-600 border-t pt-2",children:[l.jsx("span",{children:"Due (Payable - Paid)"}),l.jsx("span",{children:bt.toLocaleString()})]})]})]}),l.jsxs("div",{className:"border rounded-lg p-4 space-y-4 bg-gray-50/50 shadow-sm",children:[l.jsx("div",{className:"text-center text-sm text-orange-600 bg-orange-100 p-2 rounded-md",children:'Hit "ENTER" or Equal(=) button after entering "Paid" amount'}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Mode*"}),l.jsxs("select",{value:be,onChange:Ae=>re(Ae.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500",children:[l.jsx("option",{children:"Cash"})," ",l.jsx("option",{children:"Card"})," ",l.jsx("option",{children:"Online"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Date*"}),l.jsx("input",{type:"date",value:we,onChange:Ae=>ve(Ae.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"School Receipt No*"}),l.jsx("input",{type:"text",value:fe,onChange:Ae=>V(Ae.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Note"}),l.jsx("input",{type:"text",value:Oe,maxLength:25,onChange:Ae=>Te(Ae.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:"keep-details",type:"checkbox",className:"h-4 w-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500"}),l.jsx("label",{htmlFor:"keep-details",className:"ml-2 block text-sm text-gray-900",children:"Keep same payment detail for the next fee payment"})]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[l.jsx("button",{onClick:kt,className:"px-4 py-2 text-sm font-medium text-white bg-violet-600 rounded-md hover:bg-violet-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",disabled:!h,children:"Take Fee"}),l.jsx("button",{onClick:Dt,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400",children:"Reset"})]})]})]})]})})}),G&&q&&l.jsx(rj,{onClose:wt,receiptData:q}),K&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("h2",{className:"text-xl font-bold",children:["Payment History - ",h==null?void 0:h.name," (",localStorage.getItem("academicYear"),")"]}),l.jsx("button",{onClick:()=>z(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2",children:"Receipt No"}),l.jsx("th",{className:"p-2",children:"Academic Year"}),l.jsx("th",{className:"p-2",children:"Date"}),l.jsx("th",{className:"p-2",children:"Fee Type"}),l.jsx("th",{className:"p-2",children:"Installment"}),l.jsx("th",{className:"p-2 text-right",children:"Amount"}),l.jsx("th",{className:"p-2 text-right",children:"Concession"}),l.jsx("th",{className:"p-2",children:"Mode"}),l.jsx("th",{className:"p-2 text-center",children:"Actions"})]})}),l.jsxs("tbody",{children:[se.map(Ae=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-2",children:Ae.receipt_no}),l.jsx("td",{className:"p-2",children:Ae.academic_year}),l.jsx("td",{className:"p-2",children:Ae.payment_date}),l.jsx("td",{className:"p-2",children:Ae.fee_type}),l.jsx("td",{className:"p-2",children:Ae.installment}),l.jsxs("td",{className:"p-2 text-right",children:["₹",parseFloat(Ae.amount_paid).toLocaleString("en-IN")]}),l.jsxs("td",{className:"p-2 text-right",children:["₹",parseFloat(Ae.concession_amount).toLocaleString("en-IN")]}),l.jsx("td",{className:"p-2",children:Ae.mode}),l.jsxs("td",{className:"p-2 flex justify-center space-x-2",children:[l.jsx("button",{onClick:()=>P(Ae.receipt_no),title:"Print Receipt",className:"text-blue-600 hover:text-blue-800",children:l.jsx(JO,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>I(Ae.payment_id),title:"Delete Payment",className:"text-red-600 hover:text-red-800",children:l.jsx(ej,{className:"w-5 h-5"})})]})]},Ae.payment_id)),se.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No payments found."})})]})]}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Close"})})]})})]})},vF=({navigateTo:e})=>{const t=[{id:"calendar",name:"Calendar",icon:l.jsx(Th,{className:"w-8 h-8"}),iconBg:"bg-blue-50",iconColor:"text-blue-600",comingSoon:!0},{id:"document",name:"Document",icon:l.jsx(kf,{className:"w-8 h-8"}),iconBg:"bg-slate-50",iconColor:"text-slate-600",comingSoon:!0},{id:"download",name:"Download",icon:l.jsx(QA,{className:"w-8 h-8"}),iconBg:"bg-green-50",iconColor:"text-green-600",comingSoon:!0},{id:"inquiry",name:"Inquiry",icon:l.jsx(XA,{className:"w-8 h-8"}),iconBg:"bg-amber-50",iconColor:"text-amber-600",comingSoon:!0},{id:"hostel",name:"Hostel",icon:l.jsx(n5,{className:"w-8 h-8"}),iconBg:"bg-purple-50",iconColor:"text-purple-600",comingSoon:!0},{id:"leave",name:"Leave",icon:l.jsx(Th,{className:"w-8 h-8"}),iconBg:"bg-orange-50",iconColor:"text-orange-600",comingSoon:!0},{id:"library",name:"Library",icon:l.jsx(kf,{className:"w-8 h-8"}),iconBg:"bg-pink-50",iconColor:"text-pink-600",comingSoon:!0},{id:"student-attendance",name:"Student Attendance",icon:l.jsx(Ph,{className:"w-8 h-8"}),iconBg:"bg-teal-50",iconColor:"text-teal-600",page:"student-attendance"},{id:"student",name:"Student",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-indigo-50",iconColor:"text-indigo-600",page:"student-administration"},{id:"summary",name:"Summary",icon:l.jsx(O2,{className:"w-8 h-8"}),iconBg:"bg-cyan-50",iconColor:"text-cyan-600",comingSoon:!0},{id:"attendance-staff",name:"Attendance(Stf)",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-red-50",iconColor:"text-red-600",comingSoon:!0},{id:"staffs",name:"Staffs",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-emerald-50",iconColor:"text-emerald-600",comingSoon:!0},{id:"team",name:"Team",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-violet-50",iconColor:"text-violet-600",comingSoon:!0},{id:"transport",name:"Transport",icon:l.jsx(n5,{className:"w-8 h-8"}),iconBg:"bg-yellow-50",iconColor:"text-yellow-600",comingSoon:!0},{id:"alumni",name:"Alumni",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-lime-50",iconColor:"text-lime-600",comingSoon:!0},{id:"post-jobs",name:"Post Jobs",icon:l.jsx(kf,{className:"w-8 h-8"}),iconBg:"bg-fuchsia-50",iconColor:"text-fuchsia-600",comingSoon:!0},{id:"survey",name:"Survey",icon:l.jsx(Ph,{className:"w-8 h-8"}),iconBg:"bg-rose-50",iconColor:"text-rose-600",comingSoon:!0},{id:"helpdesk",name:"Helpdesk",icon:l.jsx(ZA,{className:"w-8 h-8"}),iconBg:"bg-sky-50",iconColor:"text-sky-600",comingSoon:!0}],r=n=>{n.page&&e(n.page)};return l.jsxs("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-5",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:l.jsx(JA,{className:"w-6 h-6 text-slate-700"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Administration"}),l.jsx("p",{className:"text-sm text-slate-600 mt-0.5",children:"Take control of your school operations"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map(n=>l.jsxs("button",{onClick:()=>r(n),disabled:n.comingSoon,className:`group relative bg-white rounded-xl p-6 border border-slate-200 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 ${n.comingSoon?"opacity-60 cursor-not-allowed":"hover:border-blue-300 hover:shadow-lg cursor-pointer"}`,children:[l.jsx("div",{className:`${n.iconBg} ${n.iconColor} w-14 h-14 rounded-xl flex items-center justify-center mb-4 ${!n.comingSoon&&"group-hover:scale-105"} transition-transform duration-200`,children:n.icon}),l.jsx("h3",{className:`font-semibold text-slate-900 text-base mb-1 ${!n.comingSoon&&"group-hover:text-blue-600"} transition-colors`,children:n.name}),n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:"Coming Soon"}),n.page&&!n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Active"})]},n.id))})})]})},nj=({pageTitle:e})=>l.jsx("div",{className:"flex items-center justify-center h-full p-4 bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold text-gray-700 tracking-tight",children:e}),l.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"This page is under construction."}),l.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Please check back later!"})]})}),yF=({navigateTo:e})=>{const t=[{id:"academic",name:"Academic",icon:l.jsx(Y1,{className:"w-8 h-8"}),iconBg:"bg-blue-50",iconColor:"text-blue-600",page:"academics"},{id:"classwork",name:"Classwork",icon:l.jsx(Ph,{className:"w-8 h-8"}),iconBg:"bg-purple-50",iconColor:"text-purple-600",comingSoon:!0},{id:"homework",name:"Homework",icon:l.jsx(kf,{className:"w-8 h-8"}),iconBg:"bg-orange-50",iconColor:"text-orange-600",comingSoon:!0},{id:"lesson-plan",name:"Lesson Plan",icon:l.jsx(K1,{className:"w-8 h-8"}),iconBg:"bg-amber-50",iconColor:"text-amber-600",comingSoon:!0},{id:"time-table",name:"Time Table",icon:l.jsx(Th,{className:"w-8 h-8"}),iconBg:"bg-teal-50",iconColor:"text-teal-600",comingSoon:!0},{id:"time-table-2",name:"Time Table",icon:l.jsx(Th,{className:"w-8 h-8"}),iconBg:"bg-green-50",iconColor:"text-green-600",comingSoon:!0},{id:"online-exam",name:"Online Exam",icon:l.jsx(kf,{className:"w-8 h-8"}),iconBg:"bg-pink-50",iconColor:"text-pink-600",comingSoon:!0},{id:"academic-content",name:"Academic Content",icon:l.jsx(O2,{className:"w-8 h-8"}),iconBg:"bg-indigo-50",iconColor:"text-indigo-600",comingSoon:!0},{id:"assessment",name:"Assessment",icon:l.jsx(Ph,{className:"w-8 h-8"}),iconBg:"bg-red-50",iconColor:"text-red-600",comingSoon:!0},{id:"online-class",name:"Online Class",icon:l.jsx(vs,{className:"w-8 h-8"}),iconBg:"bg-cyan-50",iconColor:"text-cyan-600",comingSoon:!0},{id:"activity-planner",name:"Activity Planner",icon:l.jsx(K1,{className:"w-8 h-8"}),iconBg:"bg-emerald-50",iconColor:"text-emerald-600",comingSoon:!0}],r=n=>{n.page?e(n.page):n.comingSoon};return l.jsxs("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-5",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:l.jsx(Y1,{className:"w-6 h-6 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Academic Management"}),l.jsx("p",{className:"text-sm text-slate-600 mt-0.5",children:"Manage all academic activities and resources"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map(n=>l.jsxs("button",{onClick:()=>r(n),className:"group relative bg-white rounded-xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all duration-200 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[l.jsx("div",{className:`${n.iconBg} ${n.iconColor} w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:scale-105 transition-transform duration-200`,children:n.icon}),l.jsx("h3",{className:"font-semibold text-slate-900 text-base mb-1 group-hover:text-blue-600 transition-colors",children:n.name}),n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:"Coming Soon"}),n.page&&!n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Active"})]},n.id))})})]})};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),En=(e,t)=>{const r=y.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:c,...u},f)=>y.createElement("svg",{ref:f,...bF,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${wF(e)}`,o].join(" "),...u},[...t.map(([d,p])=>y.createElement(d,p)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oh=En("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=En("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=En("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=En("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=En("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=En("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=En("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=En("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=En("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=En("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=En("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=En("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=En("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=En("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=En("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=En("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=En("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=En("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=En("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),OF=()=>{if(JSON.parse(localStorage.getItem("user")||"{}").role!=="Admin")return l.jsx("div",{className:"p-4 text-red-500",children:"Access Denied: Only Admins can manage subjects."});const t=localStorage.getItem("academicYear")||"2024-2025",[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState("Academic"),[c,u]=y.useState(null),[f,d]=y.useState(""),[p,h]=y.useState("Academic"),m=async()=>{try{const E=[...(await Ee.get("/academic/subjects",{params:{academic_year:t}})).data].sort((O,F)=>O.subject_name.localeCompare(F.subject_name));n(E)}catch(_){console.error("Failed to load subjects:",_)}},g=async()=>{var _,E;if(a.trim())try{await Ee.post("/academic/subjects",{subject_name:a,subject_type:s,academic_year:t,is_active:!0}),i(""),o("Academic"),m()}catch(O){console.error("Failed to add subject:",O);const F=((E=(_=O.response)==null?void 0:_.data)==null?void 0:E.error)||O.message||"Failed to add subject. Please try again.";alert(F)}},x=async _=>{if(f.trim())try{await Ee.put(`/academic/subjects/${_}`,{subject_name:f,subject_type:p}),u(null),m()}catch(E){console.error("Failed to update subject:",E),alert("Failed to update subject. Please try again.")}},b=async(_,E)=>{try{await Ee.put(`/academic/subjects/${_}`,{is_active:!E}),m()}catch(O){console.error("Failed to update status:",O),alert("Failed to update status.")}},S=async _=>{var E,O;if(window.confirm("Are you sure you want to delete this subject?"))try{await Ee.delete(`/academic/subjects/${_}`),m()}catch(F){console.error("Failed to delete subject:",F);const M=((O=(E=F.response)==null?void 0:E.data)==null?void 0:O.error)||F.message||"Failed to delete subject. Please try again.";alert(M)}};return y.useEffect(()=>{m()},[t]),l.jsxs("div",{className:"bg-white border rounded-md p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-[#337ab7] mb-4 flex justify-between items-center",children:[l.jsx("span",{children:"Subject Master"}),l.jsxs("span",{className:"text-sm font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Scope: ",t]})]}),l.jsxs("div",{className:"flex gap-3 mb-6 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{value:a,onChange:_=>i(_.target.value),className:"border px-3 py-2 rounded w-64",placeholder:"Enter subject name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group"}),l.jsxs("select",{value:s,onChange:_=>o(_.target.value),className:"border px-3 py-2 rounded w-40",children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]})]}),l.jsx("button",{onClick:g,className:"px-4 py-2 bg-[#337ab7] text-white rounded hover:bg-[#286090] mb-[1px]",children:"Add Subject"})]}),l.jsxs("table",{className:"w-full text-sm border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border px-3 py-2 text-left",children:"Subject Name"}),l.jsx("th",{className:"border px-3 py-2 text-left",children:"Group"}),l.jsx("th",{className:"border px-3 py-2 text-center w-24",children:"Status"}),l.jsx("th",{className:"border px-3 py-2 text-left",children:"Actions"})]})}),l.jsx("tbody",{children:r.map(_=>l.jsxs("tr",{className:`border-t ${_.is_active?"":"bg-gray-50"}`,children:[l.jsx("td",{className:"border px-3 py-2",children:c===_.id?l.jsx("input",{value:f,onChange:E=>d(E.target.value),className:"border px-2 py-1 rounded w-full"}):l.jsx("span",{className:_.is_active?"":"text-gray-400",children:_.subject_name})}),l.jsx("td",{className:"border px-3 py-2",children:c===_.id?l.jsxs("select",{value:p,onChange:E=>h(E.target.value),className:"border px-2 py-1 rounded w-full",children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]}):l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${_.subject_type==="Hifz"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:_.subject_type||"Academic"})}),l.jsx("td",{className:"border px-3 py-2 text-center",children:l.jsx("button",{onClick:()=>b(_.id,_.is_active),className:`w-10 h-5 flex items-center rounded-full p-1 transition-colors ${_.is_active?"bg-green-500":"bg-gray-300"}`,title:_.is_active?"Click to Deactivate":"Click to Activate",children:l.jsx("div",{className:`bg-white w-3 h-3 rounded-full shadow-md transform transition-transform ${_.is_active?"translate-x-5":"translate-x-0"}`})})}),l.jsx("td",{className:"border px-3 py-2 flex gap-3",children:c===_.id?l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"text-green-600 hover:text-green-800",onClick:()=>x(_.id),children:"Save"}),l.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>u(null),children:"Cancel"})]}):l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"text-blue-600 hover:text-blue-800",onClick:()=>{u(_.id),d(_.subject_name),h(_.subject_type||"Academic")},children:"Edit"}),l.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:()=>S(_.id),children:"Delete"})]})})]},_.id))})]})]})},FF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState([]),[s,o]=y.useState([]),[c,u]=y.useState(""),[f,d]=y.useState(""),[p,h]=y.useState("Academic"),[m,g]=y.useState(new Set),[x,b]=y.useState(!1),[S,_]=y.useState(new Set),[E,O]=y.useState(!1),F=y.useRef(null);y.useEffect(()=>{function A(I){F.current&&!F.current.contains(I.target)&&O(!1)}return document.addEventListener("mousedown",A),()=>{document.removeEventListener("mousedown",A)}},[]),y.useEffect(()=>{(async()=>{try{const I=JSON.parse(localStorage.getItem("user")||"{}"),P=localStorage.getItem("academicYear");let L=localStorage.getItem("currentBranch");!L&&I.branch&&(L=I.branch);const R=await Ee.get("/classes"),G=R.data.classes||R.data||[];t(G.map(be=>({id:be.id,name:be.class_name})));const J=await Ee.get("/branches"),q=J.data.branches||J.data||[];let Q=Array.isArray(q)?q.map(be=>({id:be.id,name:be.branch_name,branch_name:be.branch_name,branch_code:be.branch_code,location_name:be.location_name||"Unknown Location"})):[];const fe=I.role==="Admin",V=Q.find(be=>be.name===L||be.branch_name===L||be.branch_code===L);fe?(i([{id:"All",name:"All Branches",branch_name:"All Branches",branch_code:"ALL",location_name:"Global"},...Q]),u(L==="All"||L==="All Branches"?"All":V?String(V.id):"All")):V?(i([V]),u(String(V.id))):(console.warn("User branch not found in branch list:",L),i(Q),Q.length>0&&u(String(Q[0].id)));const Oe=await Ee.get("/org/academic-years"),Te=Oe.data.academic_years||Oe.data||[];if(o(Te.map(be=>({id:be.id,name:be.name}))),P){const be=Te.find(re=>re.name.trim()===P.trim());be?d(be.id.toString()):Te.length>0&&d(Te[0].id.toString())}else Te.length>0&&d(Te[0].id.toString())}catch(I){console.error("Error loading metadata",I)}})()},[]),y.useEffect(()=>{const A=async()=>{if(!f){n([]);return}const I=s.find(L=>String(L.id)===String(f)),P=I?I.name:"";try{const L=await Ee.get("/academic/subjects",{params:{academic_year:P}});n(L.data.map(R=>({id:R.id,name:R.subject_name,type:R.subject_type||"Academic"})))}catch(L){console.error("Error loading subjects",L),n([])}};s.length>0&&A()},[f,s]),y.useEffect(()=>{const A=async()=>{if(!(!f||!c)){b(!0);try{const I=await Ee.get("/academic/assigned-subjects",{params:{academic_year_id:f,branch_id:c==="All"?void 0:c}}),P=new Set;I.data.forEach(L=>{const R=r.find(G=>G.name===L.subject_name);R&&P.add(`${L.class_id}-${R.id}`)}),g(P),U(new Set(P))}catch(I){console.error("Failed to fetch matrix data",I)}finally{b(!1)}}};r.length>0&&A()},[f,c,r]);const M=(A,I)=>{const P=`${A}-${I}`,L=new Set(m);L.has(P)?L.delete(P):L.add(P),g(L)},C=A=>{const I=new Set(m);let P=!0;for(const L of e)if(!I.has(`${L.id}-${A}`)){P=!1;break}e.forEach(L=>{const R=`${L.id}-${A}`;P?I.delete(R):I.add(R)}),g(I)},k=A=>{const I=new Set(m);let P=!0;for(const L of W)if(!I.has(`${A}-${L.id}`)){P=!1;break}W.forEach(L=>{const R=`${A}-${L.id}`;P?I.delete(R):I.add(R)}),g(I)},W=r.filter(A=>p==="All"||A.type===p),[D,j]=y.useState(!1),[H,U]=y.useState(new Set),Y=async()=>{if(!f||!c)return;j(!0);const A=[];if(m.forEach(I=>{if(!H.has(I)){const[P,L]=I.split("-");A.push({class_id:parseInt(P),subject_id:parseInt(L),action:"assign"})}}),H.forEach(I=>{if(!m.has(I)){const[P,L]=I.split("-");A.push({class_id:parseInt(P),subject_id:parseInt(L),action:"remove"})}}),A.length===0){alert("No changes to save."),j(!1);return}try{await Ee.post("/academic/manage-subject-assignment/bulk",{updates:A,academic_year_id:f,branch_id:c,location_id:1}),U(new Set(m)),alert("Assignments saved successfully!")}catch(I){console.error("Failed to save assignments",I);let P="Failed to save assignments. Please check the console for details.";I.response&&I.response.data&&((I.response.data.details&&Array.isArray(I.response.data.details)?I.response.data.details.filter(R=>R.includes("is assigned to students")):[]).length>0?P="Students assigned to this subject. Unable to unassign.":I.response.data.error&&(P=I.response.data.error)),alert(P),g(new Set(H))}finally{j(!1)}},X=A=>{const I=new Set(S);I.has(A)?I.delete(A):I.add(A),_(I)},Z=a.filter(A=>A.id!=="All"&&String(A.id)!==c),K={};Z.forEach(A=>{K[A.location_name]||(K[A.location_name]=[]),K[A.location_name].push(A)});const[z,se]=y.useState(!1),xe=async()=>{var A,I;if(S.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy assignments to ${S.size} branches?
(Merge Mode: Only missing assignments will be added)`)){se(!0);try{await Ee.post("/academic/copy-subject-assignments",{source_branch_id:c,target_branch_ids:Array.from(S),academic_year_id:f}),alert("Assignments copied successfully!"),_(new Set),O(!1)}catch(P){console.error("Copy failed",P),alert(((I=(A=P.response)==null?void 0:A.data)==null?void 0:I.error)||"Failed to copy assignments.")}finally{se(!1)}}};return l.jsx("div",{children:l.jsxs("div",{className:"bg-white p-6 rounded shadow border mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Class-Subject Assignment"}),l.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 items-end",children:[l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded bg-gray-50",value:f,disabled:!0,onChange:A=>d(A.target.value),children:[l.jsx("option",{value:"",children:"Select Year"}),s.map(A=>l.jsx("option",{value:A.id,children:A.name},A.id))]})]}),l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded bg-gray-50",value:c,disabled:!0,onChange:A=>u(A.target.value),children:[l.jsx("option",{value:"",children:"Select Branch"}),a.map(A=>l.jsx("option",{value:A.id,children:A.name},A.id))]})]}),l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Group"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:p,onChange:A=>h(A.target.value),children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"}),l.jsx("option",{value:"All",children:"All Types"})]})]})]}),l.jsx("div",{className:"overflow-x-auto border rounded",children:l.jsxs("table",{className:"w-full border-collapse text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 min-w-[150px] text-left",children:"Subjects \\ Classes"}),e.map(A=>l.jsx("th",{className:"border p-2 text-center min-w-[60px]",children:l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{children:A.name}),l.jsx("button",{onClick:()=>k(A.id),className:"text-[10px] bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-0.5 rounded",title:"Check/Uncheck all subjects for this class",children:"✓ All"})]})},A.id)),l.jsx("th",{className:"border p-2 text-center min-w-[80px]",children:"Action"})]})}),l.jsx("tbody",{children:x&&m.size===0?l.jsx("tr",{children:l.jsx("td",{colSpan:e.length+2,className:"p-4 text-center",children:"Loading Assignments..."})}):W.map(A=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2 font-medium bg-gray-50",children:A.name}),e.map(I=>{const P=`${I.id}-${A.id}`,L=m.has(P);return l.jsx("td",{className:"border p-1 text-center",children:l.jsx("div",{className:"flex justify-center items-center h-full",children:l.jsx("input",{type:"checkbox",checked:L,onChange:()=>M(I.id,A.id),className:"w-5 h-5 cursor-pointer accent-[#337ab7]"})})},I.id)}),l.jsx("td",{className:"border p-1 text-center",children:l.jsx("button",{onClick:()=>C(A.id),className:"text-xs bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded",title:"Toggle All Classes for this Subject",children:"Check/Uncheck All"})})]},A.id))})]})}),W.length===0&&l.jsx("div",{className:"p-4 text-center text-gray-500",children:"No subjects found for selected group."}),l.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[l.jsx("div",{children:c&&c!=="All"&&l.jsxs("div",{className:"relative",ref:F,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2",onClick:()=>O(!E),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),E&&l.jsxs("div",{className:"absolute left-full top-0 ml-2 w-72 bg-white border shadow-xl rounded z-20 max-h-80 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(K).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(K).map(A=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:A}),l.jsx("div",{className:"py-1",children:K[A].map(I=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:S.has(String(I.id)),onChange:()=>X(String(I.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:I.name})]},I.id))})]},A)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[S.size," selected"]}),l.jsx("button",{onClick:xe,disabled:z||S.size===0,className:`px-3 py-1 text-xs text-white rounded ${z||S.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:z?"Copying...":"Confirm Copy"})]})]})]})}),l.jsxs("div",{className:"flex gap-4 justify-end",children:[l.jsx("button",{onClick:()=>{g(new Set(H))},disabled:D,className:`px-6 py-2 rounded text-white-700 border transition hover:bg-gray-100 ${D?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:Y,disabled:D,className:`px-6 py-2 rounded text-white font-medium ${D?"bg-gray-400":"bg-[#337ab7] hover:bg-blue-600"}`,children:D?"Saving...":"Save Assignments"})]})]})]})})},IF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState(""),[f,d]=y.useState(!1),[p,h]=y.useState([]),[m,g]=y.useState([]),[x,b]=y.useState(new Map),[S,_]=y.useState(new Map),[E,O]=y.useState(!1),[F,M]=y.useState(!1),[C,k]=y.useState(new Set),[W,D]=y.useState(!1),j=y.useRef(null),[H,U]=y.useState(!1);y.useEffect(()=>{(async()=>{try{const R=JSON.parse(localStorage.getItem("user")||"{}"),G=localStorage.getItem("academicYear"),J=localStorage.getItem("currentBranch"),q=localStorage.getItem("currentLocation");J==="All Branches"||J==="All"||!J?d(!0):(d(!1),o(J),u(q||"Hyderabad"));const Q=await Ee.get("/org/academic-years"),fe=Q.data.academic_years||Q.data||[];if(t(fe.map(Te=>({id:Te.id,name:Te.name}))),G){const Te=fe.find(be=>be.name===G);Te?i(Te.name):fe.length>0&&i(fe[0].name)}else fe.length>0&&i(fe[0].name);const V=await Ee.get("/branches"),Oe=V.data.branches||V.data||[];n(Oe.map(Te=>({id:Te.id,name:Te.branch_name,location_name:Te.location_name||"Unknown"})))}catch(R){console.error("Error loading metadata",R)}})();function L(R){j.current&&!j.current.contains(R.target)&&D(!1)}return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]);const Y=async()=>{if(!(!a||!s||f)){O(!0);try{const P=await Ee.get("/class-tests/matrix",{params:{academic_year:a,branch:s}});h(P.data.classes),g(P.data.test_types);const L=new Map;P.data.assignments.forEach(G=>{L.set(`${G.class_id}-${G.test_id}`,G)}),b(L);const R=new Map;P.data.assignments.forEach(G=>{R.set(`${G.class_id}-${G.test_id}`,{...G})}),_(R)}catch(P){console.error("Error fetching matrix",P)}finally{O(!1)}}};y.useEffect(()=>{Y()},[a,s,f]);const X=(P,L)=>{let R=0;for(const[G,J]of L.entries())G.startsWith(`${P}-`)&&J.status&&J.test_order>R&&(R=J.test_order);return R+1},Z=(P,L,R)=>{const G=`${P}-${L}`,J=new Map(x);if(R){const q=J.get(G);if(q)J.set(G,{...q,status:!0});else{const Q=X(P,J);J.set(G,{class_id:P,test_id:L,test_order:Q,status:!0})}}else{const q=J.get(G);q&&J.set(G,{...q,status:!1})}b(J)},K=P=>{const L=new Map(x);let R=!0;for(const G of p){const J=`${G.id}-${P}`,q=L.get(J);if(!q||!q.status){R=!1;break}}p.forEach(G=>{const J=`${G.id}-${P}`;if(R){const q=L.get(J);q&&L.set(J,{...q,status:!1})}else{const q=L.get(J);if(q)q.status||L.set(J,{...q,status:!0});else{const Q=X(G.id,L);L.set(J,{class_id:G.id,test_id:P,test_order:Q,status:!0})}}}),b(L)},z=P=>{const L=new Map(x);let R=!0;for(const G of m){const J=`${P}-${G.id}`,q=L.get(J);if(!q||!q.status){R=!1;break}}m.forEach(G=>{const J=`${P}-${G.id}`;if(R){const q=L.get(J);q&&L.set(J,{...q,status:!1})}else{const q=L.get(J);if(q)q.status||L.set(J,{...q,status:!0});else{const Q=X(P,L);L.set(J,{class_id:P,test_id:G.id,test_order:Q,status:!0})}}}),b(L)},se=(P,L,R)=>{const G=`${P}-${L}`,J=new Map(x),q=J.get(G);q&&(J.set(G,{...q,test_order:R}),b(J))},xe=async()=>{var L,R;if(!a||!s)return;M(!0);const P=[];for(const G of p){const J=new Set;for(const q of m){const Q=`${G.id}-${q.id}`,fe=x.get(Q);if(fe&&fe.status){if(J.has(fe.test_order)){alert(`Duplicate order number ${fe.test_order} in Class ${G.name}. Please fix before saving.`),M(!1);return}J.add(fe.test_order)}}}x.forEach((G,J)=>{const q=S.get(J);let Q=!1;q?(q.status!==G.status||q.test_order!==G.test_order)&&(Q=!0):G.status&&(Q=!0),Q&&P.push(Ee.post("/class-tests/assign",{academic_year:a,branch:s,location:c,class_id:G.class_id,test_id:G.test_id,test_order:G.test_order,status:G.status}))});try{await Promise.all(P),alert("Assignments saved successfully"),Y()}catch(G){console.error("Save error",G),alert("Error saving: "+(((R=(L=G.response)==null?void 0:L.data)==null?void 0:R.error)||G.message))}finally{M(!1)}},A={};r.filter(P=>P.name!==s&&P.name!=="All Branches").forEach(P=>{A[P.location_name]||(A[P.location_name]=[]),A[P.location_name].push(P)});const I=async()=>{if(C.size===0)return alert("Select target branches");if(confirm(`Copy assignments to ${C.size} branches?`)){U(!0);try{for(const P of Array.from(C)){const[L,R]=P.split("|");await Ee.post("/class-tests/copy",{from_branch:s,to_branch:L,to_location:R,academic_year:a})}alert("Copy successful"),D(!1),k(new Set)}catch(P){alert("Copy failed: "+P.message)}finally{U(!1)}}};return f?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(SF,{className:"text-yellow-500 mr-2",size:24}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-yellow-700",children:'Cannot create tests in "All Branches" mode.'}),l.jsx("p",{className:"text-sm text-yellow-600",children:"Please select a specific branch from the header to create or modify assignments."})]})]})})}):l.jsxs("div",{className:"p-2 bg-white rounded shadow border",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Assign Tests to Classes"})}),l.jsxs("div",{className:"flex gap-4 mb-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Academic Year"}),l.jsx("div",{className:"border p-2 rounded bg-gray-100 min-w-[150px] text-gray-700",children:a||"Loading..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),l.jsx("div",{className:"border p-2 rounded bg-gray-100 min-w-[200px] text-gray-700",children:s||"Loading..."})]})]}),l.jsxs("div",{className:"border rounded overflow-x-auto mb-4",children:[l.jsxs("table",{className:"w-full text-sm text-left collapse-borders",children:[l.jsx("thead",{className:"bg-[#1a202c] text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-3 border-r border-gray-600 sticky left-0 z-10 bg-[#1a202c]",children:"Class"}),m.map(P=>l.jsxs("th",{className:"p-3 text-center border-r border-gray-600 min-w-[100px]",children:[l.jsx("div",{children:P.name}),l.jsx("input",{type:"checkbox",className:"mt-1 w-3 h-3 accent-blue-400 cursor-pointer",title:`Assign ${P.name} to all classes`,onClick:L=>{L.stopPropagation(),K(P.id)}})]},P.id)),l.jsx("th",{className:"p-3 text-center border-r border-gray-600 min-w-[50px] bg-[#1a202c]",children:"All"})]})}),l.jsx("tbody",{children:p.map(P=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-3 font-semibold text-gray-800 bg-gray-50 sticky left-0 border-r",children:P.name}),m.map(L=>{const R=`${P.id}-${L.id}`,G=x.get(R),J=(G==null?void 0:G.status)||!1,q=G==null?void 0:G.test_order;return l.jsx("td",{className:"p-2 border-r text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:J,onChange:Q=>Z(P.id,L.id,Q.target.checked),className:"w-4 h-4 accent-purple-600 cursor-pointer"}),J&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 text-xs mr-1",children:"("}),l.jsx("input",{type:"number",value:q||"",onChange:Q=>se(P.id,L.id,parseInt(Q.target.value)||0),className:"w-8 p-0.5 text-center border rounded text-xs no-spinner"}),l.jsx("span",{className:"text-gray-500 text-xs ml-1",children:")"})]})]})},L.id)}),l.jsx("td",{className:"p-2 border-r text-center",children:l.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600 cursor-pointer",title:`Assign all tests to ${P.name}`,onClick:L=>{L.stopPropagation(),z(P.id)}})})]},P.id))})]}),E&&l.jsx("div",{className:"p-4 text-center",children:"Loading..."}),!E&&p.length===0&&l.jsx("div",{className:"p-4 text-center",children:"No data. Please verify Academic Year and Branch selection."})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"relative",ref:j,children:[l.jsx("button",{onClick:()=>D(!W),className:"bg-purple-600 text-white px-4 py-2 rounded shadow hover:bg-purple-700 flex items-center gap-2",children:"Copy to Branches ▼"}),W&&l.jsxs("div",{className:"absolute left-full top-0 ml-2 w-72 bg-white border shadow-xl rounded z-20 max-h-80 overflow-y-auto",children:[l.jsx("div",{className:"p-2 border-b font-bold bg-gray-50",children:"Select Target Branches"}),Object.keys(A).map(P=>l.jsxs("div",{children:[l.jsx("div",{className:"bg-gray-100 px-3 py-1 text-xs font-bold text-gray-600 uppercase",children:P}),A[P].map(L=>{const R=`${L.name}|${L.location_name}`;return l.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-blue-50 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:C.has(R),onChange:()=>{const G=new Set(C);G.has(R)?G.delete(R):G.add(R),k(G)}}),l.jsx("span",{className:"text-sm",children:L.name})]},L.id)})]},P)),l.jsx("div",{className:"p-2 border-t flex justify-end",children:l.jsx("button",{onClick:I,disabled:H||C.size===0,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 disabled:opacity-50",children:H?"Copying...":"Confirm"})})]})]}),l.jsxs("div",{className:"flex gap-4 justify-end",children:[l.jsx("button",{onClick:()=>Y(),disabled:F,className:`px-6 py-2 rounded text-blue-700 border transition hover:bg-blue-100 ${F?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:xe,disabled:F,className:"bg-[#337ab7] text-white px-6 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50",children:F?"Saving...":"Save Test"})]})]})]})},LF=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState("Academic"),[f,d]=y.useState([]),[p,h]=y.useState([]),[m,g]=y.useState([]),[x,b]=y.useState([]),[S,_]=y.useState({}),[E,O]=y.useState(!1),[F,M]=y.useState(!1);y.useEffect(()=>{const X=localStorage.getItem("academicYear")||"",Z=localStorage.getItem("user");let K="All";if(Z)try{const z=JSON.parse(Z);if(z.role==="Admin"||z.branch==="All"||z.branch==="AllBranches"){const se=localStorage.getItem("currentBranch");se&&se!=="All"&&se!=="All Locations"&&(K=se)}else K=z.branch||"All"}catch(z){console.error("Error parsing user",z)}t(X),n(K),C()},[]);const C=async()=>{try{const X=await Ee.get("/classes");X.data&&X.data.classes&&d(X.data.classes)}catch(X){console.error("Failed to load classes",X)}};y.useEffect(()=>{o(""),h([]),a&&k(a)},[a]);const k=async X=>{try{const Z=await Ee.get(`/sections?class=${X}`);Z.data&&Z.data.sections&&h(Z.data.sections)}catch(Z){console.error("Failed to load sections",Z)}},W=async()=>{if(!(!a||!e||!r)){O(!0);try{const X=new URLSearchParams({class_id:a,academic_year:e,branch:r,subject_type:c});s&&X.append("section_id",s);const Z=await Ee.get(`/academics/assignment-data?${X.toString()}`),{students:K,subjects:z,overrides:se}=Z.data;g(K),b(z);const xe={};K.forEach(A=>{xe[A.student_id]={},z.forEach(I=>{const P=se[A.student_id];let L=!1;if(P&&P.hasOwnProperty(I.subject_id)){const R=P[I.subject_id];L=R===!0||R===1}xe[A.student_id][I.subject_id]=L})}),_(xe)}catch(X){console.error("Failed to fetch assignment data",X),alert("Error fetching data")}finally{O(!1)}}};y.useEffect(()=>{a&&W()},[a,s,c,e,r]);const D=(X,Z)=>{_(K=>({...K,[X]:{...K[X],[Z]:!K[X][Z]}}))},j=(X,Z)=>{_(K=>{const z={};return x.forEach(se=>{z[se.subject_id]=Z}),{...K,[X]:z}})},H=(X,Z)=>{_(K=>{const z={...K};return m.forEach(se=>{z[se.student_id]||(z[se.student_id]={}),z[se.student_id][X]=Z}),z})},U=X=>{_(Z=>{const K={};return m.forEach(z=>{K[z.student_id]={},x.forEach(se=>{K[z.student_id][se.subject_id]=X})}),K})},Y=async()=>{if(m.length){M(!0);try{const X=m.map(Z=>{const K=S[Z.student_id];return{student_id:Z.student_id,subjects:K}});await Ee.post("/academics/save-student-subjects",{academic_year:e,branch:r,class_id:a,data:X}),alert("Saved successfully!"),W()}catch(X){console.error("Save failed",X),alert("Failed to save assignments.")}finally{M(!1)}}};return l.jsxs("div",{className:"p-6 bg-white min-h-screen",children:[l.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Assign Student-Subjects"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm border",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Academic Year"}),l.jsx("div",{className:"px-3 py-2 bg-gray-200 rounded text-gray-700 font-medium",children:e})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Branch"}),l.jsx("div",{className:"px-3 py-2 bg-gray-200 rounded text-gray-700 font-medium whitespace-nowrap overflow-hidden text-ellipsis",children:r})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Class"}),l.jsxs("select",{className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-indigo-500 outline-none",value:a,onChange:X=>i(X.target.value),children:[l.jsx("option",{value:"",children:"Select Class"}),f.map(X=>l.jsx("option",{value:X.class_name,children:X.class_name},X.id))]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Section"}),l.jsxs("select",{className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-indigo-500 outline-none",value:s,onChange:X=>o(X.target.value),disabled:!a,children:[l.jsx("option",{value:"",children:"All Sections"}),p.map(X=>l.jsx("option",{value:X,children:X},X))]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Subject Type"}),l.jsxs("div",{className:"flex items-center space-x-4 h-full",children:[l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:"subjectType",className:"mr-2",value:"Academic",checked:c==="Academic",onChange:X=>u(X.target.value)}),"Academic"]}),l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:"subjectType",className:"mr-2",value:"Hifz",checked:c==="Hifz",onChange:X=>u(X.target.value)}),"Hifz"]})]})]})]}),E?l.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading data..."}):m.length===0?l.jsx("div",{className:"text-center py-10 text-gray-400 bg-gray-50 rounded border border-dashed",children:"No students found or no class selected."}):l.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:l.jsxs("table",{className:"min-w-full bg-white text-sm",children:[l.jsx("thead",{className:"bg-[#1f2937] text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"py-3 px-4 text-left w-16",children:"S.No"}),l.jsx("th",{className:"py-3 px-4 text-left w-48 sticky left-0 z-10 bg-[#1f2937]",children:"Student Name"}),l.jsx("th",{className:"py-3 px-4 text-left w-24",children:"Roll No"}),l.jsx("th",{className:"py-3 px-4 text-left w-32",children:"Adm No"}),x.map(X=>l.jsx("th",{className:"py-3 px-4 text-center min-w-[100px]",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("span",{children:X.subject_name}),l.jsx("input",{type:"checkbox",className:"w-4 h-4 text-indigo-600 rounded bg-gray-700 border-gray-500 focus:ring-indigo-500",onChange:Z=>H(X.subject_id,Z.target.checked),title:"Assign this subject to all shown students"})]})},X.subject_id)),l.jsx("th",{className:"py-3 px-4 text-center w-24",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("span",{children:"All"}),l.jsx("input",{type:"checkbox",className:"w-4 h-4 text-green-600 rounded bg-gray-700 border-gray-500 focus:ring-green-500",onChange:X=>U(X.target.checked),title:"Select/Deselect all checkboxes"})]})})]})}),l.jsx("tbody",{className:"text-gray-700",children:m.map((X,Z)=>l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${Z%2===0?"bg-white":"bg-gray-50"}`,children:[l.jsx("td",{className:"py-2 px-4",children:Z+1}),l.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 z-10 bg-inherit border-r",children:X.name}),l.jsx("td",{className:"py-2 px-4",children:X.roll_number}),l.jsx("td",{className:"py-2 px-4",children:X.admission_no}),x.map(K=>{var se;const z=((se=S[X.student_id])==null?void 0:se[K.subject_id])||!1;return l.jsx("td",{className:"py-2 px-4 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer",checked:z,onChange:()=>D(X.student_id,K.subject_id)})},K.subject_id)}),l.jsx("td",{className:"py-2 px-4 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 text-green-600 rounded focus:ring-green-500 cursor-pointer border-2 border-green-200",onChange:K=>j(X.student_id,K.target.checked),title:"Select/Deselect All"})})]},X.student_id))})]})}),m.length>0&&l.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[l.jsx("button",{onClick:()=>W(),disabled:F,className:`px-6 py-2 rounded text-gray-700 border transition hover:bg-gray-100 ${F?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:Y,disabled:F,className:`px-8 py-3 bg-indigo-600 text-white font-bold rounded shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all ${F?"opacity-50 cursor-not-allowed":""}`,children:F?"Saving...":"Save Assignments"})]})]})},DF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),[a,i]=y.useState(localStorage.getItem("academicYear")||""),[s,o]=y.useState(localStorage.getItem("currentBranch")||"All"),[c,u]=y.useState(localStorage.getItem("currentLocation")||"Hyderabad"),[f,d]=y.useState(!1),[p,h]=y.useState(null),[m,g]=y.useState({test_name:"",max_marks:50,display_order:void 0});y.useEffect(()=>{const O=JSON.parse(localStorage.getItem("user")||"{}");O.role!=="Admin"&&O.branch&&o(O.branch),O.location&&u(O.location)},[]),y.useEffect(()=>{(async()=>{const F=localStorage.getItem("academicYear");try{const C=(await Ee.get("/org/academic-years")).data.academic_years||[];if(F){const k=C.find(W=>W.name===F);k?i(k.name):C.length>0&&i(C[0].name)}else C.length>0&&i(C[0].name)}catch(M){console.error("Failed to fetch academic years",M)}})()},[]),y.useEffect(()=>{a&&x()},[a]);const x=async()=>{var O,F,M;n(!0);try{const C=await Ee.get("/test-types/",{params:{academic_year:a}});t(C.data)}catch(C){console.error("Failed to fetch test types",C);const k=((F=(O=C.response)==null?void 0:O.data)==null?void 0:F.error)||C.message||"Unknown error",W=(M=C.response)!=null&&M.status?` (${C.response.status})`:"";alert(`Failed to fetch test types${W}: ${k}. Check console for details.`)}finally{n(!1)}},b=async()=>{var O,F;try{const M={...m,academic_year:a};p?await Ee.put(`/test-types/${p}`,M):await Ee.post("/test-types/",M),d(!1),x()}catch(M){console.error("Save error:",M);const C=((F=(O=M.response)==null?void 0:O.data)==null?void 0:F.error)||M.message||"Failed to save";alert(`Error: ${C}`)}},S=async O=>{try{await Ee.patch(`/test-types/${O}/status`),x()}catch(F){console.error("Status update failed",F)}},_=()=>{g({test_name:"",max_marks:50,display_order:void 0}),h(null),d(!0)},E=O=>{g({test_name:O.test_name,max_marks:O.max_marks,display_order:O.display_order}),h(O.id),d(!0)};return l.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Create-TestType"}),l.jsxs("button",{onClick:_,disabled:!a,className:"flex items-center gap-2 bg-[#337ab7] text-white px-4 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50",children:[l.jsx(ij,{size:18})," Add Test Type"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 bg-white p-4 rounded shadow-sm border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 block mb-1",children:"Academic Year"}),l.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded text-gray-700 border min-w-[150px]",children:a})]}),l.jsx("div",{})]}),l.jsxs("div",{className:"bg-white rounded shadow text-sm",children:[l.jsxs("div",{className:"grid grid-cols-12 bg-gray-100 p-3 font-semibold text-gray-700 border-b",children:[l.jsx("div",{className:"col-span-1 text-center",children:"Order"}),l.jsx("div",{className:"col-span-5",children:"Test Name"}),l.jsx("div",{className:"col-span-3 text-center",children:"Max Marks (Ref)"}),l.jsx("div",{className:"col-span-2 text-center",children:"Status"}),l.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]}),r?l.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):e.length===0?l.jsx("div",{className:"p-8 text-center text-gray-500",children:"No test types found. Add one to get started."}):e.map((O,F)=>l.jsxs("div",{className:"grid grid-cols-12 p-3 border-b hover:bg-gray-50 items-center",children:[l.jsx("div",{className:"col-span-1 text-center font-mono bg-gray-100 rounded mx-2 py-1",children:O.display_order??F+1}),l.jsx("div",{className:"col-span-5 font-medium text-gray-800",children:O.test_name}),l.jsx("div",{className:"col-span-3 text-center text-gray-600",children:O.max_marks}),l.jsx("div",{className:"col-span-2 flex justify-center",children:l.jsxs("button",{onClick:()=>S(O.id),className:`flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${O.is_active?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"}`,children:[O.is_active?l.jsx(PF,{size:16}):l.jsx(TF,{size:16}),O.is_active?"Active":"Inactive"]})}),l.jsx("div",{className:"col-span-1 flex justify-center gap-2",children:l.jsx("button",{onClick:()=>E(O),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:l.jsx(EF,{size:16})})})]},O.id))]}),f&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:p?"Edit Test Type":"Add Test Type"}),l.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-red-500",children:l.jsx(sj,{size:20})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name *"}),l.jsx("input",{type:"text",value:m.test_name,onChange:O=>g({...m,test_name:O.target.value}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Unit Test 1",autoFocus:!0})]}),l.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Marks (Ref) *"}),l.jsx("input",{type:"number",value:m.max_marks,onChange:O=>g({...m,max_marks:parseInt(O.target.value)||0}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none"})]})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),l.jsx("input",{type:"number",value:m.display_order??"",onChange:O=>g({...m,display_order:O.target.value?parseInt(O.target.value):void 0}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Auto"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty for auto-increment"})]}),l.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded border",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Context:"})," ",a," (Global)"]})})]}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3 pt-4 border-t",children:[l.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded",children:"Cancel"}),l.jsxs("button",{onClick:b,disabled:!m.test_name,className:"px-4 py-2 bg-[#337ab7] text-white rounded hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50",children:[l.jsx(xu,{size:16})," Save"]})]})]})})]})};function MF({isOpen:e,onClose:t,sourceClassTestId:r,currentAcademicYear:n,currentBranch:a,currentClass:i,currentTest:s}){const[o,c]=y.useState("test_to_test"),[u,f]=y.useState([]),[d,p]=y.useState([]),[h,m]=y.useState(!1),[g,x]=y.useState(!1);y.useEffect(()=>{e&&(b(),p([]))},[e,o]);const b=async()=>{m(!0);try{let E=[];o==="test_to_test"?E=(await Ee.get("/test-types",{params:{academic_year:n}})).data.filter(F=>String(F.id)!==String(s)).map(F=>({id:F.id,label:F.test_name})):o==="class_to_class"?E=(await Ee.get("/classes",{headers:{"X-Academic-Year":n}})).data.classes.filter(F=>String(F.id)!==String(i)).map(F=>({id:F.id,label:F.class_name})):o==="branch_to_branch"&&(E=(await Ee.get("/branches")).data.branches.filter(F=>String(F.id)!==String(a)).map(F=>({id:F.id,label:F.branch_name}))),f(E)}catch(E){console.error("Failed to fetch copy targets",E),alert("Failed to load target options")}finally{m(!1)}},S=E=>{p(O=>O.includes(E)?O.filter(F=>F!==E):[...O,E])},_=async()=>{var E,O;if(r){if(d.length===0){alert("Please select at least one target.");return}if(confirm(`Are you sure you want to copy assignments to ${d.length} targets? Existing assignments will be overwritten.`)){x(!0);try{await Ee.post("/class-test-subjects/copy",{source_class_test_id:r,copy_mode:o,target_ids:d,current_academic_year:n,current_branch:a,current_class:i,current_test:s}),alert("Copy successful!"),t()}catch(F){alert(((O=(E=F.response)==null?void 0:E.data)==null?void 0:O.error)||"Copy failed")}finally{x(!1)}}}};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded p-6 w-[500px] max-h-[80vh] flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-xl font-bold",children:"Copy Assignments"}),l.jsx("button",{onClick:t,className:"text-gray-500 text-xl font-bold",children:"×"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium mb-1",children:"Copy Mode"}),l.jsxs("select",{className:"border p-2 rounded w-full",value:o,onChange:E=>c(E.target.value),children:[l.jsx("option",{value:"test_to_test",children:"Test to Test (Same Class/Branch)"}),l.jsx("option",{value:"class_to_class",children:"Class to Class (Same Test/Branch)"}),l.jsx("option",{value:"branch_to_branch",children:"Branch to Branch (Same Test/Class)"})]})]}),l.jsx("div",{className:"flex-1 overflow-auto border p-2 rounded mb-4",children:h?l.jsx("p",{children:"Loading targets..."}):u.length===0?l.jsx("p",{className:"text-gray-500",children:"No targets found."}):l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b",children:[l.jsx("input",{type:"checkbox",checked:d.length===u.length,onChange:E=>{E.target.checked?p(u.map(O=>O.id)):p([])}}),l.jsx("span",{className:"font-semibold",children:"Select All"})]}),u.map(E=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:d.includes(E.id),onChange:()=>S(E.id)}),l.jsx("span",{children:E.label})]},E.id))]})}),l.jsxs("div",{className:"flex justify-end space-x-2",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 border rounded hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{onClick:_,disabled:g||d.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:g?"Copying...":"Copy"})]})]})}):null}function RF(){const[e,t]=y.useState({academic_year_id:localStorage.getItem("academicYear")||"",branch_id:localStorage.getItem("currentBranch")||"",class_id:"",test_id:"",subject_type:""}),[r,n]=y.useState([]),[a,i]=y.useState([]),[s,o]=y.useState([]),[c,u]=y.useState([]),[f,d]=y.useState([]),[p,h]=y.useState(null),[m,g]=y.useState(0),[x,b]=y.useState(!1),[S,_]=y.useState(!1),[E,O]=y.useState(!1);y.useEffect(()=>{F()},[]),y.useEffect(()=>{e.academic_year_id&&e.branch_id&&e.class_id&&e.test_id?C():(d([]),h(null))},[e]);const F=async()=>{try{const[j,H,U]=await Promise.all([Ee.get("/org/academic-years"),Ee.get("/branches"),Ee.get("/classes")]);n(j.data.academic_years.map(Y=>({id:Y.id,name:Y.name}))),i(H.data.branches.map(Y=>({id:Y.id,name:Y.branch_name}))),o(U.data.classes.map(Y=>({id:Y.id,name:Y.class_name})))}catch(j){console.error("Error loading dropdowns",j)}};y.useEffect(()=>{e.academic_year_id&&e.branch_id&&e.class_id?M():u([])},[e.academic_year_id,e.branch_id,e.class_id]);const M=async()=>{try{const j=await Ee.get("/class-tests/list",{params:{academic_year:e.academic_year_id,branch:e.branch_id,class_id:e.class_id}});u(j.data.map(H=>({id:H.test_id,name:H.test_name})))}catch(j){console.error("Error loading tests",j),u([])}},C=async()=>{var j,H;b(!0);try{const U=await Ee.get("/class-test-subjects/",{params:e});d(U.data.subjects),h(U.data.class_test_id),g(U.data.test_max_marks||0)}catch(U){console.error(U),alert(((H=(j=U.response)==null?void 0:j.data)==null?void 0:H.error)||"Failed to load subjects")}finally{b(!1)}},k=async()=>{var X,Z;if(!e.academic_year_id||!e.branch_id||!e.class_id||!e.test_id){alert("Please select all filters first.");return}const j=f.filter(K=>K.assigned),H=j.reduce((K,z)=>K+(z.max_marks||0),0);if(H>m){alert(`Total Subject Marks (${H}) cannot exceed Test Max Marks (${m})`);return}const U=j.map(K=>K.subject_order).filter(K=>K!==null);if(new Set(U).size!==U.length){alert("Subject Orders must be unique");return}_(!0);const Y={class_test_id:p,context:e,subjects:j.map(K=>({subject_id:K.subject_id,max_marks:K.max_marks,subject_order:K.subject_order}))};try{const K=await Ee.post("/class-test-subjects/",Y);alert("Assignments saved successfully"),K.data.class_test_id&&h(K.data.class_test_id)}catch(K){alert(((Z=(X=K.response)==null?void 0:X.data)==null?void 0:Z.error)||"Save failed")}finally{_(!1)}},W=(j,H,U)=>{const Y=[...f];Y[j]={...Y[j],[H]:U},H==="assigned"&&!U&&(Y[j].max_marks=null,Y[j].subject_order=null),(H==="max_marks"||H==="subject_order")&&U&&(Y[j].assigned=!0),d(Y)},D=()=>f.filter(j=>j.assigned).reduce((j,H)=>j+(H.max_marks||0),0);return l.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md min-h-screen",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Assign Subjects to Test"}),p&&l.jsxs("button",{onClick:()=>O(!0),className:"flex items-center space-x-2 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition",children:[l.jsx(kF,{size:16})," ",l.jsx("span",{children:"Copy Structure"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 bg-gray-50 p-4 rounded border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.academic_year_id,disabled:!0,onChange:j=>t({...e,academic_year_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Year"}),r.map(j=>l.jsx("option",{value:j.name,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.branch_id,disabled:!0,onChange:j=>t({...e,branch_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Branch"}),a.map(j=>l.jsx("option",{value:j.name,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Class"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.class_id,onChange:j=>t({...e,class_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Class"}),s.map(j=>l.jsx("option",{value:j.id,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Test"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.test_id,onChange:j=>t({...e,test_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Test"}),c.map(j=>l.jsx("option",{value:j.id,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Subject Type"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.subject_type,onChange:j=>t({...e,subject_type:j.target.value}),children:[l.jsx("option",{value:"",children:"All Types"}),l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]})]})]}),x?l.jsx("div",{className:"text-center py-10",children:"Loading Matrix..."}):p?l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[l.jsxs("div",{className:"text-sm",children:["Test Max Marks: ",l.jsx("span",{className:"font-bold",children:m})]}),l.jsxs("div",{className:`text-sm ${D()>m?"text-red-600 font-bold":"text-green-600"}`,children:["Total Assigned: ",D()]})]}),l.jsx("div",{className:"overflow-x-auto border rounded shadow-sm",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"Subject Name"}),l.jsx("th",{className:"px-4 py-3",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-center",children:"Assigned"}),l.jsx("th",{className:"px-4 py-3 w-32",children:"Max Marks"}),l.jsx("th",{className:"px-4 py-3 w-32",children:"Order"})]})}),l.jsx("tbody",{className:"divide-y",children:f.map((j,H)=>l.jsxs("tr",{className:`hover:bg-gray-50 ${j.assigned?"bg-blue-50":""}`,children:[l.jsx("td",{className:"px-4 py-2 font-medium",children:j.subject_name}),l.jsx("td",{className:"px-4 py-2 text-gray-500",children:j.subject_type}),l.jsx("td",{className:"px-4 py-2 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-blue-600",checked:j.assigned,onChange:U=>W(H,"assigned",U.target.checked)})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",className:`w-full border rounded p-1 ${j.assigned?"":"bg-gray-100"}`,disabled:!j.assigned,value:j.max_marks??"",onChange:U=>W(H,"max_marks",Number(U.target.value))})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",className:`w-full border rounded p-1 ${j.assigned?"":"bg-gray-100"}`,disabled:!j.assigned,value:j.subject_order??"",onChange:U=>W(H,"subject_order",Number(U.target.value))})})]},j.subject_id))})]})}),l.jsxs("div",{className:"mt-6 flex justify-end",children:[l.jsx("button",{onClick:()=>C(),disabled:S,className:"bg-gray-200 text-gray-700 px-8 py-3 rounded shadow hover:bg-gray-300 flex items-center space-x-2",children:"Cancel"}),l.jsxs("button",{onClick:k,disabled:S,className:"bg-blue-600 text-white px-8 py-3 rounded shadow hover:bg-blue-700 flex items-center space-x-2",children:[l.jsx(xu,{size:16})," ",l.jsx("span",{children:S?"Saving...":"Save Assignments"})]})]})]}):l.jsx("div",{className:"text-center py-10 text-gray-500 italic",children:"Select filters to view assignment matrix"}),l.jsx(MF,{isOpen:E,onClose:()=>O(!1),sourceClassTestId:p,currentAcademicYear:e.academic_year_id,currentBranch:e.branch_id,currentClass:e.class_id,currentTest:e.test_id})]})}function BF(){const e=()=>{const k=localStorage.getItem("currentBranch");if(k&&k!=="undefined")return k;const W=localStorage.getItem("user");if(W)try{const D=JSON.parse(W);if(D.branch&&D.branch!=="All")return D.branch}catch(D){console.error("Error parsing user from localStorage",D)}return""},[t,r]=y.useState({academic_year_id:localStorage.getItem("academicYear")||"",branch_id:e(),class_id:""}),[n,a]=y.useState([]),[i,s]=y.useState([]),[o,c]=y.useState({}),[u,f]=y.useState({years:[],branches:[],classes:[]}),[d,p]=y.useState(!1),[h,m]=y.useState(!1),[g,x]=y.useState(""),[b,S]=y.useState([]);y.useEffect(()=>{_()},[]),y.useEffect(()=>{t.academic_year_id&&t.branch_id&&t.class_id?E():(s([]),a([]),c({}))},[t]);const _=async()=>{try{const[k,W,D]=await Promise.all([Ee.get("/org/academic-years"),Ee.get("/branches"),Ee.get("/classes")]);f({years:k.data.academic_years,branches:W.data.branches,classes:D.data.classes})}catch(k){console.error("Failed to load dropdowns",k)}},E=async()=>{var k,W;p(!0),x(""),S([]);try{const D=await Ee.get("/student-test-assignments",{params:t});a(D.data.columns),s(D.data.rows),c(D.data.assignments)}catch(D){console.error(D),x(((W=(k=D.response)==null?void 0:k.data)==null?void 0:W.error)||"Failed to load data")}finally{p(!1)}},O=async()=>{var k,W;if(b.length===0){alert("No changes to save");return}m(!0);try{await Ee.post("/student-test-assignments",{...t,updates:b}),alert("Saved successfully!"),E()}catch(D){console.error(D),alert("Failed to save: "+(((W=(k=D.response)==null?void 0:k.data)==null?void 0:W.error)||"Unknown error"))}finally{m(!1)}},F=(k,W)=>{var D;return((D=o[k])==null?void 0:D.includes(W))||!1},M=(k,W,D)=>{c(j=>{const H=j[k]||[];return D?{...j,[k]:[...H,W]}:{...j,[k]:H.filter(U=>U!==W)}}),S(j=>[...j.filter(U=>!(U.student_id===k&&U.class_test_id===W)),{student_id:k,class_test_id:W,status:D}])},C=(k,W)=>{const D=[],j={...o};i.forEach(H=>{var Y;((Y=j[H.student_id])==null?void 0:Y.includes(k))!==W&&(W?j[H.student_id]=[...j[H.student_id]||[],k]:j[H.student_id]=(j[H.student_id]||[]).filter(X=>X!==k),D.push({student_id:H.student_id,class_test_id:k,status:W}))}),c(j),S(H=>[...H.filter(Y=>Y.class_test_id!==k),...D])};return l.jsxs("div",{className:"p-4 bg-white rounded shadow min-h-screen flex flex-col",children:[l.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Assign Test to Students"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 bg-gray-50 p-4 rounded border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.academic_year_id,disabled:!0,onChange:k=>r({...t,academic_year_id:k.target.value}),children:[l.jsx("option",{value:"",children:"Select Year"}),u.years.map(k=>l.jsx("option",{value:k.name,children:k.name},k.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.branch_id,disabled:!0,onChange:k=>r({...t,branch_id:k.target.value}),children:[l.jsx("option",{value:"",children:"Select Branch"}),u.branches.map(k=>l.jsx("option",{value:k.branch_name,children:k.branch_name},k.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Class"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.class_id,onChange:k=>r({...t,class_id:k.target.value}),children:[l.jsx("option",{value:"",children:"Select Class"}),u.classes.map(k=>l.jsx("option",{value:k.id,children:k.class_name},k.id))]})]})]}),d&&l.jsx("div",{className:"text-center py-10",children:"Loading Data..."}),g&&l.jsx("div",{className:"text-center py-10 text-red-600",children:g}),!d&&!g&&i.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto border rounded shadow-sm flex-1",children:l.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 border w-12 text-center",children:"S.No"}),l.jsx("th",{className:"px-3 py-2 border",children:"Student Name"}),l.jsx("th",{className:"px-3 py-2 border",children:"Sec"}),l.jsx("th",{className:"px-3 py-2 border w-24",children:"Roll"}),l.jsx("th",{className:"px-3 py-2 border w-24",children:"Adm No"}),n.map(k=>l.jsx("th",{className:"px-3 py-2 border text-center min-w-[100px]",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{className:"mb-1",children:k.test_name}),l.jsx("input",{type:"checkbox",title:"Select All",onChange:W=>C(k.class_test_id,W.target.checked)})]})},k.class_test_id))]})}),l.jsx("tbody",{children:i.map((k,W)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 border text-center",children:W+1}),l.jsx("td",{className:"px-3 py-2 border font-medium",children:k.name}),l.jsx("td",{className:"px-3 py-2 border text-center",children:k.section}),l.jsx("td",{className:"px-3 py-2 border",children:k.roll_number}),l.jsx("td",{className:"px-3 py-2 border",children:k.admission_no}),n.map(D=>l.jsx("td",{className:"px-3 py-2 border text-center",children:l.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:F(k.student_id,D.class_test_id),onChange:j=>M(k.student_id,D.class_test_id,j.target.checked)})},D.class_test_id))]},k.student_id))})]})}),l.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[l.jsx("button",{onClick:()=>E(),disabled:h||b.length===0,className:`px-6 py-2 rounded text-gray-700 border transition hover:bg-gray-100
                                ${h||b.length===0?"opacity-50 cursor-not-allowed":""}
                            `,children:"Cancel"}),l.jsxs("button",{onClick:O,disabled:h||b.length===0,className:`flex items-center space-x-2 px-6 py-2 rounded text-white transition
                                ${h||b.length===0?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 shadow"}
                            `,children:[l.jsx(xu,{size:18}),l.jsx("span",{children:h?"Saving...":"Save Assignments"})]})]})]}),!d&&!g&&i.length===0&&t.class_id&&l.jsx("div",{className:"text-center py-10 text-gray-500",children:"No students found or data not loaded. Check filters."})]})}const UF=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState("Hyderabad"),[s,o]=y.useState([]),[c,u]=y.useState([]),[f,d]=y.useState([]),[p,h]=y.useState(!1),[m,g]=y.useState(null),[x,b]=y.useState(""),[S,_]=y.useState(100),[E,O]=y.useState(""),[F,M]=y.useState([]),[C,k]=y.useState(null),[W,D]=y.useState(null),[j,H]=y.useState(null),[U,Y]=y.useState(null);y.useEffect(()=>{(async()=>{try{const J=JSON.parse(localStorage.getItem("user")||"{}"),q=localStorage.getItem("academicYear"),Q=localStorage.getItem("currentBranch")||J.branch,V=(await Ee.get("/org/academic-years")).data.academic_years||[];if(o(V),q){const be=V.find(re=>re.name===q||String(re.id)===q);t(be?be.name:q)}else V.length>0&&t(V[0].name);const Te=(await Ee.get("/branches")).data.branches||[];if(u(Te),Q){const be=Te.find(re=>re.branch_name===Q||String(re.id)===Q);be?(n(be.branch_name),i(be.location_name||"Hyderabad")):n(Q)}else Te.length>0&&n(Te[0].branch_name)}catch(J){console.error("Failed to load context",J)}})()},[]),y.useEffect(()=>{!e||!r||X()},[e,r]);const X=async()=>{h(!0);try{const G=await Ee.get("/grade-scales",{params:{academic_year:e,branch:r,location:a}});d(G.data)}catch(G){console.error("Failed to fetch scales",G)}finally{h(!1)}},Z=async G=>{h(!0),H(null),k(null),D(null);try{const q=(await Ee.get(`/grade-scales/${G}`)).data;g(q.id),b(q.scale_name),_(q.total_marks||100),O(q.scale_description||""),M(q.details||[])}catch(J){console.error("Failed to load scale details",J),H("Failed to load scale details")}finally{h(!1)}},K=()=>{g(null),g(null),b(""),_(100),O(""),M([]),H(null),Y(null),k(null),D(null)},z=()=>{const G={grade:"",min_marks:0,max_marks:0,description:""},J=[...F,G];M(J),k(J.length-1),D(G)},se=G=>{k(G),D({...F[G]})},xe=()=>{k(null),D(null)},A=()=>{if(C===null||!W)return;if(!W.grade.trim()){alert("Grade cannot be empty");return}if(Number(W.min_marks)>Number(W.max_marks)){alert("Min marks cannot be greater than Max marks");return}if(Number(W.max_marks)>Number(S)){alert(`Max marks cannot exceed Total Marks (${S})`);return}const G=[...F];G[C]=W,M(G),k(null),D(null)},I=(G,J)=>{W&&D({...W,[G]:J})},P=G=>{C===G&&xe();const J=[...F];J.splice(G,1),M(J),C!==null&&C>G&&k(C-1)},L=async()=>{var q,Q;if(!x.trim()){H("Scale Name is required");return}if(!e||!r){H("Context (Academic Year/Branch) is missing");return}if(C!==null){H("Please save or cancel the currently editing row first.");return}for(const fe of F){if(!fe.grade.trim()){H("All rows must have a Grade defined");return}if(fe.min_marks<0||fe.max_marks<0){H("Marks cannot be negative");return}if(Number(fe.min_marks)>Number(fe.max_marks)){H(`Min marks cannot be greater than Max marks for grade ${fe.grade}`);return}if(Number(fe.max_marks)>Number(S)){H(`Max marks for grade ${fe.grade} cannot exceed Total Marks (${S})`);return}}const G=[...F].sort((fe,V)=>Number(fe.min_marks)-Number(V.min_marks));for(let fe=0;fe<G.length-1;fe++)if(Number(G[fe].max_marks)>=Number(G[fe+1].min_marks)){H(`Overlapping range detected between ${G[fe].grade} and ${G[fe+1].grade}`);return}h(!0),H(null),Y(null);const J={scale_name:x,scale_description:E,location:a,branch:r,academic_year:e,total_marks:S,details:F};try{m?(await Ee.put(`/grade-scales/${m}`,J),Y("Grade Scale updated successfully")):(await Ee.post("/grade-scales",J),Y("Grade Scale created successfully"),K()),X()}catch(fe){console.error("Save failed",fe),H(((Q=(q=fe.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to save Grade Scale")}finally{h(!1)}},R=async G=>{var J,q;if(confirm("Are you sure you want to delete this Grade Scale?")){h(!0);try{await Ee.delete(`/grade-scales/${G}`),Y("Grade Scale deleted successfully"),m===G&&K(),X()}catch(Q){console.error("Delete failed",Q),H(((q=(J=Q.response)==null?void 0:J.data)==null?void 0:q.error)||"Failed to delete Grade Scale")}finally{h(!1)}}};return l.jsxs("div",{className:"flex flex-col gap-6 h-full",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 flex justify-between items-center text-sm text-blue-800",children:[l.jsxs("div",{className:"flex gap-6",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Academic Year:"})," ",e||"Loading..."]}),l.jsxs("span",{children:[l.jsx("strong",{children:"User Branch:"})," ",r||"Loading..."]}),l.jsxs("span",{className:"bg-blue-200 px-2 py-0.5 rounded text-blue-900 font-bold",children:["Scope: ",a," (All Branches)"]})]}),l.jsx("div",{children:!e||!r?l.jsx("span",{className:"text-red-500 font-bold",children:"Context Missing! Check Header."}):null})]}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start h-full",children:[l.jsxs("div",{className:"w-full md:w-1/3 flex flex-col gap-6",children:[l.jsxs("div",{className:"bg-white p-5 rounded shadow border",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h3",{className:"font-semibold text-gray-700 flex items-center gap-2",children:"Grade Scale Master"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Scale Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Enter Scale Name",value:x,onChange:G=>b(G.target.value)})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Total Marks ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. 100",value:S,onChange:G=>_(Number(G.target.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scale Description"}),l.jsx("textarea",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none h-20 resize-none",placeholder:"Enter Description",value:E,onChange:G=>O(G.target.value)})]}),j&&l.jsxs("div",{className:"p-2 bg-red-50 text-red-600 text-sm rounded flex items-center gap-2",children:[l.jsx(Oh,{size:14})," ",j]}),U&&l.jsx("div",{className:"p-2 bg-green-50 text-green-600 text-sm rounded",children:U}),l.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[l.jsxs("button",{onClick:L,disabled:p,className:"bg-[#337ab7] text-white px-4 py-2 rounded text-sm font-medium hover:bg-blue-600 flex items-center gap-2",children:[l.jsx(xu,{size:16})," ",m?"Update":"Save"]}),l.jsxs("button",{onClick:K,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded text-sm font-medium hover:bg-gray-200 border flex items-center gap-2",children:[l.jsx(CF,{size:16})," Reset"]})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded shadow border flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-4 pb-2 border-b",children:"Grade Scale List"}),l.jsx("div",{className:"overflow-auto max-h-[400px]",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"Scale Name"}),l.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),l.jsx("tbody",{children:f.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:2,className:"p-4 text-center text-gray-500",children:"No scales found."})}):f.map(G=>l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${m===G.id?"bg-blue-50":""}`,children:[l.jsx("td",{className:"p-2 font-medium",children:G.scale_name}),l.jsxs("td",{className:"p-2 flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>Z(G.id),className:"p-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit",children:l.jsx(l5,{size:14})}),l.jsx("button",{onClick:()=>R(G.id),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Delete",children:l.jsx(c5,{size:14})})]})]},G.id))})]})})]})]}),l.jsx("div",{className:"w-full md:w-2/3",children:l.jsxs("div",{className:"bg-white p-5 rounded shadow border min-h-[500px]",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-700 flex items-center gap-2",children:[l.jsx("span",{className:"w-2 h-6 bg-gray-600 rounded-sm"}),m?x:"Grade Scale Details",m&&l.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-2",children:["(Total Marks: ",S,")"]})]}),l.jsx("div",{className:"flex gap-2",children:l.jsx("button",{onClick:z,className:`p-1 text-white rounded ${m?"bg-purple-600 hover:bg-purple-700":"bg-gray-400 cursor-not-allowed"}`,title:m?"Add Row":"Select a scale to add rows",disabled:!m,children:l.jsx(ij,{size:20})})})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600 uppercase text-xs",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-3 text-center w-16",children:"S.No"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Grade"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Min"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Maximum"}),l.jsx("th",{className:"p-3 text-left",children:"Description"}),l.jsx("th",{className:"p-3 text-center w-20",children:"Action"})]})}),l.jsx("tbody",{children:F.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:m?"No grades added yet. Click + to add.":"Please select/edit a Grade Scale from the list to manage details."})}):F.map((G,J)=>{const q=C===J,Q=q&&W?W:G;return l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${q?"bg-blue-50":""}`,children:[l.jsx("td",{className:"p-2 text-center text-gray-500",children:J+1}),l.jsx("td",{className:"p-2 text-center",children:q?l.jsx("input",{type:"text",className:"border p-1 rounded w-16 text-center uppercase focus:ring-2 focus:ring-blue-500 outline-none",value:Q.grade,onChange:fe=>I("grade",fe.target.value),placeholder:"A1"}):l.jsx("span",{className:"font-medium text-gray-700",children:G.grade})}),l.jsx("td",{className:"p-2 text-center",children:q?l.jsx("input",{type:"number",className:"border p-1 rounded w-20 text-center focus:ring-2 focus:ring-blue-500 outline-none",value:Q.min_marks,onChange:fe=>I("min_marks",fe.target.value)}):l.jsx("span",{className:"text-gray-600",children:G.min_marks})}),l.jsx("td",{className:"p-2 text-center",children:q?l.jsx("input",{type:"number",className:"border p-1 rounded w-20 text-center focus:ring-2 focus:ring-blue-500 outline-none",value:Q.max_marks,onChange:fe=>I("max_marks",fe.target.value)}):l.jsx("span",{className:"text-gray-600",children:G.max_marks})}),l.jsx("td",{className:"p-2 text-left",children:q?l.jsx("input",{type:"text",className:"border p-1 rounded w-full text-left focus:ring-2 focus:ring-blue-500 outline-none",value:Q.description||"",onChange:fe=>I("description",fe.target.value),placeholder:"Grade Description"}):l.jsx("span",{className:"text-gray-600",children:G.description})}),l.jsx("td",{className:"p-2 text-center flex justify-center gap-2",children:q?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:A,className:"p-1 bg-green-500 text-white rounded hover:bg-green-600",title:"Save Changes",children:l.jsx(AF,{size:16})}),l.jsx("button",{onClick:xe,className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Cancel Changes",children:l.jsx(sj,{size:16})})]}):l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>se(J),className:"p-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit Row",children:l.jsx(l5,{size:14})}),l.jsx("button",{onClick:()=>P(J),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Remove Row",children:l.jsx(c5,{size:14})})]})})]},J)})})]})})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Fh={};Fh.version="0.18.5";var oj=1252,zF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],F2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},I2=function(e){zF.indexOf(e)!=-1&&(oj=F2[0]=e)};function $F(){I2(1252)}var Xi=function(e){I2(e)};function L2(){Xi(1200),$F()}function f5(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function WF(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function lj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Sf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?WF(e.slice(2)):t==254&&r==255?lj(e.slice(2)):t==65279?e.slice(1):e},R0=function(t){return String.fromCharCode(t)},d5=function(t){return String.fromCharCode(t)},Bf,Uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Uf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Uo.charAt(i)+Uo.charAt(s)+Uo.charAt(o)+Uo.charAt(c);return t}function oi(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Uo.indexOf(e.charAt(u++)),s=Uo.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Uo.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Uo.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Gt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),co=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function qo(e){return Gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function h5(e){return Gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ti=function(t){return Gt?co(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qp(e){if(typeof ArrayBuffer>"u")return ti(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function rl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function HF(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function D2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return D2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var zn=Gt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:co(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function qF(e){for(var t=[],r=0,n=e.length+250,a=qo(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=qo(65535),n=65530)}return t.push(a.slice(0,r)),zn(t)}var Ca=/\u0000/g,_f=/[\u0001-\u0006]/g;function Kc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ji(e,t){var r=""+e;return r.length>=t?r:Yr("0",t-r.length)+r}function M2(e,t){var r=""+e;return r.length>=t?r:Yr(" ",t-r.length)+r}function Ih(e,t){var r=""+e;return r.length>=t?r:r+Yr(" ",t-r.length)}function GF(e,t){var r=""+Math.round(e);return r.length>=t?r:Yr("0",t-r.length)+r}function VF(e,t){var r=""+e;return r.length>=t?r:Yr("0",t-r.length)+r}var p5=Math.pow(2,32);function Oc(e,t){if(e>p5||e<-p5)return GF(e,t);var r=Math.round(e);return VF(r,t)}function Lh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var m5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Dg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YF(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},g5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*s+i,f=d*u+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=i):(f=u,o=s)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function Al(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=t7(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var cj=new Date(1899,11,31,0,0,0),XF=cj.getTime(),JF=new Date(1900,2,1,0,0,0);function uj(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=JF&&(r+=1440*60*1e3),(r-(XF+(e.getTimezoneOffset()-cj.getTimezoneOffset())*6e4))/(1440*60*1e3)}function R2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZF(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function QF(e){var t=e<0?12:11,r=R2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function e7(e){var t=R2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function zf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=QF(e):t===10?r=e.toFixed(10).substr(0,12):r=e7(e),R2(ZF(r.toUpperCase()))}function Rl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ti(14,uj(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function t7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function r7(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Dg[r.m-1][1];case 5:return Dg[r.m-1][0];default:return Dg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return m5[r.q][0];default:return m5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ji(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ji(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?Ji(c,u):"";return f}function zo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var fj=/%/g;function n7(e,t,r){var n=t.replace(fj,""),a=t.length-n.length;return Ys(e,n,r*Math.pow(10,2*a))+Yr("%",a)}function a7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ys(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function dj(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+dj(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hj=/# (\?+)( ?)\/( ?)(\d+)/;function i7(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Yr(" ",e[1].length+1+e[4].length):M2(s,e[1].length)+e[2]+"/"+e[3]+Ji(o,e[4].length))}function s7(e,t,r){return r+(t===0?"":""+t)+Yr(" ",e[1].length+2+e[4].length)}var pj=/^#*0*\.([0#]+)/,mj=/\).*[0#]/,gj=/\(###\) ###\\?-####/;function Aa(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function x5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function v5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function o7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function l7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wi("n",n,r):"("+wi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a7(e,t,r);if(t.indexOf("%")!==-1)return n7(e,t,r);if(t.indexOf("E")!==-1)return dj(t,r);if(t.charCodeAt(0)===36)return"$"+wi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Oc(c,t.length);if(t.match(/^[#?]+$/))return a=Oc(r,0),a==="0"&&(a=""),a.length>t.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(hj))return i7(i,c,u);if(t.match(/^#+0+$/))return u+Oc(c,t.length-t.indexOf("0"));if(i=t.match(pj))return a=x5(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Aa(i[1])).replace(/\.$/,"."+Aa(i[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+Yr("0",Aa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+x5(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+zo(Oc(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wi(e,t,-r):zo(""+(Math.floor(r)+o7(r,i[1].length)))+"."+Ji(v5(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return wi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kc(wi(e,t.replace(/[\\-]/g,""),r)),s=0,Kc(Kc(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(gj))return a=wi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Dh(c,Math.pow(10,s)-1,!1),a=""+u,f=Ys("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Ih(o[2],s),f.length<i[4].length&&(f=Aa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Dh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?M2(o[1],s)+i[2]+"/"+i[3]+Ih(o[2],s):Yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Oc(r,0),t.length<=a.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,p=t.length-a.length-d;return Aa(t.substr(0,d)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=v5(r,i[1].length),r<0?"-"+wi(e,t,-r):zo(l7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ji(0,3-m.length):"")+m})+"."+Ji(s,i[1].length);switch(t){case"###,##0.00":return wi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=zo(Oc(c,0));return h!=="0"?u+h:"";case"###,###.00":return wi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function c7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ys(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function u7(e,t,r){var n=t.replace(fj,""),a=t.length-n.length;return Ys(e,n,r*Math.pow(10,2*a))+Yr("%",a)}function xj(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xj(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ps(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ps("n",n,r):"("+ps("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return c7(e,t,r);if(t.indexOf("%")!==-1)return u7(e,t,r);if(t.indexOf("E")!==-1)return xj(t,r);if(t.charCodeAt(0)===36)return"$"+ps(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ji(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(hj))return s7(i,c,u);if(t.match(/^#+0+$/))return u+Ji(c,t.length-t.indexOf("0"));if(i=t.match(pj))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Aa(i[1])).replace(/\.$/,"."+Aa(i[1])),a=a.replace(/\.(\d*)$/,function(m,g){return"."+g+Yr("0",Aa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+zo(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ps(e,t,-r):zo(""+r)+"."+Yr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ps(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kc(ps(e,t.replace(/[\\-]/g,""),r)),s=0,Kc(Kc(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(gj))return a=ps(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Dh(c,Math.pow(10,s)-1,!1),a=""+u,f=Ys("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Ih(o[2],s),f.length<i[4].length&&(f=Aa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Dh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?M2(o[1],s)+i[2]+"/"+i[3]+Ih(o[2],s):Yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Aa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,p=t.length-a.length-d;return Aa(t.substr(0,d)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ps(e,t,-r):zo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ji(0,3-m.length):"")+m})+"."+Ji(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=zo(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return ps(e,t.slice(0,t.lastIndexOf(".")),r)+Aa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ys(e,t,r){return(r|0)===r?ps(e,t,r):wi(e,t,r)}function f7(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var vj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Lh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(vj))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function d7(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,f,d,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Lh(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Al(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Al(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(u==null&&(u=Al(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",s+=5,p="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(vj)){if(u==null&&(u=Al(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",vu(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var x=0,b=0,S;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,c="h",x<1&&(x=1);break;case"s":(S=a[s].v.match(/\.0+$/))&&(b=Math.max(b,S[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[s].v.match(/[Hh]/)&&(x=1),x<2&&a[s].v.match(/[Mm]/)&&(x=2),x<3&&a[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",E;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=r7(a[s].t.charCodeAt(0),a[s].v,u,b),a[s].t="t";break;case"n":case"?":for(E=s+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[s].v+=a[E].v,a[E]={v:"",t:";"},++E;_+=a[s].v,s=E-1;break;case"G":a[s].t="t",a[s].v=Rl(t,r);break}var O="",F,M;if(_.length>0){_.charCodeAt(0)==40?(F=t<0&&_.charCodeAt(0)===45?-t:t,M=Ys("n",_,F)):(F=t<0&&n>1?-t:t,M=Ys("n",_,F),F<0&&a[0]&&a[0].t=="t"&&(M=M.substr(1),a[0].v="-"+a[0].v)),E=M.length-1;var C=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){C=s;break}var k=a.length;if(C===a.length&&M.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(E>=a[s].v.length-1?(E-=a[s].v.length,a[s].v=M.substr(E+1,a[s].v.length)):E<0?a[s].v="":(a[s].v=M.substr(0,E+1),E=-1),a[s].t="t",k=s);E>=0&&k<a.length&&(a[k].v=M.substr(0,E+1)+a[k].v)}else if(C!==a.length&&M.indexOf("E")===-1){for(E=M.indexOf(".")-1,s=C;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")-1:a[s].v.length-1,O=a[s].v.substr(f+1);f>=0;--f)E>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(O=M.charAt(E--)+O);a[s].v=O,a[s].t="t",k=s}for(E>=0&&k<a.length&&(a[k].v=M.substr(0,E+1)+a[k].v),E=M.indexOf(".")+1,s=C;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==C)){for(f=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")+1:0,O=a[s].v.substr(0,f);f<a[s].v.length;++f)E<M.length&&(O+=M.charAt(E++));a[s].v=O,a[s].t="t",k=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(F=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Ys(a[s].t,a[s].v,F),a[s].t="t");var W="";for(s=0;s!==a.length;++s)a[s]!=null&&(W+=a[s].v);return W}var y5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function b5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function h7(e,t){var r=f7(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(y5),o=r[1].match(y5);return b5(t,s)?[n,r[0]]:b5(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Ti(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ft)[e],n==null&&(n=r.table&&r.table[g5[e]]||Ft[g5[e]]),n==null&&(n=KF[e]||"General");break}if(Lh(n,0))return Rl(t,r);t instanceof Date&&(t=uj(t,r.date1904));var a=h7(n,t);if(Lh(a[1]))return Rl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return d7(a[1],t,r,a[0])}function Ks(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ft[r]==null){t<0&&(t=r);continue}if(Ft[r]==e){t=r;break}}t<0&&(t=391)}return Ft[t]=e,t}function Gp(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ks(e[t],t)}function yu(){Ft=YF()}var p7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},yj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function m7(e){var t=typeof e=="number"?Ft[e]:e;return t=t.replace(yj,"(\\d+)"),new RegExp("^"+t+"$")}function g7(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(yj)||[]).forEach(function(d,p){var h=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?f:u+"T"+f}var x7=(function(){var e={};e.version="1.2.0";function t(){for(var M=0,C=new Array(256),k=0;k!=256;++k)M=k,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,C[k]=M;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(M){var C=0,k=0,W=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)D[W]=M[W];for(W=0;W!=256;++W)for(k=M[W],C=256+W;C<4096;C+=256)k=D[C]=k>>>8^M[k&255];var j=[];for(W=1;W!=16;++W)j[W-1]=typeof Int32Array<"u"?D.subarray(W*256,W*256+256):D.slice(W*256,W*256+256);return j}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],f=a[5],d=a[6],p=a[7],h=a[8],m=a[9],g=a[10],x=a[11],b=a[12],S=a[13],_=a[14];function E(M,C){for(var k=C^-1,W=0,D=M.length;W<D;)k=k>>>8^r[(k^M.charCodeAt(W++))&255];return~k}function O(M,C){for(var k=C^-1,W=M.length-15,D=0;D<W;)k=_[M[D++]^k&255]^S[M[D++]^k>>8&255]^b[M[D++]^k>>16&255]^x[M[D++]^k>>>24]^g[M[D++]]^m[M[D++]]^h[M[D++]]^p[M[D++]]^d[M[D++]]^f[M[D++]]^u[M[D++]]^c[M[D++]]^o[M[D++]]^s[M[D++]]^i[M[D++]]^r[M[D++]];for(W+=15;D<W;)k=k>>>8^r[(k^M[D++])&255];return~k}function F(M,C){for(var k=C^-1,W=0,D=M.length,j=0,H=0;W<D;)j=M.charCodeAt(W++),j<128?k=k>>>8^r[(k^j)&255]:j<2048?(k=k>>>8^r[(k^(192|j>>6&31))&255],k=k>>>8^r[(k^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,H=M.charCodeAt(W++)&1023,k=k>>>8^r[(k^(240|j>>8&7))&255],k=k>>>8^r[(k^(128|j>>2&63))&255],k=k>>>8^r[(k^(128|H>>6&15|(j&3)<<4))&255],k=k>>>8^r[(k^(128|H&63))&255]):(k=k>>>8^r[(k^(224|j>>12&15))&255],k=k>>>8^r[(k^(128|j>>6&63))&255],k=k>>>8^r[(k^(128|j&63))&255]);return~k}return e.table=r,e.bstr=E,e.buf=O,e.str=F,e})(),jt=(function(){var t={};t.version="1.2.1";function r(ae,pe){for(var ce=ae.split("/"),ue=pe.split("/"),he=0,me=0,Ie=Math.min(ce.length,ue.length);he<Ie;++he){if(me=ce[he].length-ue[he].length)return me;if(ce[he]!=ue[he])return ce[he]<ue[he]?-1:1}return ce.length-ue.length}function n(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:n(ae.slice(0,-1));var pe=ae.lastIndexOf("/");return pe===-1?ae:ae.slice(0,pe+1)}function a(ae){if(ae.charAt(ae.length-1)=="/")return a(ae.slice(0,-1));var pe=ae.lastIndexOf("/");return pe===-1?ae:ae.slice(pe+1)}function i(ae,pe){typeof pe=="string"&&(pe=new Date(pe));var ce=pe.getHours();ce=ce<<6|pe.getMinutes(),ce=ce<<5|pe.getSeconds()>>>1,ae.write_shift(2,ce);var ue=pe.getFullYear()-1980;ue=ue<<4|pe.getMonth()+1,ue=ue<<5|pe.getDate(),ae.write_shift(2,ue)}function s(ae){var pe=ae.read_shift(2)&65535,ce=ae.read_shift(2)&65535,ue=new Date,he=ce&31;ce>>>=5;var me=ce&15;ce>>>=4,ue.setMilliseconds(0),ue.setFullYear(ce+1980),ue.setMonth(me-1),ue.setDate(he);var Ie=pe&31;pe>>>=5;var We=pe&63;return pe>>>=6,ue.setHours(pe),ue.setMinutes(We),ue.setSeconds(Ie<<1),ue}function o(ae){Jn(ae,0);for(var pe={},ce=0;ae.l<=ae.length-4;){var ue=ae.read_shift(2),he=ae.read_shift(2),me=ae.l+he,Ie={};switch(ue){case 21589:ce=ae.read_shift(1),ce&1&&(Ie.mtime=ae.read_shift(4)),he>5&&(ce&2&&(Ie.atime=ae.read_shift(4)),ce&4&&(Ie.ctime=ae.read_shift(4))),Ie.mtime&&(Ie.mt=new Date(Ie.mtime*1e3));break}ae.l=me,pe[ue]=Ie}return pe}var c;function u(){return c||(c={})}function f(ae,pe){if(ae[0]==80&&ae[1]==75)return ir(ae,pe);if((ae[0]|32)==109&&(ae[1]|32)==105)return ui(ae,pe);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var ce=3,ue=512,he=0,me=0,Ie=0,We=0,Fe=0,Me=[],Be=ae.slice(0,512);Jn(Be,0);var rt=d(Be);switch(ce=rt[0],ce){case 3:ue=512;break;case 4:ue=4096;break;case 0:if(rt[1]==0)return ir(ae,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ce)}ue!==512&&(Be=ae.slice(0,ue),Jn(Be,28));var st=ae.slice(0,ue);p(Be,ce);var dt=Be.read_shift(4,"i");if(ce===3&&dt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+dt);Be.l+=4,Ie=Be.read_shift(4,"i"),Be.l+=4,Be.chk("00100000","Mini Stream Cutoff Size: "),We=Be.read_shift(4,"i"),he=Be.read_shift(4,"i"),Fe=Be.read_shift(4,"i"),me=Be.read_shift(4,"i");for(var nt=-1,ft=0;ft<109&&(nt=Be.read_shift(4,"i"),!(nt<0));++ft)Me[ft]=nt;var Rt=h(ae,ue);x(Fe,me,Rt,ue,Me);var sr=S(Rt,Ie,Me,ue);sr[Ie].name="!Directory",he>0&&We!==H&&(sr[We].name="!MiniFAT"),sr[Me[0]].name="!FAT",sr.fat_addrs=Me,sr.ssz=ue;var mr={},dn=[],Di=[],Ts=[];_(Ie,sr,Rt,dn,he,mr,Di,We),m(Di,Ts,dn),dn.shift();var ss={FileIndex:Di,FullPaths:Ts};return pe&&pe.raw&&(ss.raw={header:st,sectors:Rt}),ss}function d(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(U,"Header Signature: "),ae.l+=16;var pe=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),pe]}function p(ae,pe){var ce=9;switch(ae.l+=2,ce=ae.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+ce);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ce)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function h(ae,pe){for(var ce=Math.ceil(ae.length/pe)-1,ue=[],he=1;he<ce;++he)ue[he-1]=ae.slice(he*pe,(he+1)*pe);return ue[ce-1]=ae.slice(ce*pe),ue}function m(ae,pe,ce){for(var ue=0,he=0,me=0,Ie=0,We=0,Fe=ce.length,Me=[],Be=[];ue<Fe;++ue)Me[ue]=Be[ue]=ue,pe[ue]=ce[ue];for(;We<Be.length;++We)ue=Be[We],he=ae[ue].L,me=ae[ue].R,Ie=ae[ue].C,Me[ue]===ue&&(he!==-1&&Me[he]!==he&&(Me[ue]=Me[he]),me!==-1&&Me[me]!==me&&(Me[ue]=Me[me])),Ie!==-1&&(Me[Ie]=ue),he!==-1&&ue!=Me[ue]&&(Me[he]=Me[ue],Be.lastIndexOf(he)<We&&Be.push(he)),me!==-1&&ue!=Me[ue]&&(Me[me]=Me[ue],Be.lastIndexOf(me)<We&&Be.push(me));for(ue=1;ue<Fe;++ue)Me[ue]===ue&&(me!==-1&&Me[me]!==me?Me[ue]=Me[me]:he!==-1&&Me[he]!==he&&(Me[ue]=Me[he]));for(ue=1;ue<Fe;++ue)if(ae[ue].type!==0){if(We=ue,We!=Me[We])do We=Me[We],pe[ue]=pe[We]+"/"+pe[ue];while(We!==0&&Me[We]!==-1&&We!=Me[We]);Me[ue]=-1}for(pe[0]+="/",ue=1;ue<Fe;++ue)ae[ue].type!==2&&(pe[ue]+="/")}function g(ae,pe,ce){for(var ue=ae.start,he=ae.size,me=[],Ie=ue;ce&&he>0&&Ie>=0;)me.push(pe.slice(Ie*j,Ie*j+j)),he-=j,Ie=Sl(ce,Ie*4);return me.length===0?Ge(0):zn(me).slice(0,ae.size)}function x(ae,pe,ce,ue,he){var me=H;if(ae===H){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var Ie=ce[ae],We=(ue>>>2)-1;if(!Ie)return;for(var Fe=0;Fe<We&&(me=Sl(Ie,Fe*4))!==H;++Fe)he.push(me);x(Sl(Ie,ue-4),pe-1,ce,ue,he)}}function b(ae,pe,ce,ue,he){var me=[],Ie=[];he||(he=[]);var We=ue-1,Fe=0,Me=0;for(Fe=pe;Fe>=0;){he[Fe]=!0,me[me.length]=Fe,Ie.push(ae[Fe]);var Be=ce[Math.floor(Fe*4/ue)];if(Me=Fe*4&We,ue<4+Me)throw new Error("FAT boundary crossed: "+Fe+" 4 "+ue);if(!ae[Be])break;Fe=Sl(ae[Be],Me)}return{nodes:me,data:O5([Ie])}}function S(ae,pe,ce,ue){var he=ae.length,me=[],Ie=[],We=[],Fe=[],Me=ue-1,Be=0,rt=0,st=0,dt=0;for(Be=0;Be<he;++Be)if(We=[],st=Be+pe,st>=he&&(st-=he),!Ie[st]){Fe=[];var nt=[];for(rt=st;rt>=0;){nt[rt]=!0,Ie[rt]=!0,We[We.length]=rt,Fe.push(ae[rt]);var ft=ce[Math.floor(rt*4/ue)];if(dt=rt*4&Me,ue<4+dt)throw new Error("FAT boundary crossed: "+rt+" 4 "+ue);if(!ae[ft]||(rt=Sl(ae[ft],dt),nt[rt]))break}me[st]={nodes:We,data:O5([Fe])}}return me}function _(ae,pe,ce,ue,he,me,Ie,We){for(var Fe=0,Me=ue.length?2:0,Be=pe[ae].data,rt=0,st=0,dt;rt<Be.length;rt+=128){var nt=Be.slice(rt,rt+128);Jn(nt,64),st=nt.read_shift(2),dt=q2(nt,0,st-Me),ue.push(dt);var ft={name:dt,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},Rt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Rt!==0&&(ft.ct=E(nt,nt.l-8));var sr=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);sr!==0&&(ft.mt=E(nt,nt.l-8)),ft.start=nt.read_shift(4,"i"),ft.size=nt.read_shift(4,"i"),ft.size<0&&ft.start<0&&(ft.size=ft.type=0,ft.start=H,ft.name=""),ft.type===5?(Fe=ft.start,he>0&&Fe!==H&&(pe[Fe].name="!StreamData")):ft.size>=4096?(ft.storage="fat",pe[ft.start]===void 0&&(pe[ft.start]=b(ce,ft.start,pe.fat_addrs,pe.ssz)),pe[ft.start].name=ft.name,ft.content=pe[ft.start].data.slice(0,ft.size)):(ft.storage="minifat",ft.size<0?ft.size=0:Fe!==H&&ft.start!==H&&pe[Fe]&&(ft.content=g(ft,pe[Fe].data,(pe[We]||{}).data))),ft.content&&Jn(ft.content,0),me[dt]=ft,Ie.push(ft)}}function E(ae,pe){return new Date((ei(ae,pe+4)/1e7*Math.pow(2,32)+ei(ae,pe)/1e7-11644473600)*1e3)}function O(ae,pe){return u(),f(c.readFileSync(ae),pe)}function F(ae,pe){var ce=pe&&pe.type;switch(ce||Gt&&Buffer.isBuffer(ae)&&(ce="buffer"),ce||"base64"){case"file":return O(ae,pe);case"base64":return f(ti(oi(ae)),pe);case"binary":return f(ti(ae),pe)}return f(ae,pe)}function M(ae,pe){var ce=pe||{},ue=ce.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=ue+"/",ae.FileIndex[0]={name:ue,type:5}),ce.CLSID&&(ae.FileIndex[0].clsid=ce.CLSID),C(ae)}function C(ae){var pe="Sh33tJ5";if(!jt.find(ae,"/"+pe)){var ce=Ge(4);ce[0]=55,ce[1]=ce[3]=50,ce[2]=54,ae.FileIndex.push({name:pe,type:2,content:ce,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+pe),k(ae)}}function k(ae,pe){M(ae);for(var ce=!1,ue=!1,he=ae.FullPaths.length-1;he>=0;--he){var me=ae.FileIndex[he];switch(me.type){case 0:ue?ce=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:ue=!0,isNaN(me.R*me.L*me.C)&&(ce=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(ce=!0);break;default:ce=!0;break}}if(!(!ce&&!pe)){var Ie=new Date(1987,1,19),We=0,Fe=Object.create?Object.create(null):{},Me=[];for(he=0;he<ae.FullPaths.length;++he)Fe[ae.FullPaths[he]]=!0,ae.FileIndex[he].type!==0&&Me.push([ae.FullPaths[he],ae.FileIndex[he]]);for(he=0;he<Me.length;++he){var Be=n(Me[he][0]);ue=Fe[Be],ue||(Me.push([Be,{name:a(Be).replace("/",""),type:1,clsid:X,ct:Ie,mt:Ie,content:null}]),Fe[Be]=!0)}for(Me.sort(function(dt,nt){return r(dt[0],nt[0])}),ae.FullPaths=[],ae.FileIndex=[],he=0;he<Me.length;++he)ae.FullPaths[he]=Me[he][0],ae.FileIndex[he]=Me[he][1];for(he=0;he<Me.length;++he){var rt=ae.FileIndex[he],st=ae.FullPaths[he];if(rt.name=a(st).replace("/",""),rt.L=rt.R=rt.C=-(rt.color=1),rt.size=rt.content?rt.content.length:0,rt.start=0,rt.clsid=rt.clsid||X,he===0)rt.C=Me.length>1?1:-1,rt.size=0,rt.type=5;else if(st.slice(-1)=="/"){for(We=he+1;We<Me.length&&n(ae.FullPaths[We])!=st;++We);for(rt.C=We>=Me.length?-1:We,We=he+1;We<Me.length&&n(ae.FullPaths[We])!=n(st);++We);rt.R=We>=Me.length?-1:We,rt.type=1}else n(ae.FullPaths[he+1]||"")==n(st)&&(rt.R=he+1),rt.type=2}}}function W(ae,pe){var ce=pe||{};if(ce.fileType=="mad")return Tt(ae,ce);switch(k(ae),ce.fileType){case"zip":return ba(ae,ce)}var ue=(function(dt){for(var nt=0,ft=0,Rt=0;Rt<dt.FileIndex.length;++Rt){var sr=dt.FileIndex[Rt];if(sr.content){var mr=sr.content.length;mr>0&&(mr<4096?nt+=mr+63>>6:ft+=mr+511>>9)}}for(var dn=dt.FullPaths.length+3>>2,Di=nt+7>>3,Ts=nt+127>>7,ss=Di+ft+dn+Ts,Mi=ss+127>>7,os=Mi<=109?0:Math.ceil((Mi-109)/127);ss+Mi+os+127>>7>Mi;)os=++Mi<=109?0:Math.ceil((Mi-109)/127);var Va=[1,os,Mi,Ts,dn,ft,nt,0];return dt.FileIndex[0].size=nt<<6,Va[7]=(dt.FileIndex[0].start=Va[0]+Va[1]+Va[2]+Va[3]+Va[4]+Va[5])+(Va[6]+7>>3),Va})(ae),he=Ge(ue[7]<<9),me=0,Ie=0;{for(me=0;me<8;++me)he.write_shift(1,Y[me]);for(me=0;me<8;++me)he.write_shift(2,0);for(he.write_shift(2,62),he.write_shift(2,3),he.write_shift(2,65534),he.write_shift(2,9),he.write_shift(2,6),me=0;me<3;++me)he.write_shift(2,0);for(he.write_shift(4,0),he.write_shift(4,ue[2]),he.write_shift(4,ue[0]+ue[1]+ue[2]+ue[3]-1),he.write_shift(4,0),he.write_shift(4,4096),he.write_shift(4,ue[3]?ue[0]+ue[1]+ue[2]-1:H),he.write_shift(4,ue[3]),he.write_shift(-4,ue[1]?ue[0]-1:H),he.write_shift(4,ue[1]),me=0;me<109;++me)he.write_shift(-4,me<ue[2]?ue[1]+me:-1)}if(ue[1])for(Ie=0;Ie<ue[1];++Ie){for(;me<236+Ie*127;++me)he.write_shift(-4,me<ue[2]?ue[1]+me:-1);he.write_shift(-4,Ie===ue[1]-1?H:Ie+1)}var We=function(dt){for(Ie+=dt;me<Ie-1;++me)he.write_shift(-4,me+1);dt&&(++me,he.write_shift(-4,H))};for(Ie=me=0,Ie+=ue[1];me<Ie;++me)he.write_shift(-4,Z.DIFSECT);for(Ie+=ue[2];me<Ie;++me)he.write_shift(-4,Z.FATSECT);We(ue[3]),We(ue[4]);for(var Fe=0,Me=0,Be=ae.FileIndex[0];Fe<ae.FileIndex.length;++Fe)Be=ae.FileIndex[Fe],Be.content&&(Me=Be.content.length,!(Me<4096)&&(Be.start=Ie,We(Me+511>>9)));for(We(ue[6]+7>>3);he.l&511;)he.write_shift(-4,Z.ENDOFCHAIN);for(Ie=me=0,Fe=0;Fe<ae.FileIndex.length;++Fe)Be=ae.FileIndex[Fe],Be.content&&(Me=Be.content.length,!(!Me||Me>=4096)&&(Be.start=Ie,We(Me+63>>6)));for(;he.l&511;)he.write_shift(-4,Z.ENDOFCHAIN);for(me=0;me<ue[4]<<2;++me){var rt=ae.FullPaths[me];if(!rt||rt.length===0){for(Fe=0;Fe<17;++Fe)he.write_shift(4,0);for(Fe=0;Fe<3;++Fe)he.write_shift(4,-1);for(Fe=0;Fe<12;++Fe)he.write_shift(4,0);continue}Be=ae.FileIndex[me],me===0&&(Be.start=Be.size?Be.start-1:H);var st=me===0&&ce.root||Be.name;if(Me=2*(st.length+1),he.write_shift(64,st,"utf16le"),he.write_shift(2,Me),he.write_shift(1,Be.type),he.write_shift(1,Be.color),he.write_shift(-4,Be.L),he.write_shift(-4,Be.R),he.write_shift(-4,Be.C),Be.clsid)he.write_shift(16,Be.clsid,"hex");else for(Fe=0;Fe<4;++Fe)he.write_shift(4,0);he.write_shift(4,Be.state||0),he.write_shift(4,0),he.write_shift(4,0),he.write_shift(4,0),he.write_shift(4,0),he.write_shift(4,Be.start),he.write_shift(4,Be.size),he.write_shift(4,0)}for(me=1;me<ae.FileIndex.length;++me)if(Be=ae.FileIndex[me],Be.size>=4096)if(he.l=Be.start+1<<9,Gt&&Buffer.isBuffer(Be.content))Be.content.copy(he,he.l,0,Be.size),he.l+=Be.size+511&-512;else{for(Fe=0;Fe<Be.size;++Fe)he.write_shift(1,Be.content[Fe]);for(;Fe&511;++Fe)he.write_shift(1,0)}for(me=1;me<ae.FileIndex.length;++me)if(Be=ae.FileIndex[me],Be.size>0&&Be.size<4096)if(Gt&&Buffer.isBuffer(Be.content))Be.content.copy(he,he.l,0,Be.size),he.l+=Be.size+63&-64;else{for(Fe=0;Fe<Be.size;++Fe)he.write_shift(1,Be.content[Fe]);for(;Fe&63;++Fe)he.write_shift(1,0)}if(Gt)he.l=he.length;else for(;he.l<he.length;)he.write_shift(1,0);return he}function D(ae,pe){var ce=ae.FullPaths.map(function(Fe){return Fe.toUpperCase()}),ue=ce.map(function(Fe){var Me=Fe.split("/");return Me[Me.length-(Fe.slice(-1)=="/"?2:1)]}),he=!1;pe.charCodeAt(0)===47?(he=!0,pe=ce[0].slice(0,-1)+pe):he=pe.indexOf("/")!==-1;var me=pe.toUpperCase(),Ie=he===!0?ce.indexOf(me):ue.indexOf(me);if(Ie!==-1)return ae.FileIndex[Ie];var We=!me.match(_f);for(me=me.replace(Ca,""),We&&(me=me.replace(_f,"!")),Ie=0;Ie<ce.length;++Ie)if((We?ce[Ie].replace(_f,"!"):ce[Ie]).replace(Ca,"")==me||(We?ue[Ie].replace(_f,"!"):ue[Ie]).replace(Ca,"")==me)return ae.FileIndex[Ie];return null}var j=64,H=-2,U="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(ae,pe,ce){u();var ue=W(ae,ce);c.writeFileSync(pe,ue)}function z(ae){for(var pe=new Array(ae.length),ce=0;ce<ae.length;++ce)pe[ce]=String.fromCharCode(ae[ce]);return pe.join("")}function se(ae,pe){var ce=W(ae,pe);switch(pe&&pe.type||"buffer"){case"file":return u(),c.writeFileSync(pe.filename,ce),ce;case"binary":return typeof ce=="string"?ce:z(ce);case"base64":return Uf(typeof ce=="string"?ce:z(ce));case"buffer":if(Gt)return Buffer.isBuffer(ce)?ce:co(ce);case"array":return typeof ce=="string"?ti(ce):ce}return ce}var xe;function A(ae){try{var pe=ae.InflateRaw,ce=new pe;if(ce._processChunk(new Uint8Array([3,0]),ce._finishFlushFlag),ce.bytesRead)xe=ae;else throw new Error("zlib does not expose bytesRead")}catch(ue){console.error("cannot use native zlib: "+(ue.message||ue))}}function I(ae,pe){if(!xe)return Nt(ae,pe);var ce=xe.InflateRaw,ue=new ce,he=ue._processChunk(ae.slice(ae.l),ue._finishFlushFlag);return ae.l+=ue.bytesRead,he}function P(ae){return xe?xe.deflateRawSync(ae):it(ae)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(ae){var pe=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var q=typeof Uint8Array<"u",Q=q?new Uint8Array(256):[],fe=0;fe<256;++fe)Q[fe]=J(fe);function V(ae,pe){var ce=Q[ae&255];return pe<=8?ce>>>8-pe:(ce=ce<<8|Q[ae>>8&255],pe<=16?ce>>>16-pe:(ce=ce<<8|Q[ae>>16&255],ce>>>24-pe))}function Oe(ae,pe){var ce=pe&7,ue=pe>>>3;return(ae[ue]|(ce<=6?0:ae[ue+1]<<8))>>>ce&3}function Te(ae,pe){var ce=pe&7,ue=pe>>>3;return(ae[ue]|(ce<=5?0:ae[ue+1]<<8))>>>ce&7}function be(ae,pe){var ce=pe&7,ue=pe>>>3;return(ae[ue]|(ce<=4?0:ae[ue+1]<<8))>>>ce&15}function re(ae,pe){var ce=pe&7,ue=pe>>>3;return(ae[ue]|(ce<=3?0:ae[ue+1]<<8))>>>ce&31}function we(ae,pe){var ce=pe&7,ue=pe>>>3;return(ae[ue]|(ce<=1?0:ae[ue+1]<<8))>>>ce&127}function ve(ae,pe,ce){var ue=pe&7,he=pe>>>3,me=(1<<ce)-1,Ie=ae[he]>>>ue;return ce<8-ue||(Ie|=ae[he+1]<<8-ue,ce<16-ue)||(Ie|=ae[he+2]<<16-ue,ce<24-ue)||(Ie|=ae[he+3]<<24-ue),Ie&me}function ye(ae,pe,ce){var ue=pe&7,he=pe>>>3;return ue<=5?ae[he]|=(ce&7)<<ue:(ae[he]|=ce<<ue&255,ae[he+1]=(ce&7)>>8-ue),pe+3}function Ce(ae,pe,ce){var ue=pe&7,he=pe>>>3;return ce=(ce&1)<<ue,ae[he]|=ce,pe+1}function ze(ae,pe,ce){var ue=pe&7,he=pe>>>3;return ce<<=ue,ae[he]|=ce&255,ce>>>=8,ae[he+1]=ce,pe+8}function $e(ae,pe,ce){var ue=pe&7,he=pe>>>3;return ce<<=ue,ae[he]|=ce&255,ce>>>=8,ae[he+1]=ce&255,ae[he+2]=ce>>>8,pe+16}function Ue(ae,pe){var ce=ae.length,ue=2*ce>pe?2*ce:pe+5,he=0;if(ce>=pe)return ae;if(Gt){var me=h5(ue);if(ae.copy)ae.copy(me);else for(;he<ae.length;++he)me[he]=ae[he];return me}else if(q){var Ie=new Uint8Array(ue);if(Ie.set)Ie.set(ae);else for(;he<ce;++he)Ie[he]=ae[he];return Ie}return ae.length=ue,ae}function Xe(ae){for(var pe=new Array(ae),ce=0;ce<ae;++ce)pe[ce]=0;return pe}function Qe(ae,pe,ce){var ue=1,he=0,me=0,Ie=0,We=0,Fe=ae.length,Me=q?new Uint16Array(32):Xe(32);for(me=0;me<32;++me)Me[me]=0;for(me=Fe;me<ce;++me)ae[me]=0;Fe=ae.length;var Be=q?new Uint16Array(Fe):Xe(Fe);for(me=0;me<Fe;++me)Me[he=ae[me]]++,ue<he&&(ue=he),Be[me]=0;for(Me[0]=0,me=1;me<=ue;++me)Me[me+16]=We=We+Me[me-1]<<1;for(me=0;me<Fe;++me)We=ae[me],We!=0&&(Be[me]=Me[We+16]++);var rt=0;for(me=0;me<Fe;++me)if(rt=ae[me],rt!=0)for(We=V(Be[me],ue)>>ue-rt,Ie=(1<<ue+4-rt)-1;Ie>=0;--Ie)pe[We|Ie<<rt]=rt&15|me<<4;return ue}var bt=q?new Uint16Array(512):Xe(512),Dt=q?new Uint16Array(32):Xe(32);if(!q){for(var kt=0;kt<512;++kt)bt[kt]=0;for(kt=0;kt<32;++kt)Dt[kt]=0}(function(){for(var ae=[],pe=0;pe<32;pe++)ae.push(5);Qe(ae,Dt,32);var ce=[];for(pe=0;pe<=143;pe++)ce.push(8);for(;pe<=255;pe++)ce.push(9);for(;pe<=279;pe++)ce.push(7);for(;pe<=287;pe++)ce.push(8);Qe(ce,bt,288)})();var wt=(function(){for(var pe=q?new Uint8Array(32768):[],ce=0,ue=0;ce<G.length-1;++ce)for(;ue<G[ce+1];++ue)pe[ue]=ce;for(;ue<32768;++ue)pe[ue]=29;var he=q?new Uint8Array(259):[];for(ce=0,ue=0;ce<R.length-1;++ce)for(;ue<R[ce+1];++ue)he[ue]=ce;function me(We,Fe){for(var Me=0;Me<We.length;){var Be=Math.min(65535,We.length-Me),rt=Me+Be==We.length;for(Fe.write_shift(1,+rt),Fe.write_shift(2,Be),Fe.write_shift(2,~Be&65535);Be-- >0;)Fe[Fe.l++]=We[Me++]}return Fe.l}function Ie(We,Fe){for(var Me=0,Be=0,rt=q?new Uint16Array(32768):[];Be<We.length;){var st=Math.min(65535,We.length-Be);if(st<10){for(Me=ye(Fe,Me,+(Be+st==We.length)),Me&7&&(Me+=8-(Me&7)),Fe.l=Me/8|0,Fe.write_shift(2,st),Fe.write_shift(2,~st&65535);st-- >0;)Fe[Fe.l++]=We[Be++];Me=Fe.l*8;continue}Me=ye(Fe,Me,+(Be+st==We.length)+2);for(var dt=0;st-- >0;){var nt=We[Be];dt=(dt<<5^nt)&32767;var ft=-1,Rt=0;if((ft=rt[dt])&&(ft|=Be&-32768,ft>Be&&(ft-=32768),ft<Be))for(;We[ft+Rt]==We[Be+Rt]&&Rt<250;)++Rt;if(Rt>2){nt=he[Rt],nt<=22?Me=ze(Fe,Me,Q[nt+1]>>1)-1:(ze(Fe,Me,3),Me+=5,ze(Fe,Me,Q[nt-23]>>5),Me+=3);var sr=nt<8?0:nt-4>>2;sr>0&&($e(Fe,Me,Rt-R[nt]),Me+=sr),nt=pe[Be-ft],Me=ze(Fe,Me,Q[nt]>>3),Me-=3;var mr=nt<4?0:nt-2>>1;mr>0&&($e(Fe,Me,Be-ft-G[nt]),Me+=mr);for(var dn=0;dn<Rt;++dn)rt[dt]=Be&32767,dt=(dt<<5^We[Be])&32767,++Be;st-=Rt-1}else nt<=143?nt=nt+48:Me=Ce(Fe,Me,1),Me=ze(Fe,Me,Q[nt]),rt[dt]=Be&32767,++Be}Me=ze(Fe,Me,0)-1}return Fe.l=(Me+7)/8|0,Fe.l}return function(Fe,Me){return Fe.length<8?me(Fe,Me):Ie(Fe,Me)}})();function it(ae){var pe=Ge(50+Math.floor(ae.length*1.1)),ce=wt(ae,pe);return pe.slice(0,ce)}var Ae=q?new Uint16Array(32768):Xe(32768),tt=q?new Uint16Array(32768):Xe(32768),at=q?new Uint16Array(128):Xe(128),Ct=1,_t=1;function xt(ae,pe){var ce=re(ae,pe)+257;pe+=5;var ue=re(ae,pe)+1;pe+=5;var he=be(ae,pe)+4;pe+=4;for(var me=0,Ie=q?new Uint8Array(19):Xe(19),We=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fe=1,Me=q?new Uint8Array(8):Xe(8),Be=q?new Uint8Array(8):Xe(8),rt=Ie.length,st=0;st<he;++st)Ie[L[st]]=me=Te(ae,pe),Fe<me&&(Fe=me),Me[me]++,pe+=3;var dt=0;for(Me[0]=0,st=1;st<=Fe;++st)Be[st]=dt=dt+Me[st-1]<<1;for(st=0;st<rt;++st)(dt=Ie[st])!=0&&(We[st]=Be[dt]++);var nt=0;for(st=0;st<rt;++st)if(nt=Ie[st],nt!=0){dt=Q[We[st]]>>8-nt;for(var ft=(1<<7-nt)-1;ft>=0;--ft)at[dt|ft<<nt]=nt&7|st<<3}var Rt=[];for(Fe=1;Rt.length<ce+ue;)switch(dt=at[we(ae,pe)],pe+=dt&7,dt>>>=3){case 16:for(me=3+Oe(ae,pe),pe+=2,dt=Rt[Rt.length-1];me-- >0;)Rt.push(dt);break;case 17:for(me=3+Te(ae,pe),pe+=3;me-- >0;)Rt.push(0);break;case 18:for(me=11+we(ae,pe),pe+=7;me-- >0;)Rt.push(0);break;default:Rt.push(dt),Fe<dt&&(Fe=dt);break}var sr=Rt.slice(0,ce),mr=Rt.slice(ce);for(st=ce;st<286;++st)sr[st]=0;for(st=ue;st<30;++st)mr[st]=0;return Ct=Qe(sr,Ae,286),_t=Qe(mr,tt,30),pe}function fn(ae,pe){if(ae[0]==3&&!(ae[1]&3))return[qo(pe),2];for(var ce=0,ue=0,he=h5(pe||1<<18),me=0,Ie=he.length>>>0,We=0,Fe=0;(ue&1)==0;){if(ue=Te(ae,ce),ce+=3,ue>>>1)ue>>1==1?(We=9,Fe=5):(ce=xt(ae,ce),We=Ct,Fe=_t);else{ce&7&&(ce+=8-(ce&7));var Me=ae[ce>>>3]|ae[(ce>>>3)+1]<<8;if(ce+=32,Me>0)for(!pe&&Ie<me+Me&&(he=Ue(he,me+Me),Ie=he.length);Me-- >0;)he[me++]=ae[ce>>>3],ce+=8;continue}for(;;){!pe&&Ie<me+32767&&(he=Ue(he,me+32767),Ie=he.length);var Be=ve(ae,ce,We),rt=ue>>>1==1?bt[Be]:Ae[Be];if(ce+=rt&15,rt>>>=4,(rt>>>8&255)===0)he[me++]=rt;else{if(rt==256)break;rt-=257;var st=rt<8?0:rt-4>>2;st>5&&(st=0);var dt=me+R[rt];st>0&&(dt+=ve(ae,ce,st),ce+=st),Be=ve(ae,ce,Fe),rt=ue>>>1==1?Dt[Be]:tt[Be],ce+=rt&15,rt>>>=4;var nt=rt<4?0:rt-2>>1,ft=G[rt];for(nt>0&&(ft+=ve(ae,ce,nt),ce+=nt),!pe&&Ie<dt&&(he=Ue(he,dt+100),Ie=he.length);me<dt;)he[me]=he[me-ft],++me}}}return pe?[he,ce+7>>>3]:[he.slice(0,me),ce+7>>>3]}function Nt(ae,pe){var ce=ae.slice(ae.l||0),ue=fn(ce,pe);return ae.l+=ue[1],ue[0]}function kr(ae,pe){if(ae)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function ir(ae,pe){var ce=ae;Jn(ce,0);var ue=[],he=[],me={FileIndex:ue,FullPaths:he};M(me,{root:pe.root});for(var Ie=ce.length-4;(ce[Ie]!=80||ce[Ie+1]!=75||ce[Ie+2]!=5||ce[Ie+3]!=6)&&Ie>=0;)--Ie;ce.l=Ie+4,ce.l+=4;var We=ce.read_shift(2);ce.l+=6;var Fe=ce.read_shift(4);for(ce.l=Fe,Ie=0;Ie<We;++Ie){ce.l+=20;var Me=ce.read_shift(4),Be=ce.read_shift(4),rt=ce.read_shift(2),st=ce.read_shift(2),dt=ce.read_shift(2);ce.l+=8;var nt=ce.read_shift(4),ft=o(ce.slice(ce.l+rt,ce.l+rt+st));ce.l+=rt+st+dt;var Rt=ce.l;ce.l=nt+4,Oa(ce,Me,Be,me,ft),ce.l=Rt}return me}function Oa(ae,pe,ce,ue,he){ae.l+=2;var me=ae.read_shift(2),Ie=ae.read_shift(2),We=s(ae);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var Fe=ae.read_shift(4),Me=ae.read_shift(4),Be=ae.read_shift(4),rt=ae.read_shift(2),st=ae.read_shift(2),dt="",nt=0;nt<rt;++nt)dt+=String.fromCharCode(ae[ae.l++]);if(st){var ft=o(ae.slice(ae.l,ae.l+st));(ft[21589]||{}).mt&&(We=ft[21589].mt),((he||{})[21589]||{}).mt&&(We=he[21589].mt)}ae.l+=st;var Rt=ae.slice(ae.l,ae.l+Me);switch(Ie){case 8:Rt=I(ae,Be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ie)}var sr=!1;me&8&&(Fe=ae.read_shift(4),Fe==134695760&&(Fe=ae.read_shift(4),sr=!0),Me=ae.read_shift(4),Be=ae.read_shift(4)),Me!=pe&&kr(sr,"Bad compressed size: "+pe+" != "+Me),Be!=ce&&kr(sr,"Bad uncompressed size: "+ce+" != "+Be),Fa(ue,dt,Rt,{unsafe:!0,mt:We})}function ba(ae,pe){var ce=pe||{},ue=[],he=[],me=Ge(1),Ie=ce.compression?8:0,We=0,Fe=0,Me=0,Be=0,rt=0,st=ae.FullPaths[0],dt=st,nt=ae.FileIndex[0],ft=[],Rt=0;for(Fe=1;Fe<ae.FullPaths.length;++Fe)if(dt=ae.FullPaths[Fe].slice(st.length),nt=ae.FileIndex[Fe],!(!nt.size||!nt.content||dt=="Sh33tJ5")){var sr=Be,mr=Ge(dt.length);for(Me=0;Me<dt.length;++Me)mr.write_shift(1,dt.charCodeAt(Me)&127);mr=mr.slice(0,mr.l),ft[rt]=x7.buf(nt.content,0);var dn=nt.content;Ie==8&&(dn=P(dn)),me=Ge(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,We),me.write_shift(2,Ie),nt.mt?i(me,nt.mt):me.write_shift(4,0),me.write_shift(-4,ft[rt]),me.write_shift(4,dn.length),me.write_shift(4,nt.content.length),me.write_shift(2,mr.length),me.write_shift(2,0),Be+=me.length,ue.push(me),Be+=mr.length,ue.push(mr),Be+=dn.length,ue.push(dn),me=Ge(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,We),me.write_shift(2,Ie),me.write_shift(4,0),me.write_shift(-4,ft[rt]),me.write_shift(4,dn.length),me.write_shift(4,nt.content.length),me.write_shift(2,mr.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,sr),Rt+=me.l,he.push(me),Rt+=mr.length,he.push(mr),++rt}return me=Ge(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,rt),me.write_shift(2,rt),me.write_shift(4,Rt),me.write_shift(4,Be),me.write_shift(2,0),zn([zn(ue),zn(he),me])}var or={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Et(ae,pe){if(ae.ctype)return ae.ctype;var ce=ae.name||"",ue=ce.match(/\.([^\.]+)$/);return ue&&or[ue[1]]||pe&&(ue=(ce=pe).match(/[\.\\]([^\.\\])+$/),ue&&or[ue[1]])?or[ue[1]]:"application/octet-stream"}function Kt(ae){for(var pe=Uf(ae),ce=[],ue=0;ue<pe.length;ue+=76)ce.push(pe.slice(ue,ue+76));return ce.join(`\r
`)+`\r
`}function Li(ae){var pe=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Me){var Be=Me.charCodeAt(0).toString(16).toUpperCase();return"="+(Be.length==1?"0"+Be:Be)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ce=[],ue=pe.split(`\r
`),he=0;he<ue.length;++he){var me=ue[he];if(me.length==0){ce.push("");continue}for(var Ie=0;Ie<me.length;){var We=76,Fe=me.slice(Ie,Ie+We);Fe.charAt(We-1)=="="?We--:Fe.charAt(We-2)=="="?We-=2:Fe.charAt(We-3)=="="&&(We-=3),Fe=me.slice(Ie,Ie+We),Ie+=We,Ie<me.length&&(Fe+="="),ce.push(Fe)}}return ce.join(`\r
`)}function Zr(ae){for(var pe=[],ce=0;ce<ae.length;++ce){for(var ue=ae[ce];ce<=ae.length&&ue.charAt(ue.length-1)=="=";)ue=ue.slice(0,ue.length-1)+ae[++ce];pe.push(ue)}for(var he=0;he<pe.length;++he)pe[he]=pe[he].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return ti(pe.join(`\r
`))}function wa(ae,pe,ce){for(var ue="",he="",me="",Ie,We=0;We<10;++We){var Fe=pe[We];if(!Fe||Fe.match(/^\s*$/))break;var Me=Fe.match(/^(.*?):\s*([^\s].*)$/);if(Me)switch(Me[1].toLowerCase()){case"content-location":ue=Me[2].trim();break;case"content-type":me=Me[2].trim();break;case"content-transfer-encoding":he=Me[2].trim();break}}switch(++We,he.toLowerCase()){case"base64":Ie=ti(oi(pe.slice(We).join("")));break;case"quoted-printable":Ie=Zr(pe.slice(We));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+he)}var Be=Fa(ae,ue.slice(ce.length),Ie,{unsafe:!0});me&&(Be.ctype=me)}function ui(ae,pe){if(z(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ce=pe&&pe.root||"",ue=(Gt&&Buffer.isBuffer(ae)?ae.toString("binary"):z(ae)).split(`\r
`),he=0,me="";for(he=0;he<ue.length;++he)if(me=ue[he],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),ce||(ce=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,ce.length)!=ce))for(;ce.length>0&&(ce=ce.slice(0,ce.length-1),ce=ce.slice(0,ce.lastIndexOf("/")+1),me.slice(0,ce.length)!=ce););var Ie=(ue[1]||"").match(/boundary="(.*?)"/);if(!Ie)throw new Error("MAD cannot find boundary");var We="--"+(Ie[1]||""),Fe=[],Me=[],Be={FileIndex:Fe,FullPaths:Me};M(Be);var rt,st=0;for(he=0;he<ue.length;++he){var dt=ue[he];dt!==We&&dt!==We+"--"||(st++&&wa(Be,ue.slice(rt,he),ce),rt=he)}return Be}function Tt(ae,pe){var ce=pe||{},ue=ce.boundary||"SheetJS";ue="------="+ue;for(var he=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ue.slice(2)+'"',"","",""],me=ae.FullPaths[0],Ie=me,We=ae.FileIndex[0],Fe=1;Fe<ae.FullPaths.length;++Fe)if(Ie=ae.FullPaths[Fe].slice(me.length),We=ae.FileIndex[Fe],!(!We.size||!We.content||Ie=="Sh33tJ5")){Ie=Ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Rt){return"_x"+Rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Rt){return"_u"+Rt.charCodeAt(0).toString(16)+"_"});for(var Me=We.content,Be=Gt&&Buffer.isBuffer(Me)?Me.toString("binary"):z(Me),rt=0,st=Math.min(1024,Be.length),dt=0,nt=0;nt<=st;++nt)(dt=Be.charCodeAt(nt))>=32&&dt<128&&++rt;var ft=rt>=st*4/5;he.push(ue),he.push("Content-Location: "+(ce.root||"file:///C:/SheetJS/")+Ie),he.push("Content-Transfer-Encoding: "+(ft?"quoted-printable":"base64")),he.push("Content-Type: "+Et(We,Ie)),he.push(""),he.push(ft?Li(Be):Kt(Be))}return he.push(ue+`--\r
`),he.join(`\r
`)}function Ga(ae){var pe={};return M(pe,ae),pe}function Fa(ae,pe,ce,ue){var he=ue&&ue.unsafe;he||M(ae);var me=!he&&jt.find(ae,pe);if(!me){var Ie=ae.FullPaths[0];pe.slice(0,Ie.length)==Ie?Ie=pe:(Ie.slice(-1)!="/"&&(Ie+="/"),Ie=(Ie+pe).replace("//","/")),me={name:a(pe),type:2},ae.FileIndex.push(me),ae.FullPaths.push(Ie),he||jt.utils.cfb_gc(ae)}return me.content=ce,me.size=ce?ce.length:0,ue&&(ue.CLSID&&(me.clsid=ue.CLSID),ue.mt&&(me.mt=ue.mt),ue.ct&&(me.ct=ue.ct)),me}function Qn(ae,pe){M(ae);var ce=jt.find(ae,pe);if(ce){for(var ue=0;ue<ae.FileIndex.length;++ue)if(ae.FileIndex[ue]==ce)return ae.FileIndex.splice(ue,1),ae.FullPaths.splice(ue,1),!0}return!1}function Qr(ae,pe,ce){M(ae);var ue=jt.find(ae,pe);if(ue){for(var he=0;he<ae.FileIndex.length;++he)if(ae.FileIndex[he]==ue)return ae.FileIndex[he].name=a(ce),ae.FullPaths[he]=ce,!0}return!1}function Wr(ae){k(ae,!0)}return t.find=D,t.read=F,t.parse=f,t.write=se,t.writeFile=K,t.utils={cfb_new:Ga,cfb_add:Fa,cfb_del:Qn,cfb_mov:Qr,cfb_gc:Wr,ReadShift:Ef,CheckField:zj,prep_blob:Jn,bconcat:zn,use_zlib:A,_deflateRaw:it,_inflateRaw:Nt,consts:Z},t})();function v7(e){return typeof e=="string"?qp(e):Array.isArray(e)?HF(e):e}function xd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=qp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ys(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([v7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=rl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function y7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Jr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function w5(e,t){for(var r=[],n=Jr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Vp(e){for(var t=[],r=Jr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Yp(e){for(var t=[],r=Jr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function b7(e){for(var t=[],r=Jr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Mh=new Date(1899,11,30,0,0,0);function kn(e,t){var r=e.getTime(),n=Mh.getTime()+(e.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var bj=new Date,w7=Mh.getTime()+(bj.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4,S5=bj.getTimezoneOffset();function Kp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+w7),t.getTimezoneOffset()!==S5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-S5)*6e4),t}function S7(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var _5=new Date("2017-02-19T19:06:09.000Z"),wj=isNaN(_5.getFullYear())?new Date("2/19/17"):_5,_7=wj.getFullYear()==2017;function Pr(e,t){var r=new Date(e);if(_7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(wj.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Bl(e,t){if(Gt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ys(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ys(lj(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ys(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ys(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Or(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Or(e[r]));return t}function Yr(e,t){for(var r="";r.length<t;)r+=e;return r}function Zi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var N7=["january","february","march","april","may","june","july","august","september","october","november","december"];function su(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&N7.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var A7=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}})();function Sj(e){return e?e.content&&e.type?Bl(e.content,!0):e.data?Sf(e.data):e.asNodeBuffer&&Gt?Sf(e.asNodeBuffer().toString("binary")):e.asBinary?Sf(e.asBinary()):e._data&&e._data.getContent?Sf(Bl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function _j(e){if(!e)return null;if(e.data)return f5(e.data);if(e.asNodeBuffer&&Gt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?f5(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function j7(e){return e&&e.name.slice(-4)===".bin"?_j(e):Sj(e)}function ji(e,t){for(var r=e.FullPaths||Jr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function B2(e,t){var r=ji(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function xn(e,t,r){if(!r)return j7(B2(e,t));if(!t)return null;try{return xn(e,t)}catch{return null}}function ri(e,t,r){if(!r)return Sj(B2(e,t));if(!t)return null;try{return ri(e,t)}catch{return null}}function k7(e,t,r){return _j(B2(e,t))}function N5(e){for(var t=e.FullPaths||Jr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function qt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Gt?n=co(r):n=qF(r),jt.utils.cfb_add(e,t,n)}jt.utils.cfb_add(e,t,r)}else e.file(t,r)}function U2(){return jt.utils.cfb_new()}function Nj(e,t){switch(t.type){case"base64":return jt.read(e,{type:"base64"});case"binary":return jt.read(e,{type:"binary"});case"buffer":case"array":return jt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var un=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,E7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,A5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,C7=/<[^>]*>/g,va=un.match(A5)?A5:C7,T7=/<\w*:/,P7=/<(\/?)\w+:/;function Mt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(E7),o=0,c="",u=0,f="",d="",p=1;if(s)for(u=0;u!=s.length;++u){for(d=s[u],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(p=(a=d.charCodeAt(i+1))==34||a==39?1:0,c=d.slice(i+1+p,d.length-p),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[h]&&f.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function ks(e){return e.replace(P7,"<$1")}var Aj={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},z2=Vp(Aj),Qt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return Aj[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}})(),$2=/[&<>'"]/g,O7=/[\u0000-\u0008\u000b-\u001f]/g;function hr(e){var t=e+"";return t.replace($2,function(r){return z2[r]}).replace(O7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function j5(e){return hr(e).replace(/ /g,"_x0020_")}var jj=/[\u0000-\u001f]/g;function W2(e){var t=e+"";return t.replace($2,function(r){return z2[r]}).replace(/\n/g,"<br/>").replace(jj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function F7(e){var t=e+"";return t.replace($2,function(r){return z2[r]}).replace(jj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var k5=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function I7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mg(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function E5(e){var t=qo(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function C5(e){return co(e,"binary").toString("utf8")}var B0="foo bar bazâð£",vr=Gt&&(C5(B0)==Mg(B0)&&C5||E5(B0)==Mg(B0)&&E5)||Mg,ys=Gt?function(e){return co(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$f=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),kj=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),L7=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),D7=/<\/?(?:vt:)?variant>/g,M7=/<(?:vt:)([^>]*)>([\s\S]*)</;function T5(e,t){var r=Mt(e),n=e.match(L7(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(D7,"").match(M7);s&&a.push({v:vr(s[2]),t:s[1]})}),a}var Ej=/(^\s|\s$|\n)/;function Zn(e,t){return"<"+e+(t.match(Ej)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Wf(e){return Jr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ot(e,t,r){return"<"+e+(r!=null?Wf(r):"")+(t!=null?(t.match(Ej)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function X1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function R7(e,t){switch(typeof e){case"string":var r=ot("vt:lpwstr",hr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ot((e|0)==e?"vt:i4":"vt:r8",hr(String(e)));case"boolean":return ot("vt:bool",e?"true":"false")}if(e instanceof Date)return ot("vt:filetime",X1(e));throw new Error("Unable to serialize "+e)}function H2(e){if(Gt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return vr(rl(D2(e)));throw new Error("Bad input format: expected Buffer or string")}var Hf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,jn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ql=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function B7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function U7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var P5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},O5=Gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:co(t)})):P5(e)}:P5,F5=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Hs(e,a)));return n.join("").replace(Ca,"")},q2=Gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ca,""):F5(e,t,r)}:F5,I5=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Cj=Gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):I5(e,t,r)}:I5,L5=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(zc(e,a)));return n.join("")},vd=Gt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):L5(t,r,n)}:L5,Tj=function(e,t){var r=ei(e,t);return r>0?vd(e,t+4,t+4+r-1):""},Pj=Tj,Oj=function(e,t){var r=ei(e,t);return r>0?vd(e,t+4,t+4+r-1):""},Fj=Oj,Ij=function(e,t){var r=2*ei(e,t);return r>0?vd(e,t+4,t+4+r-1):""},Lj=Ij,Dj=function(t,r){var n=ei(t,r);return n>0?q2(t,r+4,r+4+n):""},Mj=Dj,Rj=function(e,t){var r=ei(e,t);return r>0?vd(e,t+4,t+4+r):""},Bj=Rj,Uj=function(e,t){return B7(e,t)},Rh=Uj,G2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Gt&&(Pj=function(t,r){if(!Buffer.isBuffer(t))return Tj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Fj=function(t,r){if(!Buffer.isBuffer(t))return Oj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Lj=function(t,r){if(!Buffer.isBuffer(t))return Ij(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Mj=function(t,r){if(!Buffer.isBuffer(t))return Dj(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Bj=function(t,r){if(!Buffer.isBuffer(t))return Rj(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Rh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Uj(t,r)},G2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var zc=function(e,t){return e[t]},Hs=function(e,t){return e[t+1]*256+e[t]},z7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ei=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Sl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},$7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ef(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,Gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Hs(this,u)),u+=2;e*=2;break;case"utf8":r=vd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=q2(this,this.l,this.l+e);break;case"wstr":return Ef.call(this,e,"dbcs");case"lpstr-ansi":r=Pj(this,this.l),e=4+ei(this,this.l);break;case"lpstr-cp":r=Fj(this,this.l),e=4+ei(this,this.l);break;case"lpwstr":r=Lj(this,this.l),e=4+2*ei(this,this.l);break;case"lpp4":e=4+ei(this,this.l),r=Mj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ei(this,this.l),r=Bj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=zc(this,this.l+e++))!==0;)i.push(R0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Hs(this,this.l+e))!==0;)i.push(R0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=zc(this,u),this.l=u+1,o=Ef.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(R0(Hs(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=zc(this,u),this.l=u+1,o=Ef.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(R0(zc(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=zc(this,this.l),this.l++,n;case 2:return n=(t==="i"?z7:Hs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Sl:$7)(this,this.l),this.l+=4,n):(a=ei(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Rh(this,this.l):a=Rh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Cj(this,this.l,e);break}}return this.l+=e,r}var W7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},H7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},q7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function G7(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)q7(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,W7(this,t,this.l);break;case 8:if(n=8,r==="f"){U7(this,t,this.l);break}case 16:break;case-4:n=4,H7(this,t,this.l);break}return this.l+=n,this}function zj(e,t){var r=Cj(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jn(e,t){e.l=t,e.read_shift=Ef,e.chk=zj,e.write_shift=G7}function xa(e,t){e.l+=t}function Ge(e){var t=qo(e);return Jn(t,0),t}function uo(e,t,r){if(e){var n,a,i;Jn(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Xf[o]||Xf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var f=u.f&&u.f(e,i,r);if(e.l=c,t(f,u,o))return}}}function za(){var e=[],t=Gt?256:2048,r=function(u){var f=Ge(u);return Jn(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),zn(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function Je(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Xf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&G2(r)&&e.push(r)}}function Cf(e,t,r){var n=Or(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function D5(e,t,r){var n=Or(e);return n.s=Cf(n.s,t.s,r),n.e=Cf(n.e,t.s,r),n}function Tf(e,t){if(e.cRel&&e.c<0)for(e=Or(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Or(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Lt(e);return!e.cRel&&e.cRel!=null&&(r=K7(r)),!e.rRel&&e.rRel!=null&&(r=V7(r)),r}function Rg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Br(e.s.c)+":"+(e.e.cRel?"":"$")+Br(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+cn(e.s.r)+":"+(e.e.rRel?"":"$")+cn(e.e.r):Tf(e.s,t.biff)+":"+Tf(e.e,t.biff)}function V2(e){return parseInt(Y7(e),10)-1}function cn(e){return""+(e+1)}function V7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Y7(e){return e.replace(/\$(\d+)$/,"$1")}function Y2(e){for(var t=X7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Br(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function K7(e){return e.replace(/^([A-Z])/,"$$$1")}function X7(e){return e.replace(/^\$([A-Z])/,"$1")}function J7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ur(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Lt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $a(e){var t=e.indexOf(":");return t==-1?{s:Ur(e),e:Ur(e)}:{s:Ur(e.slice(0,t)),e:Ur(e.slice(t+1))}}function Ht(e,t){return typeof t>"u"||typeof t=="number"?Ht(e.s,e.e):(typeof e!="string"&&(e=Lt(e)),typeof t!="string"&&(t=Lt(t)),e==t?e:e+":"+t)}function er(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function M5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ti(e.z,r?kn(t):t)}catch{}try{return e.w=Ti((e.XF||{}).numFmtId||(r?14:0),r?kn(t):t)}catch{return""+t}}function Qs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fo[e.v]||e.v:t==null?M5(e,e.v):M5(e,t))}function nl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function $j(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ur(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=er(i["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(u.e.r=s=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[d].length;++p)if(!(typeof t[d][p]>"u")){var h={v:t[d][p]},m=s+d,g=o+p;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[d][p]&&typeof t[d][p]=="object"&&!Array.isArray(t[d][p])&&!(t[d][p]instanceof Date))h=t[d][p];else if(Array.isArray(h.v)&&(h.f=t[d][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ft[14],n.cellDates?(h.t="d",h.w=Ti(h.z,kn(h.v))):(h.t="n",h.v=kn(h.v),h.w=Ti(h.z,h.v))):h.t="s";if(a)i[m]||(i[m]=[]),i[m][g]&&i[m][g].z&&(h.z=i[m][g].z),i[m][g]=h;else{var x=Lt({c:g,r:m});i[x]&&i[x].z&&(h.z=i[x].z),i[x]=h}}}return u.s.c<1e7&&(i["!ref"]=Ht(u)),i}function bu(e,t){return $j(null,e,t)}function Z7(e){return e.read_shift(4,"i")}function Qi(e,t){return t||(t=Ge(4)),t.write_shift(4,e),t}function ma(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function $n(e,t){var r=!1;return t==null&&(r=!0,t=Ge(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Q7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function eI(e,t){return t||(t=Ge(4)),t.write_shift(2,0),t.write_shift(2,0),t}function K2(e,t){var r=e.l,n=e.read_shift(1),a=ma(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Q7(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function tI(e,t){var r=!1;return t==null&&(r=!0,t=Ge(15+4*e.t.length)),t.write_shift(1,0),$n(e.t,t),r?t.slice(0,t.l):t}var rI=K2;function nI(e,t){var r=!1;return t==null&&(r=!0,t=Ge(23+4*e.t.length)),t.write_shift(1,1),$n(e.t,t),t.write_shift(4,1),eI({},t),r?t.slice(0,t.l):t}function Fi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ec(e,t){return t==null&&(t=Ge(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function tc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function rc(e,t){return t==null&&(t=Ge(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var aI=ma,Wj=$n;function X2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Bh(e,t){var r=!1;return t==null&&(r=!0,t=Ge(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var iI=ma,J1=X2,J2=Bh;function Z2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Rh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Sl(t,0)>>2;return r?a/100:a}function Hj(e,t){t==null&&(t=Ge(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function qj(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function sI(e,t){return t||(t=Ge(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var nc=qj,wu=sI;function da(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ul(e,t){return(t||Ge(8)).write_shift(8,e,"f")}function oI(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Tl[a];u&&(t.rgb=Gf(u));break;case 2:t.rgb=Gf([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Uh(e,t){if(t||(t=Ge(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function lI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function cI(e,t){t||(t=Ge(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Gj(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function uI(e){return Gj(e,1)}function fI(e){return Gj(e,2)}var Q2=2,Ba=3,U0=11,R5=12,zh=19,z0=64,dI=65,hI=71,pI=4108,mI=4126,Rn=80,Vj=81,gI=[Rn,Vj],Z1={1:{n:"CodePage",t:Q2},2:{n:"Category",t:Rn},3:{n:"PresentationFormat",t:Rn},4:{n:"ByteCount",t:Ba},5:{n:"LineCount",t:Ba},6:{n:"ParagraphCount",t:Ba},7:{n:"SlideCount",t:Ba},8:{n:"NoteCount",t:Ba},9:{n:"HiddenCount",t:Ba},10:{n:"MultimediaClipCount",t:Ba},11:{n:"ScaleCrop",t:U0},12:{n:"HeadingPairs",t:pI},13:{n:"TitlesOfParts",t:mI},14:{n:"Manager",t:Rn},15:{n:"Company",t:Rn},16:{n:"LinksUpToDate",t:U0},17:{n:"CharacterCount",t:Ba},19:{n:"SharedDoc",t:U0},22:{n:"HyperlinksChanged",t:U0},23:{n:"AppVersion",t:Ba,p:"version"},24:{n:"DigSig",t:dI},26:{n:"ContentType",t:Rn},27:{n:"ContentStatus",t:Rn},28:{n:"Language",t:Rn},29:{n:"Version",t:Rn},255:{},2147483648:{n:"Locale",t:zh},2147483651:{n:"Behavior",t:zh},1919054434:{}},Q1={1:{n:"CodePage",t:Q2},2:{n:"Title",t:Rn},3:{n:"Subject",t:Rn},4:{n:"Author",t:Rn},5:{n:"Keywords",t:Rn},6:{n:"Comments",t:Rn},7:{n:"Template",t:Rn},8:{n:"LastAuthor",t:Rn},9:{n:"RevNumber",t:Rn},10:{n:"EditTime",t:z0},11:{n:"LastPrinted",t:z0},12:{n:"CreatedDate",t:z0},13:{n:"ModifiedDate",t:z0},14:{n:"PageCount",t:Ba},15:{n:"WordCount",t:Ba},16:{n:"CharCount",t:Ba},17:{n:"Thumbnail",t:hI},18:{n:"Application",t:Rn},19:{n:"DocSecurity",t:Ba},255:{},2147483648:{n:"Locale",t:zh},2147483651:{n:"Behavior",t:zh},1919054434:{}},B5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var yI=vI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tl=Or(yI),fo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Yj={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ev={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ey(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bI(e){var t=ey();if(!e||!e.match)return t;var r={};if((e.match(va)||[]).forEach(function(n){var a=Mt(n);switch(a[0].replace(T7,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[ev[a.ContentType]]!==void 0&&t[ev[a.ContentType]].push(a.PartName);break}}),t.xmlns!==jn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Kj(e,t){var r=b7(ev),n=[],a;n[n.length]=un,n[n.length]=ot("Types",null,{xmlns:jn.CT,"xmlns:xsd":jn.xsd,"xmlns:xsi":jn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ot("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ot("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:$0[c][t.bookType]||$0[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ot("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:$0[c][t.bookType]||$0[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ot("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Pf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(va)||[]).forEach(function(a){var i=Mt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Nf(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function Xc(e){var t=[un,ot("Relationships",null,{xmlns:jn.RELS})];return Jr(e["!id"]).forEach(function(r){t[t.length]=ot("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function fr(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Vt.HLINK,Vt.XPATH,Vt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var wI="application/vnd.oasis.opendocument.spreadsheet";function SI(e,t){for(var r=H2(e),n,a;n=Hf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Mt(n[0],!1),a.path=="/"&&a.type!==wI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function _I(e){var t=[un];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function U5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function NI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function AI(e){var t=[un];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(U5(e[r][0],e[r][1])),t.push(NI("",e[r][0]));return t.push(U5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Xj(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fh.version+"</meta:generator></office:meta></office:document-meta>"}var Ci=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jI=(function(){for(var e=new Array(Ci.length),t=0;t<Ci.length;++t){var r=Ci[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function Jj(e){var t={};e=vr(e);for(var r=0;r<Ci.length;++r){var n=Ci[r],a=e.match(jI[r]);a!=null&&a.length>0&&(t[n[1]]=Qt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Pr(t[n[1]]))}return t}function Bg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=hr(t),n[n.length]=r?ot(e,t,r):Zn(e,t))}function Zj(e,t){var r=t||{},n=[un,ot("cp:coreProperties",null,{"xmlns:cp":jn.CORE_PROPS,"xmlns:dc":jn.dc,"xmlns:dcterms":jn.dcterms,"xmlns:dcmitype":jn.dcmitype,"xmlns:xsi":jn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Bg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:X1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Bg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:X1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ci.length;++i){var s=Ci[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Bg(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Pl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Qj=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ek(e,t,r,n){var a=[];if(typeof e=="string")a=T5(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(f){return{v:f}}));var s=typeof t=="string"?T5(t,n).map(function(f){return f.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function kI(e,t,r){var n={};return t||(t={}),e=vr(e),Pl.forEach(function(a){var i=(e.match($f(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Qt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ek(n.HeadingPairs,n.TitlesOfParts,t,r),t}function tk(e){var t=[],r=ot;return e||(e={}),e.Application="SheetJS",t[t.length]=un,t[t.length]=ot("Properties",null,{xmlns:jn.EXT_PROPS,"xmlns:vt":jn.vt}),Pl.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=hr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+hr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var EI=/<[^>]+>[^<]*/g;function CI(e,t){var r={},n="",a=e.match(EI);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Mt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Qt(f);break;case"bool":r[n]=Cr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Pr(f);break;case"cy":case"error":r[n]=Qt(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function rk(e){var t=[un,ot("Properties",null,{xmlns:jn.CUST_PROPS,"xmlns:vt":jn.vt})];if(!e)return t.join("");var r=1;return Jr(e).forEach(function(a){++r,t[t.length]=ot("property",R7(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:hr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var tv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ug;function TI(e,t,r){Ug||(Ug=Vp(tv)),t=Ug[t]||t,e[t]=r}function PI(e,t){var r=[];return Jr(tv).map(function(n){for(var a=0;a<Ci.length;++a)if(Ci[a][1]==n)return Ci[a];for(a=0;a<Pl.length;++a)if(Pl[a][1]==n)return Pl[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Zn(tv[n[1]]||n[1],a))}}),ot("DocumentProperties",r.join(""),{xmlns:Qa.o})}function OI(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Jr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Ci.length;++s)if(i==Ci[s][1])return;for(s=0;s<Pl.length;++s)if(i==Pl[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ot(j5(i),o,{"dt:dt":c}))}}),t&&Jr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(ot(j5(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Qa.o+'">'+a.join("")+"</"+n+">"}function ty(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function FI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Ge(8);return s.write_shift(4,n),s.write_shift(4,a),s}function nk(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function ak(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function ik(e,t,r){return t===31?ak(e):nk(e,t,r)}function rv(e,t,r){return ik(e,t,r===!1?0:4)}function II(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ik(e,t,0)}function LI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ca,""),e.l-a&2&&(e.l+=2)}return r}function DI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ca,"");return r}function MI(e){var t=e.l,r=$h(e,Vj);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=$h(e,Ba);return[r,n]}function RI(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(MI(e));return r}function z5(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Ca,"").replace(_f,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function sk(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function BI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function $h(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==R5&&n!==t&&gI.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===R5?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return nk(e,n,4).replace(Ca,"");case 31:return ak(e);case 64:return ty(e);case 65:return sk(e);case 71:return BI(e);case 80:return rv(e,n,!i.raw).replace(Ca,"");case 81:return II(e,n).replace(Ca,"");case 4108:return RI(e);case 4126:case 4127:return n==4127?LI(e):DI(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function $5(e,t){var r=Ge(4),n=Ge(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ge(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=FI(t);break;case 31:case 80:for(n=Ge(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return zn([r,n])}function W5(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+r]}i.sort(function(S,_){return S[1]-_[1]});var p={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[i[s][0]];if(p[m.n]=$h(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xi(o=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(i[s][0]===1){if(o=p.CodePage=$h(e,Q2),Xi(o),c!==-1){var g=e.l;e.l=i[c][1],u=z5(e,o),e.l=g}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=z5(e,o)}else{var x=u[i[s][0]],b;switch(e[e.l]){case 65:e.l+=4,b=sk(e);break;case 30:e.l+=4,b=rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=nn(e,4);break;case 64:e.l+=4,b=Pr(ty(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[x]=b}}return e.l=r+n,p}var ok=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function H5(e,t,r){var n=Ge(8),a=[],i=[],s=8,o=0,c=Ge(8),u=Ge(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=Ge(8),u.write_shift(4,0),a.unshift(u);var f=[Ge(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=Ge(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=zn(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(ok.indexOf(e[o][0])>-1||Qj.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],h=0;if(t){h=+t[e[o][0]];var m=r[h];if(m.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}c=$5(m.t,p)}else{var x=UI(p);x==-1&&(x=31,p=String(p)),c=$5(x,p)}i.push(c),u=Ge(8),u.write_shift(4,t?h:2+o),a.push(u),s+=8+c.length}var b=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,b),b+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),zn([n].concat(a).concat(i))}function q5(e,t,r){var n=e.content;if(!n)return{};Jn(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==jt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var d=W5(n,t),p={SystemIdentifier:u};for(var h in d)p[h]=d[h];if(p.FMTID=i,a===1)return p;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=W5(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[i,s],p}function G5(e,t,r,n,a,i){var s=Ge(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,jt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=H5(e,r,n);if(o.push(c),a){var u=H5(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return zn(o)}function Io(e,t){return e.read_shift(t),null}function zI(e,t){t||(t=Ge(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function $I(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function nn(e,t){return e.read_shift(t)===1}function ja(e,t){return t||(t=Ge(2)),t.write_shift(2,+!!e),t}function vn(e){return e.read_shift(2,"u")}function ki(e,t){return t||(t=Ge(2)),t.write_shift(2,e),t}function lk(e,t){return $I(e,t,vn)}function WI(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ck(e,t,r){return r||(r=Ge(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function yd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function HI(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,c={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*s),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function qI(e){var t=e.t||"",r=Ge(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ge(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return zn(a)}function zl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function bd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):zl(e,n,r)}function ac(e,t,r){if(r.biff>5)return bd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function uk(e,t,r){return r||(r=Ge(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function GI(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function VI(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ca,"");return n&&(e.l+=24),a}function YI(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Ca,"");return r+s}function KI(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return VI(e);case"0303000000000000c000000000000046":return YI(e);default:throw new Error("Unsupported Moniker "+r)}}function W0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ca,""):"";return r}function V5(e,t){t||(t=Ge(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function XI(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",f,d;a&16&&(i=W0(e,r-e.l)),a&128&&(s=W0(e,r-e.l)),(a&257)===257&&(o=W0(e,r-e.l)),(a&257)===1&&(c=KI(e,r-e.l)),a&8&&(u=W0(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=ty(e)),e.l=r;var p=s||o||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return f&&(h.guid=f),d&&(h.time=d),i&&(h.Tooltip=i),h}function JI(e){var t=Ge(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),V5(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&V5(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function fk(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function dk(e,t){var r=fk(e);return r[3]=0,r}function Es(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function $l(e,t,r,n){return n||(n=Ge(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ZI(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function QI(e,t,r){return t===0?"":ac(e,t,r)}function eL(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function hk(e){var t=e.read_shift(2),r=Z2(e);return[t,r]}function tL(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=yd(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Xp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function pk(e,t){return t||(t=Ge(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function mk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var rL=mk;function gk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function nL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function aL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ra(e){e.l+=2,e.l+=e.read_shift(2)}var iL={0:ra,4:ra,5:ra,6:ra,7:aL,8:ra,9:ra,10:ra,11:ra,12:ra,13:nL,14:ra,15:ra,16:ra,17:ra,18:ra,19:ra,20:ra,21:gk};function sL(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(iL[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function H0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ry(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ge(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function oL(e,t){return t===0||e.read_shift(2),1200}function lL(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ac(e,0,r);return e.read_shift(t+n-e.l),a}function cL(e,t){var r=!t||t.biff==8,n=Ge(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uL(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fL(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=yd(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function dL(e,t){var r=!t||t.biff>=8?2:1,n=Ge(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function hL(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(HI(e));return i.Count=n,i.Unique=a,i}function pL(e,t){var r=Ge(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=qI(e[a]);var i=zn([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function mL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function gL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function xL(e){var t=ZI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vL(e){return e.read_shift(2),e.read_shift(4)}function Y5(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function yL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function bL(){var e=Ge(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function wL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function SL(e){var t=Ge(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function _L(){}function NL(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=yd(e,0,r),n}function AL(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ge(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function jL(e){var t=Es(e);return t.isst=e.read_shift(4),t}function kL(e,t,r,n){var a=Ge(10);return $l(e,t,n,a),a.write_shift(4,r),a}function EL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Es(e);r.biff==2&&e.l++;var i=bd(e,n-e.l,r);return a.val=i,a}function CL(e,t,r,n,a){var i=!a||a.biff==8,s=Ge(8+ +i+(1+i)*r.length);return $l(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function TL(e,t,r){var n=e.read_shift(2),a=ac(e,0,r);return[n,a]}function PL(e,t,r,n){var a=r&&r.biff==5;n||(n=Ge(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var OL=ac;function K5(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function FL(e,t){var r=t.biff==8||!t.biff?4:2,n=Ge(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function IL(e){var t=e.read_shift(2),r=e.read_shift(2),n=hk(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function LL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(hk(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function DL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function ML(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=xI[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function RL(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=ML(e,t,n.fStyle,r),n}function X5(e,t,r,n){var a=r&&r.biff==5;n||(n=Ge(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function BL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function UL(e){var t=Ge(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function J5(e,t,r){var n=Es(e);(r.biff==2||t==9)&&++e.l;var a=WI(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function zL(e,t,r,n,a,i){var s=Ge(8);return $l(e,t,n,s),ck(r,i,s),s}function $L(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Es(e),a=da(e);return n.val=a,n}function WL(e,t,r,n){var a=Ge(14);return $l(e,t,n,a),Ul(r,a),a}var Z5=QI;function HL(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=zl(e,i),o=[];n>e.l;)o.push(bd(e));return[i,a,s,o]}function Q5(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=tL(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var qL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function eS(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=zl(e,s,r);a&32&&(u=qL[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:sB(e,f,r,o);return{chKey:i,Name:u,itab:c,rgce:d}}function xk(e,t,r){if(r.biff<8)return GL(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(eL(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function GL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=yd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function VL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=zl(e,n,r),s=zl(e,a,r);return[i,s]}function YL(e,t,r){var n=mk(e);e.l++;var a=e.read_shift(1);return t-=8,[oB(e,t,r),a,n]}function tS(e,t,r){var n=rL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,aB(e,t,r)]}function KL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function XL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=ac(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function JL(e,t,r){return XL(e,t,r)}function ZL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Xp(e));return r}function QL(e){var t=Ge(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)pk(e[r],t);return t}function eD(e,t,r){if(r&&r.biff<8)return rD(e,t,r);var n=gk(e),a=sL(e,t-22,n[1]);return{cmo:n,ft:a}}var tD={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function rD(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((tD[n]||xa)(e,t,r)),{cmo:[a,n,i],ft:s}}function nD(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=GI(e,6,r);var o=e.read_shift(2);e.read_shift(2),vn(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=zl(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function aD(e,t){var r=Xp(e);e.l+=16;var n=XI(e,t-24);return[r,n]}function iD(e){var t=Ge(24),r=Ur(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return zn([t,JI(e[1])])}function sD(e,t){e.read_shift(2);var r=Xp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ca,""),[r,n]}function oD(e){var t=e[1].Tooltip,r=Ge(10+2*(t.length+1));r.write_shift(2,2048);var n=Ur(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function lD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=B5[r]||r,r=e.read_shift(2),t[1]=B5[r]||r,t}function cD(e){return e||(e=Ge(4)),e.write_shift(2,1),e.write_shift(2,1),e}function uD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dk(e));return r}function fD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(dk(e));return r}function dD(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function vk(e,t,r){if(!r.cellStyles)return xa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function hD(e,t){var r=Ge(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function pD(e,t){var r={};return t<32||(e.l+=16,r.header=da(e),r.footer=da(e),e.l+=2),r}function mD(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function gD(e){for(var t=Ge(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var xD=Es,vD=lk,yD=bd;function bD(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function wD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Es(e);++e.l;var a=ac(e,t-7,r);return n.t="str",n.val=a,n}function SD(e){var t=Es(e);++e.l;var r=da(e);return t.t="n",t.val=r,t}function _D(e,t,r){var n=Ge(15);return Nd(n,e,t),n.write_shift(8,r,"f"),n}function ND(e){var t=Es(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function AD(e,t,r){var n=Ge(9);return Nd(n,e,t),n.write_shift(2,r),n}function jD(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function kD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function ED(e,t,r){var n=e.l+t,a=Es(e),i=e.read_shift(2),s=zl(e,i,r);return e.l=n,a.t="str",a.val=s,a}var CD=[2,3,48,49,131,139,140,245],nv=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=qo(1);switch(c.type){case"base64":f=ti(oi(o));break;case"binary":f=ti(o);break;case"buffer":case"array":f=o;break}Jn(f,0);var d=f.read_shift(1),p=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,x=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(x=f.read_shift(2));var b=f.read_shift(2),S=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(S=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var _=[],E={},O=Math.min(f.length,d==2?521:x-10-(h?264:0)),F=m?32:11;f.l<O&&f[f.l]!=13;)switch(E={},E.name=Bf.utils.decode(S,f.slice(f.l,f.l+F)).replace(/[\u0000\r\n].*$/g,""),f.l+=F,E.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(E.offset=f.read_shift(4)),E.len=f.read_shift(1),d==2&&(E.offset=f.read_shift(2)),E.dec=f.read_shift(1),E.name.length&&_.push(E),d!=2&&(f.l+=m?13:14),E.type){case"B":(!h||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(f[f.l]!==13&&(f.l=x-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=x;var M=0,C=0;for(u[0]=[],C=0;C!=_.length;++C)u[0][C]=_[C].name;for(;g-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,u[++M]=[],C=0,C=0;C!=_.length;++C){var k=f.slice(f.l,f.l+_[C].len);f.l+=_[C].len,Jn(k,0);var W=Bf.utils.decode(S,k);switch(_[C].type){case"C":W.trim().length&&(u[M][C]=W.replace(/\s+$/,""));break;case"D":W.length===8?u[M][C]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):u[M][C]=W;break;case"F":u[M][C]=parseFloat(W.trim());break;case"+":case"I":u[M][C]=m?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[M][C]=!0;break;case"N":case"F":u[M][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[M][C]="##MEMO##"+(m?parseInt(W.trim(),10):k.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(u[M][C]=+W||0);break;case"@":u[M][C]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[M][C]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[M][C]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[M][C]=-k.read_shift(-8,"f");break;case"B":if(h&&_[C].len==8){u[M][C]=k.read_shift(8,"f");break}case"G":case"P":k.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=bu(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,c){try{return nl(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&Xi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=za(),d=qh(o,{header:1,raw:!0,cellDates:!0}),p=d[0],h=d.slice(1),m=o["!cols"]||[],g=0,x=0,b=0,S=1;for(g=0;g<p.length;++g){if(((m[g]||{}).DBF||{}).name){p[g]=m[g].DBF.name,++b;continue}if(p[g]!=null){if(++b,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(x=0;x<1024;++x)if(p.indexOf(p[g]+"_"+x)==-1){p[g]+="_"+x;break}}}}var _=er(o["!ref"]),E=[],O=[],F=[];for(g=0;g<=_.e.c-_.s.c;++g){var M="",C="",k=0,W=[];for(x=0;x<h.length;++x)h[x][g]!=null&&W.push(h[x][g]);if(W.length==0||p[g]==null){E[g]="?";continue}for(x=0;x<W.length;++x){switch(typeof W[x]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=W[x]instanceof Date?"D":"C";break;default:C="C"}k=Math.max(k,String(W[x]).length),M=M&&M!=C?"C":C}k>250&&(k=250),C=((m[g]||{}).DBF||{}).type,C=="C"&&m[g].DBF.len>k&&(k=m[g].DBF.len),M=="B"&&C=="N"&&(M="N",F[g]=m[g].DBF.dec,k=m[g].DBF.len),O[g]=M=="C"||C=="N"?k:i[M]||0,S+=O[g],E[g]=M}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,h.length),D.write_shift(2,296+32*b),D.write_shift(2,S),g=0;g<4;++g)D.write_shift(4,0);for(D.write_shift(4,0|(+t[oj]||3)<<8),g=0,x=0;g<p.length;++g)if(p[g]!=null){var j=f.next(32),H=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,H,"sbcs"),j.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),j.write_shift(4,x),j.write_shift(1,O[g]||i[E[g]]||0),j.write_shift(1,F[g]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),x+=O[g]||i[E[g]]||0}var U=f.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<h.length;++g){var Y=f.next(S);for(Y.write_shift(1,0),x=0;x<p.length;++x)if(p[x]!=null)switch(E[x]){case"L":Y.write_shift(1,h[g][x]==null?63:h[g][x]?84:70);break;case"B":Y.write_shift(8,h[g][x]||0,"f");break;case"N":var X="0";for(typeof h[g][x]=="number"&&(X=h[g][x].toFixed(F[x]||0)),b=0;b<O[x]-X.length;++b)Y.write_shift(1,32);Y.write_shift(1,X,"sbcs");break;case"D":h[g][x]?(Y.write_shift(4,("0000"+h[g][x].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(h[g][x].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+h[g][x].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(h[g][x]!=null?h[g][x]:"").slice(0,O[x]);for(Y.write_shift(1,Z,"sbcs"),b=0;b<O[x]-Z.length;++b)Y.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),yk=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Jr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?d5(m):m},n=function(p,h,m){var g=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?p:d5(g)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return i(oi(p),h);case"binary":return i(p,h);case"buffer":return i(Gt&&Buffer.isBuffer(p)?p.toString("binary"):rl(p),h);case"array":return i(Bl(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var m=p.split(/[\n\r]+/),g=-1,x=-1,b=0,S=0,_=[],E=[],O=null,F={},M=[],C=[],k=[],W=0,D;for(+h.codepage>=0&&Xi(+h.codepage);b!==m.length;++b){W=0;var j=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=j.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),U=H[0],Y;if(j.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&E.push(j.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,Z=!1,K=!1,z=!1,se=-1,xe=-1;for(S=1;S<H.length;++S)switch(H[S].charAt(0)){case"A":break;case"X":x=parseInt(H[S].slice(1))-1,Z=!0;break;case"Y":for(g=parseInt(H[S].slice(1))-1,Z||(x=0),D=_.length;D<=g;++D)_[D]=[];break;case"K":Y=H[S].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(Zi(Y))?isNaN(su(Y).getDate())||(Y=Pr(Y)):(Y=Zi(Y),O!==null&&vu(O)&&(Y=Kp(Y))),X=!0;break;case"E":z=!0;var A=Jc(H[S].slice(1),{r:g,c:x});_[g][x]=[_[g][x],A];break;case"S":K=!0,_[g][x]=[_[g][x],"S5S"];break;case"G":break;case"R":se=parseInt(H[S].slice(1))-1;break;case"C":xe=parseInt(H[S].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(X&&(_[g][x]&&_[g][x].length==2?_[g][x][0]=Y:_[g][x]=Y,O=null),K){if(z)throw new Error("SYLK shared formula cannot have own formula");var I=se>-1&&_[se][xe];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");_[g][x][1]=Mk(I[1],{r:g-se,c:x-xe})}break;case"F":var P=0;for(S=1;S<H.length;++S)switch(H[S].charAt(0)){case"X":x=parseInt(H[S].slice(1))-1,++P;break;case"Y":for(g=parseInt(H[S].slice(1))-1,D=_.length;D<=g;++D)_[D]=[];break;case"M":W=parseInt(H[S].slice(1))/20;break;case"F":break;case"G":break;case"P":O=E[parseInt(H[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=H[S].slice(1).split(" "),D=parseInt(k[0],10);D<=parseInt(k[1],10);++D)W=parseInt(k[2],10),C[D-1]=W===0?{hidden:!0}:{wch:W},Go(C[D-1]);break;case"C":x=parseInt(H[S].slice(1))-1,C[x]||(C[x]={});break;case"R":g=parseInt(H[S].slice(1))-1,M[g]||(M[g]={}),W>0?(M[g].hpt=W,M[g].hpx=lu(W)):W===0&&(M[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}P<1&&(O=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return M.length>0&&(F["!rows"]=M),C.length>0&&(F["!cols"]=C),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,F]}function s(p,h){var m=a(p,h),g=m[0],x=m[1],b=bu(g,h);return Jr(x).forEach(function(S){b[S]=x[S]}),b}function o(p,h){return nl(s(p,h),h)}function c(p,h,m,g){var x="C;Y"+(m+1)+";X"+(g+1)+";K";switch(p.t){case"n":x+=p.v||0,p.f&&!p.F&&(x+=";E"+ly(p.f,{r:m,c:g}));break;case"b":x+=p.v?"TRUE":"FALSE";break;case"e":x+=p.w||p.v;break;case"d":x+='"'+(p.w||p.v)+'"';break;case"s":x+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(p,h){h.forEach(function(m,g){var x="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Vf(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Yf(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&p.push(x)})}function f(p,h){h.forEach(function(m,g){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*Kf(m.hpx)+";"),x.length>2&&p.push(x+"R"+(g+1))})}function d(p,h){var m=["ID;PWXL;N;E"],g=[],x=er(p["!ref"]),b,S=Array.isArray(p),_=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&f(m,p["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var E=x.s.r;E<=x.e.r;++E)for(var O=x.s.c;O<=x.e.c;++O){var F=Lt({r:E,c:O});b=S?(p[E]||[])[O]:p[F],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,p,E,O))}return m.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:s,from_sheet:d}})(),bk=(function(){function e(i,s){switch(s.type){case"base64":return t(oi(i),s);case"binary":return t(i,s);case"buffer":return t(Gt&&Buffer.isBuffer(i)?i.toString("binary"):rl(i),s);case"array":return t(Bl(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var p=o[f].trim().split(","),h=p[0],m=p[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+h){case-1:if(g==="BOT"){d[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[c][u]=!0:g==="FALSE"?d[c][u]=!1:isNaN(Zi(m))?isNaN(su(m).getDate())?d[c][u]=m:d[c][u]=Pr(m):d[c][u]=Zi(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(i,s){return bu(e(i,s),s)}function n(i,s){return nl(r(i,s),s)}var a=(function(){var i=function(c,u,f,d,p){c.push(u),c.push(f+","+d),c.push('"'+p.replace(/"/g,'""')+'"')},s=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=er(c["!ref"]),d,p=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,f.e.r-f.s.r+1,""),i(u,"TUPLES",0,f.e.c-f.s.c+1,""),i(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(u,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var g=Lt({r:h,c:m});if(d=p?(c[h]||[])[m]:c[g],!d){s(u,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,x,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Ti(d.z||Ft[14],kn(Pr(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var b=`\r
`,S=u.join(b);return S}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),wk=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var h=d.split(`
`),m=-1,g=-1,x=0,b=[];x!==h.length;++x){var S=h[x].trim().split(":");if(S[0]==="cell"){var _=Ur(S[1]);if(b.length<=_.r)for(m=b.length;m<=_.r;++m)b[m]||(b[m]=[]);switch(m=_.r,g=_.c,S[2]){case"t":b[m][g]=e(S[3]);break;case"v":b[m][g]=+S[3];break;case"vtf":var E=S[S.length-1];case"vtc":switch(S[3]){case"nl":b[m][g]=!!+S[4];break;default:b[m][g]=+S[4];break}S[2]=="vtf"&&(b[m][g]=[b[m][g],E])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(d,p){return bu(r(d,p),p)}function a(d,p){return nl(n(d,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],h=[],m,g="",x=$a(d["!ref"]),b=Array.isArray(d),S=x.s.r;S<=x.e.r;++S)for(var _=x.s.c;_<=x.e.c;++_)if(g=Lt({r:S,c:_}),m=b?(d[S]||[])[_]:d[g],!(!m||m.v==null||m.t==="z")){switch(h=["cell",g,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var E=kn(Pr(m.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=m.w||Ti(m.z||Ft[14],E);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[i,s,o,s,u(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}})(),ou=(function(){function e(f,d,p,h,m){m.raw?d[p][h]=f:f===""||(f==="TRUE"?d[p][h]=!0:f==="FALSE"?d[p][h]=!1:isNaN(Zi(f))?isNaN(su(f).getDate())?d[p][h]=f:d[p][h]=Pr(f):d[p][h]=Zi(f))}function t(f,d){var p=d||{},h=[];if(!f||f.length===0)return h;for(var m=f.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var x=10,b=0,S=0;S<=g;++S)b=m[S].indexOf(" "),b==-1?b=m[S].length:b++,x=Math.max(x,b);for(S=0;S<=g;++S){h[S]=[];var _=0;for(e(m[S].slice(0,x).trim(),h,S,_,p),_=1;_<=(m[S].length-x)/10+1;++_)e(m[S].slice(x+(_-1)*10,x+_*10).trim(),h,S,_,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},p=!1,h=0,m=0;h<f.length;++h)(m=f.charCodeAt(h))==34?p=!p:!p&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(g,x){return g[0]-x[0]||n[g[1]]-n[x[1]]}),r[m.pop()[1]]||44}function i(f,d){var p=d||{},h="",m=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):p&&p.FS?h=p.FS:h=a(f.slice(0,1024));var x=0,b=0,S=0,_=0,E=0,O=h.charCodeAt(0),F=!1,M=0,C=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var k=p.dateNF!=null?m7(p.dateNF):null;function W(){var D=f.slice(_,E),j={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)j.t="z";else if(p.raw)j.t="s",j.v=D;else if(D.trim().length===0)j.t="s",j.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(j.t="s",j.v=D.slice(2,-1).replace(/""/g,'"')):HR(D)?(j.t="n",j.f=D.slice(1)):(j.t="s",j.v=D);else if(D=="TRUE")j.t="b",j.v=!0;else if(D=="FALSE")j.t="b",j.v=!1;else if(!isNaN(S=Zi(D)))j.t="n",p.cellText!==!1&&(j.w=D),j.v=S;else if(!isNaN(su(D).getDate())||k&&D.match(k)){j.z=p.dateNF||Ft[14];var H=0;k&&D.match(k)&&(D=g7(D,p.dateNF,D.match(k)||[]),H=1),p.cellDates?(j.t="d",j.v=Pr(D,H)):(j.t="n",j.v=kn(Pr(D,H))),p.cellText!==!1&&(j.w=Ti(j.z,j.v instanceof Date?kn(j.v):j.v)),p.cellNF||delete j.z}else j.t="s",j.v=D;if(j.t=="z"||(p.dense?(m[x]||(m[x]=[]),m[x][b]=j):m[Lt({c:b,r:x})]=j),_=E+1,C=f.charCodeAt(_),g.e.c<b&&(g.e.c=b),g.e.r<x&&(g.e.r=x),M==O)++b;else if(b=0,++x,p.sheetRows&&p.sheetRows<=x)return!0}e:for(;E<f.length;++E)switch(M=f.charCodeAt(E)){case 34:C===34&&(F=!F);break;case O:case 10:case 13:if(!F&&W())break e;break}return E-_>0&&W(),m["!ref"]=Ht(g),m}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):bu(t(f,d),d)}function o(f,d){var p="",h=d.type=="string"?[0,0,0,0]:gy(f,d);switch(d.type){case"base64":p=oi(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof Bf<"u"||(p=Gt&&Buffer.isBuffer(f)?f.toString("binary"):rl(f));break;case"array":p=Bl(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=vr(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=vr(p):d.type=="binary"&&typeof Bf<"u",p.slice(0,19)=="socialcalc:version:"?wk.to_sheet(d.type=="string"?p:vr(p),d):s(p,d)}function c(f,d){return nl(o(f,d),d)}function u(f){for(var d=[],p=er(f["!ref"]),h,m=Array.isArray(f),g=p.s.r;g<=p.e.r;++g){for(var x=[],b=p.s.c;b<=p.e.c;++b){var S=Lt({r:g,c:b});if(h=m?(f[g]||[])[b]:f[S],!h||h.v==null){x.push("          ");continue}for(var _=(h.w||(Qs(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";x.push(_+(b===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function TD(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=yk.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return ou.to_workbook(e,t)}}var Ol=(function(){function e(A,I,P){if(A){Jn(A,A.l||0);for(var L=P.Enum||se;A.l<A.length;){var R=A.read_shift(2),G=L[R]||L[65535],J=A.read_shift(2),q=A.l+J,Q=G.f&&G.f(A,J,P);if(A.l=q,I(Q,G,R))return}}}function t(A,I){switch(I.type){case"base64":return r(ti(oi(A)),I);case"binary":return r(ti(A),I);case"buffer":case"array":return r(A,I)}throw"Unsupported type "+I.type}function r(A,I){if(!A)return A;var P=I||{},L=P.dense?[]:{},R="Sheet1",G="",J=0,q={},Q=[],fe=[],V={s:{r:0,c:0},e:{r:0,c:0}},Oe=P.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)P.Enum=se,e(A,function(we,ve,ye){switch(ye){case 0:P.vers=we,we>=4096&&(P.qpro=!0);break;case 6:V=we;break;case 204:we&&(G=we);break;case 222:G=we;break;case 15:case 51:P.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:ye==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=P.dateNF||Ft[14],P.cellDates&&(we[1].t="d",we[1].v=Kp(we[1].v))),P.qpro&&we[3]>J&&(L["!ref"]=Ht(V),q[R]=L,Q.push(R),L=P.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=we[3],R=G||"Sheet"+(J+1),G="");var Ce=P.dense?(L[we[0].r]||[])[we[0].c]:L[Lt(we[0])];if(Ce){Ce.t=we[1].t,Ce.v=we[1].v,we[1].z!=null&&(Ce.z=we[1].z),we[1].f!=null&&(Ce.f=we[1].f);break}P.dense?(L[we[0].r]||(L[we[0].r]=[]),L[we[0].r][we[0].c]=we[1]):L[Lt(we[0])]=we[1];break}},P);else if(A[2]==26||A[2]==14)P.Enum=xe,A[2]==14&&(P.qpro=!0,A.l=0),e(A,function(we,ve,ye){switch(ye){case 204:R=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>J&&(L["!ref"]=Ht(V),q[R]=L,Q.push(R),L=P.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=we[3],R="Sheet"+(J+1)),Oe>0&&we[0].r>=Oe)break;P.dense?(L[we[0].r]||(L[we[0].r]=[]),L[we[0].r][we[0].c]=we[1]):L[Lt(we[0])]=we[1],V.e.c<we[0].c&&(V.e.c=we[0].c),V.e.r<we[0].r&&(V.e.r=we[0].r);break;case 27:we[14e3]&&(fe[we[14e3][0]]=we[14e3][1]);break;case 1537:fe[we[0]]=we[1],we[0]==J&&(R=we[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(L["!ref"]=Ht(V),q[G||R]=L,Q.push(G||R),!fe.length)return{SheetNames:Q,Sheets:q};for(var Te={},be=[],re=0;re<fe.length;++re)q[Q[re]]?(be.push(fe[re]||Q[re]),Te[fe[re]]=q[fe[re]]||q[Q[re]]):(be.push(fe[re]),Te[fe[re]]={"!ref":"A1"});return{SheetNames:be,Sheets:Te}}function n(A,I){var P=I||{};if(+P.codepage>=0&&Xi(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var L=za(),R=er(A["!ref"]),G=Array.isArray(A),J=[];lt(L,0,i(1030)),lt(L,6,c(R));for(var q=Math.min(R.e.r,8191),Q=R.s.r;Q<=q;++Q)for(var fe=cn(Q),V=R.s.c;V<=R.e.c;++V){Q===R.s.r&&(J[V]=Br(V));var Oe=J[V]+fe,Te=G?(A[Q]||[])[V]:A[Oe];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?lt(L,13,h(Q,V,Te.v)):lt(L,14,g(Q,V,Te.v));else{var be=Qs(Te);lt(L,15,d(Q,V,be.slice(0,239)))}}return lt(L,1),L.end()}function a(A,I){var P=I||{};if(+P.codepage>=0&&Xi(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var L=za();lt(L,0,s(A));for(var R=0,G=0;R<A.SheetNames.length;++R)(A.Sheets[A.SheetNames[R]]||{})["!ref"]&&lt(L,27,z(A.SheetNames[R],G++));var J=0;for(R=0;R<A.SheetNames.length;++R){var q=A.Sheets[A.SheetNames[R]];if(!(!q||!q["!ref"])){for(var Q=er(q["!ref"]),fe=Array.isArray(q),V=[],Oe=Math.min(Q.e.r,8191),Te=Q.s.r;Te<=Oe;++Te)for(var be=cn(Te),re=Q.s.c;re<=Q.e.c;++re){Te===Q.s.r&&(V[re]=Br(re));var we=V[re]+be,ve=fe?(q[Te]||[])[re]:q[we];if(!(!ve||ve.t=="z"))if(ve.t=="n")lt(L,23,W(Te,re,J,ve.v));else{var ye=Qs(ve);lt(L,22,M(Te,re,J,ye.slice(0,239)))}}++J}}return lt(L,1),L.end()}function i(A){var I=Ge(2);return I.write_shift(2,A),I}function s(A){var I=Ge(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var P=0,L=0,R=0,G=0;G<A.SheetNames.length;++G){var J=A.SheetNames[G],q=A.Sheets[J];if(!(!q||!q["!ref"])){++R;var Q=$a(q["!ref"]);P<Q.e.r&&(P=Q.e.r),L<Q.e.c&&(L=Q.e.c)}}return P>8191&&(P=8191),I.write_shift(2,P),I.write_shift(1,R),I.write_shift(1,L),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(A,I,P){var L={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&P.qpro?(L.s.c=A.read_shift(1),A.l++,L.s.r=A.read_shift(2),L.e.c=A.read_shift(1),A.l++,L.e.r=A.read_shift(2),L):(L.s.c=A.read_shift(2),L.s.r=A.read_shift(2),I==12&&P.qpro&&(A.l+=2),L.e.c=A.read_shift(2),L.e.r=A.read_shift(2),I==12&&P.qpro&&(A.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(A){var I=Ge(8);return I.write_shift(2,A.s.c),I.write_shift(2,A.s.r),I.write_shift(2,A.e.c),I.write_shift(2,A.e.r),I}function u(A,I,P){var L=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(L[0].c=A.read_shift(1),L[3]=A.read_shift(1),L[0].r=A.read_shift(2),A.l+=2):(L[2]=A.read_shift(1),L[0].c=A.read_shift(2),L[0].r=A.read_shift(2)),L}function f(A,I,P){var L=A.l+I,R=u(A,I,P);if(R[1].t="s",P.vers==20768){A.l++;var G=A.read_shift(1);return R[1].v=A.read_shift(G,"utf8"),R}return P.qpro&&A.l++,R[1].v=A.read_shift(L-A.l,"cstr"),R}function d(A,I,P){var L=Ge(7+P.length);L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,A),L.write_shift(1,39);for(var R=0;R<L.length;++R){var G=P.charCodeAt(R);L.write_shift(1,G>=128?95:G)}return L.write_shift(1,0),L}function p(A,I,P){var L=u(A,I,P);return L[1].v=A.read_shift(2,"i"),L}function h(A,I,P){var L=Ge(7);return L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,A),L.write_shift(2,P,"i"),L}function m(A,I,P){var L=u(A,I,P);return L[1].v=A.read_shift(8,"f"),L}function g(A,I,P){var L=Ge(13);return L.write_shift(1,255),L.write_shift(2,I),L.write_shift(2,A),L.write_shift(8,P,"f"),L}function x(A,I,P){var L=A.l+I,R=u(A,I,P);if(R[1].v=A.read_shift(8,"f"),P.qpro)A.l=L;else{var G=A.read_shift(2);E(A.slice(A.l,A.l+G),R),A.l+=G}return R}function b(A,I,P){var L=I&32768;return I&=-32769,I=(L?A:0)+(I>=8192?I-16384:I),(L?"":"$")+(P?Br(I):cn(I))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(A,I){Jn(A,0);for(var P=[],L=0,R="",G="",J="",q="";A.l<A.length;){var Q=A[A.l++];switch(Q){case 0:P.push(A.read_shift(8,"f"));break;case 1:G=b(I[0].c,A.read_shift(2),!0),R=b(I[0].r,A.read_shift(2),!1),P.push(G+R);break;case 2:{var fe=b(I[0].c,A.read_shift(2),!0),V=b(I[0].r,A.read_shift(2),!1);G=b(I[0].c,A.read_shift(2),!0),R=b(I[0].r,A.read_shift(2),!1),P.push(fe+V+":"+G+R)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(A.read_shift(2));break;case 6:{for(var Oe="";Q=A[A.l++];)Oe+=String.fromCharCode(Q);P.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:q=P.pop(),J=P.pop(),P.push(["AND","OR"][Q-20]+"("+J+","+q+")");break;default:if(Q<32&&_[Q])q=P.pop(),J=P.pop(),P.push(J+_[Q]+q);else if(S[Q]){if(L=S[Q][1],L==69&&(L=A[A.l++]),L>P.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+P.join("|")+"|");return}var Te=P.slice(-L);P.length-=L,P.push(S[Q][0]+"("+Te.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}P.length==1?I[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function O(A){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=A.read_shift(2),I[3]=A[A.l++],I[0].c=A[A.l++],I}function F(A,I){var P=O(A);return P[1].t="s",P[1].v=A.read_shift(I-4,"cstr"),P}function M(A,I,P,L){var R=Ge(6+L.length);R.write_shift(2,A),R.write_shift(1,P),R.write_shift(1,I),R.write_shift(1,39);for(var G=0;G<L.length;++G){var J=L.charCodeAt(G);R.write_shift(1,J>=128?95:J)}return R.write_shift(1,0),R}function C(A,I){var P=O(A);P[1].v=A.read_shift(2);var L=P[1].v>>1;if(P[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return P[1].v=L,P}function k(A,I){var P=O(A),L=A.read_shift(4),R=A.read_shift(4),G=A.read_shift(2);if(G==65535)return L===0&&R===3221225472?(P[1].t="e",P[1].v=15):L===0&&R===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var J=G&32768;return G=(G&32767)-16446,P[1].v=(1-J*2)*(R*Math.pow(2,G+32)+L*Math.pow(2,G)),P}function W(A,I,P,L){var R=Ge(14);if(R.write_shift(2,A),R.write_shift(1,P),R.write_shift(1,I),L==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var G=0,J=0,q=0,Q=0;return L<0&&(G=1,L=-L),J=Math.log2(L)|0,L/=Math.pow(2,J-31),Q=L>>>0,(Q&2147483648)==0&&(L/=2,++J,Q=L>>>0),L-=Q,Q|=2147483648,Q>>>=0,L*=Math.pow(2,32),q=L>>>0,R.write_shift(4,q),R.write_shift(4,Q),J+=16383+(G?32768:0),R.write_shift(2,J),R}function D(A,I){var P=k(A);return A.l+=I-14,P}function j(A,I){var P=O(A),L=A.read_shift(4);return P[1].v=L>>6,P}function H(A,I){var P=O(A),L=A.read_shift(8,"f");return P[1].v=L,P}function U(A,I){var P=H(A);return A.l+=I-10,P}function Y(A,I){return A[A.l+I-1]==0?A.read_shift(I,"cstr"):""}function X(A,I){var P=A[A.l++];P>I-1&&(P=I-1);for(var L="";L.length<P;)L+=String.fromCharCode(A[A.l++]);return L}function Z(A,I,P){if(!(!P.qpro||I<21)){var L=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var R=A.read_shift(I-21,"cstr");return[L,R]}}function K(A,I){for(var P={},L=A.l+I;A.l<L;){var R=A.read_shift(2);if(R==14e3){for(P[R]=[0,""],P[R][0]=A.read_shift(2);A[A.l];)P[R][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return P}function z(A,I){var P=Ge(5+A.length);P.write_shift(2,14e3),P.write_shift(2,I);for(var L=0;L<A.length;++L){var R=A.charCodeAt(L);P[P.l++]=R>127?95:R}return P[P.l++]=0,P}var se={0:{n:"BOF",f:vn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function PD(e){var t={},r=e.match(va),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Mt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=F2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var OD=(function(){var e=$f("t"),t=$f("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Qt(s[1])},c=i.match(t);return c&&(o.s=PD(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}})(),FD=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),ID=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LD=/<(?:\w+:)?r>/,DD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ny(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qt(vr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(e),r&&(n.h=W2(n.t))):e.match(LD)&&(n.r=vr(e),n.t=Qt(vr((e.replace(DD,"").match(ID)||[]).join("").replace(va,""))),r&&(n.h=FD(OD(n.r)))),n):{t:""}}var MD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,RD=/<(?:\w+:)?(?:si|sstItem)>/g,BD=/<\/(?:\w+:)?(?:si|sstItem)>/;function UD(e,t){var r=[],n="";if(!e)return r;var a=e.match(MD);if(a){n=a[2].replace(RD,"").split(BD);for(var i=0;i!=n.length;++i){var s=ny(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=Mt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var zD=/^\s|\s$|[\t\n\r]/;function Sk(e,t){if(!t.bookSST)return"";var r=[un];r[r.length]=ot("sst",null,{xmlns:Ql[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(zD)&&(i+=' xml:space="preserve"'),i+=">"+hr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function $D(e){return[e.read_shift(4),e.read_shift(4)]}function WD(e,t){var r=[],n=!1;return uo(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function HD(e,t){return t||(t=Ge(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var qD=tI;function GD(e){var t=za();Je(t,159,HD(e));for(var r=0;r<e.length;++r)Je(t,19,qD(e[r]));return Je(t,160),t.end()}function _k(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Xs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function VD(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xs(e,4),t.U=Xs(e,4),t.W=Xs(e,4),t}function YD(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function KD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YD(e));return t}function XD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function JD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xs(e,4),t.U=Xs(e,4),t.W=Xs(e,4),t}function ZD(e){var t=JD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Nk(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Ak(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function QD(e){var t=Xs(e);switch(t.Minor){case 2:return[t.Minor,eM(e)];case 3:return[t.Minor,tM()];case 4:return[t.Minor,rM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function eM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Nk(e,r),a=Ak(e,e.length-e.l);return{t:"Std",h:n,v:a}}function tM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function rM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(va,function(i){var s=Mt(i);switch(ks(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function nM(e,t){var r={},n=r.EncryptionVersionInfo=Xs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Nk(e,a),t-=a,r.EncryptionVerifier=Ak(e,t),r}function aM(e){var t={},r=t.EncryptionVersionInfo=Xs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ay(e){var t=0,r,n=_k(e),a=n.length+1,i,s,o,c,u;for(r=qo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var jk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var f=s[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(s){for(var o=_k(s),c=i(o),u=o.length,f=qo(16),d=0;d!=16;++d)f[d]=0;var p,h,m;for((u&1)===1&&(p=c>>8,f[u]=a(e[0],p),--u,p=c&255,h=o[o.length-1],f[u]=a(h,p));u>0;)--u,p=c>>8,f[u]=a(o[u],p),--u,p=c&255,f[u]=a(o[u],p);for(u=15,m=15-o.length;m>0;)p=c>>8,f[u]=a(e[m],p),--u,--m,p=c&255,f[u]=a(o[u],p),--u,--m;return f}})(),iM=function(e,t,r,n,a){a||(a=t),n||(n=jk(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},sM=function(e){var t=0,r=jk(e);return function(n){var a=iM("",n,t,r);return t=a[1],a[0]}};function oM(e,t,r,n){var a={key:vn(e),verificationBytes:vn(e)};return r.password&&(a.verifier=ay(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=sM(r.password)),a}function lM(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=aM(e):n.Data=nM(e,t),n}function cM(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?lM(e,t-2,n):oM(e,r.biff>=8?t:t-2,r,n),n}var kk=(function(){function e(a,i){switch(i.type){case"base64":return t(oi(a),i);case"binary":return t(a,i);case"buffer":return t(Gt&&Buffer.isBuffer(a)?a.toString("binary"):rl(a),i);case"array":return t(Bl(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,h=0,m,g=-1;m=p.exec(f);){switch(m[0]){case"\\cell":var x=f.slice(h,p.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++g,x.length){var b={v:x,t:"s"};Array.isArray(o)?o[d][g]=b:o[Lt({r:d,c:g})]=b}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Ht(u),o}function r(a,i){return nl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=er(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=Lt({r:u,c:f});o=c?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Qs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function uM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Gf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function fM(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function dM(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function Wh(e,t){if(t===0)return e;var r=fM(uM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Gf(dM(r))}var Ek=6,hM=15,pM=1,ua=Ek;function Vf(e){return Math.floor((e+Math.round(128/ua)/256)*ua)}function Yf(e){return Math.floor((e-5)/ua*100+.5)/100}function Hh(e){return Math.round((e*ua+5)/ua*256)/256}function zg(e){return Hh(Yf(Vf(e)))}function iy(e){var t=Math.abs(e-zg(e)),r=ua;if(t>.005)for(ua=pM;ua<hM;++ua)Math.abs(e-zg(e))<=t&&(t=Math.abs(e-zg(e)),r=ua);ua=r}function Go(e){e.width?(e.wpx=Vf(e.width),e.wch=Yf(e.wpx),e.MDW=ua):e.wpx?(e.wch=Yf(e.wpx),e.width=Hh(e.wch),e.MDW=ua):typeof e.wch=="number"&&(e.width=Hh(e.wch),e.wpx=Vf(e.width),e.MDW=ua),e.customWidth&&delete e.customWidth}var mM=96,Ck=mM;function Kf(e){return e*96/Ck}function lu(e){return e*Ck/96}var gM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xM(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(va)||[]).forEach(function(s){var o=Mt(s);switch(ks(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Cr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Cr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function vM(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(va)||[]).forEach(function(s){var o=Mt(s);switch(ks(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function yM(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(va)||[]).forEach(function(s){var o=Mt(s);switch(ks(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=vr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Cr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Cr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Cr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Cr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Cr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Cr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Cr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=F2[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Cr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Tl[a.color.index];a.color.index==81&&(c=Tl[1]),c||(c=Tl[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Wh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function bM(e,t,r){t.NumberFmt=[];for(var n=Jr(Ft),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ft[n[a]];var i=e[0].match(va);if(i)for(a=0;a<i.length;++a){var s=Mt(i[a]);switch(ks(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Qt(vr(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Ks(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function wM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ot("numFmt",null,{numFmtId:n,formatCode:hr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ot("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var q0=["numFmtId","fillId","fontId","borderId","xfId"],G0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SM(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(va)||[]).forEach(function(i){var s=Mt(i),o=0;switch(ks(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<q0.length;++o)n[q0[o]]&&(n[q0[o]]=parseInt(n[q0[o]],10));for(o=0;o<G0.length;++o)n[G0[o]]&&(n[G0[o]]=Cr(n[G0[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Cr(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function _M(e){var t=[];return t[t.length]=ot("cellXfs",null),e.forEach(function(r){t[t.length]=ot("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ot("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var NM=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&bM(d,f,u),(d=o.match(a))&&yM(d,f,c,u),(d=o.match(n))&&vM(d,f,c,u),(d=o.match(i))&&xM(d,f,c,u),(d=o.match(r))&&SM(d,f,u),f}})();function Tk(e,t){var r=[un,ot("styleSheet",null,{xmlns:Ql[0],"xmlns:vt":jn.vt})],n;return e.SSF&&(n=wM(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=_M(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function AM(e,t){var r=e.read_shift(2),n=ma(e);return[r,n]}function jM(e,t,r){r||(r=Ge(6+4*t.length)),r.write_shift(2,e),$n(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function kM(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=lI(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=oI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ma(e),n}function EM(e,t){t||(t=Ge(153)),t.write_shift(2,e.sz*20),cI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Uh(e.color,t);var n=0;return n=2,t.write_shift(1,n),$n(e.name,t),t.length>t.l?t.slice(0,t.l):t}var CM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$g,TM=xa;function rS(e,t){t||(t=Ge(84)),$g||($g=Vp(CM));var r=$g[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Uh({auto:1},t),Uh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function PM(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Pk(e,t,r){r||(r=Ge(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function uf(e,t){return t||(t=Ge(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var OM=xa;function FM(e,t){return t||(t=Ge(51)),t.write_shift(1,0),uf(null,t),uf(null,t),uf(null,t),uf(null,t),uf(null,t),t.length>t.l?t.slice(0,t.l):t}function IM(e,t){return t||(t=Ge(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Bh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function LM(e,t,r){var n=Ge(2052);return n.write_shift(4,e),Bh(t,n),Bh(r,n),n.length>n.l?n.slice(0,n.l):n}function DM(e,t,r){var n={};n.NumberFmt=[];for(var a in Ft)n.NumberFmt[a]=Ft[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return uo(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Ks(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Wh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(f);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function MM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Je(e,615,Qi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Je(e,44,jM(a,t[a]))}),Je(e,616))}}function RM(e){var t=1;Je(e,611,Qi(t)),Je(e,43,EM({sz:12,color:{theme:1},name:"Calibri",family:2})),Je(e,612)}function BM(e){var t=2;Je(e,603,Qi(t)),Je(e,45,rS({patternType:"none"})),Je(e,45,rS({patternType:"gray125"})),Je(e,604)}function UM(e){var t=1;Je(e,613,Qi(t)),Je(e,46,FM()),Je(e,614)}function zM(e){var t=1;Je(e,626,Qi(t)),Je(e,47,Pk({numFmtId:0},65535)),Je(e,627)}function $M(e,t){Je(e,617,Qi(t.length)),t.forEach(function(r){Je(e,47,Pk(r,0))}),Je(e,618)}function WM(e){var t=1;Je(e,619,Qi(t)),Je(e,48,IM({xfId:0,name:"Normal"})),Je(e,620)}function HM(e){var t=0;Je(e,505,Qi(t)),Je(e,506)}function qM(e){var t=0;Je(e,508,LM(t,"TableStyleMedium9","PivotStyleMedium4")),Je(e,509)}function GM(e,t){var r=za();return Je(r,278),MM(r,e.SSF),RM(r),BM(r),UM(r),zM(r),$M(r,t.cellXfs),WM(r),HM(r),qM(r),Je(r,279),r.end()}var VM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YM(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(va)||[]).forEach(function(a){var i=Mt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[VM.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function KM(){}function XM(){}var JM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,QM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eR(e,t,r){t.themeElements={};var n;[["clrScheme",JM,YM],["fontScheme",ZM,KM],["fmtScheme",QM,XM]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var tR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ok(e,t){(!e||e.length===0)&&(e=sy());var r,n={};if(!(r=e.match(tR)))throw new Error("themeElements not found in theme");return eR(r[0],n,t),n.raw=e,n}function sy(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[un];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rR(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=Nj(i,{type:"array"})}catch{return}var o=ri(s,"theme/theme/theme1.xml",!0);if(o)return Ok(o,r)}}function nR(e){return e.read_shift(4)}function aR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=iR(e,4);break;case 2:t.xclrValue=fk(e);break;case 3:t.xclrValue=nR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function iR(e,t){return xa(e,t)}function sR(e,t){return xa(e,t)}function oR(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=aR(e);break;case 6:n[1]=sR(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function lR(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(oR(e,r-e.l));return{ixfe:n,ext:i}}function cR(e,t){t.forEach(function(r){r[0]})}function uR(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ma(e)}}function fR(e){var t=Ge(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),$n(e.name,t),t.slice(0,t.l)}function dR(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function hR(e){var t=Ge(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function pR(e,t){var r=Ge(8+2*t.length);return r.write_shift(4,e),$n(t,r),r.slice(0,r.l)}function mR(e){return e.l+=4,e.read_shift(4)!=0}function gR(e,t){var r=Ge(8);return r.write_shift(4,e),r.write_shift(4,1),r}function xR(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return uo(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function vR(){var e=za();return Je(e,332),Je(e,334,Qi(1)),Je(e,335,fR({name:"XLDAPR",version:12e4,flags:3496657072})),Je(e,336),Je(e,339,pR(1,"XLDAPR")),Je(e,52),Je(e,35,Qi(514)),Je(e,4096,Qi(0)),Je(e,4097,ki(1)),Je(e,36),Je(e,53),Je(e,340),Je(e,337,gR(1)),Je(e,51,hR([[1,0]])),Je(e,338),Je(e,333),e.end()}function yR(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(va,function(o){var c=Mt(o);switch(ks(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Fk(){var e=[un];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function bR(e){var t=[];if(!e)return t;var r=1;return(e.match(va)||[]).forEach(function(n){var a=Mt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function wR(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Lt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function SR(e,t,r){var n=[];return uo(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function _R(e,t,r,n){if(!e)return e;var a=n||{},i=!1;uo(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function NR(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var qc=1024;function Ik(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ot("xml",null,{"xmlns:v":Qa.v,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:mv":Qa.mv}).replace(/\/>/,">"),ot("o:shapelayout",ot("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ot("v:shapetype",[ot("v:stroke",null,{joinstyle:"miter"}),ot("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];qc<e*1e3;)qc+=1e3;return t.forEach(function(i){var s=Ur(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ot("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ot("v:fill",c,o),f={on:"t",obscured:"t"};++qc,a=a.concat(["<v:shape"+Wf({id:"_x0000_s"+qc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ot("v:shadow",null,f),ot("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Zn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Zn("x:AutoFill","False"),Zn("x:Row",String(s.r)),Zn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function nS(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Ur(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=er(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Ht(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:r};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}i.c.push(f)})}function AR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Mt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Ur(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!d&&!!d[1]&&ny(d[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function Lk(e){var t=[un,ot("comments",null,{xmlns:Ql[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=hr(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(hr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Zn("t",hr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Zn("t",hr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function jR(e,t){var r=[],n=!1,a={},i=0;return e.replace(va,function(o,c){var u=Mt(o);switch(ks(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function kR(e,t,r){var n=[un,ot("ThreadedComments",null,{xmlns:jn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(ot("threadedComment",Zn("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function ER(e,t){var r=[],n=!1;return e.replace(va,function(i){var s=Mt(i);switch(ks(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function CR(e){var t=[un,ot("personList",null,{xmlns:jn.TCMNT,"xmlns:x":Ql[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ot("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function TR(e){var t={};t.iauthor=e.read_shift(4);var r=nc(e);return t.rfx=r.s,t.ref=Lt(r.s),e.l+=16,t}function PR(e,t){return t==null&&(t=Ge(36)),t.write_shift(4,e[1].iauthor),wu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var OR=ma;function FR(e){return $n(e.slice(0,54))}function IR(e,t){var r=[],n=[],a={},i=!1;return uo(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function LR(e){var t=za(),r=[];return Je(t,628),Je(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Je(t,632,FR(a.a)))})}),Je(t,631),Je(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Ur(n[0]),e:Ur(n[0])};Je(t,635,PR([i,a])),a.t&&a.t.length>0&&Je(t,637,nI(a)),Je(t,636),delete a.iauthor})}),Je(t,634),Je(t,629),t.end()}var DR="application/vnd.ms-office.vbaProject";function MR(e){var t=jt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");jt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),jt.write(t)}function RR(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&jt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Dk=["xlsb","xlsm","xlam","biff8","xla"];function BR(){return{"!type":"dialog"}}function UR(){return{"!type":"dialog"}}function zR(){return{"!type":"macro"}}function $R(){return{"!type":"macro"}}var Jc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,a+(o?"":"$")+Br(f)+(c?"":"$")+cn(u)}return function(a,i){return t=i,a.replace(e,r)}})(),oy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ly=(function(){return function(t,r){return t.replace(oy,function(n,a,i,s,o,c){var u=Y2(s)-(i?0:r.c),f=V2(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=u==0?"":i?u+1:"["+u+"]";return a+"R"+d+"C"+p})}})();function Mk(e,t){return e.replace(oy,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Br(Y2(i)+t.c))+(s=="$"?s+o:cn(V2(o)+t.r))})}function WR(e,t,r){var n=$a(t),a=n.s,i=Ur(r),s={r:i.r-a.r,c:i.c-a.c};return Mk(e,s)}function HR(e){return e.length!=1}function aS(e){return e.replace(/_xlfn\./g,"")}function gn(e){e.l+=1}function Vo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Rk(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Bk(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Vo(e),o=Vo(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Bk(e){var t=Vo(e),r=Vo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function qR(e,t,r){if(r.biff<8)return Bk(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Vo(e),s=Vo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Uk(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return GR(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Vo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function GR(e){var t=Vo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function VR(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YR(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return KR(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function KR(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function XR(e,t,r){var n=(e[e.l++]&96)>>5,a=Rk(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function JR(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Rk(e,i,r);return[n,a,s]}function ZR(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function QR(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function e9(e,t,r){var n=(e[e.l++]&96)>>5,a=qR(e,t-1,r);return[n,a]}function t9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function iS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function r9(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function n9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function a9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function i9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function s9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function zk(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function o9(e){return e.read_shift(2),zk(e)}function l9(e){return e.read_shift(2),zk(e)}function c9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Uk(e,0,r);return[n,a]}function u9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=YR(e,0,r);return[n,a]}function f9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Uk(e,0,r);return[n,a,i]}function d9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[mB[a],Hk[a],n]}function h9(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:p9(e);return[a,(i[0]===0?Hk:pB)[i[1]]]}function p9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function m9(e,t,r){e.l+=r&&r.biff==2?3:4}function g9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function x9(e){return e.l++,fo[e.read_shift(1)]}function v9(e){return e.l++,e.read_shift(2)}function y9(e){return e.l++,e.read_shift(1)!==0}function b9(e){return e.l++,da(e)}function w9(e,t,r){return e.l++,yd(e,t-1,r)}function S9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=nn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=da(e);break;case 2:r[1]=ac(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?nc:Xp)(e));return a}function N9(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=S9(e,r.biff);return s}function A9(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function j9(e,t,r){if(r.biff==5)return k9(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function k9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function E9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function C9(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function T9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function P9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var O9=xa,F9=xa,I9=xa;function wd(e,t,r){return e.l+=2,[VR(e)]}function cy(e){return e.l+=6,[]}var L9=wd,D9=cy,M9=cy,R9=wd;function $k(e){return e.l+=2,[vn(e),e.read_shift(2)&1]}var B9=wd,U9=$k,z9=cy,$9=wd,W9=wd,H9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function q9(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=H9[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function G9(e){return e.l+=2,[e.read_shift(4)]}function V9(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Y9(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function K9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function X9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function J9(e){return e.l+=4,[0,0]}var sS={1:{n:"PtgExp",f:g9},2:{n:"PtgTbl",f:I9},3:{n:"PtgAdd",f:gn},4:{n:"PtgSub",f:gn},5:{n:"PtgMul",f:gn},6:{n:"PtgDiv",f:gn},7:{n:"PtgPower",f:gn},8:{n:"PtgConcat",f:gn},9:{n:"PtgLt",f:gn},10:{n:"PtgLe",f:gn},11:{n:"PtgEq",f:gn},12:{n:"PtgGe",f:gn},13:{n:"PtgGt",f:gn},14:{n:"PtgNe",f:gn},15:{n:"PtgIsect",f:gn},16:{n:"PtgUnion",f:gn},17:{n:"PtgRange",f:gn},18:{n:"PtgUplus",f:gn},19:{n:"PtgUminus",f:gn},20:{n:"PtgPercent",f:gn},21:{n:"PtgParen",f:gn},22:{n:"PtgMissArg",f:gn},23:{n:"PtgStr",f:w9},26:{n:"PtgSheet",f:V9},27:{n:"PtgEndSheet",f:Y9},28:{n:"PtgErr",f:x9},29:{n:"PtgBool",f:y9},30:{n:"PtgInt",f:v9},31:{n:"PtgNum",f:b9},32:{n:"PtgArray",f:t9},33:{n:"PtgFunc",f:d9},34:{n:"PtgFuncVar",f:h9},35:{n:"PtgName",f:A9},36:{n:"PtgRef",f:c9},37:{n:"PtgArea",f:XR},38:{n:"PtgMemArea",f:E9},39:{n:"PtgMemErr",f:O9},40:{n:"PtgMemNoMem",f:F9},41:{n:"PtgMemFunc",f:C9},42:{n:"PtgRefErr",f:T9},43:{n:"PtgAreaErr",f:ZR},44:{n:"PtgRefN",f:u9},45:{n:"PtgAreaN",f:e9},46:{n:"PtgMemAreaN",f:K9},47:{n:"PtgMemNoMemN",f:X9},57:{n:"PtgNameX",f:j9},58:{n:"PtgRef3d",f:f9},59:{n:"PtgArea3d",f:JR},60:{n:"PtgRefErr3d",f:P9},61:{n:"PtgAreaErr3d",f:QR},255:{}},Z9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Q9={1:{n:"PtgElfLel",f:$k},2:{n:"PtgElfRw",f:$9},3:{n:"PtgElfCol",f:L9},6:{n:"PtgElfRwV",f:W9},7:{n:"PtgElfColV",f:R9},10:{n:"PtgElfRadical",f:B9},11:{n:"PtgElfRadicalS",f:z9},13:{n:"PtgElfColS",f:D9},15:{n:"PtgElfColSV",f:M9},16:{n:"PtgElfRadicalLel",f:U9},25:{n:"PtgList",f:q9},29:{n:"PtgSxName",f:G9},255:{}},eB={0:{n:"PtgAttrNoop",f:J9},1:{n:"PtgAttrSemi",f:s9},2:{n:"PtgAttrIf",f:a9},4:{n:"PtgAttrChoose",f:r9},8:{n:"PtgAttrGoto",f:n9},16:{n:"PtgAttrSum",f:m9},32:{n:"PtgAttrBaxcel",f:iS},33:{n:"PtgAttrBaxcel",f:iS},64:{n:"PtgAttrSpace",f:o9},65:{n:"PtgAttrSpaceSemi",f:l9},128:{n:"PtgAttrIfError",f:i9},255:{}};function Sd(e,t,r,n){if(n.biff<8)return xa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=N9(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=_9(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(xa(e,t)),i}function _d(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=sS[i]||sS[Z9[i]],(i===24||i===25)&&(a=(i===24?Q9:eB)[e[e.l+1]]),!a||!a.f?xa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function tB(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var rB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Wk(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function oS(e,t,r){var n=Wk(e,t,r);return n=="#REF"?n:nB(n,r)}function ca(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,u,f,d=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,x="",b=0,S=e[0].length;b<S;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:x=Yr(" ",e[0][g][1][1]);break;case 1:x=Yr("\r",e[0][g][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+x,g=-1}o.push(u+rB[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Cf(_[1][1],s,a),o.push(Tf(f,i));break;case"PtgRefN":f=r?Cf(_[1][1],r,a):_[1][1],o.push(Tf(f,i));break;case"PtgRef3d":d=_[1][1],f=Cf(_[1][2],s,a),m=oS(n,d,a),o.push(m+"!"+Tf(f,i));break;case"PtgFunc":case"PtgFuncVar":var E=_[1][0],O=_[1][1];E||(E=0),E&=127;var F=E==0?[]:o.slice(-E);o.length-=E,O==="User"&&(O=F.shift()),o.push(O+"("+F.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=D5(_[1][1],r?{s:r}:s,a),o.push(Rg(h,a));break;case"PtgArea":h=D5(_[1][1],s,a),o.push(Rg(h,a));break;case"PtgArea3d":d=_[1][1],h=_[1][2],m=oS(n,d,a),o.push(m+"!"+Rg(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var M=(n.names||[])[p-1]||(n[0]||[])[p],C=M?M.Name:"SH33TJSNAME"+String(p);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var k=_[1][1];p=_[1][2];var W;if(a.biff<=5)k<0&&(k=-k),n[k]&&(W=n[k][p]);else{var D="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][p]&&n[k][p].itab>0&&(D=n.SheetNames[n[k][p].itab-1]+"!"):D=n.SheetNames[p-1]+"!"),n[k]&&n[k][p])D+=n[k][p].Name;else if(n[0]&&n[0][p])D+=n[0][p].Name;else{var j=(Wk(n,k,a)||"").split(";;");j[p-1]?D=j[p-1]:D+="SH33TJSERRX"}o.push(D);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var H="(",U=")";if(g>=0){switch(x="",e[0][g][1][0]){case 2:H=Yr(" ",e[0][g][1][1])+H;break;case 3:H=Yr("\r",e[0][g][1][1])+H;break;case 4:U=Yr(" ",e[0][g][1][1])+U;break;case 5:U=Yr("\r",e[0][g][1][1])+U;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(H+o.pop()+U);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var Y={c:r.c,r:r.r};if(n.sharedf[Lt(f)]){var X=n.sharedf[Lt(f)];o.push(ca(X,s,Y,n,a))}else{var Z=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ca(u[1],s,Y,n,a)),Z=!0;break}Z||o.push(_[1])}break;case"PtgArray":o.push("{"+tB(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&K.indexOf(e[0][b][0])==-1){_=e[0][g];var z=!0;switch(_[1][0]){case 4:z=!1;case 0:x=Yr(" ",_[1][1]);break;case 5:z=!1;case 1:x=Yr("\r",_[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((z?x:"")+o.pop()+(z?"":x)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function aB(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],xa(e,t-2)];var o=_d(e,s,r);return t!==s+a&&(i=Sd(e,t-s-a,o,r)),e.l=n,[o,i]}function iB(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],xa(e,t-2)];var o=_d(e,s,r);return t!==s+a&&(i=Sd(e,t-s-a,o,r)),e.l=n,[o,i]}function sB(e,t,r,n){var a=e.l+t,i=_d(e,n,r),s;return a!==e.l&&(s=Sd(e,a-e.l,i,r)),[i,s]}function oB(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=_d(e,i,r);return i==65535?[[],xa(e,t-2)]:(t!==i+2&&(a=Sd(e,n-i-2,s,r)),[s,a])}function lB(e){var t;if(Hs(e,e.l+6)!==65535)return[da(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function cB(e){if(e==null){var t=Ge(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ul(e);return Ul(0)}function Wg(e,t,r){var n=e.l+t,a=Es(e);r.biff==2&&++e.l;var i=lB(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=iB(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function uB(e,t,r,n,a){var i=$l(t,r,a),s=cB(e.v),o=Ge(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=Ge(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=zn([i,s,o,u]);return d}function Jp(e,t,r){var n=e.read_shift(4),a=_d(e,n,r),i=e.read_shift(4),s=i>0?Sd(e,i,a,r):null;return[a,s]}var fB=Jp,Zp=Jp,dB=Jp,hB=Jp,pB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gB(e){var t="of:="+e.replace(oy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Hg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function xB(e){return e.replace(/\./,"!")}var Of={},Zc={},Ff=typeof Map<"u";function uy(e,t,r){var n=0,a=e.length;if(r){if(Ff?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ff?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Ff?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Qp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ua=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Yf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Hh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Fl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function al(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ks(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function qk(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ft[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Pr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ft[t]==null&&Ks(p7[t]||"General",t),e.t==="e")e.w=e.w||fo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zf(e.v);else if(e.t==="d"){var s=kn(e.v);(s|0)===s?e.w=s.toString(10):e.w=zf(s)}else{if(e.v===void 0)return"";e.w=Rl(e.v,Zc)}else e.t==="d"?e.w=Ti(t,kn(e.v),Zc):e.w=Ti(t,e.v,Zc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Wh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Wh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function vB(e,t,r){if(e&&e["!ref"]){var n=er(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function yB(e,t){var r=er(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ht(r))}var bB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,wB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,SB=/<(?:\w:)?hyperlink [^>]*>/mg,_B=/"(\w*:\w*)"/,NB=/<(?:\w:)?col\b[^>]*[\/]?>/g,AB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jB=/<(?:\w:)?pageMargins[^>]*\/>/g,Gk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function CB(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(wB);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var p=u.match(Gk);p?fy(p[0],o,a,r):(p=u.match(kB))&&PB(p[0],p[1]||"",o,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(_B);m&&yB(o,m[1])}var g=u.match(EB);g&&g[1]&&HB(g[1],a);var x=[];if(t.cellStyles){var b=u.match(NB);b&&BB(x,b)}d&&VB(d[1],o,t,c,i,s);var S=f.match(AB);S&&(o["!autofilter"]=zB(S[0]));var _=[],E=f.match(bB);if(E)for(h=0;h!=E.length;++h)_[h]=er(E[h].slice(E[h].indexOf('"')+1));var O=f.match(SB);O&&DB(o,O,n);var F=f.match(jB);if(F&&(o["!margins"]=MB(Mt(F[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ht(c)),t.sheetRows>0&&o["!ref"]){var M=er(o["!ref"]);t.sheetRows<=+M.e.r&&(M.e.r=t.sheetRows-1,M.e.r>c.e.r&&(M.e.r=c.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>c.e.c&&(M.e.c=c.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ht(M))}return x.length>0&&(o["!cols"]=x),_.length>0&&(o["!merges"]=_),o}function TB(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ht(e[r])+'"/>';return t+"</mergeCells>"}function fy(e,t,r,n){var a=Mt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Qt(vr(a.codeName)))}function PB(e,t,r,n,a){fy(e.slice(0,e.indexOf(">")),r,n,a)}function OB(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=ys(hr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ot("outlinePr",null,u)}!i&&!o||(a[a.length]=ot("sheetPr",o,s))}var FB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],IB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LB(e){var t={sheet:1};return FB.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),IB.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ay(e.password).toString(16).toUpperCase()),ot("sheetProtection",null,t)}function DB(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Mt(vr(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Qt(i.location))):(i.Target="#"+Qt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=er(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=Lt({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function MB(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function RB(e){return Fl(e),ot("pageMargins",null,e)}function BB(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Mt(t[n],!0);a.hidden&&(a.hidden=Cr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,iy(a.width)),Go(a);i<=s;)e[i++]=Or(a)}}function UB(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ot("col",null,Qp(a,n)));return r[r.length]="</cols>",r.join("")}function zB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function $B(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ht(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=$a(a);s.s.r==s.e.r&&(s.e.r=$a(t["!ref"]).e.r,a=Ht(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ot("autoFilter",null,{ref:a})}var WB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function HB(e,t){t.Views||(t.Views=[{}]),(e.match(WB)||[]).forEach(function(r,n){var a=Mt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Cr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function qB(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ot("sheetViews",ot("sheetView",null,a),{})}function GB(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=fo[e.v];break;case"d":n&&n.cellDates?a=Pr(e.v,-1).toISOString():(e=Or(e),e.t="n",a=""+(e.v=kn(Pr(e.v)))),typeof e.z>"u"&&(e.z=Ft[14]);break;default:a=e.v;break}var o=Zn("v",hr(a)),c={r:t},u=al(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Zn("v",""+uy(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ot("f",hr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ot("c",o,c)}var VB=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=$f("v"),s=$f("f");return function(c,u,f,d,p,h){for(var m=0,g="",x=[],b=[],S=0,_=0,E=0,O="",F,M,C=0,k=0,W,D,j=0,H=0,U=Array.isArray(h.CellXf),Y,X=[],Z=[],K=Array.isArray(u),z=[],se={},xe=!1,A=!!f.sheetStubs,I=c.split(t),P=0,L=I.length;P!=L;++P){g=I[P].trim();var R=g.length;if(R!==0){var G=0;e:for(m=0;m<R;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(M=Mt(g.slice(G,m),!0),C=M.r!=null?parseInt(M.r,10):C+1,k=-1,f.sheetRows&&f.sheetRows<C)continue;se={},xe=!1,M.ht&&(xe=!0,se.hpt=parseFloat(M.ht),se.hpx=lu(se.hpt)),M.hidden=="1"&&(xe=!0,se.hidden=!0),M.outlineLevel!=null&&(xe=!0,se.level=+M.outlineLevel),xe&&(z[C-1]=se)}break;case"<":G=m;break}if(G>=m)break;if(M=Mt(g.slice(G,m),!0),C=M.r!=null?parseInt(M.r,10):C+1,k=-1,!(f.sheetRows&&f.sheetRows<C)){d.s.r>C-1&&(d.s.r=C-1),d.e.r<C-1&&(d.e.r=C-1),f&&f.cellStyles&&(se={},xe=!1,M.ht&&(xe=!0,se.hpt=parseFloat(M.ht),se.hpx=lu(se.hpt)),M.hidden=="1"&&(xe=!0,se.hidden=!0),M.outlineLevel!=null&&(xe=!0,se.level=+M.outlineLevel),xe&&(z[C-1]=se)),x=g.slice(m).split(e);for(var J=0;J!=x.length&&x[J].trim().charAt(0)=="<";++J);for(x=x.slice(J),m=0;m!=x.length;++m)if(g=x[m].trim(),g.length!==0){if(b=g.match(r),S=m,_=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(S=0,O=b[1],_=0;_!=O.length&&!((E=O.charCodeAt(_)-64)<1||E>26);++_)S=26*S+E;--S,k=S}else++k;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,M=Mt(g.slice(0,_),!0),M.r||(M.r=Lt({r:C-1,c:k})),O=g.slice(_),F={t:""},(b=O.match(i))!=null&&b[1]!==""&&(F.v=Qt(b[1])),f.cellFormula){if((b=O.match(s))!=null&&b[1]!==""){if(F.f=Qt(vr(b[1])).replace(/\r\n/g,`
`),f.xlfn||(F.f=aS(F.f)),b[0].indexOf('t="array"')>-1)F.F=(O.match(a)||[])[1],F.F.indexOf(":")>-1&&X.push([er(F.F),F.F]);else if(b[0].indexOf('t="shared"')>-1){D=Mt(b[0]);var q=Qt(vr(b[1]));f.xlfn||(q=aS(q)),Z[parseInt(D.si,10)]=[D,q,M.r]}}else(b=O.match(/<f[^>]*\/>/))&&(D=Mt(b[0]),Z[D.si]&&(F.f=WR(Z[D.si][1],Z[D.si][2],M.r)));var Q=Ur(M.r);for(_=0;_<X.length;++_)Q.r>=X[_][0].s.r&&Q.r<=X[_][0].e.r&&Q.c>=X[_][0].s.c&&Q.c<=X[_][0].e.c&&(F.F=X[_][1])}if(M.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(A)F.t="z";else continue;else F.t=M.t||"n";switch(d.s.c>k&&(d.s.c=k),d.e.c<k&&(d.e.c=k),F.t){case"n":if(F.v==""||F.v==null){if(!A)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!A)continue;F.t="z"}else W=Of[parseInt(F.v,10)],F.v=W.t,F.r=W.r,f.cellHTML&&(F.h=W.h);break;case"str":F.t="s",F.v=F.v!=null?vr(F.v):"",f.cellHTML&&(F.h=W2(F.v));break;case"inlineStr":b=O.match(n),F.t="s",b!=null&&(W=ny(b[1]))?(F.v=W.t,f.cellHTML&&(F.h=W.h)):F.v="";break;case"b":F.v=Cr(F.v);break;case"d":f.cellDates?F.v=Pr(F.v,1):(F.v=kn(Pr(F.v,1)),F.t="n");break;case"e":(!f||f.cellText!==!1)&&(F.w=F.v),F.v=Yj[F.v];break}if(j=H=0,Y=null,U&&M.s!==void 0&&(Y=h.CellXf[M.s],Y!=null&&(Y.numFmtId!=null&&(j=Y.numFmtId),f.cellStyles&&Y.fillId!=null&&(H=Y.fillId))),qk(F,j,H,f,p,h),f.cellDates&&U&&F.t=="n"&&vu(Ft[j])&&(F.t="d",F.v=Kp(F.v)),M.cm&&f.xlmeta){var fe=(f.xlmeta.Cell||[])[+M.cm-1];fe&&fe.type=="XLDAPR"&&(F.D=!0)}if(K){var V=Ur(M.r);u[V.r]||(u[V.r]=[]),u[V.r][V.c]=F}else u[M.r]=F}}}}z.length>0&&(u["!rows"]=z)}})();function YB(e,t,r,n){var a=[],i=[],s=er(e["!ref"]),o="",c,u="",f=[],d=0,p=0,h=e["!rows"],m=Array.isArray(e),g={r:u},x,b=-1;for(p=s.s.c;p<=s.e.c;++p)f[p]=Br(p);for(d=s.s.r;d<=s.e.r;++d){for(i=[],u=cn(d),p=s.s.c;p<=s.e.c;++p){c=f[p]+u;var S=m?(e[d]||[])[p]:e[c];S!==void 0&&(o=GB(S,c,e,t))!=null&&i.push(o)}(i.length>0||h&&h[d])&&(g={r:u},h&&h[d]&&(x=h[d],x.hidden&&(g.hidden=1),b=-1,x.hpx?b=Kf(x.hpx):x.hpt&&(b=x.hpt),b>-1&&(g.ht=b,g.customHeight=1),x.level&&(g.outlineLevel=x.level)),a[a.length]=ot("row",i.join(""),g))}if(h)for(;d<h.length;++d)h&&h[d]&&(g={r:d+1},x=h[d],x.hidden&&(g.hidden=1),b=-1,x.hpx?b=Kf(x.hpx):x.hpt&&(b=x.hpt),b>-1&&(g.ht=b,g.customHeight=1),x.level&&(g.outlineLevel=x.level),a[a.length]=ot("row","",g));return a.join("")}function Vk(e,t,r,n){var a=[un,ot("worksheet",null,{xmlns:Ql[0],"xmlns:r":jn.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",f=er(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Ht(f)}n||(n={}),c["!comments"]=[];var d=[];OB(c,r,e,t,a),a[a.length]=ot("dimension",null,{ref:u}),a[a.length]=qB(c,t,e,r),t.sheetFormat&&(a[a.length]=ot("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=UB(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=YB(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=LB(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=$B(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=TB(c["!merges"]));var p=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=fr(n,-1,hr(g[1].Target).replace(/#.*$/,""),Vt.HLINK),h["r:id"]="rId"+m),(p=g[1].Target.indexOf("#"))>-1&&(h.location=hr(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=hr(g[1].Tooltip)),a[a.length]=ot("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=RB(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Zn("ignoredErrors",ot("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(m=fr(n,-1,"../drawings/drawing"+(e+1)+".xml",Vt.DRAW),a[a.length]=ot("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=fr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Vt.VML),a[a.length]=ot("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function KB(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function XB(e,t,r){var n=Ge(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Kf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,p=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Lt(u)];m&&(d<0&&(d=h),p=h)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function JB(e,t,r,n){var a=XB(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Je(e,0,a)}var ZB=nc,QB=wu;function eU(){}function tU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=aI(e),r}function rU(e,t,r){r==null&&(r=Ge(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Uh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Wj(e,r),r.slice(0,r.l)}function nU(e){var t=Fi(e);return[t]}function aU(e,t,r){return r==null&&(r=Ge(8)),ec(t,r)}function iU(e){var t=tc(e);return[t]}function sU(e,t,r){return r==null&&(r=Ge(4)),rc(t,r)}function oU(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"b"]}function lU(e,t,r){return r==null&&(r=Ge(9)),ec(t,r),r.write_shift(1,e.v?1:0),r}function cU(e){var t=tc(e),r=e.read_shift(1);return[t,r,"b"]}function uU(e,t,r){return r==null&&(r=Ge(5)),rc(t,r),r.write_shift(1,e.v?1:0),r}function fU(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"e"]}function dU(e,t,r){return r==null&&(r=Ge(9)),ec(t,r),r.write_shift(1,e.v),r}function hU(e){var t=tc(e),r=e.read_shift(1);return[t,r,"e"]}function pU(e,t,r){return r==null&&(r=Ge(8)),rc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function mU(e){var t=Fi(e),r=e.read_shift(4);return[t,r,"s"]}function gU(e,t,r){return r==null&&(r=Ge(12)),ec(t,r),r.write_shift(4,t.v),r}function xU(e){var t=tc(e),r=e.read_shift(4);return[t,r,"s"]}function vU(e,t,r){return r==null&&(r=Ge(8)),rc(t,r),r.write_shift(4,t.v),r}function yU(e){var t=Fi(e),r=da(e);return[t,r,"n"]}function bU(e,t,r){return r==null&&(r=Ge(16)),ec(t,r),Ul(e.v,r),r}function Yk(e){var t=tc(e),r=da(e);return[t,r,"n"]}function wU(e,t,r){return r==null&&(r=Ge(12)),rc(t,r),Ul(e.v,r),r}function SU(e){var t=Fi(e),r=Z2(e);return[t,r,"n"]}function _U(e,t,r){return r==null&&(r=Ge(12)),ec(t,r),Hj(e.v,r),r}function NU(e){var t=tc(e),r=Z2(e);return[t,r,"n"]}function AU(e,t,r){return r==null&&(r=Ge(8)),rc(t,r),Hj(e.v,r),r}function jU(e){var t=Fi(e),r=K2(e);return[t,r,"is"]}function kU(e){var t=Fi(e),r=ma(e);return[t,r,"str"]}function EU(e,t,r){return r==null&&(r=Ge(12+4*e.v.length)),ec(t,r),$n(e.v,r),r.length>r.l?r.slice(0,r.l):r}function CU(e){var t=tc(e),r=ma(e);return[t,r,"str"]}function TU(e,t,r){return r==null&&(r=Ge(8+4*e.v.length)),rc(t,r),$n(e.v,r),r.length>r.l?r.slice(0,r.l):r}function PU(e,t,r){var n=e.l+t,a=Fi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Zp(e,n-e.l,r);s[3]=ca(o,null,a,r.supbooks,r)}else e.l=n;return s}function OU(e,t,r){var n=e.l+t,a=Fi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Zp(e,n-e.l,r);s[3]=ca(o,null,a,r.supbooks,r)}else e.l=n;return s}function FU(e,t,r){var n=e.l+t,a=Fi(e);a.r=r["!row"];var i=da(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Zp(e,n-e.l,r);s[3]=ca(o,null,a,r.supbooks,r)}else e.l=n;return s}function IU(e,t,r){var n=e.l+t,a=Fi(e);a.r=r["!row"];var i=ma(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Zp(e,n-e.l,r);s[3]=ca(o,null,a,r.supbooks,r)}else e.l=n;return s}var LU=nc,DU=wu;function MU(e,t){return t==null&&(t=Ge(4)),t.write_shift(4,e),t}function RU(e,t){var r=e.l+t,n=nc(e),a=X2(e),i=ma(e),s=ma(e),o=ma(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function BU(e,t){var r=Ge(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));wu({s:Ur(e[0]),e:Ur(e[0])},r),J2("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return $n(a||"",r),$n(e[1].Tooltip||"",r),$n("",r),r.slice(0,r.l)}function UU(){}function zU(e,t,r){var n=e.l+t,a=qj(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=fB(e,n-e.l,r);s[1]=o}else e.l=n;return s}function $U(e,t,r){var n=e.l+t,a=nc(e),i=[a];if(r.cellFormula){var s=hB(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function WU(e,t,r){r==null&&(r=Ge(18));var n=Qp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var Kk=["left","right","top","bottom","header","footer"];function HU(e){var t={};return Kk.forEach(function(r){t[r]=da(e)}),t}function qU(e,t){return t==null&&(t=Ge(48)),Fl(e),Kk.forEach(function(r){Ul(e[r],t)}),t}function GU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function VU(e,t,r){r==null&&(r=Ge(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function YU(e){var t=Ge(24);return t.write_shift(4,4),t.write_shift(4,1),wu(e,t),t}function KU(e,t){return t==null&&(t=Ge(66)),t.write_shift(2,e.password?ay(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function XU(){}function JU(){}function ZU(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,p=!1,h,m,g,x,b,S,_,E,O,F=[];o.biff=12,o["!row"]=0;var M=0,C=!1,k=[],W={},D=o.supbooks||a.supbooks||[[]];if(D.sharedf=W,D.arrayf=k,D.SheetNames=a.SheetNames||a.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=D,a.Names))for(var j=0;j<a.Names.length;++j)D[0][j+1]=a.Names[j];var H=[],U=[],Y=!1;Xf[16]={n:"BrtShortReal",f:Yk};var X;if(uo(e,function(z,se,xe){if(!p)switch(xe){case 148:u=z;break;case 0:h=z,o.sheetRows&&o.sheetRows<=h.r&&(p=!0),E=cn(x=h.r),o["!row"]=h.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=lu(z.hpt)),U[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:z[2]},z[2]){case"n":m.v=z[1];break;case"s":_=Of[z[1]],m.v=_.t,m.r=_.r;break;case"b":m.v=!!z[1];break;case"e":m.v=z[1],o.cellText!==!1&&(m.w=fo[m.v]);break;case"str":m.t="s",m.v=z[1];break;case"is":m.t="s",m.v=z[1].t;break}if((g=s.CellXf[z[0].iStyleRef])&&qk(m,g.numFmtId,null,o,i,s),b=z[0].c==-1?b+1:z[0].c,o.dense?(c[x]||(c[x]=[]),c[x][b]=m):c[Br(b)+E]=m,o.cellFormula){for(C=!1,M=0;M<k.length;++M){var A=k[M];h.r>=A[0].s.r&&h.r<=A[0].e.r&&b>=A[0].s.c&&b<=A[0].e.c&&(m.F=Ht(A[0]),C=!0)}!C&&z.length>3&&(m.f=z[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>b&&(f.s.c=b),f.e.r<h.r&&(f.e.r=h.r),f.e.c<b&&(f.e.c=b),o.cellDates&&g&&m.t=="n"&&vu(Ft[g.numFmtId])){var I=Al(m.v);I&&(m.t="d",m.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}X&&(X.type=="XLDAPR"&&(m.D=!0),X=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;m={t:"z",v:void 0},b=z[0].c==-1?b+1:z[0].c,o.dense?(c[x]||(c[x]=[]),c[x][b]=m):c[Br(b)+E]=m,f.s.r>h.r&&(f.s.r=h.r),f.s.c>b&&(f.s.c=b),f.e.r<h.r&&(f.e.r=h.r),f.e.c<b&&(f.e.c=b),X&&(X.type=="XLDAPR"&&(m.D=!0),X=void 0);break;case 176:F.push(z);break;case 49:X=((o.xlmeta||{}).Cell||[])[z-1];break;case 494:var P=n["!id"][z.relId];for(P?(z.Target=P.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=P):z.relId==""&&(z.Target="#"+z.loc),x=z.rfx.s.r;x<=z.rfx.e.r;++x)for(b=z.rfx.s.c;b<=z.rfx.e.c;++b)o.dense?(c[x]||(c[x]=[]),c[x][b]||(c[x][b]={t:"z",v:void 0}),c[x][b].l=z):(S=Lt({c:b,r:x}),c[S]||(c[S]={t:"z",v:void 0}),c[S].l=z);break;case 426:if(!o.cellFormula)break;k.push(z),O=o.dense?c[x][b]:c[Br(b)+E],O.f=ca(z[1],f,{r:h.r,c:b},D,o),O.F=Ht(z[0]);break;case 427:if(!o.cellFormula)break;W[Lt(z[0].s)]=z[1],O=o.dense?c[x][b]:c[Br(b)+E],O.f=ca(z[1],f,{r:h.r,c:b},D,o);break;case 60:if(!o.cellStyles)break;for(;z.e>=z.s;)H[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},Y||(Y=!0,iy(z.w/256)),Go(H[z.e+1]);break;case 161:c["!autofilter"]={ref:Ht(z)};break;case 476:c["!margins"]=z;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),z.name&&(a.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),z.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!se.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ht(u||f)),o.sheetRows&&c["!ref"]){var Z=er(c["!ref"]);o.sheetRows<=+Z.e.r&&(Z.e.r=o.sheetRows-1,Z.e.r>f.e.r&&(Z.e.r=f.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>f.e.c&&(Z.e.c=f.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ht(Z))}return F.length>0&&(c["!merges"]=F),H.length>0&&(c["!cols"]=H),U.length>0&&(c["!rows"]=U),c}function QU(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Or(t),t.z=t.z||Ft[14],t.v=kn(Pr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=al(a.cellXfs,t,a),t.l&&i["!links"].push([Lt(c),t.l]),t.c&&i["!comments"].push([Lt(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=uy(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?Je(e,18,vU(t,c)):Je(e,7,gU(t,c))):(c.t="str",s?Je(e,17,TU(t,c)):Je(e,6,EU(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Je(e,13,AU(t,c)):Je(e,2,_U(t,c)):s?Je(e,16,wU(t,c)):Je(e,5,bU(t,c)),!0;case"b":return c.t="b",s?Je(e,15,uU(t,c)):Je(e,4,lU(t,c)),!0;case"e":return c.t="e",s?Je(e,14,pU(t,c)):Je(e,3,dU(t,c)),!0}return s?Je(e,12,sU(t,c)):Je(e,1,aU(t,c)),!0}function ez(e,t,r,n){var a=er(t["!ref"]||"A1"),i,s="",o=[];Je(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){s=cn(f),JB(e,t,a,f);var d=!1;if(f<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(o[p]=Br(p)),i=o[p]+s;var h=c?(t[f]||[])[p]:t[i];if(!h){d=!1;continue}d=QU(e,h,f,p,n,t,d)}}Je(e,146)}function tz(e,t){!t||!t["!merges"]||(Je(e,177,MU(t["!merges"].length)),t["!merges"].forEach(function(r){Je(e,176,DU(r))}),Je(e,178))}function rz(e,t){!t||!t["!cols"]||(Je(e,390),t["!cols"].forEach(function(r,n){r&&Je(e,60,WU(n,r))}),Je(e,391))}function nz(e,t){!t||!t["!ref"]||(Je(e,648),Je(e,649,YU(er(t["!ref"]))),Je(e,650))}function az(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=fr(r,-1,n[1].Target.replace(/#.*$/,""),Vt.HLINK);Je(e,494,BU(n,a))}}),delete t["!links"]}function iz(e,t,r,n){if(t["!comments"].length>0){var a=fr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Vt.VML);Je(e,551,J2("rId"+a)),t["!legacy"]=a}}function sz(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Ht(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=$a(i);o.s.r==o.e.r&&(o.e.r=$a(t["!ref"]).e.r,i=Ht(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Je(e,161,wu(er(i))),Je(e,162)}}function oz(e,t,r){Je(e,133),Je(e,137,VU(t,r)),Je(e,138),Je(e,134)}function lz(e,t){t["!protect"]&&Je(e,535,KU(t["!protect"]))}function cz(e,t,r,n){var a=za(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=er(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Je(a,129),(r.vbaraw||s["!outline"])&&Je(a,147,rU(o,s["!outline"])),Je(a,148,QB(c)),oz(a,s,r.Workbook),rz(a,s),ez(a,s,e,t),lz(a,s),sz(a,s,r,e),tz(a,s),az(a,s,n),s["!margins"]&&Je(a,476,qU(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&nz(a,s),iz(a,s,e,n),Je(a,130),a.end()}function uz(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Qt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function fz(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var p=uz(d);f.s.r=f.s.c=0,f.e.c=o,u=Br(o),p[0].forEach(function(h,m){s[u+cn(m)]={t:"n",v:h,z:p[1]},c=m}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Ht(f)),s}function dz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(Gk);return o&&fy(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function hz(e,t){e.l+=10;var r=ma(e);return{name:r}}function pz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return uo(e,function(c,u,f){switch(f){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var dy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gz=[],xz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function cS(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Cr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function uS(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Xk(e){uS(e.WBProps,dy),uS(e.CalcPr,xz),cS(e.WBView,mz),cS(e.Sheets,gz),Zc.date1904=Cr(e.WBProps.date1904)}function vz(e){return!e.Workbook||!e.Workbook.WBProps?"false":Cr(e.Workbook.WBProps.date1904)?"true":"false"}var yz="][*?/\\".split("");function Jk(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yz.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bz(e,t,r){e.forEach(function(n,a){Jk(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function wz(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bz(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Sz=/<\w+:workbook/;function _z(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(va,function(c,u){var f=Mt(c);switch(ks(f[0])){case"<?xml":break;case"<workbook":c.match(Sz)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dy.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Cr(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=vr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Qt(vr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=vr(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),Cr(f.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=Qt(vr(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Ql.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Xk(r),r}function Zk(e){var t=[un];t[t.length]=ot("workbook",null,{xmlns:Ql[0],"xmlns:r":jn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(dy.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ot("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:hr(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=ot("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ot("definedName",hr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Nz(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=J1(e),r.name=ma(e),r}function Az(e,t){return t||(t=Ge(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),J2(e.strRelID,t),$n(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function jz(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ma(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function kz(e,t){t||(t=Ge(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Wj(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Ez(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Cz(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=iI(e),s=dB(e,0,r),o=X2(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function Tz(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Xf[16]={n:"BrtFRTArchID$",f:Ez},uo(e,function(c,u,f){switch(f){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ca(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Xk(r),r.Names=i,r.supbooks=s,r}function Pz(e,t){Je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Je(e,156,Az(a))}Je(e,144)}function Oz(e,t){t||(t=Ge(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return $n("SheetJS",t),$n(Fh.version,t),$n(Fh.version,t),$n("7262",t),t.length>t.l?t.slice(0,t.l):t}function Fz(e,t){t||(t=Ge(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Iz(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Je(e,135),Je(e,158,Fz(a)),Je(e,136))}}function Lz(e,t){var r=za();return Je(r,131),Je(r,128,Oz()),Je(r,153,kz(e.Workbook&&e.Workbook.WBProps||null)),Iz(r,e),Pz(r,e),Je(r,132),r.end()}function Dz(e,t,r){return t.slice(-4)===".bin"?Tz(e,r):_z(e,r)}function Mz(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?ZU(e,n,r,a,i,s,o):CB(e,n,r,a,i,s,o)}function Rz(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?pz(e,n,r,a,i):dz(e,n,r,a,i)}function Bz(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?zR():$R()}function Uz(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?BR():UR()}function zz(e,t,r,n){return t.slice(-4)===".bin"?DM(e,r,n):NM(e,r,n)}function $z(e,t,r){return Ok(e,r)}function Wz(e,t,r){return t.slice(-4)===".bin"?WD(e,r):UD(e,r)}function Hz(e,t,r){return t.slice(-4)===".bin"?IR(e,r):AR(e,r)}function qz(e,t,r){return t.slice(-4)===".bin"?SR(e):bR(e)}function Gz(e,t,r,n){return r.slice(-4)===".bin"?_R(e,t,r,n):void 0}function Vz(e,t,r){return t.slice(-4)===".bin"?xR(e,t,r):yR(e,t,r)}function Yz(e,t,r){return(t.slice(-4)===".bin"?Lz:Zk)(e)}function Kz(e,t,r,n,a){return(t.slice(-4)===".bin"?cz:Vk)(e,r,n,a)}function Xz(e,t,r){return(t.slice(-4)===".bin"?GM:Tk)(e,r)}function Jz(e,t,r){return(t.slice(-4)===".bin"?GD:Sk)(e,r)}function Zz(e,t,r){return(t.slice(-4)===".bin"?LR:Lk)(e)}function Qz(e){return(e.slice(-4)===".bin"?vR:Fk)()}var Qk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,e6=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Qk),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(e6),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function e$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Qk),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(e6),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var If;function t$(e,t){var r=If[e]||Qt(e);return r==="General"?Rl(t):Ti(r,t)}function r$(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Cr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Pr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Qt(t)]=a}function n$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zf(e.v):e.w=Rl(e.v):e.w=t$(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=If[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&vu(n)){var a=Al(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function a$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=gM[n.Pattern]||n.Pattern)}e[t.ID]=t}function i$(e,t,r,n,a,i,s,o,c,u){var f="General",d=n.StyleID,p={};u=u||{};var h=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(f=i[d].nf),i[d].Interior&&h.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Cr(e);break;case"String":n.t="s",n.r=k5(Qt(e)),n.v=e.indexOf("<")>-1?Qt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Pr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Qt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Yj[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=k5(t||e));break}if(n$(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=Qt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Jc(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Jc("RC:RC",a):n.ArrayRange&&(n.F=Jc(n.ArrayRange,a),c.push([er(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(x){!p.patternType&&x.patternType&&(p.patternType=x.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function s$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qg(e,t){var r=t||{};yu();var n=Sf(H2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Or(r);return s.type="string",ou.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ve){a.indexOf("<"+ve)>=0&&(i=!0)}),i)return q$(n,r);If={"General Number":"General","General Date":Ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ft[15],"Short Date":Ft[14],"Long Time":Ft[19],"Medium Time":Ft[18],"Short Time":Ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ft[2],Standard:Ft[4],Percent:Ft[10],Scientific:Ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],p=r.dense?[]:{},h="",m={},g={},x=Wi('<Data ss:Type="String">'),b=0,S=0,_=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},F={},M="",C=0,k=[],W={},D={},j=0,H=[],U=[],Y={},X=[],Z,K=!1,z=[],se=[],xe={},A=0,I=0,P={Sheets:[],WBProps:{date1904:!1}},L={};Hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";o=Hf.exec(n);)switch(o[3]=(R=o[3]).toLowerCase()){case"data":if(R=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?i$(n.slice(b,o.index),M,x,c[c.length-1][0]=="comment"?Y:m,{c:S,r:_},O,X[S],g,z,r):(M="",x=Wi(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(U.length>0&&(m.c=U),(!r.sheetRows||r.sheetRows>_)&&m.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][S]=m):p[Br(S)+cn(_)]=m),m.HRef&&(m.l={Target:Qt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(A=S+(parseInt(m.MergeAcross,10)|0),I=_+(parseInt(m.MergeDown,10)|0),k.push({s:{c:S,r:_},e:{c:A,r:I}})),!r.sheetStubs)m.MergeAcross?S=A+1:++S;else if(m.MergeAcross||m.MergeDown){for(var G=S;G<=A;++G)for(var J=_;J<=I;++J)(G>S||J>_)&&(r.dense?(p[J]||(p[J]=[]),p[J][G]={t:"z"}):p[Br(G)+cn(J)]={t:"z"});S=A+1}else++S;else m=e$(o[0]),m.Index&&(S=+m.Index-1),S<E.s.c&&(E.s.c=S),S>E.e.c&&(E.e.c=S),o[0].slice(-2)==="/>"&&++S,U=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<E.s.r&&(E.s.r=_),_>E.e.r&&(E.e.r=_),o[0].slice(-2)==="/>"&&(g=Wi(o[0]),g.Index&&(_=+g.Index-1)),S=0,++_):(g=Wi(o[0]),g.Index&&(_=+g.Index-1),xe={},(g.AutoFitHeight=="0"||g.Height)&&(xe.hpx=parseInt(g.Height,10),xe.hpt=Kf(xe.hpx),se[_]=xe),g.Hidden=="1"&&(xe.hidden=!0,se[_]=xe));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(h),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(p["!ref"]=Ht(E),r.sheetRows&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Ht(E))),k.length&&(p["!merges"]=k),X.length>0&&(p["!cols"]=X),se.length>0&&(p["!rows"]=se),f[h]=p}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=S=0,c.push([o[3],!1]),u=Wi(o[0]),h=Qt(u.Name),p=r.dense?[]:{},k=[],z=[],se=[],L={name:h,Hidden:0},P.Sheets.push(L);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),X=[],K=!1}break;case"style":o[1]==="/"?a$(O,F,r):F=Wi(o[0]);break;case"numberformat":F.nf=Qt(Wi(o[0]).Format||"General"),If[F.nf]&&(F.nf=If[F.nf]);for(var q=0;q!=392&&Ft[q]!=F.nf;++q);if(q==392){for(q=57;q!=392;++q)if(Ft[q]==null){Ks(F.nf,q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Z=Wi(o[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!K&&Z.wpx>10){K=!0,ua=Ek;for(var Q=0;Q<X.length;++Q)X[Q]&&Go(X[Q])}K&&Go(Z),X[Z.Index-1||X.length]=Z;for(var fe=0;fe<+Z.Span;++fe)X[X.length]=Or(Z);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var V=Mt(o[0]),Oe={Name:V.Name,Ref:Jc(V.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Oe.Sheet=P.Sheets.length-1),P.Names.push(Oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?M+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Wi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?TI(W,R,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));s$(Y),U.push(Y)}else c.push([o[3],!1]),u=Wi(o[0]),Y={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Te=Wi(o[0]);p["!autofilter"]={ref:Jc(Te.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return mS(n,r);var be=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else j=o.index+o[0].length;break;case"header":p["!margins"]||Fl(p["!margins"]={},"xlml"),isNaN(+Mt(o[0]).Margin)||(p["!margins"].header=+Mt(o[0]).Margin);break;case"footer":p["!margins"]||Fl(p["!margins"]={},"xlml"),isNaN(+Mt(o[0]).Margin)||(p["!margins"].footer=+Mt(o[0]).Margin);break;case"pagemargins":var re=Mt(o[0]);p["!margins"]||Fl(p["!margins"]={},"xlml"),isNaN(+re.Top)||(p["!margins"].top=+re.Top),isNaN(+re.Left)||(p["!margins"].left=+re.Left),isNaN(+re.Right)||(p["!margins"].right=+re.Right),isNaN(+re.Bottom)||(p["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?r$(D,R,H,n.slice(j,o.index)):(H=o,j=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var we={};return!r.bookSheets&&!r.bookProps&&(we.Sheets=f),we.SheetNames=d,we.Workbook=P,we.SSF=Or(Ft),we.Props=W,we.Custprops=D,we}function av(e,t){switch(py(t=t||{}),t.type||"base64"){case"base64":return qg(oi(e),t);case"binary":case"buffer":case"file":return qg(e,t);case"array":return qg(rl(e),t)}}function o$(e,t){var r=[];return e.Props&&r.push(PI(e.Props,t)),e.Custprops&&r.push(OI(e.Props,e.Custprops)),r.join("")}function l$(){return""}function c$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(ot("NumberFormat",null,{"ss:Format":hr(Ft[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(ot("Style",i.join(""),s))}),ot("Styles",r.join(""))}function t6(e){return ot("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ly(e.Ref,{r:0,c:0})})}function u$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(t6(a)))}return ot("Names",r.join(""))}function f$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(t6(o)))}return i.join("")}function d$(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ot("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ot("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ot("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ot("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Zn("ProtectContents","True")),e["!protect"].objects&&a.push(Zn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Zn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Zn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Zn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":ot("WorksheetOptions",a.join(""),{xmlns:Qa.x})}function h$(e){return e.map(function(t){var r=I7(t.t||""),n=ot("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ot("Comment",n,{"ss:Author":t.a})}).join("")}function p$(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+hr(ly(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=Ur(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=hr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=hr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=s.c||u[f].s.r!=s.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(e.v);break;case"b":d="Boolean",p=e.v?"1":"0";break;case"e":d="Error",p=fo[e.v];break;case"d":d="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ft[14]);break;case"s":d="String",p=F7(e.v||"");break}var h=al(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var m=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=h$(e.c)),ot("Cell",g,o)}function m$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=lu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function g$(e,t,r,n){if(!e["!ref"])return"";var a=er(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,b){Go(x);var S=!!x.width,_=Qp(b,x),E={"ss:Index":b+1};S&&(E["ss:Width"]=Vf(_.width)),x.hidden&&(E["ss:Hidden"]="1"),o.push(ot("Column",null,E))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[m$(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>u)&&!(i[s].e.c<d)&&!(i[s].e.r<u)){(i[s].s.c!=d||i[s].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:d},m=Lt(h),g=c?(e[u]||[])[d]:e[m];f.push(p$(g,m,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function x$(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?f$(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?g$(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(d$(i,t,e,r)),n.join("")}function v$(e,t){t||(t={}),e.SSF||(e.SSF=Or(Ft)),e.SSF&&(yu(),Gp(e.SSF),t.revssf=Yp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(o$(e,t)),r.push(l$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ot("Worksheet",x$(n,t,e),{"ss:Name":hr(e.SheetNames[n])}));return r[2]=c$(e,t),r[3]=u$(e),un+ot("Workbook",r.join(""),{xmlns:Qa.ss,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:ss":Qa.ss,"xmlns:dt":Qa.dt,"xmlns:html":Qa.html})}function y$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=uI(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=fI(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var b$=[60,1084,2066,2165,2175];function w$(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=Hs(r,r.l),u=iv[c],f=0;u!=null&&b$.indexOf(c)>-1;)i=Hs(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),s.push(o),r.l+=4+i,u=iv[c=Hs(r,r.l)];var d=zn(s);Jn(d,0);var p=0;d.lens=[];for(var h=0;h<s.length;++h)d.lens.push(p),p+=s[h].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ds(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ft[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zf(e.v):e.w=Rl(e.v):e.w=Ti(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&vu(Ft[n]||String(n))){var a=Al(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function V0(e,t,r){return{v:e,ixfe:t,t:r}}function S$(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",f={},d,p="",h,m,g,x,b={},S=[],_,E,O=[],F=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},k=function(it){return it<8?Tl[it]:it<64&&F[it-8]||Tl[it]},W=function(it,Ae,tt){var at=Ae.XF.data;if(!(!at||!at.patternType||!tt||!tt.cellStyles)){Ae.s={},Ae.s.patternType=at.patternType;var Ct;(Ct=Gf(k(at.icvFore)))&&(Ae.s.fgColor={rgb:Ct}),(Ct=Gf(k(at.icvBack)))&&(Ae.s.bgColor={rgb:Ct})}},D=function(it,Ae,tt){if(!(xe>1)&&!(tt.sheetRows&&it.r>=tt.sheetRows)){if(tt.cellStyles&&Ae.XF&&Ae.XF.data&&W(it,Ae,tt),delete Ae.ixfe,delete Ae.XF,d=it,p=Lt(it),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),it.r<s.s.r&&(s.s.r=it.r),it.c<s.s.c&&(s.s.c=it.c),it.r+1>s.e.r&&(s.e.r=it.r+1),it.c+1>s.e.c&&(s.e.c=it.c+1),tt.cellFormula&&Ae.f){for(var at=0;at<S.length;++at)if(!(S[at][0].s.c>it.c||S[at][0].s.r>it.r)&&!(S[at][0].e.c<it.c||S[at][0].e.r<it.r)){Ae.F=Ht(S[at][0]),(S[at][0].s.c!=it.c||S[at][0].s.r!=it.r)&&delete Ae.f,Ae.f&&(Ae.f=""+ca(S[at][1],s,it,z,j));break}}tt.dense?(a[it.r]||(a[it.r]=[]),a[it.r][it.c]=Ae):a[p]=Ae}},j={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var H,U=[],Y=[],X=[],Z=[],K=!1,z=[];z.SheetNames=j.snames,z.sharedf=j.sharedf,z.arrayf=j.arrayf,z.names=[],z.XTI=[];var se=0,xe=0,A=0,I=[],P=[],L;j.codepage=1200,Xi(1200);for(var R=!1;e.l<e.length-1;){var G=e.l,J=e.read_shift(2);if(J===0&&se===10)break;var q=e.l===e.length?0:e.read_shift(2),Q=iv[J];if(Q&&Q.f){if(t.bookSheets&&se===133&&J!==133)break;if(se=J,Q.r===2||Q.r==12){var fe=e.read_shift(2);if(q-=2,!j.enc&&fe!==J&&((fe&255)<<8|fe>>8)!==J)throw new Error("rt mismatch: "+fe+"!="+J);Q.r==12&&(e.l+=10,q-=10)}var V={};if(J===10?V=Q.f(e,q,j):V=w$(J,Q,e,q,j),xe==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(J){case 34:r.opts.Date1904=M.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=V;break;case 66:var Oe=Number(V);switch(Oe){case 21010:Oe=1200;break;case 32768:Oe=1e4;break;case 32769:Oe=1252;break}Xi(j.codepage=Oe),R=!0;break;case 317:j.rrtabid=V;break;case 25:j.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:j.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:O.push(V);break;case 430:z.push([V]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(V);break;case 24:case 536:L={Name:V.Name,Ref:ca(V.rgce,s,null,z,j)},V.itab>0&&(L.Sheet=V.itab-1),z.names.push(L),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(P[V.itab-1]={ref:Ht(V.rgce[0][0][1][2])});break;case 22:j.ExternCount=V;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(V),z.XTI=z.XTI.concat(V);break;case 2196:if(j.biff<8)break;L!=null&&(L.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&j.WTF&&console.error("Password verifier: "+V);break;case 133:i[V.pos]=V,j.snames.push(V.name);break;case 10:{if(--xe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Ht(s),t.sheetRows&&t.sheetRows<=s.e.r){var Te=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ht(s),s.e.r=Te}s.e.r++,s.e.c++}U.length>0&&(a["!merges"]=U),Y.length>0&&(a["!objects"]=Y),X.length>0&&(a["!cols"]=X),Z.length>0&&(a["!rows"]=Z),M.Sheets.push(C)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),j.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(j.biff=5,R=!0,Xi(j.codepage=28591)),j.biff==8&&V.BIFFVer==0&&V.dt==16&&(j.biff=2),xe++)break;if(a=t.dense?[]:{},j.biff<8&&!R&&(R=!0,Xi(j.codepage=t.codepage||1252)),j.biff<5||V.BIFFVer==0&&V.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:e.l-q,name:u};i[be.pos]=be,j.snames.push(u)}else u=(i[G]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),U=[],Y=[],j.arrayf=S=[],X=[],Z=[],K=!1,C={Hidden:(i[G]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[V.r]||[])[V.c]:a[Lt({c:V.c,r:V.r})])&&++V.c,_={ixfe:V.ixfe,XF:O[V.ixfe]||{},v:V.val,t:"n"},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t);break;case 5:case 517:_={ixfe:V.ixfe,XF:O[V.ixfe],v:V.val,t:V.t},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t);break;case 638:_={ixfe:V.ixfe,XF:O[V.ixfe],v:V.rknum,t:"n"},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t);break;case 189:for(var re=V.c;re<=V.C;++re){var we=V.rkrec[re-V.c][0];_={ixfe:we,XF:O[we],v:V.rkrec[re-V.c][1],t:"n"},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:re,r:V.r},_,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(_=V0(V.val,V.cell.ixfe,V.tt),_.XF=O[_.ixfe],t.cellFormula){var ve=V.formula;if(ve&&ve[0]&&ve[0][0]&&ve[0][0][0]=="PtgExp"){var ye=ve[0][0][1][0],Ce=ve[0][0][1][1],ze=Lt({r:ye,c:Ce});b[ze]?_.f=""+ca(V.formula,s,V.cell,z,j):_.F=((t.dense?(a[ye]||[])[Ce]:a[ze])||{}).F}else _.f=""+ca(V.formula,s,V.cell,z,j)}A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D(V.cell,_,t),o=V}break;case 7:case 519:if(o)o.val=V,_=V0(V,o.cell.ixfe,"s"),_.XF=O[_.ixfe],t.cellFormula&&(_.f=""+ca(o.formula,s,o.cell,z,j)),A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(V);var $e=Lt(V[0].s);if(h=t.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[$e],t.cellFormula&&h){if(!o||!$e||!h)break;h.f=""+ca(V[1],s,V[0],z,j),h.F=Ht(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;b[Lt(o.cell)]=V[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Lt(o.cell)],(h||{}).f=""+ca(V[0],s,d,z,j)}}break;case 253:_=V0(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(_.h=c[V.isst].h),_.XF=O[_.ixfe],A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:V.ixfe,XF:O[V.ixfe],t:"z"},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t));break;case 190:if(t.sheetStubs)for(var Ue=V.c;Ue<=V.C;++Ue){var Xe=V.ixfe[Ue-V.c];_={ixfe:Xe,XF:O[Xe],t:"z"},A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:Ue,r:V.r},_,t)}break;case 214:case 516:case 4:_=V0(V.val,V.ixfe,"s"),_.XF=O[_.ixfe],A>0&&(_.z=I[_.ixfe>>8&63]),ds(_,t,r.opts.Date1904),D({c:V.c,r:V.r},_,t);break;case 0:case 512:xe===1&&(s=V);break;case 252:c=V;break;case 1054:if(j.biff==4){I[A++]=V[1];for(var Qe=0;Qe<A+163&&Ft[Qe]!=V[1];++Qe);Qe>=163&&Ks(V[1],A+163)}else Ks(V[1],V[0]);break;case 30:{I[A++]=V;for(var bt=0;bt<A+163&&Ft[bt]!=V;++bt);bt>=163&&Ks(V,A+163)}break;case 229:U=U.concat(V);break;case 93:Y[V.cmo[0]]=j.lastobj=V;break;case 438:j.lastobj.TxO=V;break;case 127:j.lastobj.ImData=V;break;case 440:for(x=V[0].s.r;x<=V[0].e.r;++x)for(g=V[0].s.c;g<=V[0].e.c;++g)h=t.dense?(a[x]||[])[g]:a[Lt({c:g,r:x})],h&&(h.l=V[1]);break;case 2048:for(x=V[0].s.r;x<=V[0].e.r;++x)for(g=V[0].s.c;g<=V[0].e.c;++g)h=t.dense?(a[x]||[])[g]:a[Lt({c:g,r:x})],h&&h.l&&(h.l.Tooltip=V[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;h=t.dense?(a[V[0].r]||[])[V[0].c]:a[Lt(V[0])];var Dt=Y[V[2]];h||(t.dense?(a[V[0].r]||(a[V[0].r]=[]),h=a[V[0].r][V[0].c]={t:"z"}):h=a[Lt(V[0])]={t:"z"},s.e.r=Math.max(s.e.r,V[0].r),s.s.r=Math.min(s.s.r,V[0].r),s.e.c=Math.max(s.e.c,V[0].c),s.s.c=Math.min(s.s.c,V[0].c)),h.c||(h.c=[]),m={a:V[1],t:Dt.TxO.t},h.c.push(m)}break;case 2173:cR(O[V.ixfe],V.ext);break;case 125:{if(!j.cellStyles)break;for(;V.e>=V.s;)X[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},K||(K=!0,iy(V.w/256)),Go(X[V.e+1])}break;case 520:{var kt={};V.level!=null&&(Z[V.r]=kt,kt.level=V.level),V.hidden&&(Z[V.r]=kt,kt.hidden=!0),V.hpt&&(Z[V.r]=kt,kt.hpt=V.hpt,kt.hpx=lu(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=V;break;case 161:a["!margins"]||Fl(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(M.Views[0].RTL=!0);break;case 146:F=V;break;case 2198:H=V;break;case 140:E=V;break;case 442:u?C.CodeName=V||C.name:M.WBProps.CodeName=V||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=q}return r.SheetNames=Jr(i).sort(function(wt,it){return Number(wt)-Number(it)}).map(function(wt){return i[wt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&P.forEach(function(wt,it){r.Sheets[r.SheetNames[it]]["!autofilter"]=wt}),r.Strings=c,r.SSF=Or(Ft),j.enc&&(r.Encryption=j.enc),H&&(r.Themes=H),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),z.names.length>0&&(M.Names=z.names),r.Workbook=M,r}var Lf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _$(e,t,r){var n=jt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=q5(n,Z1,Lf.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=jt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=q5(s,Q1,Lf.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(ek(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function N$(e,t){var r=[],n=[],a=[],i=0,s,o=w5(Z1,"n"),c=w5(Q1,"n");if(e.Props)for(s=Jr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Jr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)ok.indexOf(a[i][0])>-1||Qj.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&jt.utils.cfb_add(t,"/SummaryInformation",G5(n,Lf.SI,c,Q1)),(r.length||u.length)&&jt.utils.cfb_add(t,"/DocumentSummaryInformation",G5(r,Lf.DSI,o,Z1,u.length?u:null,Lf.UDI))}function r6(e,t){t||(t={}),py(t),L2(),t.codepage&&I2(t.codepage);var r,n;if(e.FullPaths){if(jt.find(e,"/encryption"))throw new Error("File is password-protected");r=jt.find(e,"!CompObj"),n=jt.find(e,"/Workbook")||jt.find(e,"/Book")}else{switch(t.type){case"base64":e=ti(oi(e));break;case"binary":e=ti(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jn(e,0),n={content:e}}var a,i;if(r&&y$(r),t.bookProps&&!t.bookSheets)a={};else{var s=Gt?"buffer":"array";if(n&&n.content)a=S$(n.content,t);else if((i=jt.find(e,"PerfectOffice_MAIN"))&&i.content)a=Ol.to_workbook(i.content,(t.type=s,t));else if((i=jt.find(e,"NativeContent_MAIN"))&&i.content)a=Ol.to_workbook(i.content,(t.type=s,t));else throw(i=jt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&jt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=MR(e))}var o={};return e.FullPaths&&_$(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function A$(e,t){var r=t||{},n=jt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return jt.utils.cfb_add(n,a,n6(e,r)),r.biff==8&&(e.Props||e.Custprops)&&N$(e,n),r.biff==8&&e.vbaraw&&RR(n,jt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Xf={0:{f:KB},1:{f:nU},2:{f:SU},3:{f:fU},4:{f:oU},5:{f:yU},6:{f:kU},7:{f:mU},8:{f:IU},9:{f:FU},10:{f:PU},11:{f:OU},12:{f:iU},13:{f:NU},14:{f:hU},15:{f:cU},16:{f:Yk},17:{f:CU},18:{f:xU},19:{f:K2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Cz},40:{},42:{},43:{f:kM},44:{f:AM},45:{f:TM},46:{f:OM},47:{f:PM},48:{},49:{f:Z7},50:{},51:{f:dR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vk},62:{f:jU},63:{f:wR},64:{f:XU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:GU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tU},148:{f:ZB,p:16},151:{f:UU},152:{},153:{f:jz},154:{},155:{},156:{f:Nz},157:{},158:{},159:{T:1,f:$D},160:{T:-1},161:{T:1,f:nc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:LU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uR},336:{T:-1},337:{f:mR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:J1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zU},427:{f:$U},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:HU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:RU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:J1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OR},633:{T:1},634:{T:-1},635:{T:1,f:TR},636:{T:-1},637:{f:rI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:JU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},iv={6:{f:Wg},10:{f:Io},12:{f:vn},13:{f:vn},14:{f:nn},15:{f:nn},16:{f:da},17:{f:nn},18:{f:nn},19:{f:vn},20:{f:Z5},21:{f:Z5},23:{f:xk},24:{f:eS},25:{f:nn},26:{},27:{},28:{f:JL},29:{},34:{f:nn},35:{f:Q5},38:{f:da},39:{f:da},40:{f:da},41:{f:da},42:{f:nn},43:{f:nn},47:{f:cM},49:{f:NL},51:{f:vn},60:{},61:{f:yL},64:{f:nn},65:{f:_L},66:{f:vn},77:{},80:{},81:{},82:{},85:{f:vn},89:{},90:{},91:{},92:{f:lL},93:{f:eD},94:{},95:{f:nn},96:{},97:{},99:{f:nn},125:{f:vk},128:{f:BL},129:{f:uL},130:{f:vn},131:{f:nn},132:{f:nn},133:{f:fL},134:{},140:{f:lD},141:{f:vn},144:{},146:{f:fD},151:{},152:{},153:{},154:{},155:{},156:{f:vn},157:{},158:{},160:{f:vD},161:{f:pD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:LL},190:{f:DL},193:{f:Io},197:{},198:{},199:{},200:{},201:{},202:{f:nn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vn},220:{},221:{f:nn},222:{},224:{f:RL},225:{f:oL},226:{f:Io},227:{},229:{f:ZL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:hL},253:{f:jL},255:{f:mL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:lk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:nn},353:{f:Io},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:HL},431:{f:nn},432:{},433:{},434:{},437:{},438:{f:nD},439:{f:nn},440:{f:aD},441:{},442:{f:bd},443:{},444:{f:vn},445:{},446:{},448:{f:Io},449:{f:vL,r:2},450:{f:Io},512:{f:K5},513:{f:xD},515:{f:$L},516:{f:EL},517:{f:J5},519:{f:yD},520:{f:gL},523:{},545:{f:tS},549:{f:Y5},566:{},574:{f:wL},638:{f:IL},659:{},1048:{},1054:{f:TL},1084:{},1212:{f:YL},2048:{f:sD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:H0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Io},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:dD,r:12},2173:{f:lR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:nn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:VL,r:12},2197:{},2198:{f:rR,r:12},2199:{},2200:{},2201:{},2202:{f:KL,r:12},2203:{f:Io},2204:{},2205:{},2206:{},2207:{},2211:{f:xL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:K5},1:{},2:{f:ND},3:{f:SD},4:{f:wD},5:{f:J5},7:{f:jD},8:{},9:{f:H0},11:{},22:{f:vn},30:{f:OL},31:{},32:{},33:{f:tS},36:{},37:{f:Y5},50:{f:kD},62:{},52:{},67:{},68:{f:vn},69:{},86:{},126:{},127:{f:bD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ED},223:{},234:{},354:{},421:{},518:{f:Wg},521:{f:H0},536:{f:eS},547:{f:Q5},561:{},579:{},1030:{f:Wg},1033:{f:H0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function lt(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&G2(r)&&e.push(r)}}function j$(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return lt(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Nd(e,t,r){return e||(e=Ge(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function k$(e,t,r,n){var a=Ge(9);return Nd(a,e,t),ck(r,n||"b",a),a}function E$(e,t,r){var n=Ge(8+2*r.length);return Nd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function C$(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?kn(Pr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?lt(e,2,AD(r,n,a)):lt(e,3,_D(r,n,a));return;case"b":case"e":lt(e,5,k$(r,n,t.v,t.t));return;case"s":case"str":lt(e,4,E$(r,n,(t.v||"").slice(0,255)));return}lt(e,1,Nd(null,r,n))}function T$(e,t,r,n){var a=Array.isArray(t),i=er(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ht(i)}for(var u=i.s.r;u<=i.e.r;++u){o=cn(u);for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(c[f]=Br(f)),s=c[f]+o;var d=a?(t[u]||[])[f]:t[s];d&&C$(e,d,u,f)}}}function P$(e,t){for(var r=t||{},n=za(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return lt(n,r.biff==4?1033:r.biff==3?521:9,ry(e,16,r)),T$(n,e.Sheets[e.SheetNames[a]],a,r),lt(n,10),n.end()}function O$(e,t,r){lt(e,49,AL({sz:12,name:"Arial"},r))}function F$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&lt(e,1054,PL(a,t[a],r))})}function I$(e,t){var r=Ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),lt(e,2151,r),r=Ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pk(er(t["!ref"]||"A1"),r),r.write_shift(4,4),lt(e,2152,r)}function L$(e,t){for(var r=0;r<16;++r)lt(e,224,X5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){lt(e,224,X5(n,0,t))})}function D$(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];lt(e,440,iD(n)),n[1].Tooltip&&lt(e,2048,oD(n))}delete t["!links"]}function M$(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&lt(e,125,hD(Qp(a,n),a))})}}function R$(e,t,r,n,a){var i=16+al(a.cellXfs,t,a);if(t.v==null&&!t.bf){lt(e,513,$l(r,n,i));return}if(t.bf)lt(e,6,uB(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?kn(Pr(t.v)):t.v;lt(e,515,WL(r,n,s,i));break;case"b":case"e":lt(e,517,zL(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=uy(a.Strings,t.v,a.revStrings);lt(e,253,kL(r,n,o,i))}else lt(e,516,CL(r,n,(t.v||"").slice(0,255),i,a));break;default:lt(e,513,$l(r,n,i))}}function B$(e,t,r){var n=za(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,f,d="",p=[],h=er(i["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}lt(n,2057,ry(r,16,t)),lt(n,13,ki(1)),lt(n,12,ki(100)),lt(n,15,ja(!0)),lt(n,17,ja(!1)),lt(n,16,Ul(.001)),lt(n,95,ja(!0)),lt(n,42,ja(!1)),lt(n,43,ja(!1)),lt(n,130,ki(1)),lt(n,128,UL()),lt(n,131,ja(!1)),lt(n,132,ja(!1)),u&&M$(n,i["!cols"]),lt(n,512,FL(h,t)),u&&(i["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){d=cn(g);for(var x=h.s.c;x<=h.e.c;++x){g===h.s.r&&(p[x]=Br(x)),f=p[x]+d;var b=c?(i[g]||[])[x]:i[f];b&&(R$(n,b,g,x,t),u&&b.l&&i["!links"].push([f,b.l]))}}var S=o.CodeName||o.name||a;return u&&lt(n,574,SL((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&lt(n,229,QL(i["!merges"])),u&&D$(n,i),lt(n,442,uk(S)),u&&I$(n,i),lt(n,10),n.end()}function U$(e,t,r){var n=za(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(lt(n,2057,ry(e,5,r)),r.bookType=="xla"&&lt(n,135),lt(n,225,o?ki(1200):null),lt(n,193,zI(2)),c&&lt(n,191),c&&lt(n,192),lt(n,226),lt(n,92,cL("SheetJS",r)),lt(n,66,ki(o?1200:1252)),o&&lt(n,353,ki(0)),o&&lt(n,448),lt(n,317,gD(e.SheetNames.length)),o&&e.vbaraw&&lt(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";lt(n,442,uk(u))}lt(n,156,ki(17)),lt(n,25,ja(!1)),lt(n,18,ja(!1)),lt(n,19,ki(0)),o&&lt(n,431,ja(!1)),o&&lt(n,444,ki(0)),lt(n,61,bL()),lt(n,64,ja(!1)),lt(n,141,ki(0)),lt(n,34,ja(vz(e)=="true")),lt(n,14,ja(!0)),o&&lt(n,439,ja(!1)),lt(n,218,ki(0)),O$(n,e,r),F$(n,e.SSF,r),L$(n,r),o&&lt(n,352,ja(!1));var f=n.end(),d=za();o&&lt(d,140,cD()),o&&r.Strings&&j$(d,252,pL(r.Strings)),lt(d,10);var p=d.end(),h=za(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var x=f.length+m+p.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};lt(h,133,dL({pos:x,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),x+=t[g].length}var S=h.end();if(m!=S.length)throw new Error("BS8 "+m+" != "+S.length);var _=[];return f.length&&_.push(f),S.length&&_.push(S),p.length&&_.push(p),zn(_)}function z$(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Or(Ft)),e&&e.SSF&&(yu(),Gp(e.SSF),r.revssf=Yp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,my(r),r.cellXfs=[],al(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=B$(a,r,e);return n.unshift(U$(e,n,r)),zn(n)}function n6(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=$a(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return z$(e,t);case 4:case 3:case 2:return P$(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function fS(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=A7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<c.length;++s){var g=c[s].trim(),x=g.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(x!="<td"&&x!="<th")){var b=g.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var S=b[o].trim();if(S.match(/<t[dh]/i)){for(var _=S,E=0;_.charAt(0)=="<"&&(E=_.indexOf(">"))>-1;)_=_.slice(E+1);for(var O=0;O<m.length;++O){var F=m[O];F.s.c==f&&F.s.r<u&&u<=F.e.r&&(f=F.e.c+1,O=-1)}var M=Mt(S.slice(0,S.indexOf(">")));p=M.colspan?+M.colspan:1,((d=+M.rowspan)>1||p>1)&&m.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+p-1}});var C=M.t||M["data-t"]||"";if(!_.length){f+=p;continue}if(_=kj(_),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!_.length){f+=p;continue}var k={t:"s",v:_};r.raw||!_.trim().length||C=="s"||(_==="TRUE"?k={t:"b",v:!0}:_==="FALSE"?k={t:"b",v:!1}:isNaN(Zi(_))?isNaN(su(_).getDate())||(k={t:"d",v:Pr(_)},r.cellDates||(k={t:"n",v:kn(k.v)}),k.z=r.dateNF||Ft[14]):k={t:"n",v:Zi(_)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=k):n[Lt({r:u,c:f})]=k,f+=p}}}}return n["!ref"]=Ht(h),m.length&&(n["!merges"]=m),n}function $$(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Lt({r,c:s}),d=n.dense?(e[r]||[])[s]:e[f],p=d&&d.v!=null&&(d.h||W2(d.w||(Qs(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+f,i.push(ot("td",p,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var W$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',H$="</body></html>";function q$(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return nl(fS(r[0],t),t);var n=yy();return r.forEach(function(a,i){by(n,fS(a,t),"Sheet"+(i+1))}),n}function G$(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function a6(e,t){var r=t||{},n=r.header!=null?r.header:W$,a=r.footer!=null?r.footer:H$,i=[n],s=$a(e["!ref"]);r.dense=Array.isArray(e),i.push(G$(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push($$(e,s,o,r));return i.push("</table>"+a),i.join("")}function i6(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Ur(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=$a(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,x=0,b=0,S=0,_=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<c;++m){var E=o[m];if(dS(E)){if(n.display)continue;h[g]={hidden:!0}}var O=E.children;for(x=b=0;x<O.length;++x){var F=O[x];if(!(n.display&&dS(F))){var M=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):kj(F.innerHTML),C=F.getAttribute("data-z")||F.getAttribute("z");for(p=0;p<d.length;++p){var k=d[p];k.s.c==b+i&&k.s.r<g+a&&g+a<=k.e.r&&(b=k.e.c+1-i,p=-1)}_=+F.getAttribute("colspan")||1,((S=+F.getAttribute("rowspan")||1)>1||_>1)&&d.push({s:{r:g+a,c:b+i},e:{r:g+a+(S||1)-1,c:b+i+(_||1)-1}});var W={t:"s",v:M},D=F.getAttribute("data-t")||F.getAttribute("t")||"";M!=null&&(M.length==0?W.t=D||"z":n.raw||M.trim().length==0||D=="s"||(M==="TRUE"?W={t:"b",v:!0}:M==="FALSE"?W={t:"b",v:!1}:isNaN(Zi(M))?isNaN(su(M).getDate())||(W={t:"d",v:Pr(M)},n.cellDates||(W={t:"n",v:kn(W.v)}),W.z=n.dateNF||Ft[14]):W={t:"n",v:Zi(M)})),W.z===void 0&&C!=null&&(W.z=C);var j="",H=F.getElementsByTagName("A");if(H&&H.length)for(var U=0;U<H.length&&!(H[U].hasAttribute("href")&&(j=H[U].getAttribute("href"),j.charAt(0)!="#"));++U);j&&j.charAt(0)!="#"&&(W.l={Target:j}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][b+i]=W):e[Lt({c:b+i,r:g+a})]=W,u.e.c<b+i&&(u.e.c=b+i),b+=_}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=Ht(u),g>=c&&(e["!fullref"]=Ht((u.e.r=o.length-m+g-1+a,u))),e}function s6(e,t){var r=t||{},n=r.dense?[]:{};return i6(n,e,t)}function V$(e,t){return nl(s6(e,t),t)}function dS(e){var t="",r=Y$(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Y$(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function K$(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qt(t.replace(/<[^>]*>/g,""));return[r]}var hS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function o6(e,t){var r=t||{},n=H2(e),a=[],i,s,o={name:""},c="",u=0,f,d,p={},h=[],m=r.dense?[]:{},g,x,b={value:""},S="",_=0,E=[],O=-1,F=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,k={},W=[],D={},j=0,H=0,U=[],Y=1,X=1,Z=[],K={Names:[]},z={},se=["",""],xe=[],A={},I="",P=0,L=!1,R=!1,G=0;for(Hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Hf.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?m["!ref"]=Ht(M):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=M.e.r&&(m["!fullref"]=m["!ref"],M.e.r=r.sheetRows-1,m["!ref"]=Ht(M)),W.length&&(m["!merges"]=W),U.length&&(m["!rows"]=U),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),p[f.name]=m,R=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=Mt(g[0],!1),O=F=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,m=r.dense?[]:{},W=[],U=[],R=!0);break;case"table-row-group":g[1]==="/"?--C:++C;break;case"table-row":case"行":if(g[1]==="/"){O+=Y,Y=1;break}if(d=Mt(g[0],!1),d.行号?O=d.行号-1:O==-1&&(O=0),Y=+d["number-rows-repeated"]||1,Y<10)for(G=0;G<Y;++G)C>0&&(U[O+G]={level:C});F=-1;break;case"covered-table-cell":g[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(m[O]||(m[O]=[]),m[O][F]={t:"z"}):m[Lt({r:O,c:F})]={t:"z"}),S="",E=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++F,b=Mt(g[0],!1),X=parseInt(b["number-columns-repeated"]||"1",10),x={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(x.f=lS(Qt(b.formula))),(b.数据类型||b["value-type"])=="string"&&(x.t="s",x.v=Qt(b["string-value"]||""),r.dense?(m[O]||(m[O]=[]),m[O][F]=x):m[Lt({r:O,c:F})]=x),F+=X-1;else if(g[1]!=="/"){++F,S="",_=0,E=[],X=1;var J=Y?O+Y-1:O;if(F>M.e.c&&(M.e.c=F),F<M.s.c&&(M.s.c=F),O<M.s.r&&(M.s.r=O),J>M.e.r&&(M.e.r=J),b=Mt(g[0],!1),xe=[],A={},x={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Qt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(j=parseInt(b["number-matrix-rows-spanned"],10)||0,H=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:O,c:F},e:{r:O+j-1,c:F+H-1}},x.F=Ht(D),Z.push([D,x.F])),b.formula)x.f=lS(b.formula);else for(G=0;G<Z.length;++G)O>=Z[G][0].s.r&&O<=Z[G][0].e.r&&F>=Z[G][0].s.c&&F<=Z[G][0].e.c&&(x.F=Z[G][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(j=parseInt(b["number-rows-spanned"],10)||0,H=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:O,c:F},e:{r:O+j-1,c:F+H-1}},W.push(D)),b["number-columns-repeated"]&&(X=parseInt(b["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Cr(b["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(b.value);break;case"percentage":x.t="n",x.v=parseFloat(b.value);break;case"currency":x.t="n",x.v=parseFloat(b.value);break;case"date":x.t="d",x.v=Pr(b["date-value"]),r.cellDates||(x.t="n",x.v=kn(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=S7(b["time-value"])/86400,r.cellDates&&(x.t="d",x.v=Kp(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(b.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",b["string-value"]!=null&&(S=Qt(b["string-value"]),E=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(L=!1,x.t==="s"&&(x.v=S||"",E.length&&(x.R=E),L=_==0),z.Target&&(x.l=z),xe.length>0&&(x.c=xe,xe=[]),S&&r.cellText!==!1&&(x.w=S),L&&(x.t="z",delete x.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var q=0;q<Y;++q){if(X=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[O+q]||(m[O+q]=[]),m[O+q][F]=q==0?x:Or(x);--X>0;)m[O+q][F+X]=Or(x);else for(m[Lt({r:O+q,c:F})]=x;--X>0;)m[Lt({r:O+q,c:F+X})]=Or(x);M.e.c<=F&&(M.e.c=F)}X=parseInt(b["number-columns-repeated"]||"1",10),F+=X-1,X=0,x={},S="",E=[]}z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i;A.t=S,E.length&&(A.R=E),A.a=I,xe.push(A)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);I="",P=0,S="",_=0,E=[];break;case"creator":g[1]==="/"?I=n.slice(P,g.index):P=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);S="",_=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(k[o.name]=c,(i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=Mt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Mt(g[0],!1),c+=hS[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Mt(g[0],!1),c+=hS[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":s=Mt(g[0],!1),se=Hg(s["cell-range-address"]);var Q={Name:s.name,Ref:se[0]+"!"+se[1]};R&&(Q.Sheet=h.length),K.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var fe=K$(n.slice(_,g.index));S=(S.length>0?S+`
`:"")+fe[0]}else Mt(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{se=Hg(Mt(g[0])["target-range-address"]),p[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(z=Mt(g[0],!1),!z.href)break;z.Target=Qt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(se=Hg(z.Target.slice(1)),z.Target="#"+se[0]+"!"+se[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var V={Sheets:p,SheetNames:h,Workbook:K};return r.bookSheets&&delete V.Sheets,V}function pS(e,t){t=t||{},ji(e,"META-INF/manifest.xml")&&SI(xn(e,"META-INF/manifest.xml"),t);var r=ri(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=o6(vr(r),t);return ji(e,"meta.xml")&&(n.Props=Jj(xn(e,"meta.xml"))),n}function mS(e,t){return o6(e,t)}var X$=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return un+t}})(),gS=(function(){var e=function(i){return hr(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+hr(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=$a(i["!ref"]||"A1"),p=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",x=i["!rows"]||[];for(u=0;u<d.s.r;++u)g=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=d.e.r;++u){for(g=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var b=!1,S={},_="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>f)&&!(p[h].s.r>u)&&!(p[h].e.c<f)&&!(p[h].e.r<u)){(p[h].s.c!=f||p[h].s.r!=u)&&(b=!0),S["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,S["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(b){c.push(r);continue}var E=Lt({r:u,c:f}),O=m?(i[u]||[])[f]:i[E];if(O&&O.f&&(S["table:formula"]=hr(gB(O.f)),O.F&&O.F.slice(0,E.length)==E)){var F=$a(O.F);S["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,S["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!O){c.push(t);continue}switch(O.t){case"b":_=O.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=O.v?"true":"false";break;case"n":_=O.w||String(O.v||0),S["office:value-type"]="float",S["office:value"]=O.v||0;break;case"s":case"str":_=O.v==null?"":O.v,S["office:value-type"]="string";break;case"d":_=O.w||Pr(O.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Pr(O.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(t);continue}var M=e(_);if(O.l&&O.l.Target){var C=O.l.Target;C=C.charAt(0)=="#"?"#"+xB(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),M=ot("text:a",M,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+ot("table:table-cell",ot("text:p",M,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Go(d),d.ods=o;var p=u["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[un],u=Wf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Wf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(Xj().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(n(s.Sheets[s.SheetNames[d]],s,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function l6(e,t){if(t.bookType=="fods")return gS(e,t);var r=U2(),n="",a=[],i=[];return n="mimetype",qt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qt(r,n,gS(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",qt(r,n,X$(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",qt(r,n,un+Xj()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",qt(r,n,AI(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qt(r,n,_I(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vr(rl(e))}function J$(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ti(ys(e))}function Z$(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Yo(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function xS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Q$(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function eW(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Jf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ur(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Xr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function tr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Jf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Jf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Yn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ur(n*8+a.type)),a.type==2&&t.push(ur(a.data.length)),t.push(a.data))})}),Yo(t)}function hy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Si(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Jf(e,n),i=tr(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Xr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=tr(o.data),u=Xr(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Xr(i[3][0].data)>>>0>0),r.push(s)}return r}function Fc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ur(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ur(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ur(s.data.length)}],n[2].push({data:Yn(s.meta),type:2})});var i=Yn(n);t.push(ur(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Yo(t)}function tW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Jf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Yo(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var f=Yo(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function _i(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tW(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Yo(t)}function Ic(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ur(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Yo(t)}function rW(e,t,r,n){var a=Wl(e),i=a.getUint32(4,!0),s=(n>1?12:8)+xS(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=xS(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function nW(e,t,r){var n=Wl(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(c=Q$(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Gg(e,t){var r=new Uint8Array(32),n=Wl(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,eW(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Vg(e,t){var r=new Uint8Array(32),n=Wl(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function aW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return rW(e,t,r,e[0]);case 5:return nW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function la(e){var t=tr(e);return Jf(t[1][0].data)}function vS(e,t){var r=tr(t.data),n=Xr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=tr(s.data),c=Xr(o[1][0].data)>>>0;switch(n){case 1:i[c]=sv(o[3][0].data);break;case 8:{var u=e[la(o[9][0].data)][0],f=tr(u.data),d=e[la(f[1][0].data)][0],p=Xr(d.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=tr(d.data);i[c]=h[3].map(function(m){return sv(m.data)}).join("")}break}}),i}function iW(e,t){var r,n,a,i,s,o,c,u,f,d,p,h,m,g,x=tr(e),b=Xr(x[1][0].data)>>>0,S=Xr(x[2][0].data)>>>0,_=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&Xr(x[8][0].data)>0||!1,E,O;if((i=(a=x[7])==null?void 0:a[0])!=null&&i.data&&t!=0)E=(o=(s=x[7])==null?void 0:s[0])==null?void 0:o.data,O=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=x[4])==null?void 0:f[0])!=null&&d.data&&t!=1)E=(h=(p=x[4])==null?void 0:p[0])==null?void 0:h.data,O=(g=(m=x[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=_?4:1,M=Wl(E),C=[],k=0;k<E.length/2;++k){var W=M.getUint16(k*2,!0);W<65535&&C.push([k,W])}if(C.length!=S)throw"Expected ".concat(S," cells, found ").concat(C.length);var D=[];for(k=0;k<C.length-1;++k)D[C[k][0]]=O.subarray(C[k][1]*F,C[k+1][1]*F);return C.length>=1&&(D[C[C.length-1][0]]=O.subarray(C[C.length-1][1]*F)),{R:b,cells:D}}function sW(e,t){var r,n=tr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Xr(n[7][0].data)>>>0>0?1:0:-1,i=hy(n[5],function(s){return iW(s,a)});return{nrows:Xr(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function oW(e,t,r){var n,a=tr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Xr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Xr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ht(i);var s=tr(a[4][0].data),o=vS(e,e[la(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?vS(e,e[la(s[17][0].data)][0]):[],u=tr(s[3][0].data),f=0;u[1].forEach(function(d){var p=tr(d.data),h=e[la(p[2][0].data)][0],m=Xr(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=sW(e,h);g.data.forEach(function(x,b){x.forEach(function(S,_){var E=Lt({r:f+b,c:_}),O=aW(S,o,c);O&&(r[E]=O)})}),f+=g.nrows})}function lW(e,t){var r=tr(t.data),n={"!ref":"A1"},a=e[la(r[2][0].data)],i=Xr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return oW(e,a[0],n),n}function cW(e,t){var r,n=tr(t.data),a={name:(r=n[1])!=null&&r[0]?sv(n[1][0].data):"",sheets:[]},i=hy(n[2],la);return i.forEach(function(s){e[s].forEach(function(o){var c=Xr(o.meta[1][0].data);c==6e3&&a.sheets.push(lW(e,o))})}),a}function uW(e,t){var r=yy(),n=tr(t.data),a=hy(n[1],la);if(a.forEach(function(i){e[i].forEach(function(s){var o=Xr(s.meta[1][0].data);if(o==2){var c=cW(e,s);c.sheets.forEach(function(u,f){by(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Yg(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=_i(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=Si(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Xr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var f=Xr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return uW(i,o)}function fW(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Xr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Wl(e[7][0].data),f=0,d=[],p=Wl(e[4][0].data),h=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,f,!0),p.setUint16(g*2,h,!0);var x,b;switch(typeof t[g]){case"string":x=Gg({t:"s",v:t[g]},r),b=Vg({t:"s",v:t[g]},r);break;case"number":x=Gg({t:"n",v:t[g]},r),b=Vg({t:"n",v:t[g]},r);break;case"boolean":x=Gg({t:"b",v:t[g]},r),b=Vg({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}d.push(x),f+=x.length,m.push(b),h+=b.length,++c}for(e[2][0].data=ur(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Yo(d),e[3][0].data=Yo(m),c}function dW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=$a(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ht(n)));var i=qh(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(I){return I.forEach(function(P){typeof P=="string"&&s.push(P)})});var o={},c=[],u=jt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(I,P){return[I,u.FullPaths[P]]}).forEach(function(I){var P=I[0],L=I[1];if(P.type==2&&P.name.match(/\.iwa/)){var R=P.content,G=_i(R),J=Si(G);J.forEach(function(q){c.push(q.id),o[q.id]={deps:[],location:L,type:Xr(q.messages[0].meta[1][0].data)}})}}),c.sort(function(I,P){return I-P});var f=c.filter(function(I){return I>1}).map(function(I){return[I,ur(I)]});u.FileIndex.map(function(I,P){return[I,u.FullPaths[P]]}).forEach(function(I){var P=I[0];if(I[1],!!P.name.match(/\.iwa/)){var L=Si(_i(P.content));L.forEach(function(R){R.messages.forEach(function(G){f.forEach(function(J){R.messages.some(function(q){return Xr(q.meta[1][0].data)!=11006&&Z$(q.data,J[1])})&&o[J[0]].deps.push(R.id)})})})}});for(var d=jt.find(u,o[1].location),p=Si(_i(d.content)),h,m=0;m<p.length;++m){var g=p[m];g.id==1&&(h=g)}var x=la(tr(h.messages[0].data)[1][0].data);for(d=jt.find(u,o[x].location),p=Si(_i(d.content)),m=0;m<p.length;++m)g=p[m],g.id==x&&(h=g);for(x=la(tr(h.messages[0].data)[2][0].data),d=jt.find(u,o[x].location),p=Si(_i(d.content)),m=0;m<p.length;++m)g=p[m],g.id==x&&(h=g);for(x=la(tr(h.messages[0].data)[2][0].data),d=jt.find(u,o[x].location),p=Si(_i(d.content)),m=0;m<p.length;++m)g=p[m],g.id==x&&(h=g);var b=tr(h.messages[0].data);{b[6][0].data=ur(n.e.r+1),b[7][0].data=ur(n.e.c+1);var S=la(b[46][0].data),_=jt.find(u,o[S].location),E=Si(_i(_.content));{for(var O=0;O<E.length&&E[O].id!=S;++O);if(E[O].id!=S)throw"Bad ColumnRowUIDMapArchive";var F=tr(E[O].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var M=0;M<=n.e.c;++M){var C=[];C[1]=C[2]=[{type:0,data:ur(M+420690)}],F[1].push({type:2,data:Yn(C)}),F[2].push({type:0,data:ur(M)}),F[3].push({type:0,data:ur(M)})}F[4]=[],F[5]=[],F[6]=[];for(var k=0;k<=n.e.r;++k)C=[],C[1]=C[2]=[{type:0,data:ur(k+726270)}],F[4].push({type:2,data:Yn(C)}),F[5].push({type:0,data:ur(k)}),F[6].push({type:0,data:ur(k)});E[O].messages[0].data=Yn(F)}_.content=Ic(Fc(E)),_.size=_.content.length,delete b[46];var W=tr(b[4][0].data);{W[7][0].data=ur(n.e.r+1);var D=tr(W[1][0].data),j=la(D[2][0].data);_=jt.find(u,o[j].location),E=Si(_i(_.content));{if(E[0].id!=j)throw"Bad HeaderStorageBucket";var H=tr(E[0].messages[0].data);for(k=0;k<i.length;++k){var U=tr(H[2][0].data);U[1][0].data=ur(k),U[4][0].data=ur(i[k].length),H[2][k]={type:H[2][0].type,data:Yn(U)}}E[0].messages[0].data=Yn(H)}_.content=Ic(Fc(E)),_.size=_.content.length;var Y=la(W[2][0].data);_=jt.find(u,o[Y].location),E=Si(_i(_.content));{if(E[0].id!=Y)throw"Bad HeaderStorageBucket";for(H=tr(E[0].messages[0].data),M=0;M<=n.e.c;++M)U=tr(H[2][0].data),U[1][0].data=ur(M),U[4][0].data=ur(n.e.r+1),H[2][M]={type:H[2][0].type,data:Yn(U)};E[0].messages[0].data=Yn(H)}_.content=Ic(Fc(E)),_.size=_.content.length;var X=la(W[4][0].data);(function(){for(var I=jt.find(u,o[X].location),P=Si(_i(I.content)),L,R=0;R<P.length;++R){var G=P[R];G.id==X&&(L=G)}var J=tr(L.messages[0].data);{J[3]=[];var q=[];s.forEach(function(V,Oe){q[1]=[{type:0,data:ur(Oe)}],q[2]=[{type:0,data:ur(1)}],q[3]=[{type:2,data:J$(V)}],J[3].push({type:2,data:Yn(q)})})}L.messages[0].data=Yn(J);var Q=Fc(P),fe=Ic(Q);I.content=fe,I.size=I.content.length})();var Z=tr(W[3][0].data);{var K=Z[1][0];delete Z[2];var z=tr(K.data);{var se=la(z[2][0].data);(function(){for(var I=jt.find(u,o[se].location),P=Si(_i(I.content)),L,R=0;R<P.length;++R){var G=P[R];G.id==se&&(L=G)}var J=tr(L.messages[0].data);{delete J[6],delete Z[7];var q=new Uint8Array(J[5][0].data);J[5]=[];for(var Q=0,fe=0;fe<=n.e.r;++fe){var V=tr(q);Q+=fW(V,i[fe],s),V[1][0].data=ur(fe),J[5].push({data:Yn(V),type:2})}J[1]=[{type:0,data:ur(n.e.c+1)}],J[2]=[{type:0,data:ur(n.e.r+1)}],J[3]=[{type:0,data:ur(Q)}],J[4]=[{type:0,data:ur(n.e.r+1)}]}L.messages[0].data=Yn(J);var Oe=Fc(P),Te=Ic(Oe);I.content=Te,I.size=I.content.length})()}K.data=Yn(z)}W[3][0].data=Yn(Z)}b[4][0].data=Yn(W)}h.messages[0].data=Yn(b);var xe=Fc(p),A=Ic(xe);return d.content=A,d.size=d.content.length,u}function c6(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function py(e){c6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function my(e){c6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function hW(e){return Vt.WS.indexOf(e)>-1?"sheet":e==Vt.CS?"chart":e==Vt.DS?"dialog":e==Vt.MS?"macro":e&&e.length?e:"sheet"}function pW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,hW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mW(e,t,r,n,a,i,s,o,c,u,f,d){try{i[n]=Pf(ri(e,r,!0),t);var p=xn(e,t),h;switch(o){case"sheet":h=Mz(p,t,a,c,i[n],u,f,d);break;case"chart":if(h=Rz(p,t,a,c,i[n],u,f,d),!h||!h["!drawel"])break;var m=Nf(h["!drawel"].Target,t),g=qf(m),x=NR(ri(e,m,!0),Pf(ri(e,g,!0),m)),b=Nf(x,m),S=qf(b);h=fz(ri(e,b,!0),b,c,Pf(ri(e,S,!0),b),u,h);break;case"macro":h=Bz(p,t,a,c,i[n],u,f,d);break;case"dialog":h=Uz(p,t,a,c,i[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var _=[];i&&i[n]&&Jr(i[n]).forEach(function(E){var O="";if(i[n][E].Type==Vt.CMNT){O=Nf(i[n][E].Target,t);var F=Hz(xn(e,O,!0),O,c);if(!F||!F.length)return;nS(h,F,!1)}i[n][E].Type==Vt.TCMNT&&(O=Nf(i[n][E].Target,t),_=_.concat(jR(xn(e,O,!0),c)))}),_&&_.length&&nS(h,_,!0,c.people||[])}catch(E){if(c.WTF)throw E}}function vi(e){return e.charAt(0)=="/"?e.slice(1):e}function gW(e,t){if(yu(),t=t||{},py(t),ji(e,"META-INF/manifest.xml")||ji(e,"objectdata.xml"))return pS(e,t);if(ji(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yg<"u"){if(e.FileIndex)return Yg(e);var r=jt.utils.cfb_new();return N5(e).forEach(function(U){qt(r,U,k7(e,U))}),Yg(r)}throw new Error("Unsupported NUMBERS file")}if(!ji(e,"[Content_Types].xml"))throw ji(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ji(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=N5(e),a=bI(ri(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",xn(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!xn(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Of=[],a.sst)try{Of=Wz(xn(e,vi(a.sst)),a.sst,t)}catch(U){if(t.WTF)throw U}t.cellStyles&&a.themes.length&&(c=$z(ri(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=zz(xn(e,vi(a.style)),a.style,c,t))}a.links.map(function(U){try{var Y=Pf(ri(e,qf(vi(U))),U);return Gz(xn(e,vi(U)),Y,U,t)}catch{}});var f=Dz(xn(e,vi(a.workbooks[0])),a.workbooks[0],t),d={},p="";a.coreprops.length&&(p=xn(e,vi(a.coreprops[0]),!0),p&&(d=Jj(p)),a.extprops.length!==0&&(p=xn(e,vi(a.extprops[0]),!0),p&&kI(p,d,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=ri(e,vi(a.custprops[0]),!0),p&&(h=CI(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(f.Sheets?s=f.Sheets.map(function(Y){return Y.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=h),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var g={};t.bookDeps&&a.calcchain&&(g=qz(xn(e,vi(a.calcchain)),a.calcchain));var x=0,b={},S,_;{var E=f.Sheets;d.Worksheets=E.length,d.SheetNames=[];for(var O=0;O!=E.length;++O)d.SheetNames[O]=E[O].name}var F=i?"bin":"xml",M=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,M+1)+"_rels/"+a.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");ji(e,C)||(C="xl/_rels/workbook."+F+".rels");var k=Pf(ri(e,C,!0),C.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Vz(xn(e,vi(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ER(xn(e,vi(a.people[0])),t)),k&&(k=pW(k,f.Sheets));var W=xn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var D="sheet";if(k&&k[x]?(S="xl/"+k[x][1].replace(/[\/]?xl\//,""),ji(e,S)||(S=k[x][1]),ji(e,S)||(S=C.replace(/_rels\/.*$/,"")+k[x][1]),D=k[x][2]):(S="xl/worksheets/sheet"+(x+1-W)+"."+F,S=S.replace(/sheet0\./,"sheet.")),_=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,H=0;H!=t.sheets.length;++H)typeof t.sheets[H]=="number"&&t.sheets[H]==x&&(j=1),typeof t.sheets[H]=="string"&&t.sheets[H].toLowerCase()==d.SheetNames[x].toLowerCase()&&(j=1);if(!j)continue e}}mW(e,S,_,d.SheetNames[x],x,b,s,D,t,f,c,u)}return m={Directory:a,Workbook:f,Props:d,Custprops:h,Deps:g,Sheets:s,SheetNames:d.SheetNames,Strings:Of,Styles:u,Themes:c,SSF:Or(Ft)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(U,Y){U=U.replace(/^Root Entry[\/]/,""),m.keys.push(U),m.files[U]=e.FileIndex[Y]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=xn(e,vi(a.vba[0]),!0):a.defaults&&a.defaults.bin===DR&&(m.vbaraw=xn(e,"xl/vbaProject.bin",!0))),m}function xW(e,t){var r=t||{},n="Workbook",a=jt.find(e,n);try{if(n="/!DataSpaces/Version",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(VD(a.content),n="/!DataSpaces/DataSpaceMap",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=KD(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=XD(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);ZD(a.content)}catch{}if(n="/EncryptionInfo",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=QD(a.content);if(n="/EncryptedPackage",a=jt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function vW(e,t){return t.bookType=="ods"?l6(e,t):t.bookType=="numbers"?dW(e,t):t.bookType=="xlsb"?yW(e,t):bW(e,t)}function yW(e,t){qc=1024,e&&!e.SSF&&(e.SSF=Or(Ft)),e&&e.SSF&&(yu(),Gp(e.SSF),t.revssf=Yp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Dk.indexOf(t.bookType)>-1,a=ey();my(t=t||{});var i=U2(),s="",o=0;if(t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qt(i,s,Zj(e.Props,t)),a.coreprops.push(s),fr(t.rels,2,s,Vt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,qt(i,s,tk(e.Props)),a.extprops.push(s),fr(t.rels,3,s,Vt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qt(i,s,rk(e.Custprops)),a.custprops.push(s),fr(t.rels,4,s,Vt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,qt(i,s,Kz(o-1,s,t,e,f)),a.sheets.push(s),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Vt.WS[0])}if(d){var h=d["!comments"],m=!1,g="";h&&h.length>0&&(g="xl/comments"+o+"."+r,qt(i,g,Zz(h,g)),a.comments.push(g),fr(f,-1,"../comments"+o+"."+r,Vt.CMNT),m=!0),d["!legacy"]&&m&&qt(i,"xl/drawings/vmlDrawing"+o+".vml",Ik(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&qt(i,qf(s),Xc(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qt(i,s,Jz(t.Strings,s,t)),a.strs.push(s),fr(t.wbrels,-1,"sharedStrings."+r,Vt.SST)),s="xl/workbook."+r,qt(i,s,Yz(e,s)),a.workbooks.push(s),fr(t.rels,1,s,Vt.WB),s="xl/theme/theme1.xml",qt(i,s,sy(e.Themes,t)),a.themes.push(s),fr(t.wbrels,-1,"theme/theme1.xml",Vt.THEME),s="xl/styles."+r,qt(i,s,Xz(e,s,t)),a.styles.push(s),fr(t.wbrels,-1,"styles."+r,Vt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qt(i,s,e.vbaraw),a.vba.push(s),fr(t.wbrels,-1,"vbaProject.bin",Vt.VBA)),s="xl/metadata."+r,qt(i,s,Qz(s)),a.metadata.push(s),fr(t.wbrels,-1,"metadata."+r,Vt.XLMETA),qt(i,"[Content_Types].xml",Kj(a,t)),qt(i,"_rels/.rels",Xc(t.rels)),qt(i,"xl/_rels/workbook."+r+".rels",Xc(t.wbrels)),delete t.revssf,delete t.ssf,i}function bW(e,t){qc=1024,e&&!e.SSF&&(e.SSF=Or(Ft)),e&&e.SSF&&(yu(),Gp(e.SSF),t.revssf=Yp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Dk.indexOf(t.bookType)>-1,a=ey();my(t=t||{});var i=U2(),s="",o=0;if(t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qt(i,s,Zj(e.Props,t)),a.coreprops.push(s),fr(t.rels,2,s,Vt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qt(i,s,tk(e.Props)),a.extprops.push(s),fr(t.rels,3,s,Vt.EXT_PROPS),e.Custprops!==e.Props&&Jr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qt(i,s,rk(e.Custprops)),a.custprops.push(s),fr(t.rels,4,s,Vt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,qt(i,s,Vk(o-1,t,e,d)),a.sheets.push(s),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Vt.WS[0])}if(p){var m=p["!comments"],g=!1,x="";if(m&&m.length>0){var b=!1;m.forEach(function(S){S[1].forEach(function(_){_.T==!0&&(b=!0)})}),b&&(x="xl/threadedComments/threadedComment"+o+"."+r,qt(i,x,kR(m,f,t)),a.threadedcomments.push(x),fr(d,-1,"../threadedComments/threadedComment"+o+"."+r,Vt.TCMNT)),x="xl/comments"+o+"."+r,qt(i,x,Lk(m)),a.comments.push(x),fr(d,-1,"../comments"+o+"."+r,Vt.CMNT),g=!0}p["!legacy"]&&g&&qt(i,"xl/drawings/vmlDrawing"+o+".vml",Ik(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&qt(i,qf(s),Xc(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qt(i,s,Sk(t.Strings,t)),a.strs.push(s),fr(t.wbrels,-1,"sharedStrings."+r,Vt.SST)),s="xl/workbook."+r,qt(i,s,Zk(e)),a.workbooks.push(s),fr(t.rels,1,s,Vt.WB),s="xl/theme/theme1.xml",qt(i,s,sy(e.Themes,t)),a.themes.push(s),fr(t.wbrels,-1,"theme/theme1.xml",Vt.THEME),s="xl/styles."+r,qt(i,s,Tk(e,t)),a.styles.push(s),fr(t.wbrels,-1,"styles."+r,Vt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qt(i,s,e.vbaraw),a.vba.push(s),fr(t.wbrels,-1,"vbaProject.bin",Vt.VBA)),s="xl/metadata."+r,qt(i,s,Fk()),a.metadata.push(s),fr(t.wbrels,-1,"metadata."+r,Vt.XLMETA),f.length>1&&(s="xl/persons/person.xml",qt(i,s,CR(f)),a.people.push(s),fr(t.wbrels,-1,"persons/person.xml",Vt.PEOPLE)),qt(i,"[Content_Types].xml",Kj(a,t)),qt(i,"_rels/.rels",Xc(t.rels)),qt(i,"xl/_rels/workbook."+r+".rels",Xc(t.wbrels)),delete t.revssf,delete t.ssf,i}function gy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=oi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wW(e,t){return jt.find(e,"EncryptedPackage")?xW(e,t):r6(e,t)}function SW(e,t){var r,n=e,a=t||{};return a.type||(a.type=Gt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Nj(n,a),gW(r,a)}function u6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return av(e.slice(r),t);default:break e}return ou.to_workbook(e,t)}function _W(e,t){var r="",n=gy(e,t);switch(t.type){case"base64":r=oi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Bl(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),t.type="binary",u6(r,t)}function NW(e,t){var r=e;return t.type=="base64"&&(r=oi(r)),r=Bf.utils.decode(1200,r.slice(2),"str"),t.type="binary",u6(r,t)}function AW(e){return e.match(/[^\x00-\x7F]/)?ys(e):e}function Kg(e,t,r,n){return n?(r.type="string",ou.to_workbook(e,r)):ou.to_workbook(t,r)}function ov(e,t){L2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ov(new Uint8Array(e),(r=Or(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Zc={},r.dateNF&&(Zc.dateNF=r.dateNF),r.type||(r.type=Gt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Gt?"buffer":"binary",n=y7(e),typeof Uint8Array<"u"&&!Gt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=AW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Or(r),r.type="array",ov(D2(n),r)}switch((a=gy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return wW(jt.read(n,r),r);break;case 9:if(a[1]<=8)return r6(n,r);break;case 60:return av(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return TD(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bk.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?SW(n,r):Kg(e,n,r,i);case 239:return a[3]===60?av(n,r):Kg(e,n,r,i);case 255:if(a[1]===254)return NW(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ol.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ol.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return nv.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return kk.to_workbook(n,r);break;case 10:case 13:case 32:return _W(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return CD.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?nv.to_workbook(n,r):Kg(e,n,r,i)}function f6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return xd(t.file,jt.write(e,{type:Gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return jt.write(e,t)}function jW(e,t){var r=Or(t||{}),n=vW(e,r);return kW(n,r)}function kW(e,t){var r={},n=Gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?jt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(qp(a))}return t.password&&typeof encrypt_agile<"u"?f6(encrypt_agile(a,t.password),t):t.type==="file"?xd(t.file,a):t.type=="string"?vr(a):a}function EW(e,t){var r=t||{},n=A$(e,r);return f6(n,r)}function ms(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Uf(ys(n));case"binary":return ys(n);case"string":return e;case"file":return xd(t.file,n,"utf8");case"buffer":return Gt?co(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ms(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function CW(e,t){switch(t.type){case"base64":return Uf(e);case"binary":return e;case"string":return e;case"file":return xd(t.file,e,"binary");case"buffer":return Gt?co(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Y0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Uf(r):t.type=="string"?vr(r):r;case"file":return xd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function em(e,t){L2(),wz(e);var r=Or(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=em(e,r);return r.type="array",qp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ms(v$(e,r),r);case"slk":case"sylk":return ms(yk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ms(a6(e.Sheets[e.SheetNames[a]],r),r);case"txt":return CW(d6(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ms(vy(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ms(bk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Y0(nv.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ms(ou.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ms(kk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ms(wk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ms(l6(e,r),r);case"wk1":return Y0(Ol.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Y0(Ol.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Y0(n6(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),EW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return jW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function TW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function xy(e,t,r){var n={};return n.type="file",n.file=t,TW(n),em(e,n)}function PW(e,t,r,n,a,i,s,o){var c=cn(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=s?e[r][h]:e[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;i[h]!=null&&(p[i[h]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(g==null)if(m.t=="e"&&g===null)p[i[h]]=null;else if(u!==void 0)p[i[h]]=u;else if(f&&g===null)p[i[h]]=null;else continue;else p[i[h]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:Qs(m,g,o);g!=null&&(d=!1)}}return{row:p,isempty:d}}function qh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=er(f);break;case"number":c=er(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=cn(c.s.r),p=[],h=[],m=0,g=0,x=Array.isArray(e),b=c.s.r,S=0,_={};x&&!e[b]&&(e[b]=[]);var E=u.skipHidden&&e["!cols"]||[],O=u.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(E[S]||{}).hidden)switch(p[S]=Br(S),r=x?e[b][S]:e[p[S]+d],n){case 1:i[S]=S-c.s.c;break;case 2:i[S]=p[S];break;case 3:i[S]=u.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Qs(r,null,u),g=_[s]||0,!g)_[s]=1;else{do o=s+"_"+g++;while(_[o]);_[s]=g,_[o]=1}i[S]=o}for(b=c.s.r+a;b<=c.e.r;++b)if(!(O[b]||{}).hidden){var F=PW(e,c,b,p,n,i,x,u);(F.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=F.row)}return h.length=m,h}var yS=/"/g;function OW(e,t,r,n,a,i,s,o){for(var c=!0,u=[],f="",d=cn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+d];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Qs(h,null,o));for(var m=0,g=0;m!==f.length;++m)if((g=f.charCodeAt(m))===a||g===i||g===34||o.forceQuotes){f='"'+f.replace(yS,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(yS,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(s)}function vy(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=er(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(p[m]||{}).hidden||(d[m]=Br(m));for(var g=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(f=OW(e,a,x,d,s,c,i,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function d6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=vy(e,t);return r}function FW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=er(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Br(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=cn(f),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function h6(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Ur(n.origin):n.origin;s=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var d=er(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+t.length-1+a)}else s==-1&&(s=0,f.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(g,x){Jr(g).forEach(function(b){(h=p.indexOf(b))==-1&&(p[h=p.length]=b);var S=g[b],_="z",E="",O=Lt({c:o+h,r:s+x+a});u=Zf(i,O),S&&typeof S=="object"&&!(S instanceof Date)?i[O]=S:(typeof S=="number"?_="n":typeof S=="boolean"?_="b":typeof S=="string"?_="s":S instanceof Date?(_="d",n.cellDates||(_="n",S=kn(S)),E=n.dateNF||Ft[14]):S===null&&n.nullError&&(_="e",S=0),u?(u.t=_,u.v=S,delete u.w,delete u.R,E&&(u.z=E)):i[O]=u={t:_,v:S},E&&(u.z=E))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var m=cn(s);if(a)for(h=0;h<p.length;++h)i[Br(h+o)+m]={t:"s",v:p[h]};return i["!ref"]=Ht(f),i}function IW(e,t){return h6(null,e,t)}function Zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ur(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zf(e,Lt(t)):Zf(e,Lt({r:t,c:r||0}))}function LW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yy(){return{SheetNames:[],Sheets:{}}}function by(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(Jk(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=LW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function MW(e,t){return e.z=t,e}function p6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function RW(e,t,r){return p6(e,"#"+t,r)}function BW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function UW(e,t,r,n){for(var a=typeof t!="string"?t:er(t),i=typeof t=="string"?t:Ht(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Zf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var pa={encode_col:Br,encode_row:cn,encode_cell:Lt,encode_range:Ht,decode_col:Y2,decode_row:V2,split_cell:J7,decode_cell:Ur,decode_range:$a,format_cell:Qs,sheet_add_aoa:$j,sheet_add_json:h6,sheet_add_dom:i6,aoa_to_sheet:bu,json_to_sheet:IW,table_to_sheet:s6,table_to_book:V$,sheet_to_csv:vy,sheet_to_txt:d6,sheet_to_json:qh,sheet_to_html:a6,sheet_to_formulae:FW,sheet_to_row_object_array:qh,sheet_get_cell:Zf,book_new:yy,book_append_sheet:by,book_set_sheet_visibility:DW,cell_set_number_format:MW,cell_set_hyperlink:p6,cell_set_internal_link:RW,cell_add_comment:BW,sheet_set_array_formula:UW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const zW=()=>{const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState([]),[c,u]=y.useState(""),[f,d]=y.useState([]),[p,h]=y.useState(""),[m,g]=y.useState([]),[x,b]=y.useState(""),[S,_]=y.useState([]),[E,O]=y.useState(""),[F,M]=y.useState([]),[C,k]=y.useState(0),[W,D]=y.useState([]),[j,H]=y.useState(!1),[U,Y]=y.useState(!1),[X,Z]=y.useState(null);y.useEffect(()=>{const R=localStorage.getItem("academicYear")||"",G=localStorage.getItem("user");let J="All";if(G)try{const q=JSON.parse(G);if(q.role==="Admin"||q.branch==="All"||q.branch==="AllBranches"){const Q=localStorage.getItem("currentBranch");Q&&Q!=="All"&&Q!=="All Locations"&&(J=Q)}else J=q.branch||"All";q.role}catch(q){console.error("Error parsing user",q)}t(R),i(J),n([{branch_name:J,branch_code:J}])},[]),y.useEffect(()=>{a&&Ee.get(`/classes?branch=${a}`).then(R=>o(R.data.classes||R.data)).catch(R=>console.error(R))},[a]),y.useEffect(()=>{const R=s.find(G=>G.id==c);if(!R){d([]);return}Ee.get(`/sections?class=${R.class_name}`).then(G=>d(G.data.sections||[])).catch(G=>{console.error(G),d([])})},[c,s]),y.useEffect(()=>{!c||!e||Ee.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:c}}).then(R=>{g(R.data)}).catch(R=>console.error(R))},[c,e,a]),y.useEffect(()=>{if(!x){_([]);return}const R=m.find(G=>G.test_id==x);R&&R.subjects?_(R.subjects):_([])},[x,m]);const[K,z]=y.useState(null),se=()=>{if(!x||!E){Z({type:"error",text:"Please select Test and Subject"});return}H(!0),Z(null),z(null),M([]),Ee.get("/marks/entry/subject",{params:{academic_year:e,branch:a,class_id:c,section:p,test_id:x,subject_id:E}}).then(R=>{M(R.data.students),k(R.data.subject_total_marks),D(R.data.grading_scale),z(R.data.class_test_id)}).catch(R=>{var G,J;console.error(R),Z({type:"error",text:((J=(G=R.response)==null?void 0:G.data)==null?void 0:J.error)||"Failed to load marks"})}).finally(()=>H(!1))},xe=(R,G)=>{M(J=>J.map(q=>q.student_id!==R?q:{...q,marks_obtained:G}))},A=R=>{M(G=>G.map(J=>{if(J.student_id!==R)return J;let q=J.marks_obtained,Q=!1;if(typeof q=="string"){const V=q.trim().toUpperCase();if(V==="AB")Q=!0,q="AB";else if(V==="")q="";else{const Oe=parseFloat(V);if(!isNaN(Oe)&&isFinite(Oe)){let Te=Math.round(Oe);Te<0&&(Te=0),Te>C?(alert(`Marks cannot exceed ${C}`),q=""):q=String(Te)}else q=""}}let fe="";if(!Q){if(q!==""&&q!==null&&q!==void 0){const V=parseInt(String(q),10),Oe=W.find(Te=>V>=Te.min&&V<=Te.max);Oe&&(fe=Oe.grade)}}return{...J,marks_obtained:q,is_absent:Q,grade:fe}}))},I=()=>{if(F.length===0)return;if(!K){Z({type:"error",text:"Internal Error: Missing Class Test ID. Please reload data."});return}Y(!0),Z(null);const R={class_test_id:K,subject_id:E,academic_year:e,branch:a,class_id:c,section:p,user_id:1,marks:F.map(G=>({student_id:G.student_id,value:G.is_absent?"AB":G.marks_obtained}))};Ee.post("/marks/entry/subject",R).then(G=>{Z({type:"success",text:"Marks saved successfully!"})}).catch(G=>{var J,q;console.error(G),Z({type:"error",text:((q=(J=G.response)==null?void 0:J.data)==null?void 0:q.error)||"Failed to save marks"})}).finally(()=>Y(!1))},P=()=>{se()},L=()=>{var Te,be,re;if(F.length===0){Z({type:"error",text:"No data to download."});return}const R=((Te=s.find(we=>we.id==c))==null?void 0:Te.class_name)||"Class",G=((be=S.find(we=>we.id==E))==null?void 0:be.subject_name)||"Subject",J=((re=m.find(we=>we.test_id==x))==null?void 0:re.test_name)||"Test",q=["S.No","Roll No","Admission No","Student Name","Marks","Grade","Status"],Q=F.map((we,ve)=>[ve+1,we.roll_number,we.admission_no,we.name,we.is_absent?"AB":we.marks_obtained,we.grade||"-",we.is_absent?"Absent":we.marks_obtained!==""&&we.marks_obtained!==null&&we.marks_obtained!==void 0?"Present":"-"]),fe=pa.aoa_to_sheet([q,...Q]),V=pa.book_new();pa.book_append_sheet(V,fe,"Marks");const Oe=`${R}_${G}_${J}_Marks.xlsx`;xy(V,Oe)};return l.jsxs("div",{className:"p-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4 border-b pb-2",children:"Enter Subject Marks"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 bg-white p-4 rounded shadow-sm",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),l.jsx("select",{value:a,onChange:R=>i(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",disabled:r.length<=1,children:r.map(R=>l.jsx("option",{value:R.branch_code,children:R.branch_name},R.branch_code))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Class"}),s.map(R=>l.jsx("option",{value:R.id,children:R.class_name},R.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:p,onChange:R=>h(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Section"}),f.map(R=>l.jsx("option",{value:R,children:R},R))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test"}),l.jsxs("select",{value:x,onChange:R=>b(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Test"}),m.map(R=>l.jsx("option",{value:R.test_id,children:R.test_name},R.test_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),l.jsxs("select",{value:E,onChange:R=>O(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Subject"}),S.map(R=>l.jsx("option",{value:R.id,children:R.subject_name},R.id))]})]})]}),l.jsx("div",{className:"mb-4",children:l.jsx("button",{type:"button",onClick:se,disabled:j||!x||!E,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400",children:j?"Loading...":"Get Marks"})}),X&&l.jsx("div",{className:`p-3 rounded mb-4 ${X.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:X.text}),F.length>0&&l.jsxs("div",{className:"bg-white shadow rounded overflow-hidden",children:[l.jsxs("div",{className:"p-3 bg-gray-50 border-b flex justify-between items-center",children:[l.jsxs("span",{className:"font-semibold text-gray-700",children:["Max Marks: ",C]}),l.jsxs("div",{className:"text-sm text-gray-500",children:["Valid inputs: 0-",C,', "AB" (Absent)']})]}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S.No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admission No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marks"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map((R,G)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:G+1}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.roll_number}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R.admission_no}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:R.name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"text",value:R.is_absent?"AB":R.marks_obtained!==null&&R.marks_obtained!==void 0?String(R.marks_obtained).split(".")[0]:"",onChange:J=>xe(R.student_id,J.target.value),onBlur:()=>A(R.student_id),className:`border rounded px-2 py-1 w-24 focus:outline-none focus:ring-2 
                                                ${R.is_absent?"bg-red-50 border-red-300 text-red-700 font-bold":"border-gray-300"}
                                            `,placeholder:"-"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 font-bold",children:R.grade||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:R.is_absent?l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Absent"}):R.marks_obtained!==""&&R.marks_obtained!==null&&R.marks_obtained!==void 0?l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Present"}):l.jsx("span",{className:"text-gray-400",children:"-"})})]},R.student_id))})]}),l.jsxs("div",{className:"p-4 bg-gray-50 border-t flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:P,disabled:U,className:`bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 flex items-center gap-2 ${U?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsxs("button",{type:"button",onClick:L,disabled:U||F.length===0,className:`bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 flex items-center gap-2 ${U||F.length===0?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(aj,{size:18}),"Download Excel"]}),l.jsxs("button",{type:"button",onClick:I,disabled:U,className:`bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 flex items-center gap-2 ${U?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(xu,{size:18}),U?"Saving...":"Save Marks"]})]})]})]})},$W=()=>{const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState([]),[c,u]=y.useState(""),[f,d]=y.useState([]),[p,h]=y.useState(""),[m,g]=y.useState([]),[x,b]=y.useState(""),[S,_]=y.useState([]),[E,O]=y.useState(""),[F,M]=y.useState([]),[C,k]=y.useState(0),[W,D]=y.useState([]),[j,H]=y.useState(null),[U,Y]=y.useState(!1),[X,Z]=y.useState(!1),[K,z]=y.useState(null),se=y.useRef(null);y.useEffect(()=>{const P=localStorage.getItem("academicYear")||"",L=localStorage.getItem("user");let R="All";if(L)try{const G=JSON.parse(L);if(G.role==="Admin"||G.branch==="All"||G.branch==="AllBranches"){const J=localStorage.getItem("currentBranch");J&&J!=="All"&&J!=="All Locations"&&(R=J)}else R=G.branch||"All"}catch(G){console.error("Error parsing user",G)}t(P),i(R),n([{branch_name:R,branch_code:R}])},[]),y.useEffect(()=>{a&&Ee.get(`/classes?branch=${a}`).then(P=>o(P.data.classes||P.data)).catch(P=>console.error(P))},[a]),y.useEffect(()=>{!c||!e||Ee.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:c}}).then(P=>g(P.data)).catch(P=>console.error(P))},[c,e,a]),y.useEffect(()=>{if(!x){_([]);return}const P=m.find(L=>L.test_id==x);P&&P.subjects?_(P.subjects):_([])},[x,m]),y.useEffect(()=>{!x||!E||!c||(Y(!0),Ee.get("/marks/entry/subject",{params:{academic_year:e,branch:a,class_id:c,section:p,test_id:x,subject_id:E}}).then(P=>{M(P.data.students),k(P.data.subject_total_marks),D(P.data.grading_scale),H(P.data.class_test_id)}).catch(P=>{console.error(P),z({type:"error",text:"Failed to load class configuration."})}).finally(()=>Y(!1)))},[x,E,c,p]);const xe=()=>{var V,Oe,Te;if(F.length===0){z({type:"error",text:"No students found to generate template."});return}const P=((V=s.find(be=>be.id==c))==null?void 0:V.class_name)||"Class",L=((Oe=S.find(be=>be.id==E))==null?void 0:Oe.subject_name)||"Subject",R=((Te=m.find(be=>be.test_id==x))==null?void 0:Te.test_name)||"Test",G=["Student ID","Roll No","Admission No","Student Name","Marks (Max: "+C+")"],J=F.map(be=>[be.student_id,be.roll_number,be.admission_no,be.name,""]),q=pa.aoa_to_sheet([G,...J]),Q=pa.book_new();pa.book_append_sheet(Q,q,"MarksEntry");const fe=`${P}_${L}_${R}_Template.xlsx`;xy(Q,fe)},A=()=>{se.current&&(se.current.value="",se.current.click())},I=P=>{var G;const L=(G=P.target.files)==null?void 0:G[0];if(!L)return;if(!j){z({type:"error",text:"System Error: Missing active class test ID."});return}Z(!0),z(null);const R=new FileReader;R.onload=J=>{var q;try{const Q=(q=J.target)==null?void 0:q.result,fe=ov(Q,{type:"binary"}),V=fe.SheetNames[0],Oe=fe.Sheets[V],Te=pa.sheet_to_json(Oe,{header:1}),be=[];let re=[];for(let ve=1;ve<Te.length;ve++){const ye=Te[ve];if(!ye||ye.length===0)continue;const Ce=parseInt(ye[0]);let ze=ye[4];const $e=F.find(Qe=>Qe.student_id===Ce);if(!$e)continue;let Ue="",Xe=!1;if(!(ze==null||String(ze).trim()==="")){{const Qe=String(ze).trim().toUpperCase();if(Qe==="AB"||Qe==="ABSENT")Xe=!0,Ue="AB";else{const bt=parseFloat(Qe);if(isNaN(bt)){re.push(`Row ${ve+1}: Invalid mark '${ze}' for ${$e.name}`);continue}if(bt<0||bt>C){re.push(`Row ${ve+1}: Mark ${bt} exceeds max ${C} for ${$e.name}`);continue}Ue=bt}}be.push({student_id:Ce,value:Xe?"AB":Ue})}}if(re.length>0){alert(`Issues found in Excel:
`+re.slice(0,10).join(`
`)),Z(!1);return}if(be.length===0){z({type:"error",text:"No valid marks found in file."}),Z(!1);return}const we={class_test_id:j,subject_id:E,academic_year:e,branch:a,class_id:c,user_id:1,marks:be};Ee.post("/marks/entry/subject",we).then(ve=>{z({type:"success",text:`Successfully saved marks for ${be.length} students!`})}).catch(ve=>{var ye,Ce;console.error(ve),z({type:"error",text:((Ce=(ye=ve.response)==null?void 0:ye.data)==null?void 0:Ce.error)||"Failed to save marks"})}).finally(()=>Z(!1))}catch(Q){console.error(Q),z({type:"error",text:"Failed to parse Excel file."}),Z(!1)}},R.readAsBinaryString(L)};return l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"mb-6 bg-rose-50 border border-rose-200 p-4 rounded text-sm text-gray-700",children:[l.jsx("h3",{className:"text-red-600 font-bold mb-2",children:"Important!!"}),l.jsx("p",{className:"mb-1 text-gray-800 font-medium",children:"Note :Please read the following instructions:"}),l.jsxs("ul",{className:"list-decimal pl-5 space-y-1",children:[l.jsx("li",{children:"Please don't make any changes in given template."}),l.jsx("li",{children:"Only 80 records are accepted in the list at a time."}),l.jsx("li",{children:"The data should be in valid format to upload successfully."}),l.jsx("li",{children:"For Ispresent column enter score for Absent  use 'AB' in Marks column"}),l.jsx("li",{children:"In mark column you can enter mark, grade and absent remark."})]})]}),l.jsxs("h2",{className:"text-xl font-bold text-gray-700 mb-4 flex items-center gap-2",children:[l.jsx(u5,{size:24,className:"text-blue-600"}),"Import Subject Marks"]}),l.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Class ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:c,onChange:P=>u(P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Class"}),s.map(P=>l.jsx("option",{value:P.id,children:P.class_name},P.id))]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Schedule Test ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:x,onChange:P=>b(P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Test"}),m.map(P=>l.jsx("option",{value:P.test_id,children:P.test_name},P.test_id))]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Subject ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:E,onChange:P=>O(P.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Subject"}),S.map(P=>l.jsx("option",{value:P.id,children:P.subject_name},P.id))]})]})]}),l.jsxs("div",{className:"flex flex-col md:flex-row items-end gap-4 border-t pt-4",children:[l.jsxs("div",{className:"flex-1 w-full",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Browse for the excel sheet:"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",readOnly:!0,placeholder:"No file chosen",className:"block w-full rounded-md border-gray-300 shadow-sm sm:text-sm border p-2 bg-gray-50 text-gray-500"}),l.jsx("input",{type:"file",ref:se,style:{display:"none"},accept:".xlsx, .xls",onChange:I}),l.jsx("button",{type:"button",onClick:A,className:"bg-gray-200 border border-gray-300 text-gray-700 px-3 py-2 rounded hover:bg-gray-300 text-xs whitespace-nowrap",children:"Choose File"})]})]}),l.jsx("button",{type:"button",onClick:A,disabled:X||!x||!E,className:`bg-blue-500 text-white px-6 py-2.5 rounded hover:bg-blue-600 flex items-center gap-2 font-medium ${X||!x?"opacity-50 cursor-not-allowed":""}`,children:X?"Uploading...":"Upload Excel"}),l.jsxs("button",{type:"button",onClick:xe,disabled:U||!x||F.length===0,className:`bg-emerald-500 text-white px-6 py-2.5 rounded hover:bg-emerald-600 flex items-center gap-2 font-medium ${F.length===0?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(aj,{size:18}),"Download Template"]})]})]}),K&&l.jsxs("div",{className:`p-3 rounded mb-4 flex items-center gap-2 ${K.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[K.type==="error"?l.jsx(Oh,{size:18}):l.jsx(u5,{size:18}),K.text]})]})};function m6(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=m6(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function rr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=m6(e))&&(n&&(n+=" "),n+=t);return n}var WW=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function wy(e){if(typeof e!="string")return!1;var t=WW;return t.includes(e)}var HW=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],qW=new Set(HW);function g6(e){return typeof e!="string"?!1:qW.has(e)}function x6(e){return typeof e=="string"&&e.startsWith("data-")}function li(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(g6(r)||x6(r))&&(t[r]=e[r]);return t}function Hl(e){if(e==null)return null;if(y.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return li(t)}return typeof e=="object"&&!Array.isArray(e)?li(e):null}function Ta(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(g6(r)||x6(r)||wy(r))&&(t[r]=e[r]);return t}function GW(e){return e==null?null:y.isValidElement(e)?Ta(e.props):typeof e=="object"&&!Array.isArray(e)?Ta(e):null}var VW=["children","width","height","viewBox","className","style","title","desc"];function lv(){return lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lv.apply(null,arguments)}function YW(e,t){if(e==null)return{};var r,n,a=KW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Sy=y.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:c,desc:u}=e,f=YW(e,VW),d=i||{width:n,height:a,x:0,y:0},p=rr("recharts-surface",s);return y.createElement("svg",lv({},Ta(f),{className:p,width:n,height:a,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:t}),y.createElement("title",null,c),y.createElement("desc",null,u),r)}),XW=["children","className"];function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cv.apply(null,arguments)}function JW(e,t){if(e==null)return{};var r,n,a=ZW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Hn=y.forwardRef((e,t)=>{var{children:r,className:n}=e,a=JW(e,XW),i=rr("recharts-layer",n);return y.createElement("g",cv({className:i},Ta(a),{ref:t}),r)}),v6=y.createContext(null),QW=()=>y.useContext(v6);function Ar(e){return function(){return e}}const y6=Math.cos,Gh=Math.sin,ns=Math.sqrt,Vh=Math.PI,tm=2*Vh,uv=Math.PI,fv=2*uv,vl=1e-6,eH=fv-vl;function b6(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function tH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return b6;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class rH{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?b6:tH(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,f=s-t,d=o-r,p=f*f+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>vl)if(!(Math.abs(d*c-u*f)>vl)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,m=a-o,g=c*c+u*u,x=h*h+m*m,b=Math.sqrt(g),S=Math.sqrt(p),_=i*Math.tan((uv-Math.acos((g+p-x)/(2*b*S)))/2),E=_/S,O=_/b;Math.abs(E-1)>vl&&this._append`L${t+E*f},${r+E*d}`,this._append`A${i},${i},0,0,${+(d*h>f*m)},${this._x1=t+O*c},${this._y1=r+O*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,f=r+c,d=1^s,p=s?a-i:i-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>vl||Math.abs(this._y1-f)>vl)&&this._append`L${u},${f}`,n&&(p<0&&(p=p%fv+fv),p>eH?this._append`A${n},${n},0,1,${d},${t-o},${r-c}A${n},${n},0,1,${d},${this._x1=u},${this._y1=f}`:p>vl&&this._append`A${n},${n},0,${+(p>=uv)},${d},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function _y(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new rH(t)}function Ny(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function w6(e){this._context=e}w6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function rm(e){return new w6(e)}function S6(e){return e[0]}function _6(e){return e[1]}function N6(e,t){var r=Ar(!0),n=null,a=rm,i=null,s=_y(o);e=typeof e=="function"?e:e===void 0?S6:Ar(e),t=typeof t=="function"?t:t===void 0?_6:Ar(t);function o(c){var u,f=(c=Ny(c)).length,d,p=!1,h;for(n==null&&(i=a(h=s())),u=0;u<=f;++u)!(u<f&&r(d=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(d,u,c),+t(d,u,c));if(h)return i=null,h+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ar(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ar(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ar(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function K0(e,t,r){var n=null,a=Ar(!0),i=null,s=rm,o=null,c=_y(u);e=typeof e=="function"?e:e===void 0?S6:Ar(+e),t=typeof t=="function"?t:Ar(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?_6:Ar(+r);function u(d){var p,h,m,g=(d=Ny(d)).length,x,b=!1,S,_=new Array(g),E=new Array(g);for(i==null&&(o=s(S=c())),p=0;p<=g;++p){if(!(p<g&&a(x=d[p],p,d))===b)if(b=!b)h=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),m=p-1;m>=h;--m)o.point(_[m],E[m]);o.lineEnd(),o.areaEnd()}b&&(_[p]=+e(x,p,d),E[p]=+t(x,p,d),o.point(n?+n(x,p,d):_[p],r?+r(x,p,d):E[p]))}if(S)return o=null,S+""||null}function f(){return N6().defined(a).curve(s).context(i)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:Ar(+d),n=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:Ar(+d),u):e},u.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Ar(+d),u):n},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:Ar(+d),r=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:Ar(+d),u):t},u.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Ar(+d),u):r},u.lineX0=u.lineY0=function(){return f().x(e).y(t)},u.lineY1=function(){return f().x(e).y(r)},u.lineX1=function(){return f().x(n).y(t)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:Ar(!!d),u):a},u.curve=function(d){return arguments.length?(s=d,i!=null&&(o=s(i)),u):s},u.context=function(d){return arguments.length?(d==null?i=o=null:o=s(i=d),u):i},u}class A6{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function nH(e){return new A6(e,!0)}function aH(e){return new A6(e,!1)}const Ay={draw(e,t){const r=ns(t/Vh);e.moveTo(r,0),e.arc(0,0,r,0,tm)}},iH={draw(e,t){const r=ns(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},j6=ns(1/3),sH=j6*2,oH={draw(e,t){const r=ns(t/sH),n=r*j6;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},lH={draw(e,t){const r=ns(t),n=-r/2;e.rect(n,n,r,r)}},cH=.8908130915292852,k6=Gh(Vh/10)/Gh(7*Vh/10),uH=Gh(tm/10)*k6,fH=-y6(tm/10)*k6,dH={draw(e,t){const r=ns(t*cH),n=uH*r,a=fH*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=tm*i/5,o=y6(s),c=Gh(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},Xg=ns(3),hH={draw(e,t){const r=-ns(t/(Xg*3));e.moveTo(0,r*2),e.lineTo(-Xg*r,-r),e.lineTo(Xg*r,-r),e.closePath()}},yi=-.5,bi=ns(3)/2,dv=1/ns(12),pH=(dv/2+1)*3,mH={draw(e,t){const r=ns(t/pH),n=r/2,a=r*dv,i=n,s=r*dv+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(yi*n-bi*a,bi*n+yi*a),e.lineTo(yi*i-bi*s,bi*i+yi*s),e.lineTo(yi*o-bi*c,bi*o+yi*c),e.lineTo(yi*n+bi*a,yi*a-bi*n),e.lineTo(yi*i+bi*s,yi*s-bi*i),e.lineTo(yi*o+bi*c,yi*c-bi*o),e.closePath()}};function gH(e,t){let r=null,n=_y(a);e=typeof e=="function"?e:Ar(e||Ay),t=typeof t=="function"?t:Ar(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Ar(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Yh(){}function Kh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function E6(e){this._context=e}E6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Kh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xH(e){return new E6(e)}function C6(e){this._context=e}C6.prototype={areaStart:Yh,areaEnd:Yh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vH(e){return new C6(e)}function T6(e){this._context=e}T6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function yH(e){return new T6(e)}function P6(e){this._context=e}P6.prototype={areaStart:Yh,areaEnd:Yh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function bH(e){return new P6(e)}function bS(e){return e<0?-1:1}function wS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(bS(i)+bS(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function SS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Jg(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function Xh(e){this._context=e}Xh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jg(this,this._t0,SS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Jg(this,SS(this,r=wS(this,e,t)),r);break;default:Jg(this,this._t0,r=wS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function O6(e){this._context=new F6(e)}(O6.prototype=Object.create(Xh.prototype)).point=function(e,t){Xh.prototype.point.call(this,t,e)};function F6(e){this._context=e}F6.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function wH(e){return new Xh(e)}function SH(e){return new O6(e)}function I6(e){this._context=e}I6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=_S(e),a=_S(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function _S(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function _H(e){return new I6(e)}function nm(e,t){this._context=e,this._t=t}nm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function NH(e){return new nm(e,.5)}function AH(e){return new nm(e,0)}function jH(e){return new nm(e,1)}function ql(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function hv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function kH(e,t){return e[t]}function EH(e){const t=[];return t.key=e,t}function CH(){var e=Ar([]),t=hv,r=ql,n=kH;function a(i){var s=Array.from(e.apply(this,arguments),EH),o,c=s.length,u=-1,f;for(const d of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(d,s[o].key,u,i)]).data=d;for(o=0,f=Ny(t(s));o<c;++o)s[f[o]].index=o;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Ar(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?hv:typeof i=="function"?i:Ar(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??ql,a):r},a}function TH(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}ql(e,t)}}function PH(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}ql(e,t)}}function OH(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var f=e[t[o]],d=f[n][1]||0,p=f[n-1][1]||0,h=(d-p)/2,m=0;m<o;++m){var g=e[t[m]],x=g[n][1]||0,b=g[n-1][1]||0;h+=x-b}c+=d,u+=h*d}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,ql(e,t)}}var Zg={},Qg={},NS;function FH(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Qg)),Qg}var ex={},AS;function L6(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(ex)),ex}var tx={},jS;function jy(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(tx)),tx}var rx={},nx={},kS;function IH(){return kS||(kS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(nx)),nx}var ES;function ky(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IH(),r=jy();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let o=0,c="",u="",f=!1;for(a.charCodeAt(0)===46&&(i.push(""),o++);o<s;){const d=a[o];u?d==="\\"&&o+1<s?(o++,c+=a[o]):d===u?u="":c+=d:f?d==='"'||d==="'"?u=d:d==="]"?(f=!1,i.push(c),c=""):c+=d:d==="["?(f=!0,c&&(i.push(c),c="")):d==="."?c&&(i.push(c),c=""):c+=d,o++}return c&&i.push(c),i}e.toPath=n})(rx)),rx}var CS;function Ey(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FH(),r=L6(),n=jy(),a=ky();function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const f=o[c];return f===void 0?r.isDeepKey(c)?i(o,a.toPath(c),u):u:f}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const f=o[c];return f===void 0?u:f}default:{if(Array.isArray(c))return s(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const f=o[c];return f===void 0?u:f}}}function s(o,c,u){if(c.length===0)return u;let f=o;for(let d=0;d<c.length;d++){if(f==null||t.isUnsafeProperty(c[d]))return u;f=f[c[d]]}return f===void 0?u:f}e.get=i})(Zg)),Zg}var ax,TS;function LH(){return TS||(TS=1,ax=Ey().get),ax}var DH=LH();const Gl=lo(DH);var MH=4;function $o(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:MH,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Vr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,i,s)=>{var o=r[s-1];return typeof o=="string"?a+o+i:o!==void 0?a+$o(o)+i:a+i},"")}var Wn=e=>e===0?0:e>0?1:-1,ts=e=>typeof e=="number"&&e!=+e,eo=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,gt=e=>(typeof e=="number"||e instanceof Number)&&!ts(e),Ns=e=>gt(e)||typeof e=="string",RH=0,Qf=e=>{var t=++RH;return"".concat(e||"").concat(t)},ga=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!gt(t)&&typeof t!="string")return n;var i;if(eo(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ts(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},D6=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Ir(e,t,r){return gt(e)&&gt(t)?$o(e+r*(t-e)):t}function M6(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Gl(n,t))===r)}var Dr=e=>e===null||typeof e>"u",Ad=e=>Dr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function BH(e){return e!=null}function jd(){}var UH=["type","size","sizeType"];function pv(){return pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pv.apply(null,arguments)}function PS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PS(Object(r),!0).forEach(function(n){zH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zH(e,t,r){return(t=$H(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $H(e){var t=WH(e,"string");return typeof t=="symbol"?t:t+""}function WH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HH(e,t){if(e==null)return{};var r,n,a=qH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var R6={symbolCircle:Ay,symbolCross:iH,symbolDiamond:oH,symbolSquare:lH,symbolStar:dH,symbolTriangle:hH,symbolWye:mH},GH=Math.PI/180,VH=e=>{var t="symbol".concat(Ad(e));return R6[t]||Ay},YH=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*GH;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},KH=(e,t)=>{R6["symbol".concat(Ad(e))]=t},Cy=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=HH(e,UH),i=OS(OS({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var o=()=>{var p=VH(s),h=gH().type(p).size(YH(r,n,s)),m=h();if(m!==null)return m},{className:c,cx:u,cy:f}=i,d=Ta(i);return gt(u)&&gt(f)&&gt(r)?y.createElement("path",pv({},d,{className:rr("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(f,")"),d:o()})):null};Cy.registerSymbol=KH;var B6=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Ty=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(y.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{wy(a)&&(n[a]=(i=>r[a](r,i)))}),n},XH=(e,t,r)=>n=>(e(t,r,n),null),kd=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];wy(a)&&typeof i=="function"&&(n||(n={}),n[a]=XH(i,t,r))}),n};function FS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function JH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FS(Object(r),!0).forEach(function(n){ZH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZH(e,t,r){return(t=QH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QH(e){var t=eq(e,"string");return typeof t=="symbol"?t:t+""}function eq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _n(e,t){var r=JH({},e),n=t,a=Object.keys(t),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}function Jh(){return Jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jh.apply(null,arguments)}function IS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IS(Object(r),!0).forEach(function(n){rq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rq(e,t,r){return(t=nq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nq(e){var t=aq(e,"string");return typeof t=="symbol"?t:t+""}function aq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ai=32,iq={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function sq(e){var{data:t,iconType:r,inactiveColor:n}=e,a=Ai/2,i=Ai/6,s=Ai/3,o=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return y.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:Ai,y2:a,className:"recharts-legend-icon"})}if(c==="line")return y.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(Ai,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return y.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(Ai/8,"h").concat(Ai,"v").concat(Ai*3/4,"h").concat(-Ai,"z"),className:"recharts-legend-icon"});if(y.isValidElement(t.legendIcon)){var f=tq({},t);return delete f.legendIcon,y.cloneElement(t.legendIcon,f)}return y.createElement(Cy,{fill:o,cx:a,cy:a,size:Ai,sizeType:"diameter",type:c})}function oq(e){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=e,o={x:0,y:0,width:Ai,height:Ai},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((f,d)=>{var p=f.formatter||a,h=rr({"recharts-legend-item":!0,["legend-item-".concat(d)]:!0,inactive:f.inactive});if(f.type==="none")return null;var m=f.inactive?i:f.color,g=p?p(f.value,f,d):f.value;return y.createElement("li",Jh({className:h,style:c,key:"legend-item-".concat(d)},kd(e,f,d)),y.createElement(Sy,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(g," legend icon")},y.createElement(sq,{data:f,iconType:s,inactiveColor:i})),y.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var lq=e=>{var t=_n(e,iq),{payload:r,layout:n,align:a}=t;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return y.createElement("ul",{className:"recharts-default-legend",style:i},y.createElement(oq,Jh({},t,{payload:r})))},ix={},sx={},LS;function cq(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s,i,r);a.has(o)||a.set(o,s)}return Array.from(a.values())}e.uniqBy=t})(sx)),sx}var ox={},DS;function uq(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(ox)),ox}var lx={},MS;function U6(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(lx)),lx}var cx={},ux={},fx={},RS;function fq(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(fx)),fx}var BS;function Py(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fq();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(ux)),ux}var dx={},US;function dq(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(dx)),dx}var zS;function hq(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Py(),r=dq();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(cx)),cx}var hx={},px={},$S;function pq(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ey();function r(n){return function(a){return t.get(a,n)}}e.property=r})(px)),px}var mx={},gx={},xx={},vx={},WS;function z6(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(vx)),vx}var yx={},HS;function $6(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(yx)),yx}var bx={},qS;function W6(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(bx)),bx}var GS;function mq(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z6(),r=$6(),n=W6();function a(f,d,p){return typeof p!="function"?a(f,d,()=>{}):i(f,d,function h(m,g,x,b,S,_){const E=p(m,g,x,b,S,_);return E!==void 0?!!E:i(m,g,h,_)},new Map)}function i(f,d,p,h){if(d===f)return!0;switch(typeof d){case"object":return s(f,d,p,h);case"function":return Object.keys(d).length>0?i(f,{...d},p,h):n.isEqualsSameValueZero(f,d);default:return t.isObject(f)?typeof d=="string"?d==="":!0:n.isEqualsSameValueZero(f,d)}}function s(f,d,p,h){if(d==null)return!0;if(Array.isArray(d))return c(f,d,p,h);if(d instanceof Map)return o(f,d,p,h);if(d instanceof Set)return u(f,d,p,h);const m=Object.keys(d);if(f==null||r.isPrimitive(f))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(d))return h.get(d)===f;h==null||h.set(d,f);try{for(let g=0;g<m.length;g++){const x=m[g];if(!r.isPrimitive(f)&&!(x in f)||d[x]===void 0&&f[x]!==void 0||d[x]===null&&f[x]!==null||!p(f[x],d[x],x,f,d,h))return!1}return!0}finally{h==null||h.delete(d)}}function o(f,d,p,h){if(d.size===0)return!0;if(!(f instanceof Map))return!1;for(const[m,g]of d.entries()){const x=f.get(m);if(p(x,g,m,f,d,h)===!1)return!1}return!0}function c(f,d,p,h){if(d.length===0)return!0;if(!Array.isArray(f))return!1;const m=new Set;for(let g=0;g<d.length;g++){const x=d[g];let b=!1;for(let S=0;S<f.length;S++){if(m.has(S))continue;const _=f[S];let E=!1;if(p(_,x,g,f,d,h)&&(E=!0),E){m.add(S),b=!0;break}}if(!b)return!1}return!0}function u(f,d,p,h){return d.size===0?!0:f instanceof Set?c([...f],[...d],p,h):!1}e.isMatchWith=a,e.isSetMatch=u})(xx)),xx}var VS;function H6(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mq();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(gx)),gx}var wx={},Sx={},_x={},YS;function gq(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(_x)),_x}var Nx={},KS;function Oy(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Nx)),Nx}var Ax={},XS;function q6(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",f="[object Array]",d="[object Function]",p="[object ArrayBuffer]",h="[object Object]",m="[object Error]",g="[object DataView]",x="[object Uint8Array]",b="[object Uint8ClampedArray]",S="[object Uint16Array]",_="[object Uint32Array]",E="[object BigUint64Array]",O="[object Int8Array]",F="[object Int16Array]",M="[object Int32Array]",C="[object BigInt64Array]",k="[object Float32Array]",W="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=f,e.bigInt64ArrayTag=C,e.bigUint64ArrayTag=E,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=m,e.float32ArrayTag=k,e.float64ArrayTag=W,e.functionTag=d,e.int16ArrayTag=F,e.int32ArrayTag=M,e.int8ArrayTag=O,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=S,e.uint32ArrayTag=_,e.uint8ArrayTag=x,e.uint8ClampedArrayTag=b})(Ax)),Ax}var jx={},JS;function xq(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(jx)),jx}var ZS;function G6(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gq(),r=Oy(),n=q6(),a=$6(),i=xq();function s(f,d){return o(f,void 0,f,new Map,d)}function o(f,d,p,h=new Map,m=void 0){const g=m==null?void 0:m(f,d,p,h);if(g!==void 0)return g;if(a.isPrimitive(f))return f;if(h.has(f))return h.get(f);if(Array.isArray(f)){const x=new Array(f.length);h.set(f,x);for(let b=0;b<f.length;b++)x[b]=o(f[b],b,p,h,m);return Object.hasOwn(f,"index")&&(x.index=f.index),Object.hasOwn(f,"input")&&(x.input=f.input),x}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const x=new RegExp(f.source,f.flags);return x.lastIndex=f.lastIndex,x}if(f instanceof Map){const x=new Map;h.set(f,x);for(const[b,S]of f)x.set(b,o(S,b,p,h,m));return x}if(f instanceof Set){const x=new Set;h.set(f,x);for(const b of f)x.add(o(b,void 0,p,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(i.isTypedArray(f)){const x=new(Object.getPrototypeOf(f)).constructor(f.length);h.set(f,x);for(let b=0;b<f.length;b++)x[b]=o(f[b],b,p,h,m);return x}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const x=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return h.set(f,x),c(x,f,p,h,m),x}if(typeof File<"u"&&f instanceof File){const x=new File([f],f.name,{type:f.type});return h.set(f,x),c(x,f,p,h,m),x}if(typeof Blob<"u"&&f instanceof Blob){const x=new Blob([f],{type:f.type});return h.set(f,x),c(x,f,p,h,m),x}if(f instanceof Error){const x=new f.constructor;return h.set(f,x),x.message=f.message,x.name=f.name,x.stack=f.stack,x.cause=f.cause,c(x,f,p,h,m),x}if(f instanceof Boolean){const x=new Boolean(f.valueOf());return h.set(f,x),c(x,f,p,h,m),x}if(f instanceof Number){const x=new Number(f.valueOf());return h.set(f,x),c(x,f,p,h,m),x}if(f instanceof String){const x=new String(f.valueOf());return h.set(f,x),c(x,f,p,h,m),x}if(typeof f=="object"&&u(f)){const x=Object.create(Object.getPrototypeOf(f));return h.set(f,x),c(x,f,p,h,m),x}return f}function c(f,d,p=f,h,m){const g=[...Object.keys(d),...t.getSymbols(d)];for(let x=0;x<g.length;x++){const b=g[x],S=Object.getOwnPropertyDescriptor(f,b);(S==null||S.writable)&&(f[b]=o(d[b],b,p,h,m))}}function u(f){switch(r.getTag(f)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=c})(Sx)),Sx}var QS;function vq(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G6();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(wx)),wx}var e_;function yq(){return e_||(e_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H6(),r=vq();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(mx)),mx}var kx={},Ex={},Cx={},t_;function bq(){return t_||(t_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G6(),r=Oy(),n=q6();function a(i,s){return t.cloneDeepWith(i,(o,c,u,f)=>{const d=s==null?void 0:s(o,c,u,f);if(d!==void 0)return d;if(typeof i=="object"){if(r.getTag(i)===n.objectTag&&typeof i.constructor!="function"){const p={};return f.set(i,p),t.copyProperties(p,i,u,f),p}switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const p=new i.constructor(i==null?void 0:i.valueOf());return t.copyProperties(p,i),p}case n.argumentsTag:{const p={};return t.copyProperties(p,i),p.length=i.length,p[Symbol.iterator]=i[Symbol.iterator],p}default:return}}})}e.cloneDeepWith=a})(Cx)),Cx}var r_;function wq(){return r_||(r_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bq();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Ex)),Ex}var Tx={},Px={},n_;function V6(){return n_||(n_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Px)),Px}var Ox={},a_;function Sq(){return a_||(a_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oy();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(Ox)),Ox}var i_;function _q(){return i_||(i_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L6(),r=V6(),n=Sq(),a=ky();function i(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?c=a.toPath(o):c=[o],c.length===0)return!1;let u=s;for(let f=0;f<c.length;f++){const d=c[f];if((u==null||!Object.hasOwn(u,d))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(d)&&d<u.length))return!1;u=u[d]}return!0}e.has=i})(Tx)),Tx}var s_;function Nq(){return s_||(s_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H6(),r=jy(),n=wq(),a=Ey(),i=_q();function s(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const f=a.get(u,o);return f===void 0?i.has(u,o):c===void 0?f===void 0:t.isMatch(f,c)}}e.matchesProperty=s})(kx)),kx}var o_;function Aq(){return o_||(o_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U6(),r=pq(),n=yq(),a=Nq();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(hx)),hx}var l_;function jq(){return l_||(l_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cq(),r=uq(),n=U6(),a=hq(),i=Aq();function s(o,c=n.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),r.ary(i.iteratee(c),1)):[]}e.uniqBy=s})(ix)),ix}var Fx,c_;function kq(){return c_||(c_=1,Fx=jq().uniqBy),Fx}var Eq=kq();const u_=lo(Eq);function Y6(e,t,r){return t===!0?u_(e,r):typeof t=="function"?u_(e,t):e}var Ix={exports:{}},Lx={},Dx={exports:{}},Mx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f_;function Cq(){if(f_)return Mx;f_=1;var e=Hp();function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function o(d,p){var h=p(),m=n({inst:{value:h,getSnapshot:p}}),g=m[0].inst,x=m[1];return i(function(){g.value=h,g.getSnapshot=p,c(g)&&x({inst:g})},[d,h,p]),a(function(){return c(g)&&x({inst:g}),d(function(){c(g)&&x({inst:g})})},[d]),s(h),h}function c(d){var p=d.getSnapshot;d=d.value;try{var h=p();return!r(d,h)}catch{return!0}}function u(d,p){return p()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Mx.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:f,Mx}var d_;function Tq(){return d_||(d_=1,Dx.exports=Cq()),Dx.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_;function Pq(){if(h_)return Lx;h_=1;var e=Hp(),t=Tq();function r(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,o=e.useMemo,c=e.useDebugValue;return Lx.useSyncExternalStoreWithSelector=function(u,f,d,p,h){var m=i(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=o(function(){function b(F){if(!S){if(S=!0,_=F,F=p(F),h!==void 0&&g.hasValue){var M=g.value;if(h(M,F))return E=M}return E=F}if(M=E,n(_,F))return M;var C=p(F);return h!==void 0&&h(M,C)?(_=F,M):(_=F,E=C)}var S=!1,_,E,O=d===void 0?null:d;return[function(){return b(f())},O===null?void 0:function(){return b(O())}]},[f,d,p,h]);var x=a(u,m[0],m[1]);return s(function(){g.hasValue=!0,g.value=x},[x]),c(x),x},Lx}var p_;function Oq(){return p_||(p_=1,Ix.exports=Pq()),Ix.exports}var Fq=Oq(),Fy=y.createContext(null),Iq=e=>e,jr=()=>{var e=y.useContext(Fy);return e?e.store.dispatch:Iq},yh=()=>{},Lq=()=>yh,Dq=(e,t)=>e===t;function yt(e){var t=y.useContext(Fy);return Fq.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Lq,t?t.store.getState:yh,t?t.store.getState:yh,t?e:yh,Dq)}function Mq(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Rq(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Bq(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var m_=e=>Array.isArray(e)?e:[e];function Uq(e){const t=Array.isArray(e[0])?e[0]:e;return Bq(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function zq(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var $q=class{constructor(e){this.value=e}deref(){return this.value}},Wq=typeof WeakRef<"u"?WeakRef:$q,Hq=0,g_=1;function X0(){return{s:Hq,v:void 0,o:null,p:null}}function K6(e,t={}){let r=X0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var d;let o=r;const{length:c}=arguments;for(let p=0,h=c;p<h;p++){const m=arguments[p];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const x=g.get(m);x===void 0?(o=X0(),g.set(m,o)):o=x}else{let g=o.p;g===null&&(o.p=g=new Map);const x=g.get(m);x===void 0?(o=X0(),g.set(m,o)):o=x}}const u=o;let f;if(o.s===g_)f=o.v;else if(f=e.apply(null,arguments),i++,n){const p=((d=a==null?void 0:a.deref)==null?void 0:d.call(a))??a;p!=null&&n(p,f)&&(f=p,i!==0&&i--),a=typeof f=="object"&&f!==null||typeof f=="function"?new Wq(f):f}return u.s=g_,u.v=f,f}return s.clearCache=()=>{r=X0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function qq(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),Mq(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const f={...r,...c},{memoize:d,memoizeOptions:p=[],argsMemoize:h=K6,argsMemoizeOptions:m=[]}=f,g=m_(p),x=m_(m),b=Uq(a),S=d(function(){return i++,u.apply(null,arguments)},...g),_=h(function(){s++;const O=zq(b,arguments);return o=S.apply(null,O),o},...x);return Object.assign(_,{resultFunc:u,memoizedResultFunc:S,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Re=qq(K6),Gq=Object.assign((e,t=Re)=>{Rq(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>Gq}),Rx={},Bx={},Ux={},x_;function Vq(){return x_||(x_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),o=t(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};e.compareValues=r})(Ux)),Ux}var zx={},$x={},v_;function X6(){return v_||(v_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})($x)),$x}var y_;function Yq(){return y_||(y_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=X6(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(zx)),zx}var b_;function Kq(){return b_||(b_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vq(),r=Yq(),n=ky();function a(i,s,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(h=>String(h));const u=(h,m)=>{let g=h;for(let x=0;x<m.length&&g!=null;++x)g=g[m[x]];return g},f=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,d=s.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return i.map(h=>({original:h,criteria:d.map(m=>f(m,h))})).slice().sort((h,m)=>{for(let g=0;g<d.length;g++){const x=t.compareValues(h.criteria[g],m.criteria[g],o[g]);if(x!==0)return x}return 0}).map(h=>h.original)}e.orderBy=a})(Bx)),Bx}var Wx={},w_;function Xq(){return w_||(w_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(o,c)=>{for(let u=0;u<o.length;u++){const f=o[u];Array.isArray(f)&&c<i?s(f,c+1):a.push(f)}};return s(r,0),a}e.flatten=t})(Wx)),Wx}var Hx={},S_;function J6(){return S_||(S_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V6(),r=Py(),n=z6(),a=W6();function i(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?a.isEqualsSameValueZero(c[o],s):!1}e.isIterateeCall=i})(Hx)),Hx}var __;function Jq(){return __||(__=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kq(),r=Xq(),n=J6();function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(Rx)),Rx}var qx,N_;function Zq(){return N_||(N_=1,qx=Jq().sortBy),qx}var Qq=Zq();const am=lo(Qq);var Z6=e=>e.legend.settings,eG=e=>e.legend.size,tG=e=>e.legend.payload,rG=Re([tG,Z6],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?am(n,r):n});function nG(){return yt(rG)}var J0=1;function Q6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=y.useState({height:0,left:0,top:0,width:0}),n=y.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>J0||Math.abs(s.left-t.left)>J0||Math.abs(s.top-t.top)>J0||Math.abs(s.width-t.width)>J0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Kn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var aG=typeof Symbol=="function"&&Symbol.observable||"@@observable",A_=aG,Gx=()=>Math.random().toString(36).substring(7).split("").join("."),iG={INIT:`@@redux/INIT${Gx()}`,REPLACE:`@@redux/REPLACE${Gx()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Gx()}`},Zh=iG;function Iy(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function eE(e,t,r){if(typeof e!="function")throw new Error(Kn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Kn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Kn(1));return r(eE)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((x,b)=>{s.set(b,x)}))}function f(){if(c)throw new Error(Kn(3));return a}function d(x){if(typeof x!="function")throw new Error(Kn(4));if(c)throw new Error(Kn(5));let b=!0;u();const S=o++;return s.set(S,x),function(){if(b){if(c)throw new Error(Kn(6));b=!1,u(),s.delete(S),i=null}}}function p(x){if(!Iy(x))throw new Error(Kn(7));if(typeof x.type>"u")throw new Error(Kn(8));if(typeof x.type!="string")throw new Error(Kn(17));if(c)throw new Error(Kn(9));try{c=!0,a=n(a,x)}finally{c=!1}return(i=s).forEach(S=>{S()}),x}function h(x){if(typeof x!="function")throw new Error(Kn(10));n=x,p({type:Zh.REPLACE})}function m(){const x=d;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Kn(11));function S(){const E=b;E.next&&E.next(f())}return S(),{unsubscribe:x(S)}},[A_](){return this}}}return p({type:Zh.INIT}),{dispatch:p,subscribe:d,getState:f,replaceReducer:h,[A_]:m}}function sG(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Zh.INIT})>"u")throw new Error(Kn(12));if(typeof r(void 0,{type:Zh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Kn(13))})}function tE(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{sG(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const u={};for(let f=0;f<n.length;f++){const d=n[f],p=r[d],h=s[d],m=p(h,o);if(typeof m>"u")throw o&&o.type,new Error(Kn(14));u[d]=m,c=c||m!==h}return c=c||n.length!==Object.keys(s).length,c?u:s}}function Qh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function oG(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Kn(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(s));return i=Qh(...o)(a.dispatch),{...a,dispatch:i}}}function rE(e){return Iy(e)&&"type"in e&&typeof e.type=="string"}var nE=Symbol.for("immer-nothing"),j_=Symbol.for("immer-draftable"),Pa=Symbol.for("immer-state");function Vi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ai=Object,cu=ai.getPrototypeOf,ep="constructor",im="prototype",mv="configurable",tp="enumerable",bh="writable",ed="value",to=e=>!!e&&!!e[Pa];function rs(e){var t;return e?aE(e)||om(e)||!!e[j_]||!!((t=e[ep])!=null&&t[j_])||lm(e)||cm(e):!1}var lG=ai[im][ep].toString(),k_=new WeakMap;function aE(e){if(!e||!Ly(e))return!1;const t=cu(e);if(t===null||t===ai[im])return!0;const r=ai.hasOwnProperty.call(t,ep)&&t[ep];if(r===Object)return!0;if(!$c(r))return!1;let n=k_.get(r);return n===void 0&&(n=Function.toString.call(r),k_.set(r,n)),n===lG}function sm(e,t,r=!0){Ed(e)===0?(r?Reflect.ownKeys(e):ai.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Ed(e){const t=e[Pa];return t?t.type_:om(e)?1:lm(e)?2:cm(e)?3:0}var E_=(e,t,r=Ed(e))=>r===2?e.has(t):ai[im].hasOwnProperty.call(e,t),gv=(e,t,r=Ed(e))=>r===2?e.get(t):e[t],rp=(e,t,r,n=Ed(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function cG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var om=Array.isArray,lm=e=>e instanceof Map,cm=e=>e instanceof Set,Ly=e=>typeof e=="object",$c=e=>typeof e=="function",Vx=e=>typeof e=="boolean";function uG(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var zs=e=>e.copy_||e.base_,Dy=e=>e.modified_?e.copy_:e.base_;function xv(e,t){if(lm(e))return new Map(e);if(cm(e))return new Set(e);if(om(e))return Array[im].slice.call(e);const r=aE(e);if(t===!0||t==="class_only"&&!r){const n=ai.getOwnPropertyDescriptors(e);delete n[Pa];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o[bh]===!1&&(o[bh]=!0,o[mv]=!0),(o.get||o.set)&&(n[s]={[mv]:!0,[bh]:!0,[tp]:o[tp],[ed]:e[s]})}return ai.create(cu(e),n)}else{const n=cu(e);if(n!==null&&r)return{...e};const a=ai.create(n);return ai.assign(a,e)}}function My(e,t=!1){return um(e)||to(e)||!rs(e)||(Ed(e)>1&&ai.defineProperties(e,{set:Z0,add:Z0,clear:Z0,delete:Z0}),ai.freeze(e),t&&sm(e,(r,n)=>{My(n,!0)},!1)),e}function fG(){Vi(2)}var Z0={[ed]:fG};function um(e){return e===null||!Ly(e)?!0:ai.isFrozen(e)}var np="MapSet",vv="Patches",C_="ArrayMethods",iE={};function Vl(e){const t=iE[e];return t||Vi(0,e),t}var T_=e=>!!iE[e],td,sE=()=>td,dG=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:T_(np)?Vl(np):void 0,arrayMethodsPlugin_:T_(C_)?Vl(C_):void 0});function P_(e,t){t&&(e.patchPlugin_=Vl(vv),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function yv(e){bv(e),e.drafts_.forEach(hG),e.drafts_=null}function bv(e){e===td&&(td=e.parent_)}var O_=e=>td=dG(td,e);function hG(e){const t=e[Pa];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function F_(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[Pa].modified_&&(yv(t),Vi(4)),rs(e)&&(e=I_(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[Pa].base_,e,t)}else e=I_(t,r);return pG(t,e,!0),yv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==nE?e:void 0}function I_(e,t){if(um(t))return t;const r=t[Pa];if(!r)return ap(t,e.handledSet_,e);if(!fm(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);cE(r,e)}return r.copy_}function pG(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&My(t,r)}function oE(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var fm=(e,t)=>e.scope_===t,mG=[];function lE(e,t,r,n){const a=zs(e),i=e.type_;if(n!==void 0&&gv(a,n,i)===t){rp(a,n,r,i);return}if(!e.draftLocations_){const o=e.draftLocations_=new Map;sm(a,(c,u)=>{if(to(u)){const f=o.get(u)||[];f.push(c),o.set(u,f)}})}const s=e.draftLocations_.get(t)??mG;for(const o of s)rp(a,o,r,i)}function gG(e,t,r){e.callbacks_.push(function(a){var o;const i=t;if(!i||!fm(i,a))return;(o=a.mapSetPlugin_)==null||o.fixSetContents(i);const s=Dy(i);lE(e,i.draft_??i,s,r),cE(i,a)})}function cE(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=t;if(a){const i=a.getPath(e);i&&a.generatePatches_(e,i,t)}oE(e)}}function xG(e,t,r){const{scope_:n}=e;if(to(r)){const a=r[Pa];fm(a,n)&&a.callbacks_.push(function(){wh(e);const s=Dy(a);lE(e,r,s,t)})}else rs(r)&&e.callbacks_.push(function(){const i=zs(e);e.type_===3?i.has(r)&&ap(r,n.handledSet_,n):gv(i,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&ap(gv(e.copy_,t,e.type_),n.handledSet_,n)})}function ap(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||to(e)||t.has(e)||!rs(e)||um(e)||(t.add(e),sm(e,(n,a)=>{if(to(a)){const i=a[Pa];if(fm(i,r)){const s=Dy(i);rp(e,n,s,e.type_),oE(i)}}else rs(a)&&ap(a,t,r)})),e}function vG(e,t){const r=om(e),n={type_:r?1:0,scope_:t?t.scope_:sE(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=ip;r&&(a=[n],i=rd);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,[o,n]}var ip={get(e,t){if(t===Pa)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=zs(e);if(!E_(a,t,e.type_))return yG(e,a,t);const i=a[t];if(e.finalized_||!rs(i)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&uG(t))return i;if(i===Yx(e.base_,t)){wh(e);const s=e.type_===1?+t:t,o=Sv(e.scope_,i,e,s);return e.copy_[s]=o}return i},has(e,t){return t in zs(e)},ownKeys(e){return Reflect.ownKeys(zs(e))},set(e,t,r){const n=uE(zs(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Yx(zs(e),t),i=a==null?void 0:a[Pa];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(cG(r,a)&&(r!==void 0||E_(e.base_,t,e.type_)))return!0;wh(e),wv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),xG(e,t,r)),!0},deleteProperty(e,t){return wh(e),Yx(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),wv(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=zs(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[bh]:!0,[mv]:e.type_!==1||t!=="length",[tp]:n[tp],[ed]:r[t]}},defineProperty(){Vi(11)},getPrototypeOf(e){return cu(e.base_)},setPrototypeOf(){Vi(12)}},rd={};for(let e in ip){let t=ip[e];rd[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}rd.deleteProperty=function(e,t){return rd.set.call(this,e,t,void 0)};rd.set=function(e,t,r){return ip.set.call(this,e[0],t,r,e[0])};function Yx(e,t){const r=e[Pa];return(r?zs(r):e)[t]}function yG(e,t,r){var a;const n=uE(t,r);return n?ed in n?n[ed]:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function uE(e,t){if(!(t in e))return;let r=cu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=cu(r)}}function wv(e){e.modified_||(e.modified_=!0,e.parent_&&wv(e.parent_))}function wh(e){e.copy_||(e.assigned_=new Map,e.copy_=xv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var bG=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if($c(r)&&!$c(n)){const s=n;n=r;const o=this;return function(u=s,...f){return o.produce(u,d=>n.call(this,d,...f))}}$c(n)||Vi(6),a!==void 0&&!$c(a)&&Vi(7);let i;if(rs(r)){const s=O_(this),o=Sv(s,r,void 0);let c=!0;try{i=n(o),c=!1}finally{c?yv(s):bv(s)}return P_(s,a),F_(i,s)}else if(!r||!Ly(r)){if(i=n(r),i===void 0&&(i=r),i===nE&&(i=void 0),this.autoFreeze_&&My(i,!0),a){const s=[],o=[];Vl(vv).generateReplacementPatches_(r,i,{patches_:s,inversePatches_:o}),a(s,o)}return i}else Vi(1,r)},this.produceWithPatches=(r,n)=>{if($c(r))return(o,...c)=>this.produceWithPatches(o,u=>r(u,...c));let a,i;return[this.produce(r,n,(o,c)=>{a=o,i=c}),a,i]},Vx(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Vx(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Vx(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){rs(t)||Vi(8),to(t)&&(t=es(t));const r=O_(this),n=Sv(r,t,void 0);return n[Pa].isManual_=!0,bv(r),n}finishDraft(t,r){const n=t&&t[Pa];(!n||!n.isManual_)&&Vi(9);const{scope_:a}=n;return P_(a,r),F_(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const i=r[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(r=r.slice(n+1));const a=Vl(vv).applyPatches_;return to(t)?a(t,r):this.produce(t,i=>a(i,r))}};function Sv(e,t,r,n){const[a,i]=lm(t)?Vl(np).proxyMap_(t,r):cm(t)?Vl(np).proxySet_(t,r):vG(t,r);return((r==null?void 0:r.scope_)??sE()).drafts_.push(a),i.callbacks_=(r==null?void 0:r.callbacks_)??[],i.key_=n,r&&n!==void 0?gG(r,i,n):i.callbacks_.push(function(c){var f;(f=c.mapSetPlugin_)==null||f.fixSetContents(i);const{patchPlugin_:u}=c;i.modified_&&u&&u.generatePatches_(i,[],c)}),a}function es(e){return to(e)||Vi(10,e),fE(e)}function fE(e){if(!rs(e)||um(e))return e;const t=e[Pa];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=xv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=xv(e,!0);return sm(r,(a,i)=>{rp(r,a,fE(i))},n),t&&(t.finalized_=!1),r}var wG=new bG,dE=wG.produce;function hE(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var SG=hE(),_G=hE,NG=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qh:Qh.apply(null,arguments)};function Pi(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(si(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>rE(n)&&n.type===e,r}var pE=class Af extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Af.prototype)}static get[Symbol.species](){return Af}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Af(...t[0].concat(this)):new Af(...t.concat(this))}};function L_(e){return rs(e)?dE(e,()=>{}):e}function Q0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function AG(e){return typeof e=="boolean"}var jG=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new pE;return r&&(AG(r)?s.push(SG):s.push(_G(r.extraArgument))),s},mE="RTK_autoBatch",Fr=()=>e=>({payload:e,meta:{[mE]:!0}}),D_=e=>t=>{setTimeout(t,e)},gE=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:D_(10):e.type==="callback"?e.queueNotification:D_(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const d=()=>a&&f(),p=n.subscribe(d);return o.add(f),()=>{p(),o.delete(f)}},dispatch(f){var d;try{return a=!((d=f==null?void 0:f.meta)!=null&&d[mE]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(f)}finally{a=!0}}})},kG=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new pE(e);return n&&a.push(gE(typeof n=="object"?n:void 0)),a};function EG(e){const t=jG(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(Iy(r))o=tE(r);else throw new Error(si(1));let c;typeof n=="function"?c=n(t):c=t();let u=Qh;a&&(u=NG({trace:!1,...typeof a=="object"&&a}));const f=oG(...c),d=kG(f);let p=typeof s=="function"?s(d):d();const h=u(...p);return eE(o,i,h)}function xE(e){const t={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(si(28));if(o in t)throw new Error(si(29));return t[o]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function CG(e){return typeof e=="function"}function TG(e,t){let[r,n,a]=xE(t),i;if(CG(e))i=()=>L_(e());else{const o=L_(e);i=()=>o}function s(o=i(),c){let u=[r[c.type],...n.filter(({matcher:f})=>f(c)).map(({reducer:f})=>f)];return u.filter(f=>!!f).length===0&&(u=[a]),u.reduce((f,d)=>{if(d)if(to(f)){const h=d(f,c);return h===void 0?f:h}else{if(rs(f))return dE(f,p=>d(p,c));{const p=d(f,c);if(p===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return f},o)}return s.getInitialState=i,s}var PG="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",OG=(e=21)=>{let t="",r=e;for(;r--;)t+=PG[Math.random()*64|0];return t},FG=Symbol.for("rtk-slice-createasyncthunk");function IG(e,t){return`${e}/${t}`}function LG({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[FG];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(si(11));const o=(typeof a.reducers=="function"?a.reducers(MG()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(E,O){const F=typeof E=="string"?E:E.type;if(!F)throw new Error(si(12));if(F in u.sliceCaseReducersByType)throw new Error(si(13));return u.sliceCaseReducersByType[F]=O,f},addMatcher(E,O){return u.sliceMatchers.push({matcher:E,reducer:O}),f},exposeAction(E,O){return u.actionCreators[E]=O,f},exposeCaseReducer(E,O){return u.sliceCaseReducersByName[E]=O,f}};c.forEach(E=>{const O=o[E],F={reducerName:E,type:IG(i,E),createNotation:typeof a.reducers=="function"};BG(O)?zG(F,O,f,t):RG(F,O,f)});function d(){const[E={},O=[],F=void 0]=typeof a.extraReducers=="function"?xE(a.extraReducers):[a.extraReducers],M={...E,...u.sliceCaseReducersByType};return TG(a.initialState,C=>{for(let k in M)C.addCase(k,M[k]);for(let k of u.sliceMatchers)C.addMatcher(k.matcher,k.reducer);for(let k of O)C.addMatcher(k.matcher,k.reducer);F&&C.addDefaultCase(F)})}const p=E=>E,h=new Map,m=new WeakMap;let g;function x(E,O){return g||(g=d()),g(E,O)}function b(){return g||(g=d()),g.getInitialState()}function S(E,O=!1){function F(C){let k=C[E];return typeof k>"u"&&O&&(k=Q0(m,F,b)),k}function M(C=p){const k=Q0(h,O,()=>new WeakMap);return Q0(k,C,()=>{const W={};for(const[D,j]of Object.entries(a.selectors??{}))W[D]=DG(j,C,()=>Q0(m,C,b),O);return W})}return{reducerPath:E,getSelectors:M,get selectors(){return M(F)},selectSlice:F}}const _={name:i,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...S(s),injectInto(E,{reducerPath:O,...F}={}){const M=O??s;return E.inject({reducerPath:M,reducer:x},F),{..._,...S(M,!0)}}};return _}}function DG(e,t,r,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return a.unwrapped=e,a}var Wa=LG();function MG(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function RG({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!UG(n))throw new Error(si(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Pi(e,s):Pi(e))}function BG(e){return e._reducerDefinitionType==="asyncThunk"}function UG(e){return e._reducerDefinitionType==="reducerWithPrepare"}function zG({type:e,reducerName:t},r,n,a){if(!a)throw new Error(si(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:f}=r,d=a(e,i,f);n.exposeAction(t,d),s&&n.addCase(d.fulfilled,s),o&&n.addCase(d.pending,o),c&&n.addCase(d.rejected,c),u&&n.addMatcher(d.settled,u),n.exposeCaseReducer(t,{fulfilled:s||eh,pending:o||eh,rejected:c||eh,settled:u||eh})}function eh(){}var $G="task",vE="listener",yE="completed",Ry="cancelled",WG=`task-${Ry}`,HG=`task-${yE}`,_v=`${vE}-${Ry}`,qG=`${vE}-${yE}`,dm=class{constructor(e){Ig(this,"name","TaskAbortError");Ig(this,"message");this.code=e,this.message=`${$G} ${Ry} (reason: ${e})`}},By=(e,t)=>{if(typeof e!="function")throw new TypeError(si(32))},sp=()=>{},bE=(e,t=sp)=>(e.catch(t),e),wE=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Il=e=>{if(e.aborted)throw new dm(e.reason)};function SE(e,t){let r=sp;return new Promise((n,a)=>{const i=()=>a(new dm(e.reason));if(e.aborted){i();return}r=wE(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=sp})}var GG=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof dm?"cancelled":"rejected",error:r}}finally{t==null||t()}},op=e=>t=>bE(SE(e,t).then(r=>(Il(e),r))),_E=e=>{const t=op(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Qc}=Object,M_={},hm="listenerMiddleware",VG=(e,t)=>{const r=n=>wE(e,()=>n.abort(e.reason));return(n,a)=>{By(n);const i=new AbortController;r(i);const s=GG(async()=>{Il(e),Il(i.signal);const o=await n({pause:op(i.signal),delay:_E(i.signal),signal:i.signal});return Il(i.signal),o},()=>i.abort(HG));return a!=null&&a.autoJoin&&t.push(s.catch(sp)),{result:op(e)(s),cancel(){i.abort(WG)}}}},YG=(e,t)=>{const r=async(n,a)=>{Il(t);let i=()=>{};const o=[new Promise((c,u)=>{let f=e({predicate:n,effect:(d,p)=>{p.unsubscribe(),c([d,p.getState(),p.getOriginalState()])}});i=()=>{f(),u()}})];a!=null&&o.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await SE(t,Promise.race(o));return Il(t),c}finally{i()}};return(n,a)=>bE(r(n,a))},NE=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Pi(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(si(21));return By(i),{predicate:a,type:t,effect:i}},AE=Qc(e=>{const{type:t,predicate:r,effect:n}=NE(e);return{id:OG(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(si(22))}}},{withTypes:()=>AE}),R_=(e,t)=>{const{type:r,effect:n,predicate:a}=NE(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},Nv=e=>{e.pending.forEach(t=>{t.abort(_v)})},KG=(e,t)=>()=>{for(const r of t.keys())Nv(r);e.clear()},B_=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},jE=Qc(Pi(`${hm}/add`),{withTypes:()=>jE}),XG=Pi(`${hm}/removeAll`),kE=Qc(Pi(`${hm}/remove`),{withTypes:()=>kE}),JG=(...e)=>{console.error(`${hm}/error`,...e)},Cd=(e={})=>{const t=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:i,onError:s=JG}=e;By(s);const o=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&Nv(h)}),c=h=>{const m=R_(t,h)??AE(h);return o(m)};Qc(c,{withTypes:()=>c});const u=h=>{const m=R_(t,h);return m&&(m.unsubscribe(),h.cancelActive&&Nv(m)),!!m};Qc(u,{withTypes:()=>u});const f=async(h,m,g,x)=>{const b=new AbortController,S=YG(c,b.signal),_=[];try{h.pending.add(b),n(h),await Promise.resolve(h.effect(m,Qc({},g,{getOriginalState:x,condition:(E,O)=>S(E,O).then(Boolean),take:S,delay:_E(b.signal),pause:op(b.signal),extra:i,signal:b.signal,fork:VG(b.signal,_),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((E,O,F)=>{E!==b&&(E.abort(_v),F.delete(E))})},cancel:()=>{b.abort(_v),h.pending.delete(b)},throwIfCancelled:()=>{Il(b.signal)}})))}catch(E){E instanceof dm||B_(s,E,{raisedBy:"effect"})}finally{await Promise.all(_),b.abort(qG),a(h),h.pending.delete(b)}},d=KG(t,r);return{middleware:h=>m=>g=>{if(!rE(g))return m(g);if(jE.match(g))return c(g.payload);if(XG.match(g)){d();return}if(kE.match(g))return u(g.payload);let x=h.getState();const b=()=>{if(x===M_)throw new Error(si(23));return x};let S;try{if(S=m(g),t.size>0){const _=h.getState(),E=Array.from(t.values());for(const O of E){let F=!1;try{F=O.predicate(g,_,x)}catch(M){F=!1,B_(s,M,{raisedBy:"predicate"})}F&&f(O,g,h,b)}}}finally{x=M_}return S},startListening:c,stopListening:u,clearListeners:d}};function si(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ZG={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},EE=Wa({name:"chartLayout",initialState:ZG,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:QG,setLayout:eV,setChartSize:tV,setScale:rV}=EE.actions,nV=EE.reducer;function CE(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function zr(e){return Number.isFinite(e)}function As(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function U_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U_(Object(r),!0).forEach(function(n){aV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aV(e,t,r){return(t=iV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iV(e){var t=sV(e,"string");return typeof t=="symbol"?t:t+""}function sV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yr(e,t,r){return Dr(e)||Dr(t)?r:Ns(t)?Gl(e,t,r):typeof t=="function"?t(e):r}var oV=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&gt(e[i]))return Gc(Gc({},e),{},{[i]:e[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&gt(e[s]))return Gc(Gc({},e),{},{[s]:e[s]+(a||0)})}return e},il=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",TE=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var a,i,s=e.map(o=>(o.coordinate===t&&(a=!0),o.coordinate===r&&(i=!0),o.coordinate));return a||s.push(t),i||s.push(r),s},PE=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:f,ticks:d,niceTicks:p,axisType:h}=e;if(!s)return null;var m=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=a==="category"&&s.bandwidth?s.bandwidth()/m:0;if(g=h==="angleAxis"&&i&&i.length>=2?Wn(i[0]-i[1])*2*g:g,d||p){var x=(d||p||[]).map((b,S)=>{var _=n?n.indexOf(b):b;return{coordinate:s(_)+g,value:b,offset:g,index:S}});return x.filter(b=>!ts(b.coordinate))}return c&&u?u.map((b,S)=>({coordinate:s(b)+g,value:b,index:S,offset:g})):s.ticks&&f!=null?s.ticks(f).map((b,S)=>({coordinate:s(b)+g,value:b,offset:g,index:S})):s.domain().map((b,S)=>({coordinate:s(b)+g,value:n?n[b]:b,index:S,offset:g}))},z_=1e-4,lV=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-z_,i=Math.max(n[0],n[1])+z_,s=e(t[0]),o=e(t[r-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[r-1]])}},cV=(e,t)=>{if(!t||t.length!==2||!gt(t[0])||!gt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!gt(e[0])||e[0]<r)&&(a[0]=r),(!gt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},uV=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0,o=0;o<r;++o){var c=e[o],u=c==null?void 0:c[a];if(u!=null){var f=u[1],d=u[0],p=ts(f)?d:f;p>=0?(u[0]=i,u[1]=i+p,i=f):(u[0]=s,u[1]=s+p,s=f)}}}},fV=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0;s<r;++s){var o=e[s],c=o==null?void 0:o[a];if(c!=null){var u=ts(c[1])?c[0]:c[1];u>=0?(c[0]=i,c[1]=i+u,i=c[1]):(c[0]=0,c[1]=0)}}}},dV={sign:uV,expand:TH,none:ql,silhouette:PH,wiggle:OH,positive:fV},hV=(e,t,r)=>{var n,a=(n=dV[r])!==null&&n!==void 0?n:ql,i=CH().keys(t).value((o,c)=>Number(yr(o,c,0))).order(hv).offset(a),s=i(e);return s.forEach((o,c)=>{o.forEach((u,f)=>{var d=yr(e[f],t[c],0);Array.isArray(d)&&d.length===2&&gt(d[0])&&gt(d[1])&&(u[0]=d[0],u[1]=d[1])})}),s};function pV(e){return e==null?void 0:String(e)}function $_(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Dr(a[t.dataKey])){var o=M6(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=yr(a,Dr(s)?t.dataKey:s);return Dr(c)?null:t.scale(c)}var W_=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var o=yr(i,t.dataKey,t.scale.domain()[s]);return Dr(o)?null:t.scale(o)-a/2+n},mV=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},gV=e=>{var t=e.flat(2).filter(gt);return[Math.min(...t),Math.max(...t)]},xV=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],vV=(e,t,r)=>{if(e!=null)return xV(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:s}=i,o=s.reduce((c,u)=>{var f=CE(u,t,r),d=gV(f);return!zr(d[0])||!zr(d[1])?c:[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},H_=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,q_=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,uu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=am(t,f=>f.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var c=a[s],u=a[s-1];i=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),i)}return i===1/0?0:i}return r?void 0:0};function G_(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Gc(Gc({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Su(e,t){if(e)return String(e);if(typeof t=="string")return t}var yV=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},bV=(e,t)=>t==="centric"?e.angle:e.radius,ho=e=>e.layout.width,po=e=>e.layout.height,wV=e=>e.layout.scale,OE=e=>e.layout.margin,pm=Re(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),mm=Re(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),FE="data-recharts-item-index",IE="data-recharts-item-id",Td=60;function V_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function th(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V_(Object(r),!0).forEach(function(n){SV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SV(e,t,r){return(t=_V(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _V(e){var t=NV(e,"string");return typeof t=="symbol"?t:t+""}function NV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AV=e=>e.brush.height;function jV(e){var t=mm(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Td;return r+a}return r},0)}function kV(e){var t=mm(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Td;return r+a}return r},0)}function EV(e){var t=pm(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function CV(e){var t=pm(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Cn=Re([ho,po,OE,AV,jV,kV,EV,CV,Z6,eG],(e,t,r,n,a,i,s,o,c,u)=>{var f={left:(r.left||0)+a,right:(r.right||0)+i},d={top:(r.top||0)+s,bottom:(r.bottom||0)+o},p=th(th({},d),f),h=p.bottom;p.bottom+=n,p=oV(p,c,u);var m=e-p.left-p.right,g=t-p.top-p.bottom;return th(th({brushBottom:h},p),{},{width:Math.max(m,0),height:Math.max(g,0)})}),TV=Re(Cn,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Uy=Re(ho,po,(e,t)=>({x:0,y:0,width:e,height:t})),PV=y.createContext(null),ya=()=>y.useContext(PV)!=null,gm=e=>e.brush,xm=Re([gm,Cn,OE],(e,t,r)=>({height:e.height,x:gt(e.x)?e.x:t.left,y:gt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:gt(e.width)?e.width:t.width})),Kx={},Xx={},Jx={},Y_;function OV(){return Y_||(Y_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),f=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},d=()=>{u&&f(),g()};let p=null;const h=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,d()},n)},m=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{m(),s=void 0,o=null},x=()=>{f()},b=function(...S){if(a!=null&&a.aborted)return;s=this,o=S;const _=p==null;h(),c&&_&&f()};return b.schedule=h,b.cancel=g,b.flush=x,a==null||a.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Jx)),Jx}var K_;function FV(){return K_||(K_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OV();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);s&&(u[0]="leading"),o&&(u[1]="trailing");let f,d=null;const p=t.debounce(function(...g){f=n.apply(this,g),d=null},a,{edges:u}),h=function(...g){return c!=null&&(d===null&&(d=Date.now()),Date.now()-d>=c)?(f=n.apply(this,g),d=Date.now(),p.cancel(),p.schedule(),f):(p.apply(this,g),f)},m=()=>(p.flush(),f);return h.cancel=p.cancel,h.flush=m,h}e.debounce=r})(Xx)),Xx}var X_;function IV(){return X_||(X_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FV();function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:o})}e.throttle=r})(Kx)),Kx}var Zx,J_;function LV(){return J_||(J_=1,Zx=IV().throttle),Zx}var DV=LV();const MV=lo(DV);var lp=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;console.warn(r.replace(/%s/g,()=>a[s++]))}},LE=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,o=eo(n)?e:Number(n),c=eo(a)?t:Number(a);return i&&i>0&&(o?c=o/i:c&&(o=c*i),s&&c!=null&&c>s&&(c=s)),{calculatedWidth:o,calculatedHeight:c}},RV={width:0,height:0,overflow:"visible"},BV={width:0,overflowX:"visible"},UV={height:0,overflowY:"visible"},zV={},$V=e=>{var{width:t,height:r}=e,n=eo(t),a=eo(r);return n&&a?RV:n?BV:a?UV:zV};function WV(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(null,arguments)}function Z_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z_(Object(r),!0).forEach(function(n){HV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HV(e,t,r){return(t=qV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qV(e){var t=GV(e,"string");return typeof t=="symbol"?t:t+""}function GV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DE=y.createContext({width:-1,height:-1});function VV(e){return As(e.width)&&As(e.height)}function ME(e){var{children:t,width:r,height:n}=e,a=y.useMemo(()=>({width:r,height:n}),[r,n]);return VV(a)?y.createElement(DE.Provider,{value:a},t):null}var zy=()=>y.useContext(DE),YV=y.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:o,maxHeight:c,children:u,debounce:f=0,id:d,className:p,onResize:h,style:m={}}=e,g=y.useRef(null),x=y.useRef();x.current=h,y.useImperativeHandle(t,()=>g.current);var[b,S]=y.useState({containerWidth:n.width,containerHeight:n.height}),_=y.useCallback((C,k)=>{S(W=>{var D=Math.round(C),j=Math.round(k);return W.containerWidth===D&&W.containerHeight===j?W:{containerWidth:D,containerHeight:j}})},[]);y.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return jd;var C=j=>{var H,{width:U,height:Y}=j[0].contentRect;_(U,Y),(H=x.current)===null||H===void 0||H.call(x,U,Y)};f>0&&(C=MV(C,f,{trailing:!0,leading:!1}));var k=new ResizeObserver(C),{width:W,height:D}=g.current.getBoundingClientRect();return _(W,D),k.observe(g.current),()=>{k.disconnect()}},[_,f]);var{containerWidth:E,containerHeight:O}=b;lp(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:F,calculatedHeight:M}=LE(E,O,{width:a,height:i,aspect:r,maxHeight:c});return lp(F!=null&&F>0||M!=null&&M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,M,a,i,s,o,r),y.createElement("div",{id:d?"".concat(d):void 0,className:rr("recharts-responsive-container",p),style:Q_(Q_({},m),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:c}),ref:g},y.createElement("div",{style:$V({width:a,height:i})},y.createElement(ME,{width:F,height:M},u)))}),rh=y.forwardRef((e,t)=>{var r=zy();if(As(r.width)&&As(r.height))return e.children;var{width:n,height:a}=WV({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=LE(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return gt(i)&&gt(s)?y.createElement(ME,{width:i,height:s},e.children):y.createElement(YV,Av({},e,{width:n,height:a,ref:t}))});function RE(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var vm=()=>{var e,t=ya(),r=yt(TV),n=yt(xm),a=(e=yt(gm))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},KV={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},BE=()=>{var e;return(e=yt(Cn))!==null&&e!==void 0?e:KV},$y=()=>yt(ho),Wy=()=>yt(po),XV=()=>yt(e=>e.layout.margin),Jt=e=>e.layout.layoutType,_u=()=>yt(Jt),JV=()=>{var e=_u();return e!==void 0},ym=e=>{var t=jr(),r=ya(),{width:n,height:a}=e,i=zy(),s=n,o=a;return i&&(s=i.width>0?i.width:n,o=i.height>0?i.height:a),y.useEffect(()=>{!r&&As(s)&&As(o)&&t(tV({width:s,height:o}))},[t,r,s,o]),null},UE=Symbol.for("immer-nothing"),e4=Symbol.for("immer-draftable"),ci=Symbol.for("immer-state");function Yi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var nd=Object.getPrototypeOf;function fu(e){return!!e&&!!e[ci]}function Yl(e){var t;return e?zE(e)||Array.isArray(e)||!!e[e4]||!!((t=e.constructor)!=null&&t[e4])||Pd(e)||wm(e):!1}var ZV=Object.prototype.constructor.toString(),t4=new WeakMap;function zE(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=t4.get(r);return n===void 0&&(n=Function.toString.call(r),t4.set(r,n)),n===ZV}function cp(e,t,r=!0){bm(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function bm(e){const t=e[ci];return t?t.type_:Array.isArray(e)?1:Pd(e)?2:wm(e)?3:0}function jv(e,t){return bm(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $E(e,t,r){const n=bm(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function QV(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Pd(e){return e instanceof Map}function wm(e){return e instanceof Set}function yl(e){return e.copy_||e.base_}function kv(e,t){if(Pd(e))return new Map(e);if(wm(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=zE(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ci];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(nd(e),n)}else{const n=nd(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Hy(e,t=!1){return Sm(e)||fu(e)||!Yl(e)||(bm(e)>1&&Object.defineProperties(e,{set:nh,add:nh,clear:nh,delete:nh}),Object.freeze(e),t&&Object.values(e).forEach(r=>Hy(r,!0))),e}function eY(){Yi(2)}var nh={value:eY};function Sm(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var tY={};function Kl(e){const t=tY[e];return t||Yi(0,e),t}var ad;function WE(){return ad}function rY(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function r4(e,t){t&&(Kl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Ev(e){Cv(e),e.drafts_.forEach(nY),e.drafts_=null}function Cv(e){e===ad&&(ad=e.parent_)}function n4(e){return ad=rY(ad,e)}function nY(e){const t=e[ci];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function a4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ci].modified_&&(Ev(t),Yi(4)),Yl(e)&&(e=up(t,e),t.parent_||fp(t,e)),t.patches_&&Kl("Patches").generateReplacementPatches_(r[ci].base_,e,t.patches_,t.inversePatches_)):e=up(t,r,[]),Ev(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==UE?e:void 0}function up(e,t,r){if(Sm(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[ci];if(!a)return cp(t,(i,s)=>i4(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return fp(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,o=!1;a.type_===3&&(s=new Set(i),i.clear(),o=!0),cp(s,(c,u)=>i4(e,a,i,c,u,r,o),n),fp(e,i,!1),r&&e.patches_&&Kl("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function i4(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const o=Sm(a);if(!(o&&!s)){if(fu(a)){const c=i&&t&&t.type_!==3&&!jv(t.assigned_,n)?i.concat(n):void 0,u=up(e,a,c);if($E(r,n,u),fu(u))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Yl(a)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&o)return;up(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Pd(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&fp(e,a)}}}function fp(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Hy(t,r)}function aY(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:WE(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=qy;r&&(a=[n],i=id);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var qy={get(e,t){if(t===ci)return e;const r=yl(e);if(!jv(r,t))return iY(e,r,t);const n=r[t];return e.finalized_||!Yl(n)?n:n===Qx(e.base_,t)?(e1(e),e.copy_[t]=Pv(n,e)):n},has(e,t){return t in yl(e)},ownKeys(e){return Reflect.ownKeys(yl(e))},set(e,t,r){const n=HE(yl(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Qx(yl(e),t),i=a==null?void 0:a[ci];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(QV(r,a)&&(r!==void 0||jv(e.base_,t)))return!0;e1(e),Tv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Qx(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,e1(e),Tv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=yl(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Yi(11)},getPrototypeOf(e){return nd(e.base_)},setPrototypeOf(){Yi(12)}},id={};cp(qy,(e,t)=>{id[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});id.deleteProperty=function(e,t){return id.set.call(this,e,t,void 0)};id.set=function(e,t,r){return qy.set.call(this,e[0],t,r,e[0])};function Qx(e,t){const r=e[ci];return(r?yl(r):e)[t]}function iY(e,t,r){var a;const n=HE(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function HE(e,t){if(!(t in e))return;let r=nd(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=nd(r)}}function Tv(e){e.modified_||(e.modified_=!0,e.parent_&&Tv(e.parent_))}function e1(e){e.copy_||(e.copy_=kv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var sY=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,f=>r.call(this,f,...u))}}typeof r!="function"&&Yi(6),n!==void 0&&typeof n!="function"&&Yi(7);let a;if(Yl(t)){const i=n4(this),s=Pv(t,void 0);let o=!0;try{a=r(s),o=!1}finally{o?Ev(i):Cv(i)}return r4(i,n),a4(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===UE&&(a=void 0),this.autoFreeze_&&Hy(a,!0),n){const i=[],s=[];Kl("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Yi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,c=>t(c,...o));let n,a;return[this.produce(t,r,(s,o)=>{n=s,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Yl(e)||Yi(8),fu(e)&&(e=oY(e));const t=n4(this),r=Pv(e,void 0);return r[ci].isManual_=!0,Cv(t),r}finishDraft(e,t){const r=e&&e[ci];(!r||!r.isManual_)&&Yi(9);const{scope_:n}=r;return r4(n,t),a4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Kl("Patches").applyPatches_;return fu(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Pv(e,t){const r=Pd(e)?Kl("MapSet").proxyMap_(e,t):wm(e)?Kl("MapSet").proxySet_(e,t):aY(e,t);return(t?t.scope_:WE()).drafts_.push(r),r}function oY(e){return fu(e)||Yi(10,e),qE(e)}function qE(e){if(!Yl(e)||Sm(e))return e;const t=e[ci];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=kv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=kv(e,!0);return cp(r,(a,i)=>{$E(r,a,qE(i))},n),t&&(t.finalized_=!1),r}var lY=new sY;lY.produce;var cY={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},GE=Wa({name:"legend",initialState:cY,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Fr()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=es(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:Fr()},removeLegendPayload:{reducer(e,t){var r=es(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Fr()}}}),{setLegendSize:s4,setLegendSettings:uY,addLegendPayload:VE,replaceLegendPayload:YE,removeLegendPayload:KE}=GE.actions,fY=GE.reducer,dY=["contextPayload"];function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ov.apply(null,arguments)}function o4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function du(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o4(Object(r),!0).forEach(function(n){hY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hY(e,t,r){return(t=pY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pY(e){var t=mY(e,"string");return typeof t=="symbol"?t:t+""}function mY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gY(e,t){if(e==null)return{};var r,n,a=xY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vY(e){return e.value}function yY(e){var{contextPayload:t}=e,r=gY(e,dY),n=Y6(t,e.payloadUniqBy,vY),a=du(du({},r),{},{payload:n});return y.isValidElement(e.content)?y.cloneElement(e.content,a):typeof e.content=="function"?y.createElement(e.content,a):y.createElement(lq,a)}function bY(e,t,r,n,a,i){var{layout:s,align:o,verticalAlign:c}=t,u,f;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&s==="vertical"?u={left:((n||0)-i.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?f={top:((a||0)-i.height)/2}:f=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),du(du({},u),f)}function wY(e){var t=jr();return y.useEffect(()=>{t(uY(e))},[t,e]),null}function SY(e){var t=jr();return y.useEffect(()=>(t(s4(e)),()=>{t(s4({width:0,height:0}))}),[t,e]),null}function _Y(e,t,r,n){return e==="vertical"&&gt(t)?{height:t}:e==="horizontal"?{width:r||n}:null}var NY={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function Fv(e){var t=_n(e,NY),r=nG(),n=QW(),a=XV(),{width:i,height:s,wrapperStyle:o,portal:c}=t,[u,f]=Q6([r]),d=$y(),p=Wy();if(d==null||p==null)return null;var h=d-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=_Y(t.layout,s,i,h),g=c?o:du(du({position:"absolute",width:(m==null?void 0:m.width)||i||"auto",height:(m==null?void 0:m.height)||s||"auto"},bY(o,t,a,d,p,u)),o),x=c??n;if(x==null||r==null)return null;var b=y.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:f},y.createElement(wY,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&y.createElement(SY,{width:u.width,height:u.height}),y.createElement(yY,Ov({},t,m,{margin:a,chartWidth:d,chartHeight:p,contextPayload:r})));return P2.createPortal(b,x)}Fv.displayName="Legend";function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(null,arguments)}function l4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l4(Object(r),!0).forEach(function(n){AY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AY(e,t,r){return(t=jY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jY(e){var t=kY(e,"string");return typeof t=="symbol"?t:t+""}function kY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EY(e){return Array.isArray(e)&&Ns(e[0])&&Ns(e[1])?e.join(" ~ "):e}var CY=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:u,label:f,labelFormatter:d,accessibilityLayer:p=!1}=e,h=()=>{if(i&&i.length){var O={padding:0,margin:0},F=(o?am(i,o):i).map((M,C)=>{if(M.type==="none")return null;var k=M.formatter||s||EY,{value:W,name:D}=M,j=W,H=D;if(k){var U=k(W,D,M,C,i);if(Array.isArray(U))[j,H]=U;else if(U!=null)j=U;else return null}var Y=t1({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},n);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(C),style:Y},Ns(H)?y.createElement("span",{className:"recharts-tooltip-item-name"},H):null,Ns(H)?y.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,y.createElement("span",{className:"recharts-tooltip-item-value"},j),y.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:O},F)}return null},m=t1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=t1({margin:0},a),x=!Dr(f),b=x?f:"",S=rr("recharts-default-tooltip",c),_=rr("recharts-tooltip-label",u);x&&d&&i!==void 0&&i!==null&&(b=d(f,i));var E=p?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",Iv({className:S,style:m},E),y.createElement("p",{className:_,style:g},y.isValidElement(b)?b:"".concat(b)),h())},ff="recharts-tooltip-wrapper",TY={visibility:"hidden"};function PY(e){var{coordinate:t,translateX:r,translateY:n}=e;return rr(ff,{["".concat(ff,"-right")]:gt(r)&&t&&gt(t.x)&&r>=t.x,["".concat(ff,"-left")]:gt(r)&&t&&gt(t.x)&&r<t.x,["".concat(ff,"-bottom")]:gt(n)&&t&&gt(t.y)&&n>=t.y,["".concat(ff,"-top")]:gt(n)&&t&&gt(t.y)&&n<t.y})}function c4(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&gt(i[n]))return i[n];var f=r[n]-o-(a>0?a:0),d=r[n]+a;if(t[n])return s[n]?f:d;var p=c[n];if(p==null)return 0;if(s[n]){var h=f,m=p;return h<m?Math.max(d,p):Math.max(f,p)}if(u==null)return 0;var g=d+o,x=p+u;return g>x?Math.max(f,p):Math.max(d,p)}function OY(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function FY(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:c}=e,u,f,d;return s.height>0&&s.width>0&&r?(f=c4({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),d=c4({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=OY({translateX:f,translateY:d,useTranslate3d:o})):u=TY,{cssProperties:u,cssClasses:PY({translateX:f,translateY:d,coordinate:r})}}function u4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u4(Object(r),!0).forEach(function(n){Lv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lv(e,t,r){return(t=IY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IY(e){var t=LY(e,"string");return typeof t=="symbol"?t:t+""}function LY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class DY extends y.PureComponent{constructor(){super(...arguments),Lv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Lv(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:c,offset:u,position:f,reverseDirection:d,useTranslate3d:p,viewBox:h,wrapperStyle:m,lastBoundingBox:g,innerRef:x,hasPortalFromProps:b}=this.props,{cssClasses:S,cssProperties:_}=FY({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:u,position:f,reverseDirection:d,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:h}),E=b?{}:ah(ah({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),O=ah(ah({},E),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},m);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:O,ref:x},i)}}var XE=()=>{var e;return(e=yt(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(null,arguments)}function f4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f4(Object(r),!0).forEach(function(n){MY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MY(e,t,r){return(t=RY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RY(e){var t=BY(e,"string");return typeof t=="symbol"?t:t+""}function BY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h4={curveBasisClosed:vH,curveBasisOpen:yH,curveBasis:xH,curveBumpX:nH,curveBumpY:aH,curveLinearClosed:bH,curveLinear:rm,curveMonotoneX:wH,curveMonotoneY:SH,curveNatural:_H,curveStep:NH,curveStepAfter:jH,curveStepBefore:AH},dp=e=>zr(e.x)&&zr(e.y),p4=e=>e.base!=null&&dp(e.base)&&dp(e),df=e=>e.x,hf=e=>e.y,UY=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Ad(e));return(r==="curveMonotone"||r==="curveBump")&&t?h4["".concat(r).concat(t==="vertical"?"Y":"X")]:h4[r]||rm},zY=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=UY(t,a),o=i?r.filter(dp):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>d4(d4({},h),{},{base:n[m]}));a==="vertical"?c=K0().y(hf).x1(df).x0(h=>h.base.x):c=K0().x(df).y1(hf).y0(h=>h.base.y);var f=c.defined(p4).curve(s),d=i?u.filter(p4):u;return f(d)}a==="vertical"&&gt(n)?c=K0().y(hf).x1(df).x0(n):gt(n)?c=K0().x(df).y1(hf).y0(n):c=N6().x(df).y(hf);var p=c.defined(dp).curve(s);return p(o)},Gy=e=>{var{className:t,points:r,path:n,pathRef:a}=e,i=_u();if((!r||!r.length)&&!n)return null;var s={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},o=r&&r.length?zY(s):n;return y.createElement("path",Dv({},li(e),Ty(e),{className:rr("recharts-curve",t),d:o===null?void 0:o,ref:a}))},$Y=["x","y","top","left","width","height","className"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(null,arguments)}function m4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m4(Object(r),!0).forEach(function(n){HY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HY(e,t,r){return(t=qY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qY(e){var t=GY(e,"string");return typeof t=="symbol"?t:t+""}function GY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VY(e,t){if(e==null)return{};var r,n,a=YY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KY=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),XY=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=e,c=VY(e,$Y),u=WY({x:t,y:r,top:n,left:a,width:i,height:s},c);return!gt(t)||!gt(r)||!gt(i)||!gt(s)||!gt(n)||!gt(a)?null:y.createElement("path",Mv({},Ta(u),{className:rr("recharts-cross",o),d:KY(t,r,i,s,n,a)}))};function JY(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function g4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g4(Object(r),!0).forEach(function(n){ZY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZY(e,t,r){return(t=QY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QY(e){var t=eK(e,"string");return typeof t=="symbol"?t:t+""}function eK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tK=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),JE=(e,t,r)=>e.map(n=>"".concat(tK(n)," ").concat(t,"ms ").concat(r)).join(","),rK=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),sd=(e,t)=>Object.keys(t).reduce((r,n)=>x4(x4({},r),{},{[n]:e(n,t[n])}),{});function v4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function An(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v4(Object(r),!0).forEach(function(n){nK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nK(e,t,r){return(t=aK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aK(e){var t=iK(e,"string");return typeof t=="symbol"?t:t+""}function iK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hp=(e,t,r)=>e+(t-e)*r,Rv=e=>{var{from:t,to:r}=e;return t!==r},ZE=(e,t,r)=>{var n=sd((a,i)=>{if(Rv(i)){var[s,o]=e(i.from,i.to,i.velocity);return An(An({},i),{},{from:s,velocity:o})}return i},t);return r<1?sd((a,i)=>Rv(i)&&n[a]!=null?An(An({},i),{},{velocity:hp(i.velocity,n[a].velocity,r),from:hp(i.from,n[a].from,r)}):i,t):ZE(e,n,r-1)};function sK(e,t,r,n,a,i){var s,o=n.reduce((p,h)=>An(An({},p),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>sd((p,h)=>h.from,o),u=()=>!Object.values(o).filter(Rv).length,f=null,d=p=>{s||(s=p);var h=p-s,m=h/r.dt;o=ZE(r,o,m),a(An(An(An({},e),t),c())),s=p,u()||(f=i.setTimeout(d))};return()=>(f=i.setTimeout(d),()=>{var p;(p=f)===null||p===void 0||p()})}function oK(e,t,r,n,a,i,s){var o=null,c=a.reduce((d,p)=>{var h=e[p],m=t[p];return h==null||m==null?d:An(An({},d),{},{[p]:[h,m]})},{}),u,f=d=>{u||(u=d);var p=(d-u)/n,h=sd((g,x)=>hp(...x,r(p)),c);if(i(An(An(An({},e),t),h)),p<1)o=s.setTimeout(f);else{var m=sd((g,x)=>hp(...x,r(1)),c);i(An(An(An({},e),t),m))}};return()=>(o=s.setTimeout(f),()=>{var d;(d=o)===null||d===void 0||d()})}const lK=(e,t,r,n,a,i)=>{var s=rK(e,t);return r==null?()=>(a(An(An({},e),t)),()=>{}):r.isStepper===!0?sK(e,t,r,s,a,i):oK(e,t,r,n,s,a,i)};var pp=1e-4,QE=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],eC=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),y4=(e,t)=>r=>{var n=QE(e,t);return eC(n,r)},cK=(e,t)=>r=>{var n=QE(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return eC(a,r)},uK=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},fK=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=uK(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},dK=(e,t,r,n)=>{var a=y4(e,r),i=y4(t,n),s=cK(e,r),o=u=>u>1?1:u<0?0:u,c=u=>{for(var f=u>1?1:u,d=f,p=0;p<8;++p){var h=a(d)-f,m=s(d);if(Math.abs(h-f)<pp||m<pp)return i(d);d=o(d-h/m)}return i(d)};return c.isStepper=!1,c},b4=function(){return dK(...fK(...arguments))},hK=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,o,c)=>{var u=-(s-o)*r,f=c*n,d=c+(u-f)*a/1e3,p=c*a/1e3+s;return Math.abs(p-o)<pp&&Math.abs(d)<pp?[o,0]:[p,d]};return i.isStepper=!0,i.dt=a,i},pK=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return b4(e);case"spring":return hK();default:if(e.split("(")[0]==="cubic-bezier")return b4(e)}return typeof e=="function"?e:null};function mK(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...u]=o;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class gK{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function xK(){return mK(new gK)}var vK=y.createContext(xK);function yK(e,t){var r=y.useContext(vK);return y.useMemo(()=>t??r(e),[e,t,r])}var bK=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),_m={isSsr:bK()},wK={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},w4={t:0},r1={t:1};function Od(e){var t=_n(e,wK),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:c,children:u}=t,f=r==="auto"?!_m.isSsr:r,d=yK(t.animationId,t.animationManager),[p,h]=y.useState(f?w4:r1),m=y.useRef(null);return y.useEffect(()=>{f||h(r1)},[f]),y.useEffect(()=>{if(!f||!n)return jd;var g=lK(w4,r1,pK(i),a,h,d.getTimeoutController()),x=()=>{m.current=g()};return d.start([c,s,x,a,o]),()=>{d.stop(),m.current&&m.current(),o()}},[f,n,a,i,s,c,o,d]),u(p.t)}function Fd(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=y.useRef(Qf(t)),n=y.useRef(e);return n.current!==e&&(r.current=Qf(t),n.current=e),r.current}var SK=["radius"],_K=["radius"],S4,_4,N4,A4,j4,k4,E4,C4,T4,P4;function O4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O4(Object(r),!0).forEach(function(n){NK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NK(e,t,r){return(t=AK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AK(e){var t=jK(e,"string");return typeof t=="symbol"?t:t+""}function jK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mp.apply(null,arguments)}function I4(e,t){if(e==null)return{};var r,n,a=kK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function hs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var L4=(e,t,r,n,a)=>{var i=$o(r),s=$o(n),o=Math.min(Math.abs(i)/2,Math.abs(s)/2),c=s>=0?1:-1,u=i>=0?1:-1,f=s>=0&&i>=0||s<0&&i<0?1:0,d;if(o>0&&a instanceof Array){for(var p=[0,0,0,0],h=0,m=4;h<m;h++)p[h]=a[h]>o?o:a[h];d=Vr(S4||(S4=hs(["M",",",""])),e,t+c*p[0]),p[0]>0&&(d+=Vr(_4||(_4=hs(["A ",",",",0,0,",",",",",""])),p[0],p[0],f,e+u*p[0],t)),d+=Vr(N4||(N4=hs(["L ",",",""])),e+r-u*p[1],t),p[1]>0&&(d+=Vr(A4||(A4=hs(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],f,e+r,t+c*p[1])),d+=Vr(j4||(j4=hs(["L ",",",""])),e+r,t+n-c*p[2]),p[2]>0&&(d+=Vr(k4||(k4=hs(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],f,e+r-u*p[2],t+n)),d+=Vr(E4||(E4=hs(["L ",",",""])),e+u*p[3],t+n),p[3]>0&&(d+=Vr(C4||(C4=hs(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],f,e,t+n-c*p[3])),d+="Z"}else if(o>0&&a===+a&&a>0){var g=Math.min(o,a);d=Vr(T4||(T4=hs(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*g,g,g,f,e+u*g,t,e+r-u*g,t,g,g,f,e+r,t+c*g,e+r,t+n-c*g,g,g,f,e+r-u*g,t+n,e+u*g,t+n,g,g,f,e,t+n-c*g)}else d=Vr(P4||(P4=hs(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return d},D4={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tC=e=>{var t=_n(e,D4),r=y.useRef(null),[n,a]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var Z=r.current.getTotalLength();Z&&a(Z)}catch{}},[]);var{x:i,y:s,width:o,height:c,radius:u,className:f}=t,{animationEasing:d,animationDuration:p,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:g}=t,x=y.useRef(o),b=y.useRef(c),S=y.useRef(i),_=y.useRef(s),E=y.useMemo(()=>({x:i,y:s,width:o,height:c,radius:u}),[i,s,o,c,u]),O=Fd(E,"rectangle-");if(i!==+i||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var F=rr("recharts-rectangle",f);if(!g){var M=Ta(t),{radius:C}=M,k=I4(M,SK);return y.createElement("path",mp({},k,{x:$o(i),y:$o(s),width:$o(o),height:$o(c),radius:typeof u=="number"?u:void 0,className:F,d:L4(i,s,o,c,u)}))}var W=x.current,D=b.current,j=S.current,H=_.current,U="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),X=JE(["strokeDasharray"],p,typeof d=="string"?d:D4.animationEasing);return y.createElement(Od,{animationId:O,key:O,canBegin:n>0,duration:p,easing:d,isActive:g,begin:h},Z=>{var K=Ir(W,o,Z),z=Ir(D,c,Z),se=Ir(j,i,Z),xe=Ir(H,s,Z);r.current&&(x.current=K,b.current=z,S.current=se,_.current=xe);var A;m?Z>0?A={transition:X,strokeDasharray:Y}:A={strokeDasharray:U}:A={strokeDasharray:Y};var I=Ta(t),{radius:P}=I,L=I4(I,_K);return y.createElement("path",mp({},L,{radius:typeof u=="number"?u:void 0,className:F,d:L4(se,xe,K,z,u),ref:r,style:F4(F4({},A),t.style)}))})};function M4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function R4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M4(Object(r),!0).forEach(function(n){EK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EK(e,t,r){return(t=CK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CK(e){var t=TK(e,"string");return typeof t=="symbol"?t:t+""}function TK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gp=Math.PI/180,PK=e=>e*180/Math.PI,bn=(e,t,r,n)=>({x:e+Math.cos(-gp*n)*r,y:t+Math.sin(-gp*n)*r}),rC=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},OK=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},FK=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=OK({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,c=Math.acos(o);return n>i&&(c=2*Math.PI-c),{radius:s,angle:PK(c),angleInRadian:c}},IK=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},LK=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},DK=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:i}=FK({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o||a===0)return null;var{startAngle:c,endAngle:u}=IK(t),f=i,d;if(c<=u){for(;f>u;)f-=360;for(;f<c;)f+=360;d=f>=c&&f<=u}else{for(;f>c;)f-=360;for(;f<u;)f+=360;d=f>=u&&f<=c}return d?R4(R4({},t),{},{radius:a,angle:LK(f,t)}):null};function nC(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=bn(t,r,n,a),o=bn(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}var B4,U4,z4,$4,W4,H4,q4;function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bv.apply(null,arguments)}function jl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var MK=(e,t)=>{var r=Wn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},ih=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:c}=e,u=o*(s?1:-1)+n,f=Math.asin(o/u)/gp,d=c?a:a+i*f,p=bn(t,r,u,d),h=bn(t,r,n,d),m=c?a-i*f:a,g=bn(t,r,u*Math.cos(f*gp),m);return{center:p,circleTangency:h,lineTangency:g,theta:f}},aC=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,o=MK(i,s),c=i+o,u=bn(t,r,a,i),f=bn(t,r,a,c),d=Vr(B4||(B4=jl(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(o)>180),+(i>c),f.x,f.y);if(n>0){var p=bn(t,r,n,i),h=bn(t,r,n,c);d+=Vr(U4||(U4=jl(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(o)>180),+(i<=c),p.x,p.y)}else d+=Vr(z4||(z4=jl(["L ",","," Z"])),t,r);return d},RK=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:u}=e,f=Wn(u-c),{circleTangency:d,lineTangency:p,theta:h}=ih({cx:t,cy:r,radius:a,angle:c,sign:f,cornerRadius:i,cornerIsExternal:o}),{circleTangency:m,lineTangency:g,theta:x}=ih({cx:t,cy:r,radius:a,angle:u,sign:-f,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(c-u):Math.abs(c-u)-h-x;if(b<0)return s?Vr($4||($4=jl(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,i,i,i*2,i,i,-i*2):aC({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var S=Vr(W4||(W4=jl(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,i,i,+(f<0),d.x,d.y,a,a,+(b>180),+(f<0),m.x,m.y,i,i,+(f<0),g.x,g.y);if(n>0){var{circleTangency:_,lineTangency:E,theta:O}=ih({cx:t,cy:r,radius:n,angle:c,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:F,lineTangency:M,theta:C}=ih({cx:t,cy:r,radius:n,angle:u,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),k=o?Math.abs(c-u):Math.abs(c-u)-O-C;if(k<0&&i===0)return"".concat(S,"L").concat(t,",").concat(r,"Z");S+=Vr(H4||(H4=jl(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),M.x,M.y,i,i,+(f<0),F.x,F.y,n,n,+(k>180),+(f>0),_.x,_.y,i,i,+(f<0),E.x,E.y)}else S+=Vr(q4||(q4=jl(["L",",","Z"])),t,r);return S},BK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},iC=e=>{var t=_n(e,BK),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:f,className:d}=t;if(i<a||u===f)return null;var p=rr("recharts-sector",d),h=i-a,m=ga(s,h,0,!0),g;return m>0&&Math.abs(u-f)<360?g=RK({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(m,h/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:f}):g=aC({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:f}),y.createElement("path",Bv({},Ta(t),{className:p,d:g}))};function UK(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(B6(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:s,angle:o}=t,c=bn(n,a,i,o),u=bn(n,a,s,o);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return nC(t)}}var n1={},a1={},i1={},G4;function zK(){return G4||(G4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=X6();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(i1)),i1}var V4;function $K(){return V4||(V4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zK();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(a1)),a1}var Y4;function WK(){return Y4||(Y4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J6(),r=$K();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=a,a+=s;return c}e.range=n})(n1)),n1}var s1,K4;function HK(){return K4||(K4=1,s1=WK().range),s1}var qK=HK();const sC=lo(qK);function Ho(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function GK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Vy(e){let t,r,n;e.length!==2?(t=Ho,r=(o,c)=>Ho(e(o),c),n=(o,c)=>e(o)-c):(t=e===Ho||e===GK?e:VK,r=e,n=e);function a(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<0?u=d+1:f=d}while(u<f)}return u}function i(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<=0?u=d+1:f=d}while(u<f)}return u}function s(o,c,u=0,f=o.length){const d=a(o,c,u,f-1);return d>u&&n(o[d-1],c)>-n(o[d],c)?d-1:d}return{left:a,center:s,right:i}}function VK(){return 0}function oC(e){return e===null?NaN:+e}function*YK(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const KK=Vy(Ho),Id=KK.right;Vy(oC).center;class X4 extends Map{constructor(t,r=ZK){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(J4(this,t))}has(t){return super.has(J4(this,t))}set(t,r){return super.set(XK(this,t),r)}delete(t){return super.delete(JK(this,t))}}function J4({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function XK({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function JK({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function ZK(e){return e!==null&&typeof e=="object"?e.valueOf():e}function QK(e=Ho){if(e===Ho)return lC;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function lC(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const eX=Math.sqrt(50),tX=Math.sqrt(10),rX=Math.sqrt(2);function xp(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=eX?10:i>=tX?5:i>=rX?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?xp(e,t,r*2):[o,c,u]}function Uv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?xp(t,e,r):xp(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function zv(e,t,r){return t=+t,e=+e,r=+r,xp(e,t,r)[2]}function $v(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?zv(t,e,r):zv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Z4(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Q4(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function cC(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?lC:QK(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,f=Math.log(c),d=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*d*(c-d)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*d/c+p)),m=Math.min(n,Math.floor(t+(c-u)*d/c+p));cC(e,t,h,m,a)}const i=e[t];let s=r,o=n;for(pf(e,r,t),a(e[n],i)>0&&pf(e,r,n);s<o;){for(pf(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?pf(e,r,o):(++o,pf(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function pf(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function nX(e,t,r){if(e=Float64Array.from(YK(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Q4(e);if(t>=1)return Z4(e);var n,a=(n-1)*t,i=Math.floor(a),s=Z4(cC(e,i).subarray(0,i+1)),o=Q4(e.subarray(i+1));return s+(o-s)*(a-i)}}function aX(e,t,r=oC){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function iX(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ii(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function mo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Wv=Symbol("implicit");function Yy(){var e=new X4,t=[],r=[],n=Wv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Wv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new X4;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Yy(t,r).unknown(n)},Ii.apply(a,arguments),a}function Ky(){var e=Yy().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,f=.5;delete e.unknown;function d(){var p=t().length,h=a<n,m=h?a:n,g=h?n:a;i=(g-m)/Math.max(1,p-c+u*2),o&&(i=Math.floor(i)),m+=(g-m-i*(p-c))*f,s=i*(1-c),o&&(m=Math.round(m),s=Math.round(s));var x=iX(p).map(function(b){return m+i*b});return r(h?x.reverse():x)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,d()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,o=!0,d()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(p){return arguments.length?(o=!!p,d()):o},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),d()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),d()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,d()):u},e.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),d()):f},e.copy=function(){return Ky(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(f)},Ii.apply(d(),arguments)}function uC(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return uC(t())},e}function sX(){return uC(Ky.apply(null,arguments).paddingInner(1))}function Xy(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function fC(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ld(){}var od=.7,vp=1/od,eu="\\s*([+-]?\\d+)\\s*",ld="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ss="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oX=/^#([0-9a-f]{3,8})$/,lX=new RegExp(`^rgb\\(${eu},${eu},${eu}\\)$`),cX=new RegExp(`^rgb\\(${Ss},${Ss},${Ss}\\)$`),uX=new RegExp(`^rgba\\(${eu},${eu},${eu},${ld}\\)$`),fX=new RegExp(`^rgba\\(${Ss},${Ss},${Ss},${ld}\\)$`),dX=new RegExp(`^hsl\\(${ld},${Ss},${Ss}\\)$`),hX=new RegExp(`^hsla\\(${ld},${Ss},${Ss},${ld}\\)$`),eN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xy(Ld,cd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:tN,formatHex:tN,formatHex8:pX,formatHsl:mX,formatRgb:rN,toString:rN});function tN(){return this.rgb().formatHex()}function pX(){return this.rgb().formatHex8()}function mX(){return dC(this).formatHsl()}function rN(){return this.rgb().formatRgb()}function cd(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=oX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?nN(t):r===3?new Ua(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?sh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?sh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=lX.exec(e))?new Ua(t[1],t[2],t[3],1):(t=cX.exec(e))?new Ua(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=uX.exec(e))?sh(t[1],t[2],t[3],t[4]):(t=fX.exec(e))?sh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=dX.exec(e))?sN(t[1],t[2]/100,t[3]/100,1):(t=hX.exec(e))?sN(t[1],t[2]/100,t[3]/100,t[4]):eN.hasOwnProperty(e)?nN(eN[e]):e==="transparent"?new Ua(NaN,NaN,NaN,0):null}function nN(e){return new Ua(e>>16&255,e>>8&255,e&255,1)}function sh(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ua(e,t,r,n)}function gX(e){return e instanceof Ld||(e=cd(e)),e?(e=e.rgb(),new Ua(e.r,e.g,e.b,e.opacity)):new Ua}function Hv(e,t,r,n){return arguments.length===1?gX(e):new Ua(e,t,r,n??1)}function Ua(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Xy(Ua,Hv,fC(Ld,{brighter(e){return e=e==null?vp:Math.pow(vp,e),new Ua(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?od:Math.pow(od,e),new Ua(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ua(Ll(this.r),Ll(this.g),Ll(this.b),yp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:aN,formatHex:aN,formatHex8:xX,formatRgb:iN,toString:iN}));function aN(){return`#${kl(this.r)}${kl(this.g)}${kl(this.b)}`}function xX(){return`#${kl(this.r)}${kl(this.g)}${kl(this.b)}${kl((isNaN(this.opacity)?1:this.opacity)*255)}`}function iN(){const e=yp(this.opacity);return`${e===1?"rgb(":"rgba("}${Ll(this.r)}, ${Ll(this.g)}, ${Ll(this.b)}${e===1?")":`, ${e})`}`}function yp(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ll(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function kl(e){return e=Ll(e),(e<16?"0":"")+e.toString(16)}function sN(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ki(e,t,r,n)}function dC(e){if(e instanceof Ki)return new Ki(e.h,e.s,e.l,e.opacity);if(e instanceof Ld||(e=cd(e)),!e)return new Ki;if(e instanceof Ki)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new Ki(s,o,c,e.opacity)}function vX(e,t,r,n){return arguments.length===1?dC(e):new Ki(e,t,r,n??1)}function Ki(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Xy(Ki,vX,fC(Ld,{brighter(e){return e=e==null?vp:Math.pow(vp,e),new Ki(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?od:Math.pow(od,e),new Ki(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Ua(o1(e>=240?e-240:e+120,a,n),o1(e,a,n),o1(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ki(oN(this.h),oh(this.s),oh(this.l),yp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yp(this.opacity);return`${e===1?"hsl(":"hsla("}${oN(this.h)}, ${oh(this.s)*100}%, ${oh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function oN(e){return e=(e||0)%360,e<0?e+360:e}function oh(e){return Math.max(0,Math.min(1,e||0))}function o1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Jy=e=>()=>e;function yX(e,t){return function(r){return e+r*t}}function bX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function wX(e){return(e=+e)==1?hC:function(t,r){return r-t?bX(t,r,e):Jy(isNaN(t)?r:t)}}function hC(e,t){var r=t-e;return r?yX(e,r):Jy(isNaN(e)?t:e)}const lN=(function e(t){var r=wX(t);function n(a,i){var s=r((a=Hv(a)).r,(i=Hv(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=hC(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=c(f),a.opacity=u(f),a+""}}return n.gamma=e,n})(1);function SX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function _X(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function NX(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Nu(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function AX(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function bp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function jX(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Nu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var qv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,l1=new RegExp(qv.source,"g");function kX(e){return function(){return e}}function EX(e){return function(t){return e(t)+""}}function CX(e,t){var r=qv.lastIndex=l1.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=qv.exec(e))&&(a=l1.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:bp(n,a)})),r=l1.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?EX(c[0].x):kX(t):(t=c.length,function(u){for(var f=0,d;f<t;++f)o[(d=c[f]).i]=d.x(u);return o.join("")})}function Nu(e,t){var r=typeof t,n;return t==null||r==="boolean"?Jy(t):(r==="number"?bp:r==="string"?(n=cd(t))?(t=n,lN):CX:t instanceof cd?lN:t instanceof Date?AX:_X(t)?SX:Array.isArray(t)?NX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?jX:bp)(e,t)}function Zy(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function TX(e,t){t===void 0&&(t=e,e=Nu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function PX(e){return function(){return e}}function wp(e){return+e}var cN=[0,1];function Ea(e){return e}function Gv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:PX(isNaN(t)?NaN:.5)}function OX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function FX(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Gv(a,n),i=r(s,i)):(n=Gv(n,a),i=r(i,s)),function(o){return i(n(o))}}function IX(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Gv(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=Id(e,o,1,n)-1;return i[c](a[c](o))}}function Dd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Nm(){var e=cN,t=cN,r=Nu,n,a,i,s=Ea,o,c,u;function f(){var p=Math.min(e.length,t.length);return s!==Ea&&(s=OX(e[0],e[p-1])),o=p>2?IX:FX,c=u=null,d}function d(p){return p==null||isNaN(p=+p)?i:(c||(c=o(e.map(n),t,r)))(n(s(p)))}return d.invert=function(p){return s(a((u||(u=o(t,e.map(n),bp)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,wp),f()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),f()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),r=Zy,f()},d.clamp=function(p){return arguments.length?(s=p?!0:Ea,f()):s!==Ea},d.interpolate=function(p){return arguments.length?(r=p,f()):r},d.unknown=function(p){return arguments.length?(i=p,d):i},function(p,h){return n=p,a=h,f()}}function Qy(){return Nm()(Ea,Ea)}function LX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Sp(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function hu(e){return e=Sp(Math.abs(e)),e?e[1]:NaN}function DX(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function MX(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var RX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ud(e){if(!(t=RX.exec(e)))throw new Error("invalid format: "+e);var t;return new eb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ud.prototype=eb.prototype;function eb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}eb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function BX(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var _p;function UX(e,t){var r=Sp(e,t);if(!r)return _p=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(_p=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Sp(e,Math.max(0,t+i-1))[0]}function uN(e,t){var r=Sp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const fN={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:LX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>uN(e*100,t),r:uN,s:UX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function dN(e){return e}var hN=Array.prototype.map,pN=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function zX(e){var t=e.grouping===void 0||e.thousands===void 0?dN:DX(hN.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?dN:MX(hN.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(d,p){d=ud(d);var h=d.fill,m=d.align,g=d.sign,x=d.symbol,b=d.zero,S=d.width,_=d.comma,E=d.precision,O=d.trim,F=d.type;F==="n"?(_=!0,F="g"):fN[F]||(E===void 0&&(E=12),O=!0,F="g"),(b||h==="0"&&m==="=")&&(b=!0,h="0",m="=");var M=(p&&p.prefix!==void 0?p.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():""),C=(x==="$"?n:/[%p]/.test(F)?s:"")+(p&&p.suffix!==void 0?p.suffix:""),k=fN[F],W=/[defgprs%]/.test(F);E=E===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function D(j){var H=M,U=C,Y,X,Z;if(F==="c")U=k(j)+U,j="";else{j=+j;var K=j<0||1/j<0;if(j=isNaN(j)?c:k(Math.abs(j),E),O&&(j=BX(j)),K&&+j==0&&g!=="+"&&(K=!1),H=(K?g==="("?g:o:g==="-"||g==="("?"":g)+H,U=(F==="s"&&!isNaN(j)&&_p!==void 0?pN[8+_p/3]:"")+U+(K&&g==="("?")":""),W){for(Y=-1,X=j.length;++Y<X;)if(Z=j.charCodeAt(Y),48>Z||Z>57){U=(Z===46?a+j.slice(Y+1):j.slice(Y))+U,j=j.slice(0,Y);break}}}_&&!b&&(j=t(j,1/0));var z=H.length+j.length+U.length,se=z<S?new Array(S-z+1).join(h):"";switch(_&&b&&(j=t(se+j,se.length?S-U.length:1/0),se=""),m){case"<":j=H+j+U+se;break;case"=":j=H+se+j+U;break;case"^":j=se.slice(0,z=se.length>>1)+H+j+U+se.slice(z);break;default:j=se+H+j+U;break}return i(j)}return D.toString=function(){return d+""},D}function f(d,p){var h=Math.max(-8,Math.min(8,Math.floor(hu(p)/3)))*3,m=Math.pow(10,-h),g=u((d=ud(d),d.type="f",d),{suffix:pN[8+h/3]});return function(x){return g(m*x)}}return{format:u,formatPrefix:f}}var lh,tb,pC;$X({thousands:",",grouping:[3],currency:["$",""]});function $X(e){return lh=zX(e),tb=lh.format,pC=lh.formatPrefix,lh}function WX(e){return Math.max(0,-hu(Math.abs(e)))}function HX(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(hu(t)/3)))*3-hu(Math.abs(e)))}function qX(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hu(t)-hu(e))+1}function mC(e,t,r,n){var a=$v(e,t,r),i;switch(n=ud(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=HX(a,s))&&(n.precision=i),pC(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=qX(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=WX(a))&&(n.precision=i-(n.type==="%")*2);break}}return tb(n)}function sl(e){var t=e.domain;return e.ticks=function(r){var n=t();return Uv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return mC(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,f=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);f-- >0;){if(u=zv(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function gC(){var e=Qy();return e.copy=function(){return Dd(e,gC())},Ii.apply(e,arguments),sl(e)}function xC(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,wp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return xC(e).unknown(t)},e=arguments.length?Array.from(e,wp):[0,1],sl(r)}function vC(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function mN(e){return Math.log(e)}function gN(e){return Math.exp(e)}function GX(e){return-Math.log(-e)}function VX(e){return-Math.exp(-e)}function YX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KX(e){return e===10?YX:e===Math.E?Math.exp:t=>Math.pow(e,t)}function XX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function xN(e){return(t,r)=>-e(-t,r)}function rb(e){const t=e(mN,gN),r=t.domain;let n=10,a,i;function s(){return a=XX(n),i=KX(n),r()[0]<0?(a=xN(a),i=xN(i),e(GX,VX)):e(mN,gN),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],f=c[c.length-1];const d=f<u;d&&([u,f]=[f,u]);let p=a(u),h=a(f),m,g;const x=o==null?10:+o;let b=[];if(!(n%1)&&h-p<x){if(p=Math.floor(p),h=Math.ceil(h),u>0){for(;p<=h;++p)for(m=1;m<n;++m)if(g=p<0?m/i(-p):m*i(p),!(g<u)){if(g>f)break;b.push(g)}}else for(;p<=h;++p)for(m=n-1;m>=1;--m)if(g=p>0?m/i(-p):m*i(p),!(g<u)){if(g>f)break;b.push(g)}b.length*2<x&&(b=Uv(u,f,x))}else b=Uv(p,h,Math.min(h-p,x)).map(i);return d?b.reverse():b},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ud(c)).precision==null&&(c.trim=!0),c=tb(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=u?c(f):""}},t.nice=()=>r(vC(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function yC(){const e=rb(Nm()).domain([1,10]);return e.copy=()=>Dd(e,yC()).base(e.base()),Ii.apply(e,arguments),e}function vN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function yN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function nb(e){var t=1,r=e(vN(t),yN(t));return r.constant=function(n){return arguments.length?e(vN(t=+n),yN(t)):t},sl(r)}function bC(){var e=nb(Nm());return e.copy=function(){return Dd(e,bC()).constant(e.constant())},Ii.apply(e,arguments)}function bN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function JX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ZX(e){return e<0?-e*e:e*e}function ab(e){var t=e(Ea,Ea),r=1;function n(){return r===1?e(Ea,Ea):r===.5?e(JX,ZX):e(bN(r),bN(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},sl(t)}function ib(){var e=ab(Nm());return e.copy=function(){return Dd(e,ib()).exponent(e.exponent())},Ii.apply(e,arguments),e}function QX(){return ib.apply(null,arguments).exponent(.5)}function wN(e){return Math.sign(e)*e*e}function eJ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function wC(){var e=Qy(),t=[0,1],r=!1,n;function a(i){var s=eJ(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(wN(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,wp)).map(wN)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return wC(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ii.apply(a,arguments),sl(a)}function SC(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=aX(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Id(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ho),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return SC().domain(e).range(t).unknown(n)},Ii.apply(i,arguments)}function _C(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Id(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return _C().domain([e,t]).range(a).unknown(i)},Ii.apply(sl(s),arguments)}function NC(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Id(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return NC().domain(e).range(t).unknown(r)},Ii.apply(a,arguments)}const c1=new Date,u1=new Date;function Tn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>Tn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(c1.setTime(+i),u1.setTime(+s),e(c1),e(u1),Math.floor(r(c1,u1))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Np=Tn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Np.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Tn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Np);Np.range;const qs=1e3,Ei=qs*60,Gs=Ei*60,ro=Gs*24,sb=ro*7,SN=ro*30,f1=ro*365,El=Tn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*qs)},(e,t)=>(t-e)/qs,e=>e.getUTCSeconds());El.range;const ob=Tn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qs)},(e,t)=>{e.setTime(+e+t*Ei)},(e,t)=>(t-e)/Ei,e=>e.getMinutes());ob.range;const lb=Tn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ei)},(e,t)=>(t-e)/Ei,e=>e.getUTCMinutes());lb.range;const cb=Tn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qs-e.getMinutes()*Ei)},(e,t)=>{e.setTime(+e+t*Gs)},(e,t)=>(t-e)/Gs,e=>e.getHours());cb.range;const ub=Tn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Gs)},(e,t)=>(t-e)/Gs,e=>e.getUTCHours());ub.range;const Md=Tn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ei)/ro,e=>e.getDate()-1);Md.range;const Am=Tn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ro,e=>e.getUTCDate()-1);Am.range;const AC=Tn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ro,e=>Math.floor(e/ro));AC.range;function ic(e){return Tn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ei)/sb)}const jm=ic(0),Ap=ic(1),tJ=ic(2),rJ=ic(3),pu=ic(4),nJ=ic(5),aJ=ic(6);jm.range;Ap.range;tJ.range;rJ.range;pu.range;nJ.range;aJ.range;function sc(e){return Tn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/sb)}const km=sc(0),jp=sc(1),iJ=sc(2),sJ=sc(3),mu=sc(4),oJ=sc(5),lJ=sc(6);km.range;jp.range;iJ.range;sJ.range;mu.range;oJ.range;lJ.range;const fb=Tn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());fb.range;const db=Tn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());db.range;const no=Tn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());no.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Tn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});no.range;const ao=Tn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ao.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Tn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ao.range;function jC(e,t,r,n,a,i){const s=[[El,1,qs],[El,5,5*qs],[El,15,15*qs],[El,30,30*qs],[i,1,Ei],[i,5,5*Ei],[i,15,15*Ei],[i,30,30*Ei],[a,1,Gs],[a,3,3*Gs],[a,6,6*Gs],[a,12,12*Gs],[n,1,ro],[n,2,2*ro],[r,1,sb],[t,1,SN],[t,3,3*SN],[e,1,f1]];function o(u,f,d){const p=f<u;p&&([u,f]=[f,u]);const h=d&&typeof d.range=="function"?d:c(u,f,d),m=h?h.range(u,+f+1):[];return p?m.reverse():m}function c(u,f,d){const p=Math.abs(f-u)/d,h=Vy(([,,x])=>x).right(s,p);if(h===s.length)return e.every($v(u/f1,f/f1,d));if(h===0)return Np.every(Math.max($v(u,f,d),1));const[m,g]=s[p/s[h-1][2]<s[h][2]/p?h-1:h];return m.every(g)}return[o,c]}const[cJ,uJ]=jC(ao,db,km,AC,ub,lb),[fJ,dJ]=jC(no,fb,jm,Md,cb,ob);function d1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function h1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function mf(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function hJ(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=gf(a),f=xf(a),d=gf(i),p=xf(i),h=gf(s),m=xf(s),g=gf(o),x=xf(o),b=gf(c),S=xf(c),_={a:Z,A:K,b:z,B:se,c:null,d:EN,e:EN,f:DJ,g:GJ,G:YJ,H:FJ,I:IJ,j:LJ,L:kC,m:MJ,M:RJ,p:xe,q:A,Q:PN,s:ON,S:BJ,u:UJ,U:zJ,V:$J,w:WJ,W:HJ,x:null,X:null,y:qJ,Y:VJ,Z:KJ,"%":TN},E={a:I,A:P,b:L,B:R,c:null,d:CN,e:CN,f:QJ,g:cZ,G:fZ,H:XJ,I:JJ,j:ZJ,L:CC,m:eZ,M:tZ,p:G,q:J,Q:PN,s:ON,S:rZ,u:nZ,U:aZ,V:iZ,w:sZ,W:oZ,x:null,X:null,y:lZ,Y:uZ,Z:dZ,"%":TN},O={a:W,A:D,b:j,B:H,c:U,d:jN,e:jN,f:CJ,g:AN,G:NN,H:kN,I:kN,j:AJ,L:EJ,m:NJ,M:jJ,p:k,q:_J,Q:PJ,s:OJ,S:kJ,u:vJ,U:yJ,V:bJ,w:xJ,W:wJ,x:Y,X,y:AN,Y:NN,Z:SJ,"%":TJ};_.x=F(r,_),_.X=F(n,_),_.c=F(t,_),E.x=F(r,E),E.X=F(n,E),E.c=F(t,E);function F(q,Q){return function(fe){var V=[],Oe=-1,Te=0,be=q.length,re,we,ve;for(fe instanceof Date||(fe=new Date(+fe));++Oe<be;)q.charCodeAt(Oe)===37&&(V.push(q.slice(Te,Oe)),(we=_N[re=q.charAt(++Oe)])!=null?re=q.charAt(++Oe):we=re==="e"?" ":"0",(ve=Q[re])&&(re=ve(fe,we)),V.push(re),Te=Oe+1);return V.push(q.slice(Te,Oe)),V.join("")}}function M(q,Q){return function(fe){var V=mf(1900,void 0,1),Oe=C(V,q,fe+="",0),Te,be;if(Oe!=fe.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(Q&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(Te=h1(mf(V.y,0,1)),be=Te.getUTCDay(),Te=be>4||be===0?jp.ceil(Te):jp(Te),Te=Am.offset(Te,(V.V-1)*7),V.y=Te.getUTCFullYear(),V.m=Te.getUTCMonth(),V.d=Te.getUTCDate()+(V.w+6)%7):(Te=d1(mf(V.y,0,1)),be=Te.getDay(),Te=be>4||be===0?Ap.ceil(Te):Ap(Te),Te=Md.offset(Te,(V.V-1)*7),V.y=Te.getFullYear(),V.m=Te.getMonth(),V.d=Te.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),be="Z"in V?h1(mf(V.y,0,1)).getUTCDay():d1(mf(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(be+5)%7:V.w+V.U*7-(be+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,h1(V)):d1(V)}}function C(q,Q,fe,V){for(var Oe=0,Te=Q.length,be=fe.length,re,we;Oe<Te;){if(V>=be)return-1;if(re=Q.charCodeAt(Oe++),re===37){if(re=Q.charAt(Oe++),we=O[re in _N?Q.charAt(Oe++):re],!we||(V=we(q,fe,V))<0)return-1}else if(re!=fe.charCodeAt(V++))return-1}return V}function k(q,Q,fe){var V=u.exec(Q.slice(fe));return V?(q.p=f.get(V[0].toLowerCase()),fe+V[0].length):-1}function W(q,Q,fe){var V=h.exec(Q.slice(fe));return V?(q.w=m.get(V[0].toLowerCase()),fe+V[0].length):-1}function D(q,Q,fe){var V=d.exec(Q.slice(fe));return V?(q.w=p.get(V[0].toLowerCase()),fe+V[0].length):-1}function j(q,Q,fe){var V=b.exec(Q.slice(fe));return V?(q.m=S.get(V[0].toLowerCase()),fe+V[0].length):-1}function H(q,Q,fe){var V=g.exec(Q.slice(fe));return V?(q.m=x.get(V[0].toLowerCase()),fe+V[0].length):-1}function U(q,Q,fe){return C(q,t,Q,fe)}function Y(q,Q,fe){return C(q,r,Q,fe)}function X(q,Q,fe){return C(q,n,Q,fe)}function Z(q){return s[q.getDay()]}function K(q){return i[q.getDay()]}function z(q){return c[q.getMonth()]}function se(q){return o[q.getMonth()]}function xe(q){return a[+(q.getHours()>=12)]}function A(q){return 1+~~(q.getMonth()/3)}function I(q){return s[q.getUTCDay()]}function P(q){return i[q.getUTCDay()]}function L(q){return c[q.getUTCMonth()]}function R(q){return o[q.getUTCMonth()]}function G(q){return a[+(q.getUTCHours()>=12)]}function J(q){return 1+~~(q.getUTCMonth()/3)}return{format:function(q){var Q=F(q+="",_);return Q.toString=function(){return q},Q},parse:function(q){var Q=M(q+="",!1);return Q.toString=function(){return q},Q},utcFormat:function(q){var Q=F(q+="",E);return Q.toString=function(){return q},Q},utcParse:function(q){var Q=M(q+="",!0);return Q.toString=function(){return q},Q}}}var _N={"-":"",_:" ",0:"0"},qn=/^\s*\d+/,pJ=/^%/,mJ=/[\\^$*+?|[\]().{}]/g;function nr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function gJ(e){return e.replace(mJ,"\\$&")}function gf(e){return new RegExp("^(?:"+e.map(gJ).join("|")+")","i")}function xf(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function xJ(e,t,r){var n=qn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function vJ(e,t,r){var n=qn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function yJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function bJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function wJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function NN(e,t,r){var n=qn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function AN(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function SJ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _J(e,t,r){var n=qn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function NJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function jN(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function AJ(e,t,r){var n=qn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function kN(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function jJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function kJ(e,t,r){var n=qn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function EJ(e,t,r){var n=qn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function CJ(e,t,r){var n=qn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function TJ(e,t,r){var n=pJ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function PJ(e,t,r){var n=qn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function OJ(e,t,r){var n=qn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function EN(e,t){return nr(e.getDate(),t,2)}function FJ(e,t){return nr(e.getHours(),t,2)}function IJ(e,t){return nr(e.getHours()%12||12,t,2)}function LJ(e,t){return nr(1+Md.count(no(e),e),t,3)}function kC(e,t){return nr(e.getMilliseconds(),t,3)}function DJ(e,t){return kC(e,t)+"000"}function MJ(e,t){return nr(e.getMonth()+1,t,2)}function RJ(e,t){return nr(e.getMinutes(),t,2)}function BJ(e,t){return nr(e.getSeconds(),t,2)}function UJ(e){var t=e.getDay();return t===0?7:t}function zJ(e,t){return nr(jm.count(no(e)-1,e),t,2)}function EC(e){var t=e.getDay();return t>=4||t===0?pu(e):pu.ceil(e)}function $J(e,t){return e=EC(e),nr(pu.count(no(e),e)+(no(e).getDay()===4),t,2)}function WJ(e){return e.getDay()}function HJ(e,t){return nr(Ap.count(no(e)-1,e),t,2)}function qJ(e,t){return nr(e.getFullYear()%100,t,2)}function GJ(e,t){return e=EC(e),nr(e.getFullYear()%100,t,2)}function VJ(e,t){return nr(e.getFullYear()%1e4,t,4)}function YJ(e,t){var r=e.getDay();return e=r>=4||r===0?pu(e):pu.ceil(e),nr(e.getFullYear()%1e4,t,4)}function KJ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+nr(t/60|0,"0",2)+nr(t%60,"0",2)}function CN(e,t){return nr(e.getUTCDate(),t,2)}function XJ(e,t){return nr(e.getUTCHours(),t,2)}function JJ(e,t){return nr(e.getUTCHours()%12||12,t,2)}function ZJ(e,t){return nr(1+Am.count(ao(e),e),t,3)}function CC(e,t){return nr(e.getUTCMilliseconds(),t,3)}function QJ(e,t){return CC(e,t)+"000"}function eZ(e,t){return nr(e.getUTCMonth()+1,t,2)}function tZ(e,t){return nr(e.getUTCMinutes(),t,2)}function rZ(e,t){return nr(e.getUTCSeconds(),t,2)}function nZ(e){var t=e.getUTCDay();return t===0?7:t}function aZ(e,t){return nr(km.count(ao(e)-1,e),t,2)}function TC(e){var t=e.getUTCDay();return t>=4||t===0?mu(e):mu.ceil(e)}function iZ(e,t){return e=TC(e),nr(mu.count(ao(e),e)+(ao(e).getUTCDay()===4),t,2)}function sZ(e){return e.getUTCDay()}function oZ(e,t){return nr(jp.count(ao(e)-1,e),t,2)}function lZ(e,t){return nr(e.getUTCFullYear()%100,t,2)}function cZ(e,t){return e=TC(e),nr(e.getUTCFullYear()%100,t,2)}function uZ(e,t){return nr(e.getUTCFullYear()%1e4,t,4)}function fZ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?mu(e):mu.ceil(e),nr(e.getUTCFullYear()%1e4,t,4)}function dZ(){return"+0000"}function TN(){return"%"}function PN(e){return+e}function ON(e){return Math.floor(+e/1e3)}var Lc,PC,OC;hZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hZ(e){return Lc=hJ(e),PC=Lc.format,Lc.parse,OC=Lc.utcFormat,Lc.utcParse,Lc}function pZ(e){return new Date(e)}function mZ(e){return e instanceof Date?+e:+new Date(+e)}function hb(e,t,r,n,a,i,s,o,c,u){var f=Qy(),d=f.invert,p=f.domain,h=u(".%L"),m=u(":%S"),g=u("%I:%M"),x=u("%I %p"),b=u("%a %d"),S=u("%b %d"),_=u("%B"),E=u("%Y");function O(F){return(c(F)<F?h:o(F)<F?m:s(F)<F?g:i(F)<F?x:n(F)<F?a(F)<F?b:S:r(F)<F?_:E)(F)}return f.invert=function(F){return new Date(d(F))},f.domain=function(F){return arguments.length?p(Array.from(F,mZ)):p().map(pZ)},f.ticks=function(F){var M=p();return e(M[0],M[M.length-1],F??10)},f.tickFormat=function(F,M){return M==null?O:u(M)},f.nice=function(F){var M=p();return(!F||typeof F.range!="function")&&(F=t(M[0],M[M.length-1],F??10)),F?p(vC(M,F)):f},f.copy=function(){return Dd(f,hb(e,t,r,n,a,i,s,o,c,u))},f}function gZ(){return Ii.apply(hb(fJ,dJ,no,fb,jm,Md,cb,ob,El,PC).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function xZ(){return Ii.apply(hb(cJ,uJ,ao,db,km,Am,ub,lb,El,OC).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Em(){var e=0,t=1,r,n,a,i,s=Ea,o=!1,c;function u(d){return d==null||isNaN(d=+d)?c:s(a===0?.5:(d=(i(d)-r)*a,o?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(d){return arguments.length?(o=!!d,u):o},u.interpolator=function(d){return arguments.length?(s=d,u):s};function f(d){return function(p){var h,m;return arguments.length?([h,m]=p,s=d(h,m),u):[s(0),s(1)]}}return u.range=f(Nu),u.rangeRound=f(Zy),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return i=d,r=d(e),n=d(t),a=r===n?0:1/(n-r),u}}function ol(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function FC(){var e=sl(Em()(Ea));return e.copy=function(){return ol(e,FC())},mo.apply(e,arguments)}function IC(){var e=rb(Em()).domain([1,10]);return e.copy=function(){return ol(e,IC()).base(e.base())},mo.apply(e,arguments)}function LC(){var e=nb(Em());return e.copy=function(){return ol(e,LC()).constant(e.constant())},mo.apply(e,arguments)}function pb(){var e=ab(Em());return e.copy=function(){return ol(e,pb()).exponent(e.exponent())},mo.apply(e,arguments)}function vZ(){return pb.apply(null,arguments).exponent(.5)}function DC(){var e=[],t=Ea;function r(n){if(n!=null&&!isNaN(n=+n))return t((Id(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ho),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>nX(e,i/n))},r.copy=function(){return DC(t).domain(e)},mo.apply(r,arguments)}function Cm(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=Ea,f,d=!1,p;function h(g){return isNaN(g=+g)?p:(g=.5+((g=+f(g))-i)*(n*g<n*i?o:c),u(d?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=f(e=+e),i=f(t=+t),s=f(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(d=!!g,h):d},h.interpolator=function(g){return arguments.length?(u=g,h):u};function m(g){return function(x){var b,S,_;return arguments.length?([b,S,_]=x,u=TX(g,[b,S,_]),h):[u(0),u(.5),u(1)]}}return h.range=m(Nu),h.rangeRound=m(Zy),h.unknown=function(g){return arguments.length?(p=g,h):p},function(g){return f=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h}}function MC(){var e=sl(Cm()(Ea));return e.copy=function(){return ol(e,MC())},mo.apply(e,arguments)}function RC(){var e=rb(Cm()).domain([.1,1,10]);return e.copy=function(){return ol(e,RC()).base(e.base())},mo.apply(e,arguments)}function BC(){var e=nb(Cm());return e.copy=function(){return ol(e,BC()).constant(e.constant())},mo.apply(e,arguments)}function mb(){var e=ab(Cm());return e.copy=function(){return ol(e,mb()).exponent(e.exponent())},mo.apply(e,arguments)}function yZ(){return mb.apply(null,arguments).exponent(.5)}const jf=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ky,scaleDiverging:MC,scaleDivergingLog:RC,scaleDivergingPow:mb,scaleDivergingSqrt:yZ,scaleDivergingSymlog:BC,scaleIdentity:xC,scaleImplicit:Wv,scaleLinear:gC,scaleLog:yC,scaleOrdinal:Yy,scalePoint:sX,scalePow:ib,scaleQuantile:SC,scaleQuantize:_C,scaleRadial:wC,scaleSequential:FC,scaleSequentialLog:IC,scaleSequentialPow:pb,scaleSequentialQuantile:DC,scaleSequentialSqrt:vZ,scaleSequentialSymlog:LC,scaleSqrt:QX,scaleSymlog:bC,scaleThreshold:NC,scaleTime:gZ,scaleUtc:xZ,tickFormat:mC},Symbol.toStringTag,{value:"Module"}));var go=e=>e.chartData,Tm=Re([go],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),gb=(e,t,r,n)=>n?Tm(e):go(e),bZ=(e,t,r)=>r?Tm(e):go(e);function Ko(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(zr(t)&&zr(r))return!0}return!1}function FN(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function UC(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(zr(r))a=r;else if(typeof r=="function")return;if(zr(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Ko(s))return s}}function wZ(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Ko(n))return FN(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,o;if(a==="auto")t!=null&&(s=Math.min(...t));else if(gt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&H_.test(a)){var c=H_.exec(a);if(c==null||c[1]==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(gt(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&q_.test(i)){var f=q_.exec(i);if(f==null||f[1]==null||t==null)o=void 0;else{var d=+f[1];o=t[1]+d}}else o=t==null?void 0:t[1];var p=[s,o];if(Ko(p))return t==null?p:FN(p,t,r)}}}var Au=1e9,SZ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vb,Lr=!0,Oi="[DecimalError] ",Dl=Oi+"Invalid argument: ",xb=Oi+"Exponent out of range: ",ju=Math.floor,bl=Math.pow,_Z=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ni,Bn=1e7,Er=7,zC=9007199254740991,kp=ju(zC/Er),mt={};mt.absoluteValue=mt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};mt.comparedTo=mt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};mt.decimalPlaces=mt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Er;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};mt.dividedBy=mt.div=function(e){return Js(this,new this.constructor(e))};mt.dividedToIntegerBy=mt.idiv=function(e){var t=this,r=t.constructor;return Sr(Js(t,new r(e),0,1),r.precision)};mt.equals=mt.eq=function(e){return!this.cmp(e)};mt.exponent=function(){return Sn(this)};mt.greaterThan=mt.gt=function(e){return this.cmp(e)>0};mt.greaterThanOrEqualTo=mt.gte=function(e){return this.cmp(e)>=0};mt.isInteger=mt.isint=function(){return this.e>this.d.length-2};mt.isNegative=mt.isneg=function(){return this.s<0};mt.isPositive=mt.ispos=function(){return this.s>0};mt.isZero=function(){return this.s===0};mt.lessThan=mt.lt=function(e){return this.cmp(e)<0};mt.lessThanOrEqualTo=mt.lte=function(e){return this.cmp(e)<1};mt.logarithm=mt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ni))throw Error(Oi+"NaN");if(r.s<1)throw Error(Oi+(r.s?"NaN":"-Infinity"));return r.eq(ni)?new n(0):(Lr=!1,t=Js(fd(r,i),fd(e,i),i),Lr=!0,Sr(t,a))};mt.minus=mt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HC(t,e):$C(t,(e.s=-e.s,e))};mt.modulo=mt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Oi+"NaN");return r.s?(Lr=!1,t=Js(r,e,0,1).times(e),Lr=!0,r.minus(t)):Sr(new n(r),a)};mt.naturalExponential=mt.exp=function(){return WC(this)};mt.naturalLogarithm=mt.ln=function(){return fd(this)};mt.negated=mt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};mt.plus=mt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$C(t,e):HC(t,(e.s=-e.s,e))};mt.precision=mt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Dl+e);if(t=Sn(a)+1,n=a.d.length-1,r=n*Er+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};mt.squareRoot=mt.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Oi+"NaN")}for(e=Sn(o),Lr=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=bs(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ju((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Js(o,i,s+2)).times(.5),bs(i.d).slice(0,s)===(t=bs(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(Sr(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Lr=!0,Sr(n,r)};mt.times=mt.mul=function(e){var t,r,n,a,i,s,o,c,u,f=this,d=f.constructor,p=f.d,h=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,r=f.e+e.e,c=p.length,u=h.length,c<u&&(i=p,p=h,h=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+h[n]*p[a-n-1]+t,i[a--]=o%Bn|0,t=o/Bn|0;i[a]=(i[a]+t)%Bn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Lr?Sr(e,d.precision):e};mt.toDecimalPlaces=mt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(js(e,0,Au),t===void 0?t=n.rounding:js(t,0,8),Sr(r,e+Sn(r)+1,t))};mt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Xl(n,!0):(js(e,0,Au),t===void 0?t=a.rounding:js(t,0,8),n=Sr(new a(n),e+1,t),r=Xl(n,!0,e+1)),r};mt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Xl(a):(js(e,0,Au),t===void 0?t=i.rounding:js(t,0,8),n=Sr(new i(a),e+Sn(a)+1,t),r=Xl(n.abs(),!1,e+Sn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};mt.toInteger=mt.toint=function(){var e=this,t=e.constructor;return Sr(new t(e),Sn(e)+1,t.rounding)};mt.toNumber=function(){return+this};mt.toPower=mt.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,f=+(e=new c(e));if(!e.s)return new c(ni);if(o=new c(o),!o.s){if(e.s<1)throw Error(Oi+"Infinity");return o}if(o.eq(ni))return o;if(n=c.precision,e.eq(ni))return Sr(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=f<0?-f:f)<=zC){for(a=new c(ni),t=Math.ceil(n/Er+4),Lr=!1;r%2&&(a=a.times(o),LN(a.d,t)),r=ju(r/2),r!==0;)o=o.times(o),LN(o.d,t);return Lr=!0,e.s<0?new c(ni).div(a):Sr(a,n)}}else if(i<0)throw Error(Oi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Lr=!1,a=e.times(fd(o,n+u)),Lr=!0,a=WC(a),a.s=i,a};mt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Sn(a),n=Xl(a,r<=i.toExpNeg||r>=i.toExpPos)):(js(e,1,Au),t===void 0?t=i.rounding:js(t,0,8),a=Sr(new i(a),e,t),r=Sn(a),n=Xl(a,e<=r||r<=i.toExpNeg,e)),n};mt.toSignificantDigits=mt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(js(e,1,Au),t===void 0?t=n.rounding:js(t,0,8)),Sr(new n(r),e,t)};mt.toString=mt.valueOf=mt.val=mt.toJSON=mt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Sn(e),r=e.constructor;return Xl(e,t<=r.toExpNeg||t>=r.toExpPos)};function $C(e,t){var r,n,a,i,s,o,c,u,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),Lr?Sr(t,d):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(d/Er),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/Bn|0,c[i]%=Bn;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,Lr?Sr(t,d):t}function js(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Dl+e)}function bs(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Er-n.length,r&&(i+=Mo(r)),i+=n;s=e[t],n=s+"",r=Er-n.length,r&&(i+=Mo(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Js=(function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%Bn|0,s=i/Bn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Bn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,f,d,p,h,m,g,x,b,S,_,E,O,F,M,C,k=n.constructor,W=n.s==a.s?1:-1,D=n.d,j=a.d;if(!n.s)return new k(n);if(!a.s)throw Error(Oi+"Division by zero");for(c=n.e-a.e,M=j.length,O=D.length,h=new k(W),m=h.d=[],u=0;j[u]==(D[u]||0);)++u;if(j[u]>(D[u]||0)&&--c,i==null?S=i=k.precision:s?S=i+(Sn(n)-Sn(a))+1:S=i,S<0)return new k(0);if(S=S/Er+2|0,u=0,M==1)for(f=0,j=j[0],S++;(u<O||f)&&S--;u++)_=f*Bn+(D[u]||0),m[u]=_/j|0,f=_%j|0;else{for(f=Bn/(j[0]+1)|0,f>1&&(j=e(j,f),D=e(D,f),M=j.length,O=D.length),E=M,g=D.slice(0,M),x=g.length;x<M;)g[x++]=0;C=j.slice(),C.unshift(0),F=j[0],j[1]>=Bn/2&&++F;do f=0,o=t(j,g,M,x),o<0?(b=g[0],M!=x&&(b=b*Bn+(g[1]||0)),f=b/F|0,f>1?(f>=Bn&&(f=Bn-1),d=e(j,f),p=d.length,x=g.length,o=t(d,g,p,x),o==1&&(f--,r(d,M<p?C:j,p))):(f==0&&(o=f=1),d=j.slice()),p=d.length,p<x&&d.unshift(0),r(g,d,x),o==-1&&(x=g.length,o=t(j,g,M,x),o<1&&(f++,r(g,M<x?C:j,x))),x=g.length):o===0&&(f++,g=[0]),m[u++]=f,o&&g[0]?g[x++]=D[E]||0:(g=[D[E]],x=1);while((E++<O||g[0]!==void 0)&&S--)}return m[0]||m.shift(),h.e=c,Sr(h,s?i+Sn(h)+1:i)}})();function WC(e,t){var r,n,a,i,s,o,c=0,u=0,f=e.constructor,d=f.precision;if(Sn(e)>16)throw Error(xb+Sn(e));if(!e.s)return new f(ni);for(Lr=!1,o=d,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(bl(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new f(ni),f.precision=o;;){if(a=Sr(a.times(e),o),r=r.times(++c),s=i.plus(Js(a,r,o)),bs(s.d).slice(0,o)===bs(i.d).slice(0,o)){for(;u--;)i=Sr(i.times(i),o);return f.precision=d,t==null?(Lr=!0,Sr(i,d)):i}i=s}}function Sn(e){for(var t=e.e*Er,r=e.d[0];r>=10;r/=10)t++;return t}function p1(e,t,r){if(t>e.LN10.sd())throw Lr=!0,r&&(e.precision=r),Error(Oi+"LN10 precision limit exceeded");return Sr(new e(e.LN10),t)}function Mo(e){for(var t="";e--;)t+="0";return t}function fd(e,t){var r,n,a,i,s,o,c,u,f,d=1,p=10,h=e,m=h.d,g=h.constructor,x=g.precision;if(h.s<1)throw Error(Oi+(h.s?"NaN":"-Infinity"));if(h.eq(ni))return new g(0);if(t==null?(Lr=!1,u=x):u=t,h.eq(10))return t==null&&(Lr=!0),p1(g,u);if(u+=p,g.precision=u,r=bs(m),n=r.charAt(0),i=Sn(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=bs(h.d),n=r.charAt(0),d++;i=Sn(h),n>1?(h=new g("0."+r),i++):h=new g(n+"."+r.slice(1))}else return c=p1(g,u+2,x).times(i+""),h=fd(new g(n+"."+r.slice(1)),u-p).plus(c),g.precision=x,t==null?(Lr=!0,Sr(h,x)):h;for(o=s=h=Js(h.minus(ni),h.plus(ni),u),f=Sr(h.times(h),u),a=3;;){if(s=Sr(s.times(f),u),c=o.plus(Js(s,new g(a),u)),bs(c.d).slice(0,u)===bs(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(p1(g,u+2,x).times(i+""))),o=Js(o,new g(d),u),g.precision=x,t==null?(Lr=!0,Sr(o,x)):o;o=c,a+=2}}function IN(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ju(r/Er),e.d=[],n=(r+1)%Er,r<0&&(n+=Er),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Er;n<a;)e.d.push(+t.slice(n,n+=Er));t=t.slice(n),n=Er-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Lr&&(e.e>kp||e.e<-kp))throw Error(xb+r)}else e.s=0,e.e=0,e.d=[0];return e}function Sr(e,t,r){var n,a,i,s,o,c,u,f,d=e.d;for(s=1,i=d[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Er,a=t,u=d[f=0];else{if(f=Math.ceil((n+1)/Er),i=d.length,f>=i)return e;for(u=i=d[f],s=1;i>=10;i/=10)s++;n%=Er,a=n-Er+s}if(r!==void 0&&(i=bl(10,s-a-1),o=u/i%10|0,c=t<0||d[f+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/bl(10,s-a):0:d[f-1])%10&1||r==(e.s<0?8:7))),t<1||!d[0])return c?(i=Sn(e),d.length=1,t=t-i-1,d[0]=bl(10,(Er-t%Er)%Er),e.e=ju(-t/Er)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=bl(10,Er-n),d[f]=a>0?(u/bl(10,s-a)%bl(10,a)|0)*i:0),c)for(;;)if(f==0){(d[0]+=i)==Bn&&(d[0]=1,++e.e);break}else{if(d[f]+=i,d[f]!=Bn)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(Lr&&(e.e>kp||e.e<-kp))throw Error(xb+Sn(e));return e}function HC(e,t){var r,n,a,i,s,o,c,u,f,d,p=e.constructor,h=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Lr?Sr(t,h):t;if(c=e.d,d=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(f=s<0,f?(r=c,s=-s,o=d.length):(r=d,n=u,o=c.length),a=Math.max(Math.ceil(h/Er),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=d.length,f=a<o,f&&(o=a),a=0;a<o;a++)if(c[a]!=d[a]){f=c[a]<d[a];break}s=0}for(f&&(r=c,c=d,d=r,t.s=-t.s),o=c.length,a=d.length-o;a>0;--a)c[o++]=0;for(a=d.length;a>s;){if(c[--a]<d[a]){for(i=a;i&&c[--i]===0;)c[i]=Bn-1;--c[i],c[a]+=Bn}c[a]-=d[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Lr?Sr(t,h):t):new p(0)}function Xl(e,t,r){var n,a=Sn(e),i=bs(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Mo(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Mo(-a-1)+i,r&&(n=r-s)>0&&(i+=Mo(n))):a>=s?(i+=Mo(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Mo(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Mo(n))),e.s<0?"-"+i:i}function LN(e,t){if(e.length>t)return e.length=t,!0}function qC(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Dl+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return IN(s,i.toString())}else if(typeof i!="string")throw Error(Dl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,_Z.test(i))IN(s,i);else throw Error(Dl+i)}if(a.prototype=mt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=qC,a.config=a.set=NZ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function NZ(e){if(!e||typeof e!="object")throw Error(Oi+"Object expected");var t,r,n,a=["precision",1,Au,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ju(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Dl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Dl+r+": "+n);return this}var vb=qC(SZ);ni=new vb(1);const dr=vb;var AZ=e=>e,GC={},VC=e=>e===GC,DN=e=>function t(){return arguments.length===0||arguments.length===1&&VC(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},YC=(e,t)=>e===1?t:DN(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==GC).length;return i>=e?t(...n):YC(e-i,DN(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var u=n.map(f=>VC(f)?o.shift():f);return t(...u,...o)}))}),jZ=e=>YC(e.length,e),Vv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},kZ=jZ((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),EZ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return AZ;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,c)=>c(o),i(...arguments))}};function KC(e){var t;return e===0?t=1:t=Math.floor(new dr(e).abs().log(10).toNumber())+1,t}function XC(e,t,r){for(var n=new dr(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var JC=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},ZC=(e,t,r)=>{if(e.lte(0))return new dr(0);var n=KC(e.toNumber()),a=new dr(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new dr(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?new dr(c.toNumber()):new dr(Math.ceil(c.toNumber()))},CZ=(e,t,r)=>{var n=new dr(1),a=new dr(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new dr(10).pow(KC(e)-1),a=new dr(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new dr(Math.floor(e)))}else e===0?a=new dr(Math.floor((t-1)/2)):r||(a=new dr(Math.floor(e)));var s=Math.floor((t-1)/2),o=EZ(kZ(c=>a.add(new dr(c-s).mul(n)).toNumber()),Vv);return o(0,t)},QC=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new dr(0),tickMin:new dr(0),tickMax:new dr(0)};var s=ZC(new dr(r).sub(t).div(n-1),a,i),o;t<=0&&r>=0?o=new dr(0):(o=new dr(t).add(r).div(2),o=o.sub(new dr(o).mod(s)));var c=Math.ceil(o.sub(t).div(s).toNumber()),u=Math.ceil(new dr(r).sub(o).div(s).toNumber()),f=c+u+1;return f>n?QC(t,r,n,a,i+1):(f<n&&(u=r>0?u+(n-f):u,c=r>0?c:c+(n-f)),{step:s,tickMin:o.sub(new dr(c).mul(s)),tickMax:o.add(new dr(u).mul(s))})},TZ=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[o,c]=JC([r,n]);if(o===-1/0||c===1/0){var u=c===1/0?[o,...Vv(0,a-1).map(()=>1/0)]:[...Vv(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(o===c)return CZ(o,a,i);var{step:f,tickMin:d,tickMax:p}=QC(o,c,s,i,0),h=XC(d,p.add(new dr(.1).mul(f)),f);return r>n?h.reverse():h},PZ=function(t,r){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=JC([n,a]);if(s===-1/0||o===1/0)return[n,a];if(s===o)return[s];var c=Math.max(r,2),u=ZC(new dr(o).sub(s).div(c-1),i,0),f=[...XC(new dr(s),new dr(o),u),o];return i===!1&&(f=f.map(d=>Math.round(d))),n>a?f.reverse():f},eT=e=>e.rootProps.maxBarSize,OZ=e=>e.rootProps.barGap,tT=e=>e.rootProps.barCategoryGap,FZ=e=>e.rootProps.barSize,Rd=e=>e.rootProps.stackOffset,rT=e=>e.rootProps.reverseStackOrder,yb=e=>e.options.chartName,bb=e=>e.rootProps.syncId,nT=e=>e.rootProps.syncMethod,wb=e=>e.options.eventEmitter,wn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},$s={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Za={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Pm=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},IZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:$s.angleAxisId,includeHidden:!1,name:void 0,reversed:$s.reversed,scale:$s.scale,tick:$s.tick,tickCount:void 0,ticks:void 0,type:$s.type,unit:void 0},LZ={allowDataOverflow:Za.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Za.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Za.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Za.scale,tick:Za.tick,tickCount:Za.tickCount,ticks:void 0,type:Za.type,unit:void 0},DZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:$s.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$s.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$s.scale,tick:$s.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},MZ={allowDataOverflow:Za.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Za.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Za.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Za.scale,tick:Za.tick,tickCount:Za.tickCount,ticks:void 0,type:"category",unit:void 0},Sb=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?DZ:IZ,_b=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?MZ:LZ,Om=e=>e.polarOptions,Nb=Re([ho,po,Cn],rC),aT=Re([Om,Nb],(e,t)=>{if(e!=null)return ga(e.innerRadius,t,0)}),iT=Re([Om,Nb],(e,t)=>{if(e!=null)return ga(e.outerRadius,t,t*.8)}),RZ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},sT=Re([Om],RZ);Re([Sb,sT],Pm);var oT=Re([Nb,aT,iT],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Re([_b,oT],Pm);var lT=Re([Jt,Om,aT,iT,ho,po],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:u}=t;return{cx:ga(s,a,a/2),cy:ga(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Mr=(e,t)=>t,Bd=(e,t,r)=>r;function Ab(e){return e==null?void 0:e.id}function cT(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var f=Ab(o);u.forEach((d,p)=>{var h=i==null||a?p:String(yr(d,i,null)),m=yr(d,o.dataKey,0),g;s.has(h)?g=s.get(h):g={},Object.assign(g,{[f]:m}),s.set(h,g)})}}),Array.from(s.values())}function Fm(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Im=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Lm(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function BZ(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Pn=e=>{var t=Jt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ku=e=>e.tooltip.settings.axisId;function MN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MN(Object(r),!0).forEach(function(n){UZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UZ(e,t,r){return(t=zZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zZ(e){var t=$Z(e,"string");return typeof t=="symbol"?t:t+""}function $Z(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yv=[0,"auto"],Dn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},uT=(e,t)=>e.cartesianAxis.xAxis[t],xo=(e,t)=>{var r=uT(e,t);return r??Dn},Mn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Yv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Td},fT=(e,t)=>e.cartesianAxis.yAxis[t],vo=(e,t)=>{var r=fT(e,t);return r??Mn},WZ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},jb=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??WZ},$r=(e,t,r)=>{switch(t){case"xAxis":return xo(e,r);case"yAxis":return vo(e,r);case"zAxis":return jb(e,r);case"angleAxis":return Sb(e,r);case"radiusAxis":return _b(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},HZ=(e,t,r)=>{switch(t){case"xAxis":return xo(e,r);case"yAxis":return vo(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ud=(e,t,r)=>{switch(t){case"xAxis":return xo(e,r);case"yAxis":return vo(e,r);case"angleAxis":return Sb(e,r);case"radiusAxis":return _b(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},dT=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function kb(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Dm=e=>e.graphicalItems.cartesianItems,qZ=Re([Mr,Bd],kb),Eb=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),zd=Re([Dm,$r,qZ],Eb,{memoizeOptions:{resultEqualityCheck:Lm}}),hT=Re([zd],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Fm)),pT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),GZ=Re([zd],pT),Cb=e=>e.map(t=>t.data).filter(Boolean).flat(1),VZ=Re([zd],Cb,{memoizeOptions:{resultEqualityCheck:Lm}}),Tb=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Pb=Re([VZ,gb],Tb),Ob=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:yr(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:yr(a,n)}))):e.map(n=>({value:n})),Mm=Re([Pb,$r,zd],Ob);function mT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Sh(e){if(Ns(e)||e instanceof Date){var t=Number(e);if(zr(t))return t}}function RN(e){if(Array.isArray(e)){var t=[Sh(e[0]),Sh(e[1])];return Ko(t)?t:void 0}var r=Sh(e);if(r!=null)return[r,r]}function io(e){return e.map(Sh).filter(BH)}function YZ(e,t,r){return!r||typeof t!="number"||ts(t)?[]:r.length?io(r.flatMap(n=>{var a=yr(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!zr(i)||!zr(s)))return[t-i,t+s]})):[]}var On=e=>{var t=Pn(e),r=ku(e);return Ud(e,t,r)},$d=Re([On],e=>e==null?void 0:e.dataKey),KZ=Re([hT,gb,On],cT),gT=(e,t,r,n)=>{var a={},i=t.reduce((s,o)=>{if(o.stackId==null)return s;var c=s[o.stackId];return c==null&&(c=[]),c.push(o),s[o.stackId]=c,s},a);return Object.fromEntries(Object.entries(i).map(s=>{var[o,c]=s,u=n?[...c].reverse():c,f=u.map(Ab);return[o,{stackedData:hV(e,f,r),graphicalItems:u}]}))},Kv=Re([KZ,hT,Rd,rT],gT),xT=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=vV(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},XZ=Re([$r],e=>e.allowDataOverflow),Fb=e=>{var t;if(e==null||!("domain"in e))return Yv;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=io(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Yv},Ib=Re([$r],Fb),Lb=Re([Ib,XZ],UC),JZ=Re([Kv,go,Mr,Lb],xT,{memoizeOptions:{resultEqualityCheck:Im}}),Rm=e=>e.errorBars,ZZ=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>mT(r,n)),Cp=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},Db=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(o=>{r.forEach(c=>{var u,f,d=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>mT(a,b)),p=yr(o,(f=t.dataKey)!==null&&f!==void 0?f:c.dataKey),h=YZ(o,p,d);if(h.length>=2){var m=Math.min(...h),g=Math.max(...h);(i==null||m<i)&&(i=m),(s==null||g>s)&&(s=g)}var x=RN(p);x!=null&&(i=i==null?x[0]:Math.min(i,x[0]),s=s==null?x[1]:Math.max(s,x[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(o=>{var c=RN(yr(o,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),s=s==null?c[1]:Math.max(s,c[1]))}),zr(i)&&zr(s))return[i,s]},QZ=Re([Pb,$r,GZ,Rm,Mr],Db,{memoizeOptions:{resultEqualityCheck:Im}});function eQ(e){var{value:t}=e;if(Ns(t)||t instanceof Date)return t}var tQ=(e,t,r)=>{var n=e.map(eQ).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&D6(n))?sC(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},vT=e=>e.referenceElements.dots,Eu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),rQ=Re([vT,Mr,Bd],Eu),yT=e=>e.referenceElements.areas,nQ=Re([yT,Mr,Bd],Eu),bT=e=>e.referenceElements.lines,aQ=Re([bT,Mr,Bd],Eu),wT=(e,t)=>{if(e!=null){var r=io(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},iQ=Re(rQ,Mr,wT),ST=(e,t)=>{if(e!=null){var r=io(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},sQ=Re([nQ,Mr],ST);function oQ(e){var t;if(e.x!=null)return io([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:io(r)}function lQ(e){var t;if(e.y!=null)return io([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:io(r)}var _T=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?oQ(n):lQ(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},cQ=Re([aQ,Mr],_T),uQ=Re(iQ,cQ,sQ,(e,t,r)=>Cp(e,r,t)),Mb=(e,t,r,n,a,i,s,o)=>{if(r!=null)return r;var c=s==="vertical"&&o==="xAxis"||s==="horizontal"&&o==="yAxis",u=c?Cp(n,i,a):Cp(i,a);return wZ(t,u,e.allowDataOverflow)},fQ=Re([$r,Ib,Lb,JZ,QZ,uQ,Jt,Mr],Mb,{memoizeOptions:{resultEqualityCheck:Im}}),dQ=[0,1],Rb=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:c}=e,u=il(t,i);if(u&&o==null){var f;return sC(0,(f=r==null?void 0:r.length)!==null&&f!==void 0?f:0)}return c==="category"?tQ(n,e,u):a==="expand"?dQ:s}},Bb=Re([$r,Jt,Pb,Mm,Rd,Mr,fQ],Rb),NT=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(Ad(i));return o in jf?o:"point"}}},Cu=Re([$r,Jt,dT,yb,Mr],NT);function hQ(e){if(e!=null){if(e in jf)return jf[e]();var t="scale".concat(Ad(e));if(t in jf)return jf[t]()}}function Ub(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=hQ(t);if(a!=null){var i=a.domain(r).range(n);return lV(i),i}}}var zb=(e,t,r)=>{var n=Fb(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Ko(e))return TZ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Ko(e))return PZ(e,t.tickCount,t.allowDecimals)}},$b=Re([Bb,Ud,Cu],zb),Wb=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Ko(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},pQ=Re([$r,Bb,$b,Mr],Wb),mQ=Re(Mm,$r,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(io(e.map(d=>d.value))).sort((d,p)=>d-p),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var s=i-a;if(s===0)return 1/0;for(var o=0;o<n.length-1;o++){var c=n[o],u=n[o+1];if(!(c==null||u==null)){var f=u-c;r=Math.min(r,f)}}return r/s}}),AT=Re(mQ,Jt,tT,Cn,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!zr(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=ga(r,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),gQ=(e,t,r)=>{var n=xo(e,t);return n==null||typeof n.padding!="string"?0:AT(e,"xAxis",t,r,n.padding)},xQ=(e,t,r)=>{var n=vo(e,t);return n==null||typeof n.padding!="string"?0:AT(e,"yAxis",t,r,n.padding)},vQ=Re(xo,gQ,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),yQ=Re(vo,xQ,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),bQ=Re([Cn,vQ,xm,gm,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),wQ=Re([Cn,Jt,yQ,xm,gm,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Wd=(e,t,r,n)=>{var a;switch(t){case"xAxis":return bQ(e,r,n);case"yAxis":return wQ(e,r,n);case"zAxis":return(a=jb(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return sT(e);case"radiusAxis":return oT(e,r);default:return}},jT=Re([$r,Wd],Pm),Bm=Re([$r,Cu,pQ,jT],Ub);Re([zd,Rm,Mr],ZZ);function kT(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Um=(e,t)=>t,zm=(e,t,r)=>r,SQ=Re(pm,Um,zm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kT)),_Q=Re(mm,Um,zm,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kT)),ET=(e,t)=>({width:e.width,height:t.height}),NQ=(e,t)=>{var r=typeof t.width=="number"?t.width:Td;return{width:r,height:e.height}},CT=Re(Cn,xo,ET),AQ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},jQ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},kQ=Re(po,Cn,SQ,Um,zm,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=ET(t,o);s==null&&(s=AQ(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i}),EQ=Re(ho,Cn,_Q,Um,zm,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=NQ(t,o);s==null&&(s=jQ(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i}),CQ=(e,t)=>{var r=xo(e,t);if(r!=null)return kQ(e,r.orientation,r.mirror)},TQ=Re([Cn,xo,CQ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),PQ=(e,t)=>{var r=vo(e,t);if(r!=null)return EQ(e,r.orientation,r.mirror)},OQ=Re([Cn,vo,PQ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),TT=Re(Cn,vo,(e,t)=>{var r=typeof t.width=="number"?t.width:Td;return{width:r,height:e.height}}),BN=(e,t,r)=>{switch(t){case"xAxis":return CT(e,r).width;case"yAxis":return TT(e,r).height;default:return}},PT=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=il(e,n),c=t.map(u=>u.value);if(s&&o&&i==="category"&&a&&D6(c))return c}},Hb=Re([Jt,Mm,$r,Mr],PT),OT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=il(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(o=>o.value)}},qb=Re([Jt,Mm,Ud,Mr],OT),UN=Re([Jt,HZ,Cu,Bm,Hb,qb,Wd,$b,Mr],(e,t,r,n,a,i,s,o,c)=>{if(t!=null){var u=il(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:o,range:s,realScaleType:r,scale:n}}}),FQ=(e,t,r,n,a,i,s,o,c)=>{if(!(t==null||n==null)){var u=il(e,c),{type:f,ticks:d,tickCount:p}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&i!=null&&i.length>=2?Wn(i[0]-i[1])*2*m:m;var g=d||a;if(g){var x=g.map((b,S)=>{var _=s?s.indexOf(b):b;return{index:S,coordinate:n(_)+m,value:b,offset:m}});return x.filter(b=>zr(b.coordinate))}return u&&o?o.map((b,S)=>({coordinate:n(b)+m,value:b,index:S,offset:m})).filter(b=>zr(b.coordinate)):n.ticks?n.ticks(p).map(b=>({coordinate:n(b)+m,value:b,offset:m})):n.domain().map((b,S)=>({coordinate:n(b)+m,value:s?s[b]:b,index:S,offset:m}))}},FT=Re([Jt,Ud,Cu,Bm,$b,Wd,Hb,qb,Mr],FQ),IQ=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=il(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&(n==null?void 0:n.length)>=2?Wn(n[0]-n[1])*2*u:u,o&&i?i.map((f,d)=>({coordinate:r(f)+u,value:f,index:d,offset:u})):r.ticks?r.ticks(c).map(f=>({coordinate:r(f)+u,value:f,offset:u})):r.domain().map((f,d)=>({coordinate:r(f)+u,value:a?a[f]:f,index:d,offset:u}))}},Xo=Re([Jt,Ud,Bm,Wd,Hb,qb,Mr],IQ),Jo=Re($r,Bm,(e,t)=>{if(!(e==null||t==null))return Ep(Ep({},e),{},{scale:t})}),LQ=Re([$r,Cu,Bb,jT],Ub);Re((e,t,r)=>jb(e,r),LQ,(e,t)=>{if(!(e==null||t==null))return Ep(Ep({},e),{},{scale:t})});var DQ=Re([Jt,pm,mm],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),IT=e=>e.options.defaultTooltipEventType,LT=e=>e.options.validateTooltipEventTypes;function DT(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Gb(e,t){var r=IT(e),n=LT(e);return DT(t,r,n)}function MQ(e){return yt(t=>Gb(t,e))}var MT=(e,t)=>{var r,n=Number(t);if(!(ts(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},RQ=e=>e.tooltip.settings,Bo={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},BQ={itemInteraction:{click:Bo,hover:Bo},axisInteraction:{click:Bo,hover:Bo},keyboardInteraction:Bo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},RT=Wa({name:"tooltip",initialState:BQ,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Fr()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=es(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:Fr()},removeTooltipEntrySettings:{reducer(e,t){var r=es(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Fr()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:UQ,replaceTooltipEntrySettings:zQ,removeTooltipEntrySettings:$Q,setTooltipSettingsState:WQ,setActiveMouseOverItemIndex:BT,mouseLeaveItem:HQ,mouseLeaveChart:UT,setActiveClickItemIndex:qQ,setMouseOverAxisIndex:zT,setMouseClickAxisIndex:GQ,setSyncInteraction:Xv,setKeyboardInteraction:Jv}=RT.actions,VQ=RT.reducer;function zN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ch(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zN(Object(r),!0).forEach(function(n){YQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YQ(e,t,r){return(t=KQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KQ(e){var t=XQ(e,"string");return typeof t=="symbol"?t:t+""}function XQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JQ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function ZQ(e){return e.index!=null}var $T=(e,t,r,n)=>{if(t==null)return Bo;var a=JQ(e,t,r);if(a==null)return Bo;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(ZQ(a)){if(i)return ch(ch({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return ch(ch({},Bo),{},{coordinate:a.coordinate})};function QQ(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function eee(e,t){var r=QQ(e),n=t[0],a=t[1];if(r===void 0)return!1;var i=Math.min(n,a),s=Math.max(n,a);return r>=i&&r<=s}function tee(e,t,r){if(r==null||t==null)return!0;var n=yr(e,t);return n==null||!Ko(r)?!0:eee(n,r)}var Vb=(e,t,r,n)=>{var a=e==null?void 0:e.index;if(a==null)return null;var i=Number(a);if(!zr(i))return a;var s=0,o=1/0;t.length>0&&(o=t.length-1);var c=Math.max(s,Math.min(i,o)),u=t[c];return u==null||tee(u,r,n)?String(c):null},WT=(e,t,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var c=s[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var f=a==null?void 0:a[Number(i)];if(f)switch(r){case"horizontal":return{x:f.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:f.coordinate}}}},HT=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.graphicalItemId)===a})},Hd=e=>e.options.tooltipPayloadSearcher,Tu=e=>e.tooltip;function $N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$N(Object(r),!0).forEach(function(n){ree(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ree(e,t,r){return(t=nee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nee(e){var t=aee(e,"string");return typeof t=="symbol"?t:t+""}function aee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iee(e,t){return e??t}var qT=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:f}=r,d=[];return e.reduce((p,h)=>{var m,{dataDefinedOnItem:g,settings:x}=h,b=iee(g,o),S=Array.isArray(b)?CE(b,u,f):b,_=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,E=x==null?void 0:x.nameKey,O;if(n&&Array.isArray(S)&&!Array.isArray(S[0])&&s==="axis"?O=M6(S,n,a):O=i(S,t,c,E),Array.isArray(O))O.forEach(M=>{var C=WN(WN({},x),{},{name:M.name,unit:M.unit,color:void 0,fill:void 0});p.push(G_({tooltipEntrySettings:C,dataKey:M.dataKey,payload:M.payload,value:yr(M.payload,M.dataKey),name:M.name}))});else{var F;p.push(G_({tooltipEntrySettings:x,dataKey:_,payload:O,value:yr(O,_),name:(F=yr(O,E))!==null&&F!==void 0?F:x==null?void 0:x.name}))}return p},d)}},Yb=Re([On,Jt,dT,yb,Pn],NT),see=Re([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),oee=Re([Pn,ku],kb),Pu=Re([see,On,oee],Eb,{memoizeOptions:{resultEqualityCheck:Lm}}),lee=Re([Pu],e=>e.filter(Fm)),cee=Re([Pu],Cb,{memoizeOptions:{resultEqualityCheck:Lm}}),Ou=Re([cee,go],Tb),uee=Re([lee,go,On],cT),Kb=Re([Ou,On,Pu],Ob),GT=Re([On],Fb),fee=Re([On],e=>e.allowDataOverflow),VT=Re([GT,fee],UC),dee=Re([Pu],e=>e.filter(Fm)),hee=Re([uee,dee,Rd,rT],gT),pee=Re([hee,go,Pn,VT],xT),mee=Re([Pu],pT),gee=Re([Ou,On,mee,Rm,Pn],Db,{memoizeOptions:{resultEqualityCheck:Im}}),xee=Re([vT,Pn,ku],Eu),vee=Re([xee,Pn],wT),yee=Re([yT,Pn,ku],Eu),bee=Re([yee,Pn],ST),wee=Re([bT,Pn,ku],Eu),See=Re([wee,Pn],_T),_ee=Re([vee,See,bee],Cp),Nee=Re([On,GT,VT,pee,gee,_ee,Jt,Pn],Mb),qd=Re([On,Jt,Ou,Kb,Rd,Pn,Nee],Rb),Aee=Re([qd,On,Yb],zb),jee=Re([On,qd,Aee,Pn],Wb),YT=e=>{var t=Pn(e),r=ku(e),n=!1;return Wd(e,t,r,n)},KT=Re([On,YT],Pm),XT=Re([On,Yb,jee,KT],Ub),kee=Re([Jt,Kb,On,Pn],PT),Eee=Re([Jt,Kb,On,Pn],OT),Cee=(e,t,r,n,a,i,s,o)=>{if(t){var{type:c}=t,u=il(e,o);if(n){var f=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,d=c==="category"&&n.bandwidth?n.bandwidth()/f:0;return d=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Wn(a[0]-a[1])*2*d:d,u&&s?s.map((p,h)=>({coordinate:n(p)+d,value:p,index:h,offset:d})):n.domain().map((p,h)=>({coordinate:n(p)+d,value:i?i[p]:p,index:h,offset:d}))}}},yo=Re([Jt,On,Yb,XT,YT,kee,Eee,Pn],Cee),Xb=Re([IT,LT,RQ],(e,t,r)=>DT(r.shared,e,t)),JT=e=>e.tooltip.settings.trigger,Jb=e=>e.tooltip.settings.defaultIndex,Gd=Re([Tu,Xb,JT,Jb],$T),Zo=Re([Gd,Ou,$d,qd],Vb),ZT=Re([yo,Zo],MT),Zb=Re([Gd],e=>{if(e)return e.dataKey}),Tee=Re([Gd],e=>{if(e)return e.graphicalItemId}),QT=Re([Tu,Xb,JT,Jb],HT),Pee=Re([ho,po,Jt,Cn,yo,Jb,QT,Hd],WT),Oee=Re([Gd,Pee],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Fee=Re([Gd],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Iee=Re([QT,Zo,go,$d,ZT,Hd,Xb],qT),Lee=Re([Iee],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function HN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HN(Object(r),!0).forEach(function(n){Dee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dee(e,t,r){return(t=Mee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mee(e){var t=Ree(e,"string");return typeof t=="symbol"?t:t+""}function Ree(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bee=()=>yt(On),Uee=()=>{var e=Bee(),t=yt(yo),r=yt(XT);return uu(!e||!r?void 0:qN(qN({},e),{},{scale:r}),t)};function GN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GN(Object(r),!0).forEach(function(n){zee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zee(e,t,r){return(t=$ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ee(e){var t=Wee(e,"string");return typeof t=="symbol"?t:t+""}function Wee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hee=(e,t,r,n)=>{var a=t.find(i=>i&&i.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},qee=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Dc(Dc(Dc({},n),bn(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:c}=n;return Dc(Dc(Dc({},n),bn(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Gee(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var eP=(e,t,r,n,a)=>{var i,s=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var o=0;o<s;o++){var c,u,f,d,p,h=o>0?(c=r[o-1])===null||c===void 0?void 0:c.coordinate:(u=r[s-1])===null||u===void 0?void 0:u.coordinate,m=(f=r[o])===null||f===void 0?void 0:f.coordinate,g=o>=s-1?(d=r[0])===null||d===void 0?void 0:d.coordinate:(p=r[o+1])===null||p===void 0?void 0:p.coordinate,x=void 0;if(!(h==null||m==null||g==null))if(Wn(m-h)!==Wn(g-m)){var b=[];if(Wn(g-m)===Wn(a[1]-a[0])){x=g;var S=m+a[1]-a[0];b[0]=Math.min(S,(S+h)/2),b[1]=Math.max(S,(S+h)/2)}else{x=h;var _=g+a[1]-a[0];b[0]=Math.min(m,(_+m)/2),b[1]=Math.max(m,(_+m)/2)}var E=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(e>E[0]&&e<=E[1]||e>=b[0]&&e<=b[1]){var O;return(O=r[o])===null||O===void 0?void 0:O.index}}else{var F=Math.min(h,g),M=Math.max(h,g);if(e>(F+m)/2&&e<=(M+m)/2){var C;return(C=r[o])===null||C===void 0?void 0:C.index}}}else if(t)for(var k=0;k<s;k++){var W=t[k];if(W!=null){var D=t[k+1],j=t[k-1];if(k===0&&D!=null&&e<=(W.coordinate+D.coordinate)/2||k===s-1&&j!=null&&e>(W.coordinate+j.coordinate)/2||k>0&&k<s-1&&j!=null&&D!=null&&e>(W.coordinate+j.coordinate)/2&&e<=(W.coordinate+D.coordinate)/2)return W.index}}return-1},Vee=()=>yt(yb),Qb=(e,t)=>t,tP=(e,t,r)=>r,ew=(e,t,r,n)=>n,Yee=Re(yo,e=>am(e,t=>t.coordinate)),tw=Re([Tu,Qb,tP,ew],$T),rw=Re([tw,Ou,$d,qd],Vb),Kee=(e,t,r)=>{if(t!=null){var n=Tu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},rP=Re([Tu,Qb,tP,ew],HT),Tp=Re([ho,po,Jt,Cn,yo,ew,rP,Hd],WT),Xee=Re([tw,Tp],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),nP=Re([yo,rw],MT),Jee=Re([rP,rw,go,$d,nP,Hd,Qb],qT),Zee=Re([tw,rw],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Qee=(e,t,r,n,a,i,s)=>{if(!(!e||!r||!n||!a)&&Gee(e,s)){var o=yV(e,t),c=eP(o,i,a,r,n),u=Hee(t,a,c,e);return{activeIndex:String(c),activeCoordinate:u}}},ete=(e,t,r,n,a,i,s)=>{if(!(!e||!n||!a||!i||!r)){var o=DK(e,r);if(o){var c=bV(o,t),u=eP(c,s,i,n,a),f=qee(t,i,u,o);return{activeIndex:String(u),activeCoordinate:f}}}},tte=(e,t,r,n,a,i,s,o)=>{if(!(!e||!t||!n||!a||!i))return t==="horizontal"||t==="vertical"?Qee(e,t,n,a,i,s,o):ete(e,t,r,n,a,i,s)},rte=Re(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),nte=Re(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(wn)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:BZ}});function VN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VN(Object(r),!0).forEach(function(n){ate(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ate(e,t,r){return(t=ite(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ite(e){var t=ste(e,"string");return typeof t=="symbol"?t:t+""}function ste(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ote={},lte={zIndexMap:Object.values(wn).reduce((e,t)=>YN(YN({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),ote)},cte=new Set(Object.values(wn));function ute(e){return cte.has(e)}var aP=Wa({name:"zIndex",initialState:lte,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Fr()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!ute(r)&&delete e.zIndexMap[r])},prepare:Fr()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Fr()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:Fr()}}}),{registerZIndexPortal:fte,unregisterZIndexPortal:dte,registerZIndexPortalElement:hte,unregisterZIndexPortalElement:pte}=aP.actions,mte=aP.reducer;function Ha(e){var{zIndex:t,children:r}=e,n=JV(),a=n&&t!==void 0&&t!==0,i=ya(),s=jr();y.useLayoutEffect(()=>a?(s(fte({zIndex:t})),()=>{s(dte({zIndex:t}))}):jd,[s,t,a]);var o=yt(c=>rte(c,t,i));return a?o?P2.createPortal(r,o):null:r}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function KN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KN(Object(r),!0).forEach(function(n){gte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gte(e,t,r){return(t=xte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xte(e){var t=vte(e,"string");return typeof t=="symbol"?t:t+""}function vte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yte(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return y.isValidElement(t)?y.cloneElement(t,n):y.createElement(r,n)}function bte(e){var t,{coordinate:r,payload:n,index:a,offset:i,tooltipAxisBandSize:s,layout:o,cursor:c,tooltipEventType:u,chartName:f}=e,d=r,p=n,h=a;if(!c||!d||f!=="ScatterChart"&&u!=="axis")return null;var m,g,x;if(f==="ScatterChart")m=d,g=XY,x=wn.cursorLine;else if(f==="BarChart")m=JY(o,d,i,s),g=tC,x=wn.cursorRectangle;else if(o==="radial"&&B6(d)){var{cx:b,cy:S,radius:_,startAngle:E,endAngle:O}=nC(d);m={cx:b,cy:S,startAngle:E,endAngle:O,innerRadius:_,outerRadius:_},g=iC,x=wn.cursorLine}else m={points:UK(o,d,i)},g=Gy,x=wn.cursorLine;var F=typeof c=="object"&&"className"in c?c.className:void 0,M=uh(uh(uh(uh({stroke:"#ccc",pointerEvents:"none"},i),m),Hl(c)),{},{payload:p,payloadIndex:h,className:rr("recharts-tooltip-cursor",F)});return y.createElement(Ha,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:x},y.createElement(yte,{cursor:c,cursorComp:g,cursorProps:M}))}function wte(e){var t=Uee(),r=BE(),n=_u(),a=Vee();return t==null||r==null||n==null||a==null?null:y.createElement(bte,Zv({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var iP=y.createContext(null),Ste=()=>y.useContext(iP),m1={exports:{}},XN;function _te(){return XN||(XN=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function i(c,u,f,d,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var h=new a(f,d||c,p),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)t.call(f,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},o.prototype.listeners=function(u){var f=r?r+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,h=d.length,m=new Array(h);p<h;p++)m[p]=d[p].fn;return m},o.prototype.listenerCount=function(u){var f=r?r+u:u,d=this._events[f];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,f,d,p,h,m){var g=r?r+u:u;if(!this._events[g])return!1;var x=this._events[g],b=arguments.length,S,_;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),b){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,f),!0;case 3:return x.fn.call(x.context,f,d),!0;case 4:return x.fn.call(x.context,f,d,p),!0;case 5:return x.fn.call(x.context,f,d,p,h),!0;case 6:return x.fn.call(x.context,f,d,p,h,m),!0}for(_=1,S=new Array(b-1);_<b;_++)S[_-1]=arguments[_];x.fn.apply(x.context,S)}else{var E=x.length,O;for(_=0;_<E;_++)switch(x[_].once&&this.removeListener(u,x[_].fn,void 0,!0),b){case 1:x[_].fn.call(x[_].context);break;case 2:x[_].fn.call(x[_].context,f);break;case 3:x[_].fn.call(x[_].context,f,d);break;case 4:x[_].fn.call(x[_].context,f,d,p);break;default:if(!S)for(O=1,S=new Array(b-1);O<b;O++)S[O-1]=arguments[O];x[_].fn.apply(x[_].context,S)}}return!0},o.prototype.on=function(u,f,d){return i(this,u,f,d,!1)},o.prototype.once=function(u,f,d){return i(this,u,f,d,!0)},o.prototype.removeListener=function(u,f,d,p){var h=r?r+u:u;if(!this._events[h])return this;if(!f)return s(this,h),this;var m=this._events[h];if(m.fn)m.fn===f&&(!p||m.once)&&(!d||m.context===d)&&s(this,h);else{for(var g=0,x=[],b=m.length;g<b;g++)(m[g].fn!==f||p&&!m[g].once||d&&m[g].context!==d)&&x.push(m[g]);x.length?this._events[h]=x.length===1?x[0]:x:s(this,h)}return this},o.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(m1)),m1.exports}var Nte=_te();const Ate=lo(Nte);var dd=new Ate,Qv="recharts.syncEvent.tooltip",JN="recharts.syncEvent.brush";function nw(e,t){if(t){var r=Number.parseInt(t,10);if(!ts(r))return e==null?void 0:e[r]}}var jte={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},sP=Wa({name:"options",initialState:jte,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),kte=sP.reducer,{createEventEmitter:Ete}=sP.actions;function Cte(e){return e.tooltip.syncInteraction}var Tte={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},oP=Wa({name:"chartData",initialState:Tte,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:ZN,setDataStartEndIndexes:Pte,setComputedData:jfe}=oP.actions,Ote=oP.reducer,Fte=["x","y"];function QN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QN(Object(r),!0).forEach(function(n){Ite(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ite(e,t,r){return(t=Lte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lte(e){var t=Dte(e,"string");return typeof t=="symbol"?t:t+""}function Dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mte(e,t){if(e==null)return{};var r,n,a=Rte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Bte(){var e=yt(bb),t=yt(wb),r=jr(),n=yt(nT),a=yt(yo),i=_u(),s=vm(),o=yt(c=>c.rootProps.className);y.useEffect(()=>{if(e==null)return jd;var c=(u,f,d)=>{if(t!==d&&e===u){if(n==="index"){var p;if(s&&f!==null&&f!==void 0&&(p=f.payload)!==null&&p!==void 0&&p.coordinate&&f.payload.sourceViewBox){var h=f.payload.coordinate,{x:m,y:g}=h,x=Mte(h,Fte),{x:b,y:S,width:_,height:E}=f.payload.sourceViewBox,O=Mc(Mc({},x),{},{x:s.x+(_?(m-b)/_:0)*s.width,y:s.y+(E?(g-S)/E:0)*s.height});r(Mc(Mc({},f),{},{payload:Mc(Mc({},f.payload),{},{coordinate:O})}))}else r(f);return}if(a!=null){var F;if(typeof n=="function"){var M={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},C=n(a,M);F=a[C]}else n==="value"&&(F=a.find(X=>String(X.value)===f.payload.label));var{coordinate:k}=f.payload;if(F==null||f.payload.active===!1||k==null||s==null){r(Xv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:W,y:D}=k,j=Math.min(W,s.x+s.width),H=Math.min(D,s.y+s.height),U={x:i==="horizontal"?F.coordinate:j,y:i==="horizontal"?H:F.coordinate},Y=Xv({active:f.payload.active,coordinate:U,dataKey:f.payload.dataKey,index:String(F.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox,graphicalItemId:f.payload.graphicalItemId});r(Y)}}};return dd.on(Qv,c),()=>{dd.off(Qv,c)}},[o,r,t,e,n,a,i,s])}function Ute(){var e=yt(bb),t=yt(wb),r=jr();y.useEffect(()=>{if(e==null)return jd;var n=(a,i,s)=>{t!==s&&e===a&&r(Pte(i))};return dd.on(JN,n),()=>{dd.off(JN,n)}},[r,t,e])}function zte(){var e=jr();y.useEffect(()=>{e(Ete())},[e]),Bte(),Ute()}function $te(e,t,r,n,a,i){var s=yt(h=>Kee(h,e,t)),o=yt(wb),c=yt(bb),u=yt(nT),f=yt(Cte),d=f==null?void 0:f.active,p=vm();y.useEffect(()=>{if(!d&&c!=null&&o!=null){var h=Xv({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:p,graphicalItemId:void 0});dd.emit(Qv,c,h,o)}},[d,r,s,a,n,o,c,u,i,p])}function e3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e3(Object(r),!0).forEach(function(n){Wte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wte(e,t,r){return(t=Hte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hte(e){var t=qte(e,"string");return typeof t=="symbol"?t:t+""}function qte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gte(e){return e.dataKey}function Vte(e,t){return y.isValidElement(e)?y.cloneElement(e,t):typeof e=="function"?y.createElement(e,t):y.createElement(CY,t)}var r3=[],Yte={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function g1(e){var t,r,n=_n(e,Yte),{active:a,allowEscapeViewBox:i,animationDuration:s,animationEasing:o,content:c,filterNull:u,isAnimationActive:f,offset:d,payloadUniqBy:p,position:h,reverseDirection:m,useTranslate3d:g,wrapperStyle:x,cursor:b,shared:S,trigger:_,defaultIndex:E,portal:O,axisId:F}=n,M=jr(),C=typeof E=="number"?String(E):E;y.useEffect(()=>{M(WQ({shared:S,trigger:_,axisId:F,active:a,defaultIndex:C}))},[M,S,_,F,a,C]);var k=vm(),W=XE(),D=MQ(S),{activeIndex:j,isActive:H}=(t=yt(G=>Zee(G,D,_,C)))!==null&&t!==void 0?t:{},U=yt(G=>Jee(G,D,_,C)),Y=yt(G=>nP(G,D,_,C)),X=yt(G=>Xee(G,D,_,C)),Z=U,K=Ste(),z=(r=a??H)!==null&&r!==void 0?r:!1,[se,xe]=Q6([Z,z]),A=D==="axis"?Y:void 0;$te(D,_,X,A,j,z);var I=O??K;if(I==null||k==null||D==null)return null;var P=Z??r3;z||(P=r3),u&&P.length&&(P=Y6(P.filter(G=>G.value!=null&&(G.hide!==!0||n.includeHidden)),p,Gte));var L=P.length>0,R=y.createElement(DY,{allowEscapeViewBox:i,animationDuration:s,animationEasing:o,isAnimationActive:f,active:z,coordinate:X,hasPayload:L,offset:d,position:h,reverseDirection:m,useTranslate3d:g,viewBox:k,wrapperStyle:x,lastBoundingBox:se,innerRef:xe,hasPortalFromProps:!!O},Vte(c,t3(t3({},n),{},{payload:P,label:A,active:z,activeIndex:j,coordinate:X,accessibilityLayer:W})));return y.createElement(y.Fragment,null,P2.createPortal(R,I),z&&y.createElement(wte,{cursor:b,tooltipEventType:D,coordinate:X,payload:P,index:j}))}var gu=e=>null;gu.displayName="Cell";function Kte(e,t,r){return(t=Xte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xte(e){var t=Jte(e,"string");return typeof t=="symbol"?t:t+""}function Jte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Zte{constructor(t){Kte(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function n3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n3(Object(r),!0).forEach(function(n){ere(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ere(e,t,r){return(t=tre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tre(e){var t=rre(e,"string");return typeof t=="symbol"?t:t+""}function rre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nre={cacheSize:2e3,enableCache:!0},lP=Qte({},nre),a3=new Zte(lP.cacheSize),are={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},i3="recharts_measurement_span";function ire(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var s3=(e,t)=>{try{var r=document.getElementById(i3);r||(r=document.createElement("span"),r.setAttribute("id",i3),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,are,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Df=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||_m.isSsr)return{width:0,height:0};if(!lP.enableCache)return s3(t,r);var n=ire(t,r),a=a3.get(n);if(a)return a;var i=s3(t,r);return a3.set(n,i),i},cP;function sre(e,t,r){return(t=ore(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ore(e){var t=lre(e,"string");return typeof t=="symbol"?t:t+""}function lre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,l3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cre=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ure=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,fre={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},dre=["cm","mm","pt","pc","in","Q","px"];function hre(e){return dre.includes(e)}var Vc="NaN";function pre(e,t){return e*fre[t]}class Xn{static parse(t){var r,[,n,a]=(r=ure.exec(t))!==null&&r!==void 0?r:[];return n==null?Xn.NaN:new Xn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ts(t)&&(this.unit=""),r!==""&&!cre.test(r)&&(this.num=NaN,this.unit=""),hre(r)&&(this.num=pre(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Xn(NaN,""):new Xn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Xn(NaN,""):new Xn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Xn(NaN,""):new Xn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Xn(NaN,""):new Xn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ts(this.num)}}cP=Xn;sre(Xn,"NaN",new cP(NaN,""));function uP(e){if(e==null||e.includes(Vc))return Vc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=o3.exec(t))!==null&&r!==void 0?r:[],s=Xn.parse(n??""),o=Xn.parse(i??""),c=a==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return Vc;t=t.replace(o3,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,f,d,p]=(u=l3.exec(t))!==null&&u!==void 0?u:[],h=Xn.parse(f??""),m=Xn.parse(p??""),g=d==="+"?h.add(m):h.subtract(m);if(g.isNaN())return Vc;t=t.replace(l3,g.toString())}return t}var c3=/\(([^()]*)\)/;function mre(e){for(var t=e,r;(r=c3.exec(t))!=null;){var[,n]=r;t=t.replace(c3,uP(n))}return t}function gre(e){var t=e.replace(/\s+/g,"");return t=mre(t),t=uP(t),t}function xre(e){try{return gre(e)}catch{return Vc}}function x1(e){var t=xre(e.slice(5,-1));return t===Vc?"":t}var vre=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],yre=["dx","dy","angle","className","breakAll"];function e2(){return e2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e2.apply(null,arguments)}function u3(e,t){if(e==null)return{};var r,n,a=bre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fP=/[ \f\n\r\t\v\u2028\u2029]+/,dP=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Dr(t)||(r?a=t.toString().split(""):a=t.toString().split(fP));var i=a.map(o=>({word:o,width:Df(o,n).width})),s=r?0:Df(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}};function wre(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var hP=(e,t,r,n)=>e.reduce((a,i)=>{var{word:s,width:o}=i,c=a[a.length-1];if(c&&o!=null&&(t==null||n||c.width+o+r<Number(t)))c.words.push(s),c.width+=o+r;else{var u={words:[s],width:o};a.push(u)}return a},[]),pP=e=>e.reduce((t,r)=>t.width>r.width?t:r),Sre="…",f3=(e,t,r,n,a,i,s,o)=>{var c=e.slice(0,t),u=dP({breakAll:r,style:n,children:c+Sre});if(!u)return[!1,[]];var f=hP(u.wordsWithComputedWidth,i,s,o),d=f.length>a||pP(f).width>Number(i);return[d,f]},_re=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:c}=e,u=gt(i),f=String(s),d=hP(t,n,r,a);if(!u||a)return d;var p=d.length>i||pP(d).width>Number(n);if(!p)return d;for(var h=0,m=f.length-1,g=0,x;h<=m&&g<=f.length-1;){var b=Math.floor((h+m)/2),S=b-1,[_,E]=f3(f,S,c,o,i,n,r,a),[O]=f3(f,b,c,o,i,n,r,a);if(!_&&!O&&(h=b+1),_&&O&&(m=b-1),!_&&O){x=E;break}g++}return x||d},d3=e=>{var t=Dr(e)?[]:e.toString().split(fP);return[{words:t,width:void 0}]},Nre=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!_m.isSsr){var o,c,u=dP({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:f,spaceWidth:d}=u;o=f,c=d}else return d3(n);return _re({breakAll:i,children:n,maxLines:s,style:a},o,c,t,!!r)}return d3(n)},mP="#808080",Are={angle:0,breakAll:!1,capHeight:"0.71em",fill:mP,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},$m=y.forwardRef((e,t)=>{var r=_n(e,Are),{x:n,y:a,lineHeight:i,capHeight:s,fill:o,scaleToFit:c,textAnchor:u,verticalAnchor:f}=r,d=u3(r,vre),p=y.useMemo(()=>Nre({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:c,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,c,d.style,d.width]),{dx:h,dy:m,angle:g,className:x,breakAll:b}=d,S=u3(d,yre);if(!Ns(n)||!Ns(a)||p.length===0)return null;var _=Number(n)+(gt(h)?h:0),E=Number(a)+(gt(m)?m:0);if(!zr(_)||!zr(E))return null;var O;switch(f){case"start":O=x1("calc(".concat(s,")"));break;case"middle":O=x1("calc(".concat((p.length-1)/2," * -").concat(i," + (").concat(s," / 2))"));break;default:O=x1("calc(".concat(p.length-1," * -").concat(i,")"));break}var F=[];if(c){var M=p[0].width,{width:C}=d;F.push("scale(".concat(gt(C)&&gt(M)?C/M:1,")"))}return g&&F.push("rotate(".concat(g,", ").concat(_,", ").concat(E,")")),F.length&&(S.transform=F.join(" ")),y.createElement("text",e2({},Ta(S),{ref:t,x:_,y:E,className:rr("recharts-text",x),textAnchor:u,fill:o.includes("url")?mP:o}),p.map((k,W)=>{var D=k.words.join(b?"":" ");return y.createElement("tspan",{x:_,dy:W===0?O:i,key:"".concat(D,"-").concat(W)},D)}))});$m.displayName="Text";var jre=["labelRef"],kre=["content"];function h3(e,t){if(e==null)return{};var r,n,a=Ere(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ere(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function p3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p3(Object(r),!0).forEach(function(n){Cre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cre(e,t,r){return(t=Tre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tre(e){var t=Pre(e,"string");return typeof t=="symbol"?t:t+""}function Pre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ws(){return Ws=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ws.apply(null,arguments)}var gP=y.createContext(null),Ore=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s,children:o}=e,c=y.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s}),[t,r,n,a,i,s]);return y.createElement(gP.Provider,{value:c},o)},xP=()=>{var e=y.useContext(gP),t=vm();return e||RE(t)},Fre=y.createContext(null),Ire=()=>{var e=y.useContext(Fre),t=yt(lT);return e||t},Lre=e=>{var{value:t,formatter:r}=e,n=Dr(e.children)?t:e.children;return typeof r=="function"?r(n):n},aw=e=>e!=null&&typeof e=="function",Dre=(e,t)=>{var r=Wn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Mre=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:o,cy:c,innerRadius:u,outerRadius:f,startAngle:d,endAngle:p,clockWise:h}=a,m=(u+f)/2,g=Dre(d,p),x=g>=0?1:-1,b,S;switch(t){case"insideStart":b=d+x*i,S=h;break;case"insideEnd":b=p-x*i,S=!h;break;case"end":b=p+x*i,S=h;break;default:throw new Error("Unsupported position ".concat(t))}S=g<=0?S:!S;var _=bn(o,c,m,b),E=bn(o,c,m,b+(S?1:-1)*359),O="M".concat(_.x,",").concat(_.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(S?0:1,`,
    `).concat(E.x,",").concat(E.y),F=Dr(e.id)?Qf("recharts-radial-line-"):e.id;return y.createElement("text",Ws({},n,{dominantBaseline:"central",className:rr("recharts-radial-bar-label",s)}),y.createElement("defs",null,y.createElement("path",{id:F,d:O})),y.createElement("textPath",{xlinkHref:"#".concat(F)},r))},Rre=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:f,y:d}=bn(n,a,s+t,u);return{x:f,y:d,textAnchor:f>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(i+s)/2,{x:h,y:m}=bn(n,a,p,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},t2=e=>"cx"in e&&gt(e.cx),Bre=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!t2(r)&&(i=r);var{x:s,y:o,upperWidth:c,lowerWidth:u,height:f}=t,d=s,p=s+(c-u)/2,h=(d+p)/2,m=(c+u)/2,g=d+c/2,x=f>=0?1:-1,b=x*n,S=x>0?"end":"start",_=x>0?"start":"end",E=c>=0?1:-1,O=E*n,F=E>0?"end":"start",M=E>0?"start":"end";if(a==="top"){var C={x:d+c/2,y:o-b,textAnchor:"middle",verticalAnchor:S};return an(an({},C),i?{height:Math.max(o-i.y,0),width:c}:{})}if(a==="bottom"){var k={x:p+u/2,y:o+f+b,textAnchor:"middle",verticalAnchor:_};return an(an({},k),i?{height:Math.max(i.y+i.height-(o+f),0),width:u}:{})}if(a==="left"){var W={x:h-O,y:o+f/2,textAnchor:F,verticalAnchor:"middle"};return an(an({},W),i?{width:Math.max(W.x-i.x,0),height:f}:{})}if(a==="right"){var D={x:h+m+O,y:o+f/2,textAnchor:M,verticalAnchor:"middle"};return an(an({},D),i?{width:Math.max(i.x+i.width-D.x,0),height:f}:{})}var j=i?{width:m,height:f}:{};return a==="insideLeft"?an({x:h+O,y:o+f/2,textAnchor:M,verticalAnchor:"middle"},j):a==="insideRight"?an({x:h+m-O,y:o+f/2,textAnchor:F,verticalAnchor:"middle"},j):a==="insideTop"?an({x:d+c/2,y:o+b,textAnchor:"middle",verticalAnchor:_},j):a==="insideBottom"?an({x:p+u/2,y:o+f-b,textAnchor:"middle",verticalAnchor:S},j):a==="insideTopLeft"?an({x:d+O,y:o+b,textAnchor:M,verticalAnchor:_},j):a==="insideTopRight"?an({x:d+c-O,y:o+b,textAnchor:F,verticalAnchor:_},j):a==="insideBottomLeft"?an({x:p+O,y:o+f-b,textAnchor:M,verticalAnchor:S},j):a==="insideBottomRight"?an({x:p+u-O,y:o+f-b,textAnchor:F,verticalAnchor:S},j):a&&typeof a=="object"&&(gt(a.x)||eo(a.x))&&(gt(a.y)||eo(a.y))?an({x:s+ga(a.x,m),y:o+ga(a.y,f),textAnchor:"end",verticalAnchor:"end"},j):an({x:g,y:o+f/2,textAnchor:"middle",verticalAnchor:"middle"},j)},Ure={angle:0,offset:5,zIndex:wn.label,position:"middle",textBreakAll:!1};function Ro(e){var t=_n(e,Ure),{viewBox:r,position:n,value:a,children:i,content:s,className:o="",textBreakAll:c,labelRef:u}=t,f=Ire(),d=xP(),p=n==="center"?d:f??d,h,m,g;if(r==null?h=p:t2(r)?h=r:h=RE(r),!h||Dr(a)&&Dr(i)&&!y.isValidElement(s)&&typeof s!="function")return null;var x=an(an({},t),{},{viewBox:h});if(y.isValidElement(s)){var{labelRef:b}=x,S=h3(x,jre);return y.cloneElement(s,S)}if(typeof s=="function"){var{content:_}=x,E=h3(x,kre);if(m=y.createElement(s,E),y.isValidElement(m))return m}else m=Lre(t);var O=Ta(t);if(t2(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return Mre(t,n,m,O,h);g=Rre(h,t.offset,t.position)}else g=Bre(t,h);return y.createElement(Ha,{zIndex:t.zIndex},y.createElement($m,Ws({ref:u,className:rr("recharts-label",o)},O,g,{textAnchor:wre(O.textAnchor)?O.textAnchor:g.textAnchor,breakAll:c}),m))}Ro.displayName="Label";var zre=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?y.createElement(Ro,Ws({key:"label-implicit"},n)):Ns(e)?y.createElement(Ro,Ws({key:"label-implicit",value:e},n)):y.isValidElement(e)?e.type===Ro?y.cloneElement(e,an({key:"label-implicit"},n)):y.createElement(Ro,Ws({key:"label-implicit",content:e},n)):aw(e)?y.createElement(Ro,Ws({key:"label-implicit",content:e},n)):e&&typeof e=="object"?y.createElement(Ro,Ws({},e,{key:"label-implicit"},n)):null};function $re(e){var{label:t,labelRef:r}=e,n=xP();return zre(t,n,r)||null}var v1={},y1={},m3;function Wre(){return m3||(m3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(y1)),y1}var b1={},g3;function Hre(){return g3||(g3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(b1)),b1}var x3;function qre(){return x3||(x3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wre(),r=Hre(),n=Py();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(v1)),v1}var w1,v3;function Gre(){return v3||(v3=1,w1=qre().last),w1}var Vre=Gre();const Yre=lo(Vre);var Kre=["valueAccessor"],Xre=["dataKey","clockWise","id","textBreakAll","zIndex"];function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pp.apply(null,arguments)}function y3(e,t){if(e==null)return{};var r,n,a=Jre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Jre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zre=e=>Array.isArray(e.value)?Yre(e.value):e.value,vP=y.createContext(void 0),yP=vP.Provider,bP=y.createContext(void 0),Qre=bP.Provider;function ene(){return y.useContext(vP)}function tne(){return y.useContext(bP)}function _h(e){var{valueAccessor:t=Zre}=e,r=y3(e,Kre),{dataKey:n,clockWise:a,id:i,textBreakAll:s,zIndex:o}=r,c=y3(r,Xre),u=ene(),f=tne(),d=u||f;return!d||!d.length?null:y.createElement(Ha,{zIndex:o??wn.label},y.createElement(Hn,{className:"recharts-label-list"},d.map((p,h)=>{var m,g=Dr(n)?t(p,h):yr(p&&p.payload,n),x=Dr(i)?{}:{id:"".concat(i,"-").concat(h)};return y.createElement(Ro,Pp({key:"label-".concat(h)},Ta(p),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:p.fill,parentViewBox:p.parentViewBox,value:g,textBreakAll:s,viewBox:p.viewBox,index:h,zIndex:0}))})))}_h.displayName="LabelList";function iw(e){var{label:t}=e;return t?t===!0?y.createElement(_h,{key:"labelList-implicit"}):y.isValidElement(t)||aw(t)?y.createElement(_h,{key:"labelList-implicit",content:t}):typeof t=="object"?y.createElement(_h,Pp({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function r2(){return r2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r2.apply(null,arguments)}var wP=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=rr("recharts-dot",a);return gt(t)&&gt(r)&&gt(n)?y.createElement("circle",r2({},li(e),Ty(e),{className:i,cx:t,cy:r,r:n})):null},SP=e=>e.graphicalItems.polarItems,rne=Re([Mr,Bd],kb),Wm=Re([SP,$r,rne],Eb),nne=Re([Wm],Cb),Hm=Re([nne,Tm],Tb),ane=Re([Hm,$r,Wm],Ob);Re([Hm,$r,Wm],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=yr(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:yr(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var b3=()=>{},ine=Re([Hm,$r,Wm,Rm,Mr],Db),sne=Re([$r,Ib,Lb,b3,ine,b3,Jt,Mr],Mb),_P=Re([$r,Jt,Hm,ane,Rd,Mr,sne],Rb),one=Re([_P,$r,Cu],zb);Re([$r,_P,one,Mr],Wb);var lne={radiusAxis:{},angleAxis:{}},NP=Wa({name:"polarAxis",initialState:lne,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:kfe,removeRadiusAxis:Efe,addAngleAxis:Cfe,removeAngleAxis:Tfe}=NP.actions,cne=NP.reducer;function w3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w3(Object(r),!0).forEach(function(n){une(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function une(e,t,r){return(t=fne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fne(e){var t=dne(e,"string");return typeof t=="symbol"?t:t+""}function dne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hne=(e,t)=>t,sw=Re([SP,hne],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),pne=[],ow=(e,t,r)=>(r==null?void 0:r.length)===0?pne:r,AP=Re([Tm,sw,ow],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>S3(S3({},t.presentationProps),i.props))),a!=null)return a}}),mne=Re([AP,sw,ow],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=yr(n,t.nameKey,t.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:Su(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),gne=Re([AP,sw,ow,Cn],(e,t,r,n)=>{if(!(t==null||e==null))return vae({offset:n,pieSettings:t,displayedData:e,cells:r})}),S1={exports:{}},xr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _3;function xne(){if(_3)return xr;_3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.view_transition"),h=Symbol.for("react.client.reference");function m(g){if(typeof g=="object"&&g!==null){var x=g.$$typeof;switch(x){case e:switch(g=g.type,g){case r:case a:case n:case c:case u:case p:return g;default:switch(g=g&&g.$$typeof,g){case s:case o:case d:case f:return g;case i:return g;default:return x}}case t:return x}}}return xr.ContextConsumer=i,xr.ContextProvider=s,xr.Element=e,xr.ForwardRef=o,xr.Fragment=r,xr.Lazy=d,xr.Memo=f,xr.Portal=t,xr.Profiler=a,xr.StrictMode=n,xr.Suspense=c,xr.SuspenseList=u,xr.isContextConsumer=function(g){return m(g)===i},xr.isContextProvider=function(g){return m(g)===s},xr.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},xr.isForwardRef=function(g){return m(g)===o},xr.isFragment=function(g){return m(g)===r},xr.isLazy=function(g){return m(g)===d},xr.isMemo=function(g){return m(g)===f},xr.isPortal=function(g){return m(g)===t},xr.isProfiler=function(g){return m(g)===a},xr.isStrictMode=function(g){return m(g)===n},xr.isSuspense=function(g){return m(g)===c},xr.isSuspenseList=function(g){return m(g)===u},xr.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===c||g===u||typeof g=="object"&&g!==null&&(g.$$typeof===d||g.$$typeof===f||g.$$typeof===s||g.$$typeof===i||g.$$typeof===o||g.$$typeof===h||g.getModuleId!==void 0)},xr.typeOf=m,xr}var N3;function vne(){return N3||(N3=1,S1.exports=xne()),S1.exports}var yne=vne(),A3=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",j3=null,_1=null,jP=e=>{if(e===j3&&Array.isArray(_1))return _1;var t=[];return y.Children.forEach(e,r=>{Dr(r)||(yne.isFragment(r)?t=t.concat(jP(r.props.children)):t.push(r))}),_1=t,j3=e,t};function lw(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>A3(a)):n=[A3(t)],jP(e).forEach(a=>{var i=Gl(a,"type.displayName")||Gl(a,"type.name");i&&n.indexOf(i)!==-1&&r.push(a)}),r}var kP=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,N1={},k3;function bne(){return k3||(k3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(N1)),N1}var A1,E3;function wne(){return E3||(E3=1,A1=bne().isPlainObject),A1}var Sne=wne();const _ne=lo(Sne);var C3,T3,P3,O3,F3;function I3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function L3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I3(Object(r),!0).forEach(function(n){Nne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nne(e,t,r){return(t=Ane(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ane(e){var t=jne(e,"string");return typeof t=="symbol"?t:t+""}function jne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Op(){return Op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Op.apply(null,arguments)}function vf(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var D3=(e,t,r,n,a)=>{var i=r-n,s;return s=Vr(C3||(C3=vf(["M ",",",""])),e,t),s+=Vr(T3||(T3=vf(["L ",",",""])),e+r,t),s+=Vr(P3||(P3=vf(["L ",",",""])),e+r-i/2,t+a),s+=Vr(O3||(O3=vf(["L ",",",""])),e+r-i/2-n,t+a),s+=Vr(F3||(F3=vf(["L ",","," Z"])),e,t),s},kne={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ene=e=>{var t=_n(e,kne),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:f,isUpdateAnimationActive:d}=t,p=y.useRef(null),[h,m]=y.useState(-1),g=y.useRef(a),x=y.useRef(i),b=y.useRef(s),S=y.useRef(r),_=y.useRef(n),E=Fd(e,"trapezoid-");if(y.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var U=p.current.getTotalLength();U&&m(U)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var O=rr("recharts-trapezoid",o);if(!d)return y.createElement("g",null,y.createElement("path",Op({},Ta(t),{className:O,d:D3(r,n,a,i,s)})));var F=g.current,M=x.current,C=b.current,k=S.current,W=_.current,D="0px ".concat(h===-1?1:h,"px"),j="".concat(h,"px 0px"),H=JE(["strokeDasharray"],u,c);return y.createElement(Od,{animationId:E,key:E,canBegin:h>0,duration:u,easing:c,isActive:d,begin:f},U=>{var Y=Ir(F,a,U),X=Ir(M,i,U),Z=Ir(C,s,U),K=Ir(k,r,U),z=Ir(W,n,U);p.current&&(g.current=Y,x.current=X,b.current=Z,S.current=K,_.current=z);var se=U>0?{transition:H,strokeDasharray:j}:{strokeDasharray:D};return y.createElement("path",Op({},Ta(t),{className:O,d:D3(K,z,Y,X,Z),ref:p,style:L3(L3({},se),t.style)}))})},Cne=["option","shapeType","activeClassName"];function Tne(e,t){if(e==null)return{};var r,n,a=Pne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Pne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function M3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M3(Object(r),!0).forEach(function(n){One(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function One(e,t,r){return(t=Fne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fne(e){var t=Ine(e,"string");return typeof t=="symbol"?t:t+""}function Ine(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lne(e,t){return Fp(Fp({},t),e)}function Dne(e,t){return e==="symbols"}function R3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return y.createElement(tC,r);case"trapezoid":return y.createElement(Ene,r);case"sector":return y.createElement(iC,r);case"symbols":if(Dne(t))return y.createElement(Cy,r);break;case"curve":return y.createElement(Gy,r);default:return null}}function Mne(e){return y.isValidElement(e)?e.props:e}function cw(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=Tne(e,Cne),i;if(y.isValidElement(t))i=y.cloneElement(t,Fp(Fp({},a),Mne(t)));else if(typeof t=="function")i=t(a,a.index);else if(_ne(t)&&typeof t!="boolean"){var s=Lne(t,a);i=y.createElement(R3,{shapeType:r,elementProps:s})}else{var o=a;i=y.createElement(R3,{shapeType:r,elementProps:o})}return a.isActive?y.createElement(Hn,{className:n},i):i}var uw=(e,t,r)=>{var n=jr();return(a,i)=>s=>{e==null||e(a,i,s),n(BT({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},fw=e=>{var t=jr();return(r,n)=>a=>{e==null||e(r,n,a),t(HQ())}},dw=(e,t,r)=>{var n=jr();return(a,i)=>s=>{e==null||e(a,i,s),n(qQ({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function hw(e){var{tooltipEntrySettings:t}=e,r=jr(),n=ya(),a=y.useRef(null);return y.useLayoutEffect(()=>{n||(a.current===null?r(UQ(t)):a.current!==t&&r(zQ({prev:a.current,next:t})),a.current=t)},[t,r,n]),y.useLayoutEffect(()=>()=>{a.current&&(r($Q(a.current)),a.current=null)},[r]),null}function EP(e){var{legendPayload:t}=e,r=jr(),n=ya(),a=y.useRef(null);return y.useLayoutEffect(()=>{n||(a.current===null?r(VE(t)):a.current!==t&&r(YE({prev:a.current,next:t})),a.current=t)},[r,n,t]),y.useLayoutEffect(()=>()=>{a.current&&(r(KE(a.current)),a.current=null)},[r]),null}function Rne(e){var{legendPayload:t}=e,r=jr(),n=yt(Jt),a=y.useRef(null);return y.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(VE(t)):a.current!==t&&r(YE({prev:a.current,next:t})),a.current=t)},[r,n,t]),y.useLayoutEffect(()=>()=>{a.current&&(r(KE(a.current)),a.current=null)},[r]),null}var j1,Bne=()=>{var[e]=y.useState(()=>Qf("uid-"));return e},Une=(j1=MO.useId)!==null&&j1!==void 0?j1:Bne;function zne(e,t){var r=Une();return t||(e?"".concat(e,"-").concat(r):r)}var $ne=y.createContext(void 0),pw=e=>{var{id:t,type:r,children:n}=e,a=zne("recharts-".concat(r),t);return y.createElement($ne.Provider,{value:a},n(a))},Wne={cartesianItems:[],polarItems:[]},CP=Wa({name:"graphicalItems",initialState:Wne,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Fr()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=es(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Fr()},removeCartesianGraphicalItem:{reducer(e,t){var r=es(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Fr()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Fr()},removePolarGraphicalItem:{reducer(e,t){var r=es(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Fr()}}}),{addCartesianGraphicalItem:Hne,replaceCartesianGraphicalItem:qne,removeCartesianGraphicalItem:Gne,addPolarGraphicalItem:Vne,removePolarGraphicalItem:Yne}=CP.actions,Kne=CP.reducer,Xne=e=>{var t=jr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(Hne(e)):r.current!==e&&t(qne({prev:r.current,next:e})),r.current=e},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(t(Gne(r.current)),r.current=null)},[t]),null},TP=y.memo(Xne);function Jne(e){var t=jr();return y.useLayoutEffect(()=>(t(Vne(e)),()=>{t(Yne(e))}),[t,e]),null}var Zne=["key"],Qne=["onMouseEnter","onClick","onMouseLeave"],eae=["id"],tae=["id"];function B3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B3(Object(r),!0).forEach(function(n){rae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rae(e,t,r){return(t=nae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nae(e){var t=aae(e,"string");return typeof t=="symbol"?t:t+""}function aae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qo.apply(null,arguments)}function qm(e,t){if(e==null)return{};var r,n,a=iae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function sae(e){var t=y.useMemo(()=>lw(e.children,gu),[e.children]),r=yt(n=>mne(n,e.id,t));return r==null?null:y.createElement(Rne,{legendPayload:r})}var oae=y.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:c,tooltipType:u,id:f}=e,d={dataDefinedOnItem:n.map(p=>p.tooltipPayload),positions:n.map(p=>p.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Su(o,t),hide:c,type:u,color:s,unit:"",graphicalItemId:f}};return y.createElement(hw,{tooltipEntrySettings:d})}),lae=(e,t)=>e>t?"start":e<t?"end":"middle",cae=(e,t,r)=>ga(typeof t=="function"?t(e):t,r,r*.8),uae=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,o=rC(i,s),c=a+ga(e.cx,i,i/2),u=n+ga(e.cy,s,s/2),f=ga(e.innerRadius,o,0),d=cae(r,e.outerRadius,o),p=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:f,outerRadius:d,maxRadius:p}},fae=(e,t)=>{var r=Wn(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function dae(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var hae=(e,t)=>{if(y.isValidElement(e))return y.cloneElement(e,t);if(typeof e=="function")return e(t);var r=rr("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=qm(t,Zne);return y.createElement(Gy,Qo({},a,{type:"linear",className:r}))},pae=(e,t,r)=>{if(y.isValidElement(e))return y.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),y.isValidElement(n)))return n;var a=rr("recharts-pie-label-text",dae(e));return y.createElement($m,Qo({},t,{alignmentBaseline:"middle",className:a}),n)};function mae(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var o=li(r),c=Hl(a),u=Hl(i),f=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,d=t.map((p,h)=>{var m=(p.startAngle+p.endAngle)/2,g=bn(p.cx,p.cy,p.outerRadius+f,m),x=Kr(Kr(Kr(Kr({},o),p),{},{stroke:"none"},c),{},{index:h,textAnchor:lae(g.x,p.cx)},g),b=Kr(Kr(Kr(Kr({},o),p),{},{fill:"none",stroke:p.fill},u),{},{index:h,points:[bn(p.cx,p.cy,p.outerRadius,m),g],key:"line"});return y.createElement(Ha,{zIndex:wn.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(h)},y.createElement(Hn,null,i&&hae(i,b),pae(a,x,yr(p,s))))});return y.createElement(Hn,{className:"recharts-pie-labels"},d)}function gae(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?y.createElement(iw,{label:a}):y.createElement(mae,{sectors:t,props:r,showLabels:n})}function xae(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:i,id:s}=e,o=yt(Zo),c=yt(Zb),u=yt(Tee),{onMouseEnter:f,onClick:d,onMouseLeave:p}=a,h=qm(a,Qne),m=uw(f,a.dataKey,s),g=fw(p),x=dw(d,a.dataKey,s);return t==null||t.length===0?null:y.createElement(y.Fragment,null,t.map((b,S)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var _=u==null||u===s,E=String(S)===o&&(c==null||a.dataKey===c)&&_,O=o?n:null,F=r&&E?r:O,M=Kr(Kr({},b),{},{stroke:b.stroke,tabIndex:-1,[FE]:S,[IE]:s});return y.createElement(Hn,Qo({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(S),tabIndex:-1,className:"recharts-pie-sector"},kd(h,b,S),{onMouseEnter:m(b,S),onMouseLeave:g(b,S),onClick:x(b,S)}),y.createElement(cw,Qo({option:i??F,index:S,shapeType:"sector",isActive:E},M)))}))}function vae(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:o,endAngle:c,dataKey:u,nameKey:f,tooltipType:d}=r,p=Math.abs(r.minAngle),h=fae(o,c),m=Math.abs(h),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,x=n.filter(F=>yr(F,u,0)!==0).length,b=(m>=360?x:x-1)*g,S=m-x*p-b,_=n.reduce((F,M)=>{var C=yr(M,u,0);return F+(gt(C)?C:0)},0),E;if(_>0){var O;E=n.map((F,M)=>{var C=yr(F,u,0),k=yr(F,f,M),W=uae(r,i,F),D=(gt(C)?C:0)/_,j,H=Kr(Kr({},F),a&&a[M]&&a[M].props);M?j=O.endAngle+Wn(h)*g*(C!==0?1:0):j=o;var U=j+Wn(h)*((C!==0?p:0)+D*S),Y=(j+U)/2,X=(W.innerRadius+W.outerRadius)/2,Z=[{name:k,value:C,payload:H,dataKey:u,type:d,graphicalItemId:r.id}],K=bn(W.cx,W.cy,X,Y);return O=Kr(Kr(Kr(Kr({},r.presentationProps),{},{percent:D,cornerRadius:typeof s=="string"?parseFloat(s):s,name:k,tooltipPayload:Z,midAngle:Y,middleRadius:X,tooltipPosition:K},H),W),{},{value:C,dataKey:u,startAngle:j,endAngle:U,payload:H,paddingAngle:Wn(h)*g}),O})}return E}function yae(e){var{showLabels:t,sectors:r,children:n}=e,a=y.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return y.createElement(Qre,{value:t?a:void 0},n)}function bae(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:c,activeShape:u,inactiveShape:f,onAnimationStart:d,onAnimationEnd:p}=t,h=Fd(t,"recharts-pie-"),m=r.current,[g,x]=y.useState(!1),b=y.useCallback(()=>{typeof p=="function"&&p(),x(!1)},[p]),S=y.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return y.createElement(yae,{showLabels:!g,sectors:a},y.createElement(Od,{animationId:h,begin:s,duration:o,isActive:i,easing:c,onAnimationStart:S,onAnimationEnd:b,key:h},_=>{var E=[],O=a&&a[0],F=O==null?void 0:O.startAngle;return a==null||a.forEach((M,C)=>{var k=m&&m[C],W=C>0?Gl(M,"paddingAngle",0):0;if(k){var D=Ir(k.endAngle-k.startAngle,M.endAngle-M.startAngle,_),j=Kr(Kr({},M),{},{startAngle:F+W,endAngle:F+D+W});E.push(j),F=j.endAngle}else{var{endAngle:H,startAngle:U}=M,Y=Ir(0,H-U,_),X=Kr(Kr({},M),{},{startAngle:F+W,endAngle:F+Y+W});E.push(X),F=X.endAngle}}),r.current=E,y.createElement(Hn,null,y.createElement(xae,{sectors:E,activeShape:u,inactiveShape:f,allOtherPieProps:t,shape:t.shape,id:n}))}),y.createElement(gae,{showLabels:!g,sectors:a,props:t}),t.children)}var wae={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:wn.area};function Sae(e){var{id:t}=e,r=qm(e,eae),{hide:n,className:a,rootTabIndex:i}=e,s=y.useMemo(()=>lw(e.children,gu),[e.children]),o=yt(f=>gne(f,t,s)),c=y.useRef(null),u=rr("recharts-pie",a);return n||o==null?(c.current=null,y.createElement(Hn,{tabIndex:i,className:u})):y.createElement(Ha,{zIndex:e.zIndex},y.createElement(oae,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:o,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),y.createElement(Hn,{tabIndex:i,className:u},y.createElement(bae,{props:Kr(Kr({},r),{},{sectors:o}),previousSectorsRef:c,id:t})))}function n2(e){var t=_n(e,wae),{id:r}=t,n=qm(t,tae),a=li(n);return y.createElement(pw,{id:r,type:"pie"},i=>y.createElement(y.Fragment,null,y.createElement(Jne,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),y.createElement(sae,Qo({},n,{id:i})),y.createElement(Sae,Qo({},n,{id:i}))))}n2.displayName="Pie";var _ae=["points"];function U3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U3(Object(r),!0).forEach(function(n){Nae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nae(e,t,r){return(t=Aae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aae(e){var t=jae(e,"string");return typeof t=="symbol"?t:t+""}function jae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ip.apply(null,arguments)}function kae(e,t){if(e==null)return{};var r,n,a=Eae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Eae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Cae(e){var{option:t,dotProps:r,className:n}=e;if(y.isValidElement(t))return y.cloneElement(t,r);if(typeof t=="function")return t(r);var a=rr(n,typeof t!="boolean"?t.className:""),i=r??{},{points:s}=i,o=kae(i,_ae);return y.createElement(wP,Ip({},o,{className:a}))}function Tae(e,t){return e==null?!1:t?!0:e.length===1}function Pae(e){var{points:t,dot:r,className:n,dotClassName:a,dataKey:i,baseProps:s,needClip:o,clipPathId:c,zIndex:u=wn.scatter}=e;if(!Tae(t,r))return null;var f=kP(r),d=GW(r),p=t.map((m,g)=>{var x,b,S=k1(k1(k1({r:3},s),d),{},{index:g,cx:(x=m.x)!==null&&x!==void 0?x:void 0,cy:(b=m.y)!==null&&b!==void 0?b:void 0,dataKey:i,value:m.value,payload:m.payload,points:t});return y.createElement(Cae,{key:"dot-".concat(g),option:r,dotProps:S,className:a})}),h={};return o&&c!=null&&(h.clipPath="url(#clipPath-".concat(f?"":"dots-").concat(c,")")),y.createElement(Ha,{zIndex:u},y.createElement(Hn,Ip({className:n},h),p))}function z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z3(Object(r),!0).forEach(function(n){Oae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oae(e,t,r){return(t=Fae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fae(e){var t=Iae(e,"string");return typeof t=="symbol"?t:t+""}function Iae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PP=0,Lae={xAxis:{},yAxis:{},zAxis:{}},OP=Wa({name:"cartesianAxis",initialState:Lae,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Fr()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:Fr()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Fr()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Fr()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:Fr()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Fr()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Fr()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:Fr()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Fr()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=$3($3({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:Dae,replaceXAxis:Mae,removeXAxis:Rae,addYAxis:Bae,replaceYAxis:Uae,removeYAxis:zae,addZAxis:Pfe,replaceZAxis:Ofe,removeZAxis:Ffe,updateYAxisWidth:$ae}=OP.actions,Wae=OP.reducer,Hae=Re([Cn],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),qae=Re([Hae,ho,po],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),mw=()=>yt(qae),Gae=()=>yt(Lee);function W3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W3(Object(r),!0).forEach(function(n){Vae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vae(e,t,r){return(t=Yae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yae(e){var t=Kae(e,"string");return typeof t=="symbol"?t:t+""}function Kae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xae=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i,clipPath:s}=e;if(a===!1||t.x==null||t.y==null)return null;var o={index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=E1(E1(E1({},o),Hl(a)),Ty(a)),u;return y.isValidElement(a)?u=y.cloneElement(a,c):typeof a=="function"?u=a(c):u=y.createElement(wP,c),y.createElement(Hn,{className:"recharts-active-dot",clipPath:s},u)};function Jae(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a,clipPath:i,zIndex:s=wn.activeDot}=e,o=yt(Zo),c=Gae();if(t==null||c==null)return null;var u=t.find(f=>c.includes(f.payload));return Dr(u)?null:y.createElement(Ha,{zIndex:s},y.createElement(Xae,{point:u,childIndex:Number(o),mainColor:r,dataKey:a,activeDot:n,clipPath:i}))}var H3=(e,t,r)=>{var n=r??e;if(!Dr(n))return ga(n,t,0)},Zae=(e,t,r)=>{var n={},a=e.filter(Fm),i=e.filter(u=>u.stackId==null),s=a.reduce((u,f)=>(u[f.stackId]||(u[f.stackId]=[]),u[f.stackId].push(f),u),n),o=Object.entries(s).map(u=>{var[f,d]=u,p=d.map(m=>m.dataKey),h=H3(t,r,d[0].barSize);return{stackId:f,dataKeys:p,barSize:h}}),c=i.map(u=>{var f=[u.dataKey].filter(p=>p!=null),d=H3(t,r,u.barSize);return{stackId:void 0,dataKeys:f,barSize:d}});return[...o,...c]};function q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q3(Object(r),!0).forEach(function(n){Qae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qae(e,t,r){return(t=eie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eie(e){var t=tie(e,"string");return typeof t=="symbol"?t:t+""}function tie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rie(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=ga(e,r,0,!0),o,c=[];if(zr(n[0].barSize)){var u=!1,f=r/i,d=n.reduce((b,S)=>b+(S.barSize||0),0);d+=(i-1)*s,d>=r&&(d-=(i-1)*s,s=0),d>=r&&f>0&&(u=!0,f*=.9,d=i*f);var p=(r-d)/2>>0,h={offset:p-s,size:0};o=n.reduce((b,S)=>{var _,E={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:h.offset+h.size+s,size:u?f:(_=S.barSize)!==null&&_!==void 0?_:0}},O=[...b,E];return h=O[O.length-1].position,O},c)}else{var m=ga(t,r,0,!0);r-2*m-(i-1)*s<=0&&(s=0);var g=(r-2*m-(i-1)*s)/i;g>1&&(g>>=0);var x=zr(a)?Math.min(g,a):g;o=n.reduce((b,S,_)=>[...b,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:m+(g+s)*_+(g-x)/2,size:x}}],c)}return o}}var nie=(e,t,r,n,a,i,s)=>{var o=Dr(s)?t:s,c=rie(r,n,a!==i?a:i,e,o);return a!==i&&c!=null&&(c=c.map(u=>fh(fh({},u),{},{position:fh(fh({},u.position),{},{offset:u.position.offset-a/2})}))),c},aie=(e,t)=>{var r=Ab(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}};function iie(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&zr(e.zIndex)?e.zIndex:t}var FP=e=>{var{chartData:t}=e,r=jr(),n=ya();return y.useEffect(()=>n?()=>{}:(r(ZN(t)),()=>{r(ZN(void 0))}),[t,r,n]),null},G3={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},IP=Wa({name:"brush",initialState:G3,reducers:{setBrushSettings(e,t){return t.payload==null?G3:t.payload}}}),{setBrushSettings:Ife}=IP.actions,sie=IP.reducer;function oie(e,t,r){return(t=lie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lie(e){var t=cie(e,"string");return typeof t=="symbol"?t:t+""}function cie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class gw{static create(t){return new gw(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}oie(gw,"EPS",1e-4);function uie(e){return(e%180+180)%180}var fie=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=uie(a),s=i*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},die={dots:[],areas:[],lines:[]},LP=Wa({name:"referenceElements",initialState:die,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=es(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=es(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=es(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Lfe,removeDot:Dfe,addArea:Mfe,removeArea:Rfe,addLine:Bfe,removeLine:Ufe}=LP.actions,hie=LP.reducer,pie=y.createContext(void 0),mie=e=>{var{children:t}=e,[r]=y.useState("".concat(Qf("recharts"),"-clip")),n=mw();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return y.createElement(pie.Provider,{value:r},y.createElement("defs",null,y.createElement("clipPath",{id:r},y.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function DP(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function gie(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return fie(n,r)}function xie(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:o}=e;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function hd(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function vie(e,t){return DP(e,t+1)}function yie(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:o}=t,c=0,u=1,f=s,d=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:DP(n,u)};var g=c,x,b=()=>(x===void 0&&(x=r(m,g)),x),S=m.coordinate,_=c===0||hd(e,S,b,f,o);_||(c=0,f=s,u+=1),_&&(f=S+e*(b()/2+a),c+=u)},p;u<=i.length;)if(p=d(),p)return p.v;return[]}function bie(e,t,r,n,a){var i=(n||[]).slice(),s=i.length;if(s===0)return[];for(var{start:o,end:c}=t,u=1;u<=s;u++){for(var f=(s-1)%u,d=o,p=!0,h=function(){var S=n[m],_=m,E,O=()=>(E===void 0&&(E=r(S,_)),E),F=S.coordinate,M=m===f||hd(e,F,O,d,c);if(!M)return p=!1,1;M&&(d=F+e*(O()/2+a))},m=f;m<s&&!h();m+=u);if(p){for(var g=[],x=f;x<s;x+=u)g.push(n[x]);return g}}return[]}function V3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(r),!0).forEach(function(n){wie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wie(e,t,r){return(t=Sie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sie(e){var t=_ie(e,"string");return typeof t=="symbol"?t:t+""}function _ie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nie(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:o}=t,{end:c}=t,u=function(p){var h=i[p],m,g=()=>(m===void 0&&(m=r(h,p)),m);if(p===s-1){var x=e*(h.coordinate+e*g()/2-c);i[p]=h=oa(oa({},h),{},{tickCoord:x>0?h.coordinate-x*e:h.coordinate})}else i[p]=h=oa(oa({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var b=hd(e,h.tickCoord,g,o,c);b&&(c=h.tickCoord-e*(g()/2+a),i[p]=oa(oa({},h),{},{isShow:!0}))}},f=s-1;f>=0;f--)u(f);return i}function Aie(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,{start:c,end:u}=t;if(i){var f=n[o-1],d=r(f,o-1),p=e*(f.coordinate+e*d/2-u);if(s[o-1]=f=oa(oa({},f),{},{tickCoord:p>0?f.coordinate-p*e:f.coordinate}),f.tickCoord!=null){var h=hd(e,f.tickCoord,()=>d,c,u);h&&(u=f.tickCoord-e*(d/2+a),s[o-1]=oa(oa({},f),{},{isShow:!0}))}}for(var m=i?o-1:o,g=function(S){var _=s[S],E,O=()=>(E===void 0&&(E=r(_,S)),E);if(S===0){var F=e*(_.coordinate-e*O()/2-c);s[S]=_=oa(oa({},_),{},{tickCoord:F<0?_.coordinate-F*e:_.coordinate})}else s[S]=_=oa(oa({},_),{},{tickCoord:_.coordinate});if(_.tickCoord!=null){var M=hd(e,_.tickCoord,O,c,u);M&&(c=_.tickCoord+e*(O()/2+a),s[S]=oa(oa({},_),{},{isShow:!0}))}},x=0;x<m;x++)g(x);return s}function xw(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:o,interval:c,tickFormatter:u,unit:f,angle:d}=e;if(!a||!a.length||!n)return[];if(gt(c)||_m.isSsr){var p;return(p=vie(a,gt(c)?c:0))!==null&&p!==void 0?p:[]}var h=[],m=o==="top"||o==="bottom"?"width":"height",g=f&&m==="width"?Df(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},x=(_,E)=>{var O=typeof u=="function"?u(_.value,E):_.value;return m==="width"?gie(Df(O,{fontSize:t,letterSpacing:r}),g,d):Df(O,{fontSize:t,letterSpacing:r})[m]},b=a.length>=2?Wn(a[1].coordinate-a[0].coordinate):1,S=xie(i,b,m);return c==="equidistantPreserveStart"?yie(b,S,x,a,s):c==="equidistantPreserveEnd"?bie(b,S,x,a,s):(c==="preserveStart"||c==="preserveStartEnd"?h=Aie(b,S,x,a,s,c==="preserveStartEnd"):h=Nie(b,S,x,a,s),h.filter(_=>_.isShow))}var jie=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(f=>{if(f){var d=f.getBoundingClientRect();d.width>s&&(s=d.width)}});var o=r?r.getBoundingClientRect().width:0,c=a+i,u=s+c+o+(r?n:0);return Math.round(u)}return 0},kie=["axisLine","width","height","className","hide","ticks","axisType"];function Eie(e,t){if(e==null)return{};var r,n,a=Cie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Cie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Jl(){return Jl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jl.apply(null,arguments)}function Y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y3(Object(r),!0).forEach(function(n){Tie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tie(e,t,r){return(t=Pie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pie(e){var t=Oie(e,"string");return typeof t=="symbol"?t:t+""}function Oie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zs={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:wn.axis};function Fie(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=yn(yn(yn({},c),li(o)),{},{fill:"none"});if(i==="top"||i==="bottom"){var f=+(i==="top"&&!s||i==="bottom"&&s);u=yn(yn({},u),{},{x1:t,y1:r+f*a,x2:t+n,y2:r+f*a})}else{var d=+(i==="left"&&!s||i==="right"&&s);u=yn(yn({},u),{},{x1:t+d*n,y1:r,x2:t+d*n,y2:r+a})}return y.createElement("line",Jl({},u,{className:rr("recharts-cartesian-axis-line",Gl(o,"className"))}))}function Iie(e,t,r,n,a,i,s,o,c){var u,f,d,p,h,m,g=o?-1:1,x=e.tickSize||s,b=gt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=f=e.coordinate,p=r+ +!o*a,d=p-g*x,m=d-g*c,h=b;break;case"left":d=p=e.coordinate,f=t+ +!o*n,u=f-g*x,h=u-g*c,m=b;break;case"right":d=p=e.coordinate,f=t+ +o*n,u=f+g*x,h=u+g*c,m=b;break;default:u=f=e.coordinate,p=r+ +o*a,d=p+g*x,m=d+g*c,h=b;break}return{line:{x1:u,y1:d,x2:f,y2:p},tick:{x:h,y:m}}}function Lie(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Die(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Mie(e){var{option:t,tickProps:r,value:n}=e,a,i=rr(r.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(t))a=y.cloneElement(t,yn(yn({},r),{},{className:i}));else if(typeof t=="function")a=t(yn(yn({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=rr(s,t==null?void 0:t.className)),a=y.createElement($m,Jl({},r,{className:s}),n)}return a}var Rie=y.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:i,tickFormatter:s,unit:o,padding:c,tickTextProps:u,orientation:f,mirror:d,x:p,y:h,width:m,height:g,tickSize:x,tickMargin:b,fontSize:S,letterSpacing:_,getTicksConfig:E,events:O,axisType:F}=e,M=xw(yn(yn({},E),{},{ticks:r}),S,_),C=Lie(f,d),k=Die(f,d),W=li(E),D=Hl(n),j={};typeof a=="object"&&(j=a);var H=yn(yn({},W),{},{fill:"none"},j),U=M.map(Z=>yn({entry:Z},Iie(Z,p,h,m,g,f,x,d,b))),Y=U.map(Z=>{var{entry:K,line:z}=Z;return y.createElement(Hn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(K.value,"-").concat(K.coordinate,"-").concat(K.tickCoord)},a&&y.createElement("line",Jl({},H,z,{className:rr("recharts-cartesian-axis-tick-line",Gl(a,"className"))})))}),X=U.map((Z,K)=>{var{entry:z,tick:se}=Z,xe=yn(yn(yn(yn({textAnchor:C,verticalAnchor:k},W),{},{stroke:"none",fill:i},D),se),{},{index:K,payload:z,visibleTicksCount:M.length,tickFormatter:s,padding:c},u);return y.createElement(Hn,Jl({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},kd(O,z,K)),n&&y.createElement(Mie,{option:n,tickProps:xe,value:"".concat(typeof s=="function"?s(z.value,K):z.value).concat(o||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(F,"-ticks")},X.length>0&&y.createElement(Ha,{zIndex:wn.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(F,"-tick-labels"),ref:t},X)),Y.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(F,"-tick-lines")},Y))}),Bie=y.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:o,axisType:c}=e,u=Eie(e,kie),[f,d]=y.useState(""),[p,h]=y.useState(""),m=y.useRef(null);y.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var x;return jie({ticks:m.current,label:(x=e.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=y.useCallback(x=>{if(x){var b=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=b;var S=b[0];if(S){var _=window.getComputedStyle(S),E=_.fontSize,O=_.letterSpacing;(E!==f||O!==p)&&(d(E),h(O))}}},[f,p]);return s||n!=null&&n<=0||a!=null&&a<=0?null:y.createElement(Ha,{zIndex:e.zIndex},y.createElement(Hn,{className:rr("recharts-cartesian-axis",i)},y.createElement(Fie,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:li(e)}),y.createElement(Rie,{ref:g,axisType:c,events:u,fontSize:f,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:o,unit:e.unit,width:e.width,x:e.x,y:e.y}),y.createElement(Ore,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},y.createElement($re,{label:e.label,labelRef:e.labelRef}),e.children)))}),vw=y.forwardRef((e,t)=>{var r=_n(e,Zs);return y.createElement(Bie,Jl({},r,{ref:t}))});vw.displayName="CartesianAxis";var Uie=["x1","y1","x2","y2","key"],zie=["offset"],$ie=["xAxisId","yAxisId"],Wie=["xAxisId","yAxisId"];function K3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K3(Object(r),!0).forEach(function(n){Hie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hie(e,t,r){return(t=qie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qie(e){var t=Gie(e,"string");return typeof t=="symbol"?t:t+""}function Gie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cl(){return Cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cl.apply(null,arguments)}function Lp(e,t){if(e==null)return{};var r,n,a=Vie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Yie=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:o}=e;return y.createElement("rect",{x:n,y:a,ry:o,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function MP(e){var{option:t,lineItemProps:r}=e,n;if(y.isValidElement(t))n=y.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:i,y1:s,x2:o,y2:c,key:u}=r,f=Lp(r,Uie),d=(a=li(f))!==null&&a!==void 0?a:{},{offset:p}=d,h=Lp(d,zie);n=y.createElement("line",Cl({},h,{x1:i,y1:s,x2:o,y2:c,fill:"none",key:u}))}return n}function Kie(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,o=Lp(e,$ie),c=a.map((u,f)=>{var d=fa(fa({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(f),index:f});return y.createElement(MP,{key:"line-".concat(f),option:n,lineItemProps:d})});return y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Xie(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,o=Lp(e,Wie),c=a.map((u,f)=>{var d=fa(fa({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(f),index:f});return y.createElement(MP,{option:n,lineItemProps:d,key:"line-".concat(f)})});return y.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Jie(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length||o==null)return null;var u=o.map(d=>Math.round(d+a-a)).sort((d,p)=>d-p);a!==u[0]&&u.unshift(0);var f=u.map((d,p)=>{var h=!u[p+1],m=h?a+s-d:u[p+1]-d;if(m<=0)return null;var g=p%t.length;return y.createElement("rect",{key:"react-".concat(p),y:d,x:n,height:m,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Zie(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(d=>Math.round(d+a-a)).sort((d,p)=>d-p);a!==u[0]&&u.unshift(0);var f=u.map((d,p)=>{var h=!u[p+1],m=h?a+s-d:u[p+1]-d;if(m<=0)return null;var g=p%r.length;return y.createElement("rect",{key:"react-".concat(p),x:d,y:i,width:m,height:o,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Qie=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return TE(xw(fa(fa(fa({},Zs),r),{},{ticks:PE(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},ese=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return TE(xw(fa(fa(fa({},Zs),r),{},{ticks:PE(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},tse={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:wn.grid};function a2(e){var t=$y(),r=Wy(),n=BE(),a=fa(fa({},_n(e,tse)),{},{x:gt(e.x)?e.x:n.left,y:gt(e.y)?e.y:n.top,width:gt(e.width)?e.width:n.width,height:gt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:o,y:c,width:u,height:f,syncWithTicks:d,horizontalValues:p,verticalValues:h}=a,m=ya(),g=yt(k=>UN(k,"xAxis",i,m)),x=yt(k=>UN(k,"yAxis",s,m));if(!As(u)||!As(f)||!gt(o)||!gt(c))return null;var b=a.verticalCoordinatesGenerator||Qie,S=a.horizontalCoordinatesGenerator||ese,{horizontalPoints:_,verticalPoints:E}=a;if((!_||!_.length)&&typeof S=="function"){var O=p&&p.length,F=S({yAxis:x?fa(fa({},x),{},{ticks:O?p:x.ticks}):void 0,width:t??u,height:r??f,offset:n},O?!0:d);lp(Array.isArray(F),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof F,"]")),Array.isArray(F)&&(_=F)}if((!E||!E.length)&&typeof b=="function"){var M=h&&h.length,C=b({xAxis:g?fa(fa({},g),{},{ticks:M?h:g.ticks}):void 0,width:t??u,height:r??f,offset:n},M?!0:d);lp(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(E=C)}return y.createElement(Ha,{zIndex:a.zIndex},y.createElement("g",{className:"recharts-cartesian-grid"},y.createElement(Yie,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),y.createElement(Jie,Cl({},a,{horizontalPoints:_})),y.createElement(Zie,Cl({},a,{verticalPoints:E})),y.createElement(Kie,Cl({},a,{offset:n,horizontalPoints:_,xAxis:g,yAxis:x})),y.createElement(Xie,Cl({},a,{offset:n,verticalPoints:E,xAxis:g,yAxis:x}))))}a2.displayName="CartesianGrid";var rse={},RP=Wa({name:"errorBars",initialState:rse,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:zfe,replaceErrorBar:$fe,removeErrorBar:Wfe}=RP.actions,nse=RP.reducer,ase=["children"];function ise(e,t){if(e==null)return{};var r,n,a=sse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ose={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},lse=y.createContext(ose);function BP(e){var{children:t}=e,r=ise(e,ase);return y.createElement(lse.Provider,{value:r},t)}function yw(e,t){var r,n,a=yt(u=>xo(u,e)),i=yt(u=>vo(u,t)),s=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Dn.allowDataOverflow,o=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:Mn.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function UP(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=mw(),{needClipX:i,needClipY:s,needClip:o}=yw(t,r);if(!o||!a)return null;var{x:c,y:u,width:f,height:d}=a;return y.createElement("clipPath",{id:"clipPath-".concat(n)},y.createElement("rect",{x:i?c:c-f/2,y:s?u:u-d/2,width:i?f:f*2,height:s?d:d*2}))}var zP=(e,t,r,n)=>Jo(e,"xAxis",t,n),$P=(e,t,r,n)=>Xo(e,"xAxis",t,n),WP=(e,t,r,n)=>Jo(e,"yAxis",r,n),HP=(e,t,r,n)=>Xo(e,"yAxis",r,n),cse=Re([Jt,zP,WP,$P,HP],(e,t,r,n,a)=>il(e,"xAxis")?uu(t,n,!1):uu(r,a,!1)),use=(e,t,r,n,a)=>a;function fse(e){return e.type==="line"}var dse=Re([Dm,use],(e,t)=>e.filter(fse).find(r=>r.id===t)),hse=Re([Jt,zP,WP,$P,HP,dse,cse,gb],(e,t,r,n,a,i,s,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:f}=o;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:d,data:p}=i,h;if(p!=null&&p.length>0?h=p:h=c==null?void 0:c.slice(u,f+1),h!=null)return Zse({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:d,bandSize:s,displayedData:h})}});function pse(e){var t=Hl(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),o=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(o)||o<0)&&(o=n),{r:s,strokeWidth:o}}return{r,strokeWidth:n}}var C1={exports:{}},T1={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3;function mse(){if(X3)return T1;X3=1;var e=Hp();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,o=e.useDebugValue;return T1.useSyncExternalStoreWithSelector=function(c,u,f,d,p){var h=a(null);if(h.current===null){var m={hasValue:!1,value:null};h.current=m}else m=h.current;h=s(function(){function x(O){if(!b){if(b=!0,S=O,O=d(O),p!==void 0&&m.hasValue){var F=m.value;if(p(F,O))return _=F}return _=O}if(F=_,r(S,O))return F;var M=d(O);return p!==void 0&&p(F,M)?(S=O,F):(S=O,_=M)}var b=!1,S,_,E=f===void 0?null:f;return[function(){return x(u())},E===null?void 0:function(){return x(E())}]},[u,f,d,p]);var g=n(c,h[0],h[1]);return i(function(){m.hasValue=!0,m.value=g},[g]),o(g),g},T1}var J3;function gse(){return J3||(J3=1,C1.exports=mse()),C1.exports}gse();function xse(e){e()}function vse(){let e=null,t=null;return{clear(){e=null,t=null},notify(){xse(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Z3={notify(){},get:()=>[]};function yse(e,t){let r,n=Z3,a=0,i=!1;function s(g){f();const x=n.subscribe(g);let b=!1;return()=>{b||(b=!0,x(),d())}}function o(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return i}function f(){a++,r||(r=e.subscribe(c),n=vse())}function d(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Z3)}function p(){i||(i=!0,f())}function h(){i&&(i=!1,d())}const m={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:h,getListeners:()=>n};return m}var bse=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",wse=bse(),Sse=()=>typeof navigator<"u"&&navigator.product==="ReactNative",_se=Sse(),Nse=()=>wse||_se?y.useLayoutEffect:y.useEffect,Ase=Nse();function Q3(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function jse(e,t){if(Q3(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!Q3(e[r[a]],t[r[a]]))return!1;return!0}var P1=Symbol.for("react-redux-context"),O1=typeof globalThis<"u"?globalThis:{};function kse(){if(!y.createContext)return{};const e=O1[P1]??(O1[P1]=new Map);let t=e.get(y.createContext);return t||(t=y.createContext(null),e.set(y.createContext,t)),t}var Ese=kse();function Cse(e){const{children:t,context:r,serverState:n,store:a}=e,i=y.useMemo(()=>{const c=yse(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=y.useMemo(()=>a.getState(),[a]);Ase(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=r||Ese;return y.createElement(o.Provider,{value:i},t)}var Tse=Cse,Pse=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Ose(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Gm(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(Pse.has(n)){if(e[n]==null&&t[n]==null)continue;if(!jse(e[n],t[n]))return!1}else if(!Ose(e[n],t[n]))return!1;return!0}var Fse=["id"],Ise=["type","layout","connectNulls","needClip","shape"],Lse=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function pd(){return pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pd.apply(null,arguments)}function eA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eA(Object(r),!0).forEach(function(n){Dse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dse(e,t,r){return(t=Mse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mse(e){var t=Rse(e,"string");return typeof t=="symbol"?t:t+""}function Rse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bw(e,t){if(e==null)return{};var r,n,a=Bse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Bse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Use=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Su(r,t),payload:e}]},zse=y.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,unit:c,tooltipType:u,id:f}=e,d={dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Su(s,t),hide:o,type:u,color:n,unit:c,graphicalItemId:f}};return y.createElement(hw,{tooltipEntrySettings:d})}),qP=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function $se(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var Wse=(e,t,r)=>{var n=r.reduce((d,p)=>d+p);if(!n)return qP(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>i){o=[...r.slice(0,c),i-u];break}var f=o.length%2===0?[0,s]:[s];return[...$se(r,a),...o,...f].map(d=>"".concat(d,"px")).join(", ")};function Hse(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n,{id:o}=n,c=bw(n,Fse),u=li(c);return y.createElement(Pae,{points:r,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:u,needClip:s,clipPathId:t})}function qse(e){var{showLabels:t,children:r,points:n}=e,a=y.useMemo(()=>n==null?void 0:n.map(i=>{var s,o,c={x:(s=i.x)!==null&&s!==void 0?s:0,y:(o=i.y)!==null&&o!==void 0?o:0,width:0,lowerWidth:0,upperWidth:0,height:0};return xs(xs({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return y.createElement(yP,{value:t?a:void 0},r)}function tA(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:o,connectNulls:c,needClip:u,shape:f}=i,d=bw(i,Ise),p=xs(xs({},Ta(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:o,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return y.createElement(y.Fragment,null,(n==null?void 0:n.length)>1&&y.createElement(cw,pd({shapeType:"curve",option:f},p,{pathRef:r})),y.createElement(Hse,{points:n,clipPathId:t,props:i}))}function Gse(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Vse(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:f,animationEasing:d,animateNewValues:p,width:h,height:m,onAnimationEnd:g,onAnimationStart:x}=r,b=a.current,S=Fd(s,"recharts-line-"),_=y.useRef(S),[E,O]=y.useState(!1),F=!E,M=y.useCallback(()=>{typeof g=="function"&&g(),O(!1)},[g]),C=y.useCallback(()=>{typeof x=="function"&&x(),O(!0)},[x]),k=Gse(n.current),W=y.useRef(0);_.current!==S&&(W.current=i.current,_.current=S);var D=W.current;return y.createElement(qse,{points:s,showLabels:F},r.children,y.createElement(Od,{animationId:S,begin:u,duration:f,isActive:c,easing:d,onAnimationEnd:M,onAnimationStart:C,key:S},j=>{var H=Ir(D,k+D,j),U=Math.min(H,k),Y;if(c)if(o){var X="".concat(o).split(/[,\s]+/gim).map(z=>parseFloat(z));Y=Wse(U,k,X)}else Y=qP(k,U);else Y=o==null?void 0:String(o);if(j>0&&k>0&&(a.current=s,i.current=Math.max(i.current,U)),b){var Z=b.length/s.length,K=j===1?s:s.map((z,se)=>{var xe=Math.floor(se*Z);if(b[xe]){var A=b[xe];return xs(xs({},z),{},{x:Ir(A.x,z.x,j),y:Ir(A.y,z.y,j)})}return p?xs(xs({},z),{},{x:Ir(h*2,z.x,j),y:Ir(m/2,z.y,j)}):xs(xs({},z),{},{x:z.x,y:z.y})});return a.current=K,y.createElement(tA,{props:r,points:K,clipPathId:t,pathRef:n,strokeDasharray:Y})}return y.createElement(tA,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:Y})}),y.createElement(iw,{label:r.label}))}function Yse(e){var{clipPathId:t,props:r}=e,n=y.useRef(null),a=y.useRef(0),i=y.useRef(null);return y.createElement(Vse,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var Kse=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:yr(e.payload,t)}};class Xse extends y.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:o,left:c,width:u,height:f,id:d,needClip:p,zIndex:h}=this.props;if(t)return null;var m=rr("recharts-line",a),g=d,{r:x,strokeWidth:b}=pse(r),S=kP(r),_=x*2+b,E=p?"url(#clipPath-".concat(S?"":"dots-").concat(g,")"):void 0;return y.createElement(Ha,{zIndex:h},y.createElement(Hn,{className:m},p&&y.createElement("defs",null,y.createElement(UP,{clipPathId:g,xAxisId:i,yAxisId:s}),!S&&y.createElement("clipPath",{id:"clipPath-dots-".concat(g)},y.createElement("rect",{x:c-_/2,y:o-_/2,width:u+_,height:f+_}))),y.createElement(BP,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:Kse,errorBarOffset:0},y.createElement(Yse,{props:this.props,clipPathId:g}))),y.createElement(Jae,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:E}))}}var GP={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:wn.line,type:"linear"};function Jse(e){var t=_n(e,GP),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:c,hide:u,isAnimationActive:f,label:d,legendType:p,xAxisId:h,yAxisId:m,id:g}=t,x=bw(t,Lse),{needClip:b}=yw(h,m),S=mw(),_=_u(),E=ya(),O=yt(W=>hse(W,h,m,E,g));if(_!=="horizontal"&&_!=="vertical"||O==null||S==null)return null;var{height:F,width:M,x:C,y:k}=S;return y.createElement(Xse,pd({},x,{id:g,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:f,hide:u,label:d,legendType:p,xAxisId:h,yAxisId:m,points:O,layout:_,height:F,width:M,left:C,top:k,needClip:b}))}function Zse(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:c}=e;return c.map((u,f)=>{var d=yr(u,s);if(t==="horizontal"){var p=$_({axis:r,ticks:a,bandSize:o,entry:u,index:f}),h=Dr(d)?null:n.scale(d);return{x:p,y:h,value:d,payload:u}}var m=Dr(d)?null:r.scale(d),g=$_({axis:n,ticks:i,bandSize:o,entry:u,index:f});return m==null||g==null?null:{x:m,y:g,value:d,payload:u}}).filter(Boolean)}function Qse(e){var t=_n(e,GP),r=ya();return y.createElement(pw,{id:t.id,type:"line"},n=>y.createElement(y.Fragment,null,y.createElement(EP,{legendPayload:Use(t)}),y.createElement(zse,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),y.createElement(TP,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),y.createElement(Jse,pd({},t,{id:n}))))}var i2=y.memo(Qse,Gm);i2.displayName="Line";function oc(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:PP}function lc(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:PP}var eoe="Invariant failed";function toe(e,t){throw new Error(eoe)}function s2(){return s2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s2.apply(null,arguments)}function Dp(e){return y.createElement(cw,s2({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var roe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(gt(t))return t;var i=gt(n)||Dr(n);return i?t(n,a):(i||toe(),r)}},noe=(e,t,r)=>r,aoe=(e,t)=>t,Vd=Re([Dm,aoe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),ioe=Re([Vd],e=>e==null?void 0:e.maxBarSize),soe=(e,t,r,n)=>n,ooe=Re([Jt,Dm,oc,lc,noe],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),loe=(e,t,r)=>{var n=Jt(e),a=oc(e,t),i=lc(e,t);if(!(a==null||i==null))return n==="horizontal"?Kv(e,"yAxis",i,r):Kv(e,"xAxis",a,r)},coe=(e,t)=>{var r=Jt(e),n=oc(e,t),a=lc(e,t);if(!(n==null||a==null))return r==="horizontal"?BN(e,"xAxis",n):BN(e,"yAxis",a)},uoe=Re([ooe,FZ,coe],Zae),foe=(e,t,r)=>{var n,a,i=Vd(e,t);if(i!=null){var s=oc(e,t),o=lc(e,t);if(!(s==null||o==null)){var c=Jt(e),u=eT(e),{maxBarSize:f}=i,d=Dr(f)?u:f,p,h;return c==="horizontal"?(p=Jo(e,"xAxis",s,r),h=Xo(e,"xAxis",s,r)):(p=Jo(e,"yAxis",o,r),h=Xo(e,"yAxis",o,r)),(n=(a=uu(p,h,!0))!==null&&a!==void 0?a:d)!==null&&n!==void 0?n:0}}},VP=(e,t,r)=>{var n=Jt(e),a=oc(e,t),i=lc(e,t);if(!(a==null||i==null)){var s,o;return n==="horizontal"?(s=Jo(e,"xAxis",a,r),o=Xo(e,"xAxis",a,r)):(s=Jo(e,"yAxis",i,r),o=Xo(e,"yAxis",i,r)),uu(s,o)}},doe=Re([uoe,eT,OZ,tT,foe,VP,ioe],nie),hoe=(e,t,r)=>{var n=oc(e,t);if(n!=null)return Jo(e,"xAxis",n,r)},poe=(e,t,r)=>{var n=lc(e,t);if(n!=null)return Jo(e,"yAxis",n,r)},moe=(e,t,r)=>{var n=oc(e,t);if(n!=null)return Xo(e,"xAxis",n,r)},goe=(e,t,r)=>{var n=lc(e,t);if(n!=null)return Xo(e,"yAxis",n,r)},xoe=Re([doe,Vd],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),voe=Re([loe,Vd],aie),yoe=Re([Cn,Uy,hoe,poe,moe,goe,xoe,Jt,bZ,VP,voe,Vd,soe],(e,t,r,n,a,i,s,o,c,u,f,d,p)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:g}=c;if(!(d==null||s==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||i==null||u==null)){var{data:x}=d,b;if(x!=null&&x.length>0?b=x:b=h==null?void 0:h.slice(m,g+1),b!=null)return Yoe({layout:o,barSettings:d,pos:s,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:f,displayedData:b,offset:e,cells:p,dataStartIndex:m})}}),boe=["index"];function o2(){return o2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o2.apply(null,arguments)}function woe(e,t){if(e==null)return{};var r,n,a=Soe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Soe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var YP=y.createContext(void 0),_oe=e=>{var t=y.useContext(YP);if(t!=null)return t.stackId;if(e!=null)return pV(e)},Noe=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),Aoe=e=>{var t=y.useContext(YP);if(t!=null){var{stackId:r}=t;return"url(#".concat(Noe(r,e),")")}},joe=e=>{var{index:t}=e,r=woe(e,boe),n=Aoe(t);return y.createElement(Hn,o2({className:"recharts-bar-stack-layer",clipPath:n},r))},koe=["onMouseEnter","onMouseLeave","onClick"],Eoe=["value","background","tooltipPosition"],Coe=["id"],Toe=["onMouseEnter","onClick","onMouseLeave"];function so(){return so=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},so.apply(null,arguments)}function rA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ka(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rA(Object(r),!0).forEach(function(n){Poe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Poe(e,t,r){return(t=Ooe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ooe(e){var t=Foe(e,"string");return typeof t=="symbol"?t:t+""}function Foe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mp(e,t){if(e==null)return{};var r,n,a=Ioe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ioe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Loe=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Su(r,t),payload:e}]},Doe=y.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:o,tooltipType:c,id:u}=e,f={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Su(i,t),hide:s,type:c,color:a,unit:o,graphicalItemId:u}};return y.createElement(hw,{tooltipEntrySettings:f})});function Moe(e){var t=yt(Zo),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:o,onClick:c}=i,u=Mp(i,koe),f=uw(s,n,i.id),d=fw(o),p=dw(c,n,i.id);if(!a||r==null)return null;var h=Hl(a);return y.createElement(Ha,{zIndex:iie(a,wn.barBackground)},r.map((m,g)=>{var{value:x,background:b,tooltipPosition:S}=m,_=Mp(m,Eoe);if(!b)return null;var E=f(m,g),O=d(m,g),F=p(m,g),M=ka(ka(ka(ka(ka({option:a,isActive:String(g)===t},_),{},{fill:"#eee"},b),h),kd(u,m,g)),{},{onMouseEnter:E,onMouseLeave:O,onClick:F,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return y.createElement(Dp,so({key:"background-bar-".concat(g)},M))}))}function Roe(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(i=>{var s={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return ka(ka({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return y.createElement(yP,{value:t?a:void 0},r)}function Boe(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,o=yt(Zo),c=yt(Zb),u=r&&String(i)===o&&(c==null||s===c),f=u?r:t;return u?y.createElement(Ha,{zIndex:wn.activeBar},y.createElement(Dp,so({},n,{name:String(n.name)},a,{isActive:u,option:f,index:i,dataKey:s}))):y.createElement(Dp,so({},n,{name:String(n.name)},a,{isActive:u,option:f,index:i,dataKey:s}))}function Uoe(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return y.createElement(Dp,so({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function zoe(e){var t,{data:r,props:n}=e,a=(t=li(n))!==null&&t!==void 0?t:{},{id:i}=a,s=Mp(a,Coe),{shape:o,dataKey:c,activeBar:u}=n,{onMouseEnter:f,onClick:d,onMouseLeave:p}=n,h=Mp(n,Toe),m=uw(f,c,i),g=fw(p),x=dw(d,c,i);return r?y.createElement(y.Fragment,null,r.map((b,S)=>y.createElement(joe,so({index:S,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(S),className:"recharts-bar-rectangle"},kd(h,b,S),{onMouseEnter:m(b,S),onMouseLeave:g(b,S),onClick:x(b,S)}),u?y.createElement(Boe,{shape:o,activeBar:u,baseProps:s,entry:b,index:S,dataKey:c}):y.createElement(Uoe,{shape:o,baseProps:s,entry:b,index:S,dataKey:c})))):null}function $oe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:f}=t,d=r.current,p=Fd(t,"recharts-bar-"),[h,m]=y.useState(!1),g=!h,x=y.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),b=y.useCallback(()=>{typeof f=="function"&&f(),m(!0)},[f]);return y.createElement(Roe,{showLabels:g,rects:n},y.createElement(Od,{animationId:p,begin:s,duration:o,isActive:i,easing:c,onAnimationEnd:x,onAnimationStart:b,key:p},S=>{var _=S===1?n:n==null?void 0:n.map((E,O)=>{var F=d&&d[O];if(F)return ka(ka({},E),{},{x:Ir(F.x,E.x,S),y:Ir(F.y,E.y,S),width:Ir(F.width,E.width,S),height:Ir(F.height,E.height,S)});if(a==="horizontal"){var M=Ir(0,E.height,S),C=Ir(E.stackedBarStart,E.y,S);return ka(ka({},E),{},{y:C,height:M})}var k=Ir(0,E.width,S),W=Ir(E.stackedBarStart,E.x,S);return ka(ka({},E),{},{width:k,x:W})});return S>0&&(r.current=_??null),_==null?null:y.createElement(Hn,null,y.createElement(zoe,{props:t,data:_}))}),y.createElement(iw,{label:t.label}),t.children)}function Woe(e){var t=y.useRef(null);return y.createElement($oe,{previousRectanglesRef:t,props:e})}var KP=0,Hoe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:yr(e,t)}};class qoe extends y.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var f=rr("recharts-bar",a),d=u;return y.createElement(Hn,{className:f,id:u},o&&y.createElement("defs",null,y.createElement(UP,{clipPathId:d,xAxisId:i,yAxisId:s})),y.createElement(Hn,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(d,")"):void 0},y.createElement(Moe,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),y.createElement(Woe,this.props)))}}var Goe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:KP,xAxisId:0,yAxisId:0,zIndex:wn.bar};function Voe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:f}=e,{needClip:d}=yw(t,r),p=_u(),h=ya(),m=lw(e.children,gu),g=yt(S=>yoe(S,e.id,h,m));if(p!=="vertical"&&p!=="horizontal")return null;var x,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?x=0:x=p==="vertical"?b.height/2:b.width/2,y.createElement(BP,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:Hoe,errorBarOffset:x},y.createElement(qoe,so({},e,{layout:p,needClip:d,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:f})))}function Yoe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:f,displayedData:d,offset:p,cells:h,parentViewBox:m,dataStartIndex:g}=e,x=t==="horizontal"?o:s,b=f?x.scale.domain():null,S=mV({numericAxis:x}),_=x.scale(S);return d.map((E,O)=>{var F,M,C,k,W,D;if(f){var j=f[O+g];if(j==null)return null;F=cV(j,b)}else F=yr(E,r),Array.isArray(F)||(F=[S,F]);var H=roe(n,KP)(F[1],O);if(t==="horizontal"){var U,[Y,X]=[o.scale(F[0]),o.scale(F[1])];M=W_({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:E,index:O}),C=(U=X??Y)!==null&&U!==void 0?U:void 0,k=a.size;var Z=Y-X;if(W=ts(Z)?0:Z,D={x:M,y:p.top,width:k,height:p.height},Math.abs(H)>0&&Math.abs(W)<Math.abs(H)){var K=Wn(W||H)*(Math.abs(H)-Math.abs(W));C-=K,W+=K}}else{var[z,se]=[s.scale(F[0]),s.scale(F[1])];if(M=z,C=W_({axis:o,ticks:u,bandSize:i,offset:a.offset,entry:E,index:O}),k=se-z,W=a.size,D={x:p.left,y:C,width:p.width,height:W},Math.abs(H)>0&&Math.abs(k)<Math.abs(H)){var xe=Wn(k||H)*(Math.abs(H)-Math.abs(k));k+=xe}}if(M==null||C==null||k==null||W==null)return null;var A=ka(ka({},E),{},{stackedBarStart:_,x:M,y:C,width:k,height:W,value:f?F:F[1],payload:E,background:D,tooltipPosition:{x:M+k/2,y:C+W/2},parentViewBox:m},h&&h[O]&&h[O].props);return A}).filter(Boolean)}function Koe(e){var t=_n(e,Goe),r=_oe(t.stackId),n=ya();return y.createElement(pw,{id:t.id,type:"bar"},a=>y.createElement(y.Fragment,null,y.createElement(EP,{legendPayload:Loe(t)}),y.createElement(Doe,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),y.createElement(TP,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),y.createElement(Ha,{zIndex:t.zIndex},y.createElement(Voe,so({},t,{id:a})))))}var l2=y.memo(Koe,Gm);l2.displayName="Bar";var Xoe=["domain","range"],Joe=["domain","range"];function nA(e,t){if(e==null)return{};var r,n,a=Zoe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Zoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function aA(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function XP(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=nA(e,Xoe),{domain:i,range:s}=t,o=nA(t,Joe);return!aA(r,i)||!aA(n,s)?!1:Gm(a,o)}var Qoe=["dangerouslySetInnerHTML","ticks","scale"],ele=["id","scale"];function c2(){return c2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c2.apply(null,arguments)}function iA(e,t){if(e==null)return{};var r,n,a=tle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rle(e){var t=jr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(Dae(e)):r.current!==e&&t(Mae({prev:r.current,next:e})),r.current=e},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(t(Rae(r.current)),r.current=null)},[t]),null}var nle=e=>{var{xAxisId:t,className:r}=e,n=yt(Uy),a=ya(),i="xAxis",s=yt(b=>FT(b,i,t,a)),o=yt(b=>CT(b,t)),c=yt(b=>TQ(b,t)),u=yt(b=>uT(b,t));if(o==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:d,scale:p}=e,h=iA(e,Qoe),{id:m,scale:g}=u,x=iA(u,ele);return y.createElement(vw,c2({},h,x,{x:c.x,y:c.y,width:o.width,height:o.height,className:rr("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:s,axisType:i}))},ale={allowDataOverflow:Dn.allowDataOverflow,allowDecimals:Dn.allowDecimals,allowDuplicatedCategory:Dn.allowDuplicatedCategory,angle:Dn.angle,axisLine:Zs.axisLine,height:Dn.height,hide:!1,includeHidden:Dn.includeHidden,interval:Dn.interval,minTickGap:Dn.minTickGap,mirror:Dn.mirror,orientation:Dn.orientation,padding:Dn.padding,reversed:Dn.reversed,scale:Dn.scale,tick:Dn.tick,tickCount:Dn.tickCount,tickLine:Zs.tickLine,tickSize:Zs.tickSize,type:Dn.type,xAxisId:0},ile=e=>{var t=_n(e,ale);return y.createElement(y.Fragment,null,y.createElement(rle,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),y.createElement(nle,t))},u2=y.memo(ile,XP);u2.displayName="XAxis";var sle=["dangerouslySetInnerHTML","ticks","scale"],ole=["id","scale"];function f2(){return f2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f2.apply(null,arguments)}function sA(e,t){if(e==null)return{};var r,n,a=lle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cle(e){var t=jr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(Bae(e)):r.current!==e&&t(Uae({prev:r.current,next:e})),r.current=e},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(t(zae(r.current)),r.current=null)},[t]),null}var ule=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=y.useRef(null),s=y.useRef(null),o=yt(Uy),c=ya(),u=jr(),f="yAxis",d=yt(F=>TT(F,t)),p=yt(F=>OQ(F,t)),h=yt(F=>FT(F,f,t,c)),m=yt(F=>fT(F,t));if(y.useLayoutEffect(()=>{if(!(n!=="auto"||!d||aw(a)||y.isValidElement(a)||m==null)){var F=i.current;if(F){var M=F.getCalculatedWidth();Math.round(d.width)!==Math.round(M)&&u($ae({id:t,width:M}))}}},[h,d,u,a,t,n,m]),d==null||p==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:x,scale:b}=e,S=sA(e,sle),{id:_,scale:E}=m,O=sA(m,ole);return y.createElement(vw,f2({},S,O,{ref:i,labelRef:s,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:d.width,height:d.height,className:rr("recharts-".concat(f," ").concat(f),r),viewBox:o,ticks:h,axisType:f}))},fle={allowDataOverflow:Mn.allowDataOverflow,allowDecimals:Mn.allowDecimals,allowDuplicatedCategory:Mn.allowDuplicatedCategory,angle:Mn.angle,axisLine:Zs.axisLine,hide:!1,includeHidden:Mn.includeHidden,interval:Mn.interval,minTickGap:Mn.minTickGap,mirror:Mn.mirror,orientation:Mn.orientation,padding:Mn.padding,reversed:Mn.reversed,scale:Mn.scale,tick:Mn.tick,tickCount:Mn.tickCount,tickLine:Zs.tickLine,tickSize:Zs.tickSize,type:Mn.type,width:Mn.width,yAxisId:0},dle=e=>{var t=_n(e,fle);return y.createElement(y.Fragment,null,y.createElement(cle,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),y.createElement(ule,t))},d2=y.memo(dle,XP);d2.displayName="YAxis";var hle=(e,t)=>t,ww=Re([hle,Jt,lT,Pn,KT,yo,Yee,Cn],tte),Sw=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},JP=Pi("mouseClick"),ZP=Cd();ZP.startListening({actionCreator:JP,effect:(e,t)=>{var r=e.payload,n=ww(t.getState(),Sw(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(GQ({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var h2=Pi("mouseMove"),QP=Cd(),dh=null;QP.startListening({actionCreator:h2,effect:(e,t)=>{var r=e.payload;dh!==null&&cancelAnimationFrame(dh);var n=Sw(r);dh=requestAnimationFrame(()=>{var a=t.getState(),i=Gb(a,a.tooltip.settings.shared);if(i==="axis"){var s=ww(a,n);(s==null?void 0:s.activeIndex)!=null?t.dispatch(zT({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(UT())}dh=null})}});function ple(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var oA={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},e8=Wa({name:"rootProps",initialState:oA,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:oA.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),mle=e8.reducer,{updateOptions:gle}=e8.actions,t8=Wa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:xle}=t8.actions,vle=t8.reducer,r8=Pi("keyDown"),n8=Pi("focus"),_w=Cd();_w.startListening({actionCreator:r8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Vb(a,Ou(r),$d(r),qd(r)),o=s==null?-1:Number(s);if(!(!Number.isFinite(o)||o<0)){var c=yo(r);if(i==="Enter"){var u=Tp(r,"axis","hover",String(a.index));t.dispatch(Jv({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var f=DQ(r),d=f==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,h=o+p*d;if(!(c==null||h>=c.length||h<0)){var m=Tp(r,"axis","hover",String(h));t.dispatch(Jv({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});_w.startListening({actionCreator:n8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=Tp(r,"axis","hover",String(i));t.dispatch(Jv({active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Ni=Pi("externalEvent"),a8=Cd(),F1=new Map;a8.startListening({actionCreator:Ni,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,i=F1.get(a);i!==void 0&&cancelAnimationFrame(i);var s=requestAnimationFrame(()=>{try{var o=t.getState(),c={activeCoordinate:Oee(o),activeDataKey:Zb(o),activeIndex:Zo(o),activeLabel:ZT(o),activeTooltipIndex:Zo(o),isTooltipActive:Fee(o)};r(c,n)}finally{F1.delete(a)}});F1.set(a,s)}}});var yle=Re([Tu],e=>e.tooltipItemPayloads),ble=Re([yle,Hd,(e,t)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),i8=Pi("touchMove"),s8=Cd();s8.startListening({actionCreator:i8,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=Gb(n,n.tooltip.settings.shared);if(a==="axis"){var i=r.touches[0];if(i==null)return;var s=ww(n,Sw({clientX:i.clientX,clientY:i.clientY,currentTarget:r.currentTarget}));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(zT({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(a==="item"){var o,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var f=u.getAttribute(FE),d=(o=u.getAttribute(IE))!==null&&o!==void 0?o:void 0,p=Pu(n).find(g=>g.id===d);if(f==null||p==null||d==null)return;var{dataKey:h}=p,m=ble(n,f,d);t.dispatch(BT({activeDataKey:h,activeIndex:f,activeCoordinate:m,activeGraphicalItemId:d}))}}}});var wle=tE({brush:sie,cartesianAxis:Wae,chartData:Ote,errorBars:nse,graphicalItems:Kne,layout:nV,legend:fY,options:kte,polarAxis:cne,polarOptions:vle,referenceElements:hie,rootProps:mle,tooltip:VQ,zIndex:mte}),Sle=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return EG({reducer:wle,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([ZP.middleware,QP.middleware,_w.middleware,a8.middleware,s8.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(gE({type:"raf"}))},devTools:{serialize:{replacer:ple},name:"recharts-".concat(r)}})};function o8(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=ya(),i=y.useRef(null);if(a)return r;i.current==null&&(i.current=Sle(t,n));var s=Fy;return y.createElement(Tse,{context:s,store:i.current},r)}function _le(e){var{layout:t,margin:r}=e,n=jr(),a=ya();return y.useEffect(()=>{a||(n(eV(t)),n(QG(r)))},[n,a,t,r]),null}var l8=y.memo(_le,Gm);function c8(e){var t=jr();return y.useEffect(()=>{t(gle(e))},[t,e]),null}function lA(e){var{zIndex:t,isPanorama:r}=e,n=y.useRef(null),a=jr();return y.useLayoutEffect(()=>(n.current&&a(hte({zIndex:t,element:n.current,isPanorama:r})),()=>{a(pte({zIndex:t,isPanorama:r}))}),[a,t,r]),y.createElement("g",{tabIndex:-1,ref:n})}function cA(e){var{children:t,isPanorama:r}=e,n=yt(nte);if(!n||n.length===0)return t;var a=n.filter(s=>s<0),i=n.filter(s=>s>0);return y.createElement(y.Fragment,null,a.map(s=>y.createElement(lA,{key:s,zIndex:s,isPanorama:r})),t,i.map(s=>y.createElement(lA,{key:s,zIndex:s,isPanorama:r})))}var Nle=["children"];function Ale(e,t){if(e==null)return{};var r,n,a=jle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(null,arguments)}var kle={width:"100%",height:"100%",display:"block"},Ele=y.forwardRef((e,t)=>{var r=$y(),n=Wy(),a=XE();if(!As(r)||!As(n))return null;var{children:i,otherAttributes:s,title:o,desc:c}=e,u,f;return s!=null&&(typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?f=s.role:f=a?"application":void 0),y.createElement(Sy,Rp({},s,{title:o,desc:c,role:f,tabIndex:u,width:r,height:n,style:kle,ref:t}),i)}),Cle=e=>{var{children:t}=e,r=yt(xm);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return y.createElement(Sy,{width:n,height:a,x:s,y:i},t)},uA=y.forwardRef((e,t)=>{var{children:r}=e,n=Ale(e,Nle),a=ya();return a?y.createElement(Cle,null,y.createElement(cA,{isPanorama:!0},r)):y.createElement(Ele,Rp({ref:t},n),y.createElement(cA,{isPanorama:!1},r))});function Tle(){var e=jr(),[t,r]=y.useState(null),n=yt(wV);return y.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;zr(i)&&i!==n&&e(rV(i))}},[t,e,n]),r}function fA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ple(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fA(Object(r),!0).forEach(function(n){Ole(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ole(e,t,r){return(t=Fle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fle(e){var t=Ile(e,"string");return typeof t=="symbol"?t:t+""}function Ile(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zl.apply(null,arguments)}var Lle=()=>(zte(),null);function Bp(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Dle=y.forwardRef((e,t)=>{var r,n,a=y.useRef(null),[i,s]=y.useState({containerWidth:Bp((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Bp((n=e.style)===null||n===void 0?void 0:n.height)}),o=y.useCallback((u,f)=>{s(d=>{var p=Math.round(u),h=Math.round(f);return d.containerWidth===p&&d.containerHeight===h?d:{containerWidth:p,containerHeight:h}})},[]),c=y.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:f,height:d}=u.getBoundingClientRect();o(f,d);var p=m=>{var{width:g,height:x}=m[0].contentRect;o(g,x)},h=new ResizeObserver(p);h.observe(u),a.current=h}},[t,o]);return y.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[o]),y.createElement(y.Fragment,null,y.createElement(ym,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",Zl({ref:c},e)))}),Mle=y.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=y.useState({containerWidth:Bp(r),containerHeight:Bp(n)}),s=y.useCallback((c,u)=>{i(f=>{var d=Math.round(c),p=Math.round(u);return f.containerWidth===d&&f.containerHeight===p?f:{containerWidth:d,containerHeight:p}})},[]),o=y.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:f}=c.getBoundingClientRect();s(u,f)}},[t,s]);return y.createElement(y.Fragment,null,y.createElement(ym,{width:a.containerWidth,height:a.containerHeight}),y.createElement("div",Zl({ref:o},e)))}),Rle=y.forwardRef((e,t)=>{var{width:r,height:n}=e;return y.createElement(y.Fragment,null,y.createElement(ym,{width:r,height:n}),y.createElement("div",Zl({ref:t},e)))}),Ble=y.forwardRef((e,t)=>{var{width:r,height:n}=e;return eo(r)||eo(n)?y.createElement(Mle,Zl({},e,{ref:t})):y.createElement(Rle,Zl({},e,{ref:t}))});function Ule(e){return e===!0?Dle:Ble}var zle=y.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:f,onMouseMove:d,onMouseUp:p,onTouchEnd:h,onTouchMove:m,onTouchStart:g,style:x,width:b,responsive:S,dispatchTouchEvents:_=!0}=e,E=y.useRef(null),O=jr(),[F,M]=y.useState(null),[C,k]=y.useState(null),W=Tle(),D=zy(),j=(D==null?void 0:D.width)>0?D.width:b,H=(D==null?void 0:D.height)>0?D.height:a,U=y.useCallback(q=>{W(q),typeof t=="function"&&t(q),M(q),k(q),q!=null&&(E.current=q)},[W,t,M,k]),Y=y.useCallback(q=>{O(JP(q)),O(Ni({handler:i,reactEvent:q}))},[O,i]),X=y.useCallback(q=>{O(h2(q)),O(Ni({handler:u,reactEvent:q}))},[O,u]),Z=y.useCallback(q=>{O(UT()),O(Ni({handler:f,reactEvent:q}))},[O,f]),K=y.useCallback(q=>{O(h2(q)),O(Ni({handler:d,reactEvent:q}))},[O,d]),z=y.useCallback(()=>{O(n8())},[O]),se=y.useCallback(q=>{O(r8(q.key))},[O]),xe=y.useCallback(q=>{O(Ni({handler:s,reactEvent:q}))},[O,s]),A=y.useCallback(q=>{O(Ni({handler:o,reactEvent:q}))},[O,o]),I=y.useCallback(q=>{O(Ni({handler:c,reactEvent:q}))},[O,c]),P=y.useCallback(q=>{O(Ni({handler:p,reactEvent:q}))},[O,p]),L=y.useCallback(q=>{O(Ni({handler:g,reactEvent:q}))},[O,g]),R=y.useCallback(q=>{_&&O(i8(q)),O(Ni({handler:m,reactEvent:q}))},[O,_,m]),G=y.useCallback(q=>{O(Ni({handler:h,reactEvent:q}))},[O,h]),J=Ule(S);return y.createElement(iP.Provider,{value:F},y.createElement(v6.Provider,{value:C},y.createElement(J,{width:j??(x==null?void 0:x.width),height:H??(x==null?void 0:x.height),className:rr("recharts-wrapper",n),style:Ple({position:"relative",cursor:"default",width:j,height:H},x),onClick:Y,onContextMenu:xe,onDoubleClick:A,onFocus:z,onKeyDown:se,onMouseDown:I,onMouseEnter:X,onMouseLeave:Z,onMouseMove:K,onMouseUp:P,onTouchEnd:G,onTouchMove:R,onTouchStart:L,ref:U},y.createElement(Lle,null),r)))}),$le=["width","height","responsive","children","className","style","compact","title","desc"];function Wle(e,t){if(e==null)return{};var r,n,a=Hle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Hle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var u8=y.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:o,compact:c,title:u,desc:f}=e,d=Wle(e,$le),p=li(d);return c?y.createElement(y.Fragment,null,y.createElement(ym,{width:r,height:n}),y.createElement(uA,{otherAttributes:p,title:u,desc:f},i)):y.createElement(zle,{className:s,style:o,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},y.createElement(uA,{otherAttributes:p,title:u,desc:f,ref:t},y.createElement(mie,null,i)))});function p2(){return p2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p2.apply(null,arguments)}var qle={top:5,right:5,bottom:5,left:5},Gle={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:qle,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},f8=y.forwardRef(function(t,r){var n,a=_n(t.categoricalChartProps,Gle),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,f={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,eventEmitter:void 0};return y.createElement(o8,{preloadedState:{options:f},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:i},y.createElement(FP,{chartData:u.data}),y.createElement(l8,{layout:a.layout,margin:a.margin}),y.createElement(c8,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),y.createElement(u8,p2({},a,{ref:r})))}),Vle=["axis"],Yle=y.forwardRef((e,t)=>y.createElement(f8,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Vle,tooltipPayloadSearcher:nw,categoricalChartProps:e,ref:t})),Kle=["axis","item"],Xle=y.forwardRef((e,t)=>y.createElement(f8,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Kle,tooltipPayloadSearcher:nw,categoricalChartProps:e,ref:t}));function Jle(e){var t=jr();return y.useEffect(()=>{t(xle(e))},[t,e]),null}var Zle=["layout"];function m2(){return m2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m2.apply(null,arguments)}function Qle(e,t){if(e==null)return{};var r,n,a=ece(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ece(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tce={top:5,right:5,bottom:5,left:5},d8={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:tce,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},rce=y.forwardRef(function(t,r){var n,a=_n(t.categoricalChartProps,d8),{layout:i}=a,s=Qle(a,Zle),{chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:f}=t,d={chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return y.createElement(o8,{preloadedState:{options:d},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:o},y.createElement(FP,{chartData:a.data}),y.createElement(l8,{layout:i,margin:a.margin}),y.createElement(c8,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),y.createElement(Jle,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),y.createElement(u8,m2({},s,{ref:r})))});function dA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dA(Object(r),!0).forEach(function(n){nce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nce(e,t,r){return(t=ace(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ace(e){var t=ice(e,"string");return typeof t=="symbol"?t:t+""}function ice(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sce=["item"],oce=hA(hA({},d8),{},{layout:"centric",startAngle:0,endAngle:360}),pA=y.forwardRef((e,t)=>{var r=_n(e,oce);return y.createElement(rce,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:sce,tooltipPayloadSearcher:nw,categoricalChartProps:r,ref:t})});const mA=({data:e})=>{var i,s,o,c,u,f,d,p,h,m,g,x,b,S,_,E,O,F,M,C;gd.useEffect(()=>{var k,W;console.log("=== REPORT CARD DATA DEBUG ==="),console.log("1. Data exists:",!!e),console.log("2. Grading Scales:",e==null?void 0:e.gradingScales),console.log("3. HIFZ Data length:",(k=e==null?void 0:e.hifzData)==null?void 0:k.length),console.log("4. Academic Performance length:",(W=e==null?void 0:e.academicPerformance)==null?void 0:W.length),console.log("5. Hifz Target Level:",e==null?void 0:e.hifzTargetLevel),console.log("6. Teacher Remark:",e==null?void 0:e.teacherRemark),e!=null&&e.hifzData&&e.hifzData.forEach((D,j)=>{var H,U;console.log(`HIFZ Item ${j}:`,{subject:D.subject,urduSubject:D.urduSubject,grade:D.grade,hasUrdu:!!((H=D.urduSubject)!=null&&H.trim()),isArabic:(U=D.urduSubject)!=null&&U.match(/[\u0600-\u06FF]/)?"Yes":"No"})})},[e]);const t=((i=e==null?void 0:e.hifzData)==null?void 0:i.filter(k=>k&&k.subject&&k.subject!=="Total/Grade"&&k.subject!=="").map(k=>({name:k.subject||"Subject","Total Marks":k.totalMarks||0,"Secured Marks":k.securedMarks||0,"Class Marks":k.classMarks||0})))||[],r=((s=e==null?void 0:e.academicPerformance)==null?void 0:s.filter(k=>k&&k.subject&&k.subject!=="Total/Grade"&&k.subject!=="").map(k=>({name:k.subject||"Subject",value:k.percentage||0,color:k.color||"#cccccc"})))||[],n=(o=e==null?void 0:e.attendance)!=null&&o.summary?[{name:"Present",value:e.attendance.summary.presentCount||0,color:"#4ade80"},{name:"Absent",value:e.attendance.summary.absentCount||0,color:"#f87171"}]:[{name:"Present",value:0,color:"#4ade80"},{name:"Absent",value:0,color:"#f87171"}],a=()=>{var W;if(!(e!=null&&e.gradingScales)||e.gradingScales.length===0||!((W=e.gradingScales[0])!=null&&W.values)||e.gradingScales[0].values.length<2)return l.jsx("div",{className:"text-center p-2 text-gray-500 text-xs",children:"Grading scale not available"});const k=["E","D","C","B2","B1","A2","A1"];return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-[10px] border-collapse",children:[l.jsx("thead",{children:l.jsx("tr",{children:k.map((D,j)=>l.jsx("th",{className:`border border-white text-white p-1 
                  ${j<2?"bg-red-500":j<4?"bg-orange-500":"bg-green-600"}`,children:D},j))})}),l.jsx("tbody",{children:e.gradingScales.map((D,j)=>{var H,U;return l.jsx("tr",{children:(U=(H=D.values)==null?void 0:H.slice(1))==null?void 0:U.map((Y,X)=>l.jsx("td",{className:"border border-gray-300 p-0.5 text-center",children:Y||"-"},X))},j)})})]})})};return e?l.jsxs("div",{className:"report-card-container bg-white shadow-2xl rounded-lg border border-gray-200 p-2",children:[l.jsx("style",{children:`
          .font-arabic {
            font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
            font-weight: 600;
            font-size: inherit;
            line-height: 1.6; /* Adjust line height for Nastaliq */
          }
          [dir="rtl"] {
            direction: rtl;
            unicode-bidi: bidi-override;
            font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
          }
          @media print {
            .font-arabic {
              font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
              font-weight: 600;
              font-size: inherit;
              line-height: 1.6;
            }
            [dir="rtl"] {
              font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
            }
          }
        `}),l.jsxs("div",{className:"flex justify-between items-center mb-0",children:[l.jsx("div",{className:"logo-container",style:{width:"auto",height:"auto",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:l.jsx("img",{src:"https://mseducationacademy.in/wp-content/uploads/2023/12/msea-logo-headerx2.png",alt:"MS Education Academy Logo",style:{maxWidth:"250px",maxHeight:"80px",width:"auto",height:"80px",objectFit:"contain"},onError:k=>{k.currentTarget.style.display="none",console.log("Logo 1 failed to load")}})}),l.jsx("div",{className:"logo-container",style:{width:"auto",height:"auto",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:l.jsx("img",{src:"https://mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS HIFZ Academy Logo",referrerPolicy:"no-referrer",style:{maxWidth:"250px",maxHeight:"80px",width:"auto",height:"80px",objectFit:"contain"},onError:k=>{k.currentTarget.style.display="none",console.log("Logo 2 failed to load")}})})]}),l.jsx("div",{className:"bg-violet-800 text-white text-center py-2 font-bold tracking-widest text-lg mb-2 shadow-md uppercase",children:e.reportTitle||"Student Progress Report"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-2",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold",children:"Student Detail"}),l.jsxs("div",{className:"p-4 grid grid-cols-[1fr,2fr] gap-y-2 text-sm font-semibold",children:[l.jsx("span",{className:"text-black-600",children:"Student Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((c=e.student)==null?void 0:c.studentName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Father's Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((u=e.student)==null?void 0:u.fathersName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Class/ Section"}),l.jsxs("span",{className:"text-black-900",children:[": ",((f=e.student)==null?void 0:f.classSection)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Group/ Roll No"}),l.jsxs("span",{className:"text-black-900",children:[": ",((d=e.student)==null?void 0:d.groupRollNo)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Branch Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((p=e.student)==null?void 0:p.branchName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Academic Year"}),l.jsxs("span",{className:"text-black-900",children:[": ",((h=e.student)==null?void 0:h.academicYear)||"N/A"]})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"GRADING SCALE"}),l.jsx("div",{className:"p-2 text-sm font-bold",children:a()})]})]}),e.hifzData&&e.hifzData.length>0&&e.hifzData.some(k=>k.subject&&k.subject!=="")?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-2",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsxs("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"HIFZ"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"حفظ قرآن رپورٹ"})]}),l.jsx("div",{className:"p-2",style:{height:"240px"},children:t.length>0?l.jsx(rh,{width:400,height:220,children:l.jsxs(Xle,{data:t,barSize:30,children:[l.jsx(a2,{strokeDasharray:"3 3",vertical:!1}),l.jsx(u2,{dataKey:"name",fontSize:10}),l.jsx(d2,{fontSize:10,domain:[0,"auto"]}),l.jsx(g1,{}),l.jsx(Fv,{iconType:"rect",wrapperStyle:{fontSize:"10px"}}),l.jsx(l2,{dataKey:"Total Marks",fill:"#22c55e"}),l.jsx(l2,{dataKey:"Secured Marks",fill:"#38bdf8"})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No HIFZ chart data available"})})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"HIFZ REPORT"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"حفظ قرآن رپورٹ"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-100 border-b border-indigo-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"گریڈ"}),l.jsx("th",{className:"p-2 text-left",children:"حاصل شدہ نمبرات"}),l.jsx("th",{className:"p-2 text-left",children:"کل نمبرات"}),l.jsx("th",{className:"p-2 text-right",children:"مضامین"})]})}),l.jsx("tbody",{children:e.hifzData.map((k,W)=>!k.subject||k.subject===""?null:l.jsxs("tr",{className:`border-b ${k.subject==="Total/Grade"?"border-t-2 border-indigo-900 bg-gray-50 font-bold":"border-gray-200"}`,children:[l.jsx("td",{className:"p-2",children:k.grade&&k.grade!=="-"?l.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] text-white font-bold
                              ${["A1","A2"].includes(k.grade)?"bg-green-600":["B1","B2"].includes(k.grade)?"bg-orange-400":["C","C1","C2"].includes(k.grade)?"bg-orange-600":"bg-red-500"}`,children:k.grade}):l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"p-2 font-semibold",children:k.securedMarks||0}),l.jsx("td",{className:"p-2 font-medium",children:k.totalMarks||0}),l.jsxs("td",{className:"p-2 text-right font-bold",children:[l.jsx("span",{className:"block text-[10px] text-gray-600 font-arabic",dir:"rtl",children:k.urduSubject||" "}),k.subject]})]},W)).filter(Boolean)})]})})]})]}):l.jsx("div",{className:"border border-indigo-900 rounded-lg p-4 mb-2 text-center text-gray-500",children:"No HIFZ data available for this student"}),e.academicPerformance&&e.academicPerformance.length>0&&e.academicPerformance.some(k=>k.subject&&k.subject!=="")?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-2",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold",children:"ACADEMIC PERFORMANCE"}),l.jsxs("div",{className:"p-4 grid grid-cols-[1fr,1.5fr]",style:{height:"220px"},children:[l.jsx("div",{className:"flex flex-col justify-center space-y-2",children:e.academicPerformance.filter(k=>k.subject&&k.subject!=="").map((k,W)=>l.jsxs("div",{className:"flex items-center space-x-2 text-[10px] font-medium",children:[l.jsx("div",{className:"w-3 h-3",style:{backgroundColor:k.color||"#f8f8f8ff"}}),l.jsxs("span",{children:[k.subject,": ",k.percentage||0,"%"]})]},W))}),l.jsx("div",{className:"relative",style:{width:"220px",height:"220px"},children:r.length>0?l.jsx(rh,{width:220,height:220,children:l.jsxs(pA,{children:[l.jsx(n2,{data:r,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,paddingAngle:0,startAngle:90,endAngle:-270,dataKey:"value",children:r.map((k,W)=>l.jsx(gu,{fill:k.color},`cell-${W}`))}),l.jsx(g1,{})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"No academic data"})})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"ACADEMIC PERFORMANCE"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"تعلیمی مظاہرہ"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-100 border-b border-indigo-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"گریڈ"}),l.jsx("th",{className:"p-2 text-left",children:"حاصل شدہ نمبرات"}),l.jsx("th",{className:"p-2 text-left",children:"کل نمبرات"}),l.jsx("th",{className:"p-2 text-right",children:"مضامین"})]})}),l.jsx("tbody",{children:e.academicPerformance.filter(k=>k.subject&&k.subject!=="").map((k,W)=>l.jsxs("tr",{className:`border-b ${k.subject==="Total/Grade"?"border-t-2 border-indigo-900 bg-gray-50 font-bold":"border-gray-200"}`,children:[l.jsx("td",{className:"p-2",children:k.grade&&k.grade!=="-"?l.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] text-white font-bold
                              ${["A1","A2"].includes(k.grade)?"bg-green-600":["B1","B2"].includes(k.grade)?"bg-orange-400":["C","C1","C2"].includes(k.grade)?"bg-orange-600":"bg-red-500"}`,children:k.grade}):l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"p-2 font-medium",children:k.securedMarks||0}),l.jsx("td",{className:"p-2 font-medium",children:k.totalMarks||0}),l.jsxs("td",{className:"p-2 text-right font-bold",children:[l.jsx("span",{className:"block text-[10px] text-gray-600 font-arabic",dir:"rtl",children:k.urduSubject||" "}),k.subject]})]},W))})]})})]})]}):l.jsx("div",{className:"border border-indigo-900 rounded-lg p-4 mb-2 text-center text-gray-500",children:"No academic performance data available"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-2",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold uppercase",children:"Attendance"}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsx("div",{className:"w-24 h-24",children:l.jsx(rh,{width:"100%",height:"100%",children:l.jsx(pA,{children:l.jsx(n2,{data:n,cx:"50%",cy:"50%",innerRadius:25,outerRadius:45,dataKey:"value",startAngle:90,endAngle:-270,children:n.map((k,W)=>l.jsx(gu,{fill:k.color},`cell-${W}`))})})})}),l.jsxs("div",{className:"flex-1 ml-4",children:[l.jsx("h4",{className:"text-red-500 text-xs font-bold mb-2 uppercase text-center",children:"Monthly Attendance"}),(m=e.attendance)!=null&&m.monthly&&e.attendance.monthly.length>0?l.jsxs("table",{className:"w-full text-[10px] border border-gray-200",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-indigo-100",children:[l.jsx("th",{className:"border p-1"}),e.attendance.monthly.map((k,W)=>l.jsx("th",{className:"border p-1",children:k.month||`Month ${W+1}`},W))]})}),l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Total"}),e.attendance.monthly.map((k,W)=>l.jsx("td",{className:"border p-1 text-center",children:k.total||0},W))]}),l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Present"}),e.attendance.monthly.map((k,W)=>l.jsx("td",{className:"border p-1 text-center",children:k.present||0},W))]}),l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Absent"}),e.attendance.monthly.map((k,W)=>l.jsx("td",{className:"border p-1 text-center",children:k.absent||0},W))]})]})]}):l.jsx("p",{className:"text-gray-400 text-center text-sm",children:"No attendance data available"})]})]}),l.jsxs("div",{className:"flex justify-center space-x-6 text-[10px] font-bold mt-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-green-400"}),l.jsxs("span",{children:["PRESENT : ",((x=(g=e.attendance)==null?void 0:g.summary)==null?void 0:x.presentCount)||0," (",((S=(b=e.attendance)==null?void 0:b.summary)==null?void 0:S.presentPercentage)||0,"%)"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-red-400"}),l.jsxs("span",{children:["ABSENT : ",((E=(_=e.attendance)==null?void 0:_.summary)==null?void 0:E.absentCount)||0," (",((F=(O=e.attendance)==null?void 0:O.summary)==null?void 0:F.absentPercentage)||0,"%)"]})]}),l.jsx("div",{className:"flex items-center space-x-2 text-indigo-900",children:l.jsxs("span",{children:["TOTAL : ",((C=(M=e.attendance)==null?void 0:M.summary)==null?void 0:C.totalCount)||0]})})]})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"HIFZ TARGET LEVEL"}),l.jsx("div",{className:"p-4",style:{height:"220px"},children:e.hifzTargetLevel&&e.hifzTargetLevel.length>0?l.jsx(rh,{width:450,height:220,children:l.jsxs(Yle,{data:e.hifzTargetLevel,children:[l.jsx(a2,{strokeDasharray:"3 3"}),l.jsx(u2,{dataKey:"month",label:{value:"MONTHS",position:"insideBottom",offset:-5,fontSize:10},fontSize:10}),l.jsx(d2,{label:{value:"PARAS",angle:-90,position:"insideLeft",fontSize:10},fontSize:10}),l.jsx(g1,{}),l.jsx(Fv,{iconType:"circle",wrapperStyle:{fontSize:"10px"}}),l.jsx(i2,{type:"monotone",dataKey:"targetParas",name:"Nazira+Hifz",stroke:"#4a235a",strokeWidth:2,dot:{r:3}}),l.jsx(i2,{type:"monotone",dataKey:"actualParas",name:"Student Performance",stroke:"#ef4444",strokeWidth:2,dot:{r:4},connectNulls:!0})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:l.jsx("span",{children:"No target data available"})})})]})]}),l.jsxs("div",{className:"border border-gray-300 rounded p-2 mb-8 bg-gray-50 relative",children:[l.jsxs("div",{className:"absolute top-2 right-4 text-right",children:[l.jsx("span",{dir:"rtl",className:"font-arabic text-green-700",children:"معلم تاثرات:"}),l.jsx("span",{className:"font-bold text-sm block",children:": Teacher's Remark"})]}),l.jsx("div",{className:"pt-6 text-gray-700 italic mt-2 min-h-[40px]",children:e.teacherRemark||"No remarks provided."})]}),l.jsxs("div",{className:"flex justify-between items-end mt-10 pt-0 border-t border-gray-200",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Parent"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Teacher"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Principal"})]})]})]}):l.jsx("div",{className:"report-card-container p-8 text-center text-gray-500",children:"No report data available"})},lce=()=>{gd.useEffect(()=>{const ye=document.createElement("style");return ye.id="student-report-print-styles",ye.textContent=`
      @media print {
        @page {
          margin: 5mm;
        }

        /* 1. RESET OUTER APP SHELL (Allow scrolling/flow) */
        html, body, #root, #app, .h-screen, .min-h-screen, .student-reports-wrapper {
          margin: 0 !important;
          padding: 0 !important;
          height: auto !important;
          min-height: 0 !important;
          overflow: visible !important;
        }

        /* 2. HIDE UI CHROME (Sidebar, Header, Menu, Back Buttons) */
        .no-print, 
        aside, nav, header, footer,
        button, a[href*="back"], 
        .sidebar, .menu,
        /* Explicitly hide the sidebar/menu container based on the screenshot artifact */
        [class*="sidebar-container"],
        [class*="nav-container"] {
          display: none !important;
        }

        /* 3. REPORT CARD CONTAINER (Preserve internal layout) */
        .report-card-container {
          /* Important: Do NOT reset display to block if it needs to be flex/grid 
             But usually the container itself is a block. 
             We just ensure it has width and no shadow. */
          width: 100% !important;
          margin: 0 !important;
          padding: 15px !important;
          box-shadow: none !important;
          border: none !important;
          
          /* Separation between reports */
          margin-bottom: 20px !important; 
          page-break-after: always; /* Re-introducing clean page break per report */
        }
        
        /* 4. PRESERVE INTERNAL LAYOUT */
        /* Avoid resetting visibility globally on all children as it unhides tooltips */
        
        /* Explicitly hide recharts tooltip in print */
        .recharts-tooltip-wrapper {
          display: none !important;
          visibility: hidden !important;
        }

        /* 5. FIX CHARTS AND IMAGES */
        svg, img {
          max-width: 100% !important;
          /* height: auto !important; <--- Removed this as it might squash fixed-height charts */
          display: block; 
          overflow: visible !important;
        }

        /* 6. HIDE PARENT BACKGROUNDS used for screens */
        body {
          background: white !important;
        }
      }
    `,document.head.appendChild(ye),()=>{const Ce=document.getElementById("student-report-print-styles");Ce&&Ce.remove()}},[]);const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState([]),[c,u]=y.useState([]),[f,d]=y.useState([]),[p,h]=y.useState([]),[m,g]=y.useState(""),[x,b]=y.useState(""),[S,_]=y.useState(""),[E,O]=y.useState(""),[F,M]=y.useState(!1),[C,k]=y.useState(!1),[W,D]=y.useState(!1),[j,H]=y.useState(!1),[U,Y]=y.useState(!1),[X,Z]=y.useState(!1),[K,z]=y.useState(!1),[se,xe]=y.useState(null),[A,I]=y.useState(null),[P,L]=y.useState([]),R=()=>{window.print()},G=async()=>{var Ce,ze;if(!S||p.length===0){xe({type:"error",text:"Please select Test and ensure students are loaded"});return}z(!0),xe(null);const ye=[];try{for(const $e of p){const Ue=$e.student_id||$e.id,Xe=await Ee.get("/report/student",{params:{student_id:Ue,test_id:S,academic_year:e,branch:a,class_id:m,section:x}});ye.push(Xe.data)}L(ye),xe({type:"success",text:`Successfully loaded ${ye.length} student reports! You can now print.`})}catch($e){console.error("Error fetching all student reports:",$e),xe({type:"error",text:((ze=(Ce=$e.response)==null?void 0:Ce.data)==null?void 0:ze.error)||"Failed to load all student reports"})}finally{z(!1)}};y.useEffect(()=>{const ye=localStorage.getItem("academicYear")||"",Ce=localStorage.getItem("user");let ze="All";if(Ce)try{const $e=JSON.parse(Ce);if($e.role==="Admin"||$e.branch==="All"||$e.branch==="AllBranches"){const Ue=localStorage.getItem("currentBranch");Ue&&Ue!=="All"&&Ue!=="All Locations"&&(ze=Ue)}else ze=$e.branch||"All"}catch($e){console.error("Error parsing user",$e)}t(ye),i(ze),n([{branch_name:ze,branch_code:ze}])},[]),y.useEffect(()=>{a&&(k(!0),Ee.get("/classes",{params:{branch:a}}).then(ye=>{const Ce=ye.data.classes||ye.data||[];o(Ce)}).catch(ye=>{console.error("Error fetching classes:",ye),xe({type:"error",text:"Failed to load classes"})}).finally(()=>k(!1)))},[a]),y.useEffect(()=>{const ye=s.find(Ce=>String(Ce.id)===m);if(!ye){u([]),b("");return}D(!0),Ee.get("/sections",{params:{class:ye.class_name}}).then(Ce=>{const ze=Ce.data.sections||Ce.data||[];u(ze)}).catch(Ce=>{console.error("Error fetching sections:",Ce),u([])}).finally(()=>D(!1))},[m,s]),y.useEffect(()=>{if(!m||!e){d([]),_("");return}H(!0),Ee.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:m}}).then(ye=>{const Ce=ye.data||[];d(Ce)}).catch(ye=>{console.error("Error fetching tests:",ye),d([])}).finally(()=>H(!1))},[m,e,a]),y.useEffect(()=>{if(!m||!x){h([]),O("");return}const ye=s.find(Ce=>String(Ce.id)===m);ye&&(Y(!0),Ee.get("/students",{params:{branch:a,class:ye.class_name,section:x,academic_year:e}}).then(Ce=>{const ze=Ce.data.students||Ce.data||[];h(ze)}).catch(Ce=>{console.error("Error fetching students:",Ce),h([])}).finally(()=>Y(!1)))},[m,x,a,e,s]);const J=()=>{if(!E||!S){xe({type:"error",text:"Please select Test and Student"});return}Z(!0),xe(null),I(null),Ee.get("/report/student",{params:{student_id:E,test_id:S,academic_year:e,branch:a,class_id:m,section:x}}).then(ye=>{I(ye.data),xe({type:"success",text:"Report loaded successfully!"})}).catch(ye=>{var Ce,ze;console.error("Error fetching report:",ye),xe({type:"error",text:((ze=(Ce=ye.response)==null?void 0:Ce.data)==null?void 0:ze.error)||"Failed to load report"})}).finally(()=>Z(!1))},q=ye=>{i(ye.target.value),g(""),b(""),_(""),O(""),I(null)},Q=ye=>{g(ye.target.value),b(""),_(""),O(""),I(null)},fe=ye=>{b(ye.target.value),O(""),I(null)},V=ye=>{_(ye.target.value),I(null)},Oe=ye=>{O(ye.target.value),I(null)},Te=()=>{g(""),b(""),_(""),O(""),u([]),d([]),h([]),I(null),xe(null)},be=()=>{var ye,Ce,ze,$e;return l.jsxs("div",{className:"bg-white p-4 rounded shadow-sm mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h2",{className:"text-lg font-bold text-gray-700 flex items-center",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Select Report Filters"]}),l.jsxs("button",{onClick:Te,className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Branch ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("select",{value:a,onChange:q,disabled:r.length<=1,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:r.map(Ue=>l.jsx("option",{value:Ue.branch_code,children:Ue.branch_name},Ue.branch_code))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Class ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:m,onChange:Q,disabled:C,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:C?"Loading...":"Select Class"}),s.map(Ue=>l.jsx("option",{value:Ue.id,children:Ue.class_name},Ue.id))]}),C&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Section ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:x,onChange:fe,disabled:!m||W,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:m?W?"Loading...":"Select Section":"Select Class First"}),c.map(Ue=>l.jsx("option",{value:Ue,children:Ue},Ue))]}),W&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Test/Exam ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:S,onChange:V,disabled:!m||j,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:m?j?"Loading...":"Select Test":"Select Class First"}),f.map(Ue=>l.jsx("option",{value:Ue.test_id,children:Ue.test_name},Ue.test_id))]}),j&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:F?"all":E,onChange:Oe,disabled:!x||U||F,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:x?U?"Loading...":`Select Student (${p.length})`:"Select Section First"}),p.map(Ue=>l.jsxs("option",{value:Ue.student_id||Ue.id,children:[Ue.roll_number," - ",Ue.name||Ue.student_name]},Ue.student_id||Ue.id))]}),U&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),p.length>0&&l.jsxs("label",{className:"flex items-center text-sm text-gray-700 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:F,onChange:Ue=>{M(Ue.target.checked),Ue.target.checked&&(O(""),I(null))},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsxs("span",{className:"font-medium",children:["Select All Students (",p.length,")"]})]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[F?l.jsx("button",{type:"button",onClick:G,disabled:K||!S||p.length===0,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:K?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading ",p.length," Reports..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Get Reports (",p.length,")"]})}):l.jsx("button",{type:"button",onClick:J,disabled:X||!S||!E,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:X?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading Report..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Get Report"]})}),(A||P.length>0)&&l.jsxs("button",{type:"button",onClick:R,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),P.length>0?`Print All Reports (${P.length})`:"Print Report"]}),(m||x||S||E||F)&&l.jsxs("div",{className:"flex flex-wrap gap-2",children:[m&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Class: ",(ye=s.find(Ue=>String(Ue.id)===m))==null?void 0:ye.class_name]}),x&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Section: ",x]}),S&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Test: ",(Ce=f.find(Ue=>String(Ue.test_id)===S))==null?void 0:Ce.test_name]}),F&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["All Students (",p.length,")"]}),E&&!F&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["Student: ",((ze=p.find(Ue=>String(Ue.student_id||Ue.id)===E))==null?void 0:ze.name)||(($e=p.find(Ue=>String(Ue.student_id||Ue.id)===E))==null?void 0:$e.student_name)]})]})]})]})},re=()=>l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[l.jsx("div",{className:"bg-blue-50 rounded-full p-6 mb-6",children:l.jsx("svg",{className:"w-16 h-16 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Report Selected"}),l.jsx("p",{className:"text-gray-500 text-center max-w-md mb-4",children:'Please select Class, Section, Test, and Student from the filters above, then click "Get Report" to view the progress report.'}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{children:"Tip: All filters are required to generate the report"})]})]}),we=()=>l.jsx("div",{className:"flex items-center justify-center py-16 bg-white rounded shadow",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600 font-medium text-lg",children:"Loading Report Data..."}),l.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we fetch the student report"})]})}),ve=()=>{if(!(A!=null&&A.historicalPerformance)||A.historicalPerformance.length<=1)return null;const ye=A.historicalPerformance.filter(Ce=>Ce.academicYear!==A.student.academicYear);return ye.length===0?null:l.jsx("div",{className:"mb-8 no-print",children:l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"PREVIOUS YEAR PERFORMANCE"}),l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"space-y-4",children:ye.map((Ce,ze)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[l.jsx("div",{className:"bg-gray-100 px-4 py-2 flex justify-between items-center",children:l.jsxs("span",{className:"font-semibold text-gray-700",children:[Ce.academicYear," - Class ",Ce.class," ",Ce.section]})}),l.jsx("div",{className:"p-3",children:Ce.tests.map(($e,Ue)=>l.jsxs("div",{className:"mb-3 last:mb-0",children:[l.jsx("h5",{className:"text-sm font-medium text-indigo-700 mb-2",children:$e.testName}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:$e.subjects.map((Xe,Qe)=>l.jsxs("div",{className:`text-xs p-2 rounded 
                              ${Xe.isAbsent?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:[l.jsx("span",{className:"font-medium",children:Xe.subject}),l.jsx("span",{className:"float-right",children:Xe.isAbsent?"AB":`${Xe.securedMarks}/${Xe.maxMarks}`})]},Qe))}),l.jsxs("div",{className:"mt-2 text-right text-sm",children:[l.jsx("span",{className:"font-medium",children:"Total: "}),l.jsxs("span",{className:"text-indigo-600",children:[$e.securedMarks,"/",$e.totalMarks,"(",$e.totalMarks>0?Math.round($e.securedMarks/$e.totalMarks*100):0,"%)"]})]})]},Ue))})]},ze))})})]})})};return l.jsxs("div",{className:"p-4 student-reports-wrapper",children:[l.jsx("h2",{className:"no-print text-xl font-bold text-gray-700 mb-4 border-b pb-2",children:"Student Progress Report"}),l.jsx("div",{className:"no-print",children:be()}),se&&l.jsxs("div",{className:`no-print p-3 rounded mb-4 flex items-center ${se.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[se.type==="error"?l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),se.text]}),X||K?we():!A&&P.length===0?re():l.jsxs("div",{className:"all-reports-container",children:[A&&ve(),A&&l.jsx(mA,{data:A}),P.length>0&&P.map((ye,Ce)=>l.jsx(mA,{data:ye},Ce))]})]})},cce=()=>{const[e,t]=y.useState(localStorage.getItem("academicYear")||""),[r,n]=y.useState(""),[a,i]=y.useState(""),[s,o]=y.useState([]),[c,u]=y.useState(""),[f,d]=y.useState([]),[p,h]=y.useState(""),[m,g]=y.useState([]),[x,b]=y.useState(null),[S,_]=y.useState(!1),[E,O]=y.useState(!1),[F,M]=y.useState(!1),[C,k]=y.useState([]),[W,D]=y.useState(new Set),[j,H]=y.useState(!1),[U,Y]=y.useState(!1),[X,Z]=y.useState(null);y.useEffect(()=>{const R=localStorage.getItem("user");if(R){const G=JSON.parse(R);n(G.role),i(G.branch),G.role==="Admin"||G.branch==="All"||G.branch==="AllBranches"?K().then(J=>{const q=localStorage.getItem("currentBranch");if(q&&q!=="All"&&q!=="All Locations"&&J){const Q=J.find(fe=>fe.branch_code===q||fe.branch_name===q);Q?u(Q.branch_code):J.length>0&&u(J[0].branch_code)}else J&&J.length>0&&u(J[0].branch_code)}):(u(G.branch),o([{branch_code:G.branch,branch_name:G.branch}]))}},[]),y.useEffect(()=>{if(e){const[R,G]=e.split("-"),J=parseInt(R),q=parseInt(G);if(!isNaN(J)&&!isNaN(q)){const Q=[],fe=["","January","February","March","April","May","June","July","August","September","October","November","December"];for(let V=1;V<=12;V++)Q.push({name:fe[V],month:V,year:J,key:`${V}-${J}`});for(let V=1;V<=12;V++)Q.push({name:fe[V],month:V,year:q,key:`${V}-${q}`});k(Q)}}},[e]),y.useEffect(()=>{c?(z(),h(""),g([]),b(null)):(d([]),g([]),h(""))},[c,e]),y.useEffect(()=>{c&&p?(se(),b(null)):(g([]),b(null))},[c,p,e]),y.useEffect(()=>{x&&c&&p?xe():D(new Set)},[x,c,p]);const K=async()=>{_(!0);try{const G=(await Ee.get("/branches")).data.branches||[];return o(G),G}catch(R){return console.error("Failed to fetch branches",R),[]}finally{_(!1)}},z=async()=>{O(!0);try{const R=await Ee.get("/classes",{params:{branch:c}});d(R.data.classes||[])}catch(R){console.error("Failed to fetch classes",R)}finally{O(!1)}},se=async()=>{M(!0);try{const R=await Ee.get("/class-tests/list",{params:{academic_year:e,branch:c,class_id:p}}),J=Array.from(new Map(R.data.map(q=>[q.test_id,q])).values()).map(q=>({id:q.test_id,test_name:q.test_name,is_active:!0}));g(J)}catch(R){console.error("Failed to fetch class tests",R),g([])}finally{M(!1)}},xe=async()=>{if(!(!x||!c||!p)){H(!0),Z(null);try{const R=await Ee.get("/test-attendance",{params:{test_id:x,academic_year:e,branch:c,class_id:p}}),G=new Set;R.data.forEach(J=>{G.add(`${J.month}-${J.year}`)}),D(G)}catch(R){console.error("Failed to fetch mapping",R),Z({type:"error",text:"Failed to load existing attendance settings."})}finally{H(!1)}}},A=async()=>{var R,G;if(!(!x||!c||!p)){Y(!0),Z(null);try{const J=Array.from(W).map(q=>{const[Q,fe]=q.split("-").map(Number);return{month:Q,year:fe}});await Ee.post("/test-attendance",{test_id:x,academic_year:e,branch:c,class_id:p,months:J}),Z({type:"success",text:"Attendance settings saved successfully!"})}catch(J){console.error("Save error",J),Z({type:"error",text:((G=(R=J.response)==null?void 0:R.data)==null?void 0:G.error)||"Failed to save settings."})}finally{Y(!1)}}},I=R=>{const G=new Set(W);if(G.has(R))G.delete(R);else{if(G.size>=12){alert("You cannot select more than 12 months.");return}G.add(R)}D(G)},P=()=>{W.size>0?D(new Set):Z({type:"error",text:"Please manually select the months (Max 12)."})},L=R=>{const G=C.filter(J=>J.year===R);return G.length===0?null:l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"font-bold text-gray-700 mb-3 border-b pb-1",children:R}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:G.map(J=>l.jsxs("label",{className:`
                                flex items-center gap-3 p-3 rounded border cursor-pointer transition-all
                                ${W.has(J.key)?"bg-blue-50 border-blue-200 ring-1 ring-blue-200":"hover:bg-gray-50 border-gray-200"}
                            `,children:[l.jsx("input",{type:"checkbox",checked:W.has(J.key),onChange:()=>I(J.key),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),l.jsx("div",{children:l.jsx("div",{className:"font-medium text-gray-800",children:J.name})})]},J.key))})]})};return l.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[l.jsx(_F,{className:"text-[#337ab7]"}),"Set Exam Attendance"]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("div",{className:"p-2 bg-gray-100 rounded border text-gray-700 font-medium",children:e})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsxs("select",{value:c,disabled:!0,onChange:R=>{u(R.target.value),h("")},className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"-- Select Branch --"}),s.map(R=>l.jsx("option",{value:R.branch_code,children:R.branch_name},R.branch_code))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsxs("select",{value:p,onChange:R=>h(R.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",disabled:!c||E,children:[l.jsx("option",{value:"",children:"-- Select Class --"}),f.map(R=>l.jsx("option",{value:R.id,children:R.class_name},R.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Exam"}),l.jsxs("select",{value:x||"",onChange:R=>b(Number(R.target.value)||null),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",disabled:F,children:[l.jsx("option",{value:"",children:"-- Select Exam --"}),m.map(R=>l.jsx("option",{value:R.id,children:R.test_name},R.id))]})]})]}),l.jsxs("div",{className:"bg-blue-50 text-blue-800 p-4 rounded-md text-sm mb-6 flex items-start gap-2",children:[l.jsx(Oh,{size:18,className:"mt-0.5"}),l.jsxs("p",{children:["Select the months that should be considered for attendance calculation for this specific ",l.jsx("strong",{children:"Class & Exam"}),".",l.jsx("br",{}),"Allowed range: ",l.jsx("strong",{children:"Jan 2025 - Dec 2026"}),". Max selection: ",l.jsx("strong",{children:"12 months"}),"."]})]}),x&&c&&p&&l.jsxs("div",{className:"animate-fade-in",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h3",{className:"font-semibold text-gray-700",children:["Attendance Months (",W.size,"/12)"]}),l.jsx("button",{onClick:P,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Clear Selection"})]}),j?l.jsx("div",{className:"py-8 text-center text-gray-500",children:"Loading settings..."}):l.jsx("div",{children:e.split("-").map(R=>{const G=parseInt(R);return isNaN(G)?null:L(G)})}),l.jsxs("div",{className:"mt-8 flex items-center justify-between border-t pt-4",children:[l.jsx("div",{children:X&&l.jsxs("span",{className:`text-sm flex items-center gap-1 ${X.type==="error"?"text-red-600":"text-green-600"}`,children:[X.type==="success"?l.jsx(NF,{size:16}):l.jsx(Oh,{size:16}),X.text]})}),l.jsx("button",{onClick:A,disabled:U||j||W.size===0,className:"bg-[#337ab7] text-white px-6 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 font-medium",children:U?"Saving...":l.jsxs(l.Fragment,{children:[l.jsx(xu,{size:18})," Save Settings"]})})]})]}),(!x||!c||!p)&&l.jsx("div",{className:"text-center py-10 text-gray-400",children:"Please select Branch, Class, and Exam to configure attendance."})]})]})},yf=({title:e,items:t})=>{const[r,n]=y.useState(!1);return l.jsxs("div",{className:"relative",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[l.jsxs("button",{className:"flex items-center gap-1 px-3 py-2 text-sm font-medium text-white bg-[#337ab7] hover:bg-[#286090] rounded",children:[e," ",l.jsx(jF,{size:14})]}),r&&l.jsx("div",{className:"absolute right-0 z-50 w-64 bg-white border shadow rounded-b py-2",children:t.map((a,i)=>l.jsxs("button",{onClick:a.disabled?void 0:a.onClick,disabled:a.disabled,className:`block w-full text-left px-4 py-2 text-sm
                ${a.disabled?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100 hover:text-[#337ab7]"}
              `,children:[a.label,a.disabled&&l.jsx("span",{className:"ml-2 text-xs",children:"(Coming soon)"})]},i))})]})},uce=()=>{const[e,t]=y.useState("HOME");return l.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:l.jsx("div",{className:"flex-1 flex flex-col",children:l.jsxs("div",{className:"bg-white flex-1 flex flex-col",children:[e==="HOME"&&l.jsxs("div",{className:"p-4 flex flex-wrap justify-between border-b",children:[l.jsxs("h1",{className:"flex items-center gap-2 text-[#337ab7] font-semibold",children:[l.jsx(o5,{className:"text-gray-400"}),"ACADEMICS MANAGEMENT"]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx(yf,{title:"Enter Marks",items:[{label:"Subject Wise",onClick:()=>t("MARKS_ENTRY_SUBJECT")},{label:"Upload Exam Marks",onClick:()=>t("MARKS_ENTRY_UPLOAD")},{label:"Marks Progress Report",disabled:!0},{label:"Student Health Details",disabled:!0}]}),l.jsx(yf,{title:"Config",items:[{label:"Student Health Config",disabled:!0},{label:"Assign Favorites to Class",disabled:!0}]}),l.jsx(yf,{title:"Academic Actions",items:[{label:"Assign Class Subjects",onClick:()=>t("ASSIGN_SUBJECTS")},{label:"Assign Student Subjects",onClick:()=>t("ASSIGN_STUDENT_SUBJECTS")},{label:"Assign Subject Tests",onClick:()=>t("ASSIGN_SUBJECT_TESTS")},{label:"Assign Test to Students",onClick:()=>t("ASSIGN_STUDENT_TESTS")},{label:"Set Exam Roaster",disabled:!0},{label:"Set Exam Attendance",onClick:()=>t("SET_EXAM_ATTENDANCE")},{label:"Freeze Marks",disabled:!0},{label:"Publish Report Card",disabled:!0}]}),l.jsx(yf,{title:"Masters",items:[...JSON.parse(localStorage.getItem("user")||"{}").role==="Admin"?[{label:"Subjects",onClick:()=>t("SUBJECTS")}]:[],{label:"Create Test",onClick:()=>t("CREATE_TEST")},{label:"Add Exam",onClick:()=>t("ADD_EXAM")},{label:"Grading",onClick:()=>t("GRADING")},{label:"Academic Setting",disabled:!0}]}),l.jsx(yf,{title:"Reports",items:[{label:"Student Report Card",onClick:()=>t("STUDENT_REPORT_CARD")},{label:"Absent Report",disabled:!0},{label:"Subject Wise Toppers",disabled:!0},{label:"Performance Index",disabled:!0}]})]})]}),l.jsxs("div",{className:`flex-1 bg-slate-50 ${e==="ADD_EXAM"?"p-2":"p-6"}`,children:[e!=="HOME"&&l.jsx("button",{onClick:()=>t("HOME"),className:"no-print mb-4 text-sm text-gray-600 hover:text-[#337ab7] flex items-center gap-1",children:"← Back to Menu"}),e==="HOME"&&l.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400 h-full py-20",children:[l.jsx(o5,{size:48,className:"mb-2 opacity-20"}),l.jsx("p",{children:"Select an action from the menu above to manage academic data."})]}),e==="SUBJECTS"&&l.jsx(OF,{}),e==="ASSIGN_SUBJECTS"&&l.jsx(FF,{}),e==="ASSIGN_STUDENT_SUBJECTS"&&l.jsx(LF,{}),e==="ASSIGN_SUBJECT_TESTS"&&l.jsx(RF,{}),e==="ASSIGN_STUDENT_TESTS"&&l.jsx(BF,{}),e==="CREATE_TEST"&&l.jsx(DF,{}),e==="ADD_EXAM"&&l.jsx(IF,{}),e==="GRADING"&&l.jsx(UF,{}),e==="MARKS_ENTRY_SUBJECT"&&l.jsx(zW,{}),e==="MARKS_ENTRY_UPLOAD"&&l.jsx($W,{}),e==="STUDENT_REPORT_CARD"&&l.jsx(lce,{}),e==="SET_EXAM_ATTENDANCE"&&l.jsx(cce,{}),!["HOME","SUBJECTS","ASSIGN_SUBJECTS","ASSIGN_STUDENT_SUBJECTS"].includes(e)&&l.jsx("div",{className:"text-gray-500"})]})]})})})};var Nh={exports:{}},fce=Nh.exports,gA;function dce(){return gA||(gA=1,(function(e,t){(function(r,n){n()})(fce,function(){function r(u,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function n(u,f,d){var p=new XMLHttpRequest;p.open("GET",u),p.responseType="blob",p.onload=function(){c(p.response,f,d)},p.onerror=function(){console.error("could not download file")},p.send()}function a(u){var f=new XMLHttpRequest;f.open("HEAD",u,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(f)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof L0=="object"&&L0.global===L0?L0:void 0,o=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(u,f,d){var p=s.URL||s.webkitURL,h=document.createElement("a");f=f||u.name||"download",h.download=f,h.rel="noopener",typeof u=="string"?(h.href=u,h.origin===location.origin?i(h):a(h.href)?n(u,f,d):i(h,h.target="_blank")):(h.href=p.createObjectURL(u),setTimeout(function(){p.revokeObjectURL(h.href)},4e4),setTimeout(function(){i(h)},0))}:"msSaveOrOpenBlob"in navigator?function(u,f,d){if(f=f||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(r(u,d),f);else if(a(u))n(u,f,d);else{var p=document.createElement("a");p.href=u,p.target="_blank",setTimeout(function(){i(p)})}}:function(u,f,d,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof u=="string")return n(u,f,d);var h=u.type==="application/octet-stream",m=/constructor/i.test(s.HTMLElement)||s.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||h&&m||o)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var _=x.result;_=g?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=_:location=_,p=null},x.readAsDataURL(u)}else{var b=s.URL||s.webkitURL,S=b.createObjectURL(u);p?p.location=S:location.href=S,p=null,setTimeout(function(){b.revokeObjectURL(S)},4e4)}});s.saveAs=c.saveAs=c,e.exports=c})})(Nh)),Nh.exports}var h8=dce();const hce=({activeTab:e,onTabChange:t,onAction:r})=>{const[n,a]=y.useState(null),i="px-3 py-1.5 text-sm border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",s="px-3 py-1.5 text-sm border border-transparent bg-sky-600 text-white rounded-md",o=({title:u,children:f})=>{const d=n===u;return l.jsxs("div",{className:"relative inline-block text-left",children:[l.jsxs("button",{type:"button",className:`${i} flex items-center`,onClick:()=>a(d?null:u),onBlur:()=>setTimeout(()=>a(null),200),children:[u,l.jsx(Nl,{className:"w-4 h-4 ml-1"})]}),d&&l.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:l.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:f})})]})},c=({children:u,action:f})=>l.jsx("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",onClick:d=>{d.preventDefault(),f&&r(f)},children:u});return l.jsx("div",{className:"bg-white p-3 border-b",children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[l.jsx("div",{children:l.jsxs("h2",{className:"text-lg font-semibold text-gray-700",children:["STUDENT ATTENDANCE",l.jsx("span",{className:"text-gray-400 mx-2",children:"/"}),l.jsx("span",{className:"text-sm bg-gray-200 text-gray-600 font-medium px-2 py-1 rounded",children:"Non Biometric"})]})}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("button",{className:e==="take"?s:i,onClick:()=>t("take"),children:"Take Attendance"}),l.jsx("button",{className:e==="register"?s:i,onClick:()=>t("register"),children:"Register View"}),l.jsxs(o,{title:"Reports",children:[l.jsx(c,{action:"Absent Report",children:"Absent Report"}),l.jsx(c,{action:"SMS",children:"Send SMS To All Present Students"}),l.jsx(c,{action:"Month Report",children:"Month Report"})]})]})]})})},xA=()=>{const[e,t]=y.useState([]),[r,n]=y.useState({}),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState(new Date().toISOString().split("T")[0]),[f,d]=y.useState(!1),[p,h]=y.useState([]),[m,g]=y.useState(!1),[x,b]=y.useState(0),[S,_]=y.useState(null);y.useEffect(()=>{Ee.get("/classes").then(C=>h(C.data.classes||[])).catch(C=>console.error("Failed to load classes",C))},[]);const E=async()=>{if(!a){alert("Please select a class");return}d(!0);try{const C=localStorage.getItem("currentBranch")||"All",k=C==="All Branches"||C==="All"?"All":C,W=await Ee.get("/attendance",{params:{class:a,section:s,date:c,branch:k}}),D=W.data.students||[],j=W.data.attendance||{};t(D),b(W.data.class_update_count||0),_(W.data.last_modified);const H={};D.forEach(Y=>{const X=j[Y.student_id]||"Present";H[Y.student_id]=X}),n(H);const U=Object.keys(j).length>0;g(U)}catch(C){console.error("Error fetching students:",C),alert("Failed to fetch students")}finally{d(!1)}},O=(C,k)=>{n(W=>({...W,[C]:k}))},F=C=>{const k=e.reduce((W,D)=>(W[D.student_id]=C,W),{});n(k)},M=async()=>{d(!0);try{const C={date:c,attendance:Object.entries(r).map(([k,W])=>({student_id:parseInt(k),status:W}))};await Ee.post("/attendance",C),alert("Attendance saved successfully!"),E()}catch(C){console.error("Error saving attendance:",C),alert("Failed to save attendance")}finally{d(!1)}};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsx("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg",children:"TAKE ATTENDANCE"}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Attendance Date"}),l.jsx("input",{type:"date",value:c,onChange:C=>u(C.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:a,onChange:C=>i(C.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"--Select Class--"}),p.map(C=>l.jsx("option",{value:C.class_name,children:C.class_name},C.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:s,onChange:C=>o(C.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"--All Sections--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("button",{onClick:E,disabled:f,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:f?"Loading...":"Get Students"})]}),e.length>0&&l.jsxs("div",{className:"overflow-x-auto border rounded-lg",children:[l.jsxs("div",{className:"p-2 bg-gray-50 border-b flex gap-2",children:[l.jsx("button",{onClick:()=>F("Present"),className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded border border-green-200 hover:bg-green-200",children:"Mark All Present"}),l.jsx("button",{onClick:()=>F("Holiday"),className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded border border-gray-200 hover:bg-gray-200",children:"Mark All Holiday"}),l.jsx("button",{onClick:()=>F("Sunday"),className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded border border-red-200 hover:bg-red-200",children:"Mark All Sunday"})]}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No."}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Adm No."}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Student Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Father Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Phone"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(C=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.rollNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.admNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium text-gray-900",children:C.name}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:C.father}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:C.smsNo||C.fatherMobile}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("div",{className:"flex items-center space-x-3",children:[{val:"Present",label:"P",color:"green"},{val:"Absent",label:"A",color:"red"},{val:"Holiday",label:"H",color:"gray"},{val:"Sunday",label:"S",color:"pink"}].map(k=>l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:`status-${C.student_id}`,checked:r[C.student_id]===k.val,onChange:()=>O(C.student_id,k.val),className:`h-4 w-4 text-${k.color}-600 border-gray-300 focus:ring-${k.color}-500`}),l.jsx("span",{className:`ml-1 text-${k.color}-700 font-medium`,children:k.label})]},k.val))})})]},C.student_id))})]}),l.jsx("div",{className:"p-4 bg-gray-50 border-t flex justify-end",children:l.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l.jsx("button",{onClick:M,disabled:f,className:`${m?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"} text-white px-6 py-2 rounded-md text-sm font-semibold disabled:bg-gray-400`,children:f?m?"Updating...":"Saving...":m?`Update Attendance (Updates: ${x})`:"Save Attendance"}),m&&S&&l.jsxs("div",{className:"text-xs text-gray-500",children:["Last Modified: ",new Date(S).toLocaleString()]})]})})]})]})]})})},pce=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState(new Date().getMonth()+1),[s,o]=y.useState(new Date().getFullYear()),[c,u]=y.useState([]),[f,d]=y.useState(null),[p,h]=y.useState(!1);y.useEffect(()=>{Ee.get("/classes").then(E=>u(E.data.classes||[])).catch(E=>console.error("Failed to load classes",E))},[]);const m=async()=>{if(!e){alert("Please select a class");return}h(!0);try{const E=localStorage.getItem("currentBranch")||"All",O=E==="All Branches"||E==="All"?"All":E,F=await Ee.get("/attendance",{params:{class:e,section:r,month:a,year:s,branch:O}});d(F.data)}catch(E){console.error("Error fetching report:",E),alert("Failed to fetch report")}finally{h(!1)}},g=new Date(s,a,0).getDate(),x=Array.from({length:g},(E,O)=>O+1),b=E=>{switch(E){case"Present":return"bg-green-100 text-green-800";case"Absent":return"bg-red-100 text-red-800";case"Leave":return"bg-yellow-100 text-yellow-800";case"Holiday":return"bg-gray-100 text-gray-800";case"Sunday":return"bg-pink-100 text-pink-800";case"Weekoff":return"bg-blue-100 text-blue-800";default:return""}},S=E=>E?E.charAt(0):"-",_=()=>{if(!f)return;const E=[],O=["Student Name","Admission No",...x.map(W=>W.toString()),"Present","Absent","Total Working Days","Attendance %"];E.push(O),f.students.forEach(W=>{const D=f.attendance[W.student_id]||{};let j=0,H=0;const U=x.map(Z=>{const K=`${s}-${String(a).padStart(2,"0")}-${String(Z).padStart(2,"0")}`,z=D[K];return z==="Present"?(j++,"P"):z==="Absent"?(H++,"A"):"-"}),Y=j+H,X=Y>0?(j/Y*100).toFixed(1):"0.0";E.push([W.name,W.admNo,...U,j,H,Y,`${X}%`])});const F=pa.aoa_to_sheet(E),M=pa.book_new();pa.book_append_sheet(M,F,"Attendance Register");const C=em(M,{bookType:"xlsx",type:"array"}),k=new Blob([C],{type:"application/octet-stream"});h8.saveAs(k,`Attendance_${e}_${a}_${s}.xlsx`)};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsx("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg",children:"ATTENDANCE REGISTER"}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:e,onChange:E=>t(E.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select Class--"}),c.map(E=>l.jsx("option",{value:E.class_name,children:E.class_name},E.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:r,onChange:E=>n(E.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--All Sections--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Month"}),l.jsx("select",{value:a,onChange:E=>i(parseInt(E.target.value)),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:Array.from({length:12},(E,O)=>O+1).map(E=>l.jsx("option",{value:E,children:new Date(0,E-1).toLocaleString("default",{month:"long"})},E))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year"}),l.jsx("input",{type:"number",value:s,onChange:E=>o(parseInt(E.target.value)),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),l.jsx("button",{onClick:m,disabled:p,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:p?"Loading...":"Get Register"})]}),f&&l.jsx("div",{className:"overflow-x-auto border rounded-lg mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-500 sticky left-0 bg-gray-50 z-10 w-48",children:"Student"}),x.map(E=>{const F=new Date(s,a-1,E).toLocaleDateString("en-US",{weekday:"short"});return l.jsx("th",{className:"px-1 py-2 text-center font-medium text-gray-500 w-8 border-l border-gray-100",children:l.jsxs("div",{className:"flex flex-col items-center justify-center leading-tight",children:[l.jsx("span",{children:E}),l.jsx("span",{className:"text-[10px] font-normal text-gray-400",children:F})]})},E)}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50 border-l border-blue-100",children:"Present"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Absent"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Total Working Days"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Attendance %"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.students.map(E=>{const O=f.attendance[E.student_id]||{};let F=0,M=0;x.forEach(W=>{const D=`${s}-${String(a).padStart(2,"0")}-${String(W).padStart(2,"0")}`,j=O[D];j==="Present"&&F++,j==="Absent"&&M++});const C=F+M,k=C>0?(F/C*100).toFixed(1):"0.0";return l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[l.jsxs("td",{className:"px-2 py-1 whitespace-nowrap font-medium text-gray-900 sticky left-0 bg-white z-10 border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:[l.jsx("div",{children:E.name}),l.jsx("div",{className:"text-[10px] text-gray-500",children:E.admNo})]}),x.map(W=>{const D=`${s}-${String(a).padStart(2,"0")}-${String(W).padStart(2,"0")}`,j=O[D];return l.jsx("td",{className:`px-1 py-1 text-center border-l border-gray-100 ${b(j)}`,children:S(j)},W)}),l.jsx("td",{className:"px-2 py-1 text-center font-bold text-green-700 bg-blue-50 border-l border-blue-100",children:F}),l.jsx("td",{className:"px-2 py-1 text-center font-bold text-red-700 bg-blue-50",children:M}),l.jsx("td",{className:"px-2 py-1 text-center font-semibold text-gray-700 bg-blue-50",children:C}),l.jsxs("td",{className:"px-2 py-1 text-center font-bold text-blue-700 bg-blue-50",children:[k,"%"]})]},E.student_id)})}),l.jsxs("div",{className:"right p-2 mt-2",children:[l.jsx("button",{onClick:_,disabled:!f,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 text-sm disabled:bg-gray-400",children:"Export Excel"})," "]})]})})]})]})})},mce=()=>{const[e,t]=y.useState("today"),[r,n]=y.useState(new Date().toISOString().split("T")[0]),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState(""),[f,d]=y.useState([]),[p,h]=y.useState(null),[m,g]=y.useState([]),[x,b]=y.useState(!1),[S,_]=y.useState([]);y.useEffect(()=>{Ee.get("/classes").then(C=>_(C.data.classes||[])).catch(C=>console.error("Failed to load classes",C))},[]);const E=async()=>{if(!c){alert("Please enter a search term");return}b(!0);try{const C=localStorage.getItem("currentBranch")||"All",k=C==="All Branches"||C==="All"?"All":C,D=(await Ee.get("/students",{params:{search:c,branch:k}})).data.students||[];D.length===0?(alert("No students found"),d([])):D.length===1?(d([]),O(D[0])):(d(D),h(null))}catch(C){console.error("Error searching students:",C),alert("Failed to search students")}finally{b(!1)}},O=C=>{h(C),d([]),F(C.student_id)},F=async C=>{b(!0);try{const W=(await Ee.get("/attendance",{params:{student_id:C}})).data.attendance||{},D=[];W[C]&&Object.entries(W[C]).forEach(([j,H])=>{D.push({date:j,status:H})}),D.sort((j,H)=>new Date(H.date).getTime()-new Date(j.date).getTime()),g(D)}catch(k){console.error("Error fetching report:",k),alert("Failed to fetch report")}finally{b(!1)}},M=async()=>{b(!0),g([]);try{const C=localStorage.getItem("currentBranch")||"All",W={date:r,branch:C==="All Branches"||C==="All"?"All":C};a&&(W.class=a);const D=await Ee.get("/attendance",{params:W}),j=D.data.students||[],H=D.data.attendance||{},U=j.filter(Y=>{const X=H[Y.student_id];return X==="Absent"||X==="Leave"}).map(Y=>({...Y,status:H[Y.student_id]}));g(U)}catch(C){console.error("Error fetching report:",C),alert("Failed to fetch report")}finally{b(!1)}};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsxs("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg flex justify-between items-center",children:[l.jsx("span",{children:"ABSENT REPORT"}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>{t("today"),g([]),h(null)},className:`px-3 py-1 text-xs rounded ${e==="today"?"bg-white text-sky-600":"bg-sky-700 text-white"}`,children:"Today's Absentees"}),l.jsx("button",{onClick:()=>{t("student"),g([])},className:`px-3 py-1 text-xs rounded ${e==="student"?"bg-white text-sky-600":"bg-sky-700 text-white"}`,children:"Student Report"})]})]}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-4 items-end",children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),l.jsx("input",{type:"date",value:r,onChange:C=>n(C.target.value),className:"mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class (Optional)"}),l.jsxs("select",{value:a,onChange:C=>i(C.target.value),className:"mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm w-40",children:[l.jsx("option",{value:"",children:"All Classes"}),S.map(C=>l.jsx("option",{value:C.class_name,children:C.class_name},C.id))]})]}),l.jsx("button",{onClick:M,disabled:x,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:x?"Searching...":"Search"})]}):l.jsxs("div",{className:"w-full space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-3 rounded-md border",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Find Student by Class & Section"}),l.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:a,onChange:C=>{i(C.target.value),C.target.value},className:"mt-1 w-40 px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select--"}),S.map(C=>l.jsx("option",{value:C.class_name,children:C.class_name},C.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:s,onChange:C=>o(C.target.value),className:"mt-1 w-40 px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("button",{onClick:async()=>{if(!a){alert("Please select a class");return}b(!0);try{const C=localStorage.getItem("currentBranch")||"All",W={class:a,branch:C==="All Branches"||C==="All"?"All":C};s&&(W.section=s);const D=await Ee.get("/students",{params:W});d(D.data.students||[]),h(null)}catch(C){console.error(C),alert("Error fetching students")}finally{b(!1)}},disabled:x,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:"Get Students"})]})]}),l.jsxs("div",{className:"relative flex items-center py-2",children:[l.jsx("div",{className:"flex-grow border-t border-gray-300"}),l.jsx("span",{className:"flex-shrink-0 mx-4 text-gray-400 text-xs",children:"OR SEARCH BY DETAILS"}),l.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),l.jsxs("div",{className:"flex gap-2 items-end",children:[l.jsxs("div",{className:"flex-grow",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Search Student (Name, Adm No, Phone)"}),l.jsx("input",{type:"text",value:c,onChange:C=>u(C.target.value),placeholder:"Enter Name, Admission No, or Phone",className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",onKeyDown:C=>C.key==="Enter"&&E()})]}),l.jsx("button",{onClick:E,disabled:x,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:"Find"})]}),f.length>0&&l.jsx("div",{className:"mt-2 border rounded-md max-h-40 overflow-y-auto bg-gray-50",children:f.map(C=>l.jsxs("div",{onClick:()=>O(C),className:"p-2 hover:bg-violet-100 cursor-pointer border-b last:border-b-0 text-sm",children:[l.jsxs("span",{className:"font-semibold",children:[C.first_name," ",C.last_name]}),l.jsxs("span",{className:"text-gray-500 ml-2",children:["(",C.admission_no,") - Class ",C.class," ",C.section?`- Sec ${C.section}`:""]})]},C.student_id))}),p&&l.jsxs("div",{className:"mt-6 bg-white border rounded-lg shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"bg-violet-50 px-4 py-3 border-b border-violet-100 flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-violet-800",children:"Student Profile"}),l.jsx("button",{onClick:()=>h(null),className:"text-sm text-violet-600 hover:text-violet-800 hover:underline",children:"Change Student"})]}),l.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"md:col-span-1 flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full mb-3 flex items-center justify-center overflow-hidden border-2 border-white shadow-md",children:p.photo?l.jsx("img",{src:p.photo,alt:p.name,className:"w-full h-full object-cover"}):l.jsx("span",{className:"text-3xl text-gray-400",children:"👤"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:p.name}),l.jsx("p",{className:"text-sm text-gray-500",children:p.admNo}),l.jsx("div",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]}),l.jsxs("div",{className:"md:col-span-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-2 uppercase text-xs tracking-wider",children:"Academic Details"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Class & Section:"}),l.jsxs("span",{className:"font-medium text-gray-900",children:[p.class," - ",p.section||"N/A"]})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Roll Number:"}),l.jsx("span",{className:"font-medium text-gray-900",children:p.rollNo||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Admission Date:"}),l.jsx("span",{className:"font-medium text-gray-900",children:p.admission_date||"-"})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-2 uppercase text-xs tracking-wider",children:"Personal Details"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Father Name:"}),l.jsx("span",{className:"font-medium text-gray-900",children:p.father||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Mobile:"}),l.jsx("span",{className:"font-medium text-gray-900",children:p.smsNo||p.fatherMobile||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"DOB:"}),l.jsx("span",{className:"font-medium text-gray-900",children:p.dob||"-"})]})]})]}),l.jsxs("div",{className:"sm:col-span-2 mt-2",children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Address"}),l.jsx("p",{className:"text-gray-700 bg-gray-50 p-2 rounded border border-gray-100",children:p.address||"No address provided"})]})]})]}),m.length>0&&l.jsxs("div",{className:"bg-gray-50 border-t px-4 py-3 grid grid-cols-2 sm:grid-cols-5 gap-4 text-center",children:[l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Total Days"}),l.jsx("div",{className:"text-xl font-bold text-gray-800",children:m.length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-green-600 uppercase font-semibold",children:"Present"}),l.jsx("div",{className:"text-xl font-bold text-green-700",children:m.filter(C=>C.status==="Present").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-red-600 uppercase font-semibold",children:"Absent"}),l.jsx("div",{className:"text-xl font-bold text-red-700",children:m.filter(C=>C.status==="Absent").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-yellow-600 uppercase font-semibold",children:"Leave"}),l.jsx("div",{className:"text-xl font-bold text-yellow-700",children:m.filter(C=>C.status==="Leave").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Percentage"}),l.jsxs("div",{className:"text-xl font-bold text-blue-700",children:[m.length>0?Math.round(m.filter(C=>C.status==="Present").length/m.length*100):0,"%"]})]})]})]})]})}),m.length>0?l.jsx("div",{className:"overflow-x-auto border rounded-lg mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsx("tr",{children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Class"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Adm No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Father Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Phone"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]}):l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Date"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]})})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((C,k)=>l.jsx("tr",{children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.class}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.rollNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.admNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:C.name}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:C.father}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:C.smsNo||C.fatherMobile}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${C.status==="Absent"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:C.status})})]}):l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:C.date}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${C.status==="Present"?"bg-green-100 text-green-800":C.status==="Absent"?"bg-red-100 text-red-800":C.status==="Leave"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:C.status})})]})},k))})]})}):!x&&(e==="today"||p)&&l.jsx("div",{className:"text-center text-gray-500 mt-4",children:"No records found"})]})]})})},vA=({navigateTo:e,defaultTab:t="take"})=>{const[r,n]=y.useState(t),a=s=>{s==="Absent Report"?n("absent-report"):s==="Month Report"&&n("register")},i=()=>{switch(r){case"take":return l.jsx(xA,{});case"register":return l.jsx(pce,{});case"absent-report":return l.jsx(mce,{});case"today":return l.jsx("div",{className:"p-4 text-center text-gray-500",children:"Today's Report Coming Soon"});default:return l.jsx(xA,{})}};return l.jsxs("div",{className:"h-full overflow-y-auto bg-gray-100",children:[l.jsx(hce,{activeTab:r,onTabChange:n,onAction:a}),i()]})},gce=({onImportSuccess:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(""),i=u=>{u.target.files&&u.target.files.length>0&&(r(u.target.files[0]),a(""))},s=async()=>{if(t){const u=new FormData;u.append("file",t),a("Uploading...");try{const d=(await Ee.post("/students/upload_csv",u,{headers:{"Content-Type":"multipart/form-data"}})).data;a(d.message||"Upload successful!"),setTimeout(()=>{e()},1500)}catch(f){if(console.error("Upload error:",f),f.response){console.error("Backend response data:",f.response.data);const d=f.response.data;d.errors&&d.errors.length>0?a(`Upload failed. Errors: ${d.errors.join(", ")}`):a(`Error: ${d.error||d.message||"Upload failed"}`)}else f.request?a("Network error: No response from server. Ensure backend is running."):a(`Error: ${f.message}`)}}else a("Please select a file to upload.")},o=async()=>{var u;try{const f=await Ee.get("/students/template",{responseType:"blob"}),d=window.URL.createObjectURL(new Blob([f.data])),p=document.createElement("a");p.href=d,p.setAttribute("download","student_import_template.xlsx"),document.body.appendChild(p),p.click(),(u=p.parentNode)==null||u.removeChild(p),window.URL.revokeObjectURL(d)}catch(f){console.error("Error downloading template:",f),alert("Failed to download template. Please check if backend is running.")}},c=["Please don't make any changes in given template.","Only 2000 records are accepted in the list at a time.","The data should be in valid format to upload successfully.","Student and father first name is mandatory field to import data.","Mobile no and Adhar no should be in text format.(Setting- Format cells)","Date should be in DD/MM/YYYY Format only using separators (/, - , .)","For Status please enter 0 for new and 1 for Promoted student.","For Gender please enter 1 for male, 2 for female, 3 for other.","Please make a separate file for each class.","Section column is mandatory.","For student type (Enter 1 for day scholar and 2 for hosteller) otherwise considered as day scholar."];return l.jsx("div",{className:"p-4 md:p-6 bg-gray-100",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsxs("div",{className:"p-4 border-b flex items-center space-x-2",children:[l.jsx(XO,{className:"w-6 h-6 text-gray-600"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Import Student Data"}),l.jsx("a",{href:"#",className:"text-sm text-blue-500 hover:underline",children:"Get Help"})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("label",{className:"block text-md font-medium text-gray-800",children:"Browse for the excel sheet:"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"cursor-pointer bg-white border border-gray-300 rounded-l-md px-4 py-2 text-gray-700 hover:bg-gray-50 whitespace-nowrap",children:["Choose File",l.jsx("input",{type:"file",className:"hidden",onChange:i,accept:".csv, .xlsx, .xls"})]}),l.jsx("input",{type:"text",value:t?t.name:"No file chosen",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-r-md bg-gray-50 focus:outline-none"}),l.jsx("button",{onClick:s,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 whitespace-nowrap",children:"Upload Excel"})]}),n&&l.jsx("p",{className:`mt-2 text-sm ${n.includes("successfully")?"text-green-600":"text-red-600"}`,children:n})]})]}),l.jsx("div",{className:"bg-[#fff0f0] rounded-lg shadow-md border-l-4 border-red-500",children:l.jsxs("div",{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-bold text-red-700 mb-3",children:"Important Instruction"}),l.jsx("p",{className:"text-sm text-gray-800 mb-4",children:"Note: Please read the following instructions:"}),l.jsx("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700",children:c.map((u,f)=>l.jsx("li",{children:u},f))}),l.jsx("div",{className:"mt-6",children:l.jsxs("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center space-x-2 shadow-md",children:[l.jsx(QA,{className:"w-5 h-5"}),l.jsx("span",{children:"Download Excel Template"})]})})]})})]})})},I1="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm disabled:bg-gray-100 disabled:text-gray-500",p8="block text-sm font-medium text-gray-700 mb-1",Rc=gd.memo(({title:e,children:t,defaultOpen:r=!1})=>{const[n,a]=y.useState(r);return l.jsxs("div",{className:"md:col-span-4 mt-6 border rounded-lg overflow-hidden shadow-sm bg-white",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 cursor-pointer border-b hover:bg-gray-100 transition-colors",onClick:()=>a(!n),children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:e}),l.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:underline font-medium focus:outline-none",children:n?"Collapse":"Expand"})]}),n&&l.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4",children:t})]})}),St=gd.memo(({label:e,name:t,value:r,checked:n,onChange:a,type:i="text",required:s=!1,as:o="input",children:c,disabled:u=!1,placeholder:f,className:d})=>{const p=`field_${t}`;return i==="checkbox"?l.jsxs("div",{className:`flex items-center pt-6 ${d||""}`,children:[l.jsx("input",{type:"checkbox",name:t,id:p,checked:n,onChange:a,className:"h-5 w-5 text-violet-600 border-gray-300 rounded focus:ring-violet-500 cursor-pointer",disabled:u}),l.jsx("label",{htmlFor:p,className:"ml-2 text-sm text-gray-700 cursor-pointer select-none",children:e}),c]}):l.jsxs("div",{className:d,children:[l.jsxs("label",{htmlFor:p,className:p8,children:[e," ",s&&l.jsx("span",{className:"text-red-500",children:"*"})]}),o==="input"&&l.jsx("input",{type:i,name:t,id:p,value:r||"",onChange:a,className:I1,disabled:u,placeholder:f}),o==="select"&&l.jsx("select",{name:t,id:p,value:r||"",onChange:a,className:I1,disabled:u,children:c}),o==="textarea"&&l.jsx("textarea",{name:t,id:p,value:r||"",onChange:a,className:I1,rows:2,disabled:u,placeholder:f})]})}),xce=gd.memo(({title:e,photo:t,onPhotoChange:r,id:n,isViewMode:a})=>l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("label",{className:p8,children:e}),l.jsx("div",{className:"w-28 h-28 rounded-md bg-gray-100 mb-2 flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors",children:t?l.jsx("img",{src:t,alt:e,className:"w-full h-full object-cover"}):l.jsx(vs,{className:"w-12 h-12 text-gray-400"})}),!a&&l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"file",id:n,className:"hidden",accept:"image/*",onChange:r}),l.jsx("label",{htmlFor:n,className:"cursor-pointer bg-gray-600 text-white px-3 py-1 rounded-md hover:bg-gray-700 text-xs shadow-sm w-full text-center",children:"Upload"})]})]})),Ah=({mode:e,studentData:t,onSave:r,onCancel:n,onEdit:a})=>{const i=y.useRef(null),[s,o]=y.useState([]),[c,u]=y.useState([]),[f,d]=y.useState([]),[p,h]=y.useState([]),m=e==="view",g={admissionNo:"",first_name:"",last_name:"",gender:"",dob:"",Doa:"",BloodGroup:"",Adharcardno:"",Religion:"",phone:"",email:"",address:"",Category:"",class:"",section:"",Roll_Number:"",admission_date:"",status:"Active",MotherTongue:"",Caste:"",StudentType:"",House:"",StudentHeight:"",StudentWeight:"",SamagraId:"",ChildId:"",PEN:"",permanentCity:"",previousSchoolName:"",primaryIncomePerYear:"",secondaryIncomePerYear:"",primaryOfficeAddress:"",secondaryOfficeAddress:"",Hobbies:"",SecondLanguage:"",ThirdLanguage:"",GroupUniqueId:"",serviceNumber:"",EmploymentservingStatus:"",StudentStatus:"",ApaarId:"",Stream:"",EmploymentCategory:"",Fatherfirstname:"",FatherLastName:"",FatherPhone:"",SmsNo:"",FatherEmail:"",PrimaryQualification:"",FatherOccuption:"",FatherCompany:"",FatherDesignation:"",FatherAadhar:"",FatherOrganizationId:"",FatherOtherOrganization:"",Motherfirstname:"",MothermiddleName:"",Motherlastname:"",SecondaryPhone:"",SecondaryEmail:"",SecondaryQualification:"",SecondaryOccupation:"",SecondaryCompany:"",SecondaryDesignation:"",MotherAadhar:"",MotherOrganizationId:"",MotherOtherOrganization:"",GuardianName:"",GuardianRelation:"",GuardianQualification:"",GuardianOccupation:"",GuardianDesignation:"",GuardianDepartment:"",GuardianOfficeAddress:"",GuardianContactNo:"",BankName:"",BankCodeNo:"",BranchName:"",IFSC:"",AccountNumber:"",MICR:"",AdmissionCategory:"",location:"Hyderabad",branch:"",academic_year:localStorage.getItem("academicYear")||"",presentAddress:"",presentCity:"",presentPin:"",permanentAddress:"",permanentCity_ui:"",isSameAddress:!1},[x,b]=y.useState(g),[S,_]=y.useState(!1);t!=null&&t.branch,x.branch;const E=(I,P,L)=>{const R=P.find(G=>G.branch_name===I);if(R){const G=(R.location_code||"").trim().toUpperCase(),J=L.find(q=>q.code.toUpperCase()===G);if(J)return J.name}return""},[O,F]=y.useState(null),[M,C]=y.useState(null),[k,W]=y.useState(null),[D,j]=y.useState(null),[H,U]=y.useState([]),[Y,X]=y.useState([]);y.useEffect(()=>{var I,P;if(t){console.log("CreateStudent received studentData:",t),console.log("Keys in studentData:",Object.keys(t));const L={...g};Object.keys(g).forEach(G=>{const J=t[G]??t[G.replace(/_/g,"")]??t[G.toLowerCase()]??L[G];L[G]=J,["Roll_Number","AdmissionCategory","StudentStatus","BloodGroup"].includes(G)&&console.log(`Mapping ${G}: studentData[${G}]=${t[G]}, Result=${J}`)});const R=["Hyderabad","Mumbai","Bangalore"];if(L.location){const G=R.find(J=>J.toLowerCase()===L.location.trim().toLowerCase());G&&(L.location=G)}L.admissionNo=t.admission_no??L.admissionNo,L.presentAddress=t.address??"",L.class=t.class??t.clazz??"",console.log("Mapped formData:",L),b(L),X(t.documents||[]),W(((I=t.photos)==null?void 0:I.mother)||null),j(((P=t.photos)==null?void 0:P.guardian)||null),(t.student_id||t.id)&&Ee.get(`/students/${t.student_id||t.id}/history`).then(G=>U(G.data.history||[])).catch(console.error)}},[t]),y.useEffect(()=>{},[]),y.useEffect(()=>{Ee.get("/classes").then(I=>{const P=I.data.classes||[];P.sort((L,R)=>L.id-R.id),o(P.map(L=>L.class_name))}).catch(I=>{console.error("Failed to load classes",I)}),Promise.all([Ee.get("/branches"),Ee.get("/org/locations"),Ee.get("/org/academic-years")]).then(([I,P,L])=>{const R=P.data.locations||[];d(R);const G=L.data.academic_years||[];h(G);let J=[];if(I.data.branches&&(J=I.data.branches.map(q=>({branch_name:q.branch_name,location_code:q.location_code})),u(J)),e==="create"){const q=localStorage.getItem("currentBranch"),Q=localStorage.getItem("user");let fe="",V="";if(Q)try{const Te=JSON.parse(Q);fe=Te.role,V=Te.branch}catch(Te){console.error("Error parsing user from localStorage",Te)}let Oe="";if(fe==="Admin"?q&&q!=="All"&&(Oe=q):V&&(Oe=V),Oe){const Te=E(Oe,J,R);let be=x.academic_year;const re=localStorage.getItem("academicYear")||"",we=G.find(ve=>ve.name.replace(/\s/g,"")===re.replace(/\s/g,""));we&&(be=we.name),b(ve=>({...ve,branch:Oe,location:Te||ve.location,academic_year:be})),_(!0)}}}).catch(I=>console.error("Failed to load master data",I))},[e]);const Z=y.useCallback(I=>{var G;const{name:P,value:L,type:R}=I.target;if(!m){if(P==="branch"){const J=E(L,c,f);b(q=>({...q,[P]:L,location:J||q.location}));return}if(R==="checkbox"){const J=I.target.checked;b(q=>{const Q={...q,[P]:J};return P==="isSameAddress"&&(Q.permanentAddress=J?q.presentAddress:"",Q.permanentCity_ui=J?q.presentCity:"",Q.permanentPin=J?q.presentPin:""),Q});return}if(P==="Adharcardno"||P==="FatherAadhar"||P==="MotherAadhar"){const q=((G=L.replace(/\D/g,"").slice(0,12).match(/.{1,4}/g))==null?void 0:G.join("-"))||"";b(Q=>({...Q,[P]:q}));return}if(P==="presentPin"){const J=L.replace(/\D/g,"").slice(0,6);b(q=>({...q,presentPin:J}));return}if(P==="Roll_Number"){const J=L.replace(/\D/g,"");b(q=>({...q,Roll_Number:J}));return}if(P==="phone"||P==="FatherPhone"||P==="SecondaryPhone"||P==="SmsNo"||P==="GuardianContactNo"){let J=L;J.startsWith("+91 ")||(J="+91 "+J.replace(/\D/g,""));let q=J.replace("+91 ","").replace(/\D/g,"");q=q.slice(0,10);const Q="+91 "+q;b(fe=>({...fe,[P]:Q}));return}b(J=>({...J,[P]:L}))}},[m]),K=(I,P)=>{if(I.target.files&&I.target.files[0]){const L=new FileReader;L.onloadend=()=>P(L.result),L.readAsDataURL(I.target.files[0])}},z=()=>{b(g),F(null),C(null),W(null),j(null),X([])},se=I=>{I.preventDefault(),z()},xe=()=>({admission_no:x.admissionNo,first_name:x.first_name,last_name:x.last_name,gender:x.gender,dob:x.dob,Doa:x.Doa,BloodGroup:x.BloodGroup,Adharcardno:x.Adharcardno,Religion:x.Religion,phone:x.phone,email:x.email,address:x.presentAddress,Category:x.Category,class:x.class,section:x.section,Roll_Number:x.Roll_Number?Number(x.Roll_Number):null,admission_date:x.admission_date,status:x.status,MotherTongue:x.MotherTongue,Caste:x.Caste,StudentType:x.StudentType,House:x.House,Fatherfirstname:x.Fatherfirstname,FatherPhone:x.FatherPhone,SmsNo:x.SmsNo,FatherEmail:x.FatherEmail,PrimaryQualification:x.PrimaryQualification,FatherOccuption:x.FatherOccuption,FatherCompany:x.FatherCompany,FatherDesignation:x.FatherDesignation,FatherAadhar:x.FatherAadhar,FatherOrganizationId:x.FatherOrganizationId,FatherOtherOrganization:x.FatherOtherOrganization,Motherfirstname:x.Motherfirstname,MothermiddleName:x.MothermiddleName,Motherlastname:x.Motherlastname,SecondaryPhone:x.SecondaryPhone,SecondaryEmail:x.SecondaryEmail,SecondaryQualification:x.SecondaryQualification,SecondaryOccupation:x.SecondaryOccupation,SecondaryCompany:x.SecondaryCompany,SecondaryDesignation:x.SecondaryDesignation,MotherAadhar:x.MotherAadhar,MotherOrganizationId:x.MotherOrganizationId,MotherOtherOrganization:x.MotherOtherOrganization,GuardianName:x.GuardianName,GuardianRelation:x.GuardianRelation,GuardianQualification:x.GuardianQualification,GuardianOccupation:x.GuardianOccupation,GuardianDesignation:x.GuardianDesignation,GuardianDepartment:x.GuardianDepartment,GuardianOfficeAddress:x.GuardianOfficeAddress,GuardianContactNo:x.GuardianContactNo,BankName:x.BankName,BankCodeNo:x.BankCodeNo,BranchName:x.BranchName,IFSC:x.IFSC,AccountNumber:x.AccountNumber,MICR:x.MICR,AdmissionCategory:x.AdmissionCategory,AdmissionClass:x.AdmissionClass,StudentHeight:x.StudentHeight?Number(x.StudentHeight):null,StudentWeight:x.StudentWeight?Number(x.StudentWeight):null,SamagraId:x.SamagraId,ChildId:x.ChildId,PEN:x.PEN,permanentCity:x.permanentCity_id,previousSchoolName:x.previousSchoolName,primaryIncomePerYear:x.primaryIncomePerYear?Number(x.primaryIncomePerYear):null,secondaryIncomePerYear:x.secondaryIncomePerYear?Number(x.secondaryIncomePerYear):null,primaryOfficeAddress:x.primaryOfficeAddress,secondaryOfficeAddress:x.secondaryOfficeAddress,Hobbies:x.Hobbies,SecondLanguage:x.SecondLanguage,ThirdLanguage:x.ThirdLanguage,GroupUniqueId:x.GroupUniqueId,serviceNumber:x.serviceNumber,EmploymentservingStatus:x.EmploymentservingStatus,StudentStatus:x.StudentStatus,ApaarId:x.ApaarId,Stream:x.Stream,location:x.location,branch:x.branch,academic_year:x.academic_year,photos:{student:O,father:M,mother:k,guardian:D},documents:Y,feeInstallments:x.feeInstallments}),A=async I=>{if(e==="create"&&(!x.first_name||!x.last_name||!x.admissionNo||!x.admission_date||!x.branch||!x.academic_year||!x.class||!x.gender||!x.dob||!x.phone||!x.email||!x.Adharcardno||!x.section||!x.Fatherfirstname||!x.FatherPhone||!x.Motherfirstname)){alert("Fill required fields");return}const P=xe();try{if(e==="create"){const L=await Ee.post("/students",P);alert("Student created successfully!"),r&&r(L.data,I)}else if(e==="edit"){const L=(t==null?void 0:t.student_id)||(t==null?void 0:t.id);if(!L){alert("Error: Student ID is missing for update.");return}const R=await Ee.put(`/students/${L}`,P);alert("Student updated successfully!"),r&&r(R.data.student,I)}}catch(L){console.error("Error saving student:",L),alert("Failed to save student.")}};return l.jsx("div",{className:"p-4 md:p-6 bg-gray-50 min-h-screen",children:l.jsx("form",{ref:i,id:"create-student-form",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4 bg-gray-100 p-4 -m-6 rounded-t-lg",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:e==="create"?"Create New Student":e==="edit"?"Edit Student":"Student Details"}),e==="view"&&l.jsx("button",{type:"button",onClick:a,className:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700 transition-colors text-sm font-medium",children:"Edit Student"})]}),l.jsxs("div",{className:"md:col-span-4 border p-4 rounded-md grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 bg-white",children:[l.jsxs(St,{label:"Class",name:"class",as:"select",required:!0,value:x.class,onChange:Z,disabled:m,children:[l.jsx("option",{value:"",children:"-- Select --"}),s.map(I=>l.jsx("option",{value:I,children:I},I))]}),l.jsxs(St,{label:"Section",name:"section",as:"select",required:!0,value:x.section,onChange:Z,disabled:m,children:[l.jsx("option",{value:"",children:"-- Select --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"})]}),l.jsx(St,{label:"Admission No",name:"admissionNo",required:!0,value:x.admissionNo,onChange:Z,disabled:m}),l.jsx(St,{label:"Admission Date",name:"admission_date",type:"date",required:!0,value:x.admission_date,onChange:Z,disabled:m}),l.jsx(St,{label:"Roll Number",name:"Roll_Number",type:"number",value:x.Roll_Number,onChange:Z,disabled:m}),l.jsx(St,{label:"Admission Category",name:"AdmissionCategory",value:x.AdmissionCategory,onChange:Z,disabled:m}),l.jsxs(St,{label:"Location",name:"location",as:"select",value:x.location,onChange:Z,disabled:m||S,className:S?"bg-gray-100 cursor-not-allowed":"",children:[l.jsx("option",{value:"",children:"-- Select --"}),f.map(I=>l.jsx("option",{value:I.name,children:I.name},I.code))]}),l.jsxs(St,{label:"Branch",name:"branch",as:"select",required:!0,value:x.branch,onChange:Z,disabled:m||S,className:S?"bg-gray-100 cursor-not-allowed":"",children:[l.jsx("option",{value:"",children:"-- Select --"}),c.map(I=>l.jsx("option",{value:I.branch_name,children:I.branch_name},I.branch_name))]}),l.jsx(St,{label:"Academic Year",name:"academic_year",as:"select",value:x.academic_year,onChange:Z,disabled:!0,className:"bg-gray-100 cursor-not-allowed",children:p.length>0?p.map(I=>l.jsx("option",{value:I.name,children:I.name},I.code)):l.jsx("option",{value:x.academic_year,children:x.academic_year})})]}),l.jsxs(Rc,{title:"Personal Details",defaultOpen:!0,children:[l.jsx(St,{label:"First Name",name:"first_name",required:!0,value:x.first_name,onChange:Z,disabled:m}),l.jsx(St,{label:"Last Name",name:"last_name",required:!0,value:x.last_name,onChange:Z,disabled:m}),l.jsxs(St,{label:"Gender",name:"gender",as:"select",required:!0,value:x.gender,onChange:Z,disabled:m,children:[l.jsx("option",{value:"",children:"-- Select --"}),l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"})]}),l.jsx(St,{label:"Date of Birth",name:"dob",type:"date",required:!0,value:x.dob,onChange:Z,disabled:m}),l.jsx(St,{label:"Blood Group",name:"BloodGroup",value:x.BloodGroup,onChange:Z,disabled:m}),l.jsx(St,{label:"Aadhar Card No",name:"Adharcardno",required:!0,value:x.Adharcardno,onChange:Z,disabled:m}),l.jsx(St,{label:"Religion",name:"Religion",value:x.Religion,onChange:Z,disabled:m}),l.jsx(St,{label:"Mother Tongue",name:"MotherTongue",value:x.MotherTongue,onChange:Z,disabled:m}),l.jsx(St,{label:"Caste",name:"Caste",value:x.Caste,onChange:Z,disabled:m}),l.jsx(St,{label:"Category",name:"Category",value:x.Category,onChange:Z,disabled:m}),l.jsx(St,{label:"Student Type",name:"StudentType",value:x.StudentType,onChange:Z,disabled:m}),l.jsx(St,{label:"House",name:"House",value:x.House,onChange:Z,disabled:m}),l.jsx(St,{label:"Height (cm)",name:"StudentHeight",type:"number",value:x.StudentHeight,onChange:Z,disabled:m}),l.jsx(St,{label:"Weight (kg)",name:"StudentWeight",type:"number",value:x.StudentWeight,onChange:Z,disabled:m}),l.jsx(St,{label:"Samagra ID",name:"SamagraId",value:x.SamagraId,onChange:Z,disabled:m}),l.jsx(St,{label:"Child ID",name:"ChildId",value:x.ChildId,onChange:Z,disabled:m}),l.jsx(St,{label:"PEN",name:"PEN",value:x.PEN,onChange:Z,disabled:m})]}),l.jsxs(Rc,{title:"Contact Details",children:[l.jsx(St,{label:"Phone",name:"phone",required:!0,value:x.phone,onChange:Z,disabled:m}),l.jsx(St,{label:"Email",name:"email",type:"email",required:!0,value:x.email,onChange:Z,disabled:m}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(St,{label:"Present Address",name:"presentAddress",as:"textarea",value:x.presentAddress,onChange:Z,disabled:m})}),l.jsx(St,{label:"Present City",name:"presentCity",value:x.presentCity,onChange:Z,disabled:m}),l.jsx(St,{label:"Present Pin",name:"presentPin",value:x.presentPin,onChange:Z,disabled:m}),l.jsx("div",{className:"md:col-span-4",children:l.jsx(St,{label:"Same as Present Address",name:"isSameAddress",type:"checkbox",checked:x.isSameAddress,onChange:Z,disabled:m})}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(St,{label:"Permanent Address",name:"permanentAddress",as:"textarea",value:x.permanentAddress,onChange:Z,disabled:m||x.isSameAddress})}),l.jsx(St,{label:"Permanent City",name:"permanentCity_ui",value:x.permanentCity_ui,onChange:Z,disabled:m||x.isSameAddress})]}),l.jsxs(Rc,{title:"Parent Details",children:[l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-2 mb-2 border-b pb-1",children:"Father's Details"}),l.jsx(St,{label:"Father Name",name:"Fatherfirstname",required:!0,value:x.Fatherfirstname,onChange:Z,disabled:m}),l.jsx(St,{label:"FatherPhone",name:"FatherPhone",required:!0,value:x.FatherPhone,onChange:Z,disabled:m}),l.jsx(St,{label:"SMS No",name:"SmsNo",value:x.SmsNo,onChange:Z,disabled:m}),l.jsx(St,{label:"Email",name:"FatherEmail",type:"email",value:x.FatherEmail,onChange:Z,disabled:m}),l.jsx(St,{label:"Qualification",name:"PrimaryQualification",value:x.PrimaryQualification,onChange:Z,disabled:m}),l.jsx(St,{label:"Occupation",name:"FatherOccuption",value:x.FatherOccuption,onChange:Z,disabled:m}),l.jsx(St,{label:"Company",name:"FatherCompany",value:x.FatherCompany,onChange:Z,disabled:m}),l.jsx(St,{label:"Designation",name:"FatherDesignation",value:x.FatherDesignation,onChange:Z,disabled:m}),l.jsx(St,{label:"Aadhar No",name:"FatherAadhar",value:x.FatherAadhar,onChange:Z,disabled:m}),l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-4 mb-2 border-b pb-1",children:"Mother's Details"}),l.jsx(St,{label:"Mother Name",name:"Motherfirstname",required:!0,value:x.Motherfirstname,onChange:Z,disabled:m}),l.jsx(St,{label:"Phone",name:"SecondaryPhone",value:x.SecondaryPhone,onChange:Z,disabled:m}),l.jsx(St,{label:"Email",name:"SecondaryEmail",type:"email",value:x.SecondaryEmail,onChange:Z,disabled:m}),l.jsx(St,{label:"Qualification",name:"SecondaryQualification",value:x.SecondaryQualification,onChange:Z,disabled:m}),l.jsx(St,{label:"Occupation",name:"SecondaryOccupation",value:x.SecondaryOccupation,onChange:Z,disabled:m}),l.jsx(St,{label:"Company",name:"SecondaryCompany",value:x.SecondaryCompany,onChange:Z,disabled:m}),l.jsx(St,{label:"Designation",name:"SecondaryDesignation",value:x.SecondaryDesignation,onChange:Z,disabled:m}),l.jsx(St,{label:"Aadhar No",name:"MotherAadhar",value:x.MotherAadhar,onChange:Z,disabled:m}),l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-4 mb-2 border-b pb-1",children:"Guardian's Details"}),l.jsx(St,{label:"Name",name:"GuardianName",value:x.GuardianName,onChange:Z,disabled:m}),l.jsx(St,{label:"Relation",name:"GuardianRelation",value:x.GuardianRelation,onChange:Z,disabled:m}),l.jsx(St,{label:"Phone",name:"GuardianContactNo",value:x.GuardianContactNo,onChange:Z,disabled:m}),l.jsx(St,{label:"Qualification",name:"GuardianQualification",value:x.GuardianQualification,onChange:Z,disabled:m}),l.jsx(St,{label:"Occupation",name:"GuardianOccupation",value:x.GuardianOccupation,onChange:Z,disabled:m}),l.jsx(St,{label:"Office Address",name:"GuardianOfficeAddress",value:x.GuardianOfficeAddress,onChange:Z,disabled:m})]}),l.jsxs(Rc,{title:"Bank Details",children:[l.jsx(St,{label:"Bank Name",name:"BankName",value:x.BankName,onChange:Z,disabled:m}),l.jsx(St,{label:"Account Number",name:"AccountNumber",value:x.AccountNumber,onChange:Z,disabled:m}),l.jsx(St,{label:"IFSC Code",name:"IFSC",value:x.IFSC,onChange:Z,disabled:m}),l.jsx(St,{label:"Branch Name",name:"BranchName",value:x.BranchName,onChange:Z,disabled:m})]}),l.jsx(Rc,{title:"Upload Photo",children:l.jsx("div",{className:"md:col-span-4 grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:l.jsx(xce,{title:"Student Photo",photo:O,onPhotoChange:I=>K(I,F),id:"student-photo",isViewMode:m})})}),(e==="view"||e==="edit")&&H.length>0&&l.jsx(Rc,{title:"Promotion History",defaultOpen:!0,children:l.jsx("div",{className:"md:col-span-4 overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200 border",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Academic Year"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Class"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Section"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(I=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:I.academic_year}),l.jsx("td",{className:"px-4 py-2",children:I.class}),l.jsx("td",{className:"px-4 py-2",children:I.section}),l.jsx("td",{className:"px-4 py-2",children:I.roll_no||"-"}),l.jsx("td",{className:"px-4 py-2",children:I.is_promoted?l.jsx("span",{className:"text-green-600 bg-green-50 px-2 py-0.5 rounded text-xs",children:"Promoted"}):l.jsx("span",{className:"text-gray-500 bg-gray-50 px-2 py-0.5 rounded text-xs",children:"Enrolled"})}),l.jsx("td",{className:"px-4 py-2 text-gray-500 text-xs",children:I.promoted_date?new Date(I.promoted_date).toLocaleDateString():I.created_at?new Date(I.created_at).toLocaleDateString():"-"})]},I.id))})]})})}),l.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t mt-6",children:[l.jsx("button",{type:"button",onClick:n,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:e==="view"?"Back":"Cancel"}),e!=="view"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",onClick:se,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Reset"}),l.jsx("button",{type:"button",onClick:()=>A(!1),className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",onClick:()=>A(!0),className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Save & Exit"})]})]})]})})})},vce=({onBack:e})=>{const[t,r]=y.useState(localStorage.getItem("academicYear")||""),[n,a]=y.useState(""),[i,s]=y.useState(""),[o,c]=y.useState([]),[u,f]=y.useState([]),[d,p]=y.useState(""),[h,m]=y.useState(""),[g,x]=y.useState(""),[b,S]=y.useState(""),[_,E]=y.useState([]),[O,F]=y.useState([]),[M,C]=y.useState([]),[k,W]=y.useState(!1),[D,j]=y.useState(!1),[H,U]=y.useState(!1);y.useEffect(()=>{Ee.get("/classes").then(K=>C(K.data.classes||[])),Ee.get("/org/academic-years").then(K=>{var se;const z=((se=K.data.academic_years)==null?void 0:se.map(xe=>xe.name))||[];F(z)})},[]),y.useEffect(()=>{if(!t||!n)return;W(!0);const K=localStorage.getItem("currentBranch")||"All";Ee.get("/students",{params:{class:n,section:i,search:d,branch:K},headers:{"X-Academic-Year":t}}).then(z=>c(z.data.students||[])).catch(z=>{var se,xe;console.error(z),alert("Error fetching source students: "+(((xe=(se=z.response)==null?void 0:se.data)==null?void 0:xe.error)||z.message))}).finally(()=>W(!1))},[t,n,i,d]),y.useEffect(()=>{if(!h||!g)return;j(!0);const K=localStorage.getItem("currentBranch")||"All";Ee.get("/students",{params:{class:g,section:b,branch:K},headers:{"X-Academic-Year":h}}).then(z=>E(z.data.students||[])).catch(z=>console.error(z)).finally(()=>j(!1))},[h,g,b]);const Y=K=>{K.target.checked?f(o.map(z=>z.student_id).filter(z=>z!==void 0)):f([])},X=K=>{K&&(u.includes(K)?f(u.filter(z=>z!==K)):f([...u,K]))},Z=async()=>{if(u.length===0)return alert("Select students to upgrade");if(!h||!g)return alert("Select Target Year and Class");if(t===h)return alert("Source and Target Year cannot be same");if(confirm(`Promote ${u.length} students to Class ${g} (${h})?`)){U(!0);try{await Ee.post("/students/promote-bulk",{student_ids:u,target_year:h,target_class:g,target_section:b}),alert("Students Promoted Successfully!"),c(se=>se.filter(xe=>!u.includes(xe.student_id))),f([]);const K=localStorage.getItem("currentBranch")||"All",z=await Ee.get("/students",{params:{class:g,section:b,branch:K},headers:{"X-Academic-Year":h}});E(z.data.students||[])}catch(K){console.error(K),alert("Failed to promote students Please Check If students are already in targeted class and Academic Year")}finally{U(!1)}}};return l.jsxs("div",{className:"p-4 bg-gray-100 min-h-screen",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Bulk Student Upgrade"}),e&&l.jsx("button",{onClick:e,className:"text-sm bg-gray-200 px-3 py-1 rounded",children:"Back"})]}),l.jsxs("div",{className:"flex gap-4 h-[80vh]",children:[l.jsxs("div",{className:"flex-1 bg-white rounded shadow flex flex-col",children:[l.jsxs("div",{className:"p-3 border-b bg-indigo-50 rounded-t",children:[l.jsx("h3",{className:"font-semibold text-indigo-700",children:"Source (Current State)"}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("select",{value:t,onChange:K=>r(K.target.value),className:"border p-1 rounded text-sm w-1/3",children:O.map(K=>l.jsx("option",{value:K,children:K},K))}),l.jsxs("select",{value:n,onChange:K=>a(K.target.value),className:"border p-1 rounded text-sm w-1/3",children:[l.jsx("option",{value:"",children:"Select Class"}),M.map(K=>l.jsx("option",{value:K.class_name,children:K.class_name},K.id))]}),l.jsxs("select",{value:i,onChange:K=>s(K.target.value),className:"border p-1 rounded text-sm w-1/4",children:[l.jsx("option",{value:"",children:"All Sec"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("input",{placeholder:"Search Source Students...",className:"w-full border p-1 rounded text-sm mt-2",value:d,onChange:K=>p(K.target.value)})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[l.jsxs("h4",{className:"text-sm font-bold mb-2",children:[o.length," Students Found"]}),l.jsxs("table",{className:"w-full text-sm border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100 text-left",children:[l.jsx("th",{className:"p-2 border",children:l.jsx("input",{type:"checkbox",onChange:Y,checked:o.length>0&&u.length===o.length})}),l.jsx("th",{className:"p-2 border",children:"Adm No"}),l.jsx("th",{className:"p-2 border",children:"Name"}),l.jsx("th",{className:"p-2 border",children:"Class"})]})}),l.jsx("tbody",{children:k?l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Loading..."})}):o.map(K=>l.jsxs("tr",{className:"hover:bg-indigo-50",children:[l.jsx("td",{className:"p-2 border",children:l.jsx("input",{type:"checkbox",checked:K.student_id?u.includes(K.student_id):!1,onChange:()=>X(K.student_id)})}),l.jsx("td",{className:"p-2 border",children:K.admNo}),l.jsxs("td",{className:"p-2 border",children:[K.first_name||K.name," ",K.last_name||""]}),l.jsxs("td",{className:"p-2 border",children:[K.class," ",K.section]})]},K.student_id))})]})]})]}),l.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 w-32",children:[l.jsx("button",{onClick:Z,disabled:u.length===0||H,className:`px-4 py-8 rounded font-bold shadow-lg transform transition-all 
                            ${u.length>0&&!H?"bg-indigo-600 text-white hover:scale-105 hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}
                        `,children:H?"...":"Upgrade >>"}),l.jsxs("div",{className:"text-xs text-center text-gray-500",children:[u.length," Selected"]})]}),l.jsxs("div",{className:"flex-1 bg-white rounded shadow flex flex-col",children:[l.jsxs("div",{className:"p-3 border-b bg-green-50 rounded-t",children:[l.jsx("h3",{className:"font-semibold text-green-700",children:"Target (Promote To)"}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("select",{value:h,onChange:K=>m(K.target.value),className:"border p-1 rounded text-sm w-1/2",children:O.map(K=>l.jsx("option",{value:K,children:K},K))}),l.jsxs("select",{value:g,onChange:K=>x(K.target.value),className:"border p-1 rounded text-sm w-1/3",children:[l.jsx("option",{value:"",children:"Select Class"}),M.map(K=>l.jsx("option",{value:K.class_name,children:K.class_name},K.id))]}),l.jsxs("select",{value:b,onChange:K=>S(K.target.value),className:"border p-1 rounded text-sm w-1/4",children:[l.jsx("option",{value:"",children:"All Sec"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[l.jsxs("h4",{className:"text-sm font-bold mb-2",children:[_.length," Students Already in Target"]}),l.jsxs("table",{className:"w-full text-sm border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100 text-left",children:[l.jsx("th",{className:"p-2 border",children:"Adm No"}),l.jsx("th",{className:"p-2 border",children:"Name"}),l.jsx("th",{className:"p-2 border",children:"Status"})]})}),l.jsxs("tbody",{children:[D?l.jsx("tr",{children:l.jsx("td",{colSpan:3,className:"p-4 text-center",children:"Loading..."})}):_.map(K=>l.jsxs("tr",{children:[l.jsx("td",{className:"p-2 border",children:K.admNo}),l.jsx("td",{className:"p-2 border",children:K.first_name||K.name}),l.jsx("td",{className:"p-2 border text-green-600",children:"Promoted"})]},K.student_id)),_.length===0&&!D&&l.jsx("tr",{children:l.jsx("td",{colSpan:3,className:"p-4 text-center text-red-400",children:"No Records Found"})})]})]})]})]})]})]})},yce=({onBack:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(!1),[i,s]=y.useState("All"),[o,c]=y.useState(null),[u,f]=y.useState(null),[d,p]=y.useState([]),[h,m]=y.useState(!1),[g,x]=y.useState(""),[b,S]=y.useState("summary"),_=d.filter(U=>U.gender==="Male").length,E=d.filter(U=>U.gender==="Female").length,O=()=>{const U=d.map((Z,K)=>({"S.No":K+1,"Roll No":Z.rollNo,"Admission No":Z.admNo,Name:Z.name,Gender:Z.gender,Class:Z.class,Section:Z.section,"Father Name":Z.father,"Phone Number":Z.fatherMobile,Status:Z.status})),Y=pa.json_to_sheet(U),X=pa.book_new();pa.book_append_sheet(X,Y,"Class Summary"),xy(X,`ClassSummary_${o||"All"}_${u||"All"}.xlsx`)},F=()=>{window.print()};y.useEffect(()=>{M()},[]),y.useEffect(()=>{o?C():p([])},[o,u,i,g]);const M=async()=>{try{a(!0);const U=localStorage.getItem("currentBranch"),Y=await Ee.get("/students/summary",{headers:{"X-Branch":U||"All"}});r(Y.data),Y.data.structure&&Y.data.structure.length>0}catch(U){console.error("Failed to fetch summary",U)}finally{a(!1)}},C=async()=>{try{m(!0);const U=localStorage.getItem("currentBranch");let X=(await Ee.get("/students",{params:{class:o,section:u,search:g,include_inactive:"true"},headers:{"X-Branch":U||"All"}})).data.students||[];i!=="All"&&(X=X.filter(Z=>Z.status===i)),p(X)}catch(U){console.error("Failed to fetch students",U)}finally{m(!1)}},k=t==null?void 0:t.structure.find(U=>U.name===o),W=d.length,D=()=>{if(!t)return l.jsx("div",{children:"Loading inputs..."});const U=["All","Active","Inactive","TC"];return l.jsxs("div",{className:"bg-white rounded-lg shadow h-full flex flex-col border border-gray-200 print:hidden",children:[l.jsxs("div",{className:"p-2 border-b bg-white",children:[l.jsx("div",{className:"relative mb-2",children:l.jsx("select",{className:"w-full border border-gray-300 rounded-md px-3 py-1.5 bg-white text-gray-700 font-medium focus:ring-2 focus:ring-blue-500 outline-none",value:i,onChange:Y=>s(Y.target.value),children:U.map(Y=>l.jsx("option",{value:Y,children:Y},Y))})}),l.jsx("div",{className:"grid grid-cols-1 border border-gray-200 rounded-md overflow-hidden text-sm",children:l.jsxs("div",{className:"flex justify-between p-2 bg-blue-600 text-white cursor-pointer",onClick:()=>s("All"),children:[l.jsx("span",{className:"font-semibold",children:"All"}),l.jsx("span",{className:"font-bold",children:t.stats.total})]})}),l.jsxs("div",{className:"grid grid-cols-1 border border-gray-200 mt-2 rounded-md overflow-hidden text-sm divide-y",children:[l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>s("Active"),children:[l.jsx("span",{children:"Active"}),l.jsx("span",{children:t.stats.by_status.Active||0})]}),l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>s("Inactive"),children:[l.jsx("span",{children:"Inactive"}),l.jsx("span",{children:t.stats.by_status.Inactive||0})]}),l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>s("TC"),children:[l.jsx("span",{children:"TC"}),l.jsx("span",{children:t.stats.by_status.TC||0})]})]})]}),l.jsxs("div",{className:"bg-gray-50 border-b px-3 py-2 flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wider",children:[l.jsx("span",{children:"Class"}),l.jsx("span",{children:"Total"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsx("table",{className:"w-full text-sm text-left",children:l.jsx("tbody",{className:"divide-y divide-gray-100",children:t.structure.map(Y=>l.jsxs("tr",{onClick:()=>{c(Y.name),f(null)},className:`cursor-pointer transition-colors ${o===Y.name?"bg-blue-50":"hover:bg-gray-50"}`,children:[l.jsx("td",{className:`px-3 py-2.5 font-medium ${o===Y.name?"text-blue-700":"text-gray-700"}`,children:Y.name}),l.jsx("td",{className:`px-3 py-2.5 text-right font-semibold ${o===Y.name?"text-blue-700":"text-blue-500"}`,children:Y.count})]},Y.name))})})})]})},j=()=>!o||!k?l.jsx("div",{className:"bg-white rounded-lg shadow h-full flex items-center justify-center text-gray-400 text-sm p-4 text-center border border-gray-200 print:hidden",children:l.jsx("span",{className:"italic",children:"Select Class"})}):l.jsxs("div",{className:"bg-white rounded-lg shadow h-full flex flex-col border border-green-100 print:hidden",children:[l.jsxs("div",{className:"p-3 border-b border-green-100 flex justify-between items-center text-green-700 bg-white",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{className:"font-bold text-lg",children:"Section"})]}),l.jsx("button",{className:"text-green-600 hover:text-green-800",title:"Refresh",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),l.jsxs("div",{className:"bg-gray-50 border-b px-3 py-2 flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wider",children:[l.jsx("span",{children:"Total"}),l.jsx("span",{children:k.count})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 border-b hidden",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2",children:"Section"}),l.jsx("th",{className:"px-3 py-2 text-right",children:"Total"})]})}),l.jsxs("tbody",{className:"divide-y divide-green-50",children:[l.jsxs("tr",{onClick:()=>f(null),className:`cursor-pointer transition-colors ${u===null?"bg-green-100":"hover:bg-green-50"}`,children:[l.jsx("td",{className:"px-3 py-2.5 font-medium text-gray-700",children:"All"}),l.jsx("td",{className:"px-3 py-2.5 text-right text-gray-600",children:k.count})]}),k.sections.map(U=>l.jsxs("tr",{onClick:()=>f(U.name),className:`cursor-pointer transition-colors ${u===U.name?"bg-lime-100 border-l-4 border-lime-500":"hover:bg-green-50 border-l-4 border-transparent"}`,children:[l.jsx("td",{className:"px-3 py-2.5 font-semibold text-gray-700",children:U.name}),l.jsx("td",{className:"px-3 py-2.5 text-right text-blue-600 font-bold",children:U.count})]},U.name))]})]})})]}),H=()=>b==="create"?l.jsxs("div",{className:"bg-white rounded-lg shadow h-full p-4 overflow-y-auto",children:[l.jsx("button",{onClick:()=>S("summary"),className:"mb-4 text-sm text-blue-600 hover:underline",children:"← Back to List"}),l.jsx(Ah,{mode:"create",onSave:()=>{S("summary"),C(),M()},onCancel:()=>S("summary")})]}):l.jsx("div",{className:"h-full flex flex-col gap-4 print:h-auto print:block",children:l.jsxs("div",{className:"bg-white rounded-lg shadow flex-1 flex flex-col overflow-hidden print:shadow-none print:h-auto",children:[l.jsxs("div",{className:"p-3 bg-violet-50 border-b flex justify-between items-center flex-wrap gap-2 print:bg-white print:border-none",children:[l.jsxs("div",{className:"font-bold text-gray-800 text-lg flex items-center gap-2",children:[o||"All Classes"," ",u||"",l.jsxs("span",{className:"text-gray-500 font-normal text-base ml-2",children:["Records : ",W]})]}),l.jsxs("div",{className:"flex items-center gap-4 print:hidden",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[l.jsxs("div",{className:"px-3 py-1 bg-green-500 text-white rounded shadow-sm",children:["Males: ",_]}),l.jsxs("div",{className:"px-3 py-1 bg-orange-400 text-white rounded shadow-sm",children:["Females: ",E]})]}),l.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[l.jsx("button",{title:"Excel",onClick:O,className:"text-green-600 hover:text-green-800",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("button",{title:"PDF",onClick:F,className:"text-red-500 hover:text-red-700",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})})]}),l.jsx("div",{className:"relative",children:l.jsx("input",{className:"border border-purple-200 rounded-full px-4 py-1 text-sm w-48 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Search",value:g,onChange:U=>x(U.target.value)})})]})]}),l.jsx("div",{className:"flex-1 overflow-auto print:overflow-visible",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-500 font-semibold print:bg-white print:border-b-2 print:border-black",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left w-12 text-gray-700",children:"#"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Roll"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Class"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Adm.No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"PhoneNumber"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:h?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-500",children:"Loading students data..."})}):d.length===0?l.jsx("tr",{children:l.jsxs("td",{colSpan:7,className:"p-8 text-center text-gray-500 flex flex-col items-center",children:[l.jsx("span",{className:"text-lg",children:"No students found"}),l.jsx("span",{className:"text-xs",children:"Try adjusting filters or search"})]})}):d.map((U,Y)=>{var X;return l.jsxs("tr",{className:"hover:bg-blue-50 group transition-colors",children:[l.jsx("td",{className:"px-4 py-3 font-mono text-gray-500",children:Y+1}),l.jsx("td",{className:"px-4 py-3 text-gray-600 font-medium",children:U.rollNo||"-"}),l.jsx("td",{className:"px-4 py-3",children:U.status==="Active"?l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-orange-400 text-white text-xs font-bold",title:"Present/Active",children:"P"}):U.status==="Inactive"?l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-red-500 text-white text-xs font-bold",title:"Inactive",children:"I"}):l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-green-500 text-white text-xs font-bold",title:U.status,children:(X=U.status)==null?void 0:X[0]})}),l.jsxs("td",{className:"px-4 py-3",children:[l.jsx("div",{className:"font-medium text-blue-600 group-hover:underline cursor-pointer",children:U.name}),U.status==="Inactive"&&l.jsx("div",{className:"text-xs text-red-500 mt-0.5",children:"(InActive)"})]}),l.jsxs("td",{className:"px-4 py-3 text-gray-700 font-semibold",children:[U.class," ",U.section]}),l.jsx("td",{className:"px-4 py-3 text-gray-600 font-mono text-xs",children:U.admNo}),l.jsx("td",{className:"px-4 py-3 text-gray-700",children:U.father}),l.jsx("td",{className:"px-4 py-3 text-gray-600 text-sm",children:U.fatherMobile})]},U.id)})})]})})]})});return l.jsxs("div",{className:"flex h-full gap-4 p-4 overflow-hidden bg-gray-100 print:bg-white print:p-0 print:h-auto print:overflow-visible",children:[l.jsx("div",{className:"w-1/5 min-w-[200px] flex-shrink-0 print:hidden",children:D()}),l.jsx("div",{className:"w-[15%] min-w-[150px] flex-shrink-0 print:hidden",children:j()}),l.jsx("div",{className:"flex-1 min-w-0 print:w-full",children:H()})]})},yA=({title:e,isOpen:t,onToggle:r,children:n})=>l.jsxs("div",{className:"relative inline-block text-left",children:[l.jsxs("button",{className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",onClick:r,children:[e,l.jsx(Nl,{className:"ml-2 h-5 w-5"})]}),t&&l.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-20",children:l.jsx("div",{className:"py-1",children:n})})]}),hh=({children:e,onClick:t})=>l.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),t==null||t()},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:e}),bce=({activeView:e,setActiveView:t})=>{const[r,n]=y.useState(null),a=s=>n(r===s?null:s),i=s=>`px-3 py-2 text-sm rounded-md ${e===s?"bg-violet-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`;return l.jsx("div",{className:"bg-gray-50 p-3 border-b border-gray-300",children:l.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"STUDENTS"}),l.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[l.jsx("button",{className:i("students"),onClick:()=>t("students"),children:"Students"}),l.jsx("button",{className:i("addStudent"),onClick:()=>t("addStudent"),children:"Create Student"}),l.jsx("button",{className:i("search"),onClick:()=>t("search"),children:"Search"}),l.jsx("button",{className:i("summary"),onClick:()=>t("summary"),children:"Class Summary"}),l.jsxs(yA,{title:"Report",isOpen:r==="report",onToggle:()=>a("report"),children:[l.jsx(hh,{children:"Custom Download"}),l.jsx(hh,{children:"Pre-defined Download"})]}),l.jsxs(yA,{title:"Certificates",isOpen:r==="certs",onToggle:()=>a("certs"),children:[l.jsx(hh,{children:"Student Certificate"}),l.jsx(hh,{children:"Teacher Certificate"})]}),l.jsx("button",{className:i("upgrade"),onClick:()=>t("upgrade"),children:"Upgrade"})]})]})})},wce=({onView:e,onEdit:t,setActiveView:r})=>{const[n,a]=y.useState([]),[i,s]=y.useState(!1),[o,c]=y.useState(!1),[u,f]=y.useState(""),[d,p]=y.useState(""),[h,m]=y.useState(""),[g,x]=y.useState(!1),[b,S]=y.useState([]),[_,E]=y.useState(!1),[O,F]=y.useState(""),[M,C]=y.useState(null),[k,W]=y.useState(!1),[D,j]=y.useState(null);y.useEffect(()=>{const z=localStorage.getItem("user");if(z){const se=JSON.parse(z);x(se.role==="Admin")}Ee.get("/classes").then(se=>S(se.data.classes||[])).catch(()=>console.log("Failed loading classes")),H()},[]),y.useEffect(()=>{H()},[u,d,h,o]);const H=()=>{s(!0);const z=localStorage.getItem("currentBranch")||"";Ee.get("/students",{params:{class:u||"",section:d||"",search:h||"",include_inactive:o?"true":"false",branch:z==="All"||z==="All Branches"?"All":z}}).then(se=>a(se.data.students||[])).catch(()=>a([])).finally(()=>s(!1))},U=z=>{C(z),F(""),E(!0)},Y=async z=>{if(window.confirm(`Are you sure you want to Activate ${z.name}?`))try{await Ee.put(`/students/${z.student_id||z.id}`,{status:"Active"}),alert("Student Activated successfully"),H()}catch(se){console.error(se),alert("Failed to activate student")}},X=async()=>{if(!O)return alert("Please enter password");try{if((await Ee.post("/verify-any-password",{password:O})).data.success){const se=M.student_id||M.id;await Ee.delete(`/students/${se}`),alert("Student marked as Inactive successfully"),E(!1),H()}else alert("Invalid Password")}catch(z){console.error(z),alert("Error deleting student")}},Z=z=>{const se=window.open("","","width=900,height=800");se&&(se.document.write(`
                     <html>
                         <head>
                            <title>Student Report - ${z.name}</title>
                            <style>
                                body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; color: #333; }
                                h1 { text-align: center; color: #4c1d95; margin-bottom: 10px; }
                                h2 { border-bottom: 2px solid #4c1d95; padding-bottom: 5px; margin-top: 30px; color: #5b21b6; font-size: 18px; }
                                .header { text-align: center; margin-bottom: 40px; }
                                .photo-box { width: 120px; height: 120px; border: 1px solid #ddd; margin: 0 auto 10px; object-fit: cover; display: block; }
                                .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
                                .field { margin-bottom: 8px; }
                                .label { font-weight: bold; color: #555; width: 140px; display: inline-block; }
                                .value { color: #000; }
                                table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 14px; }
                                th { bg-color: #f3f4f6; }
                            </style>
                         </head>
                         <body>
                             <div class="header">
                                <img src="https://www.mshifzacademy.com/assets/images/ms-logo.jpg" style="max-width: 300px; height: auto; margin-bottom: 10px;" />
                                <p>Student Profile Report</p>
                             </div>

                             <img src="${z.photo||"https://via.placeholder.com/150"}" class="photo-box" />
                             <h2 style="text-align:center; border:none;">${z.name}</h2>
                             <p style="text-align:center;">${z.admNo} | Class: ${z.class} - ${z.section}</p>

                             <h2>Academic Details</h2>
                             <div class="grid">
                                <div>
                                    <div class="field"><span class="label">Admission No:</span> <span class="value">${z.admNo||"-"}</span></div>
                                    <div class="field"><span class="label">Roll No:</span> <span class="value">${z.rollNo||"-"}</span></div>
                                    <div class="field"><span class="label">Class:</span> <span class="value">${z.class||"-"}</span></div>
                                    <div class="field"><span class="label">Section:</span> <span class="value">${z.section||"-"}</span></div>
                                </div>
                                <div>
                                    <div class="field"><span class="label">Admission Date:</span> <span class="value">${z.admission_date||"-"}</span></div>
                                    <div class="field"><span class="label">Status:</span> <span class="value">${z.status||"-"}</span></div>
                                    <div class="field"><span class="label">Category:</span> <span class="value">${z.Category||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Personal Details</h2>
                             <div class="grid">
                                <div>
                                    <div class="field"><span class="label">First Name:</span> <span class="value">${z.first_name||"-"}</span></div>
                                    <div class="field"><span class="label">Last Name:</span> <span class="value">${z.last_name||"-"}</span></div>
                                    <div class="field"><span class="label">Gender:</span> <span class="value">${z.gender||"-"}</span></div>
                                    <div class="field"><span class="label">DOB:</span> <span class="value">${z.dob||"-"}</span></div>
                                    <div class="field"><span class="label">Blood Group:</span> <span class="value">${z.BloodGroup||"-"}</span></div>
                                </div>
                                <div>
                                    <div class="field"><span class="label">Aadhar No:</span> <span class="value">${z.Adharcardno||"-"}</span></div>
                                    <div class="field"><span class="label">Religion:</span> <span class="value">${z.Religion||"-"}</span></div>
                                    <div class="field"><span class="label">Caste:</span> <span class="value">${z.Caste||"-"}</span></div>
                                    <div class="field"><span class="label">Mother Tongue:</span> <span class="value">${z.MotherTongue||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Contact Info</h2>
                             <div class="field"><span class="label">Mobile:</span> <span class="value">${z.phone||"-"}</span></div>
                             <div class="field"><span class="label">Email:</span> <span class="value">${z.email||"-"}</span></div>
                             <div class="field"><span class="label">Address:</span> <span class="value">${z.address||"-"}</span></div>

                             <h2>Parent / Guardian Details</h2>
                             <div class="grid">
                                <div>
                                    <h3>Father</h3>
                                    <div class="field"><span class="label">Name:</span> <span class="value">${z.Fatherfirstname||"-"}</span></div>
                                    <div class="field"><span class="label">Phone:</span> <span class="value">${z.FatherPhone||"-"}</span></div>
                                    <div class="field"><span class="label">Occupation:</span> <span class="value">${z.FatherOccuption||"-"}</span></div>
                                </div>
                                <div>
                                    <h3>Mother</h3>
                                    <div class="field"><span class="label">Name:</span> <span class="value">${z.Motherfirstname||"-"}</span></div>
                                    <div class="field"><span class="label">Phone:</span> <span class="value">${z.SecondaryPhone||"-"}</span></div>
                                    <div class="field"><span class="label">Occupation:</span> <span class="value">${z.SecondaryOccupation||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Bank Details</h2>
                             <div class="grid">
                                <div class="field"><span class="label">Bank Name:</span> <span class="value">${z.BankName||"-"}</span></div>
                                <div class="field"><span class="label">Account No:</span> <span class="value">${z.AccountNumber||"-"}</span></div>
                                <div class="field"><span class="label">IFSC:</span> <span class="value">${z.IFSC||"-"}</span></div>
                             </div>

                             <script>window.print();<\/script>
                         </body>
                     </html>
                 `),se.document.close())},K=()=>i?l.jsx("div",{className:"p-6 text-gray-600 text-center",children:"Loading..."}):n.length?l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-violet-600 text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left",children:"Student Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Adm No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Roll No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Class"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Branch"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father/ Guardian Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father Mobile"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Tools"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.map(z=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-4 py-2 flex items-center gap-2",children:[l.jsx("img",{src:z.photo||"https://via.placeholder.com/32",className:"w-8 h-8 rounded-full object-cover border"}),l.jsx("span",{className:"font-medium text-blue-600",children:z.name})]}),l.jsx("td",{className:"px-4 py-2",children:z.admNo}),l.jsx("td",{className:"px-4 py-2",children:z.rollNo}),l.jsxs("td",{className:"px-4 py-2",children:[z.class," ",z.section]}),l.jsx("td",{className:"px-4 py-2",children:z.branch}),l.jsx("td",{className:"px-4 py-2",children:z.father}),l.jsx("td",{className:"px-4 py-2",children:z.fatherMobile}),l.jsx("td",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("button",{onClick:()=>e(z),className:"px-2 py-1 text-xs bg-indigo-100 text-indigo-700 rounded hover:bg-indigo-200 flex items-center gap-1",title:"Details",children:[l.jsx("span",{children:"ℹ️"})," Details"]}),l.jsxs("button",{onClick:()=>t(z),className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 flex items-center gap-1",title:"Edit",children:[l.jsx("span",{children:"✏️"})," Edit"]}),l.jsxs("button",{onClick:()=>Z(z),className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200 flex items-center gap-1",title:"Print",children:[l.jsx("span",{children:"🖨️"})," Print"]}),l.jsxs("button",{onClick:()=>U(z),className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 flex items-center gap-1",title:"Deactivate",children:[l.jsx("span",{children:"🚫"})," Inactivate"]}),z.status==="Inactive"&&l.jsxs("button",{onClick:()=>Y(z),className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 flex items-center gap-1",title:"Activate",children:[l.jsx("span",{children:"✅"})," Activate"]})]})})]},z.admNo))})]})}):l.jsx("div",{className:"p-6 text-gray-600 text-center",children:"No students found"});return l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6",children:[l.jsxs("select",{value:u,onChange:z=>f(z.target.value),className:"border px-3 py-2 rounded-md",children:[l.jsx("option",{value:"",children:"-- All Classes --"}),Array.isArray(b)&&b.map(z=>l.jsx("option",{value:z.class_name,children:z.class_name},z.id))]}),l.jsxs("select",{value:d,onChange:z=>p(z.target.value),className:"border px-3 py-2 rounded-md",children:[l.jsx("option",{value:"",children:"-- All Sections --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]}),l.jsxs("div",{className:"md:col-span-2 relative",children:[l.jsx("input",{className:"border px-3 py-2 w-full rounded-md pl-10",placeholder:"Search by Name, Adm No...",value:h,onChange:z=>m(z.target.value)}),l.jsx(XA,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),l.jsx("button",{onClick:H,className:"bg-violet-600 text-white px-4 py-2 rounded-md",children:"Search"}),l.jsx("div",{className:"flex items-center",children:l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:o,onChange:z=>c(z.target.checked),className:"h-4 w-4 text-violet-600 focus:ring-violet-500 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Show Inactive"})]})})]}),K(),_&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[l.jsx("h3",{className:"text-lg font-bold mb-4",children:"Confirm Deactivation"}),l.jsxs("p",{className:"mb-4 text-gray-600",children:["Enter your password to mark ",l.jsx("b",{children:M==null?void 0:M.name})," as Inactive."]}),l.jsx("input",{type:"password",className:"w-full border p-2 rounded mb-4",placeholder:"Password",value:O,onChange:z=>F(z.target.value)}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:X,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Deactivate"})]})]})})]})},Sce=({navigateTo:e})=>{const[t,r]=y.useState("students"),[n,a]=y.useState(null),i=()=>{switch(t){case"students":return l.jsx(wce,{onView:s=>{a(s),r("viewStudent")},onEdit:s=>{a(s),r("editStudent")},setActiveView:r});case"addStudent":return l.jsx(Ah,{mode:"create",onSave:()=>r("students"),onCancel:()=>r("students")});case"viewStudent":return l.jsx(Ah,{mode:"view",studentData:n,onCancel:()=>r("students"),onEdit:()=>r("editStudent")});case"editStudent":return l.jsx(Ah,{mode:"edit",studentData:n,onSave:()=>r("students"),onCancel:()=>r("students")});case"import":return l.jsx(gce,{onImportSuccess:()=>r("students")});case"upgrade":return l.jsx(vce,{onBack:()=>r("students")});case"summary":return l.jsx(yce,{onBack:()=>r("students")});default:return l.jsx(nj,{pageTitle:"Coming Soon"})}};return l.jsxs("div",{className:"h-full bg-gray-100 overflow-y-auto",children:[l.jsx(bce,{activeView:t,setActiveView:r}),i()]})},_ce=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState(""),[s,o]=y.useState(""),[c,u]=y.useState(localStorage.getItem("academicYear")||""),[f,d]=y.useState("All"),[p,h]=y.useState(!0),[m,g]=y.useState(!1),[x,b]=y.useState(""),[S,_]=y.useState({}),[E,O]=y.useState(!1),[F,M]=y.useState(""),[C,k]=y.useState(""),[W,D]=y.useState(!1),[j,H]=y.useState(""),[U,Y]=y.useState([]),[X,Z]=y.useState(""),[K,z]=y.useState(new Set),[se,xe]=y.useState(!1),[A,I]=y.useState(!1),P=y.useRef(null);y.useEffect(()=>{function re(we){P.current&&!P.current.contains(we.target)&&xe(!1)}return document.addEventListener("mousedown",re),()=>{document.removeEventListener("mousedown",re)}},[]),y.useEffect(()=>{const re=JSON.parse(localStorage.getItem("user")||"{}"),we=re.role!=="Admin";let ve="All";we&&re.branch?ve=re.branch:ve=localStorage.getItem("currentBranch")||"All",d(ve),ve!=="All"&&ve!=="All Branches"&&Ee.get("/branches").then(ye=>{const Ce=ye.data.branches||[],ze=Ce.map(Ue=>({id:Ue.id,name:Ue.branch_name,location_name:Ue.location_name||"Unknown Location"}));Y(ze);const $e=Ce.find(Ue=>Ue.branch_name.toLowerCase()===ve.toLowerCase());$e&&Z($e.id)}).catch(ye=>console.error("Error fetching branch info:",ye)),L(),R()},[]);const L=async()=>{try{const re=await Ee.get("/fee-types");t(re.data.fee_types),G(re.data.fee_types)}catch(re){console.error("Error fetching fee types:",re)}},R=async()=>{try{const re=await Ee.get("/concessions"),we=localStorage.getItem("currentBranch")||"All",ve=JSON.parse(localStorage.getItem("user")||"{}"),ye=re.data.concessions;let Ce=ye;ve.role==="Admin"?Ce=we==="All"||we==="All Branches"?ye:ye.filter(ze=>ze.branch===we||ze.branch==="All"):Ce=ye,n(Ce)}catch(re){console.error("Error fetching concessions:",re)}},G=re=>{const we={};re.forEach(ve=>{we[ve.id]=0}),_(we),_(we)},J=re=>{const we=new Set(K);we.has(re)?we.delete(re):we.add(re),z(we)},q=async()=>{var re,we;if(K.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy all concessions to ${K.size} branches? Duplicates will be skipped.`)){I(!0);try{await Ee.post("/fees/copy-concessions",{source_branch_id:X,target_branch_ids:Array.from(K),academic_year:c}),alert("Concessions copied successfully!"),z(new Set),xe(!1)}catch(ve){console.error("Copy failed",ve),alert(((we=(re=ve.response)==null?void 0:re.data)==null?void 0:we.error)||"Failed to copy concessions.")}finally{I(!1)}}},Q=()=>{if(!x)return;const re=parseFloat(x);if(isNaN(re))return;const we={...S};e.forEach(ve=>{we[ve.id]=re}),_(we)},fe=(re,we)=>{const ve=parseFloat(we)||0;_(ye=>({...ye,[re]:ve}))},V=re=>{i(re.title),o(re.description||""),u(re.academic_year),d(re.branch||"All"),h(re.is_percentage),g(re.show_in_payment||!1);const we={};e.forEach(ve=>we[ve.id]=0),re.items.forEach(ve=>{we[ve.fee_type_id]=ve.percentage}),_(we),O(!0),M(re.title),k(re.academic_year),window.scrollTo({top:0,behavior:"smooth"}),H("Editing mode enabled. Make changes and click Update.")},Oe=async(re,we)=>{if(window.confirm(`Are you sure you want to delete "${re}" for ${we}?`))try{await Ee.delete(`/concessions/${re}/${we}`),H("Concession deleted successfully"),R()}catch(ve){console.error("Error deleting concession:",ve),alert("Student record exist for this concession,Cannot delete")}},Te=async()=>{var re,we;if(!a||!c){alert("Please fill Title and Academic Year");return}D(!0),H("");try{const ve=Object.keys(S).map(Ce=>({fee_type_id:parseInt(Ce),percentage:S[parseInt(Ce)]})),ye={title:a,description:s,academic_year:c,branch:f,is_percentage:p,show_in_payment:m,items:ve};E?(await Ee.put(`/concessions/${F}/${C}`,ye),H("Concession updated successfully!")):(await Ee.post("/concessions",ye),H("Concession created successfully!")),be(),R()}catch(ve){console.error("Error saving concession:",ve),H(`Error: ${((we=(re=ve.response)==null?void 0:re.data)==null?void 0:we.error)||ve.message}`)}finally{D(!1)}},be=()=>{i(""),o(""),b(""),u(localStorage.getItem("academicYear")||"");const re=JSON.parse(localStorage.getItem("user")||"{}");re.role!=="Admin"&&re.branch?d(re.branch):d(localStorage.getItem("currentBranch")||"All"),g(!1),O(!1),M(""),k(""),G(e)};return l.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md border p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6 border-b pb-4",children:[l.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:E?"Edit Concession Type":"Add Concession Type"})]}),U.length>0&&X&&l.jsxs("div",{className:"flex justify-end mb-4 relative",ref:P,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm bottom-10",onClick:()=>xe(!se),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),se&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b px-2",children:"Select Target Branches"}),(()=>{const re=U.filter(ve=>String(ve.id)!==String(X)&&ve.name!=="All Branches"&&ve.name!=="All"),we={};return re.forEach(ve=>{we[ve.location_name]||(we[ve.location_name]=[]),we[ve.location_name].push(ve)}),Object.keys(we).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(we).map(ve=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:ve}),l.jsx("div",{className:"py-1",children:we[ve].map(ye=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:K.has(String(ye.id)),onChange:()=>J(String(ye.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:ye.name})]},ye.id))})]},ve))})(),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white p-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[K.size," selected"]}),l.jsx("button",{onClick:q,disabled:A||K.size===0,className:`px-3 py-1 text-xs text-white rounded ${A||K.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:A?"Copying...":"Confirm Copy"})]})]})]}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title*"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-violet-500 focus:border-violet-500",value:a,onChange:re=>i(re.target.value),placeholder:"e.g. Sibling Discount"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-violet-500 focus:border-violet-500",value:s,onChange:re=>o(re.target.value)})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-100 cursor-not-allowed",value:c,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-100 cursor-not-allowed",value:f,readOnly:!0})]})]}),l.jsxs("div",{className:"flex items-center justify-between bg-pink-50 p-4 rounded-md border border-pink-100",children:[l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-violet-600 rounded",checked:p,onChange:re=>h(re.target.checked)}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Is Concession in percentage?"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-3 py-2 w-40",placeholder:"Enter Percentage",value:x,onChange:re=>b(re.target.value),disabled:!p}),l.jsx("button",{onClick:Q,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 font-medium",children:"Copy"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx("input",{type:"checkbox",id:"showInPayment",className:"form-checkbox h-5 w-5 text-violet-600 rounded",checked:m,onChange:re=>g(re.target.checked)}),l.jsx("label",{htmlFor:"showInPayment",className:"text-gray-700 font-medium cursor-pointer",children:"Show in Fee Payment Dropdown?"})]})]}),l.jsx("div",{className:"border rounded-md overflow-hidden mb-6",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:l.jsx("input",{type:"checkbox",className:"rounded"})}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Concession Percentage"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(re=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"checkbox",className:"rounded"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:re.fee_type}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-3 py-1 w-full focus:ring-violet-500 focus:border-violet-500",value:S[re.id]||0,onChange:we=>fe(re.id,we.target.value)})})]},re.id))})]})}),j&&l.jsx("div",{className:`p-4 mb-4 rounded-md ${j.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:j}),l.jsxs("div",{className:"flex justify-end space-x-3 border-t pt-4",children:[l.jsx("button",{onClick:be,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:E?"Cancel Edit":"Reset"}),l.jsx("button",{onClick:Te,disabled:W,className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 disabled:opacity-50",children:W?"Saving...":E?"Update Concession":"Save Concession"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md border p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Existing Concessions"}),r.length===0?l.jsx("p",{className:"text-gray-500 text-center py-4",children:"No concessions found."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academic Year"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Show in Payment"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((re,we)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:re.title}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:re.academic_year}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${!re.branch||re.branch==="All"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:re.branch||"All"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:re.show_in_payment?l.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Yes"}):l.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:"No"})}),l.jsx("td",{className:"px-6 py-4 text-gray-500",children:re.description}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>V(re),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),l.jsx("button",{onClick:()=>Oe(re.title,re.academic_year),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},we))})]})})]})]})})},Nce=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState([]),[s,o]=y.useState([]),[c,u]=y.useState(""),[f,d]=y.useState(""),[p,h]=y.useState(null),[m,g]=y.useState(""),[x,b]=y.useState(""),[S,_]=y.useState(!1),[E,O]=y.useState([]),[F,M]=y.useState([]),[C,k]=y.useState({}),[W,D]=y.useState(!1),[j,H]=y.useState("");y.useEffect(()=>{U(),Y();const se=localStorage.getItem("user");if(se){const xe=JSON.parse(se);_(xe.role==="Admin")}},[]);const U=async()=>{try{const xe=(await Ee.get("/classes")).data.classes.map(A=>String(A.class_name));t([...new Set(xe)])}catch(se){console.error("Error fetching classes:",se)}},Y=async()=>{try{const se=await Ee.get("/concessions"),xe=localStorage.getItem("academicYear")||"",A=se.data.concessions.filter(I=>I.academic_year===xe);o(A)}catch(se){console.error("Error fetching concessions:",se)}};y.useEffect(()=>{if(!c){n([]);return}(async()=>{try{const xe=new URLSearchParams;xe.append("class",c);const A=localStorage.getItem("currentBranch")||"All",I=A==="All Branches"||A==="All"?"All":A;xe.append("branch",I),console.log("Fetching sections with params:",xe.toString());const P=await Ee.get(`/students?${xe}`);console.log("Students API Response for Sections:",P.data);const L=P.data,R=Array.isArray(L)?L:L.students||[];console.log("Student count:",R.length);const G=R.map(q=>q.section);console.log("Raw Sections extracted:",G);const J=[...new Set(G.filter(Boolean))].sort();console.log("Final Unique Sections:",J),n(J)}catch(xe){console.error("Error fetching sections:",xe)}})()},[c]),y.useEffect(()=>{(async()=>{try{const xe=new URLSearchParams;c&&xe.append("class",c),f&&xe.append("section",f),x&&xe.append("search",x);const A=localStorage.getItem("currentBranch")||"All",I=A==="All Branches"||A==="All"?"All":A;xe.append("branch",I);const L=(await Ee.get(`/students?${xe}`)).data;i(Array.isArray(L)?L:L.students||[])}catch(xe){console.error("Error fetching students:",xe)}})()},[c,f,x]),y.useEffect(()=>{if(!p){O([]);return}(async()=>{try{const xe=await Ee.get(`/fees/student-details/${p}`);O(xe.data.installments||[]),M([]),k({})}catch(xe){console.error("Error fetching installments:",xe)}})()},[p]),y.useEffect(()=>{if(!m||E.length===0){k({});return}const se=s.find(A=>A.title===m);if(!se)return;const xe={};E.forEach(A=>{if(!A.student_fee_id)return;const I=se.items.find(P=>P.fee_type_id===A.fee_type_id);if(I){const P=A.payable;let L=0;se.is_percentage?L=P*(I.percentage/100):L=Math.min(P,I.percentage),xe[A.student_fee_id]=Math.round(L)}}),k(xe)},[m,E]);const X=se=>{M(xe=>xe.includes(se)?xe.filter(A=>A!==se):[...xe,se])},Z=se=>{if(se.target.checked){const xe=E.filter(A=>{const I=A.student_fee_id&&C[A.student_fee_id]!==void 0,P=(A.paidAmount||0)>0,L=(A.concession||0)>0;return I&&!P&&!L}).map(A=>A.student_fee_id);M(xe)}else M([])},K=async()=>{var se,xe;if(!p||!m||F.length===0){alert("Please select a student, a concession, and at least one installment.");return}if(window.confirm(`Assign concession to ${F.length} installments? This will update the fee records.`)){D(!0);try{const A=s.find(P=>P.title===m);await Ee.post("/fees/assign-concession",{student_id:p,concession_title:m,academic_year:(A==null?void 0:A.academic_year)||localStorage.getItem("academicYear")||"",installments:F}),H("Concession assigned successfully!");const I=await Ee.get(`/fees/student-details/${p}`);O(I.data.installments||[]),M([])}catch(A){console.error("Error assigning concession:",A),H(`Error: ${((xe=(se=A.response)==null?void 0:se.data)==null?void 0:xe.error)||A.message}`)}finally{D(!1)}}},z=s.find(se=>se.title===m);return l.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[l.jsx("span",{className:"text-violet-600 mr-2",children:"₹"})," Student Concession"]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border grid grid-cols-1 md:grid-cols-5 gap-4",children:[l.jsx("input",{type:"text",placeholder:"Search Admission No...",className:"border p-2 rounded",value:x,onChange:se=>b(se.target.value)}),l.jsxs("select",{className:"border p-2 rounded",value:c,onChange:se=>{u(se.target.value),d("")},children:[l.jsx("option",{value:"",children:"Select Class"}),e.map(se=>l.jsx("option",{value:se,children:se},se))]}),l.jsxs("select",{className:"border p-2 rounded",value:f,onChange:se=>d(se.target.value),children:[l.jsx("option",{value:"",children:"Select Section"}),r.map(se=>l.jsx("option",{value:se,children:se},se))]}),l.jsxs("select",{className:"border p-2 rounded",value:p||"",onChange:se=>h(Number(se.target.value)||null),children:[l.jsx("option",{value:"",children:"Select Student"}),a.map(se=>l.jsxs("option",{value:se.student_id,children:[se.name," (",se.admNo,")"]},se.student_id))]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Concession Template"}),l.jsxs("select",{className:"w-full border p-2 rounded focus:ring-violet-500 focus:border-violet-500",value:m,onChange:se=>g(se.target.value),children:[l.jsx("option",{value:"",children:"-- Select Concession --"}),s.map((se,xe)=>l.jsx("option",{value:se.title,children:se.title},xe))]})]}),z&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Concession Rules"}),l.jsx("div",{className:"border rounded overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Fee Type"}),l.jsxs("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:["Value (",z.is_percentage?"%":"₹",")"]})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.items.map((se,xe)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-900",children:se.fee_type_name}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:se.percentage})]},xe))})]})})]})]}),l.jsxs("div",{className:"lg:col-span-2 bg-white p-4 rounded-lg shadow border",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-800",children:"Student Installments"}),j&&l.jsx("span",{className:`text-sm ${j.includes("Error")?"text-red-600":"text-green-600"}`,children:j})]}),E.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"Select a student to view installments."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 w-10",children:l.jsx("input",{type:"checkbox",onChange:Z})}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Installment"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Total Fee"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Paid"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Current Concession"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-violet-600",children:"New Concession"}),l.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-500",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(se=>{const xe=se.student_fee_id?C[se.student_fee_id]:void 0,A=xe!==void 0,I=(se.paidAmount||0)>0,P=(se.concession||0)>0,L=I||P;let R="";return I?R="Cannot apply concession to paid/partial fees":P&&(R="Fee already has a concession"),l.jsxs("tr",{className:A?"bg-violet-50":"",children:[l.jsx("td",{className:"px-3 py-2 text-center",title:R,children:l.jsx("input",{type:"checkbox",checked:se.student_fee_id?F.includes(se.student_fee_id):!1,onChange:()=>se.student_fee_id&&!L&&X(se.student_fee_id),disabled:!A||L})}),l.jsxs("td",{className:"px-3 py-2 text-gray-900",children:[se.title,L&&l.jsxs("span",{className:"ml-2 text-xs text-red-500",children:["(",I?"Paid":"Has Concession",")"]})]}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:se.payable}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:se.paidAmount||0}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:se.concession||0}),l.jsx("td",{className:"px-3 py-2 text-right font-bold text-violet-600",children:A&&!L?xe:"-"}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${se.paid?"bg-green-100 text-green-800":(se.paidAmount||0)>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:se.paid?"Paid":(se.paidAmount||0)>0?"Partial":"Pending"})})]},se.sr)})})]})}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx("button",{onClick:K,disabled:W||F.length===0,className:"bg-violet-600 text-white px-6 py-2 rounded shadow hover:bg-violet-700 disabled:opacity-50",children:W?"Assigning...":"Assign Concession"})})]})]})]})})},Ace=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState(""),[s,o]=y.useState(null),[c,u]=y.useState([]),[f,d]=y.useState([]),[p,h]=y.useState([]),[m,g]=y.useState([]),[x,b]=y.useState(!1),[S,_]=y.useState(null),[E,O]=y.useState(!1);y.useEffect(()=>{const U=JSON.parse(localStorage.getItem("user")||"{}");O(U.role==="Admin"),F(),M()},[]),y.useEffect(()=>{(r||e)&&C()},[r,a,e]),y.useEffect(()=>{s?k():d([])},[s]);const F=async()=>{try{const Y=(await Ee.get("/classes")).data.classes.map(X=>X.class_name);h(Y)}catch(U){console.error("Error fetching classes:",U)}},M=async()=>{try{const U=await Ee.get("/fee-types");g(U.data.fee_types||[])}catch(U){console.error("Error fetching fee types:",U)}},C=async()=>{try{const U=new URLSearchParams;r&&U.append("class",r),a&&U.append("section",a),e&&U.append("search",e);const Y=JSON.parse(localStorage.getItem("user")||"{}");let X=localStorage.getItem("currentBranch")||"All";Y.role!=="Admin"&&Y.branch&&(X=Y.branch);const Z=X==="All Branches"||X==="All"?"All":X;U.append("branch",Z);const K=await Ee.get(`/fees/students?${U.toString()}`);u(Array.isArray(K.data)?K.data:K.data.students||[])}catch(U){console.error("Error fetching students:",U)}},k=async()=>{if(s)try{const U=await Ee.get(`/fees/student-details/${s}`);d(U.data.installments||[])}catch(U){console.error("Error fetching installments:",U)}},W=async(U,Y,X)=>{var Z,K;try{await Ee.put(`/fees/student-fee/${U}`,{total_fee:Y,concession:X}),k(),_(null),alert("Fee updated successfully")}catch(z){alert(((K=(Z=z.response)==null?void 0:Z.data)==null?void 0:K.error)||"Failed to update fee")}},D=async U=>{var Y,X;if(window.confirm("Are you sure you want to delete this fee?"))try{await Ee.delete(`/fees/student-fee/${U}`),k(),alert("Fee deleted successfully")}catch(Z){alert(((X=(Y=Z.response)==null?void 0:Y.data)==null?void 0:X.error)||"Failed to delete fee")}},j=async(U,Y,X)=>{var Z,K;if(s)try{await Ee.post("/fees/student-fee/add",{student_id:s,fee_type_id:U,amount:Y,month:X}),k(),b(!1),alert("Fee added successfully")}catch(z){alert(((K=(Z=z.response)==null?void 0:Z.data)==null?void 0:K.error)||"Failed to add fee")}},H=c.find(U=>U.student_id===s);return l.jsxs("div",{className:"container-fluid mx-auto p-4 bg-gray-50 min-h-screen",children:[l.jsxs("div",{className:"bg-indigo-50 border-l-4 border-indigo-500 p-4 mb-6 flex justify-between items-center rounded-r shadow-sm",children:[l.jsx("div",{className:"flex items-center",children:l.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[l.jsx("span",{children:"📋"})," Update student fee structure"]})}),l.jsxs("div",{className:"flex gap-2 items-center",children:[(()=>{const U=JSON.parse(localStorage.getItem("user")||"{}"),X=U.role!=="Admin"&&U.branch?U.branch:localStorage.getItem("currentBranch")||"All";return l.jsx("input",{type:"text",value:X,readOnly:!0,className:"border rounded px-2 py-1 text-sm outline-none bg-gray-100 cursor-not-allowed w-32 focus:ring-2 ring-indigo-300",title:"Current Branch"})})(),l.jsx("input",{type:"text",placeholder:"Search Name/AdmNo",value:e,onChange:U=>t(U.target.value),className:"border rounded px-3 py-1 text-sm outline-none w-40 focus:ring-2 ring-indigo-300"}),l.jsxs("select",{value:r,onChange:U=>n(U.target.value),className:"border rounded px-2 py-1 text-sm outline-none w-24 focus:ring-2 ring-indigo-300",children:[l.jsx("option",{value:"",children:"Class"}),p.map(U=>l.jsx("option",{value:U,children:U},U))]}),l.jsxs("select",{value:s||"",onChange:U=>o(Number(U.target.value)||null),className:"border rounded px-2 py-1 text-sm outline-none w-64 focus:ring-2 ring-indigo-300",children:[l.jsx("option",{value:"",children:"Select Student"}),c.map(U=>l.jsxs("option",{value:U.student_id,children:[U.name," (",U.admNo,")"]},U.student_id))]})]})]}),s?l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:["Fee Installments for ",l.jsx("span",{className:"text-indigo-600 font-bold",children:H==null?void 0:H.name})]}),f.length===0?l.jsx("div",{className:"text-center py-10 text-gray-500",children:"No installments found for this student."}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:f.map(U=>l.jsx(jce,{installment:U,onEdit:()=>_(U),onDelete:()=>D(U.student_fee_id)},U.sr))})]}):l.jsx("div",{className:"text-center py-20 text-gray-400",children:"Please select a student to view and update fee structure."}),S&&l.jsx(kce,{fee:S,onClose:()=>_(null),onSave:W}),x&&l.jsx(Ece,{feeTypes:m,onClose:()=>b(!1),onSave:j})]})},jce=({installment:e,onEdit:t,onDelete:r})=>{const n=e.status==="Paid",a=e.status==="Partial",i=n?"bg-green-600 text-white":"bg-orange-500 text-white",s=n?"bg-green-50":"bg-orange-50";return l.jsxs("div",{className:"bg-white rounded shadow-sm border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:`px-4 py-2 flex justify-between items-center ${s}`,children:[l.jsx("span",{className:"font-semibold text-gray-700 text-sm",children:e.title}),l.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${i}`,children:e.status})]}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tuition Fee"}),l.jsx("span",{className:"text-sm font-bold text-gray-800",children:e.payable})]}),l.jsxs("div",{className:"text-xs text-gray-500 text-right mb-2",children:[e.payable," - ",e.concession," = ",e.payable-e.concession]}),l.jsxs("div",{className:"border-t pt-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs text-gray-400",children:"Total"}),l.jsxs("span",{className:"font-bold text-gray-800",children:["₹ ",e.payable-e.concession]})]}),!n&&l.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[l.jsx("button",{onClick:t,className:"p-1.5 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit",children:l.jsx(K1,{className:"w-4 h-4"})}),e.paidAmount===0&&l.jsx("button",{onClick:r,className:"p-1.5 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Delete",children:l.jsx(ej,{className:"w-4 h-4"})})]})]})]})},kce=({fee:e,onClose:t,onSave:r})=>{const[n,a]=y.useState(e.payable),[i,s]=y.useState(e.concession);return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[l.jsxs("h3",{className:"text-lg font-bold mb-4",children:["Edit Fee: ",e.title]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Total Amount"}),l.jsx("input",{type:"number",value:n,onChange:o=>a(parseFloat(o.target.value)||0),className:"w-full border rounded px-3 py-2",disabled:e.paidAmount>0}),e.paidAmount>0&&l.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Cannot change total amount for partially paid fees."})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Concession"}),l.jsx("input",{type:"number",value:i,onChange:o=>s(parseFloat(o.target.value)||0),className:"w-full border rounded px-3 py-2"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:()=>r(e.student_fee_id,n,i),className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Save"})]})]})})},Ece=({feeTypes:e,onClose:t,onSave:r})=>{const[n,a]=y.useState(""),[i,s]=y.useState(""),[o,c]=y.useState("One-Time"),u=["January","February","March","April","May","June","July","August","September","October","November","December","One-Time"];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[l.jsx("h3",{className:"text-lg font-bold mb-4",children:"Add Student Fee"}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Fee Type"}),l.jsxs("select",{value:n,onChange:f=>a(Number(f.target.value)),className:"w-full border rounded px-3 py-2",children:[l.jsx("option",{value:"",children:"Select Fee Type"}),e.map(f=>l.jsx("option",{value:f.id,children:f.fee_type},f.id))]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Month / Label"}),l.jsx("select",{value:o,onChange:f=>c(f.target.value),className:"w-full border rounded px-3 py-2",children:u.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount"}),l.jsx("input",{type:"number",value:i,onChange:f=>s(parseFloat(f.target.value)),className:"w-full border rounded px-3 py-2"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:()=>n&&i&&r(n,i,o),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:!n||!i,children:"Add"})]})]})})},Cce="modulepreload",Tce=function(e){return"/"+e},bA={},g2=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=s(r.map(u=>{if(u=Tce(u),u in bA)return;bA[u]=!0;const f=u.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":Cce,f||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),f)return new Promise((h,m)=>{p.addEventListener("load",h),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(e)}var ha=Uint8Array,ii=Uint16Array,Nw=Int32Array,Vm=new ha([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ym=new ha([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),x2=new ha([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m8=function(e,t){for(var r=new ii(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new Nw(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},g8=m8(Vm,2),x8=g8.b,v2=g8.r;x8[28]=258,v2[258]=28;var v8=m8(Ym,0),Pce=v8.b,wA=v8.r,y2=new ii(32768);for(var Tr=0;Tr<32768;++Tr){var Lo=(Tr&43690)>>1|(Tr&21845)<<1;Lo=(Lo&52428)>>2|(Lo&13107)<<2,Lo=(Lo&61680)>>4|(Lo&3855)<<4,y2[Tr]=((Lo&65280)>>8|(Lo&255)<<8)>>1}var _s=(function(e,t,r){for(var n=e.length,a=0,i=new ii(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new ii(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new ii(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],f=t-e[a],d=s[e[a]-1]++<<f,p=d|(1<<f)-1;d<=p;++d)o[y2[d]>>c]=u}else for(o=new ii(n),a=0;a<n;++a)e[a]&&(o[a]=y2[s[e[a]-1]++]>>15-e[a]);return o}),el=new ha(288);for(var Tr=0;Tr<144;++Tr)el[Tr]=8;for(var Tr=144;Tr<256;++Tr)el[Tr]=9;for(var Tr=256;Tr<280;++Tr)el[Tr]=7;for(var Tr=280;Tr<288;++Tr)el[Tr]=8;var md=new ha(32);for(var Tr=0;Tr<32;++Tr)md[Tr]=5;var Oce=_s(el,9,0),Fce=_s(el,9,1),Ice=_s(md,5,0),Lce=_s(md,5,1),L1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Hi=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},D1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Aw=function(e){return(e+7)/8|0},y8=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new ha(e.subarray(t,r))},Dce=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Gi=function(e,t,r){var n=new Error(t||Dce[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Gi),!r)throw n;return n},Mce=function(e,t,r,n){var a=e.length,i=0;if(!a||t.f&&!t.l)return r||new ha(0);var s=!r,o=s||t.i!=2,c=t.i;s&&(r=new ha(a*3));var u=function(fe){var V=r.length;if(fe>V){var Oe=new ha(Math.max(V*2,fe));Oe.set(r),r=Oe}},f=t.f||0,d=t.p||0,p=t.b||0,h=t.l,m=t.d,g=t.m,x=t.n,b=a*8;do{if(!h){f=Hi(e,d,1);var S=Hi(e,d+1,3);if(d+=3,S)if(S==1)h=Fce,m=Lce,g=9,x=5;else if(S==2){var F=Hi(e,d,31)+257,M=Hi(e,d+10,15)+4,C=F+Hi(e,d+5,31)+1;d+=14;for(var k=new ha(C),W=new ha(19),D=0;D<M;++D)W[x2[D]]=Hi(e,d+D*3,7);d+=M*3;for(var j=L1(W),H=(1<<j)-1,U=_s(W,j,1),D=0;D<C;){var Y=U[Hi(e,d,H)];d+=Y&15;var _=Y>>4;if(_<16)k[D++]=_;else{var X=0,Z=0;for(_==16?(Z=3+Hi(e,d,3),d+=2,X=k[D-1]):_==17?(Z=3+Hi(e,d,7),d+=3):_==18&&(Z=11+Hi(e,d,127),d+=7);Z--;)k[D++]=X}}var K=k.subarray(0,F),z=k.subarray(F);g=L1(K),x=L1(z),h=_s(K,g,1),m=_s(z,x,1)}else Gi(1);else{var _=Aw(d)+4,E=e[_-4]|e[_-3]<<8,O=_+E;if(O>a){c&&Gi(0);break}o&&u(p+E),r.set(e.subarray(_,O),p),t.b=p+=E,t.p=d=O*8,t.f=f;continue}if(d>b){c&&Gi(0);break}}o&&u(p+131072);for(var se=(1<<g)-1,xe=(1<<x)-1,A=d;;A=d){var X=h[D1(e,d)&se],I=X>>4;if(d+=X&15,d>b){c&&Gi(0);break}if(X||Gi(2),I<256)r[p++]=I;else if(I==256){A=d,h=null;break}else{var P=I-254;if(I>264){var D=I-257,L=Vm[D];P=Hi(e,d,(1<<L)-1)+x8[D],d+=L}var R=m[D1(e,d)&xe],G=R>>4;R||Gi(3),d+=R&15;var z=Pce[G];if(G>3){var L=Ym[G];z+=D1(e,d)&(1<<L)-1,d+=L}if(d>b){c&&Gi(0);break}o&&u(p+131072);var J=p+P;if(p<z){var q=i-z,Q=Math.min(z,J);for(q+p<0&&Gi(3);p<Q;++p)r[p]=n[q+p]}for(;p<J;++p)r[p]=r[p-z]}}t.l=h,t.p=A,t.b=p,t.f=f,h&&(f=1,t.m=g,t.d=m,t.n=x)}while(!f);return p!=r.length&&s?y8(r,0,p):r.subarray(0,p)},Us=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},bf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},M1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:w8,l:0};if(a==1){var s=new ha(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(O,F){return O.f-F.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,f=1,d=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};f!=a-1;)o=r[r[u].f<r[d].f?u++:d++],c=r[u!=f&&r[u].f<r[d].f?u++:d++],r[f++]={s:-1,f:o.f+c.f,l:o,r:c};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var h=new ii(p+1),m=b2(r[f-1],h,0);if(m>t){var n=0,g=0,x=m-t,b=1<<x;for(i.sort(function(F,M){return h[M.s]-h[F.s]||F.f-M.f});n<a;++n){var S=i[n].s;if(h[S]>t)g+=b-(1<<m-h[S]),h[S]=t;else break}for(g>>=x;g>0;){var _=i[n].s;h[_]<t?g-=1<<t-h[_]++-1:++n}for(;n>=0&&g;--n){var E=i[n].s;h[E]==t&&(--h[E],++g)}m=t}return{t:new ha(h),l:m}},b2=function(e,t,r){return e.s==-1?Math.max(b2(e.l,t,r+1),b2(e.r,t,r+1)):t[e.s]=r},SA=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ii(++t),n=0,a=e[0],i=1,s=function(c){r[n++]=c},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},wf=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},b8=function(e,t,r){var n=r.length,a=Aw(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},_A=function(e,t,r,n,a,i,s,o,c,u,f){Us(t,f++,r),++a[256];for(var d=M1(a,15),p=d.t,h=d.l,m=M1(i,15),g=m.t,x=m.l,b=SA(p),S=b.c,_=b.n,E=SA(g),O=E.c,F=E.n,M=new ii(19),C=0;C<S.length;++C)++M[S[C]&31];for(var C=0;C<O.length;++C)++M[O[C]&31];for(var k=M1(M,7),W=k.t,D=k.l,j=19;j>4&&!W[x2[j-1]];--j);var H=u+5<<3,U=wf(a,el)+wf(i,md)+s,Y=wf(a,p)+wf(i,g)+s+14+3*j+wf(M,W)+2*M[16]+3*M[17]+7*M[18];if(c>=0&&H<=U&&H<=Y)return b8(t,f,e.subarray(c,c+u));var X,Z,K,z;if(Us(t,f,1+(Y<U)),f+=2,Y<U){X=_s(p,h,0),Z=p,K=_s(g,x,0),z=g;var se=_s(W,D,0);Us(t,f,_-257),Us(t,f+5,F-1),Us(t,f+10,j-4),f+=14;for(var C=0;C<j;++C)Us(t,f+3*C,W[x2[C]]);f+=3*j;for(var xe=[S,O],A=0;A<2;++A)for(var I=xe[A],C=0;C<I.length;++C){var P=I[C]&31;Us(t,f,se[P]),f+=W[P],P>15&&(Us(t,f,I[C]>>5&127),f+=I[C]>>12)}}else X=Oce,Z=el,K=Ice,z=md;for(var C=0;C<o;++C){var L=n[C];if(L>255){var P=L>>18&31;bf(t,f,X[P+257]),f+=Z[P+257],P>7&&(Us(t,f,L>>23&31),f+=Vm[P]);var R=L&31;bf(t,f,K[R]),f+=z[R],R>3&&(bf(t,f,L>>5&8191),f+=Ym[R])}else bf(t,f,X[L]),f+=Z[L]}return bf(t,f,X[256]),f+Z[256]},Rce=new Nw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),w8=new ha(0),Bce=function(e,t,r,n,a,i){var s=i.z||e.length,o=new ha(n+s+5*(1+Math.ceil(s/7e3))+a),c=o.subarray(n,o.length-a),u=i.l,f=(i.r||0)&7;if(t){f&&(c[0]=i.r>>3);for(var d=Rce[t-1],p=d>>13,h=d&8191,m=(1<<r)-1,g=i.p||new ii(32768),x=i.h||new ii(m+1),b=Math.ceil(r/3),S=2*b,_=function(Te){return(e[Te]^e[Te+1]<<b^e[Te+2]<<S)&m},E=new Nw(25e3),O=new ii(288),F=new ii(32),M=0,C=0,k=i.i||0,W=0,D=i.w||0,j=0;k+2<s;++k){var H=_(k),U=k&32767,Y=x[H];if(g[U]=Y,x[H]=U,D<=k){var X=s-k;if((M>7e3||W>24576)&&(X>423||!u)){f=_A(e,c,0,E,O,F,C,W,j,k-j,f),W=M=C=0,j=k;for(var Z=0;Z<286;++Z)O[Z]=0;for(var Z=0;Z<30;++Z)F[Z]=0}var K=2,z=0,se=h,xe=U-Y&32767;if(X>2&&H==_(k-xe))for(var A=Math.min(p,X)-1,I=Math.min(32767,k),P=Math.min(258,X);xe<=I&&--se&&U!=Y;){if(e[k+K]==e[k+K-xe]){for(var L=0;L<P&&e[k+L]==e[k+L-xe];++L);if(L>K){if(K=L,z=xe,L>A)break;for(var R=Math.min(xe,L-2),G=0,Z=0;Z<R;++Z){var J=k-xe+Z&32767,q=g[J],Q=J-q&32767;Q>G&&(G=Q,Y=J)}}}U=Y,Y=g[U],xe+=U-Y&32767}if(z){E[W++]=268435456|v2[K]<<18|wA[z];var fe=v2[K]&31,V=wA[z]&31;C+=Vm[fe]+Ym[V],++O[257+fe],++F[V],D=k+K,++M}else E[W++]=e[k],++O[e[k]]}}for(k=Math.max(k,D);k<s;++k)E[W++]=e[k],++O[e[k]];f=_A(e,c,u,E,O,F,C,W,j,k-j,f),u||(i.r=f&7|c[f/8|0]<<3,f-=7,i.h=x,i.p=g,i.i=k,i.w=D)}else{for(var k=i.w||0;k<s+u;k+=65535){var Oe=k+65535;Oe>=s&&(c[f/8|0]=u,Oe=s),f=b8(c,f+1,e.subarray(k,Oe))}i.i=s}return y8(o,0,n+Aw(f)+a)},S8=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Uce=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new ha(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return Bce(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},_8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},zce=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=S8();a.p(t.dictionary),_8(e,2,a.d())}},$ce=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Gi(6,"invalid zlib data"),(e[1]>>5&1)==1&&Gi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function w2(e,t){t||(t={});var r=S8();r.p(e);var n=Uce(e,t,t.dictionary?6:2,4);return zce(n,t),_8(n,n.length-4,r.d()),n}function Wce(e,t){return Mce(e.subarray($ce(e),-4),{i:2},t,t)}var Hce=typeof TextDecoder<"u"&&new TextDecoder,qce=0;try{Hce.decode(w8,{stream:!0}),qce=1}catch{}var It=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function R1(){It.console&&typeof It.console.log=="function"&&It.console.log.apply(It.console,arguments)}var wr={log:R1,warn:function(e){It.console&&(typeof It.console.warn=="function"?It.console.warn.apply(It.console,arguments):R1.call(null,arguments))},error:function(e){It.console&&(typeof It.console.error=="function"?It.console.error.apply(It.console,arguments):R1(e))}};function B1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){wl(n.response,t,r)},n.onerror=function(){wr.error("could not download file")},n.send()}function NA(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function ph(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Mf,S2,wl=It.saveAs||((typeof window>"u"?"undefined":pr(window))!=="object"||window!==It?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=It.URL||It.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?NA(a.href)?B1(e,t,r):ph(a,a.target="_blank"):ph(a)):(a.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(a.href)}),4e4),setTimeout((function(){ph(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(NA(e))B1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout((function(){ph(n)}))}else navigator.msSaveOrOpenBlob((function(a,i){return i===void 0?i={autoBom:!1}:pr(i)!=="object"&&(wr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a})(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return B1(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(It.HTMLElement)||It.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":pr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var c=It.URL||It.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout((function(){c.revokeObjectURL(u)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function N8(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+o+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function U1(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=na(r,n,a,i,t[0],7,-680876936),i=na(i,r,n,a,t[1],12,-389564586),a=na(a,i,r,n,t[2],17,606105819),n=na(n,a,i,r,t[3],22,-1044525330),r=na(r,n,a,i,t[4],7,-176418897),i=na(i,r,n,a,t[5],12,1200080426),a=na(a,i,r,n,t[6],17,-1473231341),n=na(n,a,i,r,t[7],22,-45705983),r=na(r,n,a,i,t[8],7,1770035416),i=na(i,r,n,a,t[9],12,-1958414417),a=na(a,i,r,n,t[10],17,-42063),n=na(n,a,i,r,t[11],22,-1990404162),r=na(r,n,a,i,t[12],7,1804603682),i=na(i,r,n,a,t[13],12,-40341101),a=na(a,i,r,n,t[14],17,-1502002290),r=aa(r,n=na(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=aa(i,r,n,a,t[6],9,-1069501632),a=aa(a,i,r,n,t[11],14,643717713),n=aa(n,a,i,r,t[0],20,-373897302),r=aa(r,n,a,i,t[5],5,-701558691),i=aa(i,r,n,a,t[10],9,38016083),a=aa(a,i,r,n,t[15],14,-660478335),n=aa(n,a,i,r,t[4],20,-405537848),r=aa(r,n,a,i,t[9],5,568446438),i=aa(i,r,n,a,t[14],9,-1019803690),a=aa(a,i,r,n,t[3],14,-187363961),n=aa(n,a,i,r,t[8],20,1163531501),r=aa(r,n,a,i,t[13],5,-1444681467),i=aa(i,r,n,a,t[2],9,-51403784),a=aa(a,i,r,n,t[7],14,1735328473),r=ia(r,n=aa(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=ia(i,r,n,a,t[8],11,-2022574463),a=ia(a,i,r,n,t[11],16,1839030562),n=ia(n,a,i,r,t[14],23,-35309556),r=ia(r,n,a,i,t[1],4,-1530992060),i=ia(i,r,n,a,t[4],11,1272893353),a=ia(a,i,r,n,t[7],16,-155497632),n=ia(n,a,i,r,t[10],23,-1094730640),r=ia(r,n,a,i,t[13],4,681279174),i=ia(i,r,n,a,t[0],11,-358537222),a=ia(a,i,r,n,t[3],16,-722521979),n=ia(n,a,i,r,t[6],23,76029189),r=ia(r,n,a,i,t[9],4,-640364487),i=ia(i,r,n,a,t[12],11,-421815835),a=ia(a,i,r,n,t[15],16,530742520),r=sa(r,n=ia(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=sa(i,r,n,a,t[7],10,1126891415),a=sa(a,i,r,n,t[14],15,-1416354905),n=sa(n,a,i,r,t[5],21,-57434055),r=sa(r,n,a,i,t[12],6,1700485571),i=sa(i,r,n,a,t[3],10,-1894986606),a=sa(a,i,r,n,t[10],15,-1051523),n=sa(n,a,i,r,t[1],21,-2054922799),r=sa(r,n,a,i,t[8],6,1873313359),i=sa(i,r,n,a,t[15],10,-30611744),a=sa(a,i,r,n,t[6],15,-1560198380),n=sa(n,a,i,r,t[13],21,1309151649),r=sa(r,n,a,i,t[4],6,-145523070),i=sa(i,r,n,a,t[11],10,-1120210379),a=sa(a,i,r,n,t[2],15,718787259),n=sa(n,a,i,r,t[9],21,-343485551),e[0]=Wo(r,e[0]),e[1]=Wo(n,e[1]),e[2]=Wo(a,e[2]),e[3]=Wo(i,e[3])}function Km(e,t,r,n,a,i){return t=Wo(Wo(t,e),Wo(n,i)),Wo(t<<a|t>>>32-a,r)}function na(e,t,r,n,a,i,s){return Km(t&r|~t&n,e,t,a,i,s)}function aa(e,t,r,n,a,i,s){return Km(t&n|r&~n,e,t,a,i,s)}function ia(e,t,r,n,a,i,s){return Km(t^r^n,e,t,a,i,s)}function sa(e,t,r,n,a,i,s){return Km(r^(t|~n),e,t,a,i,s)}function A8(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)U1(n,Gce(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(U1(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,U1(n,a),n}function Gce(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Mf=It.atob.bind(It),S2=It.btoa.bind(It);var AA="0123456789abcdef".split("");function Vce(e){for(var t="",r=0;r<4;r++)t+=AA[e>>8*r+4&15]+AA[e>>8*r&15];return t}function Yce(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function _2(e){return A8(e).map(Yce).join("")}var Kce=(function(e){for(var t=0;t<e.length;t++)e[t]=Vce(e[t]);return e.join("")})(A8("hello"))!="5d41402abc4b2a76b9719d911017c592";function Wo(e,t){if(Kce){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function N2(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var u=0;for(c=0;c<256;c++){var f=o[c];u=(u+f+s.charCodeAt(c))%256,o[c]=o[u],o[u]=f}r=e,n=o}else o=n;var d=t.length,p=0,h=0,m="";for(c=0;c<d;c++)h=(h+(f=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=f,s=o[(o[p]+o[h])%256],m+=String.fromCharCode(t.charCodeAt(c)^s);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var jA={print:4,modify:8,copy:16,"annot-forms":32};function Wc(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach((function(o){if(jA.perm!==void 0)throw new Error("Invalid permission: "+o);a+=jA[o]})),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=_2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=N2(this.encryptionKey,this.padding)}function Hc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function kA(e){if(pr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){It.console&&wr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Up(e){if(!(this instanceof Up))return new Up(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function j8(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function _l(e,t,r,n,a){if(!(this instanceof _l))return new _l(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,j8.call(this,n,a)}function Yc(e,t,r,n,a){if(!(this instanceof Yc))return new Yc(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,j8.call(this,n,a)}function Ot(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,c=16,u="S",f=null;pr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=kA;var m="1.3",g=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(N){m=N};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var b=h.__private__.getPageFormat=function(N){return x[N]};a=a||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},_=S.COMPAT;function E(){this.saveGraphicsState(),re(new Tt(Ae,0,0,-Ae,0,So()*Ae).toString()+" cm"),this.setFontSize(this.getFontSize()/Ae),u="n",_=S.ADVANCED}function O(){this.restoreGraphicsState(),u="S",_=S.COMPAT}var F=h.__private__.combineFontStyleAndFontWeight=function(N,te){if(N=="bold"&&te=="normal"||N=="bold"&&te==400||N=="normal"&&te=="italic"||N=="bold"&&te=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return te&&(N=te==400||te==="normal"?N==="italic"?"italic":"normal":te!=700&&te!=="bold"||N!=="normal"?(te==700?"bold":te)+""+N:"bold"),N};h.advancedAPI=function(N){var te=_===S.COMPAT;return te&&E.call(this),typeof N!="function"||(N(this),te&&O.call(this)),this},h.compatAPI=function(N){var te=_===S.ADVANCED;return te&&O.call(this),typeof N!="function"||(N(this),te&&E.call(this)),this},h.isAdvancedAPI=function(){return _===S.ADVANCED};var M,C=function(N){if(_!==S.ADVANCED)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},k=h.roundToPrecision=h.__private__.roundToPrecision=function(N,te){var ge=t||te;if(isNaN(N)||isNaN(ge))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(ge).replace(/0+$/,"")};M=h.hpf=h.__private__.hpf=typeof c=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return k(N,c)}:c==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return k(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return k(N,16)};var W=h.f2=h.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return k(N,2)},D=h.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return k(N,3)},j=h.scale=h.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return _===S.COMPAT?N*Ae:_===S.ADVANCED?N:void 0},H=function(N){return _===S.COMPAT?So()-N:_===S.ADVANCED?N:void 0},U=function(N){return j(H(N))};h.__private__.setPrecision=h.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(t=parseInt(N,10))};var Y,X="00000000000000000000000000000000",Z=h.__private__.getFileId=function(){return X},K=h.__private__.setFileId=function(N){return X=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():X.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),f!==null&&(ea=new Wc(f.userPermissions,f.userPassword,f.ownerPassword,X)),X};h.setFileId=function(N){return K(N),this},h.getFileId=function(){return Z()};var z=h.__private__.convertDateToPDFDate=function(N){var te=N.getTimezoneOffset(),ge=te<0?"+":"-",Se=Math.floor(Math.abs(te/60)),Pe=Math.abs(te%60),qe=[ge,P(Se),"'",P(Pe),"'"].join("");return["D:",N.getFullYear(),P(N.getMonth()+1),P(N.getDate()),P(N.getHours()),P(N.getMinutes()),P(N.getSeconds()),qe].join("")},se=h.__private__.convertPDFDateToDate=function(N){var te=parseInt(N.substr(2,4),10),ge=parseInt(N.substr(6,2),10)-1,Se=parseInt(N.substr(8,2),10),Pe=parseInt(N.substr(10,2),10),qe=parseInt(N.substr(12,2),10),et=parseInt(N.substr(14,2),10);return new Date(te,ge,Se,Pe,qe,et,0)},xe=h.__private__.setCreationDate=function(N){var te;if(N===void 0&&(N=new Date),N instanceof Date)te=z(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");te=N}return Y=te},A=h.__private__.getCreationDate=function(N){var te=Y;return N==="jsDate"&&(te=se(Y)),te};h.setCreationDate=function(N){return xe(N),this},h.getCreationDate=function(N){return A(N)};var I,P=h.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},L=h.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},R=0,G=[],J=[],q=0,Q=[],fe=[],V=!1,Oe=J,Te=function(){R=0,q=0,J=[],G=[],Q=[],ce=Wr(),ue=Wr()};h.__private__.setCustomOutputDestination=function(N){V=!0,Oe=N};var be=function(N){V||(Oe=N)};h.__private__.resetCustomOutputDestination=function(){V=!1,Oe=J};var re=h.__private__.out=function(N){return N=N.toString(),q+=N.length+1,Oe.push(N),Oe},we=h.__private__.write=function(N){return re(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},ve=h.__private__.getArrayBuffer=function(N){for(var te=N.length,ge=new ArrayBuffer(te),Se=new Uint8Array(ge);te--;)Se[te]=N.charCodeAt(te);return ge},ye=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ye};var Ce=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(N){return Ce=_===S.ADVANCED?N/Ae:N,this};var ze,$e=h.__private__.getFontSize=h.getFontSize=function(){return _===S.COMPAT?Ce:Ce*Ae},Ue=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(N){return Ue=N,this},h.__private__.getR2L=h.getR2L=function(){return Ue};var Xe,Qe=h.__private__.setZoomMode=function(N){var te=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))ze=N;else if(isNaN(N)){if(te.indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');ze=N}else ze=parseInt(N,10)};h.__private__.getZoomMode=function(){return ze};var bt,Dt=h.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');Xe=N};h.__private__.getPageMode=function(){return Xe};var kt=h.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');bt=N};h.__private__.getLayoutMode=function(){return bt},h.__private__.setDisplayMode=h.setDisplayMode=function(N,te,ge){return Qe(N),kt(te),Dt(ge),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(N){if(Object.keys(wt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[N]},h.__private__.getDocumentProperties=function(){return wt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(N){for(var te in wt)wt.hasOwnProperty(te)&&N[te]&&(wt[te]=N[te]);return this},h.__private__.setDocumentProperty=function(N,te){if(Object.keys(wt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[N]=te};var it,Ae,tt,at,Ct,_t={},xt={},fn=[],Nt={},kr={},ir={},Oa={},ba=null,or=0,Et=[],Kt=new kA(h),Li=e.hotfixes||[],Zr={},wa={},ui=[],Tt=function N(te,ge,Se,Pe,qe,et){if(!(this instanceof N))return new N(te,ge,Se,Pe,qe,et);isNaN(te)&&(te=1),isNaN(ge)&&(ge=0),isNaN(Se)&&(Se=0),isNaN(Pe)&&(Pe=1),isNaN(qe)&&(qe=0),isNaN(et)&&(et=0),this._matrix=[te,ge,Se,Pe,qe,et]};Object.defineProperty(Tt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Tt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Tt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Tt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Tt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Tt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Tt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Tt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Tt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Tt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Tt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Tt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Tt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Tt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Tt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Tt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Tt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(M).join(N)},Tt.prototype.multiply=function(N){var te=N.sx*this.sx+N.shy*this.shx,ge=N.sx*this.shy+N.shy*this.sy,Se=N.shx*this.sx+N.sy*this.shx,Pe=N.shx*this.shy+N.sy*this.sy,qe=N.tx*this.sx+N.ty*this.shx+this.tx,et=N.tx*this.shy+N.ty*this.sy+this.ty;return new Tt(te,ge,Se,Pe,qe,et)},Tt.prototype.decompose=function(){var N=this.sx,te=this.shy,ge=this.shx,Se=this.sy,Pe=this.tx,qe=this.ty,et=Math.sqrt(N*N+te*te),ht=(N/=et)*ge+(te/=et)*Se;ge-=N*ht,Se-=te*ht;var At=Math.sqrt(ge*ge+Se*Se);return ht/=At,N*(Se/=At)<te*(ge/=At)&&(N=-N,te=-te,ht=-ht,et=-et),{scale:new Tt(et,0,0,At,0,0),translate:new Tt(1,0,0,1,Pe,qe),rotate:new Tt(N,te,-te,N,0,0),skew:new Tt(1,0,ht,1,0,0)}},Tt.prototype.toString=function(N){return this.join(" ")},Tt.prototype.inversed=function(){var N=this.sx,te=this.shy,ge=this.shx,Se=this.sy,Pe=this.tx,qe=this.ty,et=1/(N*Se-te*ge),ht=Se*et,At=-te*et,$t=-ge*et,Ut=N*et;return new Tt(ht,At,$t,Ut,-ht*Pe-$t*qe,-At*Pe-Ut*qe)},Tt.prototype.applyToPoint=function(N){var te=N.x*this.sx+N.y*this.shx+this.tx,ge=N.x*this.shy+N.y*this.sy+this.ty;return new gc(te,ge)},Tt.prototype.applyToRectangle=function(N){var te=this.applyToPoint(N),ge=this.applyToPoint(new gc(N.x+N.w,N.y+N.h));return new $u(te.x,te.y,ge.x-te.x,ge.y-te.y)},Tt.prototype.clone=function(){var N=this.sx,te=this.shy,ge=this.shx,Se=this.sy,Pe=this.tx,qe=this.ty;return new Tt(N,te,ge,Se,Pe,qe)},h.Matrix=Tt;var Ga=h.matrixMult=function(N,te){return te.multiply(N)},Fa=new Tt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Fa;var Qn=function(N,te){if(!kr[N]){var ge=(te instanceof _l?"Sh":"P")+(Object.keys(Nt).length+1).toString(10);te.id=ge,kr[N]=ge,Nt[ge]=te,Kt.publish("addPattern",te)}};h.ShadingPattern=_l,h.TilingPattern=Yc,h.addShadingPattern=function(N,te){return C("addShadingPattern()"),Qn(N,te),this},h.beginTilingPattern=function(N){C("beginTilingPattern()"),c0(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},h.endTilingPattern=function(N,te){C("endTilingPattern()"),te.stream=fe[I].join(`
`),Qn(N,te),Kt.publish("endTilingPattern",te),ui.pop().restore()};var Qr=h.__private__.newObject=function(){var N=Wr();return ae(N,!0),N},Wr=h.__private__.newObjectDeferred=function(){return R++,G[R]=function(){return q},R},ae=function(N,te){return te=typeof te=="boolean"&&te,G[N]=q,te&&re(N+" 0 obj"),N},pe=h.__private__.newAdditionalObject=function(){var N={objId:Wr(),content:""};return Q.push(N),N},ce=Wr(),ue=Wr(),he=h.__private__.decodeColorString=function(N){var te=N.split(" ");if(te.length!==2||te[1]!=="g"&&te[1]!=="G")te.length===5&&(te[4]==="k"||te[4]==="K")&&(te=[(1-te[0])*(1-te[3]),(1-te[1])*(1-te[3]),(1-te[2])*(1-te[3]),"r"]);else{var ge=parseFloat(te[0]);te=[ge,ge,ge,"r"]}for(var Se="#",Pe=0;Pe<3;Pe++)Se+=("0"+Math.floor(255*parseFloat(te[Pe])).toString(16)).slice(-2);return Se},me=h.__private__.encodeColorString=function(N){var te;typeof N=="string"&&(N={ch1:N});var ge=N.ch1,Se=N.ch2,Pe=N.ch3,qe=N.ch4,et=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ge=="string"&&ge.charAt(0)!=="#"){var ht=new N8(ge);if(ht.ok)ge=ht.toHex();else if(!/^\d*\.?\d*$/.test(ge))throw new Error('Invalid color "'+ge+'" passed to jsPDF.encodeColorString.')}if(typeof ge=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ge)&&(ge="#"+ge[1]+ge[1]+ge[2]+ge[2]+ge[3]+ge[3]),typeof ge=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ge)){var At=parseInt(ge.substr(1),16);ge=At>>16&255,Se=At>>8&255,Pe=255&At}if(Se===void 0||qe===void 0&&ge===Se&&Se===Pe)if(typeof ge=="string")te=ge+" "+et[0];else switch(N.precision){case 2:te=W(ge/255)+" "+et[0];break;case 3:default:te=D(ge/255)+" "+et[0]}else if(qe===void 0||pr(qe)==="object"){if(qe&&!isNaN(qe.a)&&qe.a===0)return te=["1.","1.","1.",et[1]].join(" ");if(typeof ge=="string")te=[ge,Se,Pe,et[1]].join(" ");else switch(N.precision){case 2:te=[W(ge/255),W(Se/255),W(Pe/255),et[1]].join(" ");break;default:case 3:te=[D(ge/255),D(Se/255),D(Pe/255),et[1]].join(" ")}}else if(typeof ge=="string")te=[ge,Se,Pe,qe,et[2]].join(" ");else switch(N.precision){case 2:te=[W(ge),W(Se),W(Pe),W(qe),et[2]].join(" ");break;case 3:default:te=[D(ge),D(Se),D(Pe),D(qe),et[2]].join(" ")}return te},Ie=h.__private__.getFilters=function(){return s},We=h.__private__.putStream=function(N){var te=(N=N||{}).data||"",ge=N.filters||Ie(),Se=N.alreadyAppliedFilters||[],Pe=N.addLength1||!1,qe=te.length,et=N.objectId,ht=function(ta){return ta};if(f!==null&&et===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(ht=ea.encryptor(et,0));var At={};ge===!0&&(ge=["FlateEncode"]);var $t=N.additionalKeyValues||[],Ut=(At=Ot.API.processDataByFilters!==void 0?Ot.API.processDataByFilters(te,ge):{data:te,reverseChain:[]}).reverseChain+(Array.isArray(Se)?Se.join(" "):Se.toString());if(At.data.length!==0&&($t.push({key:"Length",value:At.data.length}),Pe===!0&&$t.push({key:"Length1",value:qe})),Ut.length!=0)if(Ut.split("/").length-1==1)$t.push({key:"Filter",value:Ut});else{$t.push({key:"Filter",value:"["+Ut+"]"});for(var Xt=0;Xt<$t.length;Xt+=1)if($t[Xt].key==="DecodeParms"){for(var Rr=[],Hr=0;Hr<At.reverseChain.split("/").length-1;Hr+=1)Rr.push("null");Rr.push($t[Xt].value),$t[Xt].value="["+Rr.join(" ")+"]"}}re("<<");for(var hn=0;hn<$t.length;hn++)re("/"+$t[hn].key+" "+$t[hn].value);re(">>"),At.data.length!==0&&(re("stream"),re(ht(At.data)),re("endstream"))},Fe=h.__private__.putPage=function(N){var te=N.number,ge=N.data,Se=N.objId,Pe=N.contentsObjId;ae(Se,!0),re("<</Type /Page"),re("/Parent "+N.rootDictionaryObjId+" 0 R"),re("/Resources "+N.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(M(N.mediaBox.bottomLeftX))+" "+parseFloat(M(N.mediaBox.bottomLeftY))+" "+M(N.mediaBox.topRightX)+" "+M(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&re("/CropBox ["+M(N.cropBox.bottomLeftX)+" "+M(N.cropBox.bottomLeftY)+" "+M(N.cropBox.topRightX)+" "+M(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&re("/BleedBox ["+M(N.bleedBox.bottomLeftX)+" "+M(N.bleedBox.bottomLeftY)+" "+M(N.bleedBox.topRightX)+" "+M(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&re("/TrimBox ["+M(N.trimBox.bottomLeftX)+" "+M(N.trimBox.bottomLeftY)+" "+M(N.trimBox.topRightX)+" "+M(N.trimBox.topRightY)+"]"),N.artBox!==null&&re("/ArtBox ["+M(N.artBox.bottomLeftX)+" "+M(N.artBox.bottomLeftY)+" "+M(N.artBox.topRightX)+" "+M(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&re("/UserUnit "+N.userUnit),Kt.publish("putPage",{objId:Se,pageContext:Et[te],pageNumber:te,page:ge}),re("/Contents "+Pe+" 0 R"),re(">>"),re("endobj");var qe=ge.join(`
`);return _===S.ADVANCED&&(qe+=`
Q`),ae(Pe,!0),We({data:qe,filters:Ie(),objectId:Pe}),re("endobj"),Se},Me=h.__private__.putPages=function(){var N,te,ge=[];for(N=1;N<=or;N++)Et[N].objId=Wr(),Et[N].contentsObjId=Wr();for(N=1;N<=or;N++)ge.push(Fe({number:N,data:fe[N],objId:Et[N].objId,contentsObjId:Et[N].contentsObjId,mediaBox:Et[N].mediaBox,cropBox:Et[N].cropBox,bleedBox:Et[N].bleedBox,trimBox:Et[N].trimBox,artBox:Et[N].artBox,userUnit:Et[N].userUnit,rootDictionaryObjId:ce,resourceDictionaryObjId:ue}));ae(ce,!0),re("<</Type /Pages");var Se="/Kids [";for(te=0;te<or;te++)Se+=ge[te]+" 0 R ";re(Se+"]"),re("/Count "+or),re(">>"),re("endobj"),Kt.publish("postPutPages")},Be=function(N){Kt.publish("putFont",{font:N,out:re,newObject:Qr,putStream:We}),N.isAlreadyPutted!==!0&&(N.objectNumber=Qr(),re("<<"),re("/Type /Font"),re("/BaseFont /"+Hc(N.postScriptName)),re("/Subtype /Type1"),typeof N.encoding=="string"&&re("/Encoding /"+N.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},rt=function(){for(var N in _t)_t.hasOwnProperty(N)&&(d===!1||d===!0&&p.hasOwnProperty(N))&&Be(_t[N])},st=function(N){N.objectNumber=Qr();var te=[];te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Form"}),te.push({key:"BBox",value:"["+[M(N.x),M(N.y),M(N.x+N.width),M(N.y+N.height)].join(" ")+"]"}),te.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var ge=N.pages[1].join(`
`);We({data:ge,additionalKeyValues:te,objectId:N.objectNumber}),re("endobj")},dt=function(){for(var N in Zr)Zr.hasOwnProperty(N)&&st(Zr[N])},nt=function(N,te){var ge,Se=[],Pe=1/(te-1);for(ge=0;ge<1;ge+=Pe)Se.push(ge);if(Se.push(1),N[0].offset!=0){var qe={offset:0,color:N[0].color};N.unshift(qe)}if(N[N.length-1].offset!=1){var et={offset:1,color:N[N.length-1].color};N.push(et)}for(var ht="",At=0,$t=0;$t<Se.length;$t++){for(ge=Se[$t];ge>N[At+1].offset;)At++;var Ut=N[At].offset,Xt=(ge-Ut)/(N[At+1].offset-Ut),Rr=N[At].color,Hr=N[At+1].color;ht+=L(Math.round((1-Xt)*Rr[0]+Xt*Hr[0]).toString(16))+L(Math.round((1-Xt)*Rr[1]+Xt*Hr[1]).toString(16))+L(Math.round((1-Xt)*Rr[2]+Xt*Hr[2]).toString(16))}return ht.trim()},ft=function(N,te){te||(te=21);var ge=Qr(),Se=nt(N.colors,te),Pe=[];Pe.push({key:"FunctionType",value:"0"}),Pe.push({key:"Domain",value:"[0.0 1.0]"}),Pe.push({key:"Size",value:"["+te+"]"}),Pe.push({key:"BitsPerSample",value:"8"}),Pe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),We({data:Se,additionalKeyValues:Pe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ge}),re("endobj"),N.objectNumber=Qr(),re("<< /ShadingType "+N.type),re("/ColorSpace /DeviceRGB");var qe="/Coords ["+M(parseFloat(N.coords[0]))+" "+M(parseFloat(N.coords[1]))+" ";N.type===2?qe+=M(parseFloat(N.coords[2]))+" "+M(parseFloat(N.coords[3])):qe+=M(parseFloat(N.coords[2]))+" "+M(parseFloat(N.coords[3]))+" "+M(parseFloat(N.coords[4]))+" "+M(parseFloat(N.coords[5])),re(qe+="]"),N.matrix&&re("/Matrix ["+N.matrix.toString()+"]"),re("/Function "+ge+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},Rt=function(N,te){var ge=Wr(),Se=Qr();te.push({resourcesOid:ge,objectOid:Se}),N.objectNumber=Se;var Pe=[];Pe.push({key:"Type",value:"/Pattern"}),Pe.push({key:"PatternType",value:"1"}),Pe.push({key:"PaintType",value:"1"}),Pe.push({key:"TilingType",value:"1"}),Pe.push({key:"BBox",value:"["+N.boundingBox.map(M).join(" ")+"]"}),Pe.push({key:"XStep",value:M(N.xStep)}),Pe.push({key:"YStep",value:M(N.yStep)}),Pe.push({key:"Resources",value:ge+" 0 R"}),N.matrix&&Pe.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),We({data:N.stream,additionalKeyValues:Pe,objectId:N.objectNumber}),re("endobj")},sr=function(N){var te;for(te in Nt)Nt.hasOwnProperty(te)&&(Nt[te]instanceof _l?ft(Nt[te]):Nt[te]instanceof Yc&&Rt(Nt[te],N))},mr=function(N){for(var te in N.objectNumber=Qr(),re("<<"),N)switch(te){case"opacity":re("/ca "+W(N[te]));break;case"stroke-opacity":re("/CA "+W(N[te]))}re(">>"),re("endobj")},dn=function(){var N;for(N in ir)ir.hasOwnProperty(N)&&mr(ir[N])},Di=function(){for(var N in re("/XObject <<"),Zr)Zr.hasOwnProperty(N)&&Zr[N].objectNumber>=0&&re("/"+N+" "+Zr[N].objectNumber+" 0 R");Kt.publish("putXobjectDict"),re(">>")},Ts=function(){ea.oid=Qr(),re("<<"),re("/Filter /Standard"),re("/V "+ea.v),re("/R "+ea.r),re("/U <"+ea.toHexString(ea.U)+">"),re("/O <"+ea.toHexString(ea.O)+">"),re("/P "+ea.P),re(">>"),re("endobj")},ss=function(){for(var N in re("/Font <<"),_t)_t.hasOwnProperty(N)&&(d===!1||d===!0&&p.hasOwnProperty(N))&&re("/"+N+" "+_t[N].objectNumber+" 0 R");re(">>")},Mi=function(){if(Object.keys(Nt).length>0){for(var N in re("/Shading <<"),Nt)Nt.hasOwnProperty(N)&&Nt[N]instanceof _l&&Nt[N].objectNumber>=0&&re("/"+N+" "+Nt[N].objectNumber+" 0 R");Kt.publish("putShadingPatternDict"),re(">>")}},os=function(N){if(Object.keys(Nt).length>0){for(var te in re("/Pattern <<"),Nt)Nt.hasOwnProperty(te)&&Nt[te]instanceof h.TilingPattern&&Nt[te].objectNumber>=0&&Nt[te].objectNumber<N&&re("/"+te+" "+Nt[te].objectNumber+" 0 R");Kt.publish("putTilingPatternDict"),re(">>")}},Va=function(){if(Object.keys(ir).length>0){var N;for(N in re("/ExtGState <<"),ir)ir.hasOwnProperty(N)&&ir[N].objectNumber>=0&&re("/"+N+" "+ir[N].objectNumber+" 0 R");Kt.publish("putGStateDict"),re(">>")}},en=function(N){ae(N.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ss(),Mi(),os(N.objectOid),Va(),Di(),re(">>"),re("endobj")},Yd=function(){var N=[];rt(),dn(),dt(),sr(N),Kt.publish("putResources"),N.forEach(en),en({resourcesOid:ue,objectOid:Number.MAX_SAFE_INTEGER}),Kt.publish("postPutResources")},Kd=function(){Kt.publish("putAdditionalObjects");for(var N=0;N<Q.length;N++){var te=Q[N];ae(te.objId,!0),re(te.content),re("endobj")}Kt.publish("postPutAdditionalObjects")},Xd=function(N){xt[N.fontName]=xt[N.fontName]||{},xt[N.fontName][N.fontStyle]=N.id},Fu=function(N,te,ge,Se,Pe){var qe={id:"F"+(Object.keys(_t).length+1).toString(10),postScriptName:N,fontName:te,fontStyle:ge,encoding:Se,isStandardFont:Pe||!1,metadata:{}};return Kt.publish("addFont",{font:qe,instance:this}),_t[qe.id]=qe,Xd(qe),qe.id},Zm=function(N){for(var te=0,ge=ye.length;te<ge;te++){var Se=Fu.call(this,N[te][0],N[te][1],N[te][2],ye[te][3],!0);d===!1&&(p[Se]=!0);var Pe=N[te][0].split("-");Xd({id:Se,fontName:Pe[0],fontStyle:Pe[1]||""})}Kt.publish("addFonts",{fonts:_t,dictionary:xt})},Ri=function(N){return N.foo=function(){try{return N.apply(this,arguments)}catch(Se){var te=Se.stack||"";~te.indexOf(" at ")&&(te=te.split(" at ")[1]);var ge="Error in function "+te.split(`
`)[0].split("<")[0]+": "+Se.message;if(!It.console)throw new Error(ge);It.console.error(ge,Se),It.alert&&alert(ge)}},N.foo.bar=N,N.foo},uc=function(N,te){var ge,Se,Pe,qe,et,ht,At,$t,Ut;if(Pe=(te=te||{}).sourceEncoding||"Unicode",et=te.outputEncoding,(te.autoencode||et)&&_t[it].metadata&&_t[it].metadata[Pe]&&_t[it].metadata[Pe].encoding&&(qe=_t[it].metadata[Pe].encoding,!et&&_t[it].encoding&&(et=_t[it].encoding),!et&&qe.codePages&&(et=qe.codePages[0]),typeof et=="string"&&(et=qe[et]),et)){for(At=!1,ht=[],ge=0,Se=N.length;ge<Se;ge++)($t=et[N.charCodeAt(ge)])?ht.push(String.fromCharCode($t)):ht.push(N[ge]),ht[ge].charCodeAt(0)>>8&&(At=!0);N=ht.join("")}for(ge=N.length;At===void 0&&ge!==0;)N.charCodeAt(ge-1)>>8&&(At=!0),ge--;if(!At)return N;for(ht=te.noBOM?[]:[254,255],ge=0,Se=N.length;ge<Se;ge++){if((Ut=($t=N.charCodeAt(ge))>>8)>>8)throw new Error("Character at position "+ge+" of string '"+N+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ht.push(Ut),ht.push($t-(Ut<<8))}return String.fromCharCode.apply(void 0,ht)},Ia=h.__private__.pdfEscape=h.pdfEscape=function(N,te){return uc(N,te).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Iu=h.__private__.beginPage=function(N){fe[++or]=[],Et[or]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Zd(or),be(fe[I])},Jd=function(N,te){var ge,Se,Pe;switch(r=te||r,typeof N=="string"&&(ge=b(N.toLowerCase()),Array.isArray(ge)&&(Se=ge[0],Pe=ge[1])),Array.isArray(N)&&(Se=N[0]*Ae,Pe=N[1]*Ae),isNaN(Se)&&(Se=a[0],Pe=a[1]),(Se>14400||Pe>14400)&&(wr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Se=Math.min(14400,Se),Pe=Math.min(14400,Pe)),a=[Se,Pe],r.substr(0,1)){case"l":Pe>Se&&(a=[Pe,Se]);break;case"p":Se>Pe&&(a=[Pe,Se])}Iu(a),a0(Ru),re(Bi),Uu!==0&&re(Uu+" J"),zu!==0&&re(zu+" j"),Kt.publish("addPage",{pageNumber:or})},Qm=function(N){N>0&&N<=or&&(fe.splice(N,1),Et.splice(N,1),or--,I>or&&(I=or),this.setPage(I))},Zd=function(N){N>0&&N<=or&&(I=N)},eg=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return fe.length-1},Qd=function(N,te,ge){var Se,Pe=void 0;return ge=ge||{},N=N!==void 0?N:_t[it].fontName,te=te!==void 0?te:_t[it].fontStyle,Se=N.toLowerCase(),xt[Se]!==void 0&&xt[Se][te]!==void 0?Pe=xt[Se][te]:xt[N]!==void 0&&xt[N][te]!==void 0?Pe=xt[N][te]:ge.disableWarning===!1&&wr.warn("Unable to look up font label for font '"+N+"', '"+te+"'. Refer to getFontList() for available fonts."),Pe||ge.noFallback||(Pe=xt.times[te])==null&&(Pe=xt.times.normal),Pe},tg=h.__private__.putInfo=function(){var N=Qr(),te=function(Se){return Se};for(var ge in f!==null&&(te=ea.encryptor(N,0)),re("<<"),re("/Producer ("+Ia(te("jsPDF "+Ot.version))+")"),wt)wt.hasOwnProperty(ge)&&wt[ge]&&re("/"+ge.substr(0,1).toUpperCase()+ge.substr(1)+" ("+Ia(te(wt[ge]))+")");re("/CreationDate ("+Ia(te(Y))+")"),re(">>"),re("endobj")},Lu=h.__private__.putCatalog=function(N){var te=(N=N||{}).rootDictionaryObjId||ce;switch(Qr(),re("<<"),re("/Type /Catalog"),re("/Pages "+te+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ge=""+ze;ge.substr(ge.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&re("/OpenAction [3 0 R /XYZ null null "+W(ze)+"]")}switch(bt||(bt="continuous"),bt){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}Xe&&re("/PageMode /"+Xe),Kt.publish("putCatalog"),re(">>"),re("endobj")},rg=h.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(R+1)),re("/Root "+R+" 0 R"),re("/Info "+(R-1)+" 0 R"),f!==null&&re("/Encrypt "+ea.oid+" 0 R"),re("/ID [ <"+X+"> <"+X+"> ]"),re(">>")},ng=h.__private__.putHeader=function(){re("%PDF-"+m),re("%ºß¬à")},ag=h.__private__.putXRef=function(){var N="0000000000";re("xref"),re("0 "+(R+1)),re("0000000000 65535 f ");for(var te=1;te<=R;te++)typeof G[te]=="function"?re((N+G[te]()).slice(-10)+" 00000 n "):G[te]!==void 0?re((N+G[te]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},Ps=h.__private__.buildDocument=function(){Te(),be(J),Kt.publish("buildDocument"),ng(),Me(),Kd(),Yd(),f!==null&&Ts(),tg(),Lu();var N=q;return ag(),rg(),re("startxref"),re(""+N),re("%%EOF"),be(fe[I]),J.join(`
`)},fc=h.__private__.getBlob=function(N){return new Blob([ve(N)],{type:"application/pdf"})},dc=h.output=h.__private__.output=Ri((function(N,te){switch(typeof(te=te||{})=="string"?te={filename:te}:te.filename=te.filename||"generated.pdf",N){case void 0:return Ps();case"save":h.save(te.filename);break;case"arraybuffer":return ve(Ps());case"blob":return fc(Ps());case"bloburi":case"bloburl":if(It.URL!==void 0&&typeof It.URL.createObjectURL=="function")return It.URL&&It.URL.createObjectURL(fc(Ps()))||void 0;wr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ge="",Se=Ps();try{ge=S2(Se)}catch{ge=S2(unescape(encodeURIComponent(Se)))}return"data:application/pdf;filename="+te.filename+";base64,"+ge;case"pdfobjectnewwindow":if(Object.prototype.toString.call(It)==="[object Window]"){var Pe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",qe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';te.pdfObjectUrl&&(Pe=te.pdfObjectUrl,qe="");var et='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Pe+'"'+qe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(te)+");<\/script></body></html>",ht=It.open();return ht!==null&&ht.document.write(et),ht}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(It)==="[object Window]"){var At='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(te.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+te.filename+'" width="500px" height="400px" /></body></html>',$t=It.open();if($t!==null){$t.document.write(At);var Ut=this;$t.document.documentElement.querySelector("#pdfViewer").onload=function(){$t.document.title=te.filename,$t.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ut.output("bloburl"))}}return $t}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(It)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",te)+'"></iframe></body></html>',Rr=It.open();if(Rr!==null&&(Rr.document.write(Xt),Rr.document.title=te.filename),Rr||typeof safari>"u")return Rr;break;case"datauri":case"dataurl":return It.document.location.href=this.output("datauristring",te);default:return null}})),e0=function(N){return Array.isArray(Li)===!0&&Li.indexOf(N)>-1};switch(n){case"pt":Ae=1;break;case"mm":Ae=72/25.4;break;case"cm":Ae=72/2.54;break;case"in":Ae=72;break;case"px":Ae=e0("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ae=12;break;case"ex":Ae=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ae=n}var ea=null;xe(),K();var ig=function(N){return f!==null?ea.encryptor(N,0):function(te){return te}},t0=h.__private__.getPageInfo=h.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Et[N].objId,pageNumber:N,pageContext:Et[N]}},Bt=h.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var te in Et)if(Et[te].objId===N)break;return t0(te)},sg=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Et[I].objId,pageNumber:I,pageContext:Et[I]}};h.addPage=function(){return Jd.apply(this,arguments),this},h.setPage=function(){return Zd.apply(this,arguments),be.call(this,fe[I]),this},h.insertPage=function(N){return this.addPage(),this.movePage(I,N),this},h.movePage=function(N,te){var ge,Se;if(N>te){ge=fe[N],Se=Et[N];for(var Pe=N;Pe>te;Pe--)fe[Pe]=fe[Pe-1],Et[Pe]=Et[Pe-1];fe[te]=ge,Et[te]=Se,this.setPage(te)}else if(N<te){ge=fe[N],Se=Et[N];for(var qe=N;qe<te;qe++)fe[qe]=fe[qe+1],Et[qe]=Et[qe+1];fe[te]=ge,Et[te]=Se,this.setPage(te)}return this},h.deletePage=function(){return Qm.apply(this,arguments),this},h.__private__.text=h.text=function(N,te,ge,Se,Pe){var qe,et,ht,At,$t,Ut,Xt,Rr,Hr,hn=(Se=Se||{}).scope||this;if(typeof N=="number"&&typeof te=="number"&&(typeof ge=="string"||Array.isArray(ge))){var ta=ge;ge=te,te=N,N=ta}if(arguments[3]instanceof Tt?(C("The transform parameter of text() with a Matrix value"),Hr=Pe):(ht=arguments[4],At=arguments[5],pr(Xt=arguments[3])==="object"&&Xt!==null||(typeof ht=="string"&&(At=ht,ht=null),typeof Xt=="string"&&(At=Xt,Xt=null),typeof Xt=="number"&&(ht=Xt,Xt=null),Se={flags:Xt,angle:ht,align:At})),isNaN(te)||isNaN(ge)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return hn;var Fn="",Ui=!1,Ya=typeof Se.lineHeightFactor=="number"?Se.lineHeightFactor:cl,us=hn.internal.scaleFactor;function u0(_r){return _r=_r.split("	").join(Array(Se.TabLen||9).join(" ")),Ia(_r,Xt)}function Gu(_r){for(var Nr,rn=_r.concat(),Nn=[],Ds=rn.length;Ds--;)typeof(Nr=rn.shift())=="string"?Nn.push(Nr):Array.isArray(_r)&&(Nr.length===1||Nr[1]===void 0&&Nr[2]===void 0)?Nn.push(Nr[0]):Nn.push([Nr[0],Nr[1],Nr[2]]);return Nn}function Vu(_r,Nr){var rn;if(typeof _r=="string")rn=Nr(_r)[0];else if(Array.isArray(_r)){for(var Nn,Ds,tf=_r.concat(),kc=[],m0=tf.length;m0--;)typeof(Nn=tf.shift())=="string"?kc.push(Nr(Nn)[0]):Array.isArray(Nn)&&typeof Nn[0]=="string"&&(Ds=Nr(Nn[0],Nn[1],Nn[2]),kc.push([Ds[0],Ds[1],Ds[2]]));rn=kc}return rn}var vc=!1,Yu=!0;if(typeof N=="string")vc=!0;else if(Array.isArray(N)){var Ku=N.concat();et=[];for(var yc,Gn=Ku.length;Gn--;)(typeof(yc=Ku.shift())!="string"||Array.isArray(yc)&&typeof yc[0]!="string")&&(Yu=!1);vc=Yu}if(vc===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var bc=Ce/hn.internal.scaleFactor,wc=bc*(Ya-1);switch(Se.baseline){case"bottom":ge-=wc;break;case"top":ge+=bc-wc;break;case"hanging":ge+=bc-2*wc;break;case"middle":ge+=bc/2-wc}if((Ut=Se.maxWidth||0)>0&&(typeof N=="string"?N=hn.splitTextToSize(N,Ut):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce((function(_r,Nr){return _r.concat(hn.splitTextToSize(Nr,Ut))}),[]))),qe={text:N,x:te,y:ge,options:Se,mutex:{pdfEscape:Ia,activeFontKey:it,fonts:_t,activeFontSize:Ce}},Kt.publish("preProcessText",qe),N=qe.text,ht=(Se=qe.options).angle,!(Hr instanceof Tt)&&ht&&typeof ht=="number"){ht*=Math.PI/180,Se.rotationDirection===0&&(ht=-ht),_===S.ADVANCED&&(ht=-ht);var Sc=Math.cos(ht),Xu=Math.sin(ht);Hr=new Tt(Sc,Xu,-Xu,Sc,0,0)}else ht&&ht instanceof Tt&&(Hr=ht);_!==S.ADVANCED||Hr||(Hr=Fa),($t=Se.charSpace||mc)!==void 0&&(Fn+=M(j($t))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Rr=Se.horizontalScale)!==void 0&&(Fn+=M(100*Rr)+` Tz
`),Se.lang;var La=-1,gg=Se.renderingMode!==void 0?Se.renderingMode:Se.stroke,Ju=hn.internal.getCurrentPageInfo().pageContext;switch(gg){case 0:case!1:case"fill":La=0;break;case 1:case!0:case"stroke":La=1;break;case 2:case"fillThenStroke":La=2;break;case 3:case"invisible":La=3;break;case 4:case"fillAndAddForClipping":La=4;break;case 5:case"strokeAndAddPathForClipping":La=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":La=6;break;case 7:case"addToPathForClipping":La=7}var f0=Ju.usedRenderingMode!==void 0?Ju.usedRenderingMode:-1;La!==-1?Fn+=La+` Tr
`:f0!==-1&&(Fn+=`0 Tr
`),La!==-1&&(Ju.usedRenderingMode=La),At=Se.align||"left";var fi,_c=Ce*Ya,d0=hn.internal.pageSize.getWidth(),h0=_t[it];$t=Se.charSpace||mc,Ut=Se.maxWidth||0,Xt=Object.assign({autoencode:!0,noBOM:!0},Se.flags);var _o=[],dl=function(_r){return hn.getStringUnitWidth(_r,{font:h0,charSpace:$t,fontSize:Ce,doKerning:!1})*Ce/us};if(Object.prototype.toString.call(N)==="[object Array]"){var Da;et=Gu(N),At!=="left"&&(fi=et.map(dl));var Sa,No=0;if(At==="right"){te-=fi[0],N=[],Gn=et.length;for(var Fs=0;Fs<Gn;Fs++)Fs===0?(Sa=cs(te),Da=Os(ge)):(Sa=j(No-fi[Fs]),Da=-_c),N.push([et[Fs],Sa,Da]),No=fi[Fs]}else if(At==="center"){te-=fi[0]/2,N=[],Gn=et.length;for(var Is=0;Is<Gn;Is++)Is===0?(Sa=cs(te),Da=Os(ge)):(Sa=j((No-fi[Is])/2),Da=-_c),N.push([et[Is],Sa,Da]),No=fi[Is]}else if(At==="left"){N=[],Gn=et.length;for(var Nc=0;Nc<Gn;Nc++)N.push(et[Nc])}else if(At==="justify"&&h0.encoding==="Identity-H"){N=[],Gn=et.length,Ut=Ut!==0?Ut:d0;for(var Ls=0,tn=0;tn<Gn;tn++)if(Da=tn===0?Os(ge):-_c,Sa=tn===0?cs(te):Ls,tn<Gn-1){var Zu=j((Ut-fi[tn])/(et[tn].split(" ").length-1)),_a=et[tn].split(" ");N.push([_a[0]+" ",Sa,Da]),Ls=0;for(var di=1;di<_a.length;di++){var Ac=(dl(_a[di-1]+" "+_a[di])-dl(_a[di]))*us+Zu;di==_a.length-1?N.push([_a[di],Ac,0]):N.push([_a[di]+" ",Ac,0]),Ls-=Ac}}else N.push([et[tn],Sa,Da]);N.push(["",Ls,0])}else{if(At!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],Gn=et.length,Ut=Ut!==0?Ut:d0,tn=0;tn<Gn;tn++)Da=tn===0?Os(ge):-_c,Sa=tn===0?cs(te):0,tn<Gn-1?_o.push(M(j((Ut-fi[tn])/(et[tn].split(" ").length-1)))):_o.push(0),N.push([et[tn],Sa,Da])}}var p0=typeof Se.R2L=="boolean"?Se.R2L:Ue;p0===!0&&(N=Vu(N,(function(_r,Nr,rn){return[_r.split("").reverse().join(""),Nr,rn]}))),qe={text:N,x:te,y:ge,options:Se,mutex:{pdfEscape:Ia,activeFontKey:it,fonts:_t,activeFontSize:Ce}},Kt.publish("postProcessText",qe),N=qe.text,Ui=qe.mutex.isHex||!1;var Qu=_t[it].encoding;Qu!=="WinAnsiEncoding"&&Qu!=="StandardEncoding"||(N=Vu(N,(function(_r,Nr,rn){return[u0(_r),Nr,rn]}))),et=Gu(N),N=[];for(var hl,pl,Ao,ml=0,jc=1,gl=Array.isArray(et[0])?jc:ml,jo="",ef=function(_r,Nr,rn){var Nn="";return rn instanceof Tt?(rn=typeof Se.angle=="number"?Ga(rn,new Tt(1,0,0,1,_r,Nr)):Ga(new Tt(1,0,0,1,_r,Nr),rn),_===S.ADVANCED&&(rn=Ga(new Tt(1,0,0,-1,0,0),rn)),Nn=rn.join(" ")+` Tm
`):Nn=M(_r)+" "+M(Nr)+` Td
`,Nn},hi=0;hi<et.length;hi++){switch(jo="",gl){case jc:Ao=(Ui?"<":"(")+et[hi][0]+(Ui?">":")"),hl=parseFloat(et[hi][1]),pl=parseFloat(et[hi][2]);break;case ml:Ao=(Ui?"<":"(")+et[hi]+(Ui?">":")"),hl=cs(te),pl=Os(ge)}_o!==void 0&&_o[hi]!==void 0&&(jo=_o[hi]+` Tw
`),hi===0?N.push(jo+ef(hl,pl,Hr)+Ao):gl===ml?N.push(jo+Ao):gl===jc&&N.push(jo+ef(hl,pl,Hr)+Ao)}N=gl===ml?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var pi=`BT
/`;return pi+=it+" "+Ce+` Tf
`,pi+=M(Ce*Ya)+` TL
`,pi+=ul+`
`,pi+=Fn,pi+=N,re(pi+="ET"),p[it]=!0,hn};var og=h.__private__.clip=h.clip=function(N){return re(N==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return og("evenodd")},h.__private__.discardPath=h.discardPath=function(){return re("n"),this};var ls=h.__private__.isValidStyle=function(N){var te=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(te=!0),te};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(N){return ls(N)&&(u=N),this};var r0=h.__private__.getStyle=h.getStyle=function(N){var te=u;switch(N){case"D":case"S":te="S";break;case"F":te="f";break;case"FD":case"DF":te="B";break;case"f":case"f*":case"B":case"B*":te=N}return te},n0=h.close=function(){return re("h"),this};h.stroke=function(){return re("S"),this},h.fill=function(N){return hc("f",N),this},h.fillEvenOdd=function(N){return hc("f*",N),this},h.fillStroke=function(N){return hc("B",N),this},h.fillStrokeEvenOdd=function(N){return hc("B*",N),this};var hc=function(N,te){pr(te)==="object"?cg(te,N):re(N)},Du=function(N){N===null||_===S.ADVANCED&&N===void 0||(N=r0(N),re(N))};function lg(N,te,ge,Se,Pe){var qe=new Yc(te||this.boundingBox,ge||this.xStep,Se||this.yStep,this.gState,Pe||this.matrix);qe.stream=this.stream;var et=N+"$$"+this.cloneIndex+++"$$";return Qn(et,qe),qe}var cg=function(N,te){var ge=kr[N.key],Se=Nt[ge];if(Se instanceof _l)re("q"),re(ug(te)),Se.gState&&h.setGState(Se.gState),re(N.matrix.toString()+" cm"),re("/"+ge+" sh"),re("Q");else if(Se instanceof Yc){var Pe=new Tt(1,0,0,-1,0,So());N.matrix&&(Pe=Pe.multiply(N.matrix||Fa),ge=lg.call(Se,N.key,N.boundingBox,N.xStep,N.yStep,Pe).id),re("q"),re("/Pattern cs"),re("/"+ge+" scn"),Se.gState&&h.setGState(Se.gState),re(te),re("Q")}},ug=function(N){switch(N){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Mu=h.moveTo=function(N,te){return re(M(j(N))+" "+M(U(te))+" m"),this},ll=h.lineTo=function(N,te){return re(M(j(N))+" "+M(U(te))+" l"),this},bo=h.curveTo=function(N,te,ge,Se,Pe,qe){return re([M(j(N)),M(U(te)),M(j(ge)),M(U(Se)),M(j(Pe)),M(U(qe)),"c"].join(" ")),this};h.__private__.line=h.line=function(N,te,ge,Se,Pe){if(isNaN(N)||isNaN(te)||isNaN(ge)||isNaN(Se)||!ls(Pe))throw new Error("Invalid arguments passed to jsPDF.line");return _===S.COMPAT?this.lines([[ge-N,Se-te]],N,te,[1,1],Pe||"S"):this.lines([[ge-N,Se-te]],N,te,[1,1]).stroke()},h.__private__.lines=h.lines=function(N,te,ge,Se,Pe,qe){var et,ht,At,$t,Ut,Xt,Rr,Hr,hn,ta,Fn,Ui;if(typeof N=="number"&&(Ui=ge,ge=te,te=N,N=Ui),Se=Se||[1,1],qe=qe||!1,isNaN(te)||isNaN(ge)||!Array.isArray(N)||!Array.isArray(Se)||!ls(Pe)||typeof qe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Mu(te,ge),et=Se[0],ht=Se[1],$t=N.length,ta=te,Fn=ge,At=0;At<$t;At++)(Ut=N[At]).length===2?(ta=Ut[0]*et+ta,Fn=Ut[1]*ht+Fn,ll(ta,Fn)):(Xt=Ut[0]*et+ta,Rr=Ut[1]*ht+Fn,Hr=Ut[2]*et+ta,hn=Ut[3]*ht+Fn,ta=Ut[4]*et+ta,Fn=Ut[5]*ht+Fn,bo(Xt,Rr,Hr,hn,ta,Fn));return qe&&n0(),Du(Pe),this},h.path=function(N){for(var te=0;te<N.length;te++){var ge=N[te],Se=ge.c;switch(ge.op){case"m":Mu(Se[0],Se[1]);break;case"l":ll(Se[0],Se[1]);break;case"c":bo.apply(this,Se);break;case"h":n0()}}return this},h.__private__.rect=h.rect=function(N,te,ge,Se,Pe){if(isNaN(N)||isNaN(te)||isNaN(ge)||isNaN(Se)||!ls(Pe))throw new Error("Invalid arguments passed to jsPDF.rect");return _===S.COMPAT&&(Se=-Se),re([M(j(N)),M(U(te)),M(j(ge)),M(j(Se)),"re"].join(" ")),Du(Pe),this},h.__private__.triangle=h.triangle=function(N,te,ge,Se,Pe,qe,et){if(isNaN(N)||isNaN(te)||isNaN(ge)||isNaN(Se)||isNaN(Pe)||isNaN(qe)||!ls(et))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ge-N,Se-te],[Pe-ge,qe-Se],[N-Pe,te-qe]],N,te,[1,1],et,!0),this},h.__private__.roundedRect=h.roundedRect=function(N,te,ge,Se,Pe,qe,et){if(isNaN(N)||isNaN(te)||isNaN(ge)||isNaN(Se)||isNaN(Pe)||isNaN(qe)||!ls(et))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ht=4/3*(Math.SQRT2-1);return Pe=Math.min(Pe,.5*ge),qe=Math.min(qe,.5*Se),this.lines([[ge-2*Pe,0],[Pe*ht,0,Pe,qe-qe*ht,Pe,qe],[0,Se-2*qe],[0,qe*ht,-Pe*ht,qe,-Pe,qe],[2*Pe-ge,0],[-Pe*ht,0,-Pe,-qe*ht,-Pe,-qe],[0,2*qe-Se],[0,-qe*ht,Pe*ht,-qe,Pe,-qe]],N+Pe,te,[1,1],et,!0),this},h.__private__.ellipse=h.ellipse=function(N,te,ge,Se,Pe){if(isNaN(N)||isNaN(te)||isNaN(ge)||isNaN(Se)||!ls(Pe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var qe=4/3*(Math.SQRT2-1)*ge,et=4/3*(Math.SQRT2-1)*Se;return Mu(N+ge,te),bo(N+ge,te-et,N+qe,te-Se,N,te-Se),bo(N-qe,te-Se,N-ge,te-et,N-ge,te),bo(N-ge,te+et,N-qe,te+Se,N,te+Se),bo(N+qe,te+Se,N+ge,te+et,N+ge,te),Du(Pe),this},h.__private__.circle=h.circle=function(N,te,ge,Se){if(isNaN(N)||isNaN(te)||isNaN(ge)||!ls(Se))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,te,ge,ge,Se)},h.setFont=function(N,te,ge){return ge&&(te=F(te,ge)),it=Qd(N,te,{disableWarning:!1}),this};var fg=h.__private__.getFont=h.getFont=function(){return _t[Qd.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var N,te,ge={};for(N in xt)if(xt.hasOwnProperty(N))for(te in ge[N]=[],xt[N])xt[N].hasOwnProperty(te)&&ge[N].push(te);return ge},h.addFont=function(N,te,ge,Se,Pe){var qe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&qe.indexOf(arguments[3])!==-1?Pe=arguments[3]:arguments[3]&&qe.indexOf(arguments[3])==-1&&(ge=F(ge,Se)),Pe=Pe||"Identity-H",Fu.call(this,N,te,ge,Pe)};var cl,Ru=e.lineWidth||.200025,pc=h.__private__.getLineWidth=h.getLineWidth=function(){return Ru},a0=h.__private__.setLineWidth=h.setLineWidth=function(N){return Ru=N,re(M(j(N))+" w"),this};h.__private__.setLineDash=Ot.API.setLineDash=Ot.API.setLineDashPattern=function(N,te){if(N=N||[],te=te||0,isNaN(te)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map((function(ge){return M(j(ge))})).join(" "),te=M(j(te)),re("["+N+"] "+te+" d"),this};var i0=h.__private__.getLineHeight=h.getLineHeight=function(){return Ce*cl};h.__private__.getLineHeight=h.getLineHeight=function(){return Ce*cl};var s0=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(cl=N),this},o0=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return cl};s0(e.lineHeight);var cs=h.__private__.getHorizontalCoordinate=function(N){return j(N)},Os=h.__private__.getVerticalCoordinate=function(N){return _===S.ADVANCED?N:Et[I].mediaBox.topRightY-Et[I].mediaBox.bottomLeftY-j(N)},dg=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(N){return M(cs(N))},wo=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(N){return M(Os(N))},Bi=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return he(Bi)},h.__private__.setStrokeColor=h.setDrawColor=function(N,te,ge,Se){return Bi=me({ch1:N,ch2:te,ch3:ge,ch4:Se,pdfColorType:"draw",precision:2}),re(Bi),this};var Bu=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return he(Bu)},h.__private__.setFillColor=h.setFillColor=function(N,te,ge,Se){return Bu=me({ch1:N,ch2:te,ch3:ge,ch4:Se,pdfColorType:"fill",precision:2}),re(Bu),this};var ul=e.textColor||"0 g",hg=h.__private__.getTextColor=h.getTextColor=function(){return he(ul)};h.__private__.setTextColor=h.setTextColor=function(N,te,ge,Se){return ul=me({ch1:N,ch2:te,ch3:ge,ch4:Se,pdfColorType:"text",precision:3}),this};var mc=e.charSpace,pg=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(mc||0)};h.__private__.setCharSpace=h.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return mc=N,this};var Uu=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(N){var te=h.CapJoinStyles[N];if(te===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Uu=te,re(te+" J"),this};var zu=0;h.__private__.setLineJoin=h.setLineJoin=function(N){var te=h.CapJoinStyles[N];if(te===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zu=te,re(te+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(M(j(N))+" M"),this},h.GState=Up,h.setGState=function(N){(N=typeof N=="string"?ir[Oa[N]]:l0(null,N)).equals(ba)||(re("/"+N.id+" gs"),ba=N)};var l0=function(N,te){if(!N||!Oa[N]){var ge=!1;for(var Se in ir)if(ir.hasOwnProperty(Se)&&ir[Se].equals(te)){ge=!0;break}if(ge)te=ir[Se];else{var Pe="GS"+(Object.keys(ir).length+1).toString(10);ir[Pe]=te,te.id=Pe}return N&&(Oa[N]=te.id),Kt.publish("addGState",te),te}};h.addGState=function(N,te){return l0(N,te),this},h.saveGraphicsState=function(){return re("q"),fn.push({key:it,size:Ce,color:ul}),this},h.restoreGraphicsState=function(){re("Q");var N=fn.pop();return it=N.key,Ce=N.size,ul=N.color,ba=null,this},h.setCurrentTransformationMatrix=function(N){return re(N.toString()+" cm"),this},h.comment=function(N){return re("#"+N),this};var gc=function(N,te){var ge=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ge},set:function(qe){isNaN(qe)||(ge=parseFloat(qe))}});var Se=te||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Se},set:function(qe){isNaN(qe)||(Se=parseFloat(qe))}});var Pe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Pe},set:function(qe){Pe=qe.toString()}}),this},$u=function(N,te,ge,Se){gc.call(this,N,te),this.type="rect";var Pe=ge||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Pe},set:function(et){isNaN(et)||(Pe=parseFloat(et))}});var qe=Se||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return qe},set:function(et){isNaN(et)||(qe=parseFloat(et))}}),this},Wu=function(){this.page=or,this.currentPage=I,this.pages=fe.slice(0),this.pagesContext=Et.slice(0),this.x=tt,this.y=at,this.matrix=Ct,this.width=fl(I),this.height=So(I),this.outputDestination=Oe,this.id="",this.objectNumber=-1};Wu.prototype.restore=function(){or=this.page,I=this.currentPage,Et=this.pagesContext,fe=this.pages,tt=this.x,at=this.y,Ct=this.matrix,Hu(I,this.width),qu(I,this.height),Oe=this.outputDestination};var c0=function(N,te,ge,Se,Pe){ui.push(new Wu),or=I=0,fe=[],tt=N,at=te,Ct=Pe,Iu([ge,Se])},mg=function(N){if(wa[N])ui.pop().restore();else{var te=new Wu,ge="Xo"+(Object.keys(Zr).length+1).toString(10);te.id=ge,wa[N]=ge,Zr[ge]=te,Kt.publish("addFormObject",te),ui.pop().restore()}};for(var xc in h.beginFormObject=function(N,te,ge,Se,Pe){return c0(N,te,ge,Se,Pe),this},h.endFormObject=function(N){return mg(N),this},h.doFormObject=function(N,te){var ge=Zr[wa[N]];return re("q"),re(te.toString()+" cm"),re("/"+ge.id+" Do"),re("Q"),this},h.getFormObject=function(N){var te=Zr[wa[N]];return{x:te.x,y:te.y,width:te.width,height:te.height,matrix:te.matrix}},h.save=function(N,te){return N=N||"generated.pdf",(te=te||{}).returnPromise=te.returnPromise||!1,te.returnPromise===!1?(wl(fc(Ps()),N),typeof wl.unload=="function"&&It.setTimeout&&setTimeout(wl.unload,911),this):new Promise((function(ge,Se){try{var Pe=wl(fc(Ps()),N);typeof wl.unload=="function"&&It.setTimeout&&setTimeout(wl.unload,911),ge(Pe)}catch(qe){Se(qe.message)}}))},Ot.API)Ot.API.hasOwnProperty(xc)&&(xc==="events"&&Ot.API.events.length?(function(N,te){var ge,Se,Pe;for(Pe=te.length-1;Pe!==-1;Pe--)ge=te[Pe][0],Se=te[Pe][1],N.subscribe.apply(N,[ge].concat(typeof Se=="function"?[Se]:Se))})(Kt,Ot.API.events):h[xc]=Ot.API[xc]);var fl=h.getPageWidth=function(N){return(Et[N=N||I].mediaBox.topRightX-Et[N].mediaBox.bottomLeftX)/Ae},Hu=h.setPageWidth=function(N,te){Et[N].mediaBox.topRightX=te*Ae+Et[N].mediaBox.bottomLeftX},So=h.getPageHeight=function(N){return(Et[N=N||I].mediaBox.topRightY-Et[N].mediaBox.bottomLeftY)/Ae},qu=h.setPageHeight=function(N,te){Et[N].mediaBox.topRightY=te*Ae+Et[N].mediaBox.bottomLeftY};return h.internal={pdfEscape:Ia,getStyle:r0,getFont:fg,getFontSize:$e,getCharSpace:pg,getTextColor:hg,getLineHeight:i0,getLineHeightFactor:o0,getLineWidth:pc,write:we,getHorizontalCoordinate:cs,getVerticalCoordinate:Os,getCoordinateString:dg,getVerticalCoordinateString:wo,collections:{},newObject:Qr,newAdditionalObject:pe,newObjectDeferred:Wr,newObjectDeferredBegin:ae,getFilters:Ie,putStream:We,events:Kt,scaleFactor:Ae,pageSize:{getWidth:function(){return fl(I)},setWidth:function(N){Hu(I,N)},getHeight:function(){return So(I)},setHeight:function(N){qu(I,N)}},encryptionOptions:f,encryption:ea,getEncryptor:ig,output:dc,getNumberOfPages:eg,pages:fe,out:re,f2:W,f3:D,getPageInfo:t0,getPageInfoByObjId:Bt,getCurrentPageInfo:sg,getPDFVersion:g,Point:gc,Rectangle:$u,Matrix:Tt,hasHotfix:e0},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return fl(I)},set:function(N){Hu(I,N)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return So(I)},set:function(N){qu(I,N)},enumerable:!0,configurable:!0}),Zm.call(h,ye),it="F1",Jd(a,r),Kt.publish("initialized"),h}Wc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Wc.prototype.toHexString=function(e){return e.split("").map((function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Wc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Wc.prototype.processOwnerPassword=function(e,t){return N2(_2(t).substr(0,5),e)},Wc.prototype.encryptor=function(e,t){var r=_2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return N2(r,n)}},Up.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||pr(e)!==pr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ot.API={events:[]},Ot.version="2.5.2";var Gr=Ot.API,jw=1,cc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Bc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},zt=function(e){return e.toFixed(2)},Do=function(e){return e.toFixed(5)};Gr.__acroform__={};var qa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},EA=function(e){return e*jw},gs=function(e){var t=new E8,r=vt.internal.getHeight(e)||0,n=vt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(zt(n)),Number(zt(r))],t},Xce=Gr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},Jce=Gr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},Zce=Gr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(e&1<<t)==0?0:1},sn=Gr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Zce(e,t-1)},on=Gr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Xce(e,t-1)},ln=Gr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Jce(e,t-1)},Qce=Gr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(i+o)||0,c.upperRight_X=r(a+s)||0,c.upperRight_Y=n(i)||0,[Number(zt(c.lowerLeft_X)),Number(zt(c.lowerLeft_Y)),Number(zt(c.upperRight_X)),Number(zt(c.upperRight_Y))]},eue=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=A2(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+zt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=gs(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},A2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map((function(D){return D.split(`
`)})):a.map((function(D){return[D]}));var i=r,s=vt.internal.getHeight(e)||0;s=s<0?-s:s;var o=vt.internal.getWidth(e)||0;o=o<0?-o:o;var c=function(D,j,H){if(D+1<a.length){var U=j+" "+a[D+1][0];return mh(U,e,H).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var u,f,d=mh("3",e,i).height,p=e.multiline?s-i:(s-d)/2,h=p+=2,m=0,g=0,x=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+mh(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var b="",S=0,_=0;_<a.length;_++)if(a.hasOwnProperty(_)){var E=!1;if(a[_].length!==1&&x!==a[_].length-1){if((d+2)*(S+2)+2>s)continue e;b+=a[_][x],E=!0,g=_,_--}else{b=(b+=a[_][x]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var O=parseInt(_),F=c(O,b,i),M=_>=a.length-1;if(F&&!M){b+=" ",x=0;continue}if(F||M){if(M)g=O;else if(e.multiline&&(d+2)*(S+2)+2>s)continue e}else{if(!e.multiline||(d+2)*(S+2)+2>s)continue e;g=O}}for(var C="",k=m;k<=g;k++){var W=a[k];if(e.multiline){if(k===g){C+=W[x]+" ",x=(x+1)%W.length;continue}if(k===m){C+=W[W.length-1]+" ";continue}}C+=W[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,f=mh(C,e,i).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;case"left":default:u=2}t+=zt(u)+" "+zt(h)+` Td
`,t+="("+cc(C)+`) Tj
`,t+=-zt(u)+` 0 Td
`,h=-(i+2),f=0,m=E?g:g+1,S++,b=""}break}return n.text=t,n.fontSize=i,n},mh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},tue={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},rue=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find((function(n){return n.type===r.type&&n.object===r.object}))===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},nue=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),pr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},aue=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(as.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(tue)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");jw=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new C8,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)})),e.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&rue(i,r)}})(e)})),e.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)})),e.internal.events.subscribe("postPutPages",(function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],u=o.Rect;if(o.Rect&&(o.Rect=Qce(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=vt.createDefaultAppearanceStream(o),pr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=eue(o);c.push({key:"AP",value:"<</N "+f+">>"}),a.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var m=h[s];typeof m=="function"&&(m=m.call(a,o)),d+="/"+s+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,o)),d+="/"+s+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}i&&nue(a.internal.acroformPlugin.xForms,a)})(r,e)})),e.internal.acroformPlugin.isInitialized=!0}},k8=Gr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),pr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+cc(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},z1=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+cc(n(e))+")"},ws=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ws.prototype.toString=function(){return this.objId+" 0 R"},ws.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ws.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter((function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"}));for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:k8(a,this.objId,this.scope)}):a instanceof ws?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var E8=function(){ws.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};qa(E8,ws);var C8=function(){ws.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+cc(r(e))+")"}},set:function(r){e=r}})};qa(C8,ws);var as=function e(){ws.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!sn(t,3)},set:function(b){b?this.F=on(t,3):this.F=ln(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof zp)return;i="FieldObject"+e.FieldNum++}var b=function(S){return S};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+cc(b(i))+")"},set:function(b){i=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(b){i=b}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(b){s=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/jw:u},set:function(b){u=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof zp||this instanceof Ml))return z1(d,this.objId,this.scope)},set:function(b){b=b.toString(),d=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Un?p:z1(p,this.objId,this.scope)},set:function(b){b=b.toString(),p=this instanceof Un?b:b.substr(0,1)==="("?Bc(b.substr(1,b.length-2)):Bc(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un?Bc(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Un?"/"+b:b}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Un?h:z1(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=this instanceof Un?b:b.substr(0,1)==="("?Bc(b.substr(1,b.length-2)):Bc(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un?Bc(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof Un?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(b){m=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,1)},set:function(b){b?this.Ff=on(this.Ff,1):this.Ff=ln(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,2)},set:function(b){b?this.Ff=on(this.Ff,2):this.Ff=ln(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,3)},set:function(b){b?this.Ff=on(this.Ff,3):this.Ff=ln(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');x=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(x){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};qa(as,ws);var tu=function(){as.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return k8(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=(function(i,s,o){o||(o=1);for(var c,u=[];c=s.exec(i);)u.push(c[o]);return u})(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,18)},set:function(r){r?this.Ff=on(this.Ff,18):this.Ff=ln(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=on(this.Ff,19):this.Ff=ln(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,20)},set:function(r){r?(this.Ff=on(this.Ff,20),t.sort()):this.Ff=ln(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,22)},set:function(r){r?this.Ff=on(this.Ff,22):this.Ff=ln(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,23)},set:function(r){r?this.Ff=on(this.Ff,23):this.Ff=ln(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,27)},set:function(r){r?this.Ff=on(this.Ff,27):this.Ff=ln(this.Ff,27)}}),this.hasAppearanceStream=!1};qa(tu,as);var ru=function(){tu.call(this),this.fontName="helvetica",this.combo=!1};qa(ru,tu);var nu=function(){ru.call(this),this.combo=!0};qa(nu,ru);var jh=function(){nu.call(this),this.edit=!0};qa(jh,nu);var Un=function(){as.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,15)},set:function(r){r?this.Ff=on(this.Ff,15):this.Ff=ln(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,16)},set:function(r){r?this.Ff=on(this.Ff,16):this.Ff=ln(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,17)},set:function(r){r?this.Ff=on(this.Ff,17):this.Ff=ln(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,26)},set:function(r){r?this.Ff=on(this.Ff,26):this.Ff=ln(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+cc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){pr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};qa(Un,as);var kh=function(){Un.call(this),this.pushButton=!0};qa(kh,Un);var au=function(){Un.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};qa(au,Un);var zp=function(){var e,t;as.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+cc(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){pr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};qa(zp,as),au.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},au.prototype.createOption=function(e){var t=new zp;return t.Parent=this,t.optionName=e,this.Kids.push(t),iue.call(this.scope,t),t};var Eh=function(){Un.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vt.CheckBox.createAppearanceStream()};qa(Eh,Un);var Ml=function(){as.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,13)},set:function(t){t?this.Ff=on(this.Ff,13):this.Ff=ln(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,21)},set:function(t){t?this.Ff=on(this.Ff,21):this.Ff=ln(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,23)},set:function(t){t?this.Ff=on(this.Ff,23):this.Ff=ln(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,24)},set:function(t){t?this.Ff=on(this.Ff,24):this.Ff=ln(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,25)},set:function(t){t?this.Ff=on(this.Ff,25):this.Ff=ln(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,26)},set:function(t){t?this.Ff=on(this.Ff,26):this.Ff=ln(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};qa(Ml,as);var Ch=function(){Ml.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!sn(this.Ff,14)},set:function(e){e?this.Ff=on(this.Ff,14):this.Ff=ln(this.Ff,14)}}),this.password=!0};qa(Ch,Ml);var vt={CheckBox:{createAppearanceStream:function(){return{N:{On:vt.CheckBox.YesNormal},D:{On:vt.CheckBox.YesPushDown,Off:vt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=A2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+zt(vt.internal.getWidth(e))+" "+zt(vt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+zt(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=gs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=vt.internal.getHeight(e),s=vt.internal.getWidth(e),o=A2(e,e.caption);return a.push("1 g"),a.push("0 0 "+zt(s)+" "+zt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+zt(s-1)+" "+zt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+zt(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+zt(vt.internal.getWidth(e))+" "+zt(vt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:vt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=vt.RadioButton.Circle.YesNormal,t.D[e]=vt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=gs(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=vt.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Do(vt.internal.getWidth(e)/2)+" "+Do(vt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*vt.internal.Bezier_C).toFixed(5)),s=Number((n*vt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Do(vt.internal.getWidth(e)/2)+" "+Do(vt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Do(vt.internal.getWidth(e)/2)+" "+Do(vt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=[],n=vt.internal.getWidth(e)<=vt.internal.getHeight(e)?vt.internal.getWidth(e)/4:vt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*vt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Do(vt.internal.getWidth(e)/2)+" "+Do(vt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:vt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=vt.RadioButton.Cross.YesNormal,t.D[e]=vt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=gs(e);t.scope=e.scope;var r=[],n=vt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+zt(vt.internal.getWidth(e)-2)+" "+zt(vt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(zt(n.x1.x)+" "+zt(n.x1.y)+" m"),r.push(zt(n.x2.x)+" "+zt(n.x2.y)+" l"),r.push(zt(n.x4.x)+" "+zt(n.x4.y)+" m"),r.push(zt(n.x3.x)+" "+zt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=vt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+zt(vt.internal.getWidth(e))+" "+zt(vt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+zt(vt.internal.getWidth(e)-2)+" "+zt(vt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(zt(r.x1.x)+" "+zt(r.x1.y)+" m"),n.push(zt(r.x2.x)+" "+zt(r.x2.y)+" l"),n.push(zt(r.x4.x)+" "+zt(r.x4.y)+" m"),n.push(zt(r.x3.x)+" "+zt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=gs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+zt(vt.internal.getWidth(e))+" "+zt(vt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};vt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=vt.internal.getWidth(e),r=vt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},vt.internal.getWidth=function(e){var t=0;return pr(e)==="object"&&(t=EA(e.Rect[2])),t},vt.internal.getHeight=function(e){var t=0;return pr(e)==="object"&&(t=EA(e.Rect[3])),t};var iue=Gr.addField=function(e){if(aue(this,e),!(e instanceof as))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Gr.AcroFormChoiceField=tu,Gr.AcroFormListBox=ru,Gr.AcroFormComboBox=nu,Gr.AcroFormEditBox=jh,Gr.AcroFormButton=Un,Gr.AcroFormPushButton=kh,Gr.AcroFormRadioButton=au,Gr.AcroFormCheckBox=Eh,Gr.AcroFormTextField=Ml,Gr.AcroFormPasswordField=Ch,Gr.AcroFormAppearance=vt,Gr.AcroForm={ChoiceField:tu,ListBox:ru,ComboBox:nu,EditBox:jh,Button:Un,PushButton:kh,RadioButton:au,CheckBox:Eh,TextField:Ml,PasswordField:Ch,Appearance:vt},Ot.AcroForm={ChoiceField:tu,ListBox:ru,ComboBox:nu,EditBox:jh,Button:Un,PushButton:kh,RadioButton:au,CheckBox:Eh,TextField:Ml,PasswordField:Ch,Appearance:vt};Ot.AcroForm;function T8(e){return e.reduce((function(t,r,n){return t[r]=n,t}),{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(D,j){var H,U,Y,X,Z,K=t;if((j=j||t)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(F(D))for(Z in r)for(Y=r[Z],H=0;H<Y.length;H+=1){for(X=!0,U=0;U<Y[H].length;U+=1)if(Y[H][U]!==void 0&&Y[H][U]!==D[U]){X=!1;break}if(X===!0){K=Z;break}}else for(Z in r)for(Y=r[Z],H=0;H<Y.length;H+=1){for(X=!0,U=0;U<Y[H].length;U+=1)if(Y[H][U]!==void 0&&Y[H][U]!==D.charCodeAt(U)){X=!1;break}if(X===!0){K=Z;break}}return K===t&&j!==t&&(K=j),K},a=function D(j){for(var H=this.internal.write,U=this.internal.putStream,Y=(0,this.internal.getFilters)();Y.indexOf("FlateEncode")!==-1;)Y.splice(Y.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:j.width}),X.push({key:"Height",value:j.height}),j.colorSpace===x.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===x.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var Z="",K=0,z=j.transparency.length;K<z;K++)Z+=j.transparency[K]+" "+j.transparency[K]+" ";X.push({key:"Mask",value:"["+Z+"]"})}j.sMask!==void 0&&X.push({key:"SMask",value:j.objectId+1+" 0 R"});var se=j.filter!==void 0?["/"+j.filter]:void 0;if(U({data:j.data,additionalKeyValues:X,alreadyAppliedFilters:se,objectId:j.objectId}),H("endobj"),"sMask"in j&&j.sMask!==void 0){var xe="/Predictor "+j.predictor+" /Colors 1 /BitsPerComponent "+j.bitsPerComponent+" /Columns "+j.width,A={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:xe,data:j.sMask};"filter"in j&&(A.filter=j.filter),D.call(this,A)}if(j.colorSpace===x.INDEXED){var I=this.internal.newObject();U({data:C(new Uint8Array(j.palette)),objectId:I}),H("endobj")}},i=function(){var D=this.internal.collections.addImage_images;for(var j in D)a.call(this,D[j])},s=function(){var D,j=this.internal.collections.addImage_images,H=this.internal.write;for(var U in j)H("/I"+(D=j[U]).index,D.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var D=this.internal.collections.addImage_images;return o.call(this),D},u=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(D){return typeof e["process"+D.toUpperCase()]=="function"},d=function(D){return pr(D)==="object"&&D.nodeType===1},p=function(D,j){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var H=""+D.getAttribute("src");if(H.indexOf("data:image/")===0)return Mf(unescape(H).split("base64,").pop());var U=e.loadFile(H,!0);if(U!==void 0)return U}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var Y;switch(j){case"PNG":Y="image/png";break;case"WEBP":Y="image/webp";break;case"JPEG":case"JPG":default:Y="image/jpeg"}return Mf(D.toDataURL(Y,1).split("base64,").pop())}},h=function(D){var j=this.internal.collections.addImage_images;if(j){for(var H in j)if(D===j[H].alias)return j[H]}},m=function(D,j,H){return D||j||(D=-96,j=-96),D<0&&(D=-1*H.width*72/D/this.internal.scaleFactor),j<0&&(j=-1*H.height*72/j/this.internal.scaleFactor),D===0&&(D=j*H.width/H.height),j===0&&(j=D*H.height/H.width),[D,j]},g=function(D,j,H,U,Y,X){var Z=m.call(this,H,U,Y),K=this.internal.getCoordinateString,z=this.internal.getVerticalCoordinateString,se=c.call(this);if(H=Z[0],U=Z[1],se[Y.index]=Y,X){X*=Math.PI/180;var xe=Math.cos(X),A=Math.sin(X),I=function(L){return L.toFixed(4)},P=[I(xe),I(A),I(-1*A),I(xe),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,K(D),z(j+U),"cm"].join(" ")),this.internal.write(P.join(" ")),this.internal.write([K(H),"0","0",K(U),"0","0","cm"].join(" "))):this.internal.write([K(H),"0","0",K(U),K(D),z(j+U),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Y.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(D){var j,H,U=0;if(typeof D=="string")for(H=D.length,j=0;j<H;j++)U=(U<<5)-U+D.charCodeAt(j),U|=0;else if(F(D))for(H=D.byteLength/2,j=0;j<H;j++)U=(U<<5)-U+D[j],U|=0;return U},_=e.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var j=!0;return D.length===0&&(j=!1),D.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(j=!1),j},E=e.__addimage__.extractImageFromDataUrl=function(D){var j=(D=D||"").split("base64,"),H=null;if(j.length===2){var U=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(j[0]);Array.isArray(U)&&(H={mimeType:U[1],charset:U[2],data:j[1]})}return H},O=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(D){return O()&&D instanceof ArrayBuffer};var F=e.__addimage__.isArrayBufferView=function(D){return O()&&typeof Uint32Array<"u"&&(D instanceof Int8Array||D instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array)},M=e.__addimage__.binaryStringToUint8Array=function(D){for(var j=D.length,H=new Uint8Array(j),U=0;U<j;U++)H[U]=D.charCodeAt(U);return H},C=e.__addimage__.arrayBufferToBinaryString=function(D){for(var j="",H=F(D)?D:new Uint8Array(D),U=0;U<H.length;U+=8192)j+=String.fromCharCode.apply(null,H.subarray(U,U+8192));return j};e.addImage=function(){var D,j,H,U,Y,X,Z,K,z;if(typeof arguments[1]=="number"?(j=t,H=arguments[1],U=arguments[2],Y=arguments[3],X=arguments[4],Z=arguments[5],K=arguments[6],z=arguments[7]):(j=arguments[1],H=arguments[2],U=arguments[3],Y=arguments[4],X=arguments[5],Z=arguments[6],K=arguments[7],z=arguments[8]),pr(D=arguments[0])==="object"&&!d(D)&&"imageData"in D){var se=D;D=se.imageData,j=se.format||j||t,H=se.x||H||0,U=se.y||U||0,Y=se.w||se.width||Y,X=se.h||se.height||X,Z=se.alias||Z,K=se.compression||K,z=se.rotation||se.angle||z}var xe=this.internal.getFilters();if(K===void 0&&xe.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(H)||isNaN(U))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var A=k.call(this,D,j,Z,K);return g.call(this,H,U,Y,X,A,z),this};var k=function(D,j,H,U){var Y,X,Z;if(typeof D=="string"&&n(D)===t){D=unescape(D);var K=W(D,!1);(K!==""||(K=e.loadFile(D,!0))!==void 0)&&(D=K)}if(d(D)&&(D=p(D,j)),j=n(D,j),!f(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((Z=H)==null||Z.length===0)&&(H=(function(z){return typeof z=="string"||F(z)?S(z):F(z.data)?S(z.data):null})(D)),(Y=h.call(this,H))||(O()&&(D instanceof Uint8Array||j==="RGBA"||(X=D,D=M(D))),Y=this["process"+j.toUpperCase()](D,u.call(this),H,(function(z){return z&&typeof z=="string"&&(z=z.toUpperCase()),z in e.image_compression?z:b.NONE})(U),X)),!Y)throw new Error("An unknown error occurred whilst processing the image.");return Y},W=e.__addimage__.convertBase64ToBinaryString=function(D,j){var H;j=typeof j!="boolean"||j;var U,Y="";if(typeof D=="string"){U=(H=E(D))!==null?H.data:D;try{Y=Mf(U)}catch(X){if(j)throw _(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};e.getImageProperties=function(D){var j,H,U="";if(d(D)&&(D=p(D)),typeof D=="string"&&n(D)===t&&((U=W(D,!1))===""&&(U=e.loadFile(D)||""),D=U),H=n(D),!f(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(!O()||D instanceof Uint8Array||(D=M(D)),!(j=this["process"+H.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=H,j}})(Ot.API),(function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ot.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,d=0;d<u.length&&!f;d++)switch((n=u[d]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),S=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(b(n.contents))+")",i+=" /Popup "+x.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(b(S))+") >>",g.content=i;var _=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(i+=" /Open true"),i+=" >>",x.content=i,this.internal.write(g.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var F=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(u*f)}else o=c,s=u;return this.text(r,n,a,i),a+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-u,o,s,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(Ot.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length==4},d=e.__arabicParser__.resolveLigatures=function(g){var x=0,b=r,S="",_=0;for(x=0;x<g.length;x+=1)b[g.charCodeAt(x)]!==void 0?(_++,typeof(b=b[g.charCodeAt(x)])=="number"&&(S+=String.fromCharCode(b),b=r,_=0),x===g.length-1&&(b=r,S+=g.charAt(x-(_-1)),x-=_-1,_=0)):(b=r,S+=g.charAt(x-_),x-=_,_=0);return S};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,x,b){return s(g)?i(g)===!1?-1:!u(g)||!s(x)&&!s(b)||!s(b)&&o(x)||o(g)&&!s(x)||o(g)&&c(x)||o(g)&&o(x)?0:f(g)&&s(x)&&!o(x)&&s(b)&&u(b)?3:o(g)||!s(b)?1:2:-1},h=function(g){var x=0,b=0,S=0,_="",E="",O="",F=(g=g||"").split("\\s+"),M=[];for(x=0;x<F.length;x+=1){for(M.push(""),b=0;b<F[x].length;b+=1)_=F[x][b],E=F[x][b-1],O=F[x][b+1],s(_)?(S=p(_,E,O),M[x]+=S!==-1?String.fromCharCode(t[_.charCodeAt(0)][S]):_):M[x]+=_;M[x]=d(M[x])}return M.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(x)){var S=0;for(b=[],S=0;S<x.length;S+=1)Array.isArray(x[S])?b.push([h(x[S][0]),x[S][1],x[S][2]]):b.push([h(x[S])]);g=b}else g=h(x);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])})(Ot.API),Ot.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+t+" 0 R")}))}return this},(function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(Ot.API),(function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),d=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,g=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce((function(_,E){return _.concat(x.splitTextToSize(E,b))}),[])):c=Array.isArray(c)?c:[c];for(var S=0;S<c.length;S++)h<(g=this.getStringUnitWidth(c[S],{font:d})*f)&&(h=g);return h!==0&&(m=c.length),{w:h/=p,h:Math.max((m*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,h&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,f,d,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var h,m,g,x,b=[],S=[],_=[],E={},O={},F=[],M=[],C=(p=p||{}).autoSize||!1,k=p.printHeaders!==!1,W=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,D=p.margins||Object.assign({width:this.getPageWidth()},t),j=typeof p.padding=="number"?p.padding:3,H=p.headerBackgroundColor||"#c8c8c8",U=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=U,this.setFontSize(W),d==null)S=b=Object.keys(f[0]),_=b.map((function(){return"left"}));else if(Array.isArray(d)&&pr(d[0])==="object")for(b=d.map((function(se){return se.name})),S=d.map((function(se){return se.prompt||se.name||""})),_=d.map((function(se){return se.align||"left"})),h=0;h<d.length;h+=1)O[d[h].name]=d[h].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(S=b=d,_=b.map((function(){return"left"})));if(C||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<b.length;h+=1){for(E[x=b[h]]=f.map((function(se){return se[x]})),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(S[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=E[x],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)F.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[x]=Math.max.apply(null,F)+j+j,F=[]}if(k){var Y={};for(h=0;h<b.length;h+=1)Y[b[h]]={},Y[b[h]].text=S[h],Y[b[h]].align=_[h];var X=o.call(this,Y,O);M=b.map((function(se){return new i(c,u,O[se],X,Y[se].text,void 0,Y[se].align)})),this.setTableHeaderRow(M),this.printHeaderRow(1,!1)}var Z=d.reduce((function(se,xe){return se[xe.name]=xe.align,se}),{});for(h=0;h<f.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:f[h]},this);var K=o.call(this,f[h],O);for(g=0;g<b.length;g+=1){var z=f[h][b[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:z},this),s.call(this,new i(c,u,O[b[g]],K,z,h+2,Z[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var o=function(c,u){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map((function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-f-f)}),this).map((function(h){return this.getLineHeightFactor()*h.length*d/p+f+f}),this).reduce((function(h,m){return Math.max(h,m)}),0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){f=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}})(Ot.API);var P8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},O8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],j2=T8(O8),F8=[100,200,300,400,500,600,700,800,900],sue=T8(F8);function k2(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=(function(i){return P8[i=i||"normal"]?i:"normal"})(e.style),n=(function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}})(e.weight),a=(function(i){return typeof j2[i=i||"normal"]=="number"?i:"normal"})(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function CA(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var oue={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},TA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function PA(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function lue(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},oue,r.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=k2(t[o])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+PA(i)+"' and default family '"+n+"'.");if(s=(function(c,u){if(u[c])return u[c];var f=j2[c],d=f<=j2.normal?-1:1,p=CA(u,O8,f,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+c);return p})(i.stretch,s),s=(function(c,u){if(u[c])return u[c];for(var f=P8[c],d=0;d<f.length;++d)if(u[f[d]])return u[f[d]];throw new Error("Could not find a matching font-style for "+c)})(i.style,s),!(s=(function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var f=sue[c],d=CA(u,F8,f,c<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+c);return d})(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+PA(i)+"'.");return s}function OA(e){return e.trimLeft()}function cue(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function uue(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var gh,FA,IA,$1=["times"];(function(e){var t,r,n,a,i,s,o,c,u,f=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new c,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new s,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new s,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new d(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var d=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=A;Object.defineProperty(this,"pdf",{get:function(){return I}});var P=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return P},set:function(be){P=!!be}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(be){L=!!be}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(be){isNaN(be)||(R=be)}});var G=0;Object.defineProperty(this,"posY",{get:function(){return G},set:function(be){isNaN(be)||(G=be)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(be){var re;typeof be=="number"?re=[be,be,be,be]:((re=new Array(4))[0]=be[0],re[1]=be.length>=2?be[1]:re[0],re[2]=be.length>=3?be[2]:re[0],re[3]=be.length>=4?be[3]:re[1]),u.margin=re}});var J=!1;Object.defineProperty(this,"autoPaging",{get:function(){return J},set:function(be){J=be}});var q=0;Object.defineProperty(this,"lastBreak",{get:function(){return q},set:function(be){q=be}});var Q=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Q},set:function(be){Q=be}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(be){be instanceof f&&(u=be)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(be){u.path=be}});var fe=[];Object.defineProperty(this,"ctxStack",{get:function(){return fe},set:function(be){fe=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var re;re=p(be),this.ctx.fillStyle=re.style,this.ctx.isFillTransparent=re.a===0,this.ctx.fillOpacity=re.a,this.pdf.setFillColor(re.r,re.g,re.b,{a:re.a}),this.pdf.setTextColor(re.r,re.g,re.b,{a:re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var re=p(be);this.ctx.strokeStyle=re.style,this.ctx.isStrokeTransparent=re.a===0,this.ctx.strokeOpacity=re.a,re.a===0?this.pdf.setDrawColor(255,255,255):(re.a,this.pdf.setDrawColor(re.r,re.g,re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var V=null;function Oe(be,re){if(V===null){var we=(function(ve){var ye=[];return Object.keys(ve).forEach((function(Ce){ve[Ce].forEach((function(ze){var $e=null;switch(ze){case"bold":$e={family:Ce,weight:"bold"};break;case"italic":$e={family:Ce,style:"italic"};break;case"bolditalic":$e={family:Ce,weight:"bold",style:"italic"};break;case"":case"normal":$e={family:Ce}}$e!==null&&($e.ref={name:Ce,style:ze},ye.push($e))}))})),ye})(be.getFontList());V=(function(ve){for(var ye={},Ce=0;Ce<ve.length;++Ce){var ze=k2(ve[Ce]),$e=ze.family,Ue=ze.stretch,Xe=ze.style,Qe=ze.weight;ye[$e]=ye[$e]||{},ye[$e][Ue]=ye[$e][Ue]||{},ye[$e][Ue][Xe]=ye[$e][Ue][Xe]||{},ye[$e][Ue][Xe][Qe]=ze}return ye})(we.concat(re))}return V}var Te=null;Object.defineProperty(this,"fontFaces",{get:function(){return Te},set:function(be){V=null,Te=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var re;if(this.ctx.font=be,(re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var we=re[1],ve=(re[2],re[3]),ye=re[4],Ce=(re[5],re[6]),ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ye)[2];ye=Math.floor(ze==="px"?parseFloat(ye)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(ye)*this.pdf.getFontSize():parseFloat(ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ye);var $e=(function(wt){var it,Ae,tt=[],at=wt.trim();if(at==="")return $1;if(at in TA)return[TA[at]];for(;at!=="";){switch(Ae=null,it=(at=OA(at)).charAt(0)){case'"':case"'":Ae=cue(at.substring(1),it);break;default:Ae=uue(at)}if(Ae===null||(tt.push(Ae[0]),(at=OA(Ae[1]))!==""&&at.charAt(0)!==","))return $1;at=at.replace(/^,/,"")}return tt})(Ce);if(this.fontFaces){var Ue=lue(Oe(this.pdf,this.fontFaces),$e.map((function(wt){return{family:wt,stretch:"normal",weight:ve,style:we}})));this.pdf.setFont(Ue.ref.name,Ue.ref.style)}else{var Xe="";(ve==="bold"||parseInt(ve,10)>=700||we==="bold")&&(Xe="bold"),we==="italic"&&(Xe+="italic"),Xe.length===0&&(Xe="normal");for(var Qe="",bt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Dt=0;Dt<$e.length;Dt++){if(this.pdf.internal.getFont($e[Dt],Xe,{noFallback:!0,disableWarning:!0})!==void 0){Qe=$e[Dt];break}if(Xe==="bolditalic"&&this.pdf.internal.getFont($e[Dt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Qe=$e[Dt],Xe="bold";else if(this.pdf.internal.getFont($e[Dt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Qe=$e[Dt],Xe="normal";break}}if(Qe===""){for(var kt=0;kt<$e.length;kt++)if(bt[$e[kt]]){Qe=bt[$e[kt]];break}}Qe=Qe===""?"Times":Qe,this.pdf.setFont(Qe,Xe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};d.prototype.setLineDash=function(A){this.lineDash=A},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){E.call(this,"fill",!1)},d.prototype.stroke=function(){E.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(A,I){if(isNaN(A)||isNaN(I))throw wr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var P=this.ctx.transform.applyToPoint(new s(A,I));this.path.push({type:"mt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(A,I)},d.prototype.closePath=function(){var A=new s(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&pr(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){A=new s(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(A.x,A.y)},d.prototype.lineTo=function(A,I){if(isNaN(A)||isNaN(I))throw wr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var P=this.ctx.transform.applyToPoint(new s(A,I));this.path.push({type:"lt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(P.x,P.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},d.prototype.quadraticCurveTo=function(A,I,P,L){if(isNaN(P)||isNaN(L)||isNaN(A)||isNaN(I))throw wr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new s(P,L)),G=this.ctx.transform.applyToPoint(new s(A,I));this.path.push({type:"qct",x1:G.x,y1:G.y,x:R.x,y:R.y}),this.ctx.lastPoint=new s(R.x,R.y)},d.prototype.bezierCurveTo=function(A,I,P,L,R,G){if(isNaN(R)||isNaN(G)||isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L))throw wr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var J=this.ctx.transform.applyToPoint(new s(R,G)),q=this.ctx.transform.applyToPoint(new s(A,I)),Q=this.ctx.transform.applyToPoint(new s(P,L));this.path.push({type:"bct",x1:q.x,y1:q.y,x2:Q.x,y2:Q.y,x:J.x,y:J.y}),this.ctx.lastPoint=new s(J.x,J.y)},d.prototype.arc=function(A,I,P,L,R,G){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L)||isNaN(R))throw wr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(G=!!G,!this.ctx.transform.isIdentity){var J=this.ctx.transform.applyToPoint(new s(A,I));A=J.x,I=J.y;var q=this.ctx.transform.applyToPoint(new s(0,P)),Q=this.ctx.transform.applyToPoint(new s(0,0));P=Math.sqrt(Math.pow(q.x-Q.x,2)+Math.pow(q.y-Q.y,2))}Math.abs(R-L)>=2*Math.PI&&(L=0,R=2*Math.PI),this.path.push({type:"arc",x:A,y:I,radius:P,startAngle:L,endAngle:R,counterclockwise:G})},d.prototype.arcTo=function(A,I,P,L,R){throw new Error("arcTo not implemented.")},d.prototype.rect=function(A,I,P,L){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L))throw wr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,I),this.lineTo(A+P,I),this.lineTo(A+P,I+L),this.lineTo(A,I+L),this.lineTo(A,I),this.lineTo(A+P,I),this.lineTo(A,I)},d.prototype.fillRect=function(A,I,P,L){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L))throw wr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,I,P,L),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},d.prototype.strokeRect=function(A,I,P,L){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L))throw wr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(A,I,P,L),this.stroke())},d.prototype.clearRect=function(A,I,P,L){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L))throw wr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,I,P,L))},d.prototype.save=function(A){A=typeof A!="boolean"||A;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},d.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("Q");this.pdf.setPage(I),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(A){var I,P,L,R;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))I=0,P=0,L=0,R=0;else{var G=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(G!==null)I=parseInt(G[1]),P=parseInt(G[2]),L=parseInt(G[3]),R=1;else if((G=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)I=parseInt(G[1]),P=parseInt(G[2]),L=parseInt(G[3]),R=parseFloat(G[4]);else{if(R=1,typeof A=="string"&&A.charAt(0)!=="#"){var J=new N8(A);A=J.ok?J.toHex():"#000000"}A.length===4?(I=A.substring(1,2),I+=I,P=A.substring(2,3),P+=P,L=A.substring(3,4),L+=L):(I=A.substring(1,3),P=A.substring(3,5),L=A.substring(5,7)),I=parseInt(I,16),P=parseInt(P,16),L=parseInt(L,16)}}return{r:I,g:P,b:L,a:R,style:A}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(A,I,P,L){if(isNaN(I)||isNaN(P)||typeof A!="string")throw wr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!h.call(this)){var R=K(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;j.call(this,{text:A,x:I,y:P,scale:G,angle:R,align:this.textAlign,maxWidth:L})}},d.prototype.strokeText=function(A,I,P,L){if(isNaN(I)||isNaN(P)||typeof A!="string")throw wr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){L=isNaN(L)?void 0:L;var R=K(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;j.call(this,{text:A,x:I,y:P,scale:G,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:L})}},d.prototype.measureText=function(A){if(typeof A!="string")throw wr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,P=this.pdf.internal.scaleFactor,L=I.internal.getFontSize(),R=I.getStringUnitWidth(A)*L/I.internal.scaleFactor,G=function(J){var q=(J=J||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return q}}),this};return new G({width:R*=Math.round(96*P/72*1e4)/1e4})},d.prototype.scale=function(A,I){if(isNaN(A)||isNaN(I))throw wr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var P=new c(A,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(P)},d.prototype.rotate=function(A){if(isNaN(A))throw wr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new c(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},d.prototype.translate=function(A,I){if(isNaN(A)||isNaN(I))throw wr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var P=new c(1,0,0,1,A,I);this.ctx.transform=this.ctx.transform.multiply(P)},d.prototype.transform=function(A,I,P,L,R,G){if(isNaN(A)||isNaN(I)||isNaN(P)||isNaN(L)||isNaN(R)||isNaN(G))throw wr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var J=new c(A,I,P,L,R,G);this.ctx.transform=this.ctx.transform.multiply(J)},d.prototype.setTransform=function(A,I,P,L,R,G){A=isNaN(A)?1:A,I=isNaN(I)?0:I,P=isNaN(P)?0:P,L=isNaN(L)?1:L,R=isNaN(R)?0:R,G=isNaN(G)?0:G,this.ctx.transform=new c(A,I,P,L,R,G)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(A,I,P,L,R,G,J,q,Q){var fe=this.pdf.getImageProperties(A),V=1,Oe=1,Te=1,be=1;L!==void 0&&q!==void 0&&(Te=q/L,be=Q/R,V=fe.width/L*q/L,Oe=fe.height/R*Q/R),G===void 0&&(G=I,J=P,I=0,P=0),L!==void 0&&q===void 0&&(q=L,Q=R),L===void 0&&q===void 0&&(q=fe.width,Q=fe.height);for(var re,we=this.ctx.transform.decompose(),ve=K(we.rotate.shx),ye=new c,Ce=(ye=(ye=(ye=ye.multiply(we.translate)).multiply(we.skew)).multiply(we.scale)).applyToRectangle(new o(G-I*Te,J-P*be,L*V,R*Oe)),ze=x.call(this,Ce),$e=[],Ue=0;Ue<ze.length;Ue+=1)$e.indexOf(ze[Ue])===-1&&$e.push(ze[Ue]);if(_($e),this.autoPaging)for(var Xe=$e[0],Qe=$e[$e.length-1],bt=Xe;bt<Qe+1;bt++){this.pdf.setPage(bt);var Dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],kt=bt===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ae=bt===1?0:wt+(bt-2)*it;if(this.ctx.clip_path.length!==0){var tt=this.path;re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(re,this.posX+this.margin[3],-Ae+kt+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=tt}var at=JSON.parse(JSON.stringify(Ce));at=S([at],this.posX+this.margin[3],-Ae+kt+this.ctx.prevPageLastElemOffset)[0];var Ct=(bt>Xe||bt<Qe)&&g.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dt,it,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",at.x,at.y,at.w,at.h,null,null,ve),Ct&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Ce.x,Ce.y,Ce.w,Ce.h,null,null,ve)};var x=function(A,I,P){var L=[];I=I||this.pdf.internal.pageSize.width,P=P||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":L.push(Math.floor((A.y+R)/P)+1);break;case"arc":L.push(Math.floor((A.y+R-A.radius)/P)+1),L.push(Math.floor((A.y+R+A.radius)/P)+1);break;case"qct":var G=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);L.push(Math.floor((G.y+R)/P)+1),L.push(Math.floor((G.y+G.h+R)/P)+1);break;case"bct":var J=se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);L.push(Math.floor((J.y+R)/P)+1),L.push(Math.floor((J.y+J.h+R)/P)+1);break;case"rect":L.push(Math.floor((A.y+R)/P)+1),L.push(Math.floor((A.y+A.h+R)/P)+1)}for(var q=0;q<L.length;q+=1)for(;this.pdf.internal.getNumberOfPages()<L[q];)b.call(this);return L},b=function(){var A=this.fillStyle,I=this.strokeStyle,P=this.font,L=this.lineCap,R=this.lineWidth,G=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=I,this.font=P,this.lineCap=L,this.lineWidth=R,this.lineJoin=G},S=function(A,I,P){for(var L=0;L<A.length;L++)switch(A[L].type){case"bct":A[L].x2+=I,A[L].y2+=P;case"qct":A[L].x1+=I,A[L].y1+=P;case"mt":case"lt":case"arc":default:A[L].x+=I,A[L].y+=P}return A},_=function(A){return A.sort((function(I,P){return I-P}))},E=function(A,I){for(var P,L,R=this.fillStyle,G=this.strokeStyle,J=this.lineCap,q=this.lineWidth,Q=Math.abs(q*this.ctx.transform.scaleX),fe=this.lineJoin,V=JSON.parse(JSON.stringify(this.path)),Oe=JSON.parse(JSON.stringify(this.path)),Te=[],be=0;be<Oe.length;be++)if(Oe[be].x!==void 0)for(var re=x.call(this,Oe[be]),we=0;we<re.length;we+=1)Te.indexOf(re[we])===-1&&Te.push(re[we]);for(var ve=0;ve<Te.length;ve++)for(;this.pdf.internal.getNumberOfPages()<Te[ve];)b.call(this);if(_(Te),this.autoPaging)for(var ye=Te[0],Ce=Te[Te.length-1],ze=ye;ze<Ce+1;ze++){this.pdf.setPage(ze),this.fillStyle=R,this.strokeStyle=G,this.lineCap=J,this.lineWidth=Q,this.lineJoin=fe;var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ue=ze===1?this.posY+this.margin[0]:this.margin[0],Xe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=ze===1?0:Xe+(ze-2)*Qe;if(this.ctx.clip_path.length!==0){var Dt=this.path;P=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(P,this.posX+this.margin[3],-bt+Ue+this.ctx.prevPageLastElemOffset),O.call(this,A,!0),this.path=Dt}if(L=JSON.parse(JSON.stringify(V)),this.path=S(L,this.posX+this.margin[3],-bt+Ue+this.ctx.prevPageLastElemOffset),I===!1||ze===0){var kt=(ze>ye||ze<Ce)&&g.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Qe,null).clip().discardPath()),O.call(this,A,I),kt&&this.pdf.restoreGraphicsState()}this.lineWidth=q}else this.lineWidth=Q,O.call(this,A,I),this.lineWidth=q;this.path=V},O=function(A,I){if((A!=="stroke"||I||!m.call(this))&&(A==="stroke"||I||!h.call(this))){for(var P,L,R=[],G=this.path,J=0;J<G.length;J++){var q=G[J];switch(q.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:q,deltas:[],abs:[]});break;case"lt":var Q=R.length;if(G[J-1]&&!isNaN(G[J-1].x)&&(P=[q.x-G[J-1].x,q.y-G[J-1].y],Q>0)){for(;Q>=0;Q--)if(R[Q-1].close!==!0&&R[Q-1].begin!==!0){R[Q-1].deltas.push(P),R[Q-1].abs.push(q);break}}break;case"bct":P=[q.x1-G[J-1].x,q.y1-G[J-1].y,q.x2-G[J-1].x,q.y2-G[J-1].y,q.x-G[J-1].x,q.y-G[J-1].y],R[R.length-1].deltas.push(P);break;case"qct":var fe=G[J-1].x+2/3*(q.x1-G[J-1].x),V=G[J-1].y+2/3*(q.y1-G[J-1].y),Oe=q.x+2/3*(q.x1-q.x),Te=q.y+2/3*(q.y1-q.y),be=q.x,re=q.y;P=[fe-G[J-1].x,V-G[J-1].y,Oe-G[J-1].x,Te-G[J-1].y,be-G[J-1].x,re-G[J-1].y],R[R.length-1].deltas.push(P);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push(q)}}L=I?null:A==="stroke"?"stroke":"fill";for(var we=!1,ve=0;ve<R.length;ve++)if(R[ve].arc)for(var ye=R[ve].abs,Ce=0;Ce<ye.length;Ce++){var ze=ye[Ce];ze.type==="arc"?C.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,I,!we):H.call(this,ze.x,ze.y),we=!0}else if(R[ve].close===!0)this.pdf.internal.out("h"),we=!1;else if(R[ve].begin!==!0){var $e=R[ve].start.x,Ue=R[ve].start.y;U.call(this,R[ve].deltas,$e,Ue),we=!0}L&&k.call(this,L),I&&W.call(this)}},F=function(A){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,P=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-P;case"top":return A+I-P;case"hanging":return A+I-2*P;case"middle":return A+I/2-P;case"ideographic":return A;case"alphabetic":default:return A}},M=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(I,P){this.colorStops.push([I,P])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(A,I,P,L,R,G,J,q,Q){for(var fe=X.call(this,P,L,R,G),V=0;V<fe.length;V++){var Oe=fe[V];V===0&&(Q?D.call(this,Oe.x1+A,Oe.y1+I):H.call(this,Oe.x1+A,Oe.y1+I)),Y.call(this,A,I,Oe.x2,Oe.y2,Oe.x3,Oe.y3,Oe.x4,Oe.y4)}q?W.call(this):k.call(this,J)},k=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(A,I){this.pdf.internal.out(r(A)+" "+n(I)+" m")},j=function(A){var I;switch(A.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var P=this.pdf.getTextDimensions(A.text),L=F.call(this,A.y),R=M.call(this,L)-P.h,G=this.ctx.transform.applyToPoint(new s(A.x,L)),J=this.ctx.transform.decompose(),q=new c;q=(q=(q=q.multiply(J.translate)).multiply(J.skew)).multiply(J.scale);for(var Q,fe,V,Oe=this.ctx.transform.applyToRectangle(new o(A.x,L,P.w,P.h)),Te=q.applyToRectangle(new o(A.x,R,P.w,P.h)),be=x.call(this,Te),re=[],we=0;we<be.length;we+=1)re.indexOf(be[we])===-1&&re.push(be[we]);if(_(re),this.autoPaging)for(var ve=re[0],ye=re[re.length-1],Ce=ve;Ce<ye+1;Ce++){this.pdf.setPage(Ce);var ze=Ce===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ue=this.pdf.internal.pageSize.height-this.margin[2],Xe=Ue-this.margin[0],Qe=this.pdf.internal.pageSize.width-this.margin[1],bt=Qe-this.margin[3],Dt=Ce===1?0:$e+(Ce-2)*Xe;if(this.ctx.clip_path.length!==0){var kt=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Q,this.posX+this.margin[3],-1*Dt+ze),O.call(this,"fill",!0),this.path=kt}var wt=S([JSON.parse(JSON.stringify(Te))],this.posX+this.margin[3],-Dt+ze+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fe*A.scale),V=this.lineWidth,this.lineWidth=V*A.scale);var it=this.autoPaging!=="text";if(it||wt.y+wt.h<=Ue){if(it||wt.y>=ze&&wt.x<=Qe){var Ae=it?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||Qe-wt.x)[0],tt=S([JSON.parse(JSON.stringify(Oe))],this.posX+this.margin[3],-Dt+ze+this.ctx.prevPageLastElemOffset)[0],at=it&&(Ce>ve||Ce<ye)&&g.call(this);at&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,Xe,null).clip().discardPath()),this.pdf.text(Ae,tt.x,tt.y,{angle:A.angle,align:I,renderingMode:A.renderingMode}),at&&this.pdf.restoreGraphicsState()}}else wt.y<Ue&&(this.ctx.prevPageLastElemOffset+=Ue-wt.y);A.scale>=.01&&(this.pdf.setFontSize(fe),this.lineWidth=V)}else A.scale>=.01&&(fe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fe*A.scale),V=this.lineWidth,this.lineWidth=V*A.scale),this.pdf.text(A.text,G.x+this.posX,G.y+this.posY,{angle:A.angle,align:I,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(fe),this.lineWidth=V)},H=function(A,I,P,L){P=P||0,L=L||0,this.pdf.internal.out(r(A+P)+" "+n(I+L)+" l")},U=function(A,I,P){return this.pdf.lines(A,I,P,null,null)},Y=function(A,I,P,L,R,G,J,q){this.pdf.internal.out([t(a(P+A)),t(i(L+I)),t(a(R+A)),t(i(G+I)),t(a(J+A)),t(i(q+I)),"c"].join(" "))},X=function(A,I,P,L){for(var R=2*Math.PI,G=Math.PI/2;I>P;)I-=R;var J=Math.abs(P-I);J<R&&L&&(J=R-J);for(var q=[],Q=L?-1:1,fe=I;J>1e-5;){var V=fe+Q*Math.min(J,G);q.push(Z.call(this,A,fe,V)),J-=Math.abs(V-fe),fe=V}return q},Z=function(A,I,P){var L=(P-I)/2,R=A*Math.cos(L),G=A*Math.sin(L),J=R,q=-G,Q=J*J+q*q,fe=Q+J*R+q*G,V=4/3*(Math.sqrt(2*Q*fe)-fe)/(J*G-q*R),Oe=J-V*q,Te=q+V*J,be=Oe,re=-Te,we=L+I,ve=Math.cos(we),ye=Math.sin(we);return{x1:A*Math.cos(I),y1:A*Math.sin(I),x2:Oe*ve-Te*ye,y2:Oe*ye+Te*ve,x3:be*ve-re*ye,y3:be*ye+re*ve,x4:A*Math.cos(P),y4:A*Math.sin(P)}},K=function(A){return 180*A/Math.PI},z=function(A,I,P,L,R,G){var J=A+.5*(P-A),q=I+.5*(L-I),Q=R+.5*(P-R),fe=G+.5*(L-G),V=Math.min(A,R,J,Q),Oe=Math.max(A,R,J,Q),Te=Math.min(I,G,q,fe),be=Math.max(I,G,q,fe);return new o(V,Te,Oe-V,be-Te)},se=function(A,I,P,L,R,G,J,q){var Q,fe,V,Oe,Te,be,re,we,ve,ye,Ce,ze,$e,Ue,Xe=P-A,Qe=L-I,bt=R-P,Dt=G-L,kt=J-R,wt=q-G;for(fe=0;fe<41;fe++)ve=(re=(V=A+(Q=fe/40)*Xe)+Q*((Te=P+Q*bt)-V))+Q*(Te+Q*(R+Q*kt-Te)-re),ye=(we=(Oe=I+Q*Qe)+Q*((be=L+Q*Dt)-Oe))+Q*(be+Q*(G+Q*wt-be)-we),fe==0?(Ce=ve,ze=ye,$e=ve,Ue=ye):(Ce=Math.min(Ce,ve),ze=Math.min(ze,ye),$e=Math.max($e,ve),Ue=Math.max(Ue,ye));return new o(Math.round(Ce),Math.round(ze),Math.round($e-Ce),Math.round(Ue-ze))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,I,P=(A=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:I}));this.prevLineDash!==P&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=P)}}})(Ot.API),(function(e){var t=function(i){var s,o,c,u,f,d,p,h,m,g;for(o=[],c=0,u=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;u>c;c+=4)(f=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(d=(f=((f=((f=((f=(f-(g=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)-(p=f%85))/85)%85,o.push(d+33,p+33,h+33,m+33,g+33)):o.push(122);return(function(x,b){for(var S=b;S>0;S--)x.pop()})(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var s,o,c,u,f,d=String,p="length",h=255,m="charCodeAt",g="slice",x="replace";for(i[g](-2),i=i[g](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],u=0,f=(i+=s="uuuuu"[g](i[p]%5||5))[p];f>u;u+=5)o=52200625*(i[m](u)-33)+614125*(i[m](u+1)-33)+7225*(i[m](u+2)-33)+85*(i[m](u+3)-33)+(i[m](u+4)-33),c.push(h&o>>24,h&o>>16,h&o>>8,h&o);return(function(b,S){for(var _=S;_>0;_--)b.pop()})(c,s[p]),d.fromCharCode.apply(d,c)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",c=0;c<i.length;c+=2)o+=String.fromCharCode("0x"+(i[c]+i[c+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=w2(s)).reduce((function(c,u){return c+String.fromCharCode(u)}),"")};e.processDataByFilters=function(i,s){var o=0,c=i||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map((function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)})).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(Ot.API),(function(e){e.loadFile=function(t,r,n){return(function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(c,u,f){var d=new XMLHttpRequest,p=0,h=function(m){var g=m.length,x=[],b=String.fromCharCode;for(p=0;p<g;p+=1)x.push(b(255&m.charCodeAt(p)));return x.join("")};if(d.open("GET",c,!u),d.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(d.onload=function(){d.status===200?f(h(this.responseText)):f(void 0)}),d.send(null),u&&d.status===200)return h(d.responseText)})(a,i,s)}catch{}return o})(t,r,n)},e.loadImageFile=e.loadFile})(Ot.API),(function(e){function t(){return(It.html2canvas?Promise.resolve(It.html2canvas):g2(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch((function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))})).then((function(s){return s.default?s.default:s}))}function r(){return(It.DOMPurify?Promise.resolve(It.DOMPurify):g2(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(s){return Promise.reject(new Error("Could not load dompurify: "+s))})).then((function(s){return s.default?s.default:s}))}var n=function(s){var o=pr(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var c=document.createElement(s);for(var u in o.className&&(c.className=o.className),o.innerHTML&&o.dompurify&&(c.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)c.style[u]=o.style[u];return c},i=function s(o){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then((function(){switch(o=o||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(s)){case"string":return this.then(r).then((function(c){return this.set({src:a("div",{innerHTML:s,dompurify:c})})}));case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}}))},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function c(u,f){for(var d=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),p=u.firstChild;p;p=p.nextSibling)f!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(c(p,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(d.width=u.width,d.height=u.height,d.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(d.value=u.value),d.addEventListener("load",(function(){d.scrollTop=u.scrollTop,d.scrollLeft=u.scrollLeft}),!0)),d})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then((function(o){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,o(this.prop.container,c)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then((function(o){var c=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var p=0;p<u.length;++p){var h=u[p],m=h.src.find((function(g){return g.format==="truetype"}));m&&c.addFont(m.url,h.ref.name,h.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,c.context2d.save(!0),o(this.prop.container,d)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s}))},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},i.prototype.output=function(s,o,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(s,o)}))},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}}))},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map((function(c){if(c in i.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}}),this);return this.then((function(){return this.thenList(o)}))},i.prototype.get=function(s,o){return this.then((function(){var c=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(c):c}))},i.prototype.setMargin=function(s){return this.then((function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s})).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(c,u){return Math.floor(c*u/72*96)}return this.then((function(){(s=s||Ot.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s}))},i.prototype.setProgress=function(s,o,c,u){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,c,u){return this.setProgress(s?this.progress.val+s:null,o||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(s,o){var c=this;return this.thenCore(s,o,(function(u,f){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,(function(d){return c.updateProgress(null,u),d})).then(u,f).then((function(d){return c.updateProgress(1),d}))}))},i.prototype.thenCore=function(s,o,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),f=c.call(u,s,o);return i.convert(f,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach((function(c){o=o.thenCore(c)})),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then((function(){throw new Error(s)}))},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Ot.getPageSize=function(s,o,c){if(pr(s)==="object"){var u=s;s=u.orientation,o=u.unit||o,c=u.format||c}o=o||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var f,d=(""+c).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+o}var h,m=0,g=0;if(p.hasOwnProperty(d))m=p[d][1]/f,g=p[d][0]/f;else try{m=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",g>m&&(h=g,g=m,m=h);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",m>g&&(h=g,g=m,m=h)}return{width:g,height:m,unit:o,k:f,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(k2):null;var c=new i(o);return o.worker?c:c.from(s).doCallback()}})(Ot.API),Ot.API.addJS=function(e){return IA=e,this.internal.events.subscribe("postPutResources",(function(){gh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(gh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),FA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+IA+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){gh!==void 0&&FA!==void 0&&this.internal.out("/Names <</JavaScript "+gh+" 0 R>>")})),this},(function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(i=0;i<u;i++){var d=r.internal.newObject();f.push(d);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<f.length;i++)r.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])})(Ot.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var c,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=(function(d){for(var p,h=256*d.charCodeAt(4)+d.charCodeAt(5),m=d.length,g={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,t.indexOf(d.charCodeAt(x+1))!==-1){p=256*d.charCodeAt(x+5)+d.charCodeAt(x+6),g={width:256*d.charCodeAt(x+7)+d.charCodeAt(x+8),height:p,numcomponents:d.charCodeAt(x+9)};break}h=256*d.charCodeAt(x+2)+d.charCodeAt(x+3)}return g})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:a}}return f}})(Ot.API);var Uc,xh,LA,DA,MA,fue=(function(){var e,t,r;function n(i){var s,o,c,u,f,d,p,h,m,g,x,b,S,_;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(s=this.readUInt32(),m=(function(){var E,O;for(O=[],E=0;E<4;++E)O.push(String.fromCharCode(this.data[this.pos++]));return O}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),u=this.readUInt16()||100,d.delay=1e3*f/u,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(m==="fdAT"&&(this.pos+=4,s-=4),i=(d!=null?d.data:void 0)||this.imgData,b=0;0<=s?b<s:b>s;0<=s?++b:--b)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((g=c-this.transparency.indexed.length)>0)for(S=0;0<=g?S<g:S>g;0<=g?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(x=this.read(s)).indexOf(0),h=String.fromCharCode.apply(String,x.slice(0,p)),this.text[h]=String.fromCharCode.apply(String,x.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),c=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function f(d,p,h,m){var g,x,b,S,_,E,O,F,M,C,k,W,D,j,H,U,Y,X,Z,K,z,se=Math.ceil((u.width-d)/h),xe=Math.ceil((u.height-p)/m),A=u.width==se&&u.height==xe;for(j=s*se,W=A?o:new Uint8Array(j*xe),E=i.length,D=0,x=0;D<xe&&c<E;){switch(i[c++]){case 0:for(S=Y=0;Y<j;S=Y+=1)W[x++]=i[c++];break;case 1:for(S=X=0;X<j;S=X+=1)g=i[c++],_=S<s?0:W[x-s],W[x++]=(g+_)%256;break;case 2:for(S=Z=0;Z<j;S=Z+=1)g=i[c++],b=(S-S%s)/s,H=D&&W[(D-1)*j+b*s+S%s],W[x++]=(H+g)%256;break;case 3:for(S=K=0;K<j;S=K+=1)g=i[c++],b=(S-S%s)/s,_=S<s?0:W[x-s],H=D&&W[(D-1)*j+b*s+S%s],W[x++]=(g+Math.floor((_+H)/2))%256;break;case 4:for(S=z=0;z<j;S=z+=1)g=i[c++],b=(S-S%s)/s,_=S<s?0:W[x-s],D===0?H=U=0:(H=W[(D-1)*j+b*s+S%s],U=b&&W[(D-1)*j+(b-1)*s+S%s]),O=_+H-U,F=Math.abs(O-_),C=Math.abs(O-H),k=Math.abs(O-U),M=F<=C&&F<=k?_:C<=k?H:U,W[x++]=(g+M)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!A){var I=((p+D*m)*u.width+d)*s,P=D*j;for(S=0;S<se;S+=1){for(var L=0;L<s;L+=1)o[I++]=W[P++];I+=(h-1)*s}}D++}}return i=Wce(i),u.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,c,u,f,d,p,h;for(o=this.palette,f=this.transparency.indexed||[],u=new Uint8Array((f.length||0)+o.length),c=0,i=0,s=d=0,p=o.length;d<p;s=d+=3)u[c++]=o[s],u[c++]=o[s+1],u[c++]=o[s+2],u[c++]=(h=f[i++])!=null?h:255;return u},n.prototype.copyToImageData=function(i,s){var o,c,u,f,d,p,h,m,g,x,b;if(c=this.colors,g=null,o=this.hasAlphaChannel,this.palette.length&&(g=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),c=4,o=!0),m=(u=i.data||i).length,d=g||s,f=p=0,c===1)for(;f<m;)h=g?4*s[f/4]:p,x=d[h++],u[f++]=x,u[f++]=x,u[f++]=x,u[f++]=o?d[h++]:255,p=h;else for(;f<m;)h=g?4*s[f/4]:p,u[f++]=d[h++],u[f++]=d[h++],u[f++]=d[h++],u[f++]=o?d[h++]:255,p=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(It)==="[object Window]"){try{t=It.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var s;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,c,u,f,d,p,h;if(this.animation){for(h=[],o=f=0,d=(p=this.animation.frames).length;f<d;o=++f)s=p[o],c=i.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,h.push(s.image=e(c));return h}},n.prototype.renderFrame=function(i,s){var o,c,u;return o=(c=this.animation.frames)[s],u=c[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,c,u,f,d,p=this;return o=0,d=this.animation,u=d.numFrames,c=d.frames,f=d.numPlays,(s=function(){var h,m;if(h=o++%u,m=c[h],p.renderFrame(i,h),u>1&&o/u<f)return p.animation._timeout=setTimeout(s,m.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function due(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var o=null,c=null;i&&(o=t,c=s,t+=3*s);var u=!0,f=[],d=0,p=null,h=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];d=e[t++]|e[t++]<<8,p=e[t++],(1&g)==0&&(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,E=e[t++],O=E>>6&1,F=1<<(7&E)+1,M=o,C=c,k=!1;E>>7&&(k=!0,M=t,C=F,t+=3*F);var W=t;for(t++;;){var D;if(!((D=e[t++])>=0))throw Error("Invalid block size");if(D===0)break;t+=D}f.push({x,y:b,width:S,height:_,has_local_palette:k,palette_offset:M,palette_size:C,data_offset:W,data_length:t-W,transparent_index:p,interlaced:!!O,delay:d,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return m},this.frameInfo=function(j){if(j<0||j>=f.length)throw new Error("Frame index out of range.");return f[j]},this.decodeAndBlitFrameBGRA=function(j,H){var U=this.frameInfo(j),Y=U.width*U.height,X=new Uint8Array(Y);RA(e,U.data_offset,X,Y);var Z=U.palette_offset,K=U.transparent_index;K===null&&(K=256);var z=U.width,se=r-z,xe=z,A=4*(U.y*r+U.x),I=4*((U.y+U.height)*r+U.x),P=A,L=4*se;U.interlaced===!0&&(L+=4*r*7);for(var R=8,G=0,J=X.length;G<J;++G){var q=X[G];if(xe===0&&(xe=z,(P+=L)>=I&&(L=4*se+4*r*(R-1),P=A+(z+se)*(R<<1),R>>=1)),q===K)P+=4;else{var Q=e[Z+3*q],fe=e[Z+3*q+1],V=e[Z+3*q+2];H[P++]=V,H[P++]=fe,H[P++]=Q,H[P++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(j,H){var U=this.frameInfo(j),Y=U.width*U.height,X=new Uint8Array(Y);RA(e,U.data_offset,X,Y);var Z=U.palette_offset,K=U.transparent_index;K===null&&(K=256);var z=U.width,se=r-z,xe=z,A=4*(U.y*r+U.x),I=4*((U.y+U.height)*r+U.x),P=A,L=4*se;U.interlaced===!0&&(L+=4*r*7);for(var R=8,G=0,J=X.length;G<J;++G){var q=X[G];if(xe===0&&(xe=z,(P+=L)>=I&&(L=4*se+4*r*(R-1),P=A+(z+se)*(R<<1),R>>=1)),q===K)P+=4;else{var Q=e[Z+3*q],fe=e[Z+3*q+1],V=e[Z+3*q+2];H[P++]=Q,H[P++]=fe,H[P++]=V,H[P++]=255}--xe}}}function RA(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,c=a+1,u=(1<<c)-1,f=0,d=0,p=0,h=e[t++],m=new Int32Array(4096),g=null;;){for(;f<16&&h!==0;)d|=e[t++]<<f,f+=8,h===1?h=e[t++]:--h;if(f<c)break;var x=d&u;if(d>>=c,f-=c,x!==i){if(x===s)break;for(var b=x<o?x:g,S=0,_=b;_>i;)_=m[_]>>8,++S;var E=_;if(p+S+(b!==x?1:0)>n)return void wr.log("Warning, gif stream longer than expected.");r[p++]=E;var O=p+=S;for(b!==x&&(r[p++]=E),_=b;S--;)_=m[_],r[--O]=255&_,_>>=8;g!==null&&o<4096&&(m[o++]=g<<8|E,o>=u+1&&c<12&&(++c,u=u<<1|1)),g=x}else o=s+1,u=(1<<(c=a+1))-1,g=null}return p!==n&&wr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function W1(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),d=new Array(65535),p=new Array(65535),h=new Array(64),m=new Array(64),g=[],x=0,b=7,S=new Array(64),_=new Array(64),E=new Array(64),O=new Array(256),F=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(A,I){for(var P=0,L=0,R=new Array,G=1;G<=16;G++){for(var J=1;J<=A[G];J++)R[I[L]]=[],R[I[L]][0]=P,R[I[L]][1]=G,L++,P++;P*=2}return R}function Z(A){for(var I=A[0],P=A[1]-1;P>=0;)I&1<<P&&(x|=1<<b),P--,--b<0&&(x==255?(K(255),K(0)):K(x),b=7,x=0)}function K(A){g.push(A)}function z(A){K(A>>8&255),K(255&A)}function se(A,I,P,L,R){for(var G,J=R[0],q=R[240],Q=(function(ye,Ce){var ze,$e,Ue,Xe,Qe,bt,Dt,kt,wt,it,Ae=0;for(wt=0;wt<8;++wt){ze=ye[Ae],$e=ye[Ae+1],Ue=ye[Ae+2],Xe=ye[Ae+3],Qe=ye[Ae+4],bt=ye[Ae+5],Dt=ye[Ae+6];var tt=ze+(kt=ye[Ae+7]),at=ze-kt,Ct=$e+Dt,_t=$e-Dt,xt=Ue+bt,fn=Ue-bt,Nt=Xe+Qe,kr=Xe-Qe,ir=tt+Nt,Oa=tt-Nt,ba=Ct+xt,or=Ct-xt;ye[Ae]=ir+ba,ye[Ae+4]=ir-ba;var Et=.707106781*(or+Oa);ye[Ae+2]=Oa+Et,ye[Ae+6]=Oa-Et;var Kt=.382683433*((ir=kr+fn)-(or=_t+at)),Li=.5411961*ir+Kt,Zr=1.306562965*or+Kt,wa=.707106781*(ba=fn+_t),ui=at+wa,Tt=at-wa;ye[Ae+5]=Tt+Li,ye[Ae+3]=Tt-Li,ye[Ae+1]=ui+Zr,ye[Ae+7]=ui-Zr,Ae+=8}for(Ae=0,wt=0;wt<8;++wt){ze=ye[Ae],$e=ye[Ae+8],Ue=ye[Ae+16],Xe=ye[Ae+24],Qe=ye[Ae+32],bt=ye[Ae+40],Dt=ye[Ae+48];var Ga=ze+(kt=ye[Ae+56]),Fa=ze-kt,Qn=$e+Dt,Qr=$e-Dt,Wr=Ue+bt,ae=Ue-bt,pe=Xe+Qe,ce=Xe-Qe,ue=Ga+pe,he=Ga-pe,me=Qn+Wr,Ie=Qn-Wr;ye[Ae]=ue+me,ye[Ae+32]=ue-me;var We=.707106781*(Ie+he);ye[Ae+16]=he+We,ye[Ae+48]=he-We;var Fe=.382683433*((ue=ce+ae)-(Ie=Qr+Fa)),Me=.5411961*ue+Fe,Be=1.306562965*Ie+Fe,rt=.707106781*(me=ae+Qr),st=Fa+rt,dt=Fa-rt;ye[Ae+40]=dt+Me,ye[Ae+24]=dt-Me,ye[Ae+8]=st+Be,ye[Ae+56]=st-Be,Ae++}for(wt=0;wt<64;++wt)it=ye[wt]*Ce[wt],h[wt]=it>0?it+.5|0:it-.5|0;return h})(A,I),fe=0;fe<64;++fe)m[M[fe]]=Q[fe];var V=m[0]-P;P=m[0],V==0?Z(L[0]):(Z(L[p[G=32767+V]]),Z(d[G]));for(var Oe=63;Oe>0&&m[Oe]==0;)Oe--;if(Oe==0)return Z(J),P;for(var Te,be=1;be<=Oe;){for(var re=be;m[be]==0&&be<=Oe;)++be;var we=be-re;if(we>=16){Te=we>>4;for(var ve=1;ve<=Te;++ve)Z(q);we&=15}G=32767+m[be],Z(R[(we<<4)+p[G]]),Z(d[G]),be++}return Oe!=63&&Z(J),P}function xe(A){A=Math.min(Math.max(A,1),100),i!=A&&((function(I){for(var P=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var R=s((P[L]*I+50)/100);R=Math.min(Math.max(R,1),255),o[M[L]]=R}for(var G=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],J=0;J<64;J++){var q=s((G[J]*I+50)/100);q=Math.min(Math.max(q,1),255),c[M[J]]=q}for(var Q=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],fe=0,V=0;V<8;V++)for(var Oe=0;Oe<8;Oe++)u[fe]=1/(o[M[fe]]*Q[V]*Q[Oe]*8),f[fe]=1/(c[M[fe]]*Q[V]*Q[Oe]*8),fe++})(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),i=A)}this.encode=function(A,I){I&&xe(I),g=new Array,x=0,b=7,z(65496),z(65504),z(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),z(1),z(1),K(0),K(0),(function(){z(65499),z(132),K(0);for(var $e=0;$e<64;$e++)K(o[$e]);K(1);for(var Ue=0;Ue<64;Ue++)K(c[Ue])})(),(function($e,Ue){z(65472),z(17),K(8),z(Ue),z($e),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)})(A.width,A.height),(function(){z(65476),z(418),K(0);for(var $e=0;$e<16;$e++)K(C[$e+1]);for(var Ue=0;Ue<=11;Ue++)K(k[Ue]);K(16);for(var Xe=0;Xe<16;Xe++)K(W[Xe+1]);for(var Qe=0;Qe<=161;Qe++)K(D[Qe]);K(1);for(var bt=0;bt<16;bt++)K(j[bt+1]);for(var Dt=0;Dt<=11;Dt++)K(H[Dt]);K(17);for(var kt=0;kt<16;kt++)K(U[kt+1]);for(var wt=0;wt<=161;wt++)K(Y[wt])})(),z(65498),z(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var P=0,L=0,R=0;x=0,b=7,this.encode.displayName="_encode_";for(var G,J,q,Q,fe,V,Oe,Te,be,re=A.data,we=A.width,ve=A.height,ye=4*we,Ce=0;Ce<ve;){for(G=0;G<ye;){for(fe=ye*Ce+G,Oe=-1,Te=0,be=0;be<64;be++)V=fe+(Te=be>>3)*ye+(Oe=4*(7&be)),Ce+Te>=ve&&(V-=ye*(Ce+1+Te-ve)),G+Oe>=ye&&(V-=G+Oe-ye+4),J=re[V++],q=re[V++],Q=re[V++],S[be]=(F[J]+F[q+256>>0]+F[Q+512>>0]>>16)-128,_[be]=(F[J+768>>0]+F[q+1024>>0]+F[Q+1280>>0]>>16)-128,E[be]=(F[J+1280>>0]+F[q+1536>>0]+F[Q+1792>>0]>>16)-128;P=se(S,u,P,t,n),L=se(_,f,L,r,a),R=se(E,f,R,r,a),G+=32}Ce+=8}if(b>=0){var ze=[];ze[1]=b+1,ze[0]=(1<<b+1)-1,Z(ze)}return z(65497),new Uint8Array(g)},e=e||50,(function(){for(var A=String.fromCharCode,I=0;I<256;I++)O[I]=A(I)})(),t=X(C,k),r=X(j,H),n=X(W,D),a=X(U,Y),(function(){for(var A=1,I=2,P=1;P<=15;P++){for(var L=A;L<I;L++)p[32767+L]=P,d[32767+L]=[],d[32767+L][1]=P,d[32767+L][0]=L;for(var R=-(I-1);R<=-A;R++)p[32767+R]=P,d[32767+R]=[],d[32767+R][1]=P,d[32767+R][0]=I-1+R;A<<=1,I<<=1}})(),(function(){for(var A=0;A<256;A++)F[A]=19595*A,F[A+256>>0]=38470*A,F[A+512>>0]=7471*A+32768,F[A+768>>0]=-11059*A,F[A+1024>>0]=-21709*A,F[A+1280>>0]=32768*A+8421375,F[A+1536>>0]=-27439*A,F[A+1792>>0]=-5329*A})(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function qi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function BA(e){function t(C){if(!C)throw Error("assert :P")}function r(C,k,W){for(var D=0;4>D;D++)if(C[k+D]!=W.charCodeAt(D))return!0;return!1}function n(C,k,W,D,j){for(var H=0;H<j;H++)C[k+H]=W[D+H]}function a(C,k,W,D){for(var j=0;j<D;j++)C[k+j]=W}function i(C){return new Int32Array(C)}function s(C,k){for(var W=[],D=0;D<C;D++)W.push(new k);return W}function o(C,k){var W=[];return(function D(j,H,U){for(var Y=U[H],X=0;X<Y&&(j.push(U.length>H+1?[]:new k),!(U.length<H+1));X++)D(j[X],H+1,U)})(W,0,C),W}var c=function(){var C=this;function k(v,w){for(var T=1<<w-1>>>0;v&T;)T>>>=1;return T?(v&T-1)+T:v}function W(v,w,T,B,ee){t(!(B%T));do v[w+(B-=T)]=ee;while(0<B)}function D(v,w,T,B,ee){if(t(2328>=ee),512>=ee)var ne=i(512);else if((ne=i(ee))==null)return 0;return(function(ie,oe,le,de,_e,Le){var De,ke,Ke=oe,He=1<<le,Ne=i(16),je=i(16);for(t(_e!=0),t(de!=null),t(ie!=null),t(0<le),ke=0;ke<_e;++ke){if(15<de[ke])return 0;++Ne[de[ke]]}if(Ne[0]==_e)return 0;for(je[1]=0,De=1;15>De;++De){if(Ne[De]>1<<De)return 0;je[De+1]=je[De]+Ne[De]}for(ke=0;ke<_e;++ke)De=de[ke],0<de[ke]&&(Le[je[De]++]=ke);if(je[15]==1)return(de=new j).g=0,de.value=Le[0],W(ie,Ke,1,He,de),He;var Ve,Ze=-1,Ye=He-1,pt=0,ct=1,Pt=1,ut=1<<le;for(ke=0,De=1,_e=2;De<=le;++De,_e<<=1){if(ct+=Pt<<=1,0>(Pt-=Ne[De]))return 0;for(;0<Ne[De];--Ne[De])(de=new j).g=De,de.value=Le[ke++],W(ie,Ke+pt,_e,ut,de),pt=k(pt,De)}for(De=le+1,_e=2;15>=De;++De,_e<<=1){if(ct+=Pt<<=1,0>(Pt-=Ne[De]))return 0;for(;0<Ne[De];--Ne[De]){if(de=new j,(pt&Ye)!=Ze){for(Ke+=ut,Ve=1<<(Ze=De)-le;15>Ze&&!(0>=(Ve-=Ne[Ze]));)++Ze,Ve<<=1;He+=ut=1<<(Ve=Ze-le),ie[oe+(Ze=pt&Ye)].g=Ve+le,ie[oe+Ze].value=Ke-oe-Ze}de.g=De-le,de.value=Le[ke++],W(ie,Ke+(pt>>le),_e,ut,de),pt=k(pt,De)}}return ct!=2*je[15]-1?0:He})(v,w,T,B,ee,ne)}function j(){this.value=this.g=0}function H(){this.value=this.g=0}function U(){this.G=s(5,j),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Gn,H)}function Y(v,w,T,B){t(v!=null),t(w!=null),t(2147483648>B),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=w,v.pa=T,v.Jd=w,v.Yc=T+B,v.Zc=4<=B?T+B-4+1:T,G(v)}function X(v,w){for(var T=0;0<w--;)T|=q(v,128)<<w;return T}function Z(v,w){var T=X(v,w);return J(v)?-T:T}function K(v,w,T,B){var ee,ne=0;for(t(v!=null),t(w!=null),t(4294967288>B),v.Sb=B,v.Ra=0,v.u=0,v.h=0,4<B&&(B=4),ee=0;ee<B;++ee)ne+=w[T+ee]<<8*ee;v.Ra=ne,v.bb=B,v.oa=w,v.pa=T}function z(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Sc-8>>>0,++v.bb,v.u-=8;P(v)&&(v.h=1,v.u=0)}function se(v,w){if(t(0<=w),!v.h&&w<=wc){var T=I(v)&bc[w];return v.u+=w,z(v),T}return v.h=1,v.u=0}function xe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(v){return v.Ra>>>(v.u&Sc-1)>>>0}function P(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Sc}function L(v,w){v.u=w,v.h=P(v)}function R(v){v.u>=Xu&&(t(v.u>=Xu),z(v))}function G(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function J(v){return X(v,1)}function q(v,w){var T=v.Ca;0>v.b&&G(v);var B=v.b,ee=T*w>>>8,ne=(v.I>>>B>ee)+0;for(ne?(T-=ee,v.I-=ee+1<<B>>>0):T=ee+1,B=T,ee=0;256<=B;)ee+=8,B>>=8;return B=7^ee+La[B],v.b-=B,v.Ca=(T<<B)-1,ne}function Q(v,w,T){v[w+0]=T>>24&255,v[w+1]=T>>16&255,v[w+2]=T>>8&255,v[w+3]=T>>0&255}function fe(v,w){return v[w+0]<<0|v[w+1]<<8}function V(v,w){return fe(v,w)|v[w+2]<<16}function Oe(v,w){return fe(v,w)|fe(v,w+2)<<16}function Te(v,w){var T=1<<w;return t(v!=null),t(0<w),v.X=i(T),v.X==null?0:(v.Mb=32-w,v.Xa=w,1)}function be(v,w){t(v!=null),t(w!=null),t(v.Xa==w.Xa),n(w.X,0,v.X,0,1<<w.Xa)}function re(){this.X=[],this.Xa=this.Mb=0}function we(v,w,T,B){t(T!=null),t(B!=null);var ee=T[0],ne=B[0];return ee==0&&(ee=(v*ne+w/2)/w),ne==0&&(ne=(w*ee+v/2)/v),0>=ee||0>=ne?0:(T[0]=ee,B[0]=ne,1)}function ve(v,w){return v+(1<<w)-1>>>w}function ye(v,w){return((4278255360&v)+(4278255360&w)>>>0&4278255360)+((16711935&v)+(16711935&w)>>>0&16711935)>>>0}function Ce(v,w){C[w]=function(T,B,ee,ne,ie,oe,le){var de;for(de=0;de<ie;++de){var _e=C[v](oe[le+de-1],ee,ne+de);oe[le+de]=ye(T[B+de],_e)}}}function ze(){this.ud=this.hd=this.jd=0}function $e(v,w){return((4278124286&(v^w))>>>1)+(v&w)>>>0}function Ue(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Xe(v,w){return Ue(v+(v-w+.5>>1))}function Qe(v,w,T){return Math.abs(w-T)-Math.abs(v-T)}function bt(v,w,T,B,ee,ne,ie){for(B=ne[ie-1],T=0;T<ee;++T)ne[ie+T]=B=ye(v[w+T],B)}function Dt(v,w,T,B,ee){var ne;for(ne=0;ne<T;++ne){var ie=v[w+ne],oe=ie>>8&255,le=16711935&(le=(le=16711935&ie)+((oe<<16)+oe));B[ee+ne]=(4278255360&ie)+le>>>0}}function kt(v,w){w.jd=v>>0&255,w.hd=v>>8&255,w.ud=v>>16&255}function wt(v,w,T,B,ee,ne){var ie;for(ie=0;ie<B;++ie){var oe=w[T+ie],le=oe>>>8,de=oe,_e=255&(_e=(_e=oe>>>16)+((v.jd<<24>>24)*(le<<24>>24)>>>5));de=255&(de=(de=de+((v.hd<<24>>24)*(le<<24>>24)>>>5))+((v.ud<<24>>24)*(_e<<24>>24)>>>5)),ee[ne+ie]=(4278255360&oe)+(_e<<16)+de}}function it(v,w,T,B,ee){C[w]=function(ne,ie,oe,le,de,_e,Le,De,ke){for(le=Le;le<De;++le)for(Le=0;Le<ke;++Le)de[_e++]=ee(oe[B(ne[ie++])])},C[v]=function(ne,ie,oe,le,de,_e,Le){var De=8>>ne.b,ke=ne.Ea,Ke=ne.K[0],He=ne.w;if(8>De)for(ne=(1<<ne.b)-1,He=(1<<De)-1;ie<oe;++ie){var Ne,je=0;for(Ne=0;Ne<ke;++Ne)Ne&ne||(je=B(le[de++])),_e[Le++]=ee(Ke[je&He]),je>>=De}else C["VP8LMapColor"+T](le,de,Ke,He,_e,Le,ie,oe,ke)}}function Ae(v,w,T,B,ee){for(T=w+T;w<T;){var ne=v[w++];B[ee++]=ne>>16&255,B[ee++]=ne>>8&255,B[ee++]=ne>>0&255}}function tt(v,w,T,B,ee){for(T=w+T;w<T;){var ne=v[w++];B[ee++]=ne>>16&255,B[ee++]=ne>>8&255,B[ee++]=ne>>0&255,B[ee++]=ne>>24&255}}function at(v,w,T,B,ee){for(T=w+T;w<T;){var ne=(ie=v[w++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;B[ee++]=ne,B[ee++]=ie}}function Ct(v,w,T,B,ee){for(T=w+T;w<T;){var ne=(ie=v[w++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;B[ee++]=ne,B[ee++]=ie}}function _t(v,w,T,B,ee){for(T=w+T;w<T;){var ne=v[w++];B[ee++]=ne>>0&255,B[ee++]=ne>>8&255,B[ee++]=ne>>16&255}}function xt(v,w,T,B,ee,ne){if(ne==0)for(T=w+T;w<T;)Q(B,((ne=v[w++])[0]>>24|ne[1]>>8&65280|ne[2]<<8&16711680|ne[3]<<24)>>>0),ee+=32;else n(B,ee,v,w,T)}function fn(v,w){C[w][0]=C[v+"0"],C[w][1]=C[v+"1"],C[w][2]=C[v+"2"],C[w][3]=C[v+"3"],C[w][4]=C[v+"4"],C[w][5]=C[v+"5"],C[w][6]=C[v+"6"],C[w][7]=C[v+"7"],C[w][8]=C[v+"8"],C[w][9]=C[v+"9"],C[w][10]=C[v+"10"],C[w][11]=C[v+"11"],C[w][12]=C[v+"12"],C[w][13]=C[v+"13"],C[w][14]=C[v+"0"],C[w][15]=C[v+"0"]}function Nt(v){return v==yg||v==bg||v==w0||v==wg}function kr(){this.eb=[],this.size=this.A=this.fb=0}function ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Oa(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new kr,this.f.kb=new ir,this.sd=null}function ba(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function or(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Et(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function Kt(v,w){var T=v.T,B=w.ba.f.RGBA,ee=B.eb,ne=B.fb+v.ka*B.A,ie=gi[w.ba.S],oe=v.y,le=v.O,de=v.f,_e=v.N,Le=v.ea,De=v.W,ke=w.cc,Ke=w.dc,He=w.Mc,Ne=w.Nc,je=v.ka,Ve=v.ka+v.T,Ze=v.U,Ye=Ze+1>>1;for(je==0?ie(oe,le,null,null,de,_e,Le,De,de,_e,Le,De,ee,ne,null,null,Ze):(ie(w.ec,w.fc,oe,le,ke,Ke,He,Ne,de,_e,Le,De,ee,ne-B.A,ee,ne,Ze),++T);je+2<Ve;je+=2)ke=de,Ke=_e,He=Le,Ne=De,_e+=v.Rc,De+=v.Rc,ne+=2*B.A,ie(oe,(le+=2*v.fa)-v.fa,oe,le,ke,Ke,He,Ne,de,_e,Le,De,ee,ne-B.A,ee,ne,Ze);return le+=v.fa,v.j+Ve<v.o?(n(w.ec,w.fc,oe,le,Ze),n(w.cc,w.dc,de,_e,Ye),n(w.Mc,w.Nc,Le,De,Ye),T--):1&Ve||ie(oe,le,null,null,de,_e,Le,De,de,_e,Le,De,ee,ne+B.A,null,null,Ze),T}function Li(v,w,T){var B=v.F,ee=[v.J];if(B!=null){var ne=v.U,ie=w.ba.S,oe=ie==b0||ie==w0;w=w.ba.f.RGBA;var le=[0],de=v.ka;le[0]=v.T,v.Kb&&(de==0?--le[0]:(--de,ee[0]-=v.width),v.j+v.ka+v.T==v.o&&(le[0]=v.o-v.j-de));var _e=w.eb;de=w.fb+de*w.A,v=Nr(B,ee[0],v.width,ne,le,_e,de+(oe?0:3),w.A),t(T==le),v&&Nt(ie)&&pi(_e,de,oe,ne,le,w.A)}return 0}function Zr(v){var w=v.ma,T=w.ba.S,B=11>T,ee=T==v0||T==y0||T==b0||T==vg||T==12||Nt(T);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Yu(w.Oa,v,ee?11:12))return 0;if(ee&&Nt(T)&&et(),v.da)alert("todo:use_scaling");else{if(B){if(w.Ib=Et,v.Kb){if(T=v.U+1>>1,w.memory=i(v.U+2*T),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+v.U,w.Mc=w.cc,w.Nc=w.dc+T,w.Ib=Kt,et()}}else alert("todo:EmitYUV");ee&&(w.Jb=Li,B&&Pe())}if(B&&!Dw){for(v=0;256>v;++v)mO[v]=89858*(v-128)+_0>>S0,vO[v]=-22014*(v-128)+_0,xO[v]=-45773*(v-128),gO[v]=113618*(v-128)+_0>>S0;for(v=nf;v<Ng;++v)w=76283*(v-16)+_0>>S0,yO[v-nf]=Ya(w,255),bO[v-nf]=Ya(w+8>>4,15);Dw=1}return 1}function wa(v){var w=v.ma,T=v.U,B=v.T;return t(!(1&v.ka)),0>=T||0>=B?0:(T=w.Ib(v,w),w.Jb!=null&&w.Jb(v,w,T),w.Dc+=T,1)}function ui(v){v.ma.memory=null}function Tt(v,w,T,B){return se(v,8)!=47?0:(w[0]=se(v,14)+1,T[0]=se(v,14)+1,B[0]=se(v,1),se(v,3)!=0?0:!v.h)}function Ga(v,w){if(4>v)return v+1;var T=v-2>>1;return(2+(1&v)<<T)+se(w,T)+1}function Fa(v,w){return 120<w?w-120:1<=(T=((T=tO[w-1])>>4)*v+(8-(15&T)))?T:1;var T}function Qn(v,w,T){var B=I(T),ee=v[w+=255&B].g-8;return 0<ee&&(L(T,T.u+8),B=I(T),w+=v[w].value,w+=B&(1<<ee)-1),L(T,T.u+v[w].g),v[w].value}function Qr(v,w,T){return T.g+=v.g,T.value+=v.value<<w>>>0,t(8>=T.g),v.g}function Wr(v,w,T){var B=v.xc;return t((w=B==0?0:v.vc[v.md*(T>>B)+(w>>B)])<v.Wb),v.Ya[w]}function ae(v,w,T,B){var ee=v.ab,ne=v.c*w,ie=v.C;w=ie+w;var oe=T,le=B;for(B=v.Ta,T=v.Ua;0<ee--;){var de=v.gc[ee],_e=ie,Le=w,De=oe,ke=le,Ke=(le=B,oe=T,de.Ea);switch(t(_e<Le),t(Le<=de.nc),de.hc){case 2:f0(De,ke,(Le-_e)*Ke,le,oe);break;case 0:var He=_e,Ne=Le,je=le,Ve=oe,Ze=(ut=de).Ea;He==0&&(gg(De,ke,null,null,1,je,Ve),bt(De,ke+1,0,0,Ze-1,je,Ve+1),ke+=Ze,Ve+=Ze,++He);for(var Ye=1<<ut.b,pt=Ye-1,ct=ve(Ze,ut.b),Pt=ut.K,ut=ut.w+(He>>ut.b)*ct;He<Ne;){var ar=Pt,lr=ut,Zt=1;for(Ju(De,ke,je,Ve-Ze,1,je,Ve);Zt<Ze;){var Yt=(Zt&~pt)+Ye;Yt>Ze&&(Yt=Ze),(0,_o[ar[lr++]>>8&15])(De,ke+ +Zt,je,Ve+Zt-Ze,Yt-Zt,je,Ve+Zt),Zt=Yt}ke+=Ze,Ve+=Ze,++He&pt||(ut+=ct)}Le!=de.nc&&n(le,oe-Ke,le,oe+(Le-_e-1)*Ke,Ke);break;case 1:for(Ke=De,Ne=ke,Ze=(De=de.Ea)-(Ve=De&~(je=(ke=1<<de.b)-1)),He=ve(De,de.b),Ye=de.K,de=de.w+(_e>>de.b)*He;_e<Le;){for(pt=Ye,ct=de,Pt=new ze,ut=Ne+Ve,ar=Ne+De;Ne<ut;)kt(pt[ct++],Pt),dl(Pt,Ke,Ne,ke,le,oe),Ne+=ke,oe+=ke;Ne<ar&&(kt(pt[ct++],Pt),dl(Pt,Ke,Ne,Ze,le,oe),Ne+=Ze,oe+=Ze),++_e&je||(de+=He)}break;case 3:if(De==le&&ke==oe&&0<de.b){for(Ne=le,De=Ke=oe+(Le-_e)*Ke-(Ve=(Le-_e)*ve(de.Ea,de.b)),ke=le,je=oe,He=[],Ve=(Ze=Ve)-1;0<=Ve;--Ve)He[Ve]=ke[je+Ve];for(Ve=Ze-1;0<=Ve;--Ve)Ne[De+Ve]=He[Ve];fi(de,_e,Le,le,Ke,le,oe)}else fi(de,_e,Le,De,ke,le,oe)}oe=B,le=T}le!=T&&n(B,T,oe,le,ne)}function pe(v,w){var T=v.V,B=v.Ba+v.c*v.C,ee=w-v.C;if(t(w<=v.l.o),t(16>=ee),0<ee){var ne=v.l,ie=v.Ta,oe=v.Ua,le=ne.width;if(ae(v,ee,T,B),ee=oe=[oe],t((T=v.C)<(B=w)),t(ne.v<ne.va),B>ne.o&&(B=ne.o),T<ne.j){var de=ne.j-T;T=ne.j,ee[0]+=de*le}if(T>=B?T=0:(ee[0]+=4*ne.v,ne.ka=T-ne.j,ne.U=ne.va-ne.v,ne.T=B-T,T=1),T){if(oe=oe[0],11>(T=v.ca).S){var _e=T.f.RGBA,Le=(B=T.S,ee=ne.U,ne=ne.T,de=_e.eb,_e.A),De=ne;for(_e=_e.fb+v.Ma*_e.A;0<De--;){var ke=ie,Ke=oe,He=ee,Ne=de,je=_e;switch(B){case x0:Da(ke,Ke,He,Ne,je);break;case v0:Sa(ke,Ke,He,Ne,je);break;case yg:Sa(ke,Ke,He,Ne,je),pi(Ne,je,0,He,1,0);break;case kw:Is(ke,Ke,He,Ne,je);break;case y0:xt(ke,Ke,He,Ne,je,1);break;case bg:xt(ke,Ke,He,Ne,je,1),pi(Ne,je,0,He,1,0);break;case b0:xt(ke,Ke,He,Ne,je,0);break;case w0:xt(ke,Ke,He,Ne,je,0),pi(Ne,je,1,He,1,0);break;case vg:No(ke,Ke,He,Ne,je);break;case wg:No(ke,Ke,He,Ne,je),_r(Ne,je,He,1,0);break;case Ew:Fs(ke,Ke,He,Ne,je);break;default:t(0)}oe+=le,_e+=Le}v.Ma+=ne}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=T.height)}}v.C=w,t(v.C<=v.i)}function ce(v){var w;if(0<v.ua)return 0;for(w=0;w<v.Wb;++w){var T=v.Ya[w].G,B=v.Ya[w].H;if(0<T[1][B[1]+0].g||0<T[2][B[2]+0].g||0<T[3][B[3]+0].g)return 0}return 1}function ue(v,w,T,B,ee,ne){if(v.Z!=0){var ie=v.qd,oe=v.rd;for(t(Eo[v.Z]!=null);w<T;++w)Eo[v.Z](ie,oe,B,ee,B,ee,ne),ie=B,oe=ee,ee+=ne;v.qd=ie,v.rd=oe}}function he(v,w){var T=v.l.ma,B=T.Z==0||T.Z==1?v.l.j:v.C;if(B=v.C<B?B:v.C,t(w<=v.l.o),w>B){var ee=v.l.width,ne=T.ca,ie=T.tb+ee*B,oe=v.V,le=v.Ba+v.c*B,de=v.gc;t(v.ab==1),t(de[0].hc==3),d0(de[0],B,w,oe,le,ne,ie),ue(T,B,w,ne,ie,ee)}v.C=v.Ma=w}function me(v,w,T,B,ee,ne,ie){var oe=v.$/B,le=v.$%B,de=v.m,_e=v.s,Le=T+v.$,De=Le;ee=T+B*ee;var ke=T+B*ne,Ke=280+_e.ua,He=v.Pb?oe:16777216,Ne=0<_e.ua?_e.Wa:null,je=_e.wc,Ve=Le<ke?Wr(_e,le,oe):null;t(v.C<ne),t(ke<=ee);var Ze=!1;e:for(;;){for(;Ze||Le<ke;){var Ye=0;if(oe>=He){var pt=Le-T;t((He=v).Pb),He.wd=He.m,He.xd=pt,0<He.s.ua&&be(He.s.Wa,He.s.vb),He=oe+nO}if(le&je||(Ve=Wr(_e,le,oe)),t(Ve!=null),Ve.Qb&&(w[Le]=Ve.qb,Ze=!0),!Ze)if(R(de),Ve.jc){Ye=de,pt=w;var ct=Le,Pt=Ve.pd[I(Ye)&Gn-1];t(Ve.jc),256>Pt.g?(L(Ye,Ye.u+Pt.g),pt[ct]=Pt.value,Ye=0):(L(Ye,Ye.u+Pt.g-256),t(256<=Pt.value),Ye=Pt.value),Ye==0&&(Ze=!0)}else Ye=Qn(Ve.G[0],Ve.H[0],de);if(de.h)break;if(Ze||256>Ye){if(!Ze)if(Ve.nd)w[Le]=(Ve.qb|Ye<<8)>>>0;else{if(R(de),Ze=Qn(Ve.G[1],Ve.H[1],de),R(de),pt=Qn(Ve.G[2],Ve.H[2],de),ct=Qn(Ve.G[3],Ve.H[3],de),de.h)break;w[Le]=(ct<<24|Ze<<16|Ye<<8|pt)>>>0}if(Ze=!1,++Le,++le>=B&&(le=0,++oe,ie!=null&&oe<=ne&&!(oe%16)&&ie(v,oe),Ne!=null))for(;De<Le;)Ye=w[De++],Ne.X[(506832829*Ye&4294967295)>>>Ne.Mb]=Ye}else if(280>Ye){if(Ye=Ga(Ye-256,de),pt=Qn(Ve.G[4],Ve.H[4],de),R(de),pt=Fa(B,pt=Ga(pt,de)),de.h)break;if(Le-T<pt||ee-Le<Ye)break e;for(ct=0;ct<Ye;++ct)w[Le+ct]=w[Le+ct-pt];for(Le+=Ye,le+=Ye;le>=B;)le-=B,++oe,ie!=null&&oe<=ne&&!(oe%16)&&ie(v,oe);if(t(Le<=ee),le&je&&(Ve=Wr(_e,le,oe)),Ne!=null)for(;De<Le;)Ye=w[De++],Ne.X[(506832829*Ye&4294967295)>>>Ne.Mb]=Ye}else{if(!(Ye<Ke))break e;for(Ze=Ye-280,t(Ne!=null);De<Le;)Ye=w[De++],Ne.X[(506832829*Ye&4294967295)>>>Ne.Mb]=Ye;Ye=Le,t(!(Ze>>>(pt=Ne).Xa)),w[Ye]=pt.X[Ze],Ze=!0}Ze||t(de.h==P(de))}if(v.Pb&&de.h&&Le<ee)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&be(v.s.vb,v.s.Wa);else{if(de.h)break e;ie!=null&&ie(v,oe>ne?ne:oe),v.a=0,v.$=Le-T}return 1}return v.a=3,0}function Ie(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var w=v.Wa;w!=null&&(w.X=null),v.vb=null,t(v!=null)}function We(){var v=new mg;return v==null?null:(v.a=0,v.xb=Pw,fn("Predictor","VP8LPredictors"),fn("Predictor","VP8LPredictors_C"),fn("PredictorAdd","VP8LPredictorsAdd"),fn("PredictorAdd","VP8LPredictorsAdd_C"),f0=Dt,dl=wt,Da=Ae,Sa=tt,No=at,Fs=Ct,Is=_t,C.VP8LMapColor32b=_c,C.VP8LMapColor8b=h0,v)}function Fe(v,w,T,B,ee){var ne=1,ie=[v],oe=[w],le=B.m,de=B.s,_e=null,Le=0;e:for(;;){if(T)for(;ne&&se(le,1);){var De=ie,ke=oe,Ke=B,He=1,Ne=Ke.m,je=Ke.gc[Ke.ab],Ve=se(Ne,2);if(Ke.Oc&1<<Ve)ne=0;else{switch(Ke.Oc|=1<<Ve,je.hc=Ve,je.Ea=De[0],je.nc=ke[0],je.K=[null],++Ke.ab,t(4>=Ke.ab),Ve){case 0:case 1:je.b=se(Ne,3)+2,He=Fe(ve(je.Ea,je.b),ve(je.nc,je.b),0,Ke,je.K),je.K=je.K[0];break;case 3:var Ze,Ye=se(Ne,8)+1,pt=16<Ye?0:4<Ye?1:2<Ye?2:3;if(De[0]=ve(je.Ea,pt),je.b=pt,Ze=He=Fe(Ye,1,0,Ke,je.K)){var ct,Pt=Ye,ut=je,ar=1<<(8>>ut.b),lr=i(ar);if(lr==null)Ze=0;else{var Zt=ut.K[0],Yt=ut.w;for(lr[0]=ut.K[0][0],ct=1;ct<1*Pt;++ct)lr[ct]=ye(Zt[Yt+ct],lr[ct-1]);for(;ct<4*ar;++ct)lr[ct]=0;ut.K[0]=null,ut.K[0]=lr,Ze=1}}He=Ze;break;case 2:break;default:t(0)}ne=He}}if(ie=ie[0],oe=oe[0],ne&&se(le,1)&&!(ne=1<=(Le=se(le,4))&&11>=Le)){B.a=3;break e}var br;if(br=ne)t:{var gr,Wt,pn,Ma=B,mn=ie,Ra=oe,cr=Le,Xa=T,Ja=Ma.m,In=Ma.s,Vn=[null],Na=1,xi=0,fs=rO[cr];r:for(;;){if(Xa&&se(Ja,1)){var Ln=se(Ja,3)+2,Rs=ve(mn,Ln),xl=ve(Ra,Ln),Ec=Rs*xl;if(!Fe(Rs,xl,0,Ma,Vn))break r;for(Vn=Vn[0],In.xc=Ln,gr=0;gr<Ec;++gr){var Co=Vn[gr]>>8&65535;Vn[gr]=Co,Co>=Na&&(Na=Co+1)}}if(Ja.h)break r;for(Wt=0;5>Wt;++Wt){var qr=Cw[Wt];!Wt&&0<cr&&(qr+=1<<cr),xi<qr&&(xi=qr)}var Ag=s(Na*fs,j),Bw=Na,Uw=s(Bw,U);if(Uw==null)var A0=null;else t(65536>=Bw),A0=Uw;var af=i(xi);if(A0==null||af==null||Ag==null){Ma.a=1;break r}var j0=Ag;for(gr=pn=0;gr<Na;++gr){var $i=A0[gr],Cc=$i.G,Tc=$i.H,zw=0,k0=1,$w=0;for(Wt=0;5>Wt;++Wt){qr=Cw[Wt],Cc[Wt]=j0,Tc[Wt]=pn,!Wt&&0<cr&&(qr+=1<<cr);a:{var E0,jg=qr,C0=Ma,sf=af,_O=j0,NO=pn,kg=0,To=C0.m,AO=se(To,1);if(a(sf,0,0,jg),AO){var jO=se(To,1)+1,kO=se(To,1),Ww=se(To,kO==0?1:8);sf[Ww]=1,jO==2&&(sf[Ww=se(To,8)]=1);var T0=1}else{var Hw=i(19),qw=se(To,4)+4;if(19<qw){C0.a=3;var P0=0;break a}for(E0=0;E0<qw;++E0)Hw[eO[E0]]=se(To,3);var Eg=void 0,of=void 0,Gw=C0,EO=Hw,O0=jg,Vw=sf,Cg=0,Po=Gw.m,Yw=8,Kw=s(128,j);n:for(;D(Kw,0,7,EO,19);){if(se(Po,1)){var CO=2+2*se(Po,3);if((Eg=2+se(Po,CO))>O0)break n}else Eg=O0;for(of=0;of<O0&&Eg--;){R(Po);var Xw=Kw[0+(127&I(Po))];L(Po,Po.u+Xw.g);var Pc=Xw.value;if(16>Pc)Vw[of++]=Pc,Pc!=0&&(Yw=Pc);else{var TO=Pc==16,Jw=Pc-16,PO=Z8[Jw],Zw=se(Po,J8[Jw])+PO;if(of+Zw>O0)break n;for(var OO=TO?Yw:0;0<Zw--;)Vw[of++]=OO}}Cg=1;break n}Cg||(Gw.a=3),T0=Cg}(T0=T0&&!To.h)&&(kg=D(_O,NO,8,sf,jg)),T0&&kg!=0?P0=kg:(C0.a=3,P0=0)}if(P0==0)break r;if(k0&&Q8[Wt]==1&&(k0=j0[pn].g==0),zw+=j0[pn].g,pn+=P0,3>=Wt){var lf,Tg=af[0];for(lf=1;lf<qr;++lf)af[lf]>Tg&&(Tg=af[lf]);$w+=Tg}}if($i.nd=k0,$i.Qb=0,k0&&($i.qb=(Cc[3][Tc[3]+0].value<<24|Cc[1][Tc[1]+0].value<<16|Cc[2][Tc[2]+0].value)>>>0,zw==0&&256>Cc[0][Tc[0]+0].value&&($i.Qb=1,$i.qb+=Cc[0][Tc[0]+0].value<<8)),$i.jc=!$i.Qb&&6>$w,$i.jc){var F0,Bs=$i;for(F0=0;F0<Gn;++F0){var Oo=F0,Fo=Bs.pd[Oo],I0=Bs.G[0][Bs.H[0]+Oo];256<=I0.value?(Fo.g=I0.g+256,Fo.value=I0.value):(Fo.g=0,Fo.value=0,Oo>>=Qr(I0,8,Fo),Oo>>=Qr(Bs.G[1][Bs.H[1]+Oo],16,Fo),Oo>>=Qr(Bs.G[2][Bs.H[2]+Oo],0,Fo),Qr(Bs.G[3][Bs.H[3]+Oo],24,Fo))}}}In.vc=Vn,In.Wb=Na,In.Ya=A0,In.yc=Ag,br=1;break t}br=0}if(!(ne=br)){B.a=3;break e}if(0<Le){if(de.ua=1<<Le,!Te(de.Wa,Le)){B.a=1,ne=0;break e}}else de.ua=0;var Pg=B,Qw=ie,FO=oe,Og=Pg.s,Fg=Og.xc;if(Pg.c=Qw,Pg.i=FO,Og.md=ve(Qw,Fg),Og.wc=Fg==0?-1:(1<<Fg)-1,T){B.xb=uO;break e}if((_e=i(ie*oe))==null){B.a=1,ne=0;break e}ne=(ne=me(B,_e,0,ie,oe,oe,null))&&!le.h;break e}return ne?(ee!=null?ee[0]=_e:(t(_e==null),t(T)),B.$=0,T||Ie(de)):Ie(de),ne}function Me(v,w){var T=v.c*v.i,B=T+w+16*w;return t(v.c<=w),v.V=i(B),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+T+w,1)}function Be(v,w){var T=v.C,B=w-T,ee=v.V,ne=v.Ba+v.c*T;for(t(w<=v.l.o);0<B;){var ie=16<B?16:B,oe=v.l.ma,le=v.l.width,de=le*ie,_e=oe.ca,Le=oe.tb+le*T,De=v.Ta,ke=v.Ua;ae(v,ie,ee,ne),rn(De,ke,_e,Le,de),ue(oe,T,T+ie,_e,Le,le),B-=ie,ee+=ie*v.c,T+=ie}t(T==w),v.C=v.Ma=w}function rt(){this.ub=this.yd=this.td=this.Rb=0}function st(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function nt(){this.Yb=(function(){var v=[];return(function w(T,B,ee){for(var ne=ee[B],ie=0;ie<ne&&(T.push(ee.length>B+1?[]:0),!(ee.length<B+1));ie++)w(T[ie],B+1,ee)})(v,0,[3,11]),v})()}function ft(){this.jb=i(3),this.Wc=o([4,8],nt),this.Xc=o([4,17],nt)}function Rt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function sr(){this.ld=this.La=this.dd=this.tc=0}function mr(){this.Na=this.la=0}function dn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Di(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ts(){this.uc=this.M=this.Nb=0,this.wa=Array(new sr),this.Y=0,this.ya=Array(new Di),this.aa=0,this.l=new os}function ss(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Mi(){this.cb=this.a=0,this.sc="",this.m=new xe,this.Od=new rt,this.Kc=new st,this.ed=new Rt,this.Qa=new dt,this.Ic=this.$c=this.Aa=0,this.D=new Ts,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,xe),this.ia=0,this.pb=s(4,dn),this.Pa=new ft,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ss),this.Hd=0,this.rb=Array(new mr),this.sb=0,this.wa=Array(new sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Di),this.L=this.aa=0,this.gd=o([4,2],sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function os(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Va(){var v=new Mi;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,rf||(rf=Xd)),v}function en(v,w,T){return v.a==0&&(v.a=w,v.sc=T,v.cb=0),0}function Yd(v,w,T){return 3<=T&&v[w+0]==157&&v[w+1]==1&&v[w+2]==42}function Kd(v,w){if(v==null)return 0;if(v.a=0,v.sc="OK",w==null)return en(v,2,"null VP8Io passed to VP8GetHeaders()");var T=w.data,B=w.w,ee=w.ha;if(4>ee)return en(v,7,"Truncated header.");var ne=T[B+0]|T[B+1]<<8|T[B+2]<<16,ie=v.Od;if(ie.Rb=!(1&ne),ie.td=ne>>1&7,ie.yd=ne>>4&1,ie.ub=ne>>5,3<ie.td)return en(v,3,"Incorrect keyframe parameters.");if(!ie.yd)return en(v,4,"Frame not displayable.");B+=3,ee-=3;var oe=v.Kc;if(ie.Rb){if(7>ee)return en(v,7,"cannot parse picture header");if(!Yd(T,B,ee))return en(v,3,"Bad code word");oe.c=16383&(T[B+4]<<8|T[B+3]),oe.Td=T[B+4]>>6,oe.i=16383&(T[B+6]<<8|T[B+5]),oe.Ud=T[B+6]>>6,B+=7,ee-=7,v.za=oe.c+15>>4,v.Ub=oe.i+15>>4,w.width=oe.c,w.height=oe.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,a((ne=v.Pa).jb,0,255,ne.jb.length),t((ne=v.Qa)!=null),ne.Cb=0,ne.Bb=0,ne.Fb=1,a(ne.Zb,0,0,ne.Zb.length),a(ne.Lb,0,0,ne.Lb)}if(ie.ub>ee)return en(v,7,"bad partition length");Y(ne=v.m,T,B,ie.ub),B+=ie.ub,ee-=ie.ub,ie.Rb&&(oe.Ld=J(ne),oe.Kd=J(ne)),oe=v.Qa;var le,de=v.Pa;if(t(ne!=null),t(oe!=null),oe.Cb=J(ne),oe.Cb){if(oe.Bb=J(ne),J(ne)){for(oe.Fb=J(ne),le=0;4>le;++le)oe.Zb[le]=J(ne)?Z(ne,7):0;for(le=0;4>le;++le)oe.Lb[le]=J(ne)?Z(ne,6):0}if(oe.Bb)for(le=0;3>le;++le)de.jb[le]=J(ne)?X(ne,8):255}else oe.Bb=0;if(ne.Ka)return en(v,3,"cannot parse segment header");if((oe=v.ed).zd=J(ne),oe.Tb=X(ne,6),oe.wb=X(ne,3),oe.Pc=J(ne),oe.Pc&&J(ne)){for(de=0;4>de;++de)J(ne)&&(oe.vd[de]=Z(ne,6));for(de=0;4>de;++de)J(ne)&&(oe.od[de]=Z(ne,6))}if(v.L=oe.Tb==0?0:oe.zd?1:2,ne.Ka)return en(v,3,"cannot parse filter header");var _e=ee;if(ee=le=B,B=le+_e,oe=_e,v.Xb=(1<<X(v.m,2))-1,_e<3*(de=v.Xb))T=7;else{for(le+=3*de,oe-=3*de,_e=0;_e<de;++_e){var Le=T[ee+0]|T[ee+1]<<8|T[ee+2]<<16;Le>oe&&(Le=oe),Y(v.Jc[+_e],T,le,Le),le+=Le,oe-=Le,ee+=3}Y(v.Jc[+de],T,le,oe),T=le<B?0:5}if(T!=0)return en(v,T,"cannot parse partitions");for(T=X(le=v.m,7),ee=J(le)?Z(le,4):0,B=J(le)?Z(le,4):0,oe=J(le)?Z(le,4):0,de=J(le)?Z(le,4):0,le=J(le)?Z(le,4):0,_e=v.Qa,Le=0;4>Le;++Le){if(_e.Cb){var De=_e.Zb[Le];_e.Fb||(De+=T)}else{if(0<Le){v.pb[Le]=v.pb[0];continue}De=T}var ke=v.pb[Le];ke.Sc[0]=Sg[Ya(De+ee,127)],ke.Sc[1]=_g[Ya(De+0,127)],ke.Eb[0]=2*Sg[Ya(De+B,127)],ke.Eb[1]=101581*_g[Ya(De+oe,127)]>>16,8>ke.Eb[1]&&(ke.Eb[1]=8),ke.Qc[0]=Sg[Ya(De+de,117)],ke.Qc[1]=_g[Ya(De+le,127)],ke.lc=De+le}if(!ie.Rb)return en(v,4,"Not a key frame.");for(J(ne),ie=v.Pa,T=0;4>T;++T){for(ee=0;8>ee;++ee)for(B=0;3>B;++B)for(oe=0;11>oe;++oe)de=q(ne,lO[T][ee][B][oe])?X(ne,8):sO[T][ee][B][oe],ie.Wc[T][ee].Yb[B][oe]=de;for(ee=0;17>ee;++ee)ie.Xc[T][ee]=ie.Wc[T][cO[ee]]}return v.kc=J(ne),v.kc&&(v.Bd=X(ne,8)),v.cb=1}function Xd(v,w,T,B,ee,ne,ie){var oe=w[ee].Yb[T];for(T=0;16>ee;++ee){if(!q(v,oe[T+0]))return ee;for(;!q(v,oe[T+1]);)if(oe=w[++ee].Yb[0],T=0,ee==16)return 16;var le=w[ee+1].Yb;if(q(v,oe[T+2])){var de=v,_e=0;if(q(de,(De=oe)[(Le=T)+3]))if(q(de,De[Le+6])){for(oe=0,Le=2*(_e=q(de,De[Le+8]))+(De=q(de,De[Le+9+_e])),_e=0,De=aO[Le];De[oe];++oe)_e+=_e+q(de,De[oe]);_e+=3+(8<<Le)}else q(de,De[Le+7])?(_e=7+2*q(de,165),_e+=q(de,145)):_e=5+q(de,159);else _e=q(de,De[Le+4])?3+q(de,De[Le+5]):2;oe=le[2]}else _e=1,oe=le[1];le=ie+iO[ee],0>(de=v).b&&G(de);var Le,De=de.b,ke=(Le=de.Ca>>1)-(de.I>>De)>>31;--de.b,de.Ca+=ke,de.Ca|=1,de.I-=(Le+1&ke)<<De,ne[le]=((_e^ke)-ke)*B[(0<ee)+0]}return 16}function Fu(v){var w=v.rb[v.sb-1];w.la=0,w.Na=0,a(v.zc,0,0,v.zc.length),v.ja=0}function Zm(v,w){if(v==null)return 0;if(w==null)return en(v,2,"NULL VP8Io parameter in VP8Decode().");if(!v.cb&&!Kd(v,w))return 0;if(t(v.cb),w.ac==null||w.ac(w)){w.ob&&(v.L=0);var T=N0[v.L];if(v.L==2?(v.yb=0,v.zb=0):(v.yb=w.v-T>>4,v.zb=w.j-T>>4,0>v.yb&&(v.yb=0),0>v.zb&&(v.zb=0)),v.Va=w.o+15+T>>4,v.Hb=w.va+15+T>>4,v.Hb>v.za&&(v.Hb=v.za),v.Va>v.Ub&&(v.Va=v.Ub),0<v.L){var B=v.ed;for(T=0;4>T;++T){var ee;if(v.Qa.Cb){var ne=v.Qa.Lb[T];v.Qa.Fb||(ne+=B.Tb)}else ne=B.Tb;for(ee=0;1>=ee;++ee){var ie=v.gd[T][ee],oe=ne;if(B.Pc&&(oe+=B.vd[0],ee&&(oe+=B.od[0])),0<(oe=0>oe?0:63<oe?63:oe)){var le=oe;0<B.wb&&(le=4<B.wb?le>>2:le>>1)>9-B.wb&&(le=9-B.wb),1>le&&(le=1),ie.dd=le,ie.tc=2*oe+le,ie.ld=40<=oe?2:15<=oe?1:0}else ie.tc=0;ie.La=ee}}}T=0}else en(v,6,"Frame setup failed"),T=v.a;if(T=T==0){if(T){v.$c=0,0<v.Aa||(v.Ic=SO);e:{T=v.Ic,B=4*(le=v.za);var de=32*le,_e=le+1,Le=0<v.L?le*(0<v.Aa?2:1):0,De=(v.Aa==2?2:1)*le;if((ie=B+832+(ee=3*(16*T+N0[v.L])/2*de)+(ne=v.Fa!=null&&0<v.Fa.length?v.Kc.c*v.Kc.i:0))!=ie)T=0;else{if(ie>v.Vb){if(v.Vb=0,v.Ec=i(ie),v.Fc=0,v.Ec==null){T=en(v,1,"no memory during frame initialization.");break e}v.Vb=ie}ie=v.Ec,oe=v.Fc,v.Ac=ie,v.Bc=oe,oe+=B,v.Gd=s(de,ss),v.Hd=0,v.rb=s(_e+1,mr),v.sb=1,v.wa=Le?s(Le,sr):null,v.Y=0,v.D.Nb=0,v.D.wa=v.wa,v.D.Y=v.Y,0<v.Aa&&(v.D.Y+=le),t(!0),v.oc=ie,v.pc=oe,oe+=832,v.ya=s(De,Di),v.aa=0,v.D.ya=v.ya,v.D.aa=v.aa,v.Aa==2&&(v.D.aa+=le),v.R=16*le,v.B=8*le,le=(de=N0[v.L])*v.R,de=de/2*v.B,v.sa=ie,v.ta=oe+le,v.qa=v.sa,v.ra=v.ta+16*T*v.R+de,v.Ha=v.qa,v.Ia=v.ra+8*T*v.B+de,v.$c=0,oe+=ee,v.mb=ne?ie:null,v.nb=ne?oe:null,t(oe+ne<=v.Fc+v.Vb),Fu(v),a(v.Ac,v.Bc,0,B),T=1}}if(T){if(w.ka=0,w.y=v.sa,w.O=v.ta,w.f=v.qa,w.N=v.ra,w.ea=v.Ha,w.Vd=v.Ia,w.fa=v.R,w.Rc=v.B,w.F=null,w.J=0,!m0){for(T=-255;255>=T;++T)Nn[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)Ds[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)tf[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)kc[255+T]=0>T?0:255<T?255:T;m0=1}Nc=tg,Ls=Qm,Zu=Zd,_a=eg,di=Qd,tn=Jd,Ac=Bu,p0=ul,Qu=pg,hl=Uu,pl=hg,Ao=mc,ml=zu,jc=l0,gl=o0,jo=cs,ef=Os,hi=dg,zi[0]=ls,zi[1]=rg,zi[2]=sg,zi[3]=og,zi[4]=r0,zi[5]=hc,zi[6]=n0,zi[7]=Du,zi[8]=cg,zi[9]=lg,ko[0]=e0,ko[1]=ag,ko[2]=Ps,ko[3]=fc,ko[4]=ea,ko[5]=ig,ko[6]=t0,Ms[0]=bo,Ms[1]=ng,Ms[2]=ug,Ms[3]=Mu,Ms[4]=cl,Ms[5]=fg,Ms[6]=Ru,T=1}else T=0}T&&(T=(function(ke,Ke){for(ke.M=0;ke.M<ke.Va;++ke.M){var He,Ne=ke.Jc[ke.M&ke.Xb],je=ke.m,Ve=ke;for(He=0;He<Ve.za;++He){var Ze=je,Ye=Ve,pt=Ye.Ac,ct=Ye.Bc+4*He,Pt=Ye.zc,ut=Ye.ya[Ye.aa+He];if(Ye.Qa.Bb?ut.$b=q(Ze,Ye.Pa.jb[0])?2+q(Ze,Ye.Pa.jb[2]):q(Ze,Ye.Pa.jb[1]):ut.$b=0,Ye.kc&&(ut.Ad=q(Ze,Ye.Bd)),ut.Za=!q(Ze,145)+0,ut.Za){var ar=ut.Ob,lr=0;for(Ye=0;4>Ye;++Ye){var Zt,Yt=Pt[0+Ye];for(Zt=0;4>Zt;++Zt){Yt=oO[pt[ct+Zt]][Yt];for(var br=Tw[q(Ze,Yt[0])];0<br;)br=Tw[2*br+q(Ze,Yt[br])];Yt=-br,pt[ct+Zt]=Yt}n(ar,lr,pt,ct,4),lr+=4,Pt[0+Ye]=Yt}}else Yt=q(Ze,156)?q(Ze,128)?1:3:q(Ze,163)?2:0,ut.Ob[0]=Yt,a(pt,ct,Yt,4),a(Pt,0,Yt,4);ut.Dd=q(Ze,142)?q(Ze,114)?q(Ze,183)?1:3:2:0}if(Ve.m.Ka)return en(ke,7,"Premature end-of-partition0 encountered.");for(;ke.ja<ke.za;++ke.ja){if(Ve=Ne,Ze=(je=ke).rb[je.sb-1],pt=je.rb[je.sb+je.ja],He=je.ya[je.aa+je.ja],ct=je.kc?He.Ad:0)Ze.la=pt.la=0,He.Za||(Ze.Na=pt.Na=0),He.Hc=0,He.Gc=0,He.ia=0;else{var gr,Wt;if(Ze=pt,pt=Ve,ct=je.Pa.Xc,Pt=je.ya[je.aa+je.ja],ut=je.pb[Pt.$b],Ye=Pt.ad,ar=0,lr=je.rb[je.sb-1],Yt=Zt=0,a(Ye,ar,0,384),Pt.Za)var pn=0,Ma=ct[3];else{br=i(16);var mn=Ze.Na+lr.Na;if(mn=rf(pt,ct[1],mn,ut.Eb,0,br,0),Ze.Na=lr.Na=(0<mn)+0,1<mn)Nc(br,0,Ye,ar);else{var Ra=br[0]+3>>3;for(br=0;256>br;br+=16)Ye[ar+br]=Ra}pn=1,Ma=ct[0]}var cr=15&Ze.la,Xa=15&lr.la;for(br=0;4>br;++br){var Ja=1&Xa;for(Ra=Wt=0;4>Ra;++Ra)cr=cr>>1|(Ja=(mn=rf(pt,Ma,mn=Ja+(1&cr),ut.Sc,pn,Ye,ar))>pn)<<7,Wt=Wt<<2|(3<mn?3:1<mn?2:Ye[ar+0]!=0),ar+=16;cr>>=4,Xa=Xa>>1|Ja<<7,Zt=(Zt<<8|Wt)>>>0}for(Ma=cr,pn=Xa>>4,gr=0;4>gr;gr+=2){for(Wt=0,cr=Ze.la>>4+gr,Xa=lr.la>>4+gr,br=0;2>br;++br){for(Ja=1&Xa,Ra=0;2>Ra;++Ra)mn=Ja+(1&cr),cr=cr>>1|(Ja=0<(mn=rf(pt,ct[2],mn,ut.Qc,0,Ye,ar)))<<3,Wt=Wt<<2|(3<mn?3:1<mn?2:Ye[ar+0]!=0),ar+=16;cr>>=2,Xa=Xa>>1|Ja<<5}Yt|=Wt<<4*gr,Ma|=cr<<4<<gr,pn|=(240&Xa)<<gr}Ze.la=Ma,lr.la=pn,Pt.Hc=Zt,Pt.Gc=Yt,Pt.ia=43690&Yt?0:ut.ia,ct=!(Zt|Yt)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[He.$b][He.Za],je.wa[je.Y+je.ja].La|=!ct),Ve.Ka)return en(ke,7,"Premature end-of-file encountered.")}if(Fu(ke),je=Ke,Ve=1,He=(Ne=ke).D,Ze=0<Ne.L&&Ne.M>=Ne.zb&&Ne.M<=Ne.Va,Ne.Aa==0)e:{if(He.M=Ne.M,He.uc=Ze,Vu(Ne,He),Ve=1,He=(Wt=Ne.D).Nb,Ze=(Yt=N0[Ne.L])*Ne.R,pt=Yt/2*Ne.B,br=16*He*Ne.R,Ra=8*He*Ne.B,ct=Ne.sa,Pt=Ne.ta-Ze+br,ut=Ne.qa,Ye=Ne.ra-pt+Ra,ar=Ne.Ha,lr=Ne.Ia-pt+Ra,Xa=(cr=Wt.M)==0,Zt=cr>=Ne.Va-1,Ne.Aa==2&&Vu(Ne,Wt),Wt.uc)for(Ja=(mn=Ne).D.M,t(mn.D.uc),Wt=mn.yb;Wt<mn.Hb;++Wt){pn=Wt,Ma=Ja;var In=(Vn=(qr=mn).D).Nb;gr=qr.R;var Vn=Vn.wa[Vn.Y+pn],Na=qr.sa,xi=qr.ta+16*In*gr+16*pn,fs=Vn.dd,Ln=Vn.tc;if(Ln!=0)if(t(3<=Ln),qr.L==1)0<pn&&jo(Na,xi,gr,Ln+4),Vn.La&&hi(Na,xi,gr,Ln),0<Ma&&gl(Na,xi,gr,Ln+4),Vn.La&&ef(Na,xi,gr,Ln);else{var Rs=qr.B,xl=qr.qa,Ec=qr.ra+8*In*Rs+8*pn,Co=qr.Ha,qr=qr.Ia+8*In*Rs+8*pn;In=Vn.ld,0<pn&&(p0(Na,xi,gr,Ln+4,fs,In),hl(xl,Ec,Co,qr,Rs,Ln+4,fs,In)),Vn.La&&(Ao(Na,xi,gr,Ln,fs,In),jc(xl,Ec,Co,qr,Rs,Ln,fs,In)),0<Ma&&(Ac(Na,xi,gr,Ln+4,fs,In),Qu(xl,Ec,Co,qr,Rs,Ln+4,fs,In)),Vn.La&&(pl(Na,xi,gr,Ln,fs,In),ml(xl,Ec,Co,qr,Rs,Ln,fs,In))}}if(Ne.ia&&alert("todo:DitherRow"),je.put!=null){if(Wt=16*cr,cr=16*(cr+1),Xa?(je.y=Ne.sa,je.O=Ne.ta+br,je.f=Ne.qa,je.N=Ne.ra+Ra,je.ea=Ne.Ha,je.W=Ne.Ia+Ra):(Wt-=Yt,je.y=ct,je.O=Pt,je.f=ut,je.N=Ye,je.ea=ar,je.W=lr),Zt||(cr-=Yt),cr>je.o&&(cr=je.o),je.F=null,je.J=null,Ne.Fa!=null&&0<Ne.Fa.length&&Wt<cr&&(je.J=qu(Ne,je,Wt,cr-Wt),je.F=Ne.mb,je.F==null&&je.F.length==0)){Ve=en(Ne,3,"Could not decode alpha data.");break e}Wt<je.j&&(Yt=je.j-Wt,Wt=je.j,t(!(1&Yt)),je.O+=Ne.R*Yt,je.N+=Ne.B*(Yt>>1),je.W+=Ne.B*(Yt>>1),je.F!=null&&(je.J+=je.width*Yt)),Wt<cr&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=Wt-je.j,je.U=je.va-je.v,je.T=cr-Wt,Ve=je.put(je))}He+1!=Ne.Ic||Zt||(n(Ne.sa,Ne.ta-Ze,ct,Pt+16*Ne.R,Ze),n(Ne.qa,Ne.ra-pt,ut,Ye+8*Ne.B,pt),n(Ne.Ha,Ne.Ia-pt,ar,lr+8*Ne.B,pt))}if(!Ve)return en(ke,6,"Output aborted.")}return 1})(v,w)),w.bc!=null&&w.bc(w),T&=1}return T?(v.cb=0,T):0}function Ri(v,w,T,B,ee){ee=v[w+T+32*B]+(ee>>3),v[w+T+32*B]=-256&ee?0>ee?0:255:ee}function uc(v,w,T,B,ee,ne){Ri(v,w,0,T,B+ee),Ri(v,w,1,T,B+ne),Ri(v,w,2,T,B-ne),Ri(v,w,3,T,B-ee)}function Ia(v){return(20091*v>>16)+v}function Iu(v,w,T,B){var ee,ne=0,ie=i(16);for(ee=0;4>ee;++ee){var oe=v[w+0]+v[w+8],le=v[w+0]-v[w+8],de=(35468*v[w+4]>>16)-Ia(v[w+12]),_e=Ia(v[w+4])+(35468*v[w+12]>>16);ie[ne+0]=oe+_e,ie[ne+1]=le+de,ie[ne+2]=le-de,ie[ne+3]=oe-_e,ne+=4,w++}for(ee=ne=0;4>ee;++ee)oe=(v=ie[ne+0]+4)+ie[ne+8],le=v-ie[ne+8],de=(35468*ie[ne+4]>>16)-Ia(ie[ne+12]),Ri(T,B,0,0,oe+(_e=Ia(ie[ne+4])+(35468*ie[ne+12]>>16))),Ri(T,B,1,0,le+de),Ri(T,B,2,0,le-de),Ri(T,B,3,0,oe-_e),ne++,B+=32}function Jd(v,w,T,B){var ee=v[w+0]+4,ne=35468*v[w+4]>>16,ie=Ia(v[w+4]),oe=35468*v[w+1]>>16;uc(T,B,0,ee+ie,v=Ia(v[w+1]),oe),uc(T,B,1,ee+ne,v,oe),uc(T,B,2,ee-ne,v,oe),uc(T,B,3,ee-ie,v,oe)}function Qm(v,w,T,B,ee){Iu(v,w,T,B),ee&&Iu(v,w+16,T,B+4)}function Zd(v,w,T,B){Ls(v,w+0,T,B,1),Ls(v,w+32,T,B+128,1)}function eg(v,w,T,B){var ee;for(v=v[w+0]+4,ee=0;4>ee;++ee)for(w=0;4>w;++w)Ri(T,B,w,ee,v)}function Qd(v,w,T,B){v[w+0]&&_a(v,w+0,T,B),v[w+16]&&_a(v,w+16,T,B+4),v[w+32]&&_a(v,w+32,T,B+128),v[w+48]&&_a(v,w+48,T,B+128+4)}function tg(v,w,T,B){var ee,ne=i(16);for(ee=0;4>ee;++ee){var ie=v[w+0+ee]+v[w+12+ee],oe=v[w+4+ee]+v[w+8+ee],le=v[w+4+ee]-v[w+8+ee],de=v[w+0+ee]-v[w+12+ee];ne[0+ee]=ie+oe,ne[8+ee]=ie-oe,ne[4+ee]=de+le,ne[12+ee]=de-le}for(ee=0;4>ee;++ee)ie=(v=ne[0+4*ee]+3)+ne[3+4*ee],oe=ne[1+4*ee]+ne[2+4*ee],le=ne[1+4*ee]-ne[2+4*ee],de=v-ne[3+4*ee],T[B+0]=ie+oe>>3,T[B+16]=de+le>>3,T[B+32]=ie-oe>>3,T[B+48]=de-le>>3,B+=64}function Lu(v,w,T){var B,ee=w-32,ne=Ka,ie=255-v[ee-1];for(B=0;B<T;++B){var oe,le=ne,de=ie+v[w-1];for(oe=0;oe<T;++oe)v[w+oe]=le[de+v[ee+oe]];w+=32}}function rg(v,w){Lu(v,w,4)}function ng(v,w){Lu(v,w,8)}function ag(v,w){Lu(v,w,16)}function Ps(v,w){var T;for(T=0;16>T;++T)n(v,w+32*T,v,w-32,16)}function fc(v,w){var T;for(T=16;0<T;--T)a(v,w,v[w-1],16),w+=32}function dc(v,w,T){var B;for(B=0;16>B;++B)a(w,T+32*B,v,16)}function e0(v,w){var T,B=16;for(T=0;16>T;++T)B+=v[w-1+32*T]+v[w+T-32];dc(B>>5,v,w)}function ea(v,w){var T,B=8;for(T=0;16>T;++T)B+=v[w-1+32*T];dc(B>>4,v,w)}function ig(v,w){var T,B=8;for(T=0;16>T;++T)B+=v[w+T-32];dc(B>>4,v,w)}function t0(v,w){dc(128,v,w)}function Bt(v,w,T){return v+2*w+T+2>>2}function sg(v,w){var T,B=w-32;for(B=new Uint8Array([Bt(v[B-1],v[B+0],v[B+1]),Bt(v[B+0],v[B+1],v[B+2]),Bt(v[B+1],v[B+2],v[B+3]),Bt(v[B+2],v[B+3],v[B+4])]),T=0;4>T;++T)n(v,w+32*T,B,0,B.length)}function og(v,w){var T=v[w-1],B=v[w-1+32],ee=v[w-1+64],ne=v[w-1+96];Q(v,w+0,16843009*Bt(v[w-1-32],T,B)),Q(v,w+32,16843009*Bt(T,B,ee)),Q(v,w+64,16843009*Bt(B,ee,ne)),Q(v,w+96,16843009*Bt(ee,ne,ne))}function ls(v,w){var T,B=4;for(T=0;4>T;++T)B+=v[w+T-32]+v[w-1+32*T];for(B>>=3,T=0;4>T;++T)a(v,w+32*T,B,4)}function r0(v,w){var T=v[w-1+0],B=v[w-1+32],ee=v[w-1+64],ne=v[w-1-32],ie=v[w+0-32],oe=v[w+1-32],le=v[w+2-32],de=v[w+3-32];v[w+0+96]=Bt(B,ee,v[w-1+96]),v[w+1+96]=v[w+0+64]=Bt(T,B,ee),v[w+2+96]=v[w+1+64]=v[w+0+32]=Bt(ne,T,B),v[w+3+96]=v[w+2+64]=v[w+1+32]=v[w+0+0]=Bt(ie,ne,T),v[w+3+64]=v[w+2+32]=v[w+1+0]=Bt(oe,ie,ne),v[w+3+32]=v[w+2+0]=Bt(le,oe,ie),v[w+3+0]=Bt(de,le,oe)}function n0(v,w){var T=v[w+1-32],B=v[w+2-32],ee=v[w+3-32],ne=v[w+4-32],ie=v[w+5-32],oe=v[w+6-32],le=v[w+7-32];v[w+0+0]=Bt(v[w+0-32],T,B),v[w+1+0]=v[w+0+32]=Bt(T,B,ee),v[w+2+0]=v[w+1+32]=v[w+0+64]=Bt(B,ee,ne),v[w+3+0]=v[w+2+32]=v[w+1+64]=v[w+0+96]=Bt(ee,ne,ie),v[w+3+32]=v[w+2+64]=v[w+1+96]=Bt(ne,ie,oe),v[w+3+64]=v[w+2+96]=Bt(ie,oe,le),v[w+3+96]=Bt(oe,le,le)}function hc(v,w){var T=v[w-1+0],B=v[w-1+32],ee=v[w-1+64],ne=v[w-1-32],ie=v[w+0-32],oe=v[w+1-32],le=v[w+2-32],de=v[w+3-32];v[w+0+0]=v[w+1+64]=ne+ie+1>>1,v[w+1+0]=v[w+2+64]=ie+oe+1>>1,v[w+2+0]=v[w+3+64]=oe+le+1>>1,v[w+3+0]=le+de+1>>1,v[w+0+96]=Bt(ee,B,T),v[w+0+64]=Bt(B,T,ne),v[w+0+32]=v[w+1+96]=Bt(T,ne,ie),v[w+1+32]=v[w+2+96]=Bt(ne,ie,oe),v[w+2+32]=v[w+3+96]=Bt(ie,oe,le),v[w+3+32]=Bt(oe,le,de)}function Du(v,w){var T=v[w+0-32],B=v[w+1-32],ee=v[w+2-32],ne=v[w+3-32],ie=v[w+4-32],oe=v[w+5-32],le=v[w+6-32],de=v[w+7-32];v[w+0+0]=T+B+1>>1,v[w+1+0]=v[w+0+64]=B+ee+1>>1,v[w+2+0]=v[w+1+64]=ee+ne+1>>1,v[w+3+0]=v[w+2+64]=ne+ie+1>>1,v[w+0+32]=Bt(T,B,ee),v[w+1+32]=v[w+0+96]=Bt(B,ee,ne),v[w+2+32]=v[w+1+96]=Bt(ee,ne,ie),v[w+3+32]=v[w+2+96]=Bt(ne,ie,oe),v[w+3+64]=Bt(ie,oe,le),v[w+3+96]=Bt(oe,le,de)}function lg(v,w){var T=v[w-1+0],B=v[w-1+32],ee=v[w-1+64],ne=v[w-1+96];v[w+0+0]=T+B+1>>1,v[w+2+0]=v[w+0+32]=B+ee+1>>1,v[w+2+32]=v[w+0+64]=ee+ne+1>>1,v[w+1+0]=Bt(T,B,ee),v[w+3+0]=v[w+1+32]=Bt(B,ee,ne),v[w+3+32]=v[w+1+64]=Bt(ee,ne,ne),v[w+3+64]=v[w+2+64]=v[w+0+96]=v[w+1+96]=v[w+2+96]=v[w+3+96]=ne}function cg(v,w){var T=v[w-1+0],B=v[w-1+32],ee=v[w-1+64],ne=v[w-1+96],ie=v[w-1-32],oe=v[w+0-32],le=v[w+1-32],de=v[w+2-32];v[w+0+0]=v[w+2+32]=T+ie+1>>1,v[w+0+32]=v[w+2+64]=B+T+1>>1,v[w+0+64]=v[w+2+96]=ee+B+1>>1,v[w+0+96]=ne+ee+1>>1,v[w+3+0]=Bt(oe,le,de),v[w+2+0]=Bt(ie,oe,le),v[w+1+0]=v[w+3+32]=Bt(T,ie,oe),v[w+1+32]=v[w+3+64]=Bt(B,T,ie),v[w+1+64]=v[w+3+96]=Bt(ee,B,T),v[w+1+96]=Bt(ne,ee,B)}function ug(v,w){var T;for(T=0;8>T;++T)n(v,w+32*T,v,w-32,8)}function Mu(v,w){var T;for(T=0;8>T;++T)a(v,w,v[w-1],8),w+=32}function ll(v,w,T){var B;for(B=0;8>B;++B)a(w,T+32*B,v,8)}function bo(v,w){var T,B=8;for(T=0;8>T;++T)B+=v[w+T-32]+v[w-1+32*T];ll(B>>4,v,w)}function fg(v,w){var T,B=4;for(T=0;8>T;++T)B+=v[w+T-32];ll(B>>3,v,w)}function cl(v,w){var T,B=4;for(T=0;8>T;++T)B+=v[w-1+32*T];ll(B>>3,v,w)}function Ru(v,w){ll(128,v,w)}function pc(v,w,T){var B=v[w-T],ee=v[w+0],ne=3*(ee-B)+xg[1020+v[w-2*T]-v[w+T]],ie=g0[112+(ne+4>>3)];v[w-T]=Ka[255+B+g0[112+(ne+3>>3)]],v[w+0]=Ka[255+ee-ie]}function a0(v,w,T,B){var ee=v[w+0],ne=v[w+T];return mi[255+v[w-2*T]-v[w-T]]>B||mi[255+ne-ee]>B}function i0(v,w,T,B){return 4*mi[255+v[w-T]-v[w+0]]+mi[255+v[w-2*T]-v[w+T]]<=B}function s0(v,w,T,B,ee){var ne=v[w-3*T],ie=v[w-2*T],oe=v[w-T],le=v[w+0],de=v[w+T],_e=v[w+2*T],Le=v[w+3*T];return 4*mi[255+oe-le]+mi[255+ie-de]>B?0:mi[255+v[w-4*T]-ne]<=ee&&mi[255+ne-ie]<=ee&&mi[255+ie-oe]<=ee&&mi[255+Le-_e]<=ee&&mi[255+_e-de]<=ee&&mi[255+de-le]<=ee}function o0(v,w,T,B){var ee=2*B+1;for(B=0;16>B;++B)i0(v,w+B,T,ee)&&pc(v,w+B,T)}function cs(v,w,T,B){var ee=2*B+1;for(B=0;16>B;++B)i0(v,w+B*T,1,ee)&&pc(v,w+B*T,1)}function Os(v,w,T,B){var ee;for(ee=3;0<ee;--ee)o0(v,w+=4*T,T,B)}function dg(v,w,T,B){var ee;for(ee=3;0<ee;--ee)cs(v,w+=4,T,B)}function wo(v,w,T,B,ee,ne,ie,oe){for(ne=2*ne+1;0<ee--;){if(s0(v,w,T,ne,ie))if(a0(v,w,T,oe))pc(v,w,T);else{var le=v,de=w,_e=T,Le=le[de-2*_e],De=le[de-_e],ke=le[de+0],Ke=le[de+_e],He=le[de+2*_e],Ne=27*(Ve=xg[1020+3*(ke-De)+xg[1020+Le-Ke]])+63>>7,je=18*Ve+63>>7,Ve=9*Ve+63>>7;le[de-3*_e]=Ka[255+le[de-3*_e]+Ve],le[de-2*_e]=Ka[255+Le+je],le[de-_e]=Ka[255+De+Ne],le[de+0]=Ka[255+ke-Ne],le[de+_e]=Ka[255+Ke-je],le[de+2*_e]=Ka[255+He-Ve]}w+=B}}function Bi(v,w,T,B,ee,ne,ie,oe){for(ne=2*ne+1;0<ee--;){if(s0(v,w,T,ne,ie))if(a0(v,w,T,oe))pc(v,w,T);else{var le=v,de=w,_e=T,Le=le[de-_e],De=le[de+0],ke=le[de+_e],Ke=g0[112+((He=3*(De-Le))+4>>3)],He=g0[112+(He+3>>3)],Ne=Ke+1>>1;le[de-2*_e]=Ka[255+le[de-2*_e]+Ne],le[de-_e]=Ka[255+Le+He],le[de+0]=Ka[255+De-Ke],le[de+_e]=Ka[255+ke-Ne]}w+=B}}function Bu(v,w,T,B,ee,ne){wo(v,w,T,1,16,B,ee,ne)}function ul(v,w,T,B,ee,ne){wo(v,w,1,T,16,B,ee,ne)}function hg(v,w,T,B,ee,ne){var ie;for(ie=3;0<ie;--ie)Bi(v,w+=4*T,T,1,16,B,ee,ne)}function mc(v,w,T,B,ee,ne){var ie;for(ie=3;0<ie;--ie)Bi(v,w+=4,1,T,16,B,ee,ne)}function pg(v,w,T,B,ee,ne,ie,oe){wo(v,w,ee,1,8,ne,ie,oe),wo(T,B,ee,1,8,ne,ie,oe)}function Uu(v,w,T,B,ee,ne,ie,oe){wo(v,w,1,ee,8,ne,ie,oe),wo(T,B,1,ee,8,ne,ie,oe)}function zu(v,w,T,B,ee,ne,ie,oe){Bi(v,w+4*ee,ee,1,8,ne,ie,oe),Bi(T,B+4*ee,ee,1,8,ne,ie,oe)}function l0(v,w,T,B,ee,ne,ie,oe){Bi(v,w+4,1,ee,8,ne,ie,oe),Bi(T,B+4,1,ee,8,ne,ie,oe)}function gc(){this.ba=new Oa,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new or,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function $u(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Wu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function c0(){this.ua=0,this.Wa=new re,this.vb=new re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new j}function mg(){this.xb=this.a=0,this.l=new os,this.ca=new Oa,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new c0,this.ab=0,this.gc=s(4,Wu),this.Oc=0}function xc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new os,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function fl(v,w,T,B,ee,ne,ie){for(v=v==null?0:v[w+0],w=0;w<ie;++w)ee[ne+w]=v+T[B+w]&255,v=ee[ne+w]}function Hu(v,w,T,B,ee,ne,ie){var oe;if(v==null)fl(null,null,T,B,ee,ne,ie);else for(oe=0;oe<ie;++oe)ee[ne+oe]=v[w+oe]+T[B+oe]&255}function So(v,w,T,B,ee,ne,ie){if(v==null)fl(null,null,T,B,ee,ne,ie);else{var oe,le=v[w+0],de=le,_e=le;for(oe=0;oe<ie;++oe)de=_e+(le=v[w+oe])-de,_e=T[B+oe]+(-256&de?0>de?0:255:de)&255,de=le,ee[ne+oe]=_e}}function qu(v,w,T,B){var ee=w.width,ne=w.o;if(t(v!=null&&w!=null),0>T||0>=B||T+B>ne)return null;if(!v.Cc){if(v.ga==null){var ie;if(v.ga=new xc,(ie=v.ga==null)||(ie=w.width*w.o,t(v.Gb.length==0),v.Gb=i(ie),v.Uc=0,v.Gb==null?ie=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,ie=1),ie=!ie),!ie){ie=v.ga;var oe=v.Fa,le=v.P,de=v.qc,_e=v.mb,Le=v.nb,De=le+1,ke=de-1,Ke=ie.l;if(t(oe!=null&&_e!=null&&w!=null),Eo[0]=null,Eo[1]=fl,Eo[2]=Hu,Eo[3]=So,ie.ca=_e,ie.tb=Le,ie.c=w.width,ie.i=w.height,t(0<ie.c&&0<ie.i),1>=de)w=0;else if(ie.$a=oe[le+0]>>0&3,ie.Z=oe[le+0]>>2&3,ie.Lc=oe[le+0]>>4&3,le=oe[le+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||le)w=0;else if(Ke.put=wa,Ke.ac=Zr,Ke.bc=ui,Ke.ma=ie,Ke.width=w.width,Ke.height=w.height,Ke.Da=w.Da,Ke.v=w.v,Ke.va=w.va,Ke.j=w.j,Ke.o=w.o,ie.$a)e:{t(ie.$a==1),w=We();t:for(;;){if(w==null){w=0;break e}if(t(ie!=null),ie.mc=w,w.c=ie.c,w.i=ie.i,w.l=ie.l,w.l.ma=ie,w.l.width=ie.c,w.l.height=ie.i,w.a=0,K(w.m,oe,De,ke),!Fe(ie.c,ie.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&ce(w.s)?(ie.ic=1,oe=w.c*w.i,w.Ta=null,w.Ua=0,w.V=i(oe),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ie.ic=0,w=Me(w,ie.c)),!w))break t;w=1;break e}ie.mc=null,w=0}else w=ke>=ie.c*ie.i;ie=!w}if(ie)return null;v.ga.Lc!=1?v.Ga=0:B=ne-T}t(v.ga!=null),t(T+B<=ne);e:{if(w=(oe=v.ga).c,ne=oe.l.o,oe.$a==0){if(De=v.rc,ke=v.Vc,Ke=v.Fa,le=v.P+1+T*w,de=v.mb,_e=v.nb+T*w,t(le<=v.P+v.qc),oe.Z!=0)for(t(Eo[oe.Z]!=null),ie=0;ie<B;++ie)Eo[oe.Z](De,ke,Ke,le,de,_e,w),De=de,ke=_e,_e+=w,le+=w;else for(ie=0;ie<B;++ie)n(de,_e,Ke,le,w),De=de,ke=_e,_e+=w,le+=w;v.rc=De,v.Vc=ke}else{if(t(oe.mc!=null),w=T+B,t((ie=oe.mc)!=null),t(w<=ie.i),ie.C>=w)w=1;else if(oe.ic||Pe(),oe.ic){oe=ie.V,De=ie.Ba,ke=ie.c;var He=ie.i,Ne=(Ke=1,le=ie.$/ke,de=ie.$%ke,_e=ie.m,Le=ie.s,ie.$),je=ke*He,Ve=ke*w,Ze=Le.wc,Ye=Ne<Ve?Wr(Le,de,le):null;t(Ne<=je),t(w<=He),t(ce(Le));t:for(;;){for(;!_e.h&&Ne<Ve;){if(de&Ze||(Ye=Wr(Le,de,le)),t(Ye!=null),R(_e),256>(He=Qn(Ye.G[0],Ye.H[0],_e)))oe[De+Ne]=He,++Ne,++de>=ke&&(de=0,++le<=w&&!(le%16)&&he(ie,le));else{if(!(280>He)){Ke=0;break t}He=Ga(He-256,_e);var pt,ct=Qn(Ye.G[4],Ye.H[4],_e);if(R(_e),!(Ne>=(ct=Fa(ke,ct=Ga(ct,_e)))&&je-Ne>=He)){Ke=0;break t}for(pt=0;pt<He;++pt)oe[De+Ne+pt]=oe[De+Ne+pt-ct];for(Ne+=He,de+=He;de>=ke;)de-=ke,++le<=w&&!(le%16)&&he(ie,le);Ne<Ve&&de&Ze&&(Ye=Wr(Le,de,le))}t(_e.h==P(_e))}he(ie,le>w?w:le);break t}!Ke||_e.h&&Ne<je?(Ke=0,ie.a=_e.h?5:3):ie.$=Ne,w=Ke}else w=me(ie,ie.V,ie.Ba,ie.c,ie.i,w,Be);if(!w){B=0;break e}}T+B>=ne&&(v.Cc=1),B=1}if(!B)return null;if(v.Cc&&((B=v.ga)!=null&&(B.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+T*ee}function N(v,w,T,B,ee,ne){for(;0<ee--;){var ie,oe=v,le=w+(T?1:0),de=v,_e=w+(T?0:3);for(ie=0;ie<B;++ie){var Le=de[_e+4*ie];Le!=255&&(Le*=32897,oe[le+4*ie+0]=oe[le+4*ie+0]*Le>>23,oe[le+4*ie+1]=oe[le+4*ie+1]*Le>>23,oe[le+4*ie+2]=oe[le+4*ie+2]*Le>>23)}w+=ne}}function te(v,w,T,B,ee){for(;0<B--;){var ne;for(ne=0;ne<T;++ne){var ie=v[w+2*ne+0],oe=15&(de=v[w+2*ne+1]),le=4369*oe,de=(240&de|de>>4)*le>>16;v[w+2*ne+0]=(240&ie|ie>>4)*le>>16&240|(15&ie|ie<<4)*le>>16>>4&15,v[w+2*ne+1]=240&de|oe}w+=ee}}function ge(v,w,T,B,ee,ne,ie,oe){var le,de,_e=255;for(de=0;de<ee;++de){for(le=0;le<B;++le){var Le=v[w+le];ne[ie+4*le]=Le,_e&=Le}w+=T,ie+=oe}return _e!=255}function Se(v,w,T,B,ee){var ne;for(ne=0;ne<ee;++ne)T[B+ne]=v[w+ne]>>8}function Pe(){pi=N,_r=te,Nr=ge,rn=Se}function qe(v,w,T){C[v]=function(B,ee,ne,ie,oe,le,de,_e,Le,De,ke,Ke,He,Ne,je,Ve,Ze){var Ye,pt=Ze-1>>1,ct=oe[le+0]|de[_e+0]<<16,Pt=Le[De+0]|ke[Ke+0]<<16;t(B!=null);var ut=3*ct+Pt+131074>>2;for(w(B[ee+0],255&ut,ut>>16,He,Ne),ne!=null&&(ut=3*Pt+ct+131074>>2,w(ne[ie+0],255&ut,ut>>16,je,Ve)),Ye=1;Ye<=pt;++Ye){var ar=oe[le+Ye]|de[_e+Ye]<<16,lr=Le[De+Ye]|ke[Ke+Ye]<<16,Zt=ct+ar+Pt+lr+524296,Yt=Zt+2*(ar+Pt)>>3;ut=Yt+ct>>1,ct=(Zt=Zt+2*(ct+lr)>>3)+ar>>1,w(B[ee+2*Ye-1],255&ut,ut>>16,He,Ne+(2*Ye-1)*T),w(B[ee+2*Ye-0],255&ct,ct>>16,He,Ne+(2*Ye-0)*T),ne!=null&&(ut=Zt+Pt>>1,ct=Yt+lr>>1,w(ne[ie+2*Ye-1],255&ut,ut>>16,je,Ve+(2*Ye-1)*T),w(ne[ie+2*Ye+0],255&ct,ct>>16,je,Ve+(2*Ye+0)*T)),ct=ar,Pt=lr}1&Ze||(ut=3*ct+Pt+131074>>2,w(B[ee+Ze-1],255&ut,ut>>16,He,Ne+(Ze-1)*T),ne!=null&&(ut=3*Pt+ct+131074>>2,w(ne[ie+Ze-1],255&ut,ut>>16,je,Ve+(Ze-1)*T)))}}function et(){gi[x0]=fO,gi[v0]=Ow,gi[kw]=dO,gi[y0]=Fw,gi[b0]=Iw,gi[vg]=Lw,gi[Ew]=hO,gi[yg]=Ow,gi[bg]=Fw,gi[w0]=Iw,gi[wg]=Lw}function ht(v){return v&-16384?0>v?0:255:v>>pO}function At(v,w){return ht((19077*v>>8)+(26149*w>>8)-14234)}function $t(v,w,T){return ht((19077*v>>8)-(6419*w>>8)-(13320*T>>8)+8708)}function Ut(v,w){return ht((19077*v>>8)+(33050*w>>8)-17685)}function Xt(v,w,T,B,ee){B[ee+0]=At(v,T),B[ee+1]=$t(v,w,T),B[ee+2]=Ut(v,w)}function Rr(v,w,T,B,ee){B[ee+0]=Ut(v,w),B[ee+1]=$t(v,w,T),B[ee+2]=At(v,T)}function Hr(v,w,T,B,ee){var ne=$t(v,w,T);w=ne<<3&224|Ut(v,w)>>3,B[ee+0]=248&At(v,T)|ne>>5,B[ee+1]=w}function hn(v,w,T,B,ee){var ne=240&Ut(v,w)|15;B[ee+0]=240&At(v,T)|$t(v,w,T)>>4,B[ee+1]=ne}function ta(v,w,T,B,ee){B[ee+0]=255,Xt(v,w,T,B,ee+1)}function Fn(v,w,T,B,ee){Rr(v,w,T,B,ee),B[ee+3]=255}function Ui(v,w,T,B,ee){Xt(v,w,T,B,ee),B[ee+3]=255}function Ya(v,w){return 0>v?0:v>w?w:v}function us(v,w,T){C[v]=function(B,ee,ne,ie,oe,le,de,_e,Le){for(var De=_e+(-2&Le)*T;_e!=De;)w(B[ee+0],ne[ie+0],oe[le+0],de,_e),w(B[ee+1],ne[ie+0],oe[le+0],de,_e+T),ee+=2,++ie,++le,_e+=2*T;1&Le&&w(B[ee+0],ne[ie+0],oe[le+0],de,_e)}}function u0(v,w,T){return T==0?v==0?w==0?6:5:w==0?4:0:T}function Gu(v,w,T,B,ee){switch(v>>>30){case 3:Ls(w,T,B,ee,0);break;case 2:tn(w,T,B,ee);break;case 1:_a(w,T,B,ee)}}function Vu(v,w){var T,B,ee=w.M,ne=w.Nb,ie=v.oc,oe=v.pc+40,le=v.oc,de=v.pc+584,_e=v.oc,Le=v.pc+600;for(T=0;16>T;++T)ie[oe+32*T-1]=129;for(T=0;8>T;++T)le[de+32*T-1]=129,_e[Le+32*T-1]=129;for(0<ee?ie[oe-1-32]=le[de-1-32]=_e[Le-1-32]=129:(a(ie,oe-32-1,127,21),a(le,de-32-1,127,9),a(_e,Le-32-1,127,9)),B=0;B<v.za;++B){var De=w.ya[w.aa+B];if(0<B){for(T=-1;16>T;++T)n(ie,oe+32*T-4,ie,oe+32*T+12,4);for(T=-1;8>T;++T)n(le,de+32*T-4,le,de+32*T+4,4),n(_e,Le+32*T-4,_e,Le+32*T+4,4)}var ke=v.Gd,Ke=v.Hd+B,He=De.ad,Ne=De.Hc;if(0<ee&&(n(ie,oe-32,ke[Ke].y,0,16),n(le,de-32,ke[Ke].f,0,8),n(_e,Le-32,ke[Ke].ea,0,8)),De.Za){var je=ie,Ve=oe-32+16;for(0<ee&&(B>=v.za-1?a(je,Ve,ke[Ke].y[15],4):n(je,Ve,ke[Ke+1].y,0,4)),T=0;4>T;T++)je[Ve+128+T]=je[Ve+256+T]=je[Ve+384+T]=je[Ve+0+T];for(T=0;16>T;++T,Ne<<=2)je=ie,Ve=oe+Mw[T],zi[De.Ob[T]](je,Ve),Gu(Ne,He,16*+T,je,Ve)}else if(je=u0(B,ee,De.Ob[0]),ko[je](ie,oe),Ne!=0)for(T=0;16>T;++T,Ne<<=2)Gu(Ne,He,16*+T,ie,oe+Mw[T]);for(T=De.Gc,je=u0(B,ee,De.Dd),Ms[je](le,de),Ms[je](_e,Le),Ne=He,je=le,Ve=de,255&(De=T>>0)&&(170&De?Zu(Ne,256,je,Ve):di(Ne,256,je,Ve)),De=_e,Ne=Le,255&(T>>=8)&&(170&T?Zu(He,320,De,Ne):di(He,320,De,Ne)),ee<v.Ub-1&&(n(ke[Ke].y,0,ie,oe+480,16),n(ke[Ke].f,0,le,de+224,8),n(ke[Ke].ea,0,_e,Le+224,8)),T=8*ne*v.B,ke=v.sa,Ke=v.ta+16*B+16*ne*v.R,He=v.qa,De=v.ra+8*B+T,Ne=v.Ha,je=v.Ia+8*B+T,T=0;16>T;++T)n(ke,Ke+T*v.R,ie,oe+32*T,16);for(T=0;8>T;++T)n(He,De+T*v.B,le,de+32*T,8),n(Ne,je+T*v.B,_e,Le+32*T,8)}}function vc(v,w,T,B,ee,ne,ie,oe,le){var de=[0],_e=[0],Le=0,De=le!=null?le.kd:0,ke=le??new $u;if(v==null||12>T)return 7;ke.data=v,ke.w=w,ke.ha=T,w=[w],T=[T],ke.gb=[ke.gb];e:{var Ke=w,He=T,Ne=ke.gb;if(t(v!=null),t(He!=null),t(Ne!=null),Ne[0]=0,12<=He[0]&&!r(v,Ke[0],"RIFF")){if(r(v,Ke[0]+8,"WEBP")){Ne=3;break e}var je=Oe(v,Ke[0]+4);if(12>je||4294967286<je){Ne=3;break e}if(De&&je>He[0]-8){Ne=7;break e}Ne[0]=je,Ke[0]+=12,He[0]-=12}Ne=0}if(Ne!=0)return Ne;for(je=0<ke.gb[0],T=T[0];;){e:{var Ve=v;He=w,Ne=T;var Ze=de,Ye=_e,pt=Ke=[0];if((ut=Le=[Le])[0]=0,8>Ne[0])Ne=7;else{if(!r(Ve,He[0],"VP8X")){if(Oe(Ve,He[0]+4)!=10){Ne=3;break e}if(18>Ne[0]){Ne=7;break e}var ct=Oe(Ve,He[0]+8),Pt=1+V(Ve,He[0]+12);if(2147483648<=Pt*(Ve=1+V(Ve,He[0]+15))){Ne=3;break e}pt!=null&&(pt[0]=ct),Ze!=null&&(Ze[0]=Pt),Ye!=null&&(Ye[0]=Ve),He[0]+=18,Ne[0]-=18,ut[0]=1}Ne=0}}if(Le=Le[0],Ke=Ke[0],Ne!=0)return Ne;if(He=!!(2&Ke),!je&&Le)return 3;if(ne!=null&&(ne[0]=!!(16&Ke)),ie!=null&&(ie[0]=He),oe!=null&&(oe[0]=0),ie=de[0],Ke=_e[0],Le&&He&&le==null){Ne=0;break}if(4>T){Ne=7;break}if(je&&Le||!je&&!Le&&!r(v,w[0],"ALPH")){T=[T],ke.na=[ke.na],ke.P=[ke.P],ke.Sa=[ke.Sa];e:{ct=v,Ne=w,je=T;var ut=ke.gb;Ze=ke.na,Ye=ke.P,pt=ke.Sa,Pt=22,t(ct!=null),t(je!=null),Ve=Ne[0];var ar=je[0];for(t(Ze!=null),t(pt!=null),Ze[0]=null,Ye[0]=null,pt[0]=0;;){if(Ne[0]=Ve,je[0]=ar,8>ar){Ne=7;break e}var lr=Oe(ct,Ve+4);if(4294967286<lr){Ne=3;break e}var Zt=8+lr+1&-2;if(Pt+=Zt,0<ut&&Pt>ut){Ne=3;break e}if(!r(ct,Ve,"VP8 ")||!r(ct,Ve,"VP8L")){Ne=0;break e}if(ar[0]<Zt){Ne=7;break e}r(ct,Ve,"ALPH")||(Ze[0]=ct,Ye[0]=Ve+8,pt[0]=lr),Ve+=Zt,ar-=Zt}}if(T=T[0],ke.na=ke.na[0],ke.P=ke.P[0],ke.Sa=ke.Sa[0],Ne!=0)break}T=[T],ke.Ja=[ke.Ja],ke.xa=[ke.xa];e:if(ut=v,Ne=w,je=T,Ze=ke.gb[0],Ye=ke.Ja,pt=ke.xa,ct=Ne[0],Ve=!r(ut,ct,"VP8 "),Pt=!r(ut,ct,"VP8L"),t(ut!=null),t(je!=null),t(Ye!=null),t(pt!=null),8>je[0])Ne=7;else{if(Ve||Pt){if(ut=Oe(ut,ct+4),12<=Ze&&ut>Ze-12){Ne=3;break e}if(De&&ut>je[0]-8){Ne=7;break e}Ye[0]=ut,Ne[0]+=8,je[0]-=8,pt[0]=Pt}else pt[0]=5<=je[0]&&ut[ct+0]==47&&!(ut[ct+4]>>5),Ye[0]=je[0];Ne=0}if(T=T[0],ke.Ja=ke.Ja[0],ke.xa=ke.xa[0],w=w[0],Ne!=0)break;if(4294967286<ke.Ja)return 3;if(oe==null||He||(oe[0]=ke.xa?2:1),ie=[ie],Ke=[Ke],ke.xa){if(5>T){Ne=7;break}oe=ie,De=Ke,He=ne,v==null||5>T?v=0:5<=T&&v[w+0]==47&&!(v[w+4]>>5)?(je=[0],ut=[0],Ze=[0],K(Ye=new A,v,w,T),Tt(Ye,je,ut,Ze)?(oe!=null&&(oe[0]=je[0]),De!=null&&(De[0]=ut[0]),He!=null&&(He[0]=Ze[0]),v=1):v=0):v=0}else{if(10>T){Ne=7;break}oe=Ke,v==null||10>T||!Yd(v,w+3,T-3)?v=0:(De=v[w+0]|v[w+1]<<8|v[w+2]<<16,He=16383&(v[w+7]<<8|v[w+6]),v=16383&(v[w+9]<<8|v[w+8]),1&De||3<(De>>1&7)||!(De>>4&1)||De>>5>=ke.Ja||!He||!v?v=0:(ie&&(ie[0]=He),oe&&(oe[0]=v),v=1))}if(!v||(ie=ie[0],Ke=Ke[0],Le&&(de[0]!=ie||_e[0]!=Ke)))return 3;le!=null&&(le[0]=ke,le.offset=w-le.w,t(4294967286>w-le.w),t(le.offset==le.ha-T));break}return Ne==0||Ne==7&&Le&&le==null?(ne!=null&&(ne[0]|=ke.na!=null&&0<ke.na.length),B!=null&&(B[0]=ie),ee!=null&&(ee[0]=Ke),0):Ne}function Yu(v,w,T){var B=w.width,ee=w.height,ne=0,ie=0,oe=B,le=ee;if(w.Da=v!=null&&0<v.Da,w.Da&&(oe=v.cd,le=v.bd,ne=v.v,ie=v.j,11>T||(ne&=-2,ie&=-2),0>ne||0>ie||0>=oe||0>=le||ne+oe>B||ie+le>ee))return 0;if(w.v=ne,w.j=ie,w.va=ne+oe,w.o=ie+le,w.U=oe,w.T=le,w.da=v!=null&&0<v.da,w.da){if(!we(oe,le,T=[v.ib],ne=[v.hb]))return 0;w.ib=T[0],w.hb=ne[0]}return w.ob=v!=null&&v.ob,w.Kb=v==null||!v.Sd,w.da&&(w.ob=w.ib<3*B/4&&w.hb<3*ee/4,w.Kb=0),1}function Ku(v){if(v==null)return 2;if(11>v.S){var w=v.f.RGBA;w.fb+=(v.height-1)*w.A,w.A=-w.A}else w=v.f.kb,v=v.height,w.O+=(v-1)*w.fa,w.fa=-w.fa,w.N+=(v-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(v-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(v-1)*w.lb,w.lb=-w.lb);return 0}function yc(v,w,T,B){if(B==null||0>=v||0>=w)return 2;if(T!=null){if(T.Da){var ee=T.cd,ne=T.bd,ie=-2&T.v,oe=-2&T.j;if(0>ie||0>oe||0>=ee||0>=ne||ie+ee>v||oe+ne>w)return 2;v=ee,w=ne}if(T.da){if(!we(v,w,ee=[T.ib],ne=[T.hb]))return 2;v=ee[0],w=ne[0]}}B.width=v,B.height=w;e:{var le=B.width,de=B.height;if(v=B.S,0>=le||0>=de||!(v>=x0&&13>v))v=2;else{if(0>=B.Rd&&B.sd==null){ie=ne=ee=w=0;var _e=(oe=le*Rw[v])*de;if(11>v||(ne=(de+1)/2*(w=(le+1)/2),v==12&&(ie=(ee=le)*de)),(de=i(_e+2*ne+ie))==null){v=1;break e}B.sd=de,11>v?((le=B.f.RGBA).eb=de,le.fb=0,le.A=oe,le.size=_e):((le=B.f.kb).y=de,le.O=0,le.fa=oe,le.Fd=_e,le.f=de,le.N=0+_e,le.Ab=w,le.Cd=ne,le.ea=de,le.W=0+_e+ne,le.Db=w,le.Ed=ne,v==12&&(le.F=de,le.J=0+_e+2*ne),le.Tc=ie,le.lb=ee)}if(w=1,ee=B.S,ne=B.width,ie=B.height,ee>=x0&&13>ee)if(11>ee)v=B.f.RGBA,w&=(oe=Math.abs(v.A))*(ie-1)+ne<=v.size,w&=oe>=ne*Rw[ee],w&=v.eb!=null;else{v=B.f.kb,oe=(ne+1)/2,_e=(ie+1)/2,le=Math.abs(v.fa),de=Math.abs(v.Ab);var Le=Math.abs(v.Db),De=Math.abs(v.lb),ke=De*(ie-1)+ne;w&=le*(ie-1)+ne<=v.Fd,w&=de*(_e-1)+oe<=v.Cd,w=(w&=Le*(_e-1)+oe<=v.Ed)&le>=ne&de>=oe&Le>=oe,w&=v.y!=null,w&=v.f!=null,w&=v.ea!=null,ee==12&&(w&=De>=ne,w&=ke<=v.Tc,w&=v.F!=null)}else w=0;v=w?0:2}}return v!=0||T!=null&&T.fd&&(v=Ku(B)),v}var Gn=64,bc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],wc=24,Sc=32,Xu=8,La=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ce("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(v){return v},C.Predictor2=function(v,w,T){return w[T+0]},C.Predictor3=function(v,w,T){return w[T+1]},C.Predictor4=function(v,w,T){return w[T-1]},C.Predictor5=function(v,w,T){return $e($e(v,w[T+1]),w[T+0])},C.Predictor6=function(v,w,T){return $e(v,w[T-1])},C.Predictor7=function(v,w,T){return $e(v,w[T+0])},C.Predictor8=function(v,w,T){return $e(w[T-1],w[T+0])},C.Predictor9=function(v,w,T){return $e(w[T+0],w[T+1])},C.Predictor10=function(v,w,T){return $e($e(v,w[T-1]),$e(w[T+0],w[T+1]))},C.Predictor11=function(v,w,T){var B=w[T+0];return 0>=Qe(B>>24&255,v>>24&255,(w=w[T-1])>>24&255)+Qe(B>>16&255,v>>16&255,w>>16&255)+Qe(B>>8&255,v>>8&255,w>>8&255)+Qe(255&B,255&v,255&w)?B:v},C.Predictor12=function(v,w,T){var B=w[T+0];return(Ue((v>>24&255)+(B>>24&255)-((w=w[T-1])>>24&255))<<24|Ue((v>>16&255)+(B>>16&255)-(w>>16&255))<<16|Ue((v>>8&255)+(B>>8&255)-(w>>8&255))<<8|Ue((255&v)+(255&B)-(255&w)))>>>0},C.Predictor13=function(v,w,T){var B=w[T-1];return(Xe((v=$e(v,w[T+0]))>>24&255,B>>24&255)<<24|Xe(v>>16&255,B>>16&255)<<16|Xe(v>>8&255,B>>8&255)<<8|Xe(v>>0&255,B>>0&255))>>>0};var gg=C.PredictorAdd0;C.PredictorAdd1=bt,Ce("Predictor2","PredictorAdd2"),Ce("Predictor3","PredictorAdd3"),Ce("Predictor4","PredictorAdd4"),Ce("Predictor5","PredictorAdd5"),Ce("Predictor6","PredictorAdd6"),Ce("Predictor7","PredictorAdd7"),Ce("Predictor8","PredictorAdd8"),Ce("Predictor9","PredictorAdd9"),Ce("Predictor10","PredictorAdd10"),Ce("Predictor11","PredictorAdd11"),Ce("Predictor12","PredictorAdd12"),Ce("Predictor13","PredictorAdd13");var Ju=C.PredictorAdd2;it("ColorIndexInverseTransform","MapARGB","32b",(function(v){return v>>8&255}),(function(v){return v})),it("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(v){return v}),(function(v){return v>>8&255}));var f0,fi=C.ColorIndexInverseTransform,_c=C.MapARGB,d0=C.VP8LColorIndexInverseTransformAlpha,h0=C.MapAlpha,_o=C.VP8LPredictorsAdd=[];_o.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var dl,Da,Sa,No,Fs,Is,Nc,Ls,tn,Zu,_a,di,Ac,p0,Qu,hl,pl,Ao,ml,jc,gl,jo,ef,hi,pi,_r,Nr,rn,Nn=i(511),Ds=i(2041),tf=i(225),kc=i(767),m0=0,xg=Ds,g0=tf,Ka=kc,mi=Nn,x0=0,v0=1,kw=2,y0=3,b0=4,vg=5,Ew=6,yg=7,bg=8,w0=9,wg=10,J8=[2,3,7],Z8=[3,3,11],Cw=[280,256,256,256,40],Q8=[0,1,1,1,0],eO=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],tO=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rO=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],nO=8,Sg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],_g=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],rf=null,aO=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],iO=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Tw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sO=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oO=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],lO=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cO=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ko=[],zi=[],Ms=[],uO=1,Pw=2,Eo=[],gi=[];qe("UpsampleRgbLinePair",Xt,3),qe("UpsampleBgrLinePair",Rr,3),qe("UpsampleRgbaLinePair",Ui,4),qe("UpsampleBgraLinePair",Fn,4),qe("UpsampleArgbLinePair",ta,4),qe("UpsampleRgba4444LinePair",hn,2),qe("UpsampleRgb565LinePair",Hr,2);var fO=C.UpsampleRgbLinePair,dO=C.UpsampleBgrLinePair,Ow=C.UpsampleRgbaLinePair,Fw=C.UpsampleBgraLinePair,Iw=C.UpsampleArgbLinePair,Lw=C.UpsampleRgba4444LinePair,hO=C.UpsampleRgb565LinePair,S0=16,_0=1<<S0-1,nf=-227,Ng=482,pO=6,Dw=0,mO=i(256),gO=i(256),xO=i(256),vO=i(256),yO=i(Ng-nf),bO=i(Ng-nf);us("YuvToRgbRow",Xt,3),us("YuvToBgrRow",Rr,3),us("YuvToRgbaRow",Ui,4),us("YuvToBgraRow",Fn,4),us("YuvToArgbRow",ta,4),us("YuvToRgba4444Row",hn,2),us("YuvToRgb565Row",Hr,2);var Mw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],N0=[0,2,8],wO=[8,7,6,4,4,2,2,2,1,1,1,1],SO=1;this.WebPDecodeRGBA=function(v,w,T,B,ee){var ne=v0,ie=new gc,oe=new Oa;ie.ba=oe,oe.S=ne,oe.width=[oe.width],oe.height=[oe.height];var le=oe.width,de=oe.height,_e=new ba;if(_e==null||v==null)var Le=2;else t(_e!=null),Le=vc(v,w,T,_e.width,_e.height,_e.Pd,_e.Qd,_e.format,null);if(Le!=0?le=0:(le!=null&&(le[0]=_e.width[0]),de!=null&&(de[0]=_e.height[0]),le=1),le){oe.width=oe.width[0],oe.height=oe.height[0],B!=null&&(B[0]=oe.width),ee!=null&&(ee[0]=oe.height);e:{if(B=new os,(ee=new $u).data=v,ee.w=w,ee.ha=T,ee.kd=1,w=[0],t(ee!=null),((v=vc(ee.data,ee.w,ee.ha,null,null,null,w,null,ee))==0||v==7)&&w[0]&&(v=4),(w=v)==0){if(t(ie!=null),B.data=ee.data,B.w=ee.w+ee.offset,B.ha=ee.ha-ee.offset,B.put=wa,B.ac=Zr,B.bc=ui,B.ma=ie,ee.xa){if((v=We())==null){ie=1;break e}if((function(De,ke){var Ke=[0],He=[0],Ne=[0];t:for(;;){if(De==null)return 0;if(ke==null)return De.a=2,0;if(De.l=ke,De.a=0,K(De.m,ke.data,ke.w,ke.ha),!Tt(De.m,Ke,He,Ne)){De.a=3;break t}if(De.xb=Pw,ke.width=Ke[0],ke.height=He[0],!Fe(Ke[0],He[0],1,De,null))break t;return 1}return t(De.a!=0),0})(v,B)){if(B=(w=yc(B.width,B.height,ie.Oa,ie.ba))==0){t:{B=v;r:for(;;){if(B==null){B=0;break t}if(t(B.s.yc!=null),t(B.s.Ya!=null),t(0<B.s.Wb),t((T=B.l)!=null),t((ee=T.ma)!=null),B.xb!=0){if(B.ca=ee.ba,B.tb=ee.tb,t(B.ca!=null),!Yu(ee.Oa,T,y0)){B.a=2;break r}if(!Me(B,T.width)||T.da)break r;if((T.da||Nt(B.ca.S))&&Pe(),11>B.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),B.ca.f.kb.F!=null&&Pe()),B.Pb&&0<B.s.ua&&B.s.vb.X==null&&!Te(B.s.vb,B.s.Wa.Xa)){B.a=1;break r}B.xb=0}if(!me(B,B.V,B.Ba,B.c,B.i,T.o,pe))break r;ee.Dc=B.Ma,B=1;break t}t(B.a!=0),B=0}B=!B}B&&(w=v.a)}else w=v.a}else{if((v=new Va)==null){ie=1;break e}if(v.Fa=ee.na,v.P=ee.P,v.qc=ee.Sa,Kd(v,B)){if((w=yc(B.width,B.height,ie.Oa,ie.ba))==0){if(v.Aa=0,T=ie.Oa,t((ee=v)!=null),T!=null){if(0<(le=0>(le=T.Md)?0:100<le?255:255*le/100)){for(de=_e=0;4>de;++de)12>(Le=ee.pb[de]).lc&&(Le.ia=le*wO[0>Le.lc?0:Le.lc]>>3),_e|=Le.ia;_e&&(alert("todo:VP8InitRandom"),ee.ia=1)}ee.Ga=T.Id,100<ee.Ga?ee.Ga=100:0>ee.Ga&&(ee.Ga=0)}Zm(v,B)||(w=v.a)}}else w=v.a}w==0&&ie.Oa!=null&&ie.Oa.fd&&(w=Ku(ie.ba))}ie=w}ne=ie!=0?null:11>ne?oe.f.RGBA.eb:oe.f.kb.y}else ne=null;return ne};var Rw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,k){for(var W="",D=0;D<4;D++)W+=String.fromCharCode(C[k++]);return W}function f(C,k){return(C[k+0]<<0|C[k+1]<<8|C[k+2]<<16)>>>0}function d(C,k){return(C[k+0]<<0|C[k+1]<<8|C[k+2]<<16|C[k+3]<<24)>>>0}new c;var p=[0],h=[0],m=[],g=new c,x=e,b=(function(C,k){var W={},D=0,j=!1,H=0,U=0;if(W.frames=[],!(function(I,P,L,R){for(var G=0;G<R;G++)if(I[P+G]!=L.charCodeAt(G))return!0;return!1})(C,k,"RIFF",4)){var Y,X;for(d(C,k+=4),k+=8;k<C.length;){var Z=u(C,k),K=d(C,k+=4);k+=4;var z=K+(1&K);switch(Z){case"VP8 ":case"VP8L":W.frames[D]===void 0&&(W.frames[D]={}),(A=W.frames[D]).src_off=j?U:k-8,A.src_size=H+K+8,D++,j&&(j=!1,H=0,U=0);break;case"VP8X":(A=W.header={}).feature_flags=C[k];var se=k+4;A.canvas_width=1+f(C,se),se+=3,A.canvas_height=1+f(C,se),se+=3;break;case"ALPH":j=!0,H=z+8,U=k-8;break;case"ANIM":(A=W.header).bgcolor=d(C,k),se=k+4,A.loop_count=(Y=C)[(X=se)+0]<<0|Y[X+1]<<8,se+=2;break;case"ANMF":var xe,A;(A=W.frames[D]={}).offset_x=2*f(C,k),k+=3,A.offset_y=2*f(C,k),k+=3,A.width=1+f(C,k),k+=3,A.height=1+f(C,k),k+=3,A.duration=f(C,k),k+=3,xe=C[k++],A.dispose=1&xe,A.blend=xe>>1&1}Z!="ANMF"&&(k+=z)}return W}})(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var S=b.header?b.header:null,_=b.frames?b.frames:null;if(S){S.loop_counter=S.loop_count,p=[S.canvas_height],h=[S.canvas_width];for(var E=0;E<_.length&&_[E].blend!=0;E++);}var O=_[0],F=g.WebPDecodeRGBA(x,O.src_off,O.src_size,h,p);O.rgba=F,O.imgwidth=h[0],O.imgheight=p[0];for(var M=0;M<h[0]*p[0]*4;M++)m[M]=F[M];return this.width=h,this.height=p,this.data=m,this}(function(e){var t=function(){return typeof w2=="function"},r=function(p,h,m,g){var x=4,b=s;switch(g){case e.image_compression.FAST:x=1,b=i;break;case e.image_compression.MEDIUM:x=6,b=o;break;case e.image_compression.SLOW:x=9,b=c}p=n(p,h,m,b);var S=w2(p,{level:x});return e.__addimage__.arrayBufferToBinaryString(S)},n=function(p,h,m,g){for(var x,b,S,_=p.length/h,E=new Uint8Array(p.length+_),O=f(),F=0;F<_;F+=1){if(S=F*h,x=p.subarray(S,S+h),g)E.set(g(x,m,b),S+F);else{for(var M,C=O.length,k=[];M<C;M+=1)k[M]=O[M](x,m,b);var W=d(k.concat());E.set(k[W],S+F)}b=x}return E},a=function(p){var h=Array.apply([],p);return h.unshift(0),h},i=function(p,h){var m,g=[],x=p.length;g[0]=1;for(var b=0;b<x;b+=1)m=p[b-h]||0,g[b+1]=p[b]-m+256&255;return g},s=function(p,h,m){var g,x=[],b=p.length;x[0]=2;for(var S=0;S<b;S+=1)g=m&&m[S]||0,x[S+1]=p[S]-g+256&255;return x},o=function(p,h,m){var g,x,b=[],S=p.length;b[0]=3;for(var _=0;_<S;_+=1)g=p[_-h]||0,x=m&&m[_]||0,b[_+1]=p[_]+256-(g+x>>>1)&255;return b},c=function(p,h,m){var g,x,b,S,_=[],E=p.length;_[0]=4;for(var O=0;O<E;O+=1)g=p[O-h]||0,x=m&&m[O]||0,b=m&&m[O-h]||0,S=u(g,x,b),_[O+1]=p[O]-S+256&255;return _},u=function(p,h,m){if(p===h&&h===m)return p;var g=Math.abs(h-m),x=Math.abs(p-m),b=Math.abs(p+h-m-m);return g<=x&&g<=b?p:x<=b?h:m},f=function(){return[a,i,s,o,c]},d=function(p){var h=p.map((function(m){return m.reduce((function(g,x){return g+Math.abs(x)}),0)}));return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(p,h,m,g){var x,b,S,_,E,O,F,M,C,k,W,D,j,H,U,Y=this.decode.FLATE_DECODE,X="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(S=new fue(p)).imgData,b=S.bits,x=S.colorSpace,E=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){C=(M=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,W=new Uint8Array(C*S.colors),k=new Uint8Array(C);var Z,K=S.pixelBitlength-S.bits;for(H=0,U=0;H<C;H++){for(j=M[H],Z=0;Z<K;)W[U++]=j>>>Z&255,Z+=S.bits;k[H]=j>>>Z&255}}if(S.bits===16){C=(M=new Uint32Array(S.decodePixels().buffer)).length,W=new Uint8Array(C*(32/S.pixelBitlength)*S.colors),k=new Uint8Array(C*(32/S.pixelBitlength)),D=S.colors>1,H=0,U=0;for(var z=0;H<C;)j=M[H++],W[U++]=j>>>0&255,D&&(W[U++]=j>>>16&255,j=M[H++],W[U++]=j>>>0&255),k[z++]=j>>>16&255;b=8}g!==e.image_compression.NONE&&t()?(p=r(W,S.width*S.colors,S.colors,g),F=r(k,S.width,1,g)):(p=W,F=k,Y=void 0)}if(S.colorType===3&&(x=this.color_spaces.INDEXED,O=S.palette,S.transparency.indexed)){var se=S.transparency.indexed,xe=0;for(H=0,C=se.length;H<C;++H)xe+=se[H];if((xe/=255)===C-1&&se.indexOf(0)!==-1)_=[se.indexOf(0)];else if(xe!==C){for(M=S.decodePixels(),k=new Uint8Array(M.length),H=0,C=M.length;H<C;H++)k[H]=se[M[H]];F=r(k,S.width,1)}}var A=(function(I){var P;switch(I){case e.image_compression.FAST:P=11;break;case e.image_compression.MEDIUM:P=13;break;case e.image_compression.SLOW:P=14;break;default:P=12}return P})(g);return Y===this.decode.FLATE_DECODE&&(X="/Predictor "+A+" "),X+="/Colors "+E+" /BitsPerComponent "+b+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(F&&this.__addimage__.isArrayBuffer(F)||this.__addimage__.isArrayBufferView(F))&&(F=this.__addimage__.arrayBufferToBinaryString(F)),{alias:m,data:p,index:h,filter:Y,decodeParameters:X,transparency:_,palette:O,sMask:F,predictor:A,width:S.width,height:S.height,bitsPerComponent:b,colorSpace:x}}}})(Ot.API),(function(e){e.processGIF89A=function(t,r,n,a){var i=new due(t),s=i.width,o=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:o},f=new W1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,a)},e.processGIF87A=e.processGIF89A})(Ot.API),qi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},qi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){wr.log("bit decode error:"+r)}},qi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},qi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,c=15&i,u=this.palette[o];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},qi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},qi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,f=n*this.width*4+4*a;this.data[f]=c,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=u}this.pos+=e}},qi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/t*255|0,f=a*this.width*4+4*i;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},qi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},qi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},qi.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,r,n,a){var i=new qi(t,!1),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new W1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}})(Ot.API),BA.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,r,n,a){var i=new BA(t),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new W1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}})(Ot.API),Ot.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,c=0,u=0;u<a;u+=4){var f=n[u],d=n[u+1],p=n[u+2],h=n[u+3];i[o++]=f,i[o++]=d,i[o++]=p,s[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ot.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},Uc=Ot.API,xh=Uc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,f=u.fof?u.fof:1,d=t.doKerning!==!1,p=0,h=e.length,m=0,g=o[0]||c,x=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(p=d&&pr(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/f:0,x.push((o[n]||g)/c+p)),m=n;return x},LA=Uc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Uc.processArabic&&(e=Uc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:xh.apply(this,arguments).reduce((function(i,s){return i+s}),0)},DA=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var c=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(c,i)),o=0,c=i),o+=t[i],i++;return c!==i&&a.push(e.slice(c,i)),a},MA=function(e,t,r){r||(r={});var n,a,i,s,o,c,u,f=[],d=[f],p=r.textIndent||0,h=0,m=0,g=e.split(" "),x=xh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),S=[];g.map((function(E){(E=E.split(/\s*\n/)).length>1?S=S.concat(E.map((function(O,F){return(F&&O.length?`
`:"")+O}))):S.push(E[0])})),g=S,c=LA.apply(this,[b,r])}for(i=0,s=g.length;i<s;i++){var _=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),_=1),p+h+(m=(a=xh.apply(this,[n,r])).reduce((function(E,O){return E+O}),0))>t||_){if(m>t){for(o=DA.apply(this,[n,a,t-(p+h),t]),f.push(o.shift()),f=[o.pop()];o.length;)d.push([o.shift()]);m=a.slice(n.length-(f[0]?f[0].length:0)).reduce((function(E,O){return E+O}),0)}else f=[n];d.push(f),p=m+c,h=x}else f.push(n),p+=h+m,h=x}return u=c?function(E,O){return(O?b:"")+E.join(" ")}:function(E){return E.join(" ")},d.map(u)},Uc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,c,u=[];for(o=0,c=n.length;o<c;o++)u=u.concat(MA.apply(this,[n[o],s,i]));return u},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(d){return"0x"+parseInt(d,10).toString(16)},s=e.__fontmetrics__.compress=function(d){var p,h,m,g,x=["{"];for(var b in d){if(p=d[b],isNaN(parseInt(b,10))?h="'"+b+"'":(b=parseInt(b,10),h=(h=i(b).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof p=="number")p<0?(m=i(p).slice(3),g="-"):(m=i(p).slice(2),g=""),m=g+m.slice(0,-1)+n[m.slice(-1)];else{if(pr(p)!=="object")throw new Error("Don't know what to do with value type "+pr(p)+".");m=s(p)}x.push(h+m)}return x.push("}"),x.join("")},o=e.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,h,m,g,x={},b=1,S=x,_=[],E="",O="",F=d.length-1,M=1;M<F;M+=1)(g=d[M])=="'"?p?(m=p.join(""),p=void 0):p=[]:p?p.push(g):g=="{"?(_.push([S,m]),S={},m=void 0):g=="}"?((h=_.pop())[0][h[1]]=S,m=void 0,S=h[0]):g=="-"?b=-1:m===void 0?r.hasOwnProperty(g)?(E+=r[g],m=parseInt(E,16)*b,b=1,E=""):E+=g:r.hasOwnProperty(g)?(O+=r[g],S[m]=parseInt(O,16)*b,b=1,m=void 0,O=""):O+=g;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(d){var p=d.font,h=f.Unicode[p.postScriptName];h&&(p.metadata.Unicode={},p.metadata.Unicode.widths=h.widths,p.metadata.Unicode.kerning=h.kerning);var m=u.Unicode[p.postScriptName];m&&(p.metadata.Unicode.encoding=m,p.encoding=m.codePages[0])}])})(Ot.API),(function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Mf(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])})(Ot),(function(e){function t(){return(It.canvg?Promise.resolve(It.canvg):g2(()=>import("./index.es-DDgX67mz.js"),__vite__mapDeps([0,1,2]))).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}Ot.API.addSvgAsImage=function(r,n,a,i,s,o,c,u){if(isNaN(n)||isNaN(a))throw wr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw wr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=i,f.height=s;var d=f.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,f.width,f.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then((function(m){return m.fromString(d,r,p)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(m){return m.render(p)})).then((function(){h.addImage(f.toDataURL("image/jpeg",1),n,a,i,s,c,u)}))}})(),Ot.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Ot.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],u=0,f=0,d=0;function p(m,g){var x,b=!1;for(x=0;x<m.length;x+=1)m[x]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(d=0;d<h;d+=1)r[o[d]].value=r[o[d]].defaultValue,r[o[d]].explicitSet=!1}if(pr(e)==="object"){for(a in e)if(i=e[a],p(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&p(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(f=0;f<i[u].length;f+=1)typeof i[u][f]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+s.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}})(Ot.API),(function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],d=0,p=i.length;d<p;++d){if(o=s.metadata.characterToGlyph(i.charCodeAt(d)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(d),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(i){var s,o,c,u,f,d,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,p=(o=Object.keys(i).sort((function(h,m){return h-m}))).length;d<p;d++)s=o[d],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(u=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",m=0;m<p.length;m++)h+=String.fromCharCode(p[m]);var g=u();f({data:h,addLength1:!0,objectId:g}),c("endobj");var x=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Hc(o.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var S=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Hc(o.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Hc(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+S+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",h=0;h<d.length;h++)p+=String.fromCharCode(d[h]);var m=u();f({data:p,addLength1:!0,objectId:m}),c("endobj");var g=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var x=u();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Hc(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=u();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Hc(o.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",c=i.x,u=i.y,f=i.options||{},d=i.mutex||{},p=d.pdfEscape,h=d.activeFontKey,m=d.fonts,g=h,x="",b=0,S="",_=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:o,x:c,y:u,options:f,mutex:d};for(S=o,g=h,Array.isArray(o)&&(S=o[0]),b=0;b<S.length;b+=1)m[g].metadata.hasOwnProperty("cmap")&&(s=m[g].metadata.cmap.unicode.codeMap[S[b].charCodeAt(0)]),s||S[b].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?x+=S[b]:x+="";var E="";return parseInt(g.slice(1))<14||_==="WinAnsiEncoding"?E=p(x,g).split("").map((function(O){return O.charCodeAt(0).toString(16)})).join(""):_==="Identity-H"&&(E=r(x,m[g])),d.isHex=!0,{text:E,x:c,y:u,options:f,mutex:d}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?o.push([a(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):o.push(a(Object.assign({},c,{text:s[u]})).text);i.text=o}else i.text=a(Object.assign({},c,{text:s})).text}])})(Ot),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(Ot.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,c,u,f,d=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,_=0;this.__bidiEngine__={};var E=function(D){var j=D.charCodeAt(),H=j>>8,U=g[H];return U!==void 0?d[256*U+(255&j)]:H===252||H===253?"AL":b.test(H)?"L":H===8?"R":"N"},O=function(D){for(var j,H=0;H<D.length;H++){if((j=E(D.charAt(H)))==="L")return!1;if(j==="R")return!0}return!1},F=function(D,j,H,U){var Y,X,Z,K,z=j[U];switch(z){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(z="AN");break;case"AL":S=!0,z="R";break;case"WS":z="N";break;case"CS":U<1||U+1>=j.length||(Y=H[U-1])!=="EN"&&Y!=="AN"||(X=j[U+1])!=="EN"&&X!=="AN"?z="N":S&&(X="AN"),z=X===Y?X:"N";break;case"ES":z=(Y=U>0?H[U-1]:"B")==="EN"&&U+1<j.length&&j[U+1]==="EN"?"EN":"N";break;case"ET":if(U>0&&H[U-1]==="EN"){z="EN";break}if(S){z="N";break}for(Z=U+1,K=j.length;Z<K&&j[Z]==="ET";)Z++;z=Z<K&&j[Z]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(K=j.length,Z=U+1;Z<K&&j[Z]==="NSM";)Z++;if(Z<K){var se=D[U],xe=se>=1425&&se<=2303||se===64286;if(Y=j[Z],xe&&(Y==="R"||Y==="AL")){z="R";break}}}z=U<1||(Y=j[U-1])==="B"?"N":H[U-1];break;case"B":S=!1,a=!0,z=_;break;case"S":i=!0,z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":z="N"}return z},M=function(D,j,H){var U=D.split("");return H&&C(U,H,{hiLevel:_}),U.reverse(),j&&j.reverse(),U.join("")},C=function(D,j,H){var U,Y,X,Z,K,z=-1,se=D.length,xe=0,A=[],I=_?h:p,P=[];for(S=!1,a=!1,i=!1,Y=0;Y<se;Y++)P[Y]=E(D[Y]);for(X=0;X<se;X++){if(K=xe,A[X]=F(D,P,A,X),U=240&(xe=I[K][m[A[X]]]),xe&=15,j[X]=Z=I[xe][5],U>0)if(U===16){for(Y=z;Y<X;Y++)j[Y]=1;z=-1}else z=-1;if(I[xe][6])z===-1&&(z=X);else if(z>-1){for(Y=z;Y<X;Y++)j[Y]=Z;z=-1}P[X]==="B"&&(j[X]=0),H.hiLevel|=Z}i&&(function(L,R,G){for(var J=0;J<G;J++)if(L[J]==="S"){R[J]=_;for(var q=J-1;q>=0&&L[q]==="WS";q--)R[q]=_}})(P,j,se)},k=function(D,j,H,U,Y){if(!(Y.hiLevel<D)){if(D===1&&_===1&&!a)return j.reverse(),void(H&&H.reverse());for(var X,Z,K,z,se=j.length,xe=0;xe<se;){if(U[xe]>=D){for(K=xe+1;K<se&&U[K]>=D;)K++;for(z=xe,Z=K-1;z<Z;z++,Z--)X=j[z],j[z]=j[Z],j[Z]=X,H&&(X=H[z],H[z]=H[Z],H[Z]=X);xe=K}xe++}}},W=function(D,j,H){var U=D.split(""),Y={hiLevel:_};return H||(H=[]),C(U,H,Y),(function(X,Z,K){if(K.hiLevel!==0&&f)for(var z,se=0;se<X.length;se++)Z[se]===1&&(z=x.indexOf(X[se]))>=0&&(X[se]=x[z+1])})(U,H,Y),k(2,U,j,H,Y),k(1,U,j,H,Y),U.join("")};return this.__bidiEngine__.doBidiReorder=function(D,j,H){if((function(Y,X){if(X)for(var Z=0;Z<Y.length;Z++)X[Z]=Z;o===void 0&&(o=O(Y)),u===void 0&&(u=O(Y))})(D,j),s||!c||u)if(s&&c&&o^u)_=o?1:0,D=M(D,j,H);else if(!s&&c&&u)_=o?1:0,D=W(D,j,H),D=M(D,j);else if(!s||o||c||u){if(s&&!c&&o^u)D=M(D,j),o?(_=0,D=W(D,j,H)):(_=1,D=W(D,j,H),D=M(D,j));else if(s&&o&&!c&&u)_=1,D=W(D,j,H),D=M(D,j);else if(!s&&!c&&o^u){var U=f;o?(_=1,D=W(D,j,H),_=0,f=!1,D=W(D,j,H),f=U):(_=0,D=W(D,j,H),D=M(D,j),_=1,f=!1,D=W(D,j,H),f=U,D=M(D,j))}}else _=0,D=W(D,j,H);else _=o?1:0,D=W(D,j,H);return D},this.__bidiEngine__.setOptions=function(D){D&&(s=D.isInputVisual,c=D.isOutputVisual,o=D.isInputRtl,u=D.isOutputRtl,f=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,i=(n.x,n.y,n.options||{}),s=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])})(Ot),Ot.API.TTFFont=(function(){function e(t){var r;if(this.rawData=t,r=this.contents=new tl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new kue(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new hue(this.contents),this.head=new mue(this),this.name=new bue(this),this.cmap=new I8(this),this.toUnicode={},this.hhea=new gue(this),this.maxp=new wue(this),this.hmtx=new Sue(this),this.post=new vue(this),this.os2=new xue(this),this.loca=new jue(this),this.glyf=new _ue(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,u;for(u=[],s=0,o=(c=this.bbox).length;s<o;s++)t=c[s],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),(32768&(r=a>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e})();var is,tl=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e})(),hue=(function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,c,u,f,d,p,h,m,g;for(g in h=Object.keys(r).length,c=Math.log(2),d=16*Math.floor(Math.log(h)/c),s=Math.floor(d/c),f=16*h-d,(a=new tl).writeInt(this.scalarType),a.writeShort(h),a.writeShort(d),a.writeShort(s),a.writeShort(f),i=16*h,u=a.pos+i,o=null,m=[],r)for(p=r[g],a.writeString(g),a.writeInt(e(p)),a.writeInt(u),a.writeInt(p.length),m=m.concat(p),g==="head"&&(o=u),u+=p.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=L8.call(r);r.length%4;)r.push(0);for(i=new tl(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t})(),pue={}.hasOwnProperty,Cs=function(e,t){for(var r in t)pue.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};is=(function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var mue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new tl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t})(),UA=(function(){function e(t,r){var n,a,i,s,o,c,u,f,d,p,h,m,g,x,b,S,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),d=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,i=(function(){var E,O;for(O=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)O.push(t.readUInt16());return O})(),t.pos+=2,g=(function(){var E,O;for(O=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)O.push(t.readUInt16());return O})(),u=(function(){var E,O;for(O=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)O.push(t.readUInt16());return O})(),f=(function(){var E,O;for(O=[],c=E=0;0<=p?E<p:E>p;c=0<=p?++E:--E)O.push(t.readUInt16());return O})(),a=(this.length-t.pos+this.offset)/2,o=(function(){var E,O;for(O=[],c=E=0;0<=a?E<a:E>a;c=0<=a?++E:--E)O.push(t.readUInt16());return O})(),c=b=0,_=i.length;b<_;c=++b)for(x=i[c],n=S=m=g[c];m<=x?S<=x:S>=x;n=m<=x?++S:--S)f[c]===0?s=n+u[c]:(s=o[f[c]/2+(n-m)-(p-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}t.pos=d}return e.encode=function(t,r){var n,a,i,s,o,c,u,f,d,p,h,m,g,x,b,S,_,E,O,F,M,C,k,W,D,j,H,U,Y,X,Z,K,z,se,xe,A,I,P,L,R,G,J,q,Q,fe,V;switch(U=new tl,s=Object.keys(t).sort((function(Oe,Te){return Oe-Te})),r){case"macroman":for(g=0,x=(function(){var Oe=[];for(m=0;m<256;++m)Oe.push(0);return Oe})(),S={0:0},i={},Y=0,z=s.length;Y<z;Y++)S[q=t[a=s[Y]]]==null&&(S[q]=++g),i[a]={old:t[a],new:S[t[a]]},x[a]=S[t[a]];return U.writeUInt16(1),U.writeUInt16(0),U.writeUInt32(12),U.writeUInt16(0),U.writeUInt16(262),U.writeUInt16(0),U.write(x),{charMap:i,subtable:U.data,maxGlyphID:g+1};case"unicode":for(j=[],d=[],_=0,S={},n={},b=u=null,X=0,se=s.length;X<se;X++)S[O=t[a=s[X]]]==null&&(S[O]=++_),n[a]={old:O,new:S[O]},o=S[O]-a,b!=null&&o===u||(b&&d.push(b),j.push(a),u=o),b=a;for(b&&d.push(b),d.push(65535),j.push(65535),W=2*(k=j.length),C=2*Math.pow(Math.log(k)/Math.LN2,2),p=Math.log(C/2)/Math.LN2,M=2*k-C,c=[],F=[],h=[],m=Z=0,xe=j.length;Z<xe;m=++Z){if(D=j[m],f=d[m],D===65535){c.push(0),F.push(0);break}if(D-(H=n[D].new)>=32768)for(c.push(0),F.push(2*(h.length+k-m)),a=K=D;D<=f?K<=f:K>=f;a=D<=f?++K:--K)h.push(n[a].new);else c.push(H-D),F.push(0)}for(U.writeUInt16(3),U.writeUInt16(1),U.writeUInt32(12),U.writeUInt16(4),U.writeUInt16(16+8*k+2*h.length),U.writeUInt16(0),U.writeUInt16(W),U.writeUInt16(C),U.writeUInt16(p),U.writeUInt16(M),G=0,A=d.length;G<A;G++)a=d[G],U.writeUInt16(a);for(U.writeUInt16(0),J=0,I=j.length;J<I;J++)a=j[J],U.writeUInt16(a);for(Q=0,P=c.length;Q<P;Q++)o=c[Q],U.writeUInt16(o);for(fe=0,L=F.length;fe<L;fe++)E=F[fe],U.writeUInt16(E);for(V=0,R=h.length;V<R;V++)g=h[V],U.writeUInt16(g);return{charMap:n,subtable:U.data,maxGlyphID:_+1}}},e})(),I8=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new UA(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=UA.encode(r,n),(i=new tl).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t})(),gue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t})(),xue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a})(),this.charRange=(function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t})(),vue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(a=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,c,u;for(u=[],s=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;s=0<=c?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t})(),yue=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},bue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,s,o,c,u,f,d,p,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=d=0,p=a.length;d<p;s=++d)i=a[s],r.pos=i.offset,f=r.readString(i.length),o=new yue(f,i),u[h=i.nameID]==null&&(u[h]=[]),u[i.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),wue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t})(),Sue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,s,o,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,d;for(d=[],n=f=0;0<=i?f<i:f>i;n=0<=i?++f:--f)d.push(r.readInt16());return d})(),this.widths=(function(){var f,d,p,h;for(h=[],f=0,d=(p=this.metrics).length;f<d;f++)s=p[f],h.push(s.advance);return h}).call(this),a=this.widths[this.widths.length-1],u=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)u.push(this.widths.push(a));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t})(),L8=[].slice,_ue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,s,o,c,u,f,d,p;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(r),(i=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(c=new tl(n.read(i))).readShort(),f=c.readShort(),p=c.readShort(),u=c.readShort(),d=c.readShort(),this.cache[r]=o===-1?new Aue(c,f,p,u,d):new Nue(c,o,f,p,u,d),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,s,o,c,u;for(o=[],s=[],c=0,u=n.length;c<u;c++)i=r[n[c]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t})(),Nue=(function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),Aue=(function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new tl(L8.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e})(),jue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Cs(t,is),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(i+=u)}for(var f=new Array(4*a.length),d=0;d<a.length;++d)f[4*d+3]=255&a[d],f[4*d+2]=(65280&a[d])>>8,f[4*d+1]=(16711680&a[d])>>16,f[4*d]=(4278190080&a[d])>>24;return f},t})(),kue=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,c;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,c,u,f,d,p,h,m,g,x,b;for(a in n=I8.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},b=n.charMap)h[(c=b[a]).old]=c.new;for(m in p=n.maxGlyphID,s)m in h||(h[m]=p++);return f=(function(S){var _,E;for(_ in E={},S)E[S[_]]=_;return E})(h),d=Object.keys(f).sort((function(S,_){return S-_})),g=(function(){var S,_,E;for(E=[],S=0,_=d.length;S<_;S++)o=d[S],E.push(f[o]);return E})(),i=this.font.glyf.encode(s,g,h),u=this.font.loca.encode(i.offsets,g),x={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},e})();Ot.API.PDFObject=(function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+(function(){var o,c,u;for(u=[],o=0,c=r.length;o<c;o++)n=r[o],u.push(t.convert(n));return u})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t})();function D8(e,t,r,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,o=a.internal.getFontSize()/s,c=a.getLineHeightFactor?a.getLineHeightFactor():i,u=o*c,f=/\r\n|\r|\n/g,d="",p=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(d=typeof e=="string"?e.split(f):e,p=d.length||1),r+=o*(2-i),n.valign==="middle"?r-=p/2*u:n.valign==="bottom"&&(r-=p*u),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),d&&p>=1){for(var m=0;m<d.length;m++)a.text(d[m],t-a.getStringUnitWidth(d[m])*h,r),r+=u;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var zA={},iu=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:zA=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,c=s.fontName;if(t.font&&(c=t.font),t.fontStyle){o=t.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),o=u[0])}if(this.jsPDFDocument.setFont(c,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var f=e.unifyColor(t.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=e.unifyColor(t.textColor),f&&(a=this.jsPDFDocument).setTextColor.apply(a,f),f=e.unifyColor(t.lineColor),f&&(i=this.jsPDFDocument).setDrawColor.apply(i,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return zA||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),E2=function(e,t){return E2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},E2(e,t)};function M8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");E2(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var R8=(function(e){M8(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t})(Array);function Eue(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Cue(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function $p(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function B8(e,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var s=U8(a,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function U8(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function Xm(e,t){var r,n,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function z8(e,t){var r=Xm(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Tue(e,t,r,n,a){var i={},s=1.3333333333333333,o=H1(t,function(_){return a.getComputedStyle(_).backgroundColor});o!=null&&(i.fillColor=o);var c=H1(t,function(_){return a.getComputedStyle(_).color});c!=null&&(i.textColor=c);var u=Oue(n,r);u&&(i.cellPadding=u);var f="borderTopColor",d=s*r,p=n.borderTopWidth;if(n.borderBottomWidth===p&&n.borderRightWidth===p&&n.borderLeftWidth===p){var h=(parseFloat(p)||0)/d;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/d,right:(parseFloat(n.borderRightWidth)||0)/d,bottom:(parseFloat(n.borderBottomWidth)||0)/d,left:(parseFloat(n.borderLeftWidth)||0)/d},i.lineWidth.top||(i.lineWidth.right?f="borderRightColor":i.lineWidth.bottom?f="borderBottomColor":i.lineWidth.left&&(f="borderLeftColor"));var m=H1(t,function(_){return a.getComputedStyle(_)[f]});m!=null&&(i.lineColor=m);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(i.fontSize=x/s);var b=Pue(n);b&&(i.fontStyle=b);var S=(n.fontFamily||"").toLowerCase();return e.indexOf(S)!==-1&&(i.font=S),i}function Pue(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function H1(e,t){var r=$8(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function $8(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:$8(e.parentElement,t):r}function Oue(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(o){return parseInt(o||"0")/n}),s=Xm(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function W8(e,t,r,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var c=Object.keys(e.getFontList()),u=e.scaleFactor(),f=[],d=[],p=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:f,body:d,foot:p};for(var h=0;h<o.rows.length;h++){var m=o.rows[h],g=(s=(i=m==null?void 0:m.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),x=Fue(c,u,r,m,n,a);x&&(g==="thead"?f.push(x):g==="tfoot"?p.push(x):d.push(x))}return{head:f,body:d,foot:p}}function Fue(e,t,r,n,a,i){for(var s=new R8(n),o=0;o<n.cells.length;o++){var c=n.cells[o],u=r.getComputedStyle(c);if(a||u.display!=="none"){var f=void 0;i&&(f=Tue(e,c,t,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:f,_element:c,content:Iue(c)})}}var d=r.getComputedStyle(n);if(s.length>0&&(a||d.display!=="none"))return s}function Iue(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Lue(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Vs(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i}function H8(e,t){var r=new iu(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();Lue(a,n,t);var i=Vs({},a,n,t),s;typeof window<"u"&&(s=window);var o=Due(a,n,t),c=Mue(a,n,t),u=Rue(r,i),f=Uue(r,i,s);return{id:t.tableId,content:f,hooks:c,styles:o,settings:u}}function Due(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=e[c],f=t[c],d=r[c];n.columnStyles=Vs({},u,f,d)}else{var p=[e,t,r],h=p.map(function(m){return m[c]||{}});n[c]=Vs({},h[0],h[1],h[2])}},i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];a(o)}return n}function Mue(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var o=s[i];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function Rue(e,t){var r,n,a,i,s,o,c,u,f,d,p,h,m=Xm(t.margin,40/e.scaleFactor()),g=(r=Bue(e,t.startY))!==null&&r!==void 0?r:m.top,x;t.showFoot===!0?x="everyPage":t.showFoot===!1?x="never":x=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var b;t.showHead===!0?b="everyPage":t.showHead===!1?b="never":b=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var S=(i=t.useCss)!==null&&i!==void 0?i:!1,_=t.theme||(S?"plain":"striped"),E=!!t.horizontalPageBreak,O=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:S,theme:_,startY:g,margin:m,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=t.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:b,showFoot:x,tableLineWidth:(d=t.tableLineWidth)!==null&&d!==void 0?d:0,tableLineColor:(p=t.tableLineColor)!==null&&p!==void 0?p:200,horizontalPageBreak:E,horizontalPageBreakRepeat:O,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function Bue(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function Uue(e,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var o=W8(e,t.html,r,s,t.useCss)||{};n=o.head||n,a=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||zue(n,a,i);return{columns:c,head:n,body:a,foot:i}}function zue(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(s=(o==null?void 0:o.colSpan)||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=a.length:u=i+(c>0?"_".concat(c):"");var f={dataKey:u};a.push(f)}}),a}var C2=(function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),$ue=(function(e){M8(t,e);function t(r,n,a,i,s,o){var c=e.call(this,r,n,o)||this;return c.cell=a,c.row=i,c.column=s,c.section=i.section,c}return t})(C2),Wue=(function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,i,s){for(var o=0,c=r;o<c.length;o++){var u=c[o],f=new $ue(t,this,n,a,i,s),d=u(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],d)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new C2(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new C2(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),q8=(function(){function e(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof R8&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var o=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+o;return u>a?u:a},0)},e})(),G8=(function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Xm(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e})(),Hue=(function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e})();function que(e,t){Gue(e,t);var r=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=T2(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=T2(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.log("Of the table content, ".concat(a," units width could not fit page"))),Yue(t),Kue(t,e),Vue(t)}function Gue(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=z8(e,t);t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u){var f=t.hooks.didParseCell;t.callCellHooks(e,f,u,i,c,null);var d=u.padding("horizontal");u.contentWidth=$p(u.text,u.styles,e)+d;var p=$p(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,e);if(u.minReadableWidth=p+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var f=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},d=f.cellWidth||f.minCellWidth;d&&typeof d=="number"&&(c.minWidth=d,c.wrappedWidth=d)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function T2(e,t,r){for(var n=t,a=e.reduce(function(h,m){return h+m.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],o=s.wrappedWidth/a,c=n*o,u=s.width+c,f=r(s),d=u<f?f:u;t-=d-s.width,s.width=d}if(t=Math.round(t*1e10)/1e10,t){var p=e.filter(function(h){return t<0?h.width>r(h):!0});p.length&&(t=T2(p,t,r))}return t}function Vue(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,o=e.columns;s<o.length;s++){var c=o[s],u=t[c.index];if(r>1)r--,delete i.cells[c.index];else if(u)u.cell.height+=i.height,r=u.cell.colSpan,delete i.cells[c.index],u.left--,u.left<=1&&delete t[c.index];else{var f=i.cells[c.index];if(!f)continue;if(f.height=i.height,f.rowSpan>1){var d=n.length-a,p=f.rowSpan>d?d:f.rowSpan;t[c.index]={cell:f,left:p,row:i}}}}}function Yue(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,s=0,o=0;o<e.columns.length;o++){var c=e.columns[o];if(s-=1,s>1&&e.columns[o+1])i+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+i}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,i=0,u.colSpan>1){a=u,i+=c.width;continue}u.width=c.width+i}}}function Kue(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],s=0,o=e.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u){t.applyStyles(u.styles,!0);var f=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=t.splitTextToSize(u.text,f+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=$A(u.text,f,u.styles,t,"...");else if(u.styles.overflow==="hidden")u.text=$A(u.text,f,u.styles,t,"");else if(typeof u.styles.overflow=="function"){var d=u.styles.overflow(u.text,f);typeof d=="string"?u.text=[d]:u.text=d}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var p=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<p*u.rowSpan?r={height:p,count:u.rowSpan}:r&&r.count>0&&r.height>p&&(p=r.height),p>i.height&&(i.height=p)}}r.count--}}function $A(e,t,r,n,a){return e.map(function(i){return Xue(i,t,r,n,a)})}function Xue(e,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=$p(e,r,n))return e;for(;t<$p(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function V8(e,t){var r=new iu(e),n=Jue(t,r.scaleFactor()),a=new Wue(t,n);return que(r,a),r.applyStyles(r.userStyles),a}function Jue(e,t){var r=e.content,n=Que(r.columns);if(r.head.length===0){var a=WA(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=WA(n,"foot");a&&r.foot.push(a)}var i=e.settings.theme,s=e.styles;return{columns:n,head:q1("head",r.head,n,s,i,t),body:q1("body",r.body,n,s,i,t),foot:q1("foot",r.foot,n,s,i,t)}}function q1(e,t,r,n,a,i){var s={},o=t.map(function(c,u){for(var f=0,d={},p=0,h=0,m=0,g=r;m<g.length;m++){var x=g[m];if(s[x.index]==null||s[x.index].left===0)if(h===0){var b=void 0;Array.isArray(c)?b=c[x.index-p-f]:b=c[x.dataKey];var S={};typeof b=="object"&&!Array.isArray(b)&&(S=(b==null?void 0:b.styles)||{});var _=efe(e,x,u,a,n,i,S),E=new G8(b,_,e);d[x.dataKey]=E,d[x.index]=E,h=E.colSpan-1,s[x.index]={left:E.rowSpan-1,times:h}}else h--,p++;else s[x.index].left--,h=s[x.index].times,f++}return new q8(c,u,e,d)});return o}function WA(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=Zue(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function Zue(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function Que(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new Hue(a,t,r)})}function efe(e,t,r,n,a,i,s){var o=Cue(n),c;e==="head"?c=a.headStyles:e==="body"?c=a.bodyStyles:e==="foot"&&(c=a.footStyles);var u=Vs({},o.table,o[e],a.styles,c),f=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},d=e==="body"?f:{},p=e==="body"&&r%2===0?Vs({},o.alternateRow,a.alternateRowStyles):{},h=Eue(i),m=Vs({},h,u,p,d);return Vs(m,s)}function tfe(e,t,r){var n;r===void 0&&(r={});var a=z8(e,t),i=new Map,s=[],o=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(p){var h=t.columns.find(function(m){return m.dataKey===p||m.index===p});h&&!i.has(h.index)&&(i.set(h.index,!0),s.push(h.index),o.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,f=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;f<t.columns.length;){if(i.has(f)){f++;continue}var d=t.columns[f].wrappedWidth;if(u||a>=d)u=!1,s.push(f),o.push(t.columns[f]),a-=d;else break;f++}return{colIndexes:s,columns:o,lastIndex:f-1}}function rfe(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=tfe(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function Y8(e,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+s;if(r.pageBreak==="avoid"){var c=t.body,u=c.reduce(function(p,h){return p+h.height},0);o+=u}var f=new iu(e);(r.pageBreak==="always"||r.startY!=null&&o>f.pageSize().height)&&(X8(f),i.y=a.top),t.callWillDrawPageHooks(f,i);var d=Vs({},i);t.startPageNumber=f.pageNumber(),r.horizontalPageBreak?nfe(f,t,d,i):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(p){return oo(f,t,p,i,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(p,h){var m=h===t.body.length-1;Wp(f,t,p,m,d,i,t.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(p){return oo(f,t,p,i,t.columns)})),B8(f,t,d,i),t.callEndPageHooks(f,i),t.finalY=i.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function nfe(e,t,r,n){var a=rfe(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,f){e.applyStyles(e.userStyles),f>0?Rf(e,t,r,n,u.columns,!0):HA(e,t,n,u.columns),afe(e,t,r,n,u.columns),G1(e,t,n,u.columns)});else for(var s=-1,o=a[0],c=function(){var u=s;if(o){e.applyStyles(e.userStyles);var f=o.columns;s>=0?Rf(e,t,r,n,f,!0):HA(e,t,n,f),u=qA(e,t,s+1,n,f),G1(e,t,n,f)}var d=u-s;a.slice(1).forEach(function(p){e.applyStyles(e.userStyles),Rf(e,t,r,n,p.columns,!0),qA(e,t,s+1,n,p.columns,d),G1(e,t,n,p.columns)}),s=u};s<t.body.length-1;)c()}function HA(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return oo(e,t,i,r,n)})}function afe(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var o=s===t.body.length-1;Wp(e,t,i,o,r,n,a)})}function qA(e,t,r,n,a,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),o=-1;return t.body.slice(r,s).forEach(function(c,u){var f=r+u===t.body.length-1,d=K8(e,t,f,n);c.canEntireRowFit(d,a)&&(oo(e,t,c,n,a),o=r+u)}),o}function G1(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return oo(e,t,i,r,n)})}function ife(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function sfe(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,o=r.columns;s<o.length;s++){var c=o[s],u=e.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var f=new G8(u.raw,u.styles,u.section);f=Vs(f,u),f.text=[];var d=ife(u,t,n);u.text.length>d&&(f.text=u.text.splice(d,u.text.length));var p=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(p,h),u.contentHeight>=t&&(u.contentHeight=t,f.styles.minCellHeight-=t),u.contentHeight>e.height&&(e.height=u.contentHeight),f.contentHeight=f.getContentHeight(p,h),f.contentHeight>i&&(i=f.contentHeight),a[c.index]=f}}var m=new q8(e.raw,-1,e.section,a,!0);m.height=i;for(var g=0,x=r.columns;g<x.length;g++){var c=x[g],f=m.cells[c.index];f&&(f.height=m.height);var u=e.cells[c.index];u&&(u.height=e.height)}return m}function ofe(e,t,r,n){var a=e.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,o=a-s;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),u=c<r;if(c>o)return console.log("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var f=t.hasRowSpan(n.columns),d=t.getMaxCellHeight(n.columns)>o;return d?(f&&console.log("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function Wp(e,t,r,n,a,i,s){var o=K8(e,t,n,i);if(r.canEntireRowFit(o,s))oo(e,t,r,i,s);else if(ofe(e,r,o,t)){var c=sfe(r,o,t,e);oo(e,t,r,i,s),Rf(e,t,a,i,s),Wp(e,t,c,n,a,i,s)}else Rf(e,t,a,i,s),Wp(e,t,r,n,a,i,s)}function oo(e,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var o=s[i],c=r.cells[o.index];if(!c){n.x+=o.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=t.callCellHooks(e,t.hooks.willDrawCell,c,r,o,n);if(u===!1){n.x+=o.width;continue}lfe(e,c,n);var f=c.getTextPos();D8(c.text,f.x,f.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,o,n),n.x+=o.width}n.y+=r.height}function lfe(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=U8(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),cfe(e,t,r,n.lineWidth))}function cfe(e,t,r,n){var a,i,s,o;n.top&&(a=r.x,i=r.y,s=r.x+t.width,o=r.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,s,o)),n.bottom&&(a=r.x,i=r.y+t.height,s=r.x+t.width,o=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,s,o)),n.left&&(a=r.x,i=r.y,s=r.x,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.left,a,i,s,o)),n.right&&(a=r.x+t.width,i=r.y,s=r.x+t.width,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.right,a,i,s,o));function c(u,f,d,p,h){e.getDocument().setLineWidth(u),e.getDocument().line(f,d,p,h,"S")}}function K8(e,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function Rf(e,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(o){return oo(e,t,o,n,a)}),t.callEndPageHooks(e,n);var s=t.settings.margin;B8(e,t,r,n),X8(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return oo(e,t,o,n,a)}),e.applyStyles(e.userStyles))}function X8(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function ufe(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=H8(this,n),i=V8(this,a);return Y8(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){D8(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return iu.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){iu.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new iu(this),i=W8(a,t,window,r,!1),s=i.head,o=i.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:o,data:o}}}var V1;function ffe(e,t){var r=H8(e,t),n=V8(e,r);Y8(e,n)}try{if(typeof window<"u"&&window){var GA=window,VA=GA.jsPDF||((V1=GA.jspdf)===null||V1===void 0?void 0:V1.jsPDF);VA&&ufe(VA)}}catch(e){console.error("Could not apply autoTable plugin",e)}const vh=({label:e,value:t,color:r="blue"})=>{const n={blue:"bg-blue-50 text-blue-800 border-blue-200",green:"bg-green-50 text-green-800 border-green-200",red:"bg-red-50 text-red-800 border-red-200"},a=n[r]||n.blue;return l.jsxs("div",{className:`p-4 rounded-lg border ${a} shadow-sm`,children:[l.jsx("p",{className:"text-xs opacity-80 uppercase tracking-wide font-semibold",children:e}),l.jsx("p",{className:"text-xl font-bold mt-1",children:typeof t=="number"?`₹${t.toLocaleString("en-IN")}`:t})]})},Jm=({receipts:e,onViewReceipt:t})=>!e||e.length===0?l.jsx("div",{className:"p-8 text-center text-gray-500 border rounded bg-gray-50 mt-4",children:"No receipts found."}):l.jsx("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receipt No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date/Time"}),l.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(r=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r.receipt_no}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.student_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.class}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-800 text-right",children:["₹",r.amount.toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[r.date||""," ",r.time||""]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:l.jsxs("button",{onClick:()=>t(r.receipt_no),className:"text-white bg-violet-600 hover:bg-violet-700 px-3 py-1 rounded flex items-center justify-center mx-auto",children:[l.jsx(ZO,{className:"w-4 h-4 mr-1"})," View"]})})]},r.receipt_no))})]})}),dfe=({onViewReceipt:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(!0),[i,s]=y.useState(""),o=async()=>{var c,u;try{a(!0);const f=await Ee.get("/reports/fees/today");r(f.data)}catch(f){s(((u=(c=f.response)==null?void 0:c.data)==null?void 0:u.error)||"Failed to fetch report")}finally{a(!1)}};return y.useEffect(()=>{o()},[]),n?l.jsx("div",{className:"p-4",children:"Loading today's collection..."}):i?l.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",i]}):t?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[l.jsx("p",{className:"text-sm text-green-600 font-semibold",children:"Total Collection"}),l.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["₹",t.total_collection.toLocaleString("en-IN")]})]}),Object.entries(t.mode_breakup||{}).map(([c,u])=>l.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[l.jsx("p",{className:"text-sm text-gray-500 font-semibold",children:c}),l.jsxs("p",{className:"text-xl font-bold text-gray-800",children:["₹",Number(u).toLocaleString("en-IN")]})]},c))]}),l.jsx(Jm,{receipts:t.receipts,onViewReceipt:e})]}):null},hfe=({onViewReceipt:e})=>{const[t,r]=y.useState(new Date().toISOString().split("T")[0]),[n,a]=y.useState(new Date().toISOString().split("T")[0]),[i,s]=y.useState("All"),[o,c]=y.useState("All"),[u,f]=y.useState("All"),[d,p]=y.useState([]),[h,m]=y.useState([]),[g,x]=y.useState(null),[b,S]=y.useState(!1),[_,E]=y.useState("");y.useEffect(()=>{(async()=>{try{const W=await Ee.get("/fee-types"),D=Array.isArray(W.data)?W.data:W.data.fee_types||[],j=localStorage.getItem("currentBranch")||"All";let H=D;j!=="All"&&j!=="All Branches"&&(H=D.filter(Z=>!Z.branch||Z.branch==="All"||Z.branch===j)),p(H);const X=((await Ee.get("/classes")).data.classes||[]).map(Z=>Z.class_name);m(["All",...X])}catch(W){console.error("Failed to load initial data",W)}})()},[]);const O=async()=>{var H,U;const k=new Date(t),W=new Date(n),D=Math.abs(W.getTime()-k.getTime());if(Math.ceil(D/(1e3*60*60*24))>365){alert("Date range cannot exceed 1 year.");return}try{S(!0),E("");const Y=new URLSearchParams({start_date:t,end_date:n,class:i,section:o,fee_type:u}),X=await Ee.get(`/reports/fees/daily?${Y.toString()}`);x(X.data)}catch(Y){E(((U=(H=Y.response)==null?void 0:H.data)==null?void 0:U.error)||"Failed to fetch report"),x(null)}finally{S(!1)}};y.useEffect(()=>{O()},[]);const F=["All","A","B","C","D"],M=()=>{var U;if(!((U=g==null?void 0:g.receipts)!=null&&U.length))return;const k=g.receipts.map(Y=>({Status:"Success",Student:Y.student_name,AdmissionNo:Y.admission_no,Class:`${Y.class} ${Y.section}`,Branch:Y.branch,ReceiptNo:Y.receipt_no,FeeType:Y.fee_type_str,TotalAmount:Y.gross_amount,Concession:Y.concession,Payable:Y.net_payable,Paid:Y.amount_paid,Due:Y.due_amount,Mode:Y.mode,Note:Y.note,Date:Y.date,Time:Y.time,TakenBy:Y.collected_by})),W=pa.json_to_sheet(k),D=pa.book_new();pa.book_append_sheet(D,W,"Daily Report");const j=em(D,{bookType:"xlsx",type:"array"}),H=new Blob([j],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});h8.saveAs(H,"Daily_Fee_Report.xlsx")},C=()=>{var j;if(!((j=g==null?void 0:g.receipts)!=null&&j.length))return;const k=new Ot("l","mm","a4");k.text("Daily Fee Report",14,15);const W=["Student","Adm No","Class","Branch","Receipt","Fee Type","Paid","Due","Mode","Date","Taken By"],D=g.receipts.map(H=>[H.student_name,H.admission_no,`${H.class} ${H.section}`,H.branch,H.receipt_no,H.fee_type_str,H.amount_paid,H.due_amount,H.mode,`${H.date} ${H.time}`,H.collected_by]);ffe(k,{head:[W],body:D,startY:20,styles:{fontSize:8}}),k.save("Daily_Fee_Report.pdf")};return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsx("div",{className:"bg-violet-50 p-4 rounded-lg flex flex-col gap-4 border border-violet-100",children:l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("div",{className:"flex flex-wrap justify-between items-center",children:l.jsxs("span",{className:"bg-white px-3 py-1 rounded-full border text-sm font-semibold text-violet-700",children:[g?g.receipts_count:0," Reports"]})}),l.jsxs("select",{value:u,onChange:k=>f(k.target.value),className:"border border-gray-300 rounded px-3 py-1.5 text-sm bg-white min-w-[150px]",children:[l.jsx("option",{value:"All",children:"All Fee Types"}),d.map(k=>l.jsx("option",{value:k.fee_type,children:k.fee_type},k.id))]}),l.jsx("input",{type:"date",value:t,onChange:k=>r(k.target.value),className:"border border-gray-300 rounded px-2 py-1.5 text-sm"}),l.jsx("input",{type:"date",value:n,onChange:k=>a(k.target.value),className:"border border-gray-300 rounded px-2 py-1.5 text-sm"}),l.jsx("select",{className:"border border-gray-300 rounded px-3 py-1.5 text-sm bg-white min-w-[100px]",children:l.jsx("option",{children:"All"})}),l.jsxs("select",{value:i,onChange:k=>s(k.target.value),className:"border border-gray-300 rounded px-3 py-1.5 text-sm bg-white w-32",children:[l.jsx("option",{value:"All",children:"Select Class"}),h.map(k=>k!=="All"&&l.jsx("option",{value:k,children:k},k))]}),l.jsxs("div",{className:"flex border border-blue-500 rounded overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-500 text-white px-3 py-1.5 text-sm font-medium flex items-center gap-1",children:[l.jsx("span",{className:"text-xs",children:"🔍"})," Section"]}),l.jsxs("select",{value:o,onChange:k=>c(k.target.value),className:"px-2 py-1.5 text-sm bg-white border-l border-blue-500 outline-none",children:[l.jsx("option",{value:"All",children:"Select Section"}),F.map(k=>k!=="All"&&l.jsx("option",{value:k,children:k},k))]})]}),l.jsx("button",{onClick:O,className:"bg-indigo-700 text-white px-6 py-1.5 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search"}),l.jsx("button",{onClick:M,className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm",children:"📊Excel"}),l.jsx("button",{onClick:C,className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm",children:"📄PDF"})]})}),b&&l.jsx("div",{className:"text-center py-4",children:"Loading report..."}),_&&l.jsx("div",{className:"text-center text-red-500 py-4",children:_}),g&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-white border rounded shadow-sm overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Status"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Student Name"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Adm No."}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Class"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Branch"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Rcpt No"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Fee Type"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Tot.Amt"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Concession"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Pay Amt"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Paid"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Due"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Mode"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Note"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Date and Time"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Taken By"}),l.jsx("th",{className:"px-3 py-2 text-center font-semibold text-xs",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:g.receipts.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:17,className:"bg-red-50 text-red-500 text-center py-3 font-medium",children:"No Records Found"})}):g.receipts.map((k,W)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-green-600 font-medium",children:"Success"}),l.jsx("td",{className:"px-3 py-2 font-medium",children:k.student_name}),l.jsx("td",{className:"px-3 py-2 text-blue-600",children:k.admission_no}),l.jsxs("td",{className:"px-3 py-2",children:[k.class," ",k.section]}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:k.branch}),l.jsx("td",{className:"px-3 py-2",children:k.receipt_no}),l.jsx("td",{className:"px-3 py-2 max-w-[200px] truncate",title:k.fee_type_str,children:k.fee_type_str||"-"}),l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",k.gross_amount.toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",k.concession.toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",k.net_payable.toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right font-bold text-gray-800",children:["₹",k.amount_paid.toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right text-red-500",children:["₹",k.due_amount.toLocaleString()]}),l.jsx("td",{className:"px-3 py-2",children:k.mode}),l.jsx("td",{className:"px-3 py-2 text-xs truncate max-w-[150px]",title:k.note,children:k.note||"-"}),l.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",children:[k.date," ",l.jsx("br",{})," ",k.time]}),l.jsx("td",{className:"px-3 py-2",children:k.collected_by}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("button",{onClick:()=>e(k.receipt_no),className:"text-blue-600 hover:underline text-xs",children:"View"})})]},W))})]})}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("table",{className:"w-full border text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Payment Mode"}),l.jsx("th",{className:"px-4 py-2 text-right font-semibold",children:"Amount"})]})}),l.jsxs("tbody",{className:"divide-y",children:[Object.entries(g.mode_summary||{}).map(([k,W])=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:k}),l.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:["₹",Number(W).toLocaleString()]})]},k)),l.jsxs("tr",{className:"bg-blue-50 font-bold",children:[l.jsx("td",{className:"px-4 py-2",children:"Total"}),l.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",g.total_collection.toLocaleString()]})]})]})]})}),l.jsx("div",{className:"flex-1",children:l.jsxs("table",{className:"w-full border text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Taken By"}),l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Branch"}),l.jsx("th",{className:"px-4 py-2 text-center font-semibold",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right font-semibold",children:"Amount"})]})}),l.jsxs("tbody",{className:"divide-y",children:[Array.isArray(g.collected_by_summary)&&g.collected_by_summary.map((k,W)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:k.user}),l.jsx("td",{className:"px-4 py-2",children:k.branch}),l.jsx("td",{className:"px-4 py-2 text-center",children:k.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:["₹",Number(k.amount).toLocaleString()]})]},W)),l.jsxs("tr",{className:"bg-blue-50 font-bold",children:[l.jsx("td",{colSpan:3,className:"px-4 py-2 text-right",children:"Total"}),l.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",g.total_collection.toLocaleString()]})]})]})]})})]})]})]})},pfe=({onViewReceipt:e})=>{const[t,r]=y.useState(String(new Date().getMonth()+1)),[n,a]=y.useState(String(new Date().getFullYear())),[i,s]=y.useState(null),[o,c]=y.useState(!1),[u,f]=y.useState(""),d=localStorage.getItem("academicYear")||"",[p,h]=d.split("-"),m=[p,h],g=async()=>{var x,b;try{c(!0),f("");const S=await Ee.get(`/reports/fees/monthly?month=${t}&year=${n}`);s(S.data)}catch(S){f(((b=(x=S.response)==null?void 0:x.data)==null?void 0:b.error)||"Failed to fetch report")}finally{c(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-end gap-4 bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),l.jsx("select",{value:t,onChange:x=>r(x.target.value),className:"border border-gray-300 rounded px-3 py-2 w-32",children:Array.from({length:12},(x,b)=>b+1).map(x=>l.jsx("option",{value:x,children:new Date(0,x-1).toLocaleString("default",{month:"long"})},x))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),l.jsx("select",{value:n,onChange:x=>a(x.target.value),className:"border border-gray-300 rounded px-3 py-2 w-24",children:m.map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsx("button",{onClick:g,className:"bg-violet-600 text-white px-4 py-2 rounded hover:bg-violet-700",children:"View Report"})]}),o&&l.jsx("div",{children:"Loading..."}),u&&l.jsx("div",{className:"text-red-500",children:u}),i&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[l.jsx("p",{className:"text-sm text-indigo-600 font-bold",children:"Total Monthly Collection"}),l.jsxs("p",{className:"text-2xl font-bold text-indigo-800",children:["₹",i.total_collection.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[l.jsx("p",{className:"text-sm font-semibold mb-2",children:"Class-wise Collection"}),l.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(i.class_wise||{}).map(([x,b])=>l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("span",{className:"text-gray-600",children:["Class ",x]}),l.jsxs("span",{className:"font-mono",children:["₹",Number(b).toLocaleString("en-IN")]})]},x))})]})]}),l.jsxs("h3",{className:"font-semibold text-lg mt-4",children:["Transactions (",i.receipts_count,")"]}),l.jsx(Jm,{receipts:i.receipts,onViewReceipt:e})]})]})},mfe=({onViewReceipt:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(""),[i,s]=y.useState(null),[o,c]=y.useState(!1);y.useEffect(()=>{(async()=>{try{const h=((await Ee.get("/classes")).data.classes||[]).map(m=>m.class_name);r(h),h.length>0&&a(h[0])}catch(d){console.error("Failed to load classes",d)}})()},[]);const u=async()=>{if(n)try{c(!0);const f=await Ee.get(`/reports/fees/class-wise?class=${n}`);s(f.data)}catch(f){console.error(f)}finally{c(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-end gap-4 bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Class"}),l.jsx("select",{value:n,onChange:f=>a(f.target.value),className:"border p-2 rounded w-40",children:t.map(f=>l.jsx("option",{value:f,children:f},f))})]}),l.jsx("button",{onClick:u,className:"bg-violet-600 text-white px-4 py-2 rounded",children:"Get Report"})]}),o&&l.jsx("div",{children:"Loading..."}),i&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"p-4 bg-gray-50 rounded border",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Total Demand"}),l.jsxs("p",{className:"text-xl font-bold",children:["₹",i.total_fee.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"p-4 bg-green-50 rounded border",children:[l.jsx("p",{className:"text-sm text-green-600",children:"Collected"}),l.jsxs("p",{className:"text-xl font-bold text-green-700",children:["₹",i.collected.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"p-4 bg-red-50 rounded border",children:[l.jsx("p",{className:"text-sm text-red-600",children:"Due"}),l.jsxs("p",{className:"text-xl font-bold text-red-700",children:["₹",i.due.toLocaleString("en-IN")]})]})]}),l.jsx(Jm,{receipts:i.receipts,onViewReceipt:e})]})]})},gfe=({onViewReceipt:e})=>{const[t,r]=y.useState(""),[n,a]=y.useState(null),[i,s]=y.useState(!1),[o,c]=y.useState(""),u=async()=>{var f,d;if(t)try{s(!0),c("");const p=await Ee.get(`/reports/fees/installment-wise?installment=${t}`);a(p.data)}catch(p){c(((d=(f=p.response)==null?void 0:f.data)==null?void 0:d.error)||"Error fetching report")}finally{s(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-end gap-4 bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex-1 max-w-sm",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installment Name / Fee Type"}),l.jsx("input",{type:"text",placeholder:"e.g. Admission Fee, June Fee",value:t,onChange:f=>r(f.target.value),className:"border border-gray-300 rounded px-3 py-2 w-full"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter exact name as in fee structure"})]}),l.jsx("button",{onClick:u,className:"bg-violet-600 text-white px-4 py-2 rounded hover:bg-violet-700",children:"Search"})]}),i&&l.jsx("div",{children:"Loading..."}),o&&l.jsx("div",{className:"text-red-500",children:o}),n&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsx(vh,{label:"Total Demand",value:n.total_demand}),l.jsx(vh,{label:"Collected",value:n.collected,color:"green"}),l.jsx(vh,{label:"Due Amount",value:n.due,color:"red"}),l.jsx(vh,{label:"Paid Students",value:`${n.paid_students} / ${n.total_students}`})]}),l.jsx("h3",{className:"font-semibold text-lg mt-4",children:"Receipts"}),l.jsx(Jm,{receipts:n.receipts,onViewReceipt:e})]})]})},xfe=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),a=async()=>{try{n(!0);const i=await Ee.get("/reports/fees/due");t(i.data)}catch(i){console.error(i)}finally{n(!1)}};return y.useEffect(()=>{a()},[]),r?l.jsx("div",{children:"Loading due list..."}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-red-700",children:"Students with Due Fees"}),l.jsxs("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium",children:[e.length," Students"]})]}),l.jsxs("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Father Mobile"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Fee"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Amount"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(i=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.name})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.class," ",i.section]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.father_mobile}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:["₹",i.total_fee.toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-red-600 text-right",children:["₹",i.due_amount.toLocaleString("en-IN")]})]},i.student_id))})]}),e.length===0&&l.jsx("div",{className:"p-8 text-center text-gray-500",children:"No dues found."})]})]})},vfe=()=>{const[e,t]=y.useState("today"),[r,n]=y.useState(null),[a,i]=y.useState(!1),[s,o]=y.useState(""),c=async f=>{var d,p;try{i(!0),o("");const h=await Ee.get(`/reports/fees/receipt/${f}`);n(h.data)}catch(h){alert(((p=(d=h.response)==null?void 0:d.data)==null?void 0:p.error)||"Failed to load receipt")}finally{i(!1)}},u=[{id:"today",label:"Today's Collection"},{id:"daily",label:"Daily Report"},{id:"monthly",label:"Monthly Report"},{id:"class",label:"Class Wise"},{id:"installment",label:"Installment Wise"},{id:"due",label:"Due Report"}];return l.jsxs("div",{className:"container mx-auto p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx("span",{className:"bg-violet-100 text-violet-600 p-2 rounded mr-3",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),"Fee Reports"]}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-8 border-b border-gray-200 pb-1",children:u.map(f=>l.jsx("button",{onClick:()=>t(f.id),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${e===f.id?"bg-violet-600 text-white shadow-md":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:f.label},f.id))}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm min-h-[400px]",children:[e==="today"&&l.jsx(dfe,{onViewReceipt:c}),e==="daily"&&l.jsx(hfe,{onViewReceipt:c}),e==="monthly"&&l.jsx(pfe,{onViewReceipt:c}),e==="class"&&l.jsx(mfe,{onViewReceipt:c}),e==="installment"&&l.jsx(gfe,{onViewReceipt:c}),e==="due"&&l.jsx(xfe,{})]}),a&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex justify-center items-center z-50",children:l.jsx("div",{className:"bg-white p-4 rounded shadow",children:"Loading Receipt..."})}),r&&l.jsx(rj,{receiptData:r,onClose:()=>n(null)})]})},yfe=e=>{const t=()=>{const o=window.location.hash.replace("#","");return o||null},[r,n]=y.useState(()=>t()||e);y.useEffect(()=>{const o=()=>{const c=t();n(c||e)};return t()||(window.location.hash=e),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[e]);const a=y.useCallback(o=>{o!==r&&(window.location.hash=o)},[r]),i=y.useCallback(()=>{window.history.back()},[]),s=y.useCallback(()=>{window.history.forward()},[]);return{currentPage:r,navigateTo:a,goBack:i,goForward:s,canGoBack:!0,canGoForward:!0}},bfe=({onLogout:e})=>{const[t,r]=y.useState(!0),{currentPage:n,navigateTo:a,goBack:i,goForward:s,canGoBack:o,canGoForward:c}=yfe("dashboard"),u=()=>{r(!t)};return l.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[l.jsx(tF,{isOpen:t,toggleSidebar:u,navigateTo:a,currentPage:n}),l.jsxs("div",{className:"flex flex-col flex-1 overflow-y-auto overflow-x-hidden",children:[l.jsx(QO,{toggleSidebar:u,navigateTo:a,onLogout:e,goBack:i,goForward:s,canGoBack:o,canGoForward:c}),l.jsxs("main",{className:"flex-1",children:[n==="dashboard"&&l.jsx(lF,{navigateTo:a}),n==="profile"&&l.jsx(cF,{}),n==="fee"&&l.jsx(uF,{navigateTo:a}),n==="fee-type"&&l.jsx(fF,{}),n==="class-fee-structure"&&l.jsx(dF,{}),n==="assign-special-fee"&&l.jsx(hF,{}),n==="fee-installments"&&l.jsx(pF,{}),n==="take-fee"&&l.jsx(xF,{navigateTo:a}),n==="administration"&&l.jsx(vF,{navigateTo:a}),n==="academic"&&l.jsx(yF,{navigateTo:a}),n==="academics"&&l.jsx(uce,{}),n==="setup"&&l.jsx(nj,{pageTitle:"Setup Your School"}),n==="student-attendance"&&l.jsx(vA,{navigateTo:a}),n==="attendance-report"&&l.jsx(vA,{navigateTo:a,defaultTab:"absent-report"}),n==="student-administration"&&l.jsx(Sce,{navigateTo:a}),n==="concession-master"&&l.jsx(_ce,{}),n==="student-concession"&&l.jsx(Nce,{}),n==="update-student-fee-structure"&&l.jsx(Ace,{}),n==="fee-reports"&&l.jsx(vfe,{})]})]})]})},wfe=()=>{const[e,t]=y.useState(()=>!!localStorage.getItem("token")),r=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(!1)};return l.jsx(l.Fragment,{children:e?l.jsx(bfe,{onLogout:r}):l.jsx(HO,{onLoginSuccess:()=>t(!0)})})};$O.createRoot(document.getElementById("root")).render(l.jsx(nF,{children:l.jsx(wfe,{})}));export{pr as _};
