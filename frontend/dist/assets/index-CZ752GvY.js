const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DLGXPHiv.js","assets/vendor-DJxZ0Ldf.js","assets/ui-BsEHV9Sx.js"])))=>i.map(i=>d[i]);
var qO=Object.defineProperty;var GO=(e,t,r)=>t in e?qO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var zg=(e,t,r)=>GO(e,typeof t!="symbol"?t+"":t,r);import{r as Zm,a as VO,g as co,b as ij,c as q0}from"./vendor-DJxZ0Ldf.js";import{r as y,a as zy,R as YO,b as yf}from"./ui-BsEHV9Sx.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var $g={exports:{}},dd={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d5;function KO(){if(d5)return dd;d5=1;var e=Zm(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,u){var d,f={},m=null,h=null;u!==void 0&&(m=""+u),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(h=c.ref);for(d in c)n.call(c,d)&&!s.hasOwnProperty(d)&&(f[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:o,key:m,ref:h,props:f,_owner:a.current}}return dd.Fragment=r,dd.jsx=i,dd.jsxs=i,dd}var f5;function XO(){return f5||(f5=1,$g.exports=KO()),$g.exports}var l=XO(),G0={},h5;function JO(){if(h5)return G0;h5=1;var e=VO();return G0.createRoot=e.createRoot,G0.hydrateRoot=e.hydrateRoot,G0}var ZO=JO();const QO=co(ZO),eF=()=>{const e="https://erp-software-application.onrender.com";return e.endsWith("/api")?e:`${e}/api`},oj=eF(),tF=({onLoginSuccess:e})=>{const[t,r]=y.useState(""),[n,a]=y.useState(""),[s,i]=y.useState(""),[o,c]=y.useState(!1),u=async d=>{var f,m;d.preventDefault(),i(""),c(!0);try{localStorage.removeItem("branch"),localStorage.removeItem("location"),localStorage.removeItem("academicYear"),localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("currentBranch"),localStorage.removeItem("currentLocation");const h=await ij.post(`${oj}/users/login`,{username:t,password:n});console.log("Login successful:",h.data),console.log("Login successful:",h.data);try{h.data.token?(localStorage.setItem("token",h.data.token),console.log("Token saved to localStorage")):console.warn("No token found in login response"),h.data.user&&(localStorage.setItem("user",JSON.stringify(h.data.user)),console.log("User saved to localStorage"))}catch(p){console.warn("Could not persist to localStorage",p)}e(h.data.user),c(!1)}catch(h){console.error(h);const p=((m=(f=h==null?void 0:h.response)==null?void 0:f.data)==null?void 0:m.error)||(h==null?void 0:h.message)||"Invalid username or password";i(p),c(!1)}};return l.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 p-4",children:l.jsx("div",{className:"w-full max-w-sm mx-auto bg-white rounded-lg shadow-md",children:l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"text-center space-y-4 mb-8",children:[l.jsx("img",{src:"https://www.mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS Education Academy Logo",className:"mx-auto h-12 object-contain"}),l.jsx("p",{className:"text-gray-500",children:"Admin Login"})]}),l.jsxs("form",{className:"space-y-6",onSubmit:u,children:[l.jsxs("div",{className:"border border-gray-300 rounded-md",children:[l.jsxs("div",{className:"px-3 py-2 border-b border-gray-300",children:[l.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Username"}),l.jsx("input",{type:"text",required:!0,value:t,onChange:d=>r(d.target.value),className:"block w-full p-0 border-0 bg-transparent focus:ring-0 sm:text-sm"})]}),l.jsxs("div",{className:"px-3 py-2",children:[l.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Password"}),l.jsx("input",{type:"password",required:!0,value:n,onChange:d=>a(d.target.value),className:"block w-full p-0 border-0 bg-transparent focus:ring-0 sm:text-sm"})]})]}),s&&l.jsx("p",{className:"text-center text-sm text-red-600 pt-2",children:s}),l.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 px-4 text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-60",children:o?"Logging in...":"Login"})]})]})})})},rF=({className:e})=>l.jsx("svg",{className:e,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M4 6h16M4 12h16m-7 6h7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Al=({className:e})=>l.jsx("svg",{className:e,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),yi=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z"})}),nF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"})}),Rh=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})}),lj=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),$y=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"})}),nv=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM6.24 5h11.52l.83 1H5.42l.82-1zM5 19V8h14v11H5zm11-5.5-3.5 2-3.5-2V6h7v7.5z"})}),aF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"})}),sF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),cj=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})}),uj=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 1a9 9 0 0 0-9 9v7c0 1.66 1.34 3 3 3h3v-8H5v-2c0-3.87 3.13-7 7-7s7 3.13 7 7v2h-4v8h3c1.66 0 3-1.34 3-3v-7a9 9 0 0 0-9-9z"})}),iF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M13.66 7.5h-3.23l-.67 2h3.22c.9 0 1.63.74 1.63 1.64 0 .91-.73 1.64-1.63 1.64h-1.88l-2.02 5.06H6.18L8.21 13h1.89c.47 0 .86-.39.86-.86s-.39-.86-.86-.86H8.21l.67-2H12c.47 0 .86-.39.86-.86s-.39-.86-.86-.86H9.55L10.22 5h4.11l-1.34 2.5H13.66zM20 4H4c-1.11 0-2 .89-2 2v12c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.11-.9-2-2-2z"})}),Bh=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"})}),Ed=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"})}),m5=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})}),oF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"})}),dj=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})}),av=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),fj=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),lF=({className:e})=>l.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})}),ke=ij.create({baseURL:oj,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});ke.interceptors.request.use(e=>{var s;const t=localStorage.getItem("user"),r=localStorage.getItem("academicYear"),n=localStorage.getItem("currentBranch"),a=localStorage.getItem("token");if(a&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${a}`),t)try{const i=JSON.parse(t);n&&!n.toLowerCase().startsWith("all")?(e.headers=e.headers||{},e.headers["X-Branch"]=n):!n&&i.branch&&!i.branch.toLowerCase().startsWith("all")&&(e.headers=e.headers||{},e.headers["X-Branch"]=i.branch),i.location&&(e.headers=e.headers||{},e.headers["X-Location"]=i.location)}catch(i){console.error("Error parsing user data from localStorage:",i)}if(!((s=e.headers)!=null&&s["X-Academic-Year"])){const i=r||localStorage.getItem("academicYear");i&&(e.headers=e.headers||{},e.headers["X-Academic-Year"]=i)}return e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));ke.interceptors.response.use(e=>e,async e=>{var r,n,a,s,i;const t=e.config;return((r=e.response)==null?void 0:r.status)===401&&!t._retry?(t._retry=!0,localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("currentBranch"),localStorage.removeItem("academicYear"),window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject({...e,message:"Session expired. Please login again."})):(((n=e.response)==null?void 0:n.status)===403&&console.error("Access forbidden:",e.response.data),((a=e.response)==null?void 0:a.status)===404&&console.error("Resource not found:",(s=e.config)==null?void 0:s.url),((i=e.response)==null?void 0:i.status)===500&&console.error("Server error:",e.response.data),e.response?Promise.reject(e):(console.error("Network error - backend might be down:",e.message),Promise.reject({...e,message:"Cannot connect to server. Please check your internet connection."})))});const cF=({toggleSidebar:e,navigateTo:t,onLogout:r,goBack:n,goForward:a,canGoBack:s,canGoForward:i})=>{var A;const o=JSON.parse(localStorage.getItem("user")||"{}"),[c,u]=y.useState(!1),[d,f]=y.useState(!1),[m,h]=y.useState(!1),[p,g]=y.useState(!1),[v,b]=y.useState(localStorage.getItem("currentLocation")||"All"),[S,_]=y.useState([]),[E,P]=y.useState([]),[N,I]=y.useState([]);y.useEffect(()=>{o.role==="Admin"&&ke.get("/branches").then(D=>{D.data.branches&&_(D.data.branches)}).catch(D=>console.error("Header branch fetch error:",D))},[]);let k=((A=o==null?void 0:o.allowed_branches)==null?void 0:A.map(D=>D.branch_name))||[];if(o.role==="Admin"&&S.length>0)v==="All"?(k=S.map(D=>D.branch_name),k=["All",...k]):(k=S.filter(L=>{const M=(L.location_code||"").toUpperCase(),R=N.find(J=>J.code.toUpperCase()===M);return(R?R.name:"Hyderabad")===v}).map(L=>L.branch_name),k.length>1?k=["Select Branch",...k]:k.length===0&&(k=[]));else{k.length===0&&(o!=null&&o.branch&&(k=[o.branch]),(o==null?void 0:o.role)==="Admin"&&(k=["All",...k]));const D=k.length>1,L=k.includes("All")||(o==null?void 0:o.role)==="Admin";D&&!k.includes("All Branches")&&L&&(k=["All Branches",...k.filter(M=>M!=="All")])}const T=o&&(o.role==="Admin"||k.length>1),[q,F]=y.useState(localStorage.getItem("academicYear")||""),[j,U]=y.useState(()=>localStorage.getItem("currentBranch")||o.branch||"All"),B=D=>{localStorage.setItem("academicYear",D),F(D),u(!1),window.location.reload()},X=D=>{localStorage.setItem("currentLocation",D),b(D),g(!1);let L="All";if(D!=="All"&&S.length>0){const M=S.filter(R=>{const H=(R.location_code||"").toUpperCase(),J=N.find(Q=>Q.code.toUpperCase()===H);return(J?J.name:"Hyderabad")===D});M.length>0&&(L=M[0].branch_name)}else L="All";localStorage.setItem("currentBranch",L),U(L),window.location.reload()},K=D=>{const L=D==="All Branches"?"All":D;localStorage.setItem("currentBranch",L),U(L),h(!1),window.location.reload()},[ee,Y]=y.useState([]);y.useEffect(()=>{ke.get("/org/academic-years").then(D=>{const L=D.data.academic_years||[];if(Y(L.map(R=>R.name)),!localStorage.getItem("academicYear")&&L.length>0){const R=L[0].name;localStorage.setItem("academicYear",R),F(R)}}).catch(D=>console.error("Failed to load academic years in Header",D))},[]);const z=ee.length>0?ee:[],[ne,le]=y.useState(["All"]);return y.useEffect(()=>{o.role==="Admin"&&ke.get("/org/locations").then(D=>{const L=D.data.locations||[];I(L);const M=L.map(R=>R.name);le(["All",...M])}).catch(D=>console.error("Failed to load locations in Header",D))},[o.role]),l.jsx("header",{className:"bg-green-700 text-white shadow-md z-20",children:l.jsx("nav",{className:"container-fluid mx-auto px-4",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:e,className:"text-white hover:bg-green-600 p-2 rounded-md focus:outline-none md:hidden mr-2",children:l.jsx(rF,{className:"w-6 h-6"})}),l.jsx("a",{href:"#",onClick:()=>t("dashboard"),className:"flex items-center space-x-3",children:l.jsx("img",{src:"https://www.mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS Education Academy Logo",className:"h-12"})}),l.jsx("div",{className:"hidden md:flex items-center ml-4"})]}),l.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4",children:[o.role==="Admin"&&l.jsxs("div",{className:"relative mr-2",children:[l.jsxs("button",{onClick:()=>g(!p),onBlur:()=>setTimeout(()=>g(!1),200),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{className:"font-semibold",children:v==="All"?"All Locations":v}),l.jsx(Al,{className:"w-4 h-4"})]}),p&&l.jsx("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:ne.map(D=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:L=>{L.preventDefault(),X(D)},className:`block px-4 py-2 text-sm hover:bg-gray-100 ${v===D?"font-bold text-green-700 bg-green-100":""}`,children:D==="All"?"All Locations":D})},D))})]}),T?l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>h(!m),onBlur:()=>setTimeout(()=>h(!1),200),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{className:"font-semibold",children:j==="All"?"All Branches":j}),l.jsx(Al,{className:"w-4 h-4"})]}),m&&l.jsx("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700 max-h-60 overflow-auto",children:k.map(D=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:L=>{L.preventDefault(),K(D==="All Branches"?"All":D)},className:`block px-4 py-2 text-sm hover:bg-gray-100 ${j===(D==="All Branches"?"All":D)?"font-bold text-green-700":""}`,children:D})},D))})]}):l.jsx("div",{className:"flex items-center space-x-1 p-2 rounded-md",children:l.jsx("span",{className:"font-semibold",children:j==="All"?"All Branches":j})}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>u(!c),onBlur:()=>setTimeout(()=>u(!1),150),className:"flex items-center space-x-1 hover:bg-green-600 p-2 rounded-md focus:outline-none",children:[l.jsx("span",{children:q}),l.jsx(Al,{className:"w-4 h-4"})]}),c&&l.jsx("ul",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:z.map(D=>l.jsx("li",{children:l.jsx("a",{href:"#",onClick:L=>{L.preventDefault(),B(D)},className:"block px-4 py-2 text-sm hover:bg-gray-100",children:D})},D))})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>f(!d),onBlur:()=>setTimeout(()=>f(!1),150),className:"flex items-center space-x-2 focus:outline-none hover:bg-green-600 p-1 rounded-md",children:[l.jsx("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpve8QCCPBiCCxagjx5ei3qUSB_7UyDEepfg&s",alt:"Profile",className:"w-8 h-8 rounded-full object-cover"}),l.jsx("span",{className:"hidden md:inline",children:JSON.parse(localStorage.getItem("user")||"{}").username||"User"}),l.jsx(Al,{className:"w-4 h-4"})]}),d&&l.jsxs("ul",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700",children:[l.jsx("li",{children:l.jsxs("a",{href:"#",onClick:D=>{D.preventDefault(),t("profile"),f(!1)},className:"flex items-center px-4 py-2 text-sm hover:bg-gray-100",children:[l.jsx(yi,{className:"w-4 h-4 mr-2"})," Profile"]})}),l.jsx("li",{children:l.jsxs("button",{onClick:r,className:"w-full text-left flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none",children:[l.jsx(nF,{className:"w-4 h-4 mr-2"})," Logout"]})})]})]})]})]})})})},uF=[{title:"Dashboard",icon:l.jsx($y,{className:"w-5 h-5"}),page:"dashboard"},{title:"Academic",icon:l.jsx(nv,{className:"w-5 h-5"}),page:"academic"},{title:"Financial",icon:l.jsx(aF,{className:"w-5 h-5"}),page:"fee"},{title:"Administration",icon:l.jsx(sF,{className:"w-5 h-5"}),page:"administration"},{title:"Setup Your School",icon:l.jsx(cj,{className:"w-5 h-5"}),page:"setup"}],dF=({isOpen:e,toggleSidebar:t,navigateTo:r,currentPage:n})=>l.jsxs("aside",{className:`flex-shrink-0 bg-white border-r border-gray-200 flex flex-col transition-all duration-300 ${e?"w-64":"w-0 overflow-hidden md:w-20"} md:relative absolute h-full z-10 md:z-auto`,children:[l.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b",children:[l.jsx("span",{className:`font-semibold text-violet-700 ${!e&&"md:hidden"}`,children:"Menu"}),l.jsx("button",{onClick:t,className:"p-2 rounded-md hover:bg-gray-100 focus:outline-none",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-600",children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.875 12.0003C1.875 11.7019 1.99353 11.4157 2.2045 11.2048C2.41548 10.9938 2.70163 10.8753 3 10.8753H18.285L14.205 6.79526C14.0063 6.582 13.8981 6.29993 13.9032 6.00847C13.9084 5.71702 14.0264 5.43894 14.2326 5.23283C14.4387 5.02671 14.7168 4.90864 15.0082 4.9035C15.2997 4.89835 15.5817 5.00654 15.795 5.20526L21.795 11.2053C22.0057 11.4162 22.124 11.7021 22.124 12.0003C22.124 12.2984 22.0057 12.5843 21.795 12.7953L15.795 18.7953C15.692 18.9058 15.5678 18.9944 15.4298 19.0559C15.2918 19.1174 15.1428 19.1505 14.9918 19.1531C14.8407 19.1558 14.6907 19.128 14.5506 19.0714C14.4105 19.0149 14.2833 18.9306 14.1764 18.8238C14.0696 18.717 13.9854 18.5897 13.9288 18.4497C13.8722 18.3096 13.8444 18.1595 13.8471 18.0085C13.8498 17.8574 13.8828 17.7084 13.9443 17.5705C14.0058 17.4325 14.0945 17.3083 14.205 17.2053L18.285 13.1253H3C2.70163 13.1253 2.41548 13.0067 2.2045 12.7958C1.99353 12.5848 1.875 12.2986 1.875 12.0003Z",fill:"#464646"})})})]}),l.jsx("div",{className:"p-4",children:l.jsxs("p",{className:"text-sm text-gray-500",children:["School Code: ",l.jsx("span",{className:"font-semibold text-gray-800",children:"msacademy"})]})}),l.jsxs("nav",{className:"flex-1 px-2 space-y-1 overflow-y-auto",children:[uF.map(a=>l.jsxs("a",{href:"#",onClick:s=>{s.preventDefault(),r(a.page)},className:`flex items-center p-2 text-sm font-medium rounded-md group ${a.page===n?"bg-green-100 text-green-800":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[a.icon,l.jsx("span",{className:`ml-3 whitespace-nowrap ${!e&&"md:hidden"}`,children:a.title})]},a.title)),l.jsxs("div",{className:`pt-4 mt-4 border-t border-gray-200 ${!e&&"md:hidden"}`,children:[l.jsxs("a",{href:"#",className:"flex items-center p-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[l.jsx(uj,{className:"w-5 h-5"}),l.jsx("span",{className:"ml-3",children:"Staff Support"})]}),l.jsxs("a",{href:"#",onClick:a=>{a.preventDefault(),r("profile")},className:"flex items-center p-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[l.jsx(yi,{className:"w-5 h-5"}),l.jsx("span",{className:"ml-3",children:"My Details"})]})]})]})]}),hj=y.createContext(void 0),fF=()=>[],hF=({children:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(!0),[s,i]=y.useState(null);y.useEffect(()=>{if(!localStorage.getItem("token")){a(!1);return}a(!0),ke.get("/students").then(d=>{r(d.data.students||[]),i(null)}).catch(()=>i("Failed to load student data")).finally(()=>a(!1))},[]);const o=async u=>{r(d=>{const f=d.length?Math.max(...d.map(m=>m.sr))+1:1;return[{...u,sr:f,feeInstallments:u.feeInstallments||fF()},...d]})},c=async(u,d)=>{r(f=>f.map(m=>m.admNo===u?{...m,...d}:m))};return l.jsx(hj.Provider,{value:{students:t,loading:n,error:s,addStudent:o,updateStudent:c},children:e})},mF=()=>{const e=y.useContext(hj);if(!e)throw new Error("useSchool must be used inside SchoolProvider");return e},p5=({title:e,value:t,icon:r,color:n})=>l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex items-center space-x-4 border-l-4",style:{borderColor:n},children:[l.jsx("div",{className:"p-3 rounded-full",style:{backgroundColor:`${n}1A`,color:n},children:r}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:e}),l.jsx("p",{className:"text-xl font-semibold text-gray-800",children:t})]})]}),pF=()=>{const{students:e}=mF(),t=(localStorage.getItem("currentBranch")||"All").trim(),r=t.toLowerCase(),n=!r||r.startsWith("all"),s=JSON.parse(localStorage.getItem("user")||"{}").allowed_branches||[];let i=t;if(Array.isArray(s)){const f=s.find(m=>String(m.branch_id)===t);f&&(i=f.branch_name)}const o=n?e:e.filter(f=>{const m=(f.branch||"").toLowerCase().trim();return m===r||m===i.toLowerCase().trim()}),c=o.length,u=o.reduce((f,m)=>{const h=(m.feeInstallments||[]).filter(p=>!p.paid).reduce((p,g)=>p+(g.payable||0),0);return f+h},0),d=f=>`₹${f.toLocaleString("en-IN")}`;return l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[l.jsx(p5,{title:"Total Students",value:c,icon:l.jsx(yi,{className:"w-6 h-6"}),color:"#4f46e5"}),l.jsx(p5,{title:"Total Fee Dues",value:d(u),icon:l.jsx(iF,{className:"w-6 h-6"}),color:"#db2777"})]})},gF=({navigateTo:e})=>{var u;const t=[{name:"Fee",icon:"https://cdn-icons-png.flaticon.com/512/1001/1001096.png",page:"fee"},{name:"Admission",icon:"https://cdn-icons-png.flaticon.com/512/3063/3063820.png",page:"dashboard"},{name:"Account",icon:"https://cdn-icons-png.flaticon.com/512/272/272997.png",page:"dashboard"},{name:"Student",icon:"https://cdn-icons-png.flaticon.com/512/921/921347.png",page:"dashboard"},{name:"Staff",icon:"https://cdn-icons-png.flaticon.com/512/2940/2940626.png",page:"dashboard"}],r=localStorage.getItem("user"),n=r?JSON.parse(r):null;let a=[];n!=null&&n.allowed_branches&&Array.isArray(n.allowed_branches)&&(a=n.allowed_branches.map(d=>({id:String(d.branch_id),name:d.branch_name}))),a.length===0&&(n!=null&&n.branch)&&(a=[{id:n.branch,name:n.branch}]);const s=(n==null?void 0:n.role)==="Admin",i=a.some(d=>d.id==="All"||d.name==="All");s&&!i&&(a=[{id:"All",name:"All Branches"},...a]),a.length>1;const[o,c]=y.useState(()=>{const d=localStorage.getItem("currentBranch");return d||(s?"All":a.length>0?a[0].id:"All")});return(u=a.find(d=>d.id===o))!=null&&u.name,l.jsx("div",{className:"bg-white shadow-sm",children:l.jsx("div",{className:"container-fluid mx-auto px-4",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap",children:[l.jsx("div",{className:"py-4 flex items-center",children:l.jsxs("h2",{className:"text-xl text-gray-800 mr-4",children:["Welcome, ",l.jsx("span",{className:"font-semibold",children:(n==null?void 0:n.username)||"User"})]})}),l.jsx("div",{className:"flex items-center space-x-1 sm:space-x-4 overflow-x-auto py-2",children:t.map((d,f)=>l.jsxs("a",{href:"#",onClick:m=>{m.preventDefault(),e(d.page)},className:"flex-shrink-0 text-center p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 w-24",children:[l.jsx("img",{src:d.icon,alt:d.name,className:"h-8 w-8 mx-auto object-contain"}),l.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:d.name})]},f))})]})})})},xF=()=>l.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[l.jsx(pF,{}),l.jsx("div",{className:"relative max-w-sm mx-auto",children:l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"})})]}),vF=({navigateTo:e})=>l.jsxs(l.Fragment,{children:[l.jsx(gF,{navigateTo:e}),l.jsx(xF,{})]}),yF=()=>{const[e,t]=y.useState("AUDIT-MN"),[r,n]=y.useState(""),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState(""),[d,f]=y.useState(""),[m,h]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState(""),[S,_]=y.useState("User"),[E,P]=y.useState(""),[N,I]=y.useState([]),[k,T]=y.useState([]),[q,F]=y.useState([]),[j,U]=y.useState({type:"",msg:""}),[B,X]=y.useState(!1);y.useEffect(()=>{const Y=JSON.parse(localStorage.getItem("user")||"{}"),z=localStorage.getItem("currentBranch");(async()=>{try{const[le,A]=await Promise.all([ke.get("/branches"),ke.get("/org/locations")]);I(le.data.branches||[]),F(A.data.locations||[])}catch(le){console.error("Failed to fetch branches/locations",le)}})(),Y.role==="Admin"?z&&z!=="All"?T([z]):X(!1):Y.branch&&(T([Y.branch]),X(!0))},[]),y.useEffect(()=>{if(k.includes("All")){P("All");return}if(k.length===1&&q.length>0){const Y=N.find(z=>z.branch_code.toLowerCase()===k[0].toLowerCase()||z.branch_name.toLowerCase()===k[0].toLowerCase());if(Y){const z=(Y.location_code||"").toUpperCase(),ne=q.find(le=>le.code.toUpperCase()===z);ne&&P(ne.name)}}else k.length===0?P(""):k.length>1&&P("Multiple")},[k,N,q]);const K=Y=>{if(B)return;if(Y==="All"){k.includes("All")?T([]):T(["All"]);return}let z=k.filter(ne=>ne!=="All");k.includes(Y)?z=z.filter(ne=>ne!==Y):z.push(Y),T(z)},ee=async Y=>{var ne,le;if(Y.preventDefault(),U({type:"",msg:""}),!p||!v){U({type:"error",msg:"Username and Password are required."});return}const z={username:p,password:v,branches:k.length>0?k:S==="Admin"?["All"]:[],branch:k[0]||"North",location:E,role:S};console.log("Sending Add User Payload:",z);try{await ke.post("/users/add",z),U({type:"success",msg:"User created successfully!"}),g(""),b(""),T([]),_("User")}catch(A){const D=((le=(ne=A.response)==null?void 0:ne.data)==null?void 0:le.error)||"Failed to create user.";U({type:"error",msg:D})}};return l.jsxs("div",{className:"container mx-auto p-4 md:p-6",children:[l.jsx("div",{className:"mb-6",children:l.jsx("h4",{className:"text-xl font-semibold text-gray-700",children:"CHANGE USERNAME/PASSWORD"})}),l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsx("form",{children:l.jsxs("div",{className:"space-y-4 border border-gray-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Change Username"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtuserName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",id:"txtuserName",name:"txtuserName",maxLength:100,value:e,onChange:Y=>t(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})}),l.jsx("form",{children:l.jsxs("div",{className:"space-y-4 border border-green-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Change Password"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtNewPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"password",id:"txtNewPassword",name:"txtNewPassword",maxLength:99,value:r,onChange:Y=>n(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtConfirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),l.jsx("input",{type:"password",id:"txtConfirmPassword",name:"txtConfirmPassword",maxLength:20,value:a,onChange:Y=>s(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save Password"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})}),l.jsx("form",{className:"lg:col-span-2",children:l.jsxs("div",{className:"space-y-4 border border-gray-200 p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Teacher Detail"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtteacherfirstname",className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"txtteacherfirstname",name:"txtteacherfirstname",maxLength:100,value:i,onChange:Y=>o(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"txtteacherLastName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"txtteacherLastName",name:"txtteacherLastName",maxLength:100,value:c,onChange:Y=>u(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtteacheremail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",id:"txtteacheremail",name:"txtteacheremail",maxLength:100,value:d,onChange:Y=>f(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"txtTMobile",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile"}),l.jsx("input",{type:"tel",id:"txtTMobile",name:"txtTMobile",maxLength:100,value:m,onChange:Y=>h(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{type:"button",className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none",children:"Cancel"})]})]})})]}),l.jsx("div",{className:"mt-8",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-blue-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4",children:"Add User (Admin Only)"}),j.msg&&l.jsx("div",{className:`p-4 mb-4 rounded-md ${j.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:j.msg}),l.jsxs("form",{onSubmit:ee,children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"newUserName",className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",id:"newUserName",value:p,onChange:Y=>g(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter username"})]}),l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"newUserPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"password",id:"newUserPassword",value:v,onChange:Y=>b(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allowed Branches"}),l.jsxs("div",{className:"border border-gray-300 rounded-md p-2 h-32 overflow-y-auto bg-white",children:[l.jsxs("div",{className:"flex items-center space-x-2 p-1",children:[l.jsx("input",{type:"checkbox",checked:k.includes("All"),onChange:()=>K("All")}),l.jsx("span",{className:"text-sm",children:"All Branches"})]}),N.map(Y=>l.jsxs("div",{className:"flex items-center space-x-2 p-1 border-t border-gray-100",children:[l.jsx("input",{type:"checkbox",checked:k.includes(Y.branch_code),onChange:()=>K(Y.branch_code),disabled:B||k.includes("All")}),l.jsx("span",{className:"text-sm",children:Y.branch_name})]},Y.branch_code))]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select multiple or All"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newUserLocation",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),l.jsx("input",{type:"text",id:"newUserLocation",value:E,onChange:Y=>P(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newUserRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),l.jsxs("select",{id:"newUserRole",value:S,onChange:Y=>_(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"User",children:"User"}),l.jsx("option",{value:"Admin",children:"Admin"})]})]})]}),l.jsx("div",{className:"mt-6",children:l.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create User"})})]})]})})]})]})},bF=({navigateTo:e})=>{const[t,r]=y.useState(null),n=u=>{r(t===u?null:u)},a=()=>{setTimeout(()=>r(null),150)},s=u=>{u==="Fee Type"?e("fee-type"):u==="Create Class Fee Structure"?e("class-fee-structure"):u==="Fee Installments"?e("fee-installments"):u==="Assign Special Fee Type"?e("assign-special-fee"):u==="Concession Template"?e("concession-master"):u==="Update Student Fee Structure"&&e("update-student-fee-structure"),r(null)},i="px-4 py-2 text-sm border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",o={feeMasters:["Fee Type","Fee Installments","Assign Special Fee Type","Create Class Fee Structure","Update Student Fee Structure"],concession:[{name:"Concession Template",action:()=>e("concession-master")},{name:"Set Student Concession",action:()=>e("student-concession")},{name:"Paid Concession Report",action:()=>console.log("Paid Concession Report")},{name:"Expected Concession Report",action:()=>console.log("Expected Concession Report")}],refund:["Refund/TC Requests","Refund Fee","Refundable Fees Refund Report","Refundable Fees Deposit Report","Refund Report","Refund Cancel Report","Adjust Fee","Adjust Fee Report","Nullify Fee","Nullify Fee Report"]},c=(u,d)=>l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>n(u),onBlur:a,className:`${i} flex items-center capitalize`,children:[u.replace(/([A-Z])/g," $1").trim()," ",l.jsx(Al,{className:"w-4 h-4 ml-1"})]}),t===u&&l.jsx("ul",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-30 text-gray-700 border max-h-60 overflow-y-auto",children:d.map((f,m)=>{const h=typeof f=="string"?f:f.name,p=typeof f=="string"?()=>s(f):f.action;return l.jsx("li",{children:l.jsx("a",{href:"#",onClick:g=>{g.preventDefault(),p()},className:"block px-4 py-2 text-sm hover:bg-gray-100",children:h})},m)})})]});return l.jsxs("div",{children:[l.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:l.jsxs("div",{className:"container-fluid mx-auto flex justify-between items-center p-4",children:[l.jsxs("h2",{className:"text-2xl font-semibold text-slate-900 flex items-center",children:[l.jsx("span",{className:"text-blue-600 mr-2",children:"₹"})," Fee Management"]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c("feeMasters",o.feeMasters),l.jsx("button",{className:"px-4 py-2 text-sm border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",onClick:()=>e("fee-reports"),children:"Fee Reports"}),l.jsx("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors shadow-sm",onClick:()=>{console.log("Fee Payment button clicked, navigating to take-fee"),e("take-fee")},children:"Take Fee"}),c("concession",o.concession),c("refund",o.refund)]})]})}),l.jsx("div",{className:"container mx-auto p-6",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:[l.jsx("div",{className:"text-slate-400 mb-4",children:l.jsx("svg",{className:"w-24 h-24 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("h3",{className:"text-2xl font-semibold text-slate-900 mb-2",children:"Fee Management Dashboard"}),l.jsx("p",{className:"text-slate-600 mb-6",children:'Click "Take Fee" button above to collect fees from students.'}),l.jsx("button",{onClick:()=>e("take-fee"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors shadow-sm font-medium",children:"Collect Due Fees"})]})})]})},wF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),[a,s]=y.useState({fee_type:"",category:"",fee_type_group:"",type:"Installment",display_name:"",is_refundable:!1,description:"",branch:"All",academic_year:localStorage.getItem("academicYear")||""}),[i,o]=y.useState(null),[c,u]=y.useState([]),[d,f]=y.useState(""),[m,h]=y.useState(new Set),[p,g]=y.useState(!1),[v,b]=y.useState(!1),S=y.useRef(null);y.useEffect(()=>{function X(K){S.current&&!S.current.contains(K.target)&&g(!1)}return document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}},[]),y.useEffect(()=>{const X=JSON.parse(localStorage.getItem("user")||"{}");let K=localStorage.getItem("currentBranch")||"All";X.role!=="Admin"&&X.branch&&X.branch!=="All"&&X.branch!=="All Branches"&&(K=X.branch),s(ee=>({...ee,branch:K})),_(),K&&K!=="All"&&K!=="All Branches"&&ke.get("/branches").then(ee=>{const Y=ee.data.branches||ee.data||[],z=Y.map(le=>({id:le.id,name:le.branch_name,location_name:le.location_name||"Unknown Location"}));u(z);const ne=Y.find(le=>le.branch_name.toLowerCase()===K.toLowerCase());ne&&f(ne.id)}).catch(ee=>console.error("Error fetching branches:",ee))},[]);const _=async()=>{try{const K=(await ke.get("/fee-types")).data,ee=Array.isArray(K)?K:K.fee_types||[],Y=JSON.parse(localStorage.getItem("user")||"{}");let z=localStorage.getItem("currentBranch")||"All";Y.role!=="Admin"&&Y.branch&&Y.branch!=="All"&&Y.branch!=="All Branches"&&(z=Y.branch);const ne=z==="All"||z==="All Branches"?ee:ee.filter(le=>!le.branch||le.branch==="All"||le.branch===z);t(ne)}catch(X){console.error("Error fetching fee types:",X)}},E=X=>{const{name:K,value:ee,type:Y}=X.target;if(Y==="checkbox"){const z=X.target.checked;s(ne=>({...ne,[K]:z}))}else s(z=>({...z,[K]:ee}))},P=async X=>{X.preventDefault();try{const K=JSON.parse(localStorage.getItem("user")||"{}");let ee=localStorage.getItem("currentBranch")||"All";K.role!=="Admin"&&K.branch&&K.branch!=="All"&&K.branch!=="All Branches"&&(ee=K.branch);const Y={...a,branch:a.branch||ee||"All"};i?await ke.put(`/fee-types/${i}`,Y):await ke.post("/fee-types",Y),k(),_()}catch(K){console.error("Error saving fee type:",K),alert("Error saving fee type. Please try again.")}},N=X=>{s(X),o(X.id||null),n(!0)},I=async X=>{if(window.confirm("Are you sure you want to delete this fee type?"))try{await ke.delete(`/fee-types/${X}`),_()}catch(K){console.error("Error deleting fee type:",K),alert("Error deleting fee type. Please try again.")}},k=()=>{s({fee_type:"",category:"",fee_type_group:"",type:"Installment",display_name:"",is_refundable:!1,description:"",branch:localStorage.getItem("currentBranch")||"All",academic_year:localStorage.getItem("academicYear")||""}),o(null),n(!1)},T=X=>{const K=new Set(m);K.has(X)?K.delete(X):K.add(X),h(K)},q=async()=>{var X,K;if(m.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy Fee Types to ${m.size} branches?`)){b(!0);try{await ke.post("/fees/copy-fee-types",{source_branch_id:d,target_branch_ids:Array.from(m),academic_year:localStorage.getItem("academicYear")||""}),alert("Fee Types copied successfully!"),h(new Set),g(!1)}catch(ee){console.error("Copy failed",ee),alert(((K=(X=ee.response)==null?void 0:X.data)==null?void 0:K.error)||"Failed to copy fee types.")}finally{b(!1)}}},F=c.filter(X=>String(X.id)!==String(d)&&X.name!=="All Branches"&&X.name!=="All"),j={};F.forEach(X=>{j[X.location_name]||(j[X.location_name]=[]),j[X.location_name].push(X)});const U=localStorage.getItem("currentBranch"),B=U&&U!=="All"&&U!=="All Branches";return l.jsxs("div",{className:"container mx-auto p-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Fee Types"}),l.jsxs("div",{className:"flex gap-2",children:[B&&l.jsxs("div",{className:"relative",ref:S,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>g(!p),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),p&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(j).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(j).map(X=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:X}),l.jsx("div",{className:"py-1",children:j[X].map(K=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:m.has(String(K.id)),onChange:()=>T(String(K.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:K.name})]},K.id))})]},X)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[m.size," selected"]}),l.jsx("button",{onClick:q,disabled:v||m.size===0,className:`px-3 py-1 text-xs text-white rounded ${v||m.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:v?"Copying...":"Confirm Copy"})]})]})]}),l.jsxs("button",{onClick:()=>n(!r),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md flex items-center gap-2",children:[l.jsx("span",{children:"⊕"})," Add New Fee Type"]})]})]})}),r&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:i?"Edit Fee Type":"Add New Fee Type"}),l.jsxs("form",{onSubmit:P,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Fee Type ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",name:"fee_type",value:a.fee_type,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"e.g., Transport Fee"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Category"}),l.jsxs("select",{name:"category",value:a.category,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Fee category"}),l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Tuition",children:"Tuition"}),l.jsx("option",{value:"Transport",children:"Transport"}),l.jsx("option",{value:"Hostel",children:"Hostel"}),l.jsx("option",{value:"Library",children:"Library"}),l.jsx("option",{value:"Sports",children:"Sports"}),l.jsx("option",{value:"Examination",children:"Examination"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsx("input",{type:"text",name:"branch",value:a.branch,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("input",{type:"text",name:"academic_year",value:a.academic_year,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type Group"}),l.jsxs("select",{name:"fee_type_group",value:a.fee_type_group,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Fee Type Group"}),l.jsx("option",{value:"Standard",children:"Standard"}),l.jsx("option",{value:"Special",children:"Special"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),l.jsx("input",{type:"text",name:"display_name",value:a.display_name,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Display name for receipts"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),l.jsxs("select",{name:"type",value:a.type,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"Installment",children:"Installment"}),l.jsx("option",{value:"One-Time",children:"One-Time"})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",name:"is_refundable",id:"is_refundable",checked:a.is_refundable,onChange:E,className:"w-4 h-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500"}),l.jsx("label",{htmlFor:"is_refundable",className:"ml-2 text-sm text-gray-700",children:"Is Fee Refundable?"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("textarea",{name:"description",value:a.description,onChange:E,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Optional description"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Reset"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-md",children:"✓ Save Fee Type"})]})]})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type Group"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Display Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Refundable"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:'No fee types found. Click "Add New Fee Type" to create one.'})}):e.map(X=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:X.fee_type}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${!X.branch||X.branch==="All"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:X.branch||"All"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.category||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.fee_type_group||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:X.type})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.display_name||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${X.is_refundable?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:X.is_refundable?"Yes":"No"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>N(X),className:"text-blue-600 hover:text-blue-900 px-3 py-1 bg-blue-50 rounded",children:"✎ Edit"}),l.jsx("button",{onClick:()=>X.id&&I(X.id),className:"text-red-600 hover:text-red-900 px-3 py-1 bg-red-50 rounded",children:"🗑 Delete"})]})})]},X.id))})]})})})]})},SF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState(["Standard"]),[i,o]=y.useState(""),[c,u]=y.useState(localStorage.getItem("academicYear")||""),[d,f]=y.useState("Standard"),[m,h]=y.useState(""),[p,g]=y.useState("Hyderabad"),[v,b]=y.useState(!1),[S,_]=y.useState([]),[E,P]=y.useState([]),[N,I]=y.useState(!1),[k,T]=y.useState(!1),[q,F]=y.useState("All"),[j,U]=y.useState(!1),[B,X]=y.useState([]),[K,ee]=y.useState(""),[Y,z]=y.useState(new Set),[ne,le]=y.useState(!1),[A,D]=y.useState(!1),L=y.useRef(null);y.useEffect(()=>{function ge(pe){L.current&&!L.current.contains(pe.target)&&le(!1)}return document.addEventListener("mousedown",ge),()=>{document.removeEventListener("mousedown",ge)}},[]),y.useEffect(()=>{const ge=JSON.parse(localStorage.getItem("user")||"{}");b(ge.role==="Admin"),ge.location&&g(ge.location);let pe=localStorage.getItem("currentBranch")||"All";ge.role!=="Admin"&&ge.branch&&ge.branch!=="All"&&ge.branch!=="All Branches"&&(pe=ge.branch),F(pe),U(pe==="All"||pe==="All Branches");const Le=localStorage.getItem("currentLocation");ke.get("/branches").then(Pe=>{const Oe=Pe.data.branches||Pe.data||[],Ve=Oe.map(et=>({id:et.id,name:et.branch_name,location_name:et.location_name||"Unknown Location"}));if(X(Ve),pe&&pe!=="All"&&pe!=="All Branches"){const et=Oe.find(_t=>_t.branch_name.toLowerCase()===pe.toLowerCase());if(et){ee(et.id);const _t={HYD:"Hyderabad",MUM:"Mumbai"},Tt=(et.location_code||"").toUpperCase();let At=_t[Tt]||"Hyderabad";g(At)}}else g(Le&&Le!=="All"?Le:"All")}).catch(Pe=>console.error("Error fetching branch info:",Pe)),M(),H()},[]);const M=async()=>{try{const ge=await ke.get("/fee-types");t(ge.data.fee_types||[])}catch(ge){console.error("Error fetching fee types:",ge)}};y.useEffect(()=>{i&&c&&R()},[i,c,p,q]);const R=async()=>{try{const ge=q,pe=ge==="All Branches"||ge==="All"?"All":ge,Le=(await ke.get("/class-fee-structure",{params:{class:i,academic_year:c,branch:pe,location:p}})).data.fee_structures;if(Le&&Le.length>0){const Pe=[],Oe=[];Le.forEach(Ve=>{const et={id:Ve.id,fee_type_id:Ve.fee_type_id,fee_type_name:Ve.fee_type_name,total_amount:Ve.total_amount,is_new_admission:Ve.is_new_admission,installments:Ve.installments};Ve.is_new_admission?Pe.push(et):Oe.push(et),Ve.fee_group&&f(Ve.fee_group)}),_(Pe),P(Oe)}else _([]),P([])}catch(ge){console.error("Error fetching existing fee structures:",ge)}},H=async()=>{try{const pe=(await ke.get("/classes")).data.classes.map(Ae=>Ae.class_name);n(pe)}catch(ge){console.error("Error fetching classes:",ge)}},J=async(ge,pe,Ae)=>{if(j){alert("Please select a specific branch to add fee structures.");return}const Le=e.find(et=>et.id===ge);if(!Le)return;if((Ae?S:E).some(et=>et.fee_type_id===ge)){alert(`Fee type "${Le.fee_type}" already exists in the list.`);return}let Oe=[];if(Le.type==="Installment")try{const et=localStorage.getItem("currentBranch")||"All",_t=et==="All Branches"||et==="All"?"All":et,At=(await ke.get("/installment-schedule",{params:{fee_type_id:ge,branch:_t}})).data.installments||[];if(At.length>0){const pt=At.length,lt=Math.floor(pe/pt/10)*10,rt=pe-lt*pt;Oe=At.map((Zt,jt)=>({month:Zt.title,amount:jt===0?lt+rt:lt,month_order:Zt.installment_no}))}else{alert("Installments not created for this fee type. Please configure installments first.");return}}catch(et){console.error("Error fetching installments:",et),alert("Error fetching installment schedule. Please try again.");return}const Ve={fee_type_id:ge,fee_type_name:Le.fee_type,total_amount:pe,is_new_admission:Ae,installments:Oe};Ae?_([...S,Ve]):P([...E,Ve])},G=async(ge,pe)=>{var Pe,Oe;const Le=(pe?S:E)[ge];if(Le.id){if(!window.confirm("Are you sure you want to delete this fee structure? This will also remove it from all students in this class."))return;try{await ke.delete(`/class-fee-structure/${Le.id}`),alert("Fee structure deleted successfully from database and student records!")}catch(et){console.error("Error deleting fee structure:",et),alert(`Error: ${((Oe=(Pe=et.response)==null?void 0:Pe.data)==null?void 0:Oe.error)||"Failed to delete fee structure"}`);return}}pe?_(S.filter((Ve,et)=>et!==ge)):P(E.filter((Ve,et)=>et!==ge))},Q=(ge,pe)=>{const Ae=pe?[...S]:[...E],Le=Ae[ge];if(Le.installments.length===0)return;const Pe=Le.total_amount,Oe=Le.installments.length,Ve=Math.floor(Pe/Oe/10)*10,et=Pe-Ve*Oe,_t=Le.installments.map((Tt,At)=>({...Tt,amount:At===0?Ve+et:Ve}));Le.installments=_t,pe?_(Ae):P(Ae)},de=(ge,pe,Ae,Le)=>{const Pe=Le?[...S]:[...E];Pe[ge].installments[pe].amount=Ae;const Oe=Pe[ge].installments.reduce((Ve,et)=>Ve+et.amount,0);Pe[ge].total_amount=Oe,Le?_(Pe):P(Pe)},V=async()=>{var Pe,Oe;if(j){alert("Class Fee Structure cannot be created at All Branches level. Please select a specific branch.");return}if(!i||!c){alert("Please select class and academic year");return}const ge=[...S,...E],pe=q,Le={class:i,academic_year:c,fee_group:d,branch:pe==="All Branches"||pe==="All"?"All":pe,location:p,fees:ge.map(Ve=>{let et=0;return Ve.installments&&Ve.installments.length>0&&(et=Ve.installments[0].amount),{id:Ve.id,fee_type_id:Ve.fee_type_id,total_amount:Ve.total_amount,monthly_amount:et,is_new_admission:Ve.is_new_admission,installments:Ve.installments,location:p}})};try{await ke.post("/class-fee-structure",Le),alert("Fee structure saved successfully!"),Ee()}catch(Ve){console.error("Error saving fee structure:",Ve);const et=((Oe=(Pe=Ve.response)==null?void 0:Pe.data)==null?void 0:Oe.error)||"Failed to save fee structure";alert(`Error: ${et}`)}},Ee=()=>{_([]),P([]),I(!1),T(!1)},we=ge=>{const pe=new Set(Y);pe.has(ge)?pe.delete(ge):pe.add(ge),z(pe)},he=async()=>{var ge,pe;if(Y.size===0){alert("Please select at least one branch to copy to.");return}if(!i){alert("Please select a class first.");return}if(confirm(`Are you sure you want to copy fee structure for ${i} to ${Y.size} branches?
(Merge Mode: Only missing fee types will be added)`)){D(!0);try{await ke.post("/fees/copy-class-fee-structure",{source_branch_id:K,target_branch_ids:Array.from(Y),academic_year:c,class:i}),alert("Fee structure copied successfully!"),z(new Set),le(!1)}catch(Ae){console.error("Copy failed",Ae),alert(((pe=(ge=Ae.response)==null?void 0:ge.data)==null?void 0:pe.error)||"Failed to copy fee structure.")}finally{D(!1)}}},Z=B.filter(ge=>String(ge.id)!==String(K)&&ge.name!=="All Branches"&&ge.name!=="All"),Se={};return Z.forEach(ge=>{Se[ge.location_name]||(Se[ge.location_name]=[]),Se[ge.location_name].push(ge)}),l.jsx("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Create Class Fee Structure"}),j&&l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-yellow-700",children:[l.jsx("span",{className:"font-bold",children:'Cannot create fee structure in "All Branches" mode.'}),l.jsx("br",{}),"Please select a specific branch from the header to create or modify fee structures."]})})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),l.jsxs("select",{value:i,onChange:ge=>o(ge.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",children:[l.jsx("option",{value:"",children:"Select Class"}),r.map(ge=>l.jsx("option",{value:ge,children:ge},ge))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year *"}),l.jsx("input",{type:"text",value:c,readOnly:!0,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed"})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fee for New Admissions"}),l.jsx("button",{onClick:()=>I(!N),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:N?"Cancel":"+ Add Fee"})]}),N&&l.jsx(g5,{feeTypes:e,onAdd:(ge,pe)=>{J(ge,pe,!0),I(!1)}}),l.jsx(x5,{fees:S,onRemove:ge=>G(ge,!0),onUpdateInstallment:(ge,pe,Ae)=>de(ge,pe,Ae,!0),onRecalculate:ge=>Q(ge,!0)})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fee Structure for Existing Students"}),l.jsx("button",{onClick:()=>T(!k),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:k?"Cancel":"+ Add Fee"})]}),k&&l.jsx(g5,{feeTypes:e,onAdd:(ge,pe)=>{J(ge,pe,!1),T(!1)}}),l.jsx(x5,{fees:E,onRemove:ge=>G(ge,!1),onUpdateInstallment:(ge,pe,Ae)=>de(ge,pe,Ae,!1),onRecalculate:ge=>Q(ge,!1)})]}),l.jsxs("div",{className:"flex justify-between items-center gap-4 mt-8 pt-4 border-t",children:[l.jsx("div",{children:!j&&i&&l.jsxs("div",{className:"relative",ref:L,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>le(!ne),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),ne&&l.jsxs("div",{className:"absolute bottom-12 left-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(Se).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(Se).map(ge=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:ge}),l.jsx("div",{className:"py-1",children:Se[ge].map(pe=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:Y.has(String(pe.id)),onChange:()=>we(String(pe.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:pe.name})]},pe.id))})]},ge)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[Y.size," selected"]}),l.jsx("button",{onClick:he,disabled:A||Y.size===0,className:`px-3 py-1 text-xs text-white rounded ${A||Y.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:A?"Copying...":"Confirm Copy"})]})]})]})}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:Ee,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Reset"}),l.jsx("button",{onClick:V,className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 shadow-md",children:"Save Fee Structure"})]})]})]})})},g5=({feeTypes:e,onAdd:t})=>{const[r,n]=y.useState(""),[a,s]=y.useState(""),i=()=>{r&&a&&(t(parseInt(r),parseFloat(a)),n(""),s(""))};return l.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4 border border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:r,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[l.jsx("option",{value:"",children:"Select Fee Type"}),e.map(o=>l.jsxs("option",{value:o.id,children:[o.fee_type," (",o.type,")"]},o.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),l.jsx("input",{type:"number",value:a,onChange:o=>s(o.target.value),placeholder:"12000",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx("button",{onClick:i,className:"w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Add Fee"})})]})})},x5=({fees:e,onRemove:t,onUpdateInstallment:r,onRecalculate:n})=>e.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-md border border-gray-200",children:"No fees added yet"}):l.jsx("div",{className:"space-y-4",children:e.map((a,s)=>l.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-50 px-4 py-3 flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800",children:a.fee_type_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Total: ₹",a.total_amount.toLocaleString()]})]}),l.jsxs("div",{className:"flex gap-2",children:[a.installments.length>0&&l.jsx("button",{onClick:()=>n(s),className:"px-3 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 text-sm",title:"Recalculate installments based on total amount",children:"Recalculate"}),l.jsx("button",{onClick:()=>t(s),className:"px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-sm",children:"Remove"})]})]}),a.installments.length>0&&l.jsxs("div",{className:"p-4 bg-white",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Monthly Installments:"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:a.installments.map((i,o)=>l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-xs text-gray-600 mb-1",children:i.month}),l.jsx("input",{type:"number",value:i.amount,onChange:c=>r(s,o,parseFloat(c.target.value)||0),className:"px-2 py-1 border border-gray-300 rounded text-sm"})]},o))})]})]},s))}),_F=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState([]),[i,o]=y.useState(""),[c,u]=y.useState(""),[d,f]=y.useState("All"),[m,h]=y.useState(!1),[p,g]=y.useState(localStorage.getItem("academicYear")||""),[v,b]=y.useState(!1),[S,_]=y.useState([]),[E,P]=y.useState([]),[N,I]=y.useState([]),[k,T]=y.useState(!1),[q,F]=y.useState(!1),[j,U]=y.useState(null),[B,X]=y.useState(new Set);y.useEffect(()=>{const M=JSON.parse(localStorage.getItem("user")||"{}"),R=localStorage.getItem("currentBranch");h(M.role==="Admin"),M.role==="Admin"?R&&R!=="All"?(f(R),b(!0)):(f("All"),b(!1)):M.branch&&(f(M.branch),b(!0)),K()},[]),y.useEffect(()=>{Y()},[i]),y.useEffect(()=>{i?ee(i):n([])},[i]),y.useEffect(()=>{i&&c?z():_([])},[i,c,d]);const K=async()=>{try{const M=await ke.get("/classes");if(M.data&&Array.isArray(M.data.classes)){const R=M.data.classes.map(H=>String(H.class_name));t([...new Set(R)])}else t([])}catch(M){console.error("Error fetching classes:",M),U("Failed to load classes.")}},ee=async M=>{try{const R=await ke.get(`/sections?class=${M}`);R.data&&Array.isArray(R.data.sections)?n(R.data.sections):n(["A","B","C","D"])}catch(R){console.error("Error fetching sections:",R),n(["A","B","C","D"])}},Y=async()=>{try{let R=(await ke.get("/fee-types")).data.fee_types||[];if(i)try{const J=(await ke.get("/class-fee-structure",{params:{class:i,academic_year:p}})).data.fee_structures||[],G=new Set;J.forEach(Q=>{G.add(Q.fee_type_id)}),X(G)}catch(H){console.error("Error fetching class fee structure for filtering:",H),X(new Set)}else X(new Set);s(R.filter(H=>{var J;return((J=H.fee_type_group)==null?void 0:J.toLowerCase())==="special"}))}catch(M){console.error("Error fetching fee types:",M),U("Failed to load fee types.")}},z=async()=>{if(!(!i||!c)){T(!0),U(null);try{const M=await ke.get("/students",{params:{class:i,section:c,branch:d}});M.data&&Array.isArray(M.data.students)?_(M.data.students):_([]),P([])}catch(M){console.error("Error fetching students:",M),U("Failed to load students.")}finally{T(!1)}}},ne=M=>{M.target.checked?P(S.map(R=>R.student_id)):P([])},le=M=>{E.includes(M)?P(E.filter(R=>R!==M)):P([...E,M])},A=(M,R)=>{I(R?[...N,{fee_type_id:M,amount:0}]:N.filter(H=>H.fee_type_id!==M))},D=(M,R)=>{const H=parseFloat(R)||0;I(N.map(J=>J.fee_type_id===M?{...J,amount:H}:J))},L=async()=>{var H,J;if(E.length===0){alert("Please select at least one student");return}if(N.length===0){alert("Please select at least one fee type");return}const M=N.filter(G=>B.has(G.fee_type_id));if(M.length>0){const G=M.map(Q=>{const de=a.find(V=>V.id===Q.fee_type_id);return de?de.fee_type:"Unknown Fee"}).join(", ");alert(`The following fees are already assigned in the Class Fee Structure and cannot be assigned again: ${G}`);return}if(N.filter(G=>G.amount<=0).length>0){alert("Please enter valid amounts for all selected fees");return}if(window.confirm(`Assign selected fees to ${E.length} students?`)){F(!0);try{const G={student_ids:E,fee_assignments:N.map(de=>({fee_type_id:de.fee_type_id,amount:de.amount,academic_year:p}))},Q=await ke.post("/fees/assign-special",G);alert(`Success! ${Q.data.assigned_count} fees assigned. ${Q.data.skipped_count} skipped (duplicates).`),I([]),P([])}catch(G){console.error("Error assigning fees:",G),alert(`Error: ${((J=(H=G.response)==null?void 0:H.data)==null?void 0:J.error)||"Failed to assign fees"}`)}finally{F(!1)}}};return j?l.jsxs("div",{className:"p-6 text-red-600",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Error"}),l.jsx("p",{children:j}),l.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 bg-blue-500 text-white px-4 py-2 rounded",children:"Retry"})]}):l.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[l.jsx("h2",{className:"text-2xl font-bold mb-6 text-[#4318FF]",children:"Assign Special Fee Type"}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm mb-6 flex flex-wrap gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsxs("select",{className:"border rounded-lg px-3 py-2 w-40",value:i,onChange:M=>o(M.target.value),children:[l.jsx("option",{value:"",children:"Select Class"}),e.map(M=>l.jsx("option",{value:M,children:M},M))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsxs("select",{className:"border rounded-lg px-3 py-2 w-40",value:c,onChange:M=>u(M.target.value),children:[l.jsx("option",{value:"",children:"Select Section"}),r.map(M=>l.jsx("option",{value:M,children:M},M))]})]})]}),l.jsxs("div",{className:"flex gap-6",children:[l.jsxs("div",{className:"w-1/3 bg-white p-4 rounded-xl shadow-sm h-fit",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Special Fee Type"}),l.jsx("button",{className:"bg-green-500 text-white px-2 py-1 rounded text-sm",children:"+ Add Special Fee Type"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between font-medium text-gray-500 text-sm pb-2 border-b",children:[l.jsx("span",{children:"Fee Type"}),l.jsx("span",{children:"Amount"})]}),a.length===0?l.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No special fee types found."}):a.map(M=>{const R=N.some(J=>J.fee_type_id===M.id),H=N.find(J=>J.fee_type_id===M.id);return l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:R,onChange:J=>A(M.id,J.target.checked),className:"w-4 h-4 text-[#4318FF]"}),l.jsx("span",{children:M.display_name||M.fee_type})]}),R&&l.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",placeholder:"0",value:(H==null?void 0:H.amount)||"",onChange:J=>D(M.id,J.target.value)})]},M.id)})]}),l.jsx("div",{className:"mt-6 flex justify-end",children:l.jsx("button",{className:`px-6 py-2 rounded-lg text-white font-medium ${E.length>0&&N.length>0?"bg-green-500 hover:bg-green-600":"bg-gray-300 cursor-not-allowed"}`,onClick:L,disabled:E.length===0||N.length===0||q,children:q?"Assigning...":"Assign >"})})]}),l.jsxs("div",{className:"w-2/3 bg-white p-4 rounded-xl shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-bold text-lg",children:"Student List"}),l.jsx("input",{type:"text",placeholder:"Search",className:"border rounded-lg px-3 py-1 text-sm"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b text-gray-500 text-sm",children:[l.jsx("th",{className:"p-2 w-10",children:l.jsx("input",{type:"checkbox",onChange:ne,checked:S.length>0&&E.length===S.length})}),l.jsx("th",{className:"p-2",children:"Admission No."}),l.jsx("th",{className:"p-2",children:"Name"}),l.jsx("th",{className:"p-2",children:"Class"}),l.jsx("th",{className:"p-2",children:"Father Mobile"})]})}),l.jsx("tbody",{children:k?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-500",children:"Loading students..."})}):S.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-4 text-center text-gray-500",children:"No students found. Select Class and Section to load."})}):S.map(M=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-2",children:l.jsx("input",{type:"checkbox",checked:E.includes(M.student_id),onChange:()=>le(M.student_id)})}),l.jsx("td",{className:"p-2",children:M.admission_no}),l.jsx("td",{className:"p-2 font-medium",children:M.name}),l.jsxs("td",{className:"p-2",children:[M.class," ",M.section]}),l.jsx("td",{className:"p-2",children:M.fatherMobile})]},M.student_id))})]})})]})]})]})},NF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState([]),[i,o]=y.useState({installment_no:1,title:"",start_date:"",end_date:"",last_pay_date:"",is_admission:!1,description:"",fee_type_id:null,branch:"",location:"",academic_year:""}),[c,u]=y.useState(!1),[d,f]=y.useState({fee_type_id:"",count:12,start_month_idx:1,year:new Date().getFullYear()+1,start_installment_no:3,branch:"",location:"",academic_year:""}),[m,h]=y.useState(null),[p,g]=y.useState(!1),[v,b]=y.useState("All"),[S,_]=y.useState([]),[E,P]=y.useState(""),[N,I]=y.useState(new Set),[k,T]=y.useState(!1),[q,F]=y.useState(!1),[j,U]=y.useState(""),B=y.useRef(null);y.useEffect(()=>{function Q(de){B.current&&!B.current.contains(de.target)&&T(!1)}return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[]),y.useEffect(()=>{const Q=JSON.parse(localStorage.getItem("user")||"{}"),de=Q.role==="Admin";g(de);let V=localStorage.getItem("currentBranch")||"All";!de&&Q.branch&&Q.branch!=="All"&&Q.branch!=="All Branches"&&(V=Q.branch);const Ee=localStorage.getItem("currentLocation"),we=Q.location||"Hyderabad",he=V==="All"||V==="All Branches";let Z="All";he?Ee&&Ee!=="All"?Z=Ee:Z="All":Z=we,b(Z);const Se=localStorage.getItem("academicYear")||"";o(ge=>({...ge,branch:V,location:Z==="All"?"Hyderabad":Z,academic_year:Se})),f(ge=>({...ge,branch:V,location:Z==="All"?"Hyderabad":Z,academic_year:Se})),he?(b("All"),o(ge=>({...ge,location:"All"})),f(ge=>({...ge,location:"All"}))):ke.get("/branches").then(ge=>{const pe=ge.data.branches||[],Ae=pe.map(Pe=>({id:Pe.id,name:Pe.branch_name,location_name:Pe.location_name||"Unknown Location"}));_(Ae);const Le=pe.find(Pe=>Pe.branch_name.toLowerCase()===V.toLowerCase());if(Le){const Pe={HYD:"Hyderabad",MUM:"Mumbai"},Oe=(Le.location_code||"").toUpperCase();let Ve=Pe[Oe]||we;b(Ve),o(et=>({...et,location:Ve})),P(Le.id)}}).catch(ge=>console.error("Error fetching branch info:",ge))},[]),y.useEffect(()=>{K()},[v]),y.useEffect(()=>{ee(),X()},[]);const X=async()=>{var Q;try{const V=((Q=(await ke.get("/org/academic-years")).data.academic_years)==null?void 0:Q.map(Ee=>Ee.name))||[];s(V)}catch(de){console.error("Error fetching academic years:",de),s([])}};y.useEffect(()=>{m||o(Q=>({...Q,installment_no:e.length+1}))},[e,m]);const K=async()=>{try{const Q=JSON.parse(localStorage.getItem("user")||"{}");let de=localStorage.getItem("currentBranch")||"All";Q.role!=="Admin"&&Q.branch&&Q.branch!=="All"&&Q.branch!=="All Branches"&&(de=Q.branch);const V=de==="All Branches"||de==="All"?"All":de,Ee=await ke.get("/installment-schedule",{params:{branch:V,location:v}});t(Ee.data.installments||[])}catch(Q){console.error("Error fetching installments:",Q)}},ee=async()=>{try{const Q=await ke.get("/fee-types");n(Q.data.fee_types||[])}catch(Q){console.error("Error fetching fee types:",Q)}},Y=Q=>{const{name:de,value:V,type:Ee}=Q.target,he=Q.target.checked;o(Z=>({...Z,[de]:Ee==="checkbox"?he:V}))},z=async Q=>{if(Q.preventDefault(),!i.title||!i.start_date||!i.end_date||!i.last_pay_date){alert("Please fill all required fields");return}const de=localStorage.getItem("currentBranch")||"All",V={...i,installment_no:parseInt(i.installment_no.toString()),fee_type_id:i.fee_type_id?parseInt(i.fee_type_id.toString()):null,branch:i.branch||de,location:i.location||"Hyderabad",academic_year:i.academic_year||""};try{m?(await ke.put(`/installment-schedule/${m}`,V),alert("Installment updated successfully!")):(await ke.post("/installment-schedule",V),alert("Installment created successfully!")),K(),A()}catch(Ee){console.error("Error saving installment:",Ee),alert("Failed to save installment")}},ne=Q=>{o({installment_no:Q.installment_no,title:Q.title,start_date:Q.start_date,end_date:Q.end_date,last_pay_date:Q.last_pay_date,is_admission:Q.is_admission,description:Q.description||"",fee_type_id:Q.fee_type_id||null,branch:Q.branch||"All",location:Q.location||"Hyderabad",academic_year:Q.academic_year||""}),h(Q.id||null),u(!1)},le=async Q=>{if(confirm("Are you sure you want to delete this installment?"))try{await ke.delete(`/installment-schedule/${Q}`),alert("Installment deleted successfully!"),K()}catch(de){console.error("Error deleting installment:",de),alert("Failed to delete installment")}},A=()=>{o({installment_no:e.length+1,title:"",start_date:"",end_date:"",last_pay_date:"",is_admission:!1,description:"",fee_type_id:null,branch:localStorage.getItem("currentBranch")||"All",location:"Hyderabad",academic_year:""}),h(null)},D=Q=>{const de=new Set(N);de.has(Q)?de.delete(Q):de.add(Q),I(de)},L=async()=>{var Q,de;if(N.size===0){alert("Please select at least one branch to copy to.");return}if(!j){alert("Please select a Fee Type to copy installments for.");return}if(confirm(`Are you sure you want to copy installments for the selected fee type to ${N.size} branches?`)){F(!0);try{await ke.post("/fees/copy-installments",{source_branch_id:E,target_branch_ids:Array.from(N),source_fee_type_id:j,academic_year:localStorage.getItem("academicYear")||""}),alert("Installments copied successfully!"),I(new Set),U(""),T(!1)}catch(V){console.error("Copy failed",V),alert(((de=(Q=V.response)==null?void 0:Q.data)==null?void 0:de.error)||"Failed to copy installments.")}finally{F(!1)}}},M=S.filter(Q=>String(Q.id)!==String(E)&&Q.name!=="All Branches"&&Q.name!=="All"),R={};M.forEach(Q=>{R[Q.location_name]||(R[Q.location_name]=[]),R[Q.location_name].push(Q)});const H=localStorage.getItem("currentBranch"),J=H&&H!=="All"&&H!=="All Branches",G=r.filter(Q=>Q.branch==="All"||Q.branch===H);return l.jsx("div",{className:"container mx-auto p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Fee Installments"})}),J&&l.jsxs("div",{className:"relative",ref:B,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm",onClick:()=>T(!k),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),k&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsxs("div",{className:"mb-2 p-2 border-b bg-gray-50",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Select Fee Type to Copy:"}),l.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-2 py-1",value:j,onChange:Q=>U(Q.target.value),children:[l.jsx("option",{value:"",children:"-- Select Fee Type --"}),G.map(Q=>l.jsxs("option",{value:Q.id,children:[Q.fee_type," (",Q.type,")"]},Q.id))]})]}),l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b px-2",children:"Select Target Branches"}),Object.keys(R).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(R).map(Q=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:Q}),l.jsx("div",{className:"py-1",children:R[Q].map(de=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:N.has(String(de.id)),onChange:()=>D(String(de.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:de.name})]},de.id))})]},Q)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white p-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[N.size," selected"]}),l.jsx("button",{onClick:L,disabled:q||N.size===0||!j,className:`px-3 py-1 text-xs text-white rounded ${q||N.size===0||!j?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:q?"Copying...":"Confirm Copy"})]})]})]})]}),l.jsxs("div",{className:"mb-6 bg-gray-50 p-6 rounded-lg border border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:m?"Edit Installment":"Add New Installment"}),l.jsxs("form",{onSubmit:z,children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{name:"fee_type_id",value:i.fee_type_id||"",onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[l.jsx("option",{value:"",children:"Select FeeType"}),r.filter(Q=>{const de=i.branch||localStorage.getItem("currentBranch")||"All";return!Q.branch||Q.branch==="All"||Q.branch===de}).map(Q=>l.jsx("option",{value:Q.id,children:Q.fee_type},Q.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Installment No *"}),l.jsx("input",{type:"number",name:"installment_no",value:i.installment_no,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),l.jsx("input",{type:"text",name:"title",value:i.title,onChange:Y,placeholder:"e.g., April Fee",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),l.jsx("input",{type:"date",name:"start_date",value:i.start_date,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),l.jsx("input",{type:"date",name:"end_date",value:i.end_date,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cut Off Date *"}),l.jsx("input",{type:"date",name:"last_pay_date",value:i.last_pay_date,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:l.jsxs("div",{className:"md:col-span-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsxs("select",{name:"academic_year",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-violet-500",value:i.academic_year,onChange:Y,children:[l.jsx("option",{value:"",children:"Select Year"}),a.map(Q=>l.jsx("option",{value:Q,children:Q},Q))]})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("textarea",{name:"description",value:i.description,onChange:Y,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-violet-500",placeholder:"Optional description"})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{type:"submit",className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-500",children:m?"Update":"Save"}),l.jsx("button",{type:"button",onClick:A,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none",children:"Reset"})]})]})]}),l.jsxs("div",{className:"overflow-x-auto",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Fee Installments"}),l.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"No."}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Fee Type"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Title"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Start Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"End Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Last Pay Date"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b",children:"Branch"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-b",children:"Action"})]})}),l.jsx("tbody",{children:e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No installments added yet"})}):e.map(Q=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:Q.installment_no}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-b",children:Q.fee_type_name||"-"}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:[Q.title,Q.is_admission&&l.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded",children:"Admission"})]}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.start_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.end_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 border-b",children:new Date(Q.last_pay_date).toLocaleDateString("en-GB")}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-b",children:Q.branch||"All"}),l.jsx("td",{className:"px-4 py-3 text-center border-b",children:l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:()=>ne(Q),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"✏️ Edit"}),l.jsx("button",{onClick:()=>le(Q.id),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm",children:"🗑️ Delete"})]})})]},Q.id))})]})]})]})})},AF="/assets/Receiptlogo-JgQVGGj_.png",jF=({data:e,copyType:t,logo:r})=>{const{studentName:n,fatherName:a,fatherPhone:s,admissionNo:i,branch:o,className:c,receiptNo:u,paymentDate:d,paymentMode:f,paymentNote:m,items:h,amount:p,concession:g,payable:v}=e,b=S=>S?new Date(S+"T00:00:00").toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).replace(/ /g,"-"):"";return l.jsxs("div",{className:"receipt-container p-8 text-gray-800 bg-white relative border-b-2 border-dashed border-gray-300 last:border-b-0 pb-12 mb-12",children:[l.jsxs("div",{className:"flex items-center justify-start mb-4",children:[l.jsx("img",{src:r,alt:"School Logo",className:"h-16 mr-4"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-black",children:"MS Education Academy"}),l.jsxs("p",{className:"text-md text-gray-600",children:["Fee Receipt ",l.jsxs("span",{className:"text-sm font-semibold ml-2",children:["(",t,")"]})]})]})]}),l.jsx("hr",{className:"my-6"}),l.jsxs("div",{className:"flex justify-between text-lg mb-2",children:[l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Student:"})," ",n]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Father:"})," ",a]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Phone:"})," ",s||"N/A"]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Adm No:"})," ",i]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Branch:"})," ",o]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold w-24 inline-block",children:"Class:"})," ",c]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Receipt No:"})," ",u]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Date:"})," ",b(d)]}),l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Mode:"})," ",f]})]})]}),l.jsxs("table",{className:"w-full text-sm text-left mb-8",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider",children:"SR. NO"}),l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider",children:"FEE DETAILS"}),l.jsx("th",{className:"px-4 py-2 font-semibold tracking-wider text-right",children:"AMOUNT"})]})}),l.jsx("tbody",{children:h.map((S,_)=>l.jsxs("tr",{className:"border-b",children:[l.jsx("td",{className:"px-4 py-3",children:_+1}),l.jsx("td",{className:"px-4 py-3 font-medium",children:S.title}),l.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["₹",S.payable.toLocaleString("en-IN")]})]},_))})]}),l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"text-sm w-1/2",children:l.jsxs("p",{children:[l.jsx("strong",{className:"font-semibold",children:"Note:"})," ",m||"-"]})}),l.jsxs("div",{className:"w-1/2 text-sm",children:[l.jsxs("div",{className:"flex justify-between border-b pb-1 mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",p.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"flex justify-between border-b pb-1 mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Concession:"}),l.jsxs("span",{className:"font-mono text-right",children:["- ₹",g.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"flex justify-between font-bold text-base border-b pb-1 mb-1",children:[l.jsx("span",{children:"Net Payable:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",v.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"flex justify-between font-bold text-base text-green-700 border-b pb-1 mb-1",children:[l.jsx("span",{children:"Paid Amount:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",e.paid.toLocaleString("en-IN")]})]}),l.jsxs("div",{className:"flex justify-between font-bold text-base text-red-700",children:[l.jsx("span",{children:"Balance Due:"}),l.jsxs("span",{className:"font-mono text-right",children:["₹",e.due.toLocaleString("en-IN")]})]})]})]}),l.jsx("div",{className:"mt-12 flex justify-start",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-bold text-sm uppercase",children:"ACCOUNTANT-MNG"}),l.jsx("p",{className:"text-sm mt-1 font-bold text-sm ",children:"Auth. Signatory"})]})}),l.jsx("div",{className:"text-center text-xs text-gray-400 mt-4",children:"This is a computer-generated receipt."})]})},mj=({onClose:e,receiptData:t})=>{const r=()=>{var f;const n=document.querySelector(".printable-receipt");if(!n)return;let a=n.innerHTML;const s=a,i=a.replace("Student Copy","Office Copy"),o=`
          <div class="receipt-page">
              <div class="receipt-copy is-student">${s}</div>
              <div class="cut-line">----------------------------------------------------</div>
              <div class="receipt-copy is-office">${i}</div>
          </div>
      `,c=Array.from(document.styleSheets).map(m=>{try{return Array.from(m.cssRules).map(h=>h.cssText).join("")}catch{return console.warn("Could not read CSS rules from stylesheet:",m.href),""}}).join(`
`),u=((f=document.querySelector('link[href^="https://fonts.googleapis.com"]'))==null?void 0:f.outerHTML)||"",d=window.open("","","height=800,width=800");if(!d){alert("Could not open print window.");return}d.document.write(`
          <!DOCTYPE html>
          <html>
          <head>
              <title>Fee Receipt</title>
              ${u}
              <style>
                  ${c}
                  body { 
                      font-family: 'Poppins', sans-serif; 
                      -webkit-print-color-adjust: exact; 
                  }
                  .receipt-container {
                      padding: 20px !important;
                      margin-bottom: 20px;
                  }
                  .cut-line {
                      text-align: center;
                      border-top: 1px dashed #ccc;
                      margin: 20px 0;
                      color: #999;
                      display: none; /* Hide text, use border */
                  }
                  .cut-line {
                      display: block;
                      border: 0;
                      border-top: 2px dashed #ccc;
                      height: 0;
                      margin: 20px 0;
                  }
                  @media print {
                    body { margin: 0; }
                    .no-print { display: none !important; }
                    .receipt-page { height: 100vh; }
                  }
              </style>
          </head>
          <body>
              ${o}
          </body>
          </html>
      `),d.document.close(),setTimeout(()=>{d.focus(),d.print(),d.close()},500)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"printable-receipt",children:l.jsx(jF,{data:t,copyType:"Student Copy",logo:AF})}),l.jsxs("div",{className:"p-6 pt-0 flex justify-end space-x-4 no-print",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-sm font-semibold text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Close"}),l.jsx("button",{onClick:r,className:"px-6 py-2 text-sm font-semibold text-white bg-violet-700 rounded-md hover:bg-violet-800",children:"Print"})]})]})})},Wg=e=>{const t=e.filter(s=>s.installment&&s.installment!=="One-Time"&&s.installment!=="None"),r=e.filter(s=>!s.installment||s.installment==="One-Time"||s.installment==="None"),n=[],a={};return t.forEach(s=>{const i=s.fee_type||"Tuition Fee";a[i]||(a[i]=[]),a[i].push(s)}),Object.keys(a).forEach(s=>{const i=a[s].sort((c,u)=>(c.sr||0)-(u.sr||0));if(i.length===0)return;let o=[i[0]];for(let c=1;c<i.length;c++){const u=o[o.length-1],d=i[c],f=u.sr||0,m=d.sr||0;f>0&&m>0&&m===f+1?o.push(d):(n.push(v5(s,o)),o=[d])}o.length>0&&n.push(v5(s,o))}),r.forEach(s=>{n.push({title:s.fee_type==="General"?"One-Time Fee":s.fee_type,amount:parseFloat(s.amount_paid),concession:parseFloat(s.concession_amount),payable:parseFloat(s.gross_amount||s.amount_paid),originalItems:[s]})}),n},v5=(e,t)=>{const r=t[0].installment.replace(" Fee",""),n=t[t.length-1].installment.replace(" Fee","");let a=`${e} - ${r} Fee`;t.length>1&&(a=`Payment for ${r} Fee to ${n} Fee`);const s=t.reduce((c,u)=>c+parseFloat(u.amount_paid),0),i=t.reduce((c,u)=>c+parseFloat(u.concession_amount),0),o=t.reduce((c,u)=>c+parseFloat(u.gross_amount||u.amount_paid),0);return{title:a,amount:s,concession:i,payable:o,originalItems:t}},kF=({navigateTo:e})=>{const[t,r]=y.useState(null);return l.jsx("div",{className:"bg-white",style:{borderTop:"4px solid #6d28d9"}})},Hg=({title:e,value:t,bgColor:r,textColor:n,icon:a})=>l.jsxs("div",{className:`p-2 rounded-lg text-center ${r}`,children:[l.jsx("p",{className:`text-xs font-semibold ${n}`,children:e}),l.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[a,l.jsx("p",{className:`font-bold text-lg ${n}`,children:t})]})]}),CF=({installment:e,isSelected:t,onSelect:r,isDisabled:n})=>{const{sr:a,title:s,payable:i,paid:o,paidAmount:c,dueAmount:u,concession:d}=e,f=u!==void 0?u:i-(c||0),m=!o&&(c||0)>0,h=o||f<=0;let p=`Payable = ${i}`;d&&d>0&&(p+=`, Concession = ${d}`);let g="bg-white hover:bg-gray-50";return h?(p=`Payable = ${i}`,d&&d>0&&(p+=`, Concession = ${d}`),p+=`, Paid = ${c||i-(d||0)}, Due = 0`,g="bg-green-100 text-green-800 hover:bg-green-200"):m?(p=`Payable = ${i}`,d&&d>0&&(p+=`, Concession = ${d}`),p+=`, Paid = ${c}, Due = ${f}`,g="bg-red-50 text-red-800 hover:bg-red-100"):f>0&&(p=`Payable = ${i}`,d&&d>0&&(p+=`, Concession = ${d}`),p+=`, Due = ${f}`,g="bg-red-50 text-red-800 hover:bg-red-100"),t&&(g+=" bg-violet-100"),n&&(g+=" opacity-50 cursor-not-allowed"),l.jsxs("tr",{className:g,children:[l.jsx("td",{className:"border px-2 py-2 text-center",children:h?l.jsx("span",{className:"text-green-600 font-bold",children:"✔"}):l.jsx("input",{type:"checkbox",checked:t,onChange:()=>!n&&r(a),disabled:n,className:"h-4 w-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500 disabled:opacity-50 disabled:cursor-not-allowed"})}),l.jsx("td",{className:"border px-2 py-2 text-center text-sm text-gray-600",children:a}),l.jsx("td",{className:"border px-2 py-2 text-sm text-gray-800",children:s}),l.jsx("td",{className:"border px-2 py-2 text-xs text-gray-500",children:p})]})},EF=({navigateTo:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState([]),[s,i]=y.useState(""),[o,c]=y.useState(""),[u,d]=y.useState(null),[f,m]=y.useState(""),h=y.useMemo(()=>t.find($e=>$e.student_id===u),[t,u]),[p,g]=y.useState([]),[v,b]=y.useState({totalPaids:0,totalDue:0,currentDue:0}),[S,_]=y.useState([]),[E,P]=y.useState("0"),[N,I]=y.useState(0),[k,T]=y.useState({}),[q,F]=y.useState("0"),[j,U]=y.useState([]),[B,X]=y.useState([]),[K,ee]=y.useState(""),[Y,z]=y.useState(!1),[ne,le]=y.useState([]),A=async()=>{if(h)try{const $e=await ke.get(`/fees/payments/${h.student_id}`);le($e.data),z(!0)}catch($e){console.error("Error fetching payment history:",$e),alert("Failed to fetch payment history.")}},D=async $e=>{var Pt,gt;if(!window.confirm("Are you sure you want to delete this ENTIRE RECEIPT? This will revert all associated fee payments."))return;const Je=ne.filter(Ot=>Ot.receipt_no===$e);try{for(const Ot of Je)await ke.delete(`/fees/payment/${Ot.payment_id}`);if(alert("Receipt deleted successfully."),A(),h){const Ot=localStorage.getItem("currentBranch")||"All",yt=Ot==="All Branches"||Ot==="All"?"All":Ot,tr=await ke.get(`/fees/student-details/${h.student_id}?branch=${yt}`);g(tr.data.installments||[])}}catch(Ot){console.error("Error deleting receipt:",Ot),alert(((gt=(Pt=Ot.response)==null?void 0:Pt.data)==null?void 0:gt.error)||"Failed to delete receipt.")}},L=$e=>{const Je=ne.filter(rr=>rr.receipt_no===$e);if(Je.length===0)return;const Pt=Je.reduce((rr,nr)=>rr+parseFloat(nr.amount_paid),0),gt=Je.reduce((rr,nr)=>rr+parseFloat(nr.concession_amount),0),Ot=Je.reduce((rr,nr)=>rr+parseFloat(nr.gross_amount||0),0)||Pt+gt,yt=Je.reduce((rr,nr)=>rr+parseFloat(nr.due_amount||0),0),tr=Ot-gt,fr=Je.map(rr=>{const nr=p.find(Cn=>Cn.title===rr.installment||Cn.title===`${rr.installment} Fee`);return{...rr,sr:nr?nr.sr:0}}),It=Wg(fr).map((rr,nr)=>({sr:nr+1,title:rr.title,payable:rr.payable,dueAmount:0,paidAmount:rr.amount,concession:rr.concession,paid:!0})),Xt={studentName:h==null?void 0:h.name,fatherName:h==null?void 0:h.fatherName,fatherPhone:h==null?void 0:h.fatherPhone,admissionNo:h==null?void 0:h.admNo,branch:h==null?void 0:h.branch,className:h==null?void 0:h.class,receiptNo:$e,paymentDate:Je[0].payment_date,paymentMode:Je[0].mode,paymentNote:"",items:It,amount:Ot,concession:gt,payable:tr,paid:Pt,due:yt};Q(Xt),J(!0)},M=y.useMemo(()=>K?p.filter($e=>$e.fee_type_id===Number(K)):[],[p,K]);y.useEffect(()=>{(async()=>{try{const Je=await ke.get("/fee-types"),Pt=Je.data.fee_types||Je.data;X(Array.isArray(Pt)?Pt:[])}catch(Je){console.error("Error fetching fee types:",Je)}})()},[]);const R=async $e=>{const Je=$e.target.value;if(ee(Je),!Je||!h)return;const Pt=Number(Je);p.some(Ot=>Ot.fee_type_id===Pt)||window.confirm("This fee type is not assigned to the student.")};y.useEffect(()=>{(async()=>{try{const Je=await ke.get("/concessions");U(Je.data.concessions)}catch(Je){console.error("Error fetching concessions:",Je)}})()},[]);const[H,J]=y.useState(!1),[G,Q]=y.useState(null),[de,V]=y.useState(""),[Ee,we]=y.useState(""),[he,Z]=y.useState("Cash"),[Se,ge]=y.useState(new Date().toISOString().split("T")[0]),[pe,Ae]=y.useState(""),[Le,Pe]=y.useState(""),[Oe,Ve]=y.useState(!1);y.useEffect(()=>{const $e=localStorage.getItem("user");if($e){const Je=JSON.parse($e);Ve(Je.role==="Admin")}},[]),y.useEffect(()=>{(async()=>{try{const Pt=(await ke.get("/classes")).data.classes.map(gt=>String(gt.class_name));a([...new Set(Pt)])}catch(Je){console.error("Error fetching classes:",Je)}})()},[]),y.useEffect(()=>{(async()=>{try{const Je=new URLSearchParams;s&&Je.append("class",s),o&&Je.append("section",o),f&&Je.append("search",f);const Pt=localStorage.getItem("currentBranch")||"All";Je.append("branch",Pt==="All Branches"||Pt==="All"?"All":Pt);const Ot=(await ke.get(`/fees/students?${Je.toString()}`)).data;r(Array.isArray(Ot)?Ot:Ot.students||[])}catch(Je){console.error("Error fetching students:",Je),r([])}})()},[s,o,f]),y.useEffect(()=>{(async()=>{if(h)try{const Je=localStorage.getItem("currentBranch")||"All",Pt=Je==="All Branches"||Je==="All"?"All":Je,gt=await ke.get(`/fees/student-details/${h.student_id}?branch=${Pt}`);g(gt.data.installments||[])}catch(Je){console.error("Error fetching installments:",Je),g([])}else g([]);rt(),P("0"),I(0),T({})})()},[h]),y.useEffect(()=>{if(!p||p.length===0){b({totalPaids:0,totalDue:0,currentDue:0});return}const $e=p.filter(Ot=>Ot.paid).reduce((Ot,yt)=>Ot+(yt.paidAmount||yt.payable),0),Je=p.filter(Ot=>!Ot.paid),Pt=Je.reduce((Ot,yt)=>Ot+yt.payable,0),gt=Je.length>0?Je[0].payable:0;b({totalPaids:$e,totalDue:Pt,currentDue:gt})},[p]);const et=$e=>{_(Je=>Je.includes($e)?Je.filter(gt=>gt<$e):[...Je,$e].sort((gt,Ot)=>gt-Ot))},_t=()=>{if(E==="0"){I(0),T({});return}const $e=j.find(yt=>yt.title===E);if(!$e){I(0),T({});return}let Je=0;const Pt={},gt=p.filter(yt=>S.includes(yt.sr));console.log("DEBUG: Applying Concession:",$e),console.log("DEBUG: Selected Items:",gt);const Ot=[];for(const yt of gt){const tr=$e.items.find(fr=>fr.fee_type_id===yt.fee_type_id);if(console.log(`DEBUG: Checking item ${yt.title} (FeeTypeID: ${yt.fee_type_id}) -> Match:`,tr),tr){if((yt.concession||0)>0){console.log(`DEBUG: Skipping ${yt.title} - Already has concession: ${yt.concession}`);continue}if(yt.due_date&&Se>yt.due_date){console.log(`DEBUG: Skipping ${yt.title} - Payment Date (${Se}) is after Due Date (${yt.due_date})`),Ot.push(`${yt.title} (Due: ${yt.due_date})`);continue}const fr=yt.dueAmount!==void 0&&yt.dueAmount>0?yt.dueAmount:yt.payable;let Vt=0;$e.is_percentage?Vt=fr*(tr.percentage/100):Vt=Math.min(fr,tr.percentage),Vt=Math.round(Vt),Pt[yt.sr]=Vt,Je+=Vt}}console.log("DEBUG: Total Discount:",Je),T(Pt),I(Je),Ot.length>0&&alert(`Concession was NOT applied to the following installments because the Payment Date (${Se}) is after the Due Date:

- ${Ot.join(`
- `)}`)},Tt=p.filter($e=>S.includes($e.sr)),At=Tt.reduce(($e,Je)=>{const Pt=Je.dueAmount!==void 0&&Je.dueAmount>0?Je.dueAmount:Je.payable;return $e+Pt},0),pt=At-N,lt=pt-Number(q);y.useEffect(()=>{F(String(pt>0?pt:0))},[pt,S]);const rt=()=>{_([]),P("0"),I(0),T({}),F("0"),V(""),we(""),Z("Cash"),ge(new Date().toISOString().split("T")[0]),Ae(""),Pe("")},Zt=async()=>{var $e,Je;if(!h||Tt.length===0){alert("Please select a student and at least one installment to pay.");return}if(!de.trim()){alert("Please enter School Receipt No");return}try{let Pt=Number(q);const gt=Tt.map(xt=>{const Un=k[xt.sr]||0;let En=xt.dueAmount!==void 0&&xt.dueAmount>0?xt.dueAmount:xt.payable;const zn=Math.max(0,En-Un),Rr=Math.min(zn,Pt);return Pt-=Rr,{student_fee_id:xt.student_fee_id,amount:Rr,concession_amount:Un}}),Ot=localStorage.getItem("currentBranch")||"All",yt=Ot==="All Branches"||Ot==="All"?"All":Ot,fr=(await ke.post(`/fees/payment?branch=${yt}`,{student_id:h.student_id,amount_paid:Number(q),payment_mode:he,payment_date:Se,note:Ee,receipt_no:de,transaction_id:pe,transaction_id_description:Le,fee_allocations:gt})).data.receipt_no,Vt=Tt.map((xt,Un)=>{const En=gt[Un];return{installment:xt.title,fee_type:"Tuition Fee",sr:xt.sr,amount_paid:En.amount,concession_amount:En.concession_amount,gross_amount:xt.dueAmount!==void 0&&xt.dueAmount>0?xt.dueAmount:xt.payable}}),It=Wg(Vt),Xt={studentName:h.name,fatherName:h.fatherName,fatherPhone:h.fatherPhone,admissionNo:h.admNo,branch:h.branch,className:h.class,receiptNo:fr,paymentDate:Se,paymentMode:he,paymentNote:Ee,items:It,amount:At,concession:N,payable:pt,paid:Number(q),due:lt};Q(Xt),J(!0);const rr=new URLSearchParams;s&&rr.append("class",s),o&&rr.append("section",o),rr.append("branch",yt);const Cn=(await ke.get(`/fees/students?${rr}`)).data;r(Array.isArray(Cn)?Cn:Cn.students||[]);const Ma=await ke.get(`/fees/student-details/${h.student_id}?branch=${yt}`);g(Ma.data.installments||[])}catch(Pt){console.error("Error recording payment:",Pt),alert(((Je=($e=Pt.response)==null?void 0:$e.data)==null?void 0:Je.error)||"Failed to record payment")}},jt=()=>{J(!1),Q(null),rt()},Mr=()=>l.jsx("span",{className:"font-sans",children:"₹"});return l.jsxs("div",{className:"container-fluid mx-auto bg-gray-50",children:[l.jsx(kF,{navigateTo:e}),l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[l.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[l.jsx(Mr,{})," Take Fee"]}),l.jsxs("div",{className:"p-4 border rounded-lg shadow-sm bg-violet-50/50 space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[l.jsx("input",{type:"text",placeholder:"Search Adm No or Name...",value:f,onChange:$e=>m($e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm"}),l.jsxs("select",{value:s,onChange:$e=>{i($e.target.value),c("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Class --"}),n.map($e=>l.jsx("option",{value:$e,children:$e},$e))]}),l.jsxs("select",{value:o,onChange:$e=>c($e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Section --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]}),l.jsxs("select",{value:K,onChange:R,disabled:!h,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Fee Type --"}),B.map($e=>l.jsx("option",{value:$e.id,children:$e.fee_type},$e.id))]})]}),l.jsx("div",{children:l.jsxs("select",{value:u||"",onChange:$e=>d(Number($e.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"-- Select Student --"}),t.map($e=>l.jsxs("option",{value:$e.student_id,children:[$e.name," (",$e.admNo,")"]},$e.student_id))]})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{className:"text-sm px-3 py-1.5 border rounded-md hover:bg-gray-100",children:"Download QR"}),l.jsx("button",{className:"text-sm px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Student"})]})]}),h&&l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[l.jsx(Hg,{title:"Total Paids",value:v.totalPaids.toLocaleString(),bgColor:"bg-green-100",textColor:"text-green-800",icon:l.jsx(Mr,{})}),l.jsx(Hg,{title:"Current Due",value:v.currentDue.toLocaleString(),bgColor:"bg-blue-100",textColor:"text-blue-800",icon:l.jsx(Mr,{})}),l.jsx(Hg,{title:"Total Due",value:v.totalDue.toLocaleString(),bgColor:"bg-orange-100",textColor:"text-orange-800",icon:l.jsx(Mr,{})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h4",{className:"font-semibold text-gray-700",children:["Details ",l.jsx("span",{className:"text-sm text-black-500 font-normal ml-3",children:h?`Student Name: ${h.name} || FatherName: ${h.fatherName} 
                            || Adm No: ${h.admNo} || Phone: ${h.fatherPhone}`:"Details : N/A"})]}),l.jsx("div",{className:"flex items-center space-x-2"})]}),l.jsxs("div",{className:"border rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-blue-500 text-white px-4 py-2 flex justify-between items-center",children:[l.jsxs("h4",{className:"font-semibold relative",children:["Installment",p.length>0&&l.jsx("span",{className:"absolute -top-2 -right-5 bg-orange-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:p.length})]}),l.jsx("button",{onClick:A,className:"bg-orange-400 text-white px-3 py-1 text-sm rounded-md hover:bg-orange-500",children:"Print / Cancel"})]}),l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-100 sticky top-0",children:l.jsxs("tr",{className:"bg-gray-100 sticky top-0",children:[l.jsx("th",{className:"px-2 py-2 border w-12"}),l.jsx("th",{className:"px-2 py-2 border w-12",children:"Sr."}),l.jsx("th",{className:"px-2 py-2 border text-left",children:"Title"}),l.jsx("th",{className:"px-2 py-2 border text-left",children:"Details"})]})}),l.jsx("tbody",{children:h?M.length>0?M.map(($e,Je)=>{const Pt=$e.paid;let gt=!1;return Pt?gt=!1:M.slice(0,Je).every(yt=>yt.paid||S.includes(yt.sr))||(gt=!0),l.jsx(CF,{installment:$e,isSelected:S.includes($e.sr),onSelect:et,isDisabled:gt},$e.sr)}):l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"text-center p-4 text-gray-500",children:"No installments found for this fee type."})}):l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"text-center p-4 text-gray-500",children:"Please select a student to view installments."})})})]})})]})]}),l.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[l.jsxs("div",{className:"border rounded-lg p-4 space-y-3 bg-gray-50/50 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("h3",{className:"font-semibold text-gray-800",children:["Fee Structure ",l.jsx("a",{href:"#",className:"text-blue-500 text-sm font-normal hover:underline",children:"Get Help"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsxs("select",{value:E,onChange:$e=>P($e.target.value),className:"text-sm border rounded-l-md p-1.5 focus:ring-violet-500 focus:border-violet-500",disabled:!h,children:[l.jsx("option",{value:"0",children:"Select Concession"}),j.filter($e=>$e.show_in_payment).map(($e,Je)=>l.jsx("option",{value:$e.title,children:$e.title},Je))]}),l.jsx("button",{onClick:_t,className:"bg-green-500 text-white px-3 py-1.5 text-sm rounded-r-md hover:bg-green-600",disabled:!h,children:"Apply"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm bg-white",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100",children:[l.jsx("th",{className:"border p-2 w-10",children:l.jsx("button",{className:"w-6 h-6 bg-green-500 text-white rounded hover:bg-green-600 flex items-center justify-center text-sm",children:"+"})}),l.jsx("th",{className:"border p-2 text-left font-medium text-gray-600",children:"Title"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Payable"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Paid"}),l.jsx("th",{className:"border p-2 text-right font-medium text-gray-600",children:"Due"}),l.jsx("th",{className:"border p-2 w-32 font-medium text-gray-600",children:"+ Extra Charge"})]})}),l.jsx("tbody",{children:Tt.length>0?Tt.map($e=>{const Je=$e.dueAmount!==void 0&&$e.dueAmount>0?$e.dueAmount:$e.payable,Pt=$e.paidAmount||0,gt=$e.dueAmount||0;return l.jsxs("tr",{children:[l.jsx("td",{className:"border p-2"}),l.jsx("td",{className:"border p-2",children:$e.title}),l.jsx("td",{className:"border p-2 text-right",children:Je.toFixed(0)}),l.jsx("td",{className:"border p-2 text-right",children:Pt.toFixed(0)}),l.jsx("td",{className:"border p-2 text-right",children:gt.toFixed(0)}),l.jsx("td",{className:"border p-2"})]},$e.sr)}):l.jsx("tr",{children:l.jsx("td",{className:"border p-2 h-8 text-center text-gray-400",colSpan:6,children:"Select installments to pay"})})})]})}),l.jsxs("div",{className:"space-y-2 pt-4",children:[l.jsxs("div",{className:"flex justify-between items-center text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Amount"}),l.jsx("span",{className:"font-semibold text-gray-800",children:At.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Concession"}),l.jsx("span",{className:"font-semibold text-gray-800",children:N.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold border-t pt-2",children:[l.jsx("span",{className:"text-gray-800",children:"Payable(Amount - Concession)"}),l.jsx("span",{className:"font-semibold text-gray-800",children:pt.toLocaleString()})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[l.jsx("span",{className:"text-gray-600",children:"Paid"}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"text",value:q,onChange:$e=>F($e.target.value),className:"w-24 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-right focus:outline-none focus:ring-violet-500 focus:border-violet-500"}),l.jsx("button",{className:"ml-2 px-3 py-1 bg-green-500 text-white rounded-md text-lg font-bold hover:bg-green-600",children:"="})]})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-red-600 border-t pt-2",children:[l.jsx("span",{children:"Due (Payable - Paid)"}),l.jsx("span",{children:lt.toLocaleString()})]})]})]}),l.jsxs("div",{className:"border rounded-lg p-4 space-y-4 bg-gray-50/50 shadow-sm",children:[l.jsx("div",{className:"text-center text-sm text-orange-600 bg-orange-100 p-2 rounded-md",children:'Hit "ENTER" or Equal(=) button after entering "Paid" amount'}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Mode*"}),l.jsxs("select",{value:he,onChange:$e=>Z($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500",children:[l.jsx("option",{children:"Cash"}),l.jsx("option",{children:"CardSwap"}),l.jsx("option",{children:"Online"}),l.jsx("option",{children:"UPI"}),l.jsx("option",{children:"Cheque"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Date*"}),l.jsx("input",{type:"date",value:Se,onChange:$e=>ge($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"School Receipt No*"}),l.jsx("input",{type:"text",value:de,onChange:$e=>V($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Note"}),l.jsx("input",{type:"text",value:Ee,maxLength:25,onChange:$e=>we($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500"})]}),(he==="CardSwap"||he==="UPI")&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"UPI/Card Transaction ID*"}),l.jsx("input",{type:"text",value:pe,onChange:$e=>Ae($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500",placeholder:"Enter UPI/Card transaction ID"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"UPI/Card Description*"}),l.jsx("input",{type:"text",value:Le,required:!0,onChange:$e=>Pe($e.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500",placeholder:"Enter UPI/Card description"})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:"keep-details",type:"checkbox",className:"h-4 w-4 text-violet-600 border-gray-300 rounded focus:ring-violet-500"}),l.jsx("label",{htmlFor:"keep-details",className:"ml-2 block text-sm text-gray-900",children:"Keep same payment detail for the next fee payment"})]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[l.jsx("button",{onClick:Zt,className:"px-4 py-2 text-sm font-medium text-white bg-violet-600 rounded-md hover:bg-violet-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",disabled:!h,children:"Take Fee"}),l.jsx("button",{onClick:rt,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400",children:"Reset"})]})]})]})]})})}),H&&G&&l.jsx(mj,{onClose:jt,receiptData:G}),Y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("h2",{className:"text-xl font-bold",children:["Payment History - ",h==null?void 0:h.name," (",localStorage.getItem("academicYear"),")"]}),l.jsx("button",{onClick:()=>z(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2",children:"Receipt No"}),l.jsx("th",{className:"p-2",children:"Academic Year"}),l.jsx("th",{className:"p-2",children:"Date"}),l.jsx("th",{className:"p-2",colSpan:2,children:"Title"}),l.jsx("th",{className:"p-2 text-right",children:"Amount"}),l.jsx("th",{className:"p-2 text-right",children:"Concession"}),l.jsx("th",{className:"p-2",children:"Mode"}),l.jsx("th",{className:"p-2 text-center",children:"Actions"})]})}),l.jsxs("tbody",{children:[Object.values(ne.reduce(($e,Je)=>($e[Je.receipt_no]||($e[Je.receipt_no]=[]),$e[Je.receipt_no].push(Je),$e),{})).map($e=>{const Je=$e[0],Pt=$e.map(tr=>{const fr=p.find(Vt=>Vt.title===tr.installment||Vt.title===`${tr.installment} Fee`);return{...tr,sr:fr?fr.sr:0}}),gt=Wg(Pt),Ot=$e.reduce((tr,fr)=>tr+parseFloat(fr.amount_paid),0),yt=$e.reduce((tr,fr)=>tr+parseFloat(fr.concession_amount),0);return l.jsxs("tr",{className:"border-b hover:bg-gray-50 align-top",children:[l.jsx("td",{className:"p-2",children:Je.receipt_no}),l.jsx("td",{className:"p-2",children:Je.academic_year}),l.jsx("td",{className:"p-2",children:Je.payment_date}),l.jsx("td",{className:"p-2",colSpan:2,children:l.jsx("div",{className:"space-y-1",children:gt.map((tr,fr)=>l.jsx("div",{className:"font-medium",children:tr.title},fr))})}),l.jsxs("td",{className:"p-2 text-right",children:["₹",Ot.toLocaleString("en-IN")]}),l.jsxs("td",{className:"p-2 text-right",children:["₹",yt.toLocaleString("en-IN")]}),l.jsx("td",{className:"p-2",children:Je.mode}),l.jsxs("td",{className:"p-2 flex justify-center space-x-2",children:[l.jsx("button",{onClick:()=>L(Je.receipt_no),title:"Print Receipt",className:"text-blue-600 hover:text-blue-800",children:l.jsx(lF,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>D(Je.receipt_no),title:"Delete Receipt",className:"text-red-600 hover:text-red-800",children:l.jsx(fj,{className:"w-5 h-5"})})]})]},Je.receipt_no)}),ne.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No payments found."})})]})]}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Close"})})]})})]})},TF=({navigateTo:e})=>{const t=[{id:"calendar",name:"Calendar",icon:l.jsx(Rh,{className:"w-8 h-8"}),iconBg:"bg-blue-50",iconColor:"text-blue-600",comingSoon:!0},{id:"document",name:"Document",icon:l.jsx(Ed,{className:"w-8 h-8"}),iconBg:"bg-slate-50",iconColor:"text-slate-600",comingSoon:!0},{id:"download",name:"Download",icon:l.jsx(dj,{className:"w-8 h-8"}),iconBg:"bg-green-50",iconColor:"text-green-600",comingSoon:!0},{id:"inquiry",name:"Inquiry",icon:l.jsx(lj,{className:"w-8 h-8"}),iconBg:"bg-amber-50",iconColor:"text-amber-600",comingSoon:!0},{id:"hostel",name:"Hostel",icon:l.jsx(m5,{className:"w-8 h-8"}),iconBg:"bg-purple-50",iconColor:"text-purple-600",comingSoon:!0},{id:"leave",name:"Leave",icon:l.jsx(Rh,{className:"w-8 h-8"}),iconBg:"bg-orange-50",iconColor:"text-orange-600",comingSoon:!0},{id:"library",name:"Library",icon:l.jsx(Ed,{className:"w-8 h-8"}),iconBg:"bg-pink-50",iconColor:"text-pink-600",comingSoon:!0},{id:"student-attendance",name:"Student Attendance",icon:l.jsx(Bh,{className:"w-8 h-8"}),iconBg:"bg-teal-50",iconColor:"text-teal-600",page:"student-attendance"},{id:"student",name:"Student",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-indigo-50",iconColor:"text-indigo-600",page:"student-administration"},{id:"summary",name:"Summary",icon:l.jsx($y,{className:"w-8 h-8"}),iconBg:"bg-cyan-50",iconColor:"text-cyan-600",comingSoon:!0},{id:"attendance-staff",name:"Attendance(Stf)",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-red-50",iconColor:"text-red-600",comingSoon:!0},{id:"staffs",name:"Staffs",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-emerald-50",iconColor:"text-emerald-600",comingSoon:!0},{id:"team",name:"Team",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-violet-50",iconColor:"text-violet-600",comingSoon:!0},{id:"transport",name:"Transport",icon:l.jsx(m5,{className:"w-8 h-8"}),iconBg:"bg-yellow-50",iconColor:"text-yellow-600",comingSoon:!0},{id:"alumni",name:"Alumni",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-lime-50",iconColor:"text-lime-600",comingSoon:!0},{id:"post-jobs",name:"Post Jobs",icon:l.jsx(Ed,{className:"w-8 h-8"}),iconBg:"bg-fuchsia-50",iconColor:"text-fuchsia-600",comingSoon:!0},{id:"survey",name:"Survey",icon:l.jsx(Bh,{className:"w-8 h-8"}),iconBg:"bg-rose-50",iconColor:"text-rose-600",comingSoon:!0},{id:"helpdesk",name:"Helpdesk",icon:l.jsx(uj,{className:"w-8 h-8"}),iconBg:"bg-sky-50",iconColor:"text-sky-600",comingSoon:!0}],r=n=>{n.page&&e(n.page)};return l.jsxs("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-5",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:l.jsx(cj,{className:"w-6 h-6 text-slate-700"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Administration"}),l.jsx("p",{className:"text-sm text-slate-600 mt-0.5",children:"Take control of your school operations"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map(n=>l.jsxs("button",{onClick:()=>r(n),disabled:n.comingSoon,className:`group relative bg-white rounded-xl p-6 border border-slate-200 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 ${n.comingSoon?"opacity-60 cursor-not-allowed":"hover:border-blue-300 hover:shadow-lg cursor-pointer"}`,children:[l.jsx("div",{className:`${n.iconBg} ${n.iconColor} w-14 h-14 rounded-xl flex items-center justify-center mb-4 ${!n.comingSoon&&"group-hover:scale-105"} transition-transform duration-200`,children:n.icon}),l.jsx("h3",{className:`font-semibold text-slate-900 text-base mb-1 ${!n.comingSoon&&"group-hover:text-blue-600"} transition-colors`,children:n.name}),n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:"Coming Soon"}),n.page&&!n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Active"})]},n.id))})})]})},pj=({pageTitle:e})=>l.jsx("div",{className:"flex items-center justify-center h-full p-4 bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold text-gray-700 tracking-tight",children:e}),l.jsx("p",{className:"mt-4 text-lg text-gray-500",children:"This page is under construction."}),l.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Please check back later!"})]})}),PF=({navigateTo:e})=>{const t=[{id:"academic",name:"Academic",icon:l.jsx(nv,{className:"w-8 h-8"}),iconBg:"bg-blue-50",iconColor:"text-blue-600",page:"academics"},{id:"classwork",name:"Classwork",icon:l.jsx(Bh,{className:"w-8 h-8"}),iconBg:"bg-purple-50",iconColor:"text-purple-600",comingSoon:!0},{id:"homework",name:"Homework",icon:l.jsx(Ed,{className:"w-8 h-8"}),iconBg:"bg-orange-50",iconColor:"text-orange-600",comingSoon:!0},{id:"lesson-plan",name:"Lesson Plan",icon:l.jsx(av,{className:"w-8 h-8"}),iconBg:"bg-amber-50",iconColor:"text-amber-600",comingSoon:!0},{id:"time-table",name:"Time Table",icon:l.jsx(Rh,{className:"w-8 h-8"}),iconBg:"bg-teal-50",iconColor:"text-teal-600",comingSoon:!0},{id:"time-table-2",name:"Time Table",icon:l.jsx(Rh,{className:"w-8 h-8"}),iconBg:"bg-green-50",iconColor:"text-green-600",comingSoon:!0},{id:"online-exam",name:"Online Exam",icon:l.jsx(Ed,{className:"w-8 h-8"}),iconBg:"bg-pink-50",iconColor:"text-pink-600",comingSoon:!0},{id:"academic-content",name:"Academic Content",icon:l.jsx($y,{className:"w-8 h-8"}),iconBg:"bg-indigo-50",iconColor:"text-indigo-600",comingSoon:!0},{id:"assessment",name:"Assessment",icon:l.jsx(Bh,{className:"w-8 h-8"}),iconBg:"bg-red-50",iconColor:"text-red-600",comingSoon:!0},{id:"online-class",name:"Online Class",icon:l.jsx(yi,{className:"w-8 h-8"}),iconBg:"bg-cyan-50",iconColor:"text-cyan-600",comingSoon:!0},{id:"activity-planner",name:"Activity Planner",icon:l.jsx(av,{className:"w-8 h-8"}),iconBg:"bg-emerald-50",iconColor:"text-emerald-600",comingSoon:!0}],r=n=>{n.page?e(n.page):n.comingSoon};return l.jsxs("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b border-slate-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-5",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:l.jsx(nv,{className:"w-6 h-6 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Academic Management"}),l.jsx("p",{className:"text-sm text-slate-600 mt-0.5",children:"Manage all academic activities and resources"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:t.map(n=>l.jsxs("button",{onClick:()=>r(n),className:"group relative bg-white rounded-xl p-6 border border-slate-200 hover:border-blue-300 hover:shadow-lg transition-all duration-200 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[l.jsx("div",{className:`${n.iconBg} ${n.iconColor} w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:scale-105 transition-transform duration-200`,children:n.icon}),l.jsx("h3",{className:"font-semibold text-slate-900 text-base mb-1 group-hover:text-blue-600 transition-colors",children:n.name}),n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:"Coming Soon"}),n.page&&!n.comingSoon&&l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Active"})]},n.id))})})]})};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var OF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ln=(e,t)=>{const r=y.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>y.createElement("svg",{ref:d,...OF,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${FF(e)}`,o].join(" "),...u},[...t.map(([f,m])=>y.createElement(f,m)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=Ln("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Ln("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Ln("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Ln("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Ln("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Ln("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Ln("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=Ln("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=Ln("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Ln("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=Ln("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Ln("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=Ln("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sv=Ln("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Ln("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=Ln("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=Ln("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=Ln("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=Ln("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),HF=()=>{if(JSON.parse(localStorage.getItem("user")||"{}").role!=="Admin")return l.jsx("div",{className:"p-4 text-red-500",children:"Access Denied: Only Admins can manage subjects."});const t=localStorage.getItem("academicYear")||"2024-2025",[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState("Academic"),[c,u]=y.useState(null),[d,f]=y.useState(""),[m,h]=y.useState("Academic"),p=async()=>{try{const E=[...(await ke.get("/academic/subjects",{params:{academic_year:t}})).data].sort((P,N)=>P.subject_name.localeCompare(N.subject_name));n(E)}catch(_){console.error("Failed to load subjects:",_)}},g=async()=>{var _,E;if(a.trim())try{await ke.post("/academic/subjects",{subject_name:a,subject_type:i,academic_year:t,is_active:!0}),s(""),o("Academic"),p()}catch(P){console.error("Failed to add subject:",P);const N=((E=(_=P.response)==null?void 0:_.data)==null?void 0:E.error)||P.message||"Failed to add subject. Please try again.";alert(N)}},v=async _=>{if(d.trim())try{await ke.put(`/academic/subjects/${_}`,{subject_name:d,subject_type:m}),u(null),p()}catch(E){console.error("Failed to update subject:",E),alert("Failed to update subject. Please try again.")}},b=async(_,E)=>{try{await ke.put(`/academic/subjects/${_}`,{is_active:!E}),p()}catch(P){console.error("Failed to update status:",P),alert("Failed to update status.")}},S=async _=>{var E,P;if(window.confirm("Are you sure you want to delete this subject?"))try{await ke.delete(`/academic/subjects/${_}`),p()}catch(N){console.error("Failed to delete subject:",N);const I=((P=(E=N.response)==null?void 0:E.data)==null?void 0:P.error)||N.message||"Failed to delete subject. Please try again.";alert(I)}};return y.useEffect(()=>{p()},[t]),l.jsxs("div",{className:"bg-white border rounded-md p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-[#337ab7] mb-4 flex justify-between items-center",children:[l.jsx("span",{children:"Subject Master"}),l.jsxs("span",{className:"text-sm font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded",children:["Scope: ",t]})]}),l.jsxs("div",{className:"flex gap-3 mb-6 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{value:a,onChange:_=>s(_.target.value),className:"border px-3 py-2 rounded w-64",placeholder:"Enter subject name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group"}),l.jsxs("select",{value:i,onChange:_=>o(_.target.value),className:"border px-3 py-2 rounded w-40",children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]})]}),l.jsx("button",{onClick:g,className:"px-4 py-2 bg-[#337ab7] text-white rounded hover:bg-[#286090] mb-[1px]",children:"Add Subject"})]}),l.jsxs("table",{className:"w-full text-sm border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border px-3 py-2 text-left",children:"Subject Name"}),l.jsx("th",{className:"border px-3 py-2 text-left",children:"Group"}),l.jsx("th",{className:"border px-3 py-2 text-center w-24",children:"Status"}),l.jsx("th",{className:"border px-3 py-2 text-left",children:"Actions"})]})}),l.jsx("tbody",{children:r.map(_=>l.jsxs("tr",{className:`border-t ${_.is_active?"":"bg-gray-50"}`,children:[l.jsx("td",{className:"border px-3 py-2",children:c===_.id?l.jsx("input",{value:d,onChange:E=>f(E.target.value),className:"border px-2 py-1 rounded w-full"}):l.jsx("span",{className:_.is_active?"":"text-gray-400",children:_.subject_name})}),l.jsx("td",{className:"border px-3 py-2",children:c===_.id?l.jsxs("select",{value:m,onChange:E=>h(E.target.value),className:"border px-2 py-1 rounded w-full",children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]}):l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${_.subject_type==="Hifz"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:_.subject_type||"Academic"})}),l.jsx("td",{className:"border px-3 py-2 text-center",children:l.jsx("button",{onClick:()=>b(_.id,_.is_active),className:`w-10 h-5 flex items-center rounded-full p-1 transition-colors ${_.is_active?"bg-green-500":"bg-gray-300"}`,title:_.is_active?"Click to Deactivate":"Click to Activate",children:l.jsx("div",{className:`bg-white w-3 h-3 rounded-full shadow-md transform transition-transform ${_.is_active?"translate-x-5":"translate-x-0"}`})})}),l.jsx("td",{className:"border px-3 py-2 flex gap-3",children:c===_.id?l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"text-green-600 hover:text-green-800",onClick:()=>v(_.id),children:"Save"}),l.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>u(null),children:"Cancel"})]}):l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"text-blue-600 hover:text-blue-800",onClick:()=>{u(_.id),f(_.subject_name),h(_.subject_type||"Academic")},children:"Edit"}),l.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:()=>S(_.id),children:"Delete"})]})})]},_.id))})]})]})},qF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState([]),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState(""),[m,h]=y.useState("Academic"),[p,g]=y.useState(new Set),[v,b]=y.useState(!1),[S,_]=y.useState(new Set),[E,P]=y.useState(!1),N=y.useRef(null);y.useEffect(()=>{function A(D){N.current&&!N.current.contains(D.target)&&P(!1)}return document.addEventListener("mousedown",A),()=>{document.removeEventListener("mousedown",A)}},[]),y.useEffect(()=>{(async()=>{try{const D=JSON.parse(localStorage.getItem("user")||"{}"),L=localStorage.getItem("academicYear");let M=localStorage.getItem("currentBranch");!M&&D.branch&&(M=D.branch);const R=await ke.get("/classes"),H=R.data.classes||R.data||[];t(H.map(he=>({id:he.id,name:he.class_name})));const J=await ke.get("/branches"),G=J.data.branches||J.data||[];let Q=Array.isArray(G)?G.map(he=>({id:he.id,name:he.branch_name,branch_name:he.branch_name,branch_code:he.branch_code,location_name:he.location_name||"Unknown Location"})):[];const de=D.role==="Admin",V=Q.find(he=>he.name===M||he.branch_name===M||he.branch_code===M);de?(s([{id:"All",name:"All Branches",branch_name:"All Branches",branch_code:"ALL",location_name:"Global"},...Q]),u(M==="All"||M==="All Branches"?"All":V?String(V.id):"All")):V?(s([V]),u(String(V.id))):(console.warn("User branch not found in branch list:",M),s(Q),Q.length>0&&u(String(Q[0].id)));const Ee=await ke.get("/org/academic-years"),we=Ee.data.academic_years||Ee.data||[];if(o(we.map(he=>({id:he.id,name:he.name}))),L){const he=we.find(Z=>Z.name.trim()===L.trim());he?f(he.id.toString()):we.length>0&&f(we[0].id.toString())}else we.length>0&&f(we[0].id.toString())}catch(D){console.error("Error loading metadata",D)}})()},[]),y.useEffect(()=>{const A=async()=>{if(!d){n([]);return}const D=i.find(M=>String(M.id)===String(d)),L=D?D.name:"";try{const M=await ke.get("/academic/subjects",{params:{academic_year:L}});n(M.data.map(R=>({id:R.id,name:R.subject_name,type:R.subject_type||"Academic"})))}catch(M){console.error("Error loading subjects",M),n([])}};i.length>0&&A()},[d,i]),y.useEffect(()=>{const A=async()=>{if(!(!d||!c)){b(!0);try{const D=await ke.get("/academic/assigned-subjects",{params:{academic_year_id:d,branch_id:c==="All"?void 0:c}}),L=new Set;D.data.forEach(M=>{const R=r.find(H=>H.name===M.subject_name);R&&L.add(`${M.class_id}-${R.id}`)}),g(L),B(new Set(L))}catch(D){console.error("Failed to fetch matrix data",D)}finally{b(!1)}}};r.length>0&&A()},[d,c,r]);const I=(A,D)=>{const L=`${A}-${D}`,M=new Set(p);M.has(L)?M.delete(L):M.add(L),g(M)},k=A=>{const D=new Set(p);let L=!0;for(const M of e)if(!D.has(`${M.id}-${A}`)){L=!1;break}e.forEach(M=>{const R=`${M.id}-${A}`;L?D.delete(R):D.add(R)}),g(D)},T=A=>{const D=new Set(p);let L=!0;for(const M of q)if(!D.has(`${A}-${M.id}`)){L=!1;break}q.forEach(M=>{const R=`${A}-${M.id}`;L?D.delete(R):D.add(R)}),g(D)},q=r.filter(A=>m==="All"||A.type===m),[F,j]=y.useState(!1),[U,B]=y.useState(new Set),X=async()=>{if(!d||!c)return;j(!0);const A=[];if(p.forEach(D=>{if(!U.has(D)){const[L,M]=D.split("-");A.push({class_id:parseInt(L),subject_id:parseInt(M),action:"assign"})}}),U.forEach(D=>{if(!p.has(D)){const[L,M]=D.split("-");A.push({class_id:parseInt(L),subject_id:parseInt(M),action:"remove"})}}),A.length===0){alert("No changes to save."),j(!1);return}try{await ke.post("/academic/manage-subject-assignment/bulk",{updates:A,academic_year_id:d,branch_id:c,location_id:1}),B(new Set(p)),alert("Assignments saved successfully!")}catch(D){console.error("Failed to save assignments",D);let L="Failed to save assignments. Please check the console for details.";D.response&&D.response.data&&((D.response.data.details&&Array.isArray(D.response.data.details)?D.response.data.details.filter(R=>R.includes("is assigned to students")):[]).length>0?L="Students assigned to this subject. Unable to unassign.":D.response.data.error&&(L=D.response.data.error)),alert(L),g(new Set(U))}finally{j(!1)}},K=A=>{const D=new Set(S);D.has(A)?D.delete(A):D.add(A),_(D)},ee=a.filter(A=>A.id!=="All"&&String(A.id)!==c),Y={};ee.forEach(A=>{Y[A.location_name]||(Y[A.location_name]=[]),Y[A.location_name].push(A)});const[z,ne]=y.useState(!1),le=async()=>{var A,D;if(S.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy assignments to ${S.size} branches?
(Merge Mode: Only missing assignments will be added)`)){ne(!0);try{await ke.post("/academic/copy-subject-assignments",{source_branch_id:c,target_branch_ids:Array.from(S),academic_year_id:d}),alert("Assignments copied successfully!"),_(new Set),P(!1)}catch(L){console.error("Copy failed",L),alert(((D=(A=L.response)==null?void 0:A.data)==null?void 0:D.error)||"Failed to copy assignments.")}finally{ne(!1)}}};return l.jsx("div",{children:l.jsxs("div",{className:"bg-white p-6 rounded shadow border mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Class-Subject Assignment"}),l.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 items-end",children:[l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded bg-gray-50",value:d,disabled:!0,onChange:A=>f(A.target.value),children:[l.jsx("option",{value:"",children:"Select Year"}),i.map(A=>l.jsx("option",{value:A.id,children:A.name},A.id))]})]}),l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded bg-gray-50",value:c,disabled:!0,onChange:A=>u(A.target.value),children:[l.jsx("option",{value:"",children:"Select Branch"}),a.map(A=>l.jsx("option",{value:A.id,children:A.name},A.id))]})]}),l.jsxs("div",{className:"w-48",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Group"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:A=>h(A.target.value),children:[l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"}),l.jsx("option",{value:"All",children:"All Types"})]})]})]}),l.jsx("div",{className:"overflow-x-auto border rounded",children:l.jsxs("table",{className:"w-full border-collapse text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 min-w-[150px] text-left",children:"Subjects \\ Classes"}),e.map(A=>l.jsx("th",{className:"border p-2 text-center min-w-[60px]",children:l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{children:A.name}),l.jsx("button",{onClick:()=>T(A.id),className:"text-[10px] bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-0.5 rounded",title:"Check/Uncheck all subjects for this class",children:"✓ All"})]})},A.id)),l.jsx("th",{className:"border p-2 text-center min-w-[80px]",children:"Action"})]})}),l.jsx("tbody",{children:v&&p.size===0?l.jsx("tr",{children:l.jsx("td",{colSpan:e.length+2,className:"p-4 text-center",children:"Loading Assignments..."})}):q.map(A=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2 font-medium bg-gray-50",children:A.name}),e.map(D=>{const L=`${D.id}-${A.id}`,M=p.has(L);return l.jsx("td",{className:"border p-1 text-center",children:l.jsx("div",{className:"flex justify-center items-center h-full",children:l.jsx("input",{type:"checkbox",checked:M,onChange:()=>I(D.id,A.id),className:"w-5 h-5 cursor-pointer accent-[#337ab7]"})})},D.id)}),l.jsx("td",{className:"border p-1 text-center",children:l.jsx("button",{onClick:()=>k(A.id),className:"text-xs bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded",title:"Toggle All Classes for this Subject",children:"Check/Uncheck All"})})]},A.id))})]})}),q.length===0&&l.jsx("div",{className:"p-4 text-center text-gray-500",children:"No subjects found for selected group."}),l.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[l.jsx("div",{children:c&&c!=="All"&&l.jsxs("div",{className:"relative",ref:N,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2",onClick:()=>P(!E),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),E&&l.jsxs("div",{className:"absolute left-full top-0 ml-2 w-72 bg-white border shadow-xl rounded z-20 max-h-80 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b",children:"Select Target Branches"}),Object.keys(Y).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(Y).map(A=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:A}),l.jsx("div",{className:"py-1",children:Y[A].map(D=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:S.has(String(D.id)),onChange:()=>K(String(D.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:D.name})]},D.id))})]},A)),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[S.size," selected"]}),l.jsx("button",{onClick:le,disabled:z||S.size===0,className:`px-3 py-1 text-xs text-white rounded ${z||S.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:z?"Copying...":"Confirm Copy"})]})]})]})}),l.jsxs("div",{className:"flex gap-4 justify-end",children:[l.jsx("button",{onClick:()=>{g(new Set(U))},disabled:F,className:`px-6 py-2 rounded text-white-700 border transition hover:bg-gray-100 ${F?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:X,disabled:F,className:`px-6 py-2 rounded text-white font-medium ${F?"bg-gray-400":"bg-[#337ab7] hover:bg-blue-600"}`,children:F?"Saving...":"Save Assignments"})]})]})]})})},GF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState(""),[d,f]=y.useState(!1),[m,h]=y.useState([]),[p,g]=y.useState([]),[v,b]=y.useState(new Map),[S,_]=y.useState(new Map),[E,P]=y.useState(!1),[N,I]=y.useState(!1),[k,T]=y.useState(new Set),[q,F]=y.useState(!1),j=y.useRef(null),[U,B]=y.useState(!1);y.useEffect(()=>{(async()=>{try{const R=JSON.parse(localStorage.getItem("user")||"{}"),H=localStorage.getItem("academicYear"),J=localStorage.getItem("currentBranch"),G=localStorage.getItem("currentLocation");J==="All Branches"||J==="All"||!J?f(!0):(f(!1),o(J),u(G||"Hyderabad"));const Q=await ke.get("/org/academic-years"),de=Q.data.academic_years||Q.data||[];if(t(de.map(we=>({id:we.id,name:we.name}))),H){const we=de.find(he=>he.name===H);we?s(we.name):de.length>0&&s(de[0].name)}else de.length>0&&s(de[0].name);const V=await ke.get("/branches"),Ee=V.data.branches||V.data||[];n(Ee.map(we=>({id:we.id,name:we.branch_name,location_name:we.location_name||"Unknown"})))}catch(R){console.error("Error loading metadata",R)}})();function M(R){j.current&&!j.current.contains(R.target)&&F(!1)}return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]);const X=async()=>{if(!(!a||!i||d)){P(!0);try{const L=await ke.get("/class-tests/matrix",{params:{academic_year:a,branch:i}});h(L.data.classes),g(L.data.test_types);const M=new Map;L.data.assignments.forEach(H=>{M.set(`${H.class_id}-${H.test_id}`,H)}),b(M);const R=new Map;L.data.assignments.forEach(H=>{R.set(`${H.class_id}-${H.test_id}`,{...H})}),_(R)}catch(L){console.error("Error fetching matrix",L)}finally{P(!1)}}};y.useEffect(()=>{X()},[a,i,d]);const K=(L,M)=>{let R=0;for(const[H,J]of M.entries())H.startsWith(`${L}-`)&&J.status&&J.test_order>R&&(R=J.test_order);return R+1},ee=(L,M,R)=>{const H=`${L}-${M}`,J=new Map(v);if(R){const G=J.get(H);if(G)J.set(H,{...G,status:!0});else{const Q=K(L,J);J.set(H,{class_id:L,test_id:M,test_order:Q,status:!0})}}else{const G=J.get(H);G&&J.set(H,{...G,status:!1})}b(J)},Y=L=>{const M=new Map(v);let R=!0;for(const H of m){const J=`${H.id}-${L}`,G=M.get(J);if(!G||!G.status){R=!1;break}}m.forEach(H=>{const J=`${H.id}-${L}`;if(R){const G=M.get(J);G&&M.set(J,{...G,status:!1})}else{const G=M.get(J);if(G)G.status||M.set(J,{...G,status:!0});else{const Q=K(H.id,M);M.set(J,{class_id:H.id,test_id:L,test_order:Q,status:!0})}}}),b(M)},z=L=>{const M=new Map(v);let R=!0;for(const H of p){const J=`${L}-${H.id}`,G=M.get(J);if(!G||!G.status){R=!1;break}}p.forEach(H=>{const J=`${L}-${H.id}`;if(R){const G=M.get(J);G&&M.set(J,{...G,status:!1})}else{const G=M.get(J);if(G)G.status||M.set(J,{...G,status:!0});else{const Q=K(L,M);M.set(J,{class_id:L,test_id:H.id,test_order:Q,status:!0})}}}),b(M)},ne=(L,M,R)=>{const H=`${L}-${M}`,J=new Map(v),G=J.get(H);G&&(J.set(H,{...G,test_order:R}),b(J))},le=async()=>{var M,R;if(!a||!i)return;I(!0);const L=[];for(const H of m){const J=new Set;for(const G of p){const Q=`${H.id}-${G.id}`,de=v.get(Q);if(de&&de.status){if(J.has(de.test_order)){alert(`Duplicate order number ${de.test_order} in Class ${H.name}. Please fix before saving.`),I(!1);return}J.add(de.test_order)}}}v.forEach((H,J)=>{const G=S.get(J);let Q=!1;G?(G.status!==H.status||G.test_order!==H.test_order)&&(Q=!0):H.status&&(Q=!0),Q&&L.push(ke.post("/class-tests/assign",{academic_year:a,branch:i,location:c,class_id:H.class_id,test_id:H.test_id,test_order:H.test_order,status:H.status}))});try{await Promise.all(L),alert("Assignments saved successfully"),X()}catch(H){console.error("Save error",H),alert("Error saving: "+(((R=(M=H.response)==null?void 0:M.data)==null?void 0:R.error)||H.message))}finally{I(!1)}},A={};r.filter(L=>L.name!==i&&L.name!=="All Branches").forEach(L=>{A[L.location_name]||(A[L.location_name]=[]),A[L.location_name].push(L)});const D=async()=>{if(k.size===0)return alert("Select target branches");if(confirm(`Copy assignments to ${k.size} branches?`)){B(!0);try{for(const L of Array.from(k)){const[M,R]=L.split("|");await ke.post("/class-tests/copy",{from_branch:i,to_branch:M,to_location:R,academic_year:a})}alert("Copy successful"),F(!1),T(new Set)}catch(L){alert("Copy failed: "+L.message)}finally{B(!1)}}};return d?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(IF,{className:"text-yellow-500 mr-2",size:24}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-yellow-700",children:'Cannot create tests in "All Branches" mode.'}),l.jsx("p",{className:"text-sm text-yellow-600",children:"Please select a specific branch from the header to create or modify assignments."})]})]})})}):l.jsxs("div",{className:"p-2 bg-white rounded shadow border",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Assign Tests to Classes"})}),l.jsxs("div",{className:"flex gap-4 mb-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Academic Year"}),l.jsx("div",{className:"border p-2 rounded bg-gray-100 min-w-[150px] text-gray-700",children:a||"Loading..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),l.jsx("div",{className:"border p-2 rounded bg-gray-100 min-w-[200px] text-gray-700",children:i||"Loading..."})]})]}),l.jsxs("div",{className:"border rounded overflow-x-auto mb-4",children:[l.jsxs("table",{className:"w-full text-sm text-left collapse-borders",children:[l.jsx("thead",{className:"bg-[#1a202c] text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-3 border-r border-gray-600 sticky left-0 z-10 bg-[#1a202c]",children:"Class"}),p.map(L=>l.jsxs("th",{className:"p-3 text-center border-r border-gray-600 min-w-[100px]",children:[l.jsx("div",{children:L.name}),l.jsx("input",{type:"checkbox",className:"mt-1 w-3 h-3 accent-blue-400 cursor-pointer",title:`Assign ${L.name} to all classes`,onClick:M=>{M.stopPropagation(),Y(L.id)}})]},L.id)),l.jsx("th",{className:"p-3 text-center border-r border-gray-600 min-w-[50px] bg-[#1a202c]",children:"All"})]})}),l.jsx("tbody",{children:m.map(L=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"p-3 font-semibold text-gray-800 bg-gray-50 sticky left-0 border-r",children:L.name}),p.map(M=>{const R=`${L.id}-${M.id}`,H=v.get(R),J=(H==null?void 0:H.status)||!1,G=H==null?void 0:H.test_order;return l.jsx("td",{className:"p-2 border-r text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:J,onChange:Q=>ee(L.id,M.id,Q.target.checked),className:"w-4 h-4 accent-purple-600 cursor-pointer"}),J&&l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"text-gray-500 text-xs mr-1",children:"("}),l.jsx("input",{type:"number",value:G||"",onChange:Q=>ne(L.id,M.id,parseInt(Q.target.value)||0),className:"w-8 p-0.5 text-center border rounded text-xs no-spinner"}),l.jsx("span",{className:"text-gray-500 text-xs ml-1",children:")"})]})]})},M.id)}),l.jsx("td",{className:"p-2 border-r text-center",children:l.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600 cursor-pointer",title:`Assign all tests to ${L.name}`,onClick:M=>{M.stopPropagation(),z(L.id)}})})]},L.id))})]}),E&&l.jsx("div",{className:"p-4 text-center",children:"Loading..."}),!E&&m.length===0&&l.jsx("div",{className:"p-4 text-center",children:"No data. Please verify Academic Year and Branch selection."})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"relative",ref:j,children:[l.jsx("button",{onClick:()=>F(!q),className:"bg-purple-600 text-white px-4 py-2 rounded shadow hover:bg-purple-700 flex items-center gap-2",children:"Copy to Branches ▼"}),q&&l.jsxs("div",{className:"absolute left-full top-0 ml-2 w-72 bg-white border shadow-xl rounded z-20 max-h-80 overflow-y-auto",children:[l.jsx("div",{className:"p-2 border-b font-bold bg-gray-50",children:"Select Target Branches"}),Object.keys(A).map(L=>l.jsxs("div",{children:[l.jsx("div",{className:"bg-gray-100 px-3 py-1 text-xs font-bold text-gray-600 uppercase",children:L}),A[L].map(M=>{const R=`${M.name}|${M.location_name}`;return l.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-blue-50 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.has(R),onChange:()=>{const H=new Set(k);H.has(R)?H.delete(R):H.add(R),T(H)}}),l.jsx("span",{className:"text-sm",children:M.name})]},M.id)})]},L)),l.jsx("div",{className:"p-2 border-t flex justify-end",children:l.jsx("button",{onClick:D,disabled:U||k.size===0,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 disabled:opacity-50",children:U?"Copying...":"Confirm"})})]})]}),l.jsxs("div",{className:"flex gap-4 justify-end",children:[l.jsx("button",{onClick:()=>X(),disabled:N,className:`px-6 py-2 rounded text-blue-700 border transition hover:bg-blue-100 ${N?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:le,disabled:N,className:"bg-[#337ab7] text-white px-6 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50",children:N?"Saving...":"Save Test"})]})]})]})},VF=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState("Academic"),[d,f]=y.useState([]),[m,h]=y.useState([]),[p,g]=y.useState([]),[v,b]=y.useState([]),[S,_]=y.useState({}),[E,P]=y.useState(!1),[N,I]=y.useState(!1);y.useEffect(()=>{const K=localStorage.getItem("academicYear")||"",ee=localStorage.getItem("user");let Y="All";if(ee)try{const z=JSON.parse(ee);if(z.role==="Admin"||z.branch==="All"||z.branch==="AllBranches"){const ne=localStorage.getItem("currentBranch");ne&&ne!=="All"&&ne!=="All Locations"&&(Y=ne)}else Y=z.branch||"All"}catch(z){console.error("Error parsing user",z)}t(K),n(Y),k()},[]);const k=async()=>{try{const K=await ke.get("/classes");K.data&&K.data.classes&&f(K.data.classes)}catch(K){console.error("Failed to load classes",K)}};y.useEffect(()=>{o(""),h([]),a&&T(a)},[a]);const T=async K=>{try{const ee=await ke.get(`/sections?class=${K}`);ee.data&&ee.data.sections&&h(ee.data.sections)}catch(ee){console.error("Failed to load sections",ee)}},q=async()=>{if(!(!a||!e||!r)){P(!0);try{const K=new URLSearchParams({class_id:a,academic_year:e,branch:r,subject_type:c});i&&K.append("section_id",i);const ee=await ke.get(`/academics/assignment-data?${K.toString()}`),{students:Y,subjects:z,overrides:ne}=ee.data;g(Y),b(z);const le={};Y.forEach(A=>{le[A.student_id]={},z.forEach(D=>{const L=ne[A.student_id];let M=!1;if(L&&L.hasOwnProperty(D.subject_id)){const R=L[D.subject_id];M=R===!0||R===1}le[A.student_id][D.subject_id]=M})}),_(le)}catch(K){console.error("Failed to fetch assignment data",K),alert("Error fetching data")}finally{P(!1)}}};y.useEffect(()=>{a&&q()},[a,i,c,e,r]);const F=(K,ee)=>{_(Y=>({...Y,[K]:{...Y[K],[ee]:!Y[K][ee]}}))},j=(K,ee)=>{_(Y=>{const z={};return v.forEach(ne=>{z[ne.subject_id]=ee}),{...Y,[K]:z}})},U=(K,ee)=>{_(Y=>{const z={...Y};return p.forEach(ne=>{z[ne.student_id]||(z[ne.student_id]={}),z[ne.student_id][K]=ee}),z})},B=K=>{_(ee=>{const Y={};return p.forEach(z=>{Y[z.student_id]={},v.forEach(ne=>{Y[z.student_id][ne.subject_id]=K})}),Y})},X=async()=>{if(p.length){I(!0);try{const K=p.map(ee=>{const Y=S[ee.student_id];return{student_id:ee.student_id,subjects:Y}});await ke.post("/academics/save-student-subjects",{academic_year:e,branch:r,class_id:a,data:K}),alert("Saved successfully!"),q()}catch(K){console.error("Save failed",K),alert("Failed to save assignments.")}finally{I(!1)}}};return l.jsxs("div",{className:"p-6 bg-white min-h-screen",children:[l.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Assign Student-Subjects"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm border",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Academic Year"}),l.jsx("div",{className:"px-3 py-2 bg-gray-200 rounded text-gray-700 font-medium",children:e})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Branch"}),l.jsx("div",{className:"px-3 py-2 bg-gray-200 rounded text-gray-700 font-medium whitespace-nowrap overflow-hidden text-ellipsis",children:r})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Class"}),l.jsxs("select",{className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-indigo-500 outline-none",value:a,onChange:K=>s(K.target.value),children:[l.jsx("option",{value:"",children:"Select Class"}),d.map(K=>l.jsx("option",{value:K.class_name,children:K.class_name},K.id))]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Section"}),l.jsxs("select",{className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-indigo-500 outline-none",value:i,onChange:K=>o(K.target.value),disabled:!a,children:[l.jsx("option",{value:"",children:"All Sections"}),m.map(K=>l.jsx("option",{value:K,children:K},K))]})]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 mb-1",children:"Subject Type"}),l.jsxs("div",{className:"flex items-center space-x-4 h-full",children:[l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:"subjectType",className:"mr-2",value:"Academic",checked:c==="Academic",onChange:K=>u(K.target.value)}),"Academic"]}),l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:"subjectType",className:"mr-2",value:"Hifz",checked:c==="Hifz",onChange:K=>u(K.target.value)}),"Hifz"]})]})]})]}),E?l.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading data..."}):p.length===0?l.jsx("div",{className:"text-center py-10 text-gray-400 bg-gray-50 rounded border border-dashed",children:"No students found or no class selected."}):l.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:l.jsxs("table",{className:"min-w-full bg-white text-sm",children:[l.jsx("thead",{className:"bg-[#1f2937] text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"py-3 px-4 text-left w-16",children:"S.No"}),l.jsx("th",{className:"py-3 px-4 text-left w-48 sticky left-0 z-10 bg-[#1f2937]",children:"Student Name"}),l.jsx("th",{className:"py-3 px-4 text-left w-24",children:"Roll No"}),l.jsx("th",{className:"py-3 px-4 text-left w-32",children:"Adm No"}),v.map(K=>l.jsx("th",{className:"py-3 px-4 text-center min-w-[100px]",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("span",{children:K.subject_name}),l.jsx("input",{type:"checkbox",className:"w-4 h-4 text-indigo-600 rounded bg-gray-700 border-gray-500 focus:ring-indigo-500",onChange:ee=>U(K.subject_id,ee.target.checked),title:"Assign this subject to all shown students"})]})},K.subject_id)),l.jsx("th",{className:"py-3 px-4 text-center w-24",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("span",{children:"All"}),l.jsx("input",{type:"checkbox",className:"w-4 h-4 text-green-600 rounded bg-gray-700 border-gray-500 focus:ring-green-500",onChange:K=>B(K.target.checked),title:"Select/Deselect all checkboxes"})]})})]})}),l.jsx("tbody",{className:"text-gray-700",children:p.map((K,ee)=>l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${ee%2===0?"bg-white":"bg-gray-50"}`,children:[l.jsx("td",{className:"py-2 px-4",children:ee+1}),l.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 z-10 bg-inherit border-r",children:K.name}),l.jsx("td",{className:"py-2 px-4",children:K.roll_number}),l.jsx("td",{className:"py-2 px-4",children:K.admission_no}),v.map(Y=>{var ne;const z=((ne=S[K.student_id])==null?void 0:ne[Y.subject_id])||!1;return l.jsx("td",{className:"py-2 px-4 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer",checked:z,onChange:()=>F(K.student_id,Y.subject_id)})},Y.subject_id)}),l.jsx("td",{className:"py-2 px-4 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 text-green-600 rounded focus:ring-green-500 cursor-pointer border-2 border-green-200",onChange:Y=>j(K.student_id,Y.target.checked),title:"Select/Deselect All"})})]},K.student_id))})]})}),p.length>0&&l.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[l.jsx("button",{onClick:()=>q(),disabled:N,className:`px-6 py-2 rounded text-gray-700 border transition hover:bg-gray-100 ${N?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsx("button",{onClick:X,disabled:N,className:`px-8 py-3 bg-indigo-600 text-white font-bold rounded shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all ${N?"opacity-50 cursor-not-allowed":""}`,children:N?"Saving...":"Save Assignments"})]})]})},YF=()=>{const[e,t]=y.useState([]),[r,n]=y.useState(!1),[a,s]=y.useState(localStorage.getItem("academicYear")||""),[i,o]=y.useState(localStorage.getItem("currentBranch")||"All"),[c,u]=y.useState(localStorage.getItem("currentLocation")||"Hyderabad"),[d,f]=y.useState(!1),[m,h]=y.useState(null),[p,g]=y.useState({test_name:"",max_marks:50,display_order:void 0});y.useEffect(()=>{const P=JSON.parse(localStorage.getItem("user")||"{}");P.role!=="Admin"&&P.branch&&o(P.branch),P.location&&u(P.location)},[]),y.useEffect(()=>{(async()=>{const N=localStorage.getItem("academicYear");try{const k=(await ke.get("/org/academic-years")).data.academic_years||[];if(N){const T=k.find(q=>q.name===N);T?s(T.name):k.length>0&&s(k[0].name)}else k.length>0&&s(k[0].name)}catch(I){console.error("Failed to fetch academic years",I)}})()},[]),y.useEffect(()=>{a&&v()},[a]);const v=async()=>{var P,N,I;n(!0);try{const k=await ke.get("/test-types/",{params:{academic_year:a}});t(k.data)}catch(k){console.error("Failed to fetch test types",k);const T=((N=(P=k.response)==null?void 0:P.data)==null?void 0:N.error)||k.message||"Unknown error",q=(I=k.response)!=null&&I.status?` (${k.response.status})`:"";alert(`Failed to fetch test types${q}: ${T}. Check console for details.`)}finally{n(!1)}},b=async()=>{var P,N;try{const I={...p,academic_year:a};m?await ke.put(`/test-types/${m}`,I):await ke.post("/test-types/",I),f(!1),v()}catch(I){console.error("Save error:",I);const k=((N=(P=I.response)==null?void 0:P.data)==null?void 0:N.error)||I.message||"Failed to save";alert(`Error: ${k}`)}},S=async P=>{try{await ke.patch(`/test-types/${P}/status`),v()}catch(N){console.error("Status update failed",N)}},_=()=>{g({test_name:"",max_marks:50,display_order:void 0}),h(null),f(!0)},E=P=>{g({test_name:P.test_name,max_marks:P.max_marks,display_order:P.display_order}),h(P.id),f(!0)};return l.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Create-TestType"}),l.jsxs("button",{onClick:_,disabled:!a,className:"flex items-center gap-2 bg-[#337ab7] text-white px-4 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50",children:[l.jsx(gj,{size:18})," Add Test Type"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 bg-white p-4 rounded shadow-sm border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-semibold text-gray-600 block mb-1",children:"Academic Year"}),l.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded text-gray-700 border min-w-[150px]",children:a})]}),l.jsx("div",{})]}),l.jsxs("div",{className:"bg-white rounded shadow text-sm",children:[l.jsxs("div",{className:"grid grid-cols-12 bg-gray-100 p-3 font-semibold text-gray-700 border-b",children:[l.jsx("div",{className:"col-span-1 text-center",children:"Order"}),l.jsx("div",{className:"col-span-5",children:"Test Name"}),l.jsx("div",{className:"col-span-3 text-center",children:"Max Marks (Ref)"}),l.jsx("div",{className:"col-span-2 text-center",children:"Status"}),l.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]}),r?l.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):e.length===0?l.jsx("div",{className:"p-8 text-center text-gray-500",children:"No test types found. Add one to get started."}):e.map((P,N)=>l.jsxs("div",{className:"grid grid-cols-12 p-3 border-b hover:bg-gray-50 items-center",children:[l.jsx("div",{className:"col-span-1 text-center font-mono bg-gray-100 rounded mx-2 py-1",children:P.display_order??N+1}),l.jsx("div",{className:"col-span-5 font-medium text-gray-800",children:P.test_name}),l.jsx("div",{className:"col-span-3 text-center text-gray-600",children:P.max_marks}),l.jsx("div",{className:"col-span-2 flex justify-center",children:l.jsxs("button",{onClick:()=>S(P.id),className:`flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${P.is_active?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"}`,children:[P.is_active?l.jsx(WF,{size:16}):l.jsx($F,{size:16}),P.is_active?"Active":"Inactive"]})}),l.jsx("div",{className:"col-span-1 flex justify-center gap-2",children:l.jsx("button",{onClick:()=>E(P),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:l.jsx(UF,{size:16})})})]},P.id))]}),d&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800",children:m?"Edit Test Type":"Add Test Type"}),l.jsx("button",{onClick:()=>f(!1),className:"text-gray-500 hover:text-red-500",children:l.jsx(xj,{size:20})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name *"}),l.jsx("input",{type:"text",value:p.test_name,onChange:P=>g({...p,test_name:P.target.value}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Unit Test 1",autoFocus:!0})]}),l.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Marks (Ref) *"}),l.jsx("input",{type:"number",value:p.max_marks,onChange:P=>g({...p,max_marks:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none"})]})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),l.jsx("input",{type:"number",value:p.display_order??"",onChange:P=>g({...p,display_order:P.target.value?parseInt(P.target.value):void 0}),className:"w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Auto"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty for auto-increment"})]}),l.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded border",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Context:"})," ",a," (Global)"]})})]}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3 pt-4 border-t",children:[l.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded",children:"Cancel"}),l.jsxs("button",{onClick:b,disabled:!p.test_name,className:"px-4 py-2 bg-[#337ab7] text-white rounded hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50",children:[l.jsx(ec,{size:16})," Save"]})]})]})})]})};function KF({isOpen:e,onClose:t,sourceClassTestId:r,currentAcademicYear:n,currentBranch:a,currentClass:s,currentTest:i}){const[o,c]=y.useState("test_to_test"),[u,d]=y.useState([]),[f,m]=y.useState([]),[h,p]=y.useState(!1),[g,v]=y.useState(!1);y.useEffect(()=>{e&&(b(),m([]))},[e,o]);const b=async()=>{p(!0);try{let E=[];o==="test_to_test"?E=(await ke.get("/test-types",{params:{academic_year:n}})).data.filter(N=>String(N.id)!==String(i)).map(N=>({id:N.id,label:N.test_name})):o==="class_to_class"?E=(await ke.get("/classes",{headers:{"X-Academic-Year":n}})).data.classes.filter(N=>String(N.id)!==String(s)).map(N=>({id:N.id,label:N.class_name})):o==="branch_to_branch"&&(E=(await ke.get("/branches")).data.branches.filter(N=>String(N.id)!==String(a)).map(N=>({id:N.id,label:N.branch_name}))),d(E)}catch(E){console.error("Failed to fetch copy targets",E),alert("Failed to load target options")}finally{p(!1)}},S=E=>{m(P=>P.includes(E)?P.filter(N=>N!==E):[...P,E])},_=async()=>{var E,P;if(r){if(f.length===0){alert("Please select at least one target.");return}if(confirm(`Are you sure you want to copy assignments to ${f.length} targets? Existing assignments will be overwritten.`)){v(!0);try{await ke.post("/class-test-subjects/copy",{source_class_test_id:r,copy_mode:o,target_ids:f,current_academic_year:n,current_branch:a,current_class:s,current_test:i}),alert("Copy successful!"),t()}catch(N){alert(((P=(E=N.response)==null?void 0:E.data)==null?void 0:P.error)||"Copy failed")}finally{v(!1)}}}};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded p-6 w-[500px] max-h-[80vh] flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-xl font-bold",children:"Copy Assignments"}),l.jsx("button",{onClick:t,className:"text-gray-500 text-xl font-bold",children:"×"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium mb-1",children:"Copy Mode"}),l.jsxs("select",{className:"border p-2 rounded w-full",value:o,onChange:E=>c(E.target.value),children:[l.jsx("option",{value:"test_to_test",children:"Test to Test (Same Class/Branch)"}),l.jsx("option",{value:"class_to_class",children:"Class to Class (Same Test/Branch)"}),l.jsx("option",{value:"branch_to_branch",children:"Branch to Branch (Same Test/Class)"})]})]}),l.jsx("div",{className:"flex-1 overflow-auto border p-2 rounded mb-4",children:h?l.jsx("p",{children:"Loading targets..."}):u.length===0?l.jsx("p",{className:"text-gray-500",children:"No targets found."}):l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b",children:[l.jsx("input",{type:"checkbox",checked:f.length===u.length,onChange:E=>{E.target.checked?m(u.map(P=>P.id)):m([])}}),l.jsx("span",{className:"font-semibold",children:"Select All"})]}),u.map(E=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:f.includes(E.id),onChange:()=>S(E.id)}),l.jsx("span",{children:E.label})]},E.id))]})}),l.jsxs("div",{className:"flex justify-end space-x-2",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 border rounded hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{onClick:_,disabled:g||f.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400",children:g?"Copying...":"Copy"})]})]})}):null}function XF(){const[e,t]=y.useState({academic_year_id:localStorage.getItem("academicYear")||"",branch_id:localStorage.getItem("currentBranch")||"",class_id:"",test_id:"",subject_type:""}),[r,n]=y.useState([]),[a,s]=y.useState([]),[i,o]=y.useState([]),[c,u]=y.useState([]),[d,f]=y.useState([]),[m,h]=y.useState(null),[p,g]=y.useState(0),[v,b]=y.useState(!1),[S,_]=y.useState(!1),[E,P]=y.useState(!1);y.useEffect(()=>{N()},[]),y.useEffect(()=>{e.academic_year_id&&e.branch_id&&e.class_id&&e.test_id?k():(f([]),h(null))},[e]);const N=async()=>{try{const[j,U,B]=await Promise.all([ke.get("/org/academic-years"),ke.get("/branches"),ke.get("/classes")]);n(j.data.academic_years.map(X=>({id:X.id,name:X.name}))),s(U.data.branches.map(X=>({id:X.id,name:X.branch_name}))),o(B.data.classes.map(X=>({id:X.id,name:X.class_name})))}catch(j){console.error("Error loading dropdowns",j)}};y.useEffect(()=>{e.academic_year_id&&e.branch_id&&e.class_id?I():u([])},[e.academic_year_id,e.branch_id,e.class_id]);const I=async()=>{try{const j=await ke.get("/class-tests/list",{params:{academic_year:e.academic_year_id,branch:e.branch_id,class_id:e.class_id}});u(j.data.map(U=>({id:U.test_id,name:U.test_name})))}catch(j){console.error("Error loading tests",j),u([])}},k=async()=>{var j,U;b(!0);try{const B=await ke.get("/class-test-subjects/",{params:e});f(B.data.subjects),h(B.data.class_test_id),g(B.data.test_max_marks||0)}catch(B){console.error(B),alert(((U=(j=B.response)==null?void 0:j.data)==null?void 0:U.error)||"Failed to load subjects")}finally{b(!1)}},T=async()=>{var K,ee;if(!e.academic_year_id||!e.branch_id||!e.class_id||!e.test_id){alert("Please select all filters first.");return}const j=d.filter(Y=>Y.assigned),U=j.reduce((Y,z)=>Y+(z.max_marks||0),0);if(U>p){alert(`Total Subject Marks (${U}) cannot exceed Test Max Marks (${p})`);return}const B=j.map(Y=>Y.subject_order).filter(Y=>Y!==null);if(new Set(B).size!==B.length){alert("Subject Orders must be unique");return}_(!0);const X={class_test_id:m,context:e,subjects:j.map(Y=>({subject_id:Y.subject_id,max_marks:Y.max_marks,subject_order:Y.subject_order}))};try{const Y=await ke.post("/class-test-subjects/",X);alert("Assignments saved successfully"),Y.data.class_test_id&&h(Y.data.class_test_id)}catch(Y){alert(((ee=(K=Y.response)==null?void 0:K.data)==null?void 0:ee.error)||"Save failed")}finally{_(!1)}},q=(j,U,B)=>{const X=[...d];X[j]={...X[j],[U]:B},U==="assigned"&&!B&&(X[j].max_marks=null,X[j].subject_order=null),(U==="max_marks"||U==="subject_order")&&B&&(X[j].assigned=!0),f(X)},F=()=>d.filter(j=>j.assigned).reduce((j,U)=>j+(U.max_marks||0),0);return l.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md min-h-screen",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Assign Subjects to Test"}),m&&l.jsxs("button",{onClick:()=>P(!0),className:"flex items-center space-x-2 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition",children:[l.jsx(BF,{size:16})," ",l.jsx("span",{children:"Copy Structure"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 bg-gray-50 p-4 rounded border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.academic_year_id,disabled:!0,onChange:j=>t({...e,academic_year_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Year"}),r.map(j=>l.jsx("option",{value:j.name,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.branch_id,disabled:!0,onChange:j=>t({...e,branch_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Branch"}),a.map(j=>l.jsx("option",{value:j.name,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Class"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.class_id,onChange:j=>t({...e,class_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Class"}),i.map(j=>l.jsx("option",{value:j.id,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Test"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.test_id,onChange:j=>t({...e,test_id:j.target.value}),children:[l.jsx("option",{value:"",children:"Select Test"}),c.map(j=>l.jsx("option",{value:j.id,children:j.name},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 uppercase mb-1",children:"Subject Type"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:e.subject_type,onChange:j=>t({...e,subject_type:j.target.value}),children:[l.jsx("option",{value:"",children:"All Types"}),l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]})]})]}),v?l.jsx("div",{className:"text-center py-10",children:"Loading Matrix..."}):m?l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 px-2",children:[l.jsxs("div",{className:"text-sm",children:["Test Max Marks: ",l.jsx("span",{className:"font-bold",children:p})]}),l.jsxs("div",{className:`text-sm ${F()>p?"text-red-600 font-bold":"text-green-600"}`,children:["Total Assigned: ",F()]})]}),l.jsx("div",{className:"overflow-x-auto border rounded shadow-sm",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"Subject Name"}),l.jsx("th",{className:"px-4 py-3",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-center",children:"Assigned"}),l.jsx("th",{className:"px-4 py-3 w-32",children:"Max Marks"}),l.jsx("th",{className:"px-4 py-3 w-32",children:"Order"})]})}),l.jsx("tbody",{className:"divide-y",children:d.map((j,U)=>l.jsxs("tr",{className:`hover:bg-gray-50 ${j.assigned?"bg-blue-50":""}`,children:[l.jsx("td",{className:"px-4 py-2 font-medium",children:j.subject_name}),l.jsx("td",{className:"px-4 py-2 text-gray-500",children:j.subject_type}),l.jsx("td",{className:"px-4 py-2 text-center",children:l.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-blue-600",checked:j.assigned,onChange:B=>q(U,"assigned",B.target.checked)})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",className:`w-full border rounded p-1 ${j.assigned?"":"bg-gray-100"}`,disabled:!j.assigned,value:j.max_marks??"",onChange:B=>q(U,"max_marks",Number(B.target.value))})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",className:`w-full border rounded p-1 ${j.assigned?"":"bg-gray-100"}`,disabled:!j.assigned,value:j.subject_order??"",onChange:B=>q(U,"subject_order",Number(B.target.value))})})]},j.subject_id))})]})}),l.jsxs("div",{className:"mt-6 flex justify-end",children:[l.jsx("button",{onClick:()=>k(),disabled:S,className:"bg-gray-200 text-gray-700 px-8 py-3 rounded shadow hover:bg-gray-300 flex items-center space-x-2",children:"Cancel"}),l.jsxs("button",{onClick:T,disabled:S,className:"bg-blue-600 text-white px-8 py-3 rounded shadow hover:bg-blue-700 flex items-center space-x-2",children:[l.jsx(ec,{size:16})," ",l.jsx("span",{children:S?"Saving...":"Save Assignments"})]})]})]}):l.jsx("div",{className:"text-center py-10 text-gray-500 italic",children:"Select filters to view assignment matrix"}),l.jsx(KF,{isOpen:E,onClose:()=>P(!1),sourceClassTestId:m,currentAcademicYear:e.academic_year_id,currentBranch:e.branch_id,currentClass:e.class_id,currentTest:e.test_id})]})}function JF(){const e=()=>{const T=localStorage.getItem("currentBranch");if(T&&T!=="undefined")return T;const q=localStorage.getItem("user");if(q)try{const F=JSON.parse(q);if(F.branch&&F.branch!=="All")return F.branch}catch(F){console.error("Error parsing user from localStorage",F)}return""},[t,r]=y.useState({academic_year_id:localStorage.getItem("academicYear")||"",branch_id:e(),class_id:""}),[n,a]=y.useState([]),[s,i]=y.useState([]),[o,c]=y.useState({}),[u,d]=y.useState({years:[],branches:[],classes:[]}),[f,m]=y.useState(!1),[h,p]=y.useState(!1),[g,v]=y.useState(""),[b,S]=y.useState([]);y.useEffect(()=>{_()},[]),y.useEffect(()=>{t.academic_year_id&&t.branch_id&&t.class_id?E():(i([]),a([]),c({}))},[t]);const _=async()=>{try{const[T,q,F]=await Promise.all([ke.get("/org/academic-years"),ke.get("/branches"),ke.get("/classes")]);d({years:T.data.academic_years,branches:q.data.branches,classes:F.data.classes})}catch(T){console.error("Failed to load dropdowns",T)}},E=async()=>{var T,q;m(!0),v(""),S([]);try{const F=await ke.get("/student-test-assignments",{params:t});a(F.data.columns),i(F.data.rows),c(F.data.assignments)}catch(F){console.error(F),v(((q=(T=F.response)==null?void 0:T.data)==null?void 0:q.error)||"Failed to load data")}finally{m(!1)}},P=async()=>{var T,q;if(b.length===0){alert("No changes to save");return}p(!0);try{await ke.post("/student-test-assignments",{...t,updates:b}),alert("Saved successfully!"),E()}catch(F){console.error(F),alert("Failed to save: "+(((q=(T=F.response)==null?void 0:T.data)==null?void 0:q.error)||"Unknown error"))}finally{p(!1)}},N=(T,q)=>{var F;return((F=o[T])==null?void 0:F.includes(q))||!1},I=(T,q,F)=>{c(j=>{const U=j[T]||[];return F?{...j,[T]:[...U,q]}:{...j,[T]:U.filter(B=>B!==q)}}),S(j=>[...j.filter(B=>!(B.student_id===T&&B.class_test_id===q)),{student_id:T,class_test_id:q,status:F}])},k=(T,q)=>{const F=[],j={...o};s.forEach(U=>{var X;((X=j[U.student_id])==null?void 0:X.includes(T))!==q&&(q?j[U.student_id]=[...j[U.student_id]||[],T]:j[U.student_id]=(j[U.student_id]||[]).filter(K=>K!==T),F.push({student_id:U.student_id,class_test_id:T,status:q}))}),c(j),S(U=>[...U.filter(X=>X.class_test_id!==T),...F])};return l.jsxs("div",{className:"p-4 bg-white rounded shadow min-h-screen flex flex-col",children:[l.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Assign Test to Students"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 bg-gray-50 p-4 rounded border",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Academic Year"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.academic_year_id,disabled:!0,onChange:T=>r({...t,academic_year_id:T.target.value}),children:[l.jsx("option",{value:"",children:"Select Year"}),u.years.map(T=>l.jsx("option",{value:T.name,children:T.name},T.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Branch"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.branch_id,disabled:!0,onChange:T=>r({...t,branch_id:T.target.value}),children:[l.jsx("option",{value:"",children:"Select Branch"}),u.branches.map(T=>l.jsx("option",{value:T.branch_name,children:T.branch_name},T.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 uppercase",children:"Class"}),l.jsxs("select",{className:"w-full border p-2 rounded",value:t.class_id,onChange:T=>r({...t,class_id:T.target.value}),children:[l.jsx("option",{value:"",children:"Select Class"}),u.classes.map(T=>l.jsx("option",{value:T.id,children:T.class_name},T.id))]})]})]}),f&&l.jsx("div",{className:"text-center py-10",children:"Loading Data..."}),g&&l.jsx("div",{className:"text-center py-10 text-red-600",children:g}),!f&&!g&&s.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto border rounded shadow-sm flex-1",children:l.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[l.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 border w-12 text-center",children:"S.No"}),l.jsx("th",{className:"px-3 py-2 border",children:"Student Name"}),l.jsx("th",{className:"px-3 py-2 border",children:"Sec"}),l.jsx("th",{className:"px-3 py-2 border w-24",children:"Roll"}),l.jsx("th",{className:"px-3 py-2 border w-24",children:"Adm No"}),n.map(T=>l.jsx("th",{className:"px-3 py-2 border text-center min-w-[100px]",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{className:"mb-1",children:T.test_name}),l.jsx("input",{type:"checkbox",title:"Select All",onChange:q=>k(T.class_test_id,q.target.checked)})]})},T.class_test_id))]})}),l.jsx("tbody",{children:s.map((T,q)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 border text-center",children:q+1}),l.jsx("td",{className:"px-3 py-2 border font-medium",children:T.name}),l.jsx("td",{className:"px-3 py-2 border text-center",children:T.section}),l.jsx("td",{className:"px-3 py-2 border",children:T.roll_number}),l.jsx("td",{className:"px-3 py-2 border",children:T.admission_no}),n.map(F=>l.jsx("td",{className:"px-3 py-2 border text-center",children:l.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-600",checked:N(T.student_id,F.class_test_id),onChange:j=>I(T.student_id,F.class_test_id,j.target.checked)})},F.class_test_id))]},T.student_id))})]})}),l.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[l.jsx("button",{onClick:()=>E(),disabled:h||b.length===0,className:`px-6 py-2 rounded text-gray-700 border transition hover:bg-gray-100
                                ${h||b.length===0?"opacity-50 cursor-not-allowed":""}
                            `,children:"Cancel"}),l.jsxs("button",{onClick:P,disabled:h||b.length===0,className:`flex items-center space-x-2 px-6 py-2 rounded text-white transition
                                ${h||b.length===0?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 shadow"}
                            `,children:[l.jsx(ec,{size:18}),l.jsx("span",{children:h?"Saving...":"Save Assignments"})]})]})]}),!f&&!g&&s.length===0&&t.class_id&&l.jsx("div",{className:"text-center py-10 text-gray-500",children:"No students found or data not loaded. Check filters."})]})}const ZF=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,s]=y.useState("Hyderabad"),[i,o]=y.useState([]),[c,u]=y.useState([]),[d,f]=y.useState([]),[m,h]=y.useState(!1),[p,g]=y.useState(null),[v,b]=y.useState(""),[S,_]=y.useState(100),[E,P]=y.useState(""),[N,I]=y.useState([]),[k,T]=y.useState(null),[q,F]=y.useState(null),[j,U]=y.useState(null),[B,X]=y.useState(null);y.useEffect(()=>{(async()=>{try{const J=JSON.parse(localStorage.getItem("user")||"{}"),G=localStorage.getItem("academicYear"),Q=localStorage.getItem("currentBranch")||J.branch,V=(await ke.get("/org/academic-years")).data.academic_years||[];if(o(V),G){const he=V.find(Z=>Z.name===G||String(Z.id)===G);t(he?he.name:G)}else V.length>0&&t(V[0].name);const we=(await ke.get("/branches")).data.branches||[];if(u(we),Q){const he=we.find(Z=>Z.branch_name===Q||String(Z.id)===Q);he?(n(he.branch_name),s(he.location_name||"Hyderabad")):n(Q)}else we.length>0&&n(we[0].branch_name)}catch(J){console.error("Failed to load context",J)}})()},[]),y.useEffect(()=>{!e||!r||K()},[e,r]);const K=async()=>{h(!0);try{const H=await ke.get("/grade-scales",{params:{academic_year:e,branch:r,location:a}});f(H.data)}catch(H){console.error("Failed to fetch scales",H)}finally{h(!1)}},ee=async H=>{h(!0),U(null),T(null),F(null);try{const G=(await ke.get(`/grade-scales/${H}`)).data;g(G.id),b(G.scale_name),_(G.total_marks||100),P(G.scale_description||""),I(G.details||[])}catch(J){console.error("Failed to load scale details",J),U("Failed to load scale details")}finally{h(!1)}},Y=()=>{g(null),g(null),b(""),_(100),P(""),I([]),U(null),X(null),T(null),F(null)},z=()=>{const H={grade:"",min_marks:0,max_marks:0,description:""},J=[...N,H];I(J),T(J.length-1),F(H)},ne=H=>{T(H),F({...N[H]})},le=()=>{T(null),F(null)},A=()=>{if(k===null||!q)return;if(!q.grade.trim()){alert("Grade cannot be empty");return}if(Number(q.min_marks)>Number(q.max_marks)){alert("Min marks cannot be greater than Max marks");return}if(Number(q.max_marks)>Number(S)){alert(`Max marks cannot exceed Total Marks (${S})`);return}const H=[...N];H[k]=q,I(H),T(null),F(null)},D=(H,J)=>{q&&F({...q,[H]:J})},L=H=>{k===H&&le();const J=[...N];J.splice(H,1),I(J),k!==null&&k>H&&T(k-1)},M=async()=>{var G,Q;if(!v.trim()){U("Scale Name is required");return}if(!e||!r){U("Context (Academic Year/Branch) is missing");return}if(k!==null){U("Please save or cancel the currently editing row first.");return}for(const de of N){if(!de.grade.trim()){U("All rows must have a Grade defined");return}if(de.min_marks<0||de.max_marks<0){U("Marks cannot be negative");return}if(Number(de.min_marks)>Number(de.max_marks)){U(`Min marks cannot be greater than Max marks for grade ${de.grade}`);return}if(Number(de.max_marks)>Number(S)){U(`Max marks for grade ${de.grade} cannot exceed Total Marks (${S})`);return}}const H=[...N].sort((de,V)=>Number(de.min_marks)-Number(V.min_marks));for(let de=0;de<H.length-1;de++)if(Number(H[de].max_marks)>=Number(H[de+1].min_marks)){U(`Overlapping range detected between ${H[de].grade} and ${H[de+1].grade}`);return}h(!0),U(null),X(null);const J={scale_name:v,scale_description:E,location:a,branch:r,academic_year:e,total_marks:S,details:N};try{p?(await ke.put(`/grade-scales/${p}`,J),X("Grade Scale updated successfully")):(await ke.post("/grade-scales",J),X("Grade Scale created successfully"),Y()),K()}catch(de){console.error("Save failed",de),U(((Q=(G=de.response)==null?void 0:G.data)==null?void 0:Q.error)||"Failed to save Grade Scale")}finally{h(!1)}},R=async H=>{var J,G;if(confirm("Are you sure you want to delete this Grade Scale?")){h(!0);try{await ke.delete(`/grade-scales/${H}`),X("Grade Scale deleted successfully"),p===H&&Y(),K()}catch(Q){console.error("Delete failed",Q),U(((G=(J=Q.response)==null?void 0:J.data)==null?void 0:G.error)||"Failed to delete Grade Scale")}finally{h(!1)}}};return l.jsxs("div",{className:"flex flex-col gap-6 h-full",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 flex justify-between items-center text-sm text-blue-800",children:[l.jsxs("div",{className:"flex gap-6",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Academic Year:"})," ",e||"Loading..."]}),l.jsxs("span",{children:[l.jsx("strong",{children:"User Branch:"})," ",r||"Loading..."]}),l.jsxs("span",{className:"bg-blue-200 px-2 py-0.5 rounded text-blue-900 font-bold",children:["Scope: ",a," (All Branches)"]})]}),l.jsx("div",{children:!e||!r?l.jsx("span",{className:"text-red-500 font-bold",children:"Context Missing! Check Header."}):null})]}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start h-full",children:[l.jsxs("div",{className:"w-full md:w-1/3 flex flex-col gap-6",children:[l.jsxs("div",{className:"bg-white p-5 rounded shadow border",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h3",{className:"font-semibold text-gray-700 flex items-center gap-2",children:"Grade Scale Master"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Scale Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Enter Scale Name",value:v,onChange:H=>b(H.target.value)})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Total Marks ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. 100",value:S,onChange:H=>_(Number(H.target.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scale Description"}),l.jsx("textarea",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none h-20 resize-none",placeholder:"Enter Description",value:E,onChange:H=>P(H.target.value)})]}),j&&l.jsxs("div",{className:"p-2 bg-red-50 text-red-600 text-sm rounded flex items-center gap-2",children:[l.jsx(Uh,{size:14})," ",j]}),B&&l.jsx("div",{className:"p-2 bg-green-50 text-green-600 text-sm rounded",children:B}),l.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[l.jsxs("button",{onClick:M,disabled:m,className:"bg-[#337ab7] text-white px-4 py-2 rounded text-sm font-medium hover:bg-blue-600 flex items-center gap-2",children:[l.jsx(ec,{size:16})," ",p?"Update":"Save"]}),l.jsxs("button",{onClick:Y,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded text-sm font-medium hover:bg-gray-200 border flex items-center gap-2",children:[l.jsx(zF,{size:16})," Reset"]})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded shadow border flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-4 pb-2 border-b",children:"Grade Scale List"}),l.jsx("div",{className:"overflow-auto max-h-[400px]",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"Scale Name"}),l.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),l.jsx("tbody",{children:d.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:2,className:"p-4 text-center text-gray-500",children:"No scales found."})}):d.map(H=>l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${p===H.id?"bg-blue-50":""}`,children:[l.jsx("td",{className:"p-2 font-medium",children:H.scale_name}),l.jsxs("td",{className:"p-2 flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>ee(H.id),className:"p-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit",children:l.jsx(sv,{size:14})}),l.jsx("button",{onClick:()=>R(H.id),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Delete",children:l.jsx(b5,{size:14})})]})]},H.id))})]})})]})]}),l.jsx("div",{className:"w-full md:w-2/3",children:l.jsxs("div",{className:"bg-white p-5 rounded shadow border min-h-[500px]",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-700 flex items-center gap-2",children:[l.jsx("span",{className:"w-2 h-6 bg-gray-600 rounded-sm"}),p?v:"Grade Scale Details",p&&l.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-2",children:["(Total Marks: ",S,")"]})]}),l.jsx("div",{className:"flex gap-2",children:l.jsx("button",{onClick:z,className:`p-1 text-white rounded ${p?"bg-purple-600 hover:bg-purple-700":"bg-gray-400 cursor-not-allowed"}`,title:p?"Add Row":"Select a scale to add rows",disabled:!p,children:l.jsx(gj,{size:20})})})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600 uppercase text-xs",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-3 text-center w-16",children:"S.No"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Grade"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Min"}),l.jsx("th",{className:"p-3 text-center w-24",children:"Maximum"}),l.jsx("th",{className:"p-3 text-left",children:"Description"}),l.jsx("th",{className:"p-3 text-center w-20",children:"Action"})]})}),l.jsx("tbody",{children:N.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:p?"No grades added yet. Click + to add.":"Please select/edit a Grade Scale from the list to manage details."})}):N.map((H,J)=>{const G=k===J,Q=G&&q?q:H;return l.jsxs("tr",{className:`border-b hover:bg-gray-50 ${G?"bg-blue-50":""}`,children:[l.jsx("td",{className:"p-2 text-center text-gray-500",children:J+1}),l.jsx("td",{className:"p-2 text-center",children:G?l.jsx("input",{type:"text",className:"border p-1 rounded w-16 text-center uppercase focus:ring-2 focus:ring-blue-500 outline-none",value:Q.grade,onChange:de=>D("grade",de.target.value),placeholder:"A1"}):l.jsx("span",{className:"font-medium text-gray-700",children:H.grade})}),l.jsx("td",{className:"p-2 text-center",children:G?l.jsx("input",{type:"number",className:"border p-1 rounded w-20 text-center focus:ring-2 focus:ring-blue-500 outline-none",value:Q.min_marks,onChange:de=>D("min_marks",de.target.value)}):l.jsx("span",{className:"text-gray-600",children:H.min_marks})}),l.jsx("td",{className:"p-2 text-center",children:G?l.jsx("input",{type:"number",className:"border p-1 rounded w-20 text-center focus:ring-2 focus:ring-blue-500 outline-none",value:Q.max_marks,onChange:de=>D("max_marks",de.target.value)}):l.jsx("span",{className:"text-gray-600",children:H.max_marks})}),l.jsx("td",{className:"p-2 text-left",children:G?l.jsx("input",{type:"text",className:"border p-1 rounded w-full text-left focus:ring-2 focus:ring-blue-500 outline-none",value:Q.description||"",onChange:de=>D("description",de.target.value),placeholder:"Grade Description"}):l.jsx("span",{className:"text-gray-600",children:H.description})}),l.jsx("td",{className:"p-2 text-center flex justify-center gap-2",children:G?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:A,className:"p-1 bg-green-500 text-white rounded hover:bg-green-600",title:"Save Changes",children:l.jsx(MF,{size:16})}),l.jsx("button",{onClick:le,className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Cancel Changes",children:l.jsx(xj,{size:16})})]}):l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>ne(J),className:"p-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit Row",children:l.jsx(sv,{size:14})}),l.jsx("button",{onClick:()=>L(J),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Remove Row",children:l.jsx(b5,{size:14})})]})})]},J)})})]})})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zh={};zh.version="0.18.5";var vj=1252,QF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Hy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qy=function(e){QF.indexOf(e)!=-1&&(vj=Hy[0]=e)};function e7(){qy(1252)}var Js=function(e){qy(e)};function Gy(){Js(1200),e7()}function S5(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function t7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function yj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Nd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?t7(e.slice(2)):t==254&&r==255?yj(e.slice(2)):t==65279?e.slice(1):e},V0=function(t){return String.fromCharCode(t)},_5=function(t){return String.fromCharCode(t)},zd,zo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $d(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=zo.charAt(s)+zo.charAt(i)+zo.charAt(o)+zo.charAt(c);return t}function us(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=zo.indexOf(e.charAt(u++)),i=zo.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=zo.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=zo.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Yt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),uo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Go(e){return Yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function N5(e){return Yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var as=function(t){return Yt?uo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Qm(e){if(typeof ArrayBuffer>"u")return as(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function nl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function r7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Vy(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Vy(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xn=Yt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:uo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function n7(e){for(var t=[],r=0,n=e.length+250,a=Go(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Go(65535),n=65530)}return t.push(a.slice(0,r)),Xn(t)}var Ia=/\u0000/g,Ad=/[\u0001-\u0006]/g;function Jc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Zs(e,t){var r=""+e;return r.length>=t?r:en("0",t-r.length)+r}function Yy(e,t){var r=""+e;return r.length>=t?r:en(" ",t-r.length)+r}function $h(e,t){var r=""+e;return r.length>=t?r:r+en(" ",t-r.length)}function a7(e,t){var r=""+Math.round(e);return r.length>=t?r:en("0",t-r.length)+r}function s7(e,t){var r=""+e;return r.length>=t?r:en("0",t-r.length)+r}var A5=Math.pow(2,32);function Ic(e,t){if(e>A5||e<-A5)return a7(e,t);var r=Math.round(e);return s7(r,t)}function Wh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var j5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},k5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*i+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=s):(d=u,o=i)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function jl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=h7(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var bj=new Date(1899,11,31,0,0,0),l7=bj.getTime(),c7=new Date(1900,2,1,0,0,0);function wj(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=c7&&(r+=1440*60*1e3),(r-(l7+(e.getTimezoneOffset()-bj.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ky(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function d7(e){var t=e<0?12:11,r=Ky(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function f7(e){var t=Ky(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Wd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=d7(e):t===10?r=e.toFixed(10).substr(0,12):r=f7(e),Ky(u7(r.toUpperCase()))}function Bl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Os(14,wj(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function h7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function m7(e,t,r,n){var a="",s=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return qg[r.m-1][1];case 5:return qg[r.m-1][0];default:return qg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return j5[r.q][0];default:return j5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Zs(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Zs(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Zs(c,u):"";return d}function $o(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Sj=/%/g;function p7(e,t,r){var n=t.replace(Sj,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+en("%",a)}function g7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _j(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_j(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Nj=/# (\?+)( ?)\/( ?)(\d+)/;function x7(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?en(" ",e[1].length+1+e[4].length):Yy(i,e[1].length)+e[2]+"/"+e[3]+Zs(o,e[4].length))}function v7(e,t,r){return r+(t===0?"":""+t)+en(" ",e[1].length+2+e[4].length)}var Aj=/^#*0*\.([0#]+)/,jj=/\).*[0#]/,kj=/\(###\) ###\\?-####/;function Ta(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function C5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function E5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function y7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function b7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _s(e,t,r){if(e.charCodeAt(0)===40&&!t.match(jj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_s("n",n,r):"("+_s("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return g7(e,t,r);if(t.indexOf("%")!==-1)return p7(e,t,r);if(t.indexOf("E")!==-1)return _j(t,r);if(t.charCodeAt(0)===36)return"$"+_s(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ic(c,t.length);if(t.match(/^[#?]+$/))return a=Ic(r,0),a==="0"&&(a=""),a.length>t.length?a:Ta(t.substr(0,t.length-a.length))+a;if(s=t.match(Nj))return x7(s,c,u);if(t.match(/^#+0+$/))return u+Ic(c,t.length-t.indexOf("0"));if(s=t.match(Aj))return a=C5(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+en("0",Ta(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+C5(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+$o(Ic(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_s(e,t,-r):$o(""+(Math.floor(r)+y7(r,s[1].length)))+"."+Zs(E5(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return _s(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Jc(_s(e,t.replace(/[\\-]/g,""),r)),i=0,Jc(Jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(kj))return a=_s(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Hh(c,Math.pow(10,i)-1,!1),a=""+u,d=Ki("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=$h(o[2],i),d.length<s[4].length&&(d=Ta(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Hh(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Yy(o[1],i)+s[2]+"/"+s[3]+$h(o[2],i):en(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ic(r,0),t.length<=a.length?a:Ta(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,m=t.length-a.length-f;return Ta(t.substr(0,f)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=E5(r,s[1].length),r<0?"-"+_s(e,t,-r):$o(b7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Zs(0,3-p.length):"")+p})+"."+Zs(i,s[1].length);switch(t){case"###,##0.00":return _s(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=$o(Ic(c,0));return h!=="0"?u+h:"";case"###,###.00":return _s(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _s(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function w7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ki(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function S7(e,t,r){var n=t.replace(Sj,""),a=t.length-n.length;return Ki(e,n,r*Math.pow(10,2*a))+en("%",a)}function Cj(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Cj(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function pi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(jj)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pi("n",n,r):"("+pi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return w7(e,t,r);if(t.indexOf("%")!==-1)return S7(e,t,r);if(t.indexOf("E")!==-1)return Cj(t,r);if(t.charCodeAt(0)===36)return"$"+pi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Zs(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ta(t.substr(0,t.length-a.length))+a;if(s=t.match(Nj))return v7(s,c,u);if(t.match(/^#+0+$/))return u+Zs(c,t.length-t.indexOf("0"));if(s=t.match(Aj))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])),a=a.replace(/\.(\d*)$/,function(p,g){return"."+g+en("0",Ta(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+$o(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pi(e,t,-r):$o(""+r)+"."+en("0",s[1].length);if(s=t.match(/^#,#*,#0/))return pi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Jc(pi(e,t.replace(/[\\-]/g,""),r)),i=0,Jc(Jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(kj))return a=pi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Hh(c,Math.pow(10,i)-1,!1),a=""+u,d=Ki("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=$h(o[2],i),d.length<s[4].length&&(d=Ta(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Hh(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Yy(o[1],i)+s[2]+"/"+s[3]+$h(o[2],i):en(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ta(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,m=t.length-a.length-f;return Ta(t.substr(0,f)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+pi(e,t,-r):$o(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Zs(0,3-p.length):"")+p})+"."+Zs(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=$o(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return pi(e,t.slice(0,t.lastIndexOf(".")),r)+Ta(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ki(e,t,r){return(r|0)===r?pi(e,t,r):_s(e,t,r)}function _7(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ej=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Wh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Ej))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function N7(e,t,r,n){for(var a=[],s="",i=0,o="",c="t",u,d,f,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Wh(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),p=h==="("||h===")"?h:"t";a[a.length]={t:p,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=jl(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=jl(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(u==null&&(u=jl(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",i+=5,m="h"):(g.t="t",++i),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Ej)){if(u==null&&(u=jl(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yu(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var v=0,b=0,S;for(i=a.length-1,c="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=m,c="h",v<1&&(v=1);break;case"s":(S=a[i].v.match(/\.0+$/))&&(b=Math.max(b,S[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=a[i].t;break;case"m":c==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=m7(a[i].t.charCodeAt(0),a[i].v,u,b),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;_+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=Bl(t,r);break}var P="",N,I;if(_.length>0){_.charCodeAt(0)==40?(N=t<0&&_.charCodeAt(0)===45?-t:t,I=Ki("n",_,N)):(N=t<0&&n>1?-t:t,I=Ki("n",_,N),N<0&&a[0]&&a[0].t=="t"&&(I=I.substr(1),a[0].v="-"+a[0].v)),E=I.length-1;var k=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){k=i;break}var T=a.length;if(k===a.length&&I.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=I.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=I.substr(0,E+1),E=-1),a[i].t="t",T=i);E>=0&&T<a.length&&(a[T].v=I.substr(0,E+1)+a[T].v)}else if(k!==a.length&&I.indexOf("E")===-1){for(E=I.indexOf(".")-1,i=k;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===k?a[i].v.indexOf(".")-1:a[i].v.length-1,P=a[i].v.substr(d+1);d>=0;--d)E>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(P=I.charAt(E--)+P);a[i].v=P,a[i].t="t",T=i}for(E>=0&&T<a.length&&(a[T].v=I.substr(0,E+1)+a[T].v),E=I.indexOf(".")+1,i=k;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==k)){for(d=a[i].v.indexOf(".")>-1&&i===k?a[i].v.indexOf(".")+1:0,P=a[i].v.substr(0,d);d<a[i].v.length;++d)E<I.length&&(P+=I.charAt(E++));a[i].v=P,a[i].t="t",T=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(N=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Ki(a[i].t,a[i].v,N),a[i].t="t");var q="";for(i=0;i!==a.length;++i)a[i]!=null&&(q+=a[i].v);return q}var T5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function P5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function A7(e,t){var r=_7(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(T5),o=r[1].match(T5);return P5(t,i)?[n,r[0]]:P5(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Os(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Lt)[e],n==null&&(n=r.table&&r.table[k5[e]]||Lt[k5[e]]),n==null&&(n=o7[e]||"General");break}if(Wh(n,0))return Bl(t,r);t instanceof Date&&(t=wj(t,r.date1904));var a=A7(n,t);if(Wh(a[1]))return Bl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return N7(a[1],t,r,a[0])}function Xi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Lt[r]==null){t<0&&(t=r);continue}if(Lt[r]==e){t=r;break}}t<0&&(t=391)}return Lt[t]=e,t}function ep(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Xi(e[t],t)}function bu(){Lt=i7()}var j7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Tj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k7(e){var t=typeof e=="number"?Lt[e]:e;return t=t.replace(Tj,"(\\d+)"),new RegExp("^"+t+"$")}function C7(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(t.match(Tj)||[]).forEach(function(f,m){var h=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":c=h;break;case"m":i>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var E7=(function(){var e={};e.version="1.2.0";function t(){for(var I=0,k=new Array(256),T=0;T!=256;++T)I=T,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,k[T]=I;return typeof Int32Array<"u"?new Int32Array(k):k}var r=t();function n(I){var k=0,T=0,q=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)F[q]=I[q];for(q=0;q!=256;++q)for(T=I[q],k=256+q;k<4096;k+=256)T=F[k]=T>>>8^I[T&255];var j=[];for(q=1;q!=16;++q)j[q-1]=typeof Int32Array<"u"?F.subarray(q*256,q*256+256):F.slice(q*256,q*256+256);return j}var a=n(r),s=a[0],i=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],m=a[7],h=a[8],p=a[9],g=a[10],v=a[11],b=a[12],S=a[13],_=a[14];function E(I,k){for(var T=k^-1,q=0,F=I.length;q<F;)T=T>>>8^r[(T^I.charCodeAt(q++))&255];return~T}function P(I,k){for(var T=k^-1,q=I.length-15,F=0;F<q;)T=_[I[F++]^T&255]^S[I[F++]^T>>8&255]^b[I[F++]^T>>16&255]^v[I[F++]^T>>>24]^g[I[F++]]^p[I[F++]]^h[I[F++]]^m[I[F++]]^f[I[F++]]^d[I[F++]]^u[I[F++]]^c[I[F++]]^o[I[F++]]^i[I[F++]]^s[I[F++]]^r[I[F++]];for(q+=15;F<q;)T=T>>>8^r[(T^I[F++])&255];return~T}function N(I,k){for(var T=k^-1,q=0,F=I.length,j=0,U=0;q<F;)j=I.charCodeAt(q++),j<128?T=T>>>8^r[(T^j)&255]:j<2048?(T=T>>>8^r[(T^(192|j>>6&31))&255],T=T>>>8^r[(T^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,U=I.charCodeAt(q++)&1023,T=T>>>8^r[(T^(240|j>>8&7))&255],T=T>>>8^r[(T^(128|j>>2&63))&255],T=T>>>8^r[(T^(128|U>>6&15|(j&3)<<4))&255],T=T>>>8^r[(T^(128|U&63))&255]):(T=T>>>8^r[(T^(224|j>>12&15))&255],T=T>>>8^r[(T^(128|j>>6&63))&255],T=T>>>8^r[(T^(128|j&63))&255]);return~T}return e.table=r,e.bstr=E,e.buf=P,e.str=N,e})(),Ct=(function(){var t={};t.version="1.2.1";function r(se,ve){for(var ue=se.split("/"),fe=ve.split("/"),xe=0,ye=0,De=Math.min(ue.length,fe.length);xe<De;++xe){if(ye=ue[xe].length-fe[xe].length)return ye;if(ue[xe]!=fe[xe])return ue[xe]<fe[xe]?-1:1}return ue.length-fe.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var ve=se.lastIndexOf("/");return ve===-1?se:se.slice(0,ve+1)}function a(se){if(se.charAt(se.length-1)=="/")return a(se.slice(0,-1));var ve=se.lastIndexOf("/");return ve===-1?se:se.slice(ve+1)}function s(se,ve){typeof ve=="string"&&(ve=new Date(ve));var ue=ve.getHours();ue=ue<<6|ve.getMinutes(),ue=ue<<5|ve.getSeconds()>>>1,se.write_shift(2,ue);var fe=ve.getFullYear()-1980;fe=fe<<4|ve.getMonth()+1,fe=fe<<5|ve.getDate(),se.write_shift(2,fe)}function i(se){var ve=se.read_shift(2)&65535,ue=se.read_shift(2)&65535,fe=new Date,xe=ue&31;ue>>>=5;var ye=ue&15;ue>>>=4,fe.setMilliseconds(0),fe.setFullYear(ue+1980),fe.setMonth(ye-1),fe.setDate(xe);var De=ve&31;ve>>>=5;var We=ve&63;return ve>>>=6,fe.setHours(ve),fe.setMinutes(We),fe.setSeconds(De<<1),fe}function o(se){ia(se,0);for(var ve={},ue=0;se.l<=se.length-4;){var fe=se.read_shift(2),xe=se.read_shift(2),ye=se.l+xe,De={};switch(fe){case 21589:ue=se.read_shift(1),ue&1&&(De.mtime=se.read_shift(4)),xe>5&&(ue&2&&(De.atime=se.read_shift(4)),ue&4&&(De.ctime=se.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}se.l=ye,ve[fe]=De}return ve}var c;function u(){return c||(c={})}function d(se,ve){if(se[0]==80&&se[1]==75)return yt(se,ve);if((se[0]|32)==109&&(se[1]|32)==105)return Ma(se,ve);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var ue=3,fe=512,xe=0,ye=0,De=0,We=0,Ie=0,Be=[],ze=se.slice(0,512);ia(ze,0);var nt=f(ze);switch(ue=nt[0],ue){case 3:fe=512;break;case 4:fe=4096;break;case 0:if(nt[1]==0)return yt(se,ve);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}fe!==512&&(ze=se.slice(0,fe),ia(ze,28));var st=se.slice(0,fe);m(ze,ue);var ft=ze.read_shift(4,"i");if(ue===3&&ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ft);ze.l+=4,De=ze.read_shift(4,"i"),ze.l+=4,ze.chk("00100000","Mini Stream Cutoff Size: "),We=ze.read_shift(4,"i"),xe=ze.read_shift(4,"i"),Ie=ze.read_shift(4,"i"),ye=ze.read_shift(4,"i");for(var at=-1,dt=0;dt<109&&(at=ze.read_shift(4,"i"),!(at<0));++dt)Be[dt]=at;var Bt=h(se,fe);v(Ie,ye,Bt,fe,Be);var dr=S(Bt,De,Be,fe);dr[De].name="!Directory",xe>0&&We!==U&&(dr[We].name="!MiniFAT"),dr[Be[0]].name="!FAT",dr.fat_addrs=Be,dr.ssz=fe;var br={},gn=[],Ms=[],Pi=[];_(De,dr,Bt,gn,xe,br,Ms,We),p(Ms,Pi,gn),gn.shift();var oi={FileIndex:Ms,FullPaths:Pi};return ve&&ve.raw&&(oi.raw={header:st,sectors:Bt}),oi}function f(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(B,"Header Signature: "),se.l+=16;var ve=se.read_shift(2,"u");return[se.read_shift(2,"u"),ve]}function m(se,ve){var ue=9;switch(se.l+=2,ue=se.read_shift(2)){case 9:if(ve!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(ve!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function h(se,ve){for(var ue=Math.ceil(se.length/ve)-1,fe=[],xe=1;xe<ue;++xe)fe[xe-1]=se.slice(xe*ve,(xe+1)*ve);return fe[ue-1]=se.slice(ue*ve),fe}function p(se,ve,ue){for(var fe=0,xe=0,ye=0,De=0,We=0,Ie=ue.length,Be=[],ze=[];fe<Ie;++fe)Be[fe]=ze[fe]=fe,ve[fe]=ue[fe];for(;We<ze.length;++We)fe=ze[We],xe=se[fe].L,ye=se[fe].R,De=se[fe].C,Be[fe]===fe&&(xe!==-1&&Be[xe]!==xe&&(Be[fe]=Be[xe]),ye!==-1&&Be[ye]!==ye&&(Be[fe]=Be[ye])),De!==-1&&(Be[De]=fe),xe!==-1&&fe!=Be[fe]&&(Be[xe]=Be[fe],ze.lastIndexOf(xe)<We&&ze.push(xe)),ye!==-1&&fe!=Be[fe]&&(Be[ye]=Be[fe],ze.lastIndexOf(ye)<We&&ze.push(ye));for(fe=1;fe<Ie;++fe)Be[fe]===fe&&(ye!==-1&&Be[ye]!==ye?Be[fe]=Be[ye]:xe!==-1&&Be[xe]!==xe&&(Be[fe]=Be[xe]));for(fe=1;fe<Ie;++fe)if(se[fe].type!==0){if(We=fe,We!=Be[We])do We=Be[We],ve[fe]=ve[We]+"/"+ve[fe];while(We!==0&&Be[We]!==-1&&We!=Be[We]);Be[fe]=-1}for(ve[0]+="/",fe=1;fe<Ie;++fe)se[fe].type!==2&&(ve[fe]+="/")}function g(se,ve,ue){for(var fe=se.start,xe=se.size,ye=[],De=fe;ue&&xe>0&&De>=0;)ye.push(ve.slice(De*j,De*j+j)),xe-=j,De=_l(ue,De*4);return ye.length===0?Ge(0):Xn(ye).slice(0,se.size)}function v(se,ve,ue,fe,xe){var ye=U;if(se===U){if(ve!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var De=ue[se],We=(fe>>>2)-1;if(!De)return;for(var Ie=0;Ie<We&&(ye=_l(De,Ie*4))!==U;++Ie)xe.push(ye);v(_l(De,fe-4),ve-1,ue,fe,xe)}}function b(se,ve,ue,fe,xe){var ye=[],De=[];xe||(xe=[]);var We=fe-1,Ie=0,Be=0;for(Ie=ve;Ie>=0;){xe[Ie]=!0,ye[ye.length]=Ie,De.push(se[Ie]);var ze=ue[Math.floor(Ie*4/fe)];if(Be=Ie*4&We,fe<4+Be)throw new Error("FAT boundary crossed: "+Ie+" 4 "+fe);if(!se[ze])break;Ie=_l(se[ze],Be)}return{nodes:ye,data:W5([De])}}function S(se,ve,ue,fe){var xe=se.length,ye=[],De=[],We=[],Ie=[],Be=fe-1,ze=0,nt=0,st=0,ft=0;for(ze=0;ze<xe;++ze)if(We=[],st=ze+ve,st>=xe&&(st-=xe),!De[st]){Ie=[];var at=[];for(nt=st;nt>=0;){at[nt]=!0,De[nt]=!0,We[We.length]=nt,Ie.push(se[nt]);var dt=ue[Math.floor(nt*4/fe)];if(ft=nt*4&Be,fe<4+ft)throw new Error("FAT boundary crossed: "+nt+" 4 "+fe);if(!se[dt]||(nt=_l(se[dt],ft),at[nt]))break}ye[st]={nodes:We,data:W5([Ie])}}return ye}function _(se,ve,ue,fe,xe,ye,De,We){for(var Ie=0,Be=fe.length?2:0,ze=ve[se].data,nt=0,st=0,ft;nt<ze.length;nt+=128){var at=ze.slice(nt,nt+128);ia(at,64),st=at.read_shift(2),ft=r2(at,0,st-Be),fe.push(ft);var dt={name:ft,type:at.read_shift(1),color:at.read_shift(1),L:at.read_shift(4,"i"),R:at.read_shift(4,"i"),C:at.read_shift(4,"i"),clsid:at.read_shift(16),state:at.read_shift(4,"i"),start:0,size:0},Bt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Bt!==0&&(dt.ct=E(at,at.l-8));var dr=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);dr!==0&&(dt.mt=E(at,at.l-8)),dt.start=at.read_shift(4,"i"),dt.size=at.read_shift(4,"i"),dt.size<0&&dt.start<0&&(dt.size=dt.type=0,dt.start=U,dt.name=""),dt.type===5?(Ie=dt.start,xe>0&&Ie!==U&&(ve[Ie].name="!StreamData")):dt.size>=4096?(dt.storage="fat",ve[dt.start]===void 0&&(ve[dt.start]=b(ue,dt.start,ve.fat_addrs,ve.ssz)),ve[dt.start].name=dt.name,dt.content=ve[dt.start].data.slice(0,dt.size)):(dt.storage="minifat",dt.size<0?dt.size=0:Ie!==U&&dt.start!==U&&ve[Ie]&&(dt.content=g(dt,ve[Ie].data,(ve[We]||{}).data))),dt.content&&ia(dt.content,0),ye[ft]=dt,De.push(dt)}}function E(se,ve){return new Date((ns(se,ve+4)/1e7*Math.pow(2,32)+ns(se,ve)/1e7-11644473600)*1e3)}function P(se,ve){return u(),d(c.readFileSync(se),ve)}function N(se,ve){var ue=ve&&ve.type;switch(ue||Yt&&Buffer.isBuffer(se)&&(ue="buffer"),ue||"base64"){case"file":return P(se,ve);case"base64":return d(as(us(se)),ve);case"binary":return d(as(se),ve)}return d(se,ve)}function I(se,ve){var ue=ve||{},fe=ue.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=fe+"/",se.FileIndex[0]={name:fe,type:5}),ue.CLSID&&(se.FileIndex[0].clsid=ue.CLSID),k(se)}function k(se){var ve="Sh33tJ5";if(!Ct.find(se,"/"+ve)){var ue=Ge(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,se.FileIndex.push({name:ve,type:2,content:ue,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+ve),T(se)}}function T(se,ve){I(se);for(var ue=!1,fe=!1,xe=se.FullPaths.length-1;xe>=0;--xe){var ye=se.FileIndex[xe];switch(ye.type){case 0:fe?ue=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:fe=!0,isNaN(ye.R*ye.L*ye.C)&&(ue=!0),ye.R>-1&&ye.L>-1&&ye.R==ye.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!ve)){var De=new Date(1987,1,19),We=0,Ie=Object.create?Object.create(null):{},Be=[];for(xe=0;xe<se.FullPaths.length;++xe)Ie[se.FullPaths[xe]]=!0,se.FileIndex[xe].type!==0&&Be.push([se.FullPaths[xe],se.FileIndex[xe]]);for(xe=0;xe<Be.length;++xe){var ze=n(Be[xe][0]);fe=Ie[ze],fe||(Be.push([ze,{name:a(ze).replace("/",""),type:1,clsid:K,ct:De,mt:De,content:null}]),Ie[ze]=!0)}for(Be.sort(function(ft,at){return r(ft[0],at[0])}),se.FullPaths=[],se.FileIndex=[],xe=0;xe<Be.length;++xe)se.FullPaths[xe]=Be[xe][0],se.FileIndex[xe]=Be[xe][1];for(xe=0;xe<Be.length;++xe){var nt=se.FileIndex[xe],st=se.FullPaths[xe];if(nt.name=a(st).replace("/",""),nt.L=nt.R=nt.C=-(nt.color=1),nt.size=nt.content?nt.content.length:0,nt.start=0,nt.clsid=nt.clsid||K,xe===0)nt.C=Be.length>1?1:-1,nt.size=0,nt.type=5;else if(st.slice(-1)=="/"){for(We=xe+1;We<Be.length&&n(se.FullPaths[We])!=st;++We);for(nt.C=We>=Be.length?-1:We,We=xe+1;We<Be.length&&n(se.FullPaths[We])!=n(st);++We);nt.R=We>=Be.length?-1:We,nt.type=1}else n(se.FullPaths[xe+1]||"")==n(st)&&(nt.R=xe+1),nt.type=2}}}function q(se,ve){var ue=ve||{};if(ue.fileType=="mad")return xt(se,ue);switch(T(se),ue.fileType){case"zip":return fr(se,ue)}var fe=(function(ft){for(var at=0,dt=0,Bt=0;Bt<ft.FileIndex.length;++Bt){var dr=ft.FileIndex[Bt];if(dr.content){var br=dr.content.length;br>0&&(br<4096?at+=br+63>>6:dt+=br+511>>9)}}for(var gn=ft.FullPaths.length+3>>2,Ms=at+7>>3,Pi=at+127>>7,oi=Ms+dt+gn+Pi,Rs=oi+127>>7,li=Rs<=109?0:Math.ceil((Rs-109)/127);oi+Rs+li+127>>7>Rs;)li=++Rs<=109?0:Math.ceil((Rs-109)/127);var Xa=[1,li,Rs,Pi,gn,dt,at,0];return ft.FileIndex[0].size=at<<6,Xa[7]=(ft.FileIndex[0].start=Xa[0]+Xa[1]+Xa[2]+Xa[3]+Xa[4]+Xa[5])+(Xa[6]+7>>3),Xa})(se),xe=Ge(fe[7]<<9),ye=0,De=0;{for(ye=0;ye<8;++ye)xe.write_shift(1,X[ye]);for(ye=0;ye<8;++ye)xe.write_shift(2,0);for(xe.write_shift(2,62),xe.write_shift(2,3),xe.write_shift(2,65534),xe.write_shift(2,9),xe.write_shift(2,6),ye=0;ye<3;++ye)xe.write_shift(2,0);for(xe.write_shift(4,0),xe.write_shift(4,fe[2]),xe.write_shift(4,fe[0]+fe[1]+fe[2]+fe[3]-1),xe.write_shift(4,0),xe.write_shift(4,4096),xe.write_shift(4,fe[3]?fe[0]+fe[1]+fe[2]-1:U),xe.write_shift(4,fe[3]),xe.write_shift(-4,fe[1]?fe[0]-1:U),xe.write_shift(4,fe[1]),ye=0;ye<109;++ye)xe.write_shift(-4,ye<fe[2]?fe[1]+ye:-1)}if(fe[1])for(De=0;De<fe[1];++De){for(;ye<236+De*127;++ye)xe.write_shift(-4,ye<fe[2]?fe[1]+ye:-1);xe.write_shift(-4,De===fe[1]-1?U:De+1)}var We=function(ft){for(De+=ft;ye<De-1;++ye)xe.write_shift(-4,ye+1);ft&&(++ye,xe.write_shift(-4,U))};for(De=ye=0,De+=fe[1];ye<De;++ye)xe.write_shift(-4,ee.DIFSECT);for(De+=fe[2];ye<De;++ye)xe.write_shift(-4,ee.FATSECT);We(fe[3]),We(fe[4]);for(var Ie=0,Be=0,ze=se.FileIndex[0];Ie<se.FileIndex.length;++Ie)ze=se.FileIndex[Ie],ze.content&&(Be=ze.content.length,!(Be<4096)&&(ze.start=De,We(Be+511>>9)));for(We(fe[6]+7>>3);xe.l&511;)xe.write_shift(-4,ee.ENDOFCHAIN);for(De=ye=0,Ie=0;Ie<se.FileIndex.length;++Ie)ze=se.FileIndex[Ie],ze.content&&(Be=ze.content.length,!(!Be||Be>=4096)&&(ze.start=De,We(Be+63>>6)));for(;xe.l&511;)xe.write_shift(-4,ee.ENDOFCHAIN);for(ye=0;ye<fe[4]<<2;++ye){var nt=se.FullPaths[ye];if(!nt||nt.length===0){for(Ie=0;Ie<17;++Ie)xe.write_shift(4,0);for(Ie=0;Ie<3;++Ie)xe.write_shift(4,-1);for(Ie=0;Ie<12;++Ie)xe.write_shift(4,0);continue}ze=se.FileIndex[ye],ye===0&&(ze.start=ze.size?ze.start-1:U);var st=ye===0&&ue.root||ze.name;if(Be=2*(st.length+1),xe.write_shift(64,st,"utf16le"),xe.write_shift(2,Be),xe.write_shift(1,ze.type),xe.write_shift(1,ze.color),xe.write_shift(-4,ze.L),xe.write_shift(-4,ze.R),xe.write_shift(-4,ze.C),ze.clsid)xe.write_shift(16,ze.clsid,"hex");else for(Ie=0;Ie<4;++Ie)xe.write_shift(4,0);xe.write_shift(4,ze.state||0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,ze.start),xe.write_shift(4,ze.size),xe.write_shift(4,0)}for(ye=1;ye<se.FileIndex.length;++ye)if(ze=se.FileIndex[ye],ze.size>=4096)if(xe.l=ze.start+1<<9,Yt&&Buffer.isBuffer(ze.content))ze.content.copy(xe,xe.l,0,ze.size),xe.l+=ze.size+511&-512;else{for(Ie=0;Ie<ze.size;++Ie)xe.write_shift(1,ze.content[Ie]);for(;Ie&511;++Ie)xe.write_shift(1,0)}for(ye=1;ye<se.FileIndex.length;++ye)if(ze=se.FileIndex[ye],ze.size>0&&ze.size<4096)if(Yt&&Buffer.isBuffer(ze.content))ze.content.copy(xe,xe.l,0,ze.size),xe.l+=ze.size+63&-64;else{for(Ie=0;Ie<ze.size;++Ie)xe.write_shift(1,ze.content[Ie]);for(;Ie&63;++Ie)xe.write_shift(1,0)}if(Yt)xe.l=xe.length;else for(;xe.l<xe.length;)xe.write_shift(1,0);return xe}function F(se,ve){var ue=se.FullPaths.map(function(Ie){return Ie.toUpperCase()}),fe=ue.map(function(Ie){var Be=Ie.split("/");return Be[Be.length-(Ie.slice(-1)=="/"?2:1)]}),xe=!1;ve.charCodeAt(0)===47?(xe=!0,ve=ue[0].slice(0,-1)+ve):xe=ve.indexOf("/")!==-1;var ye=ve.toUpperCase(),De=xe===!0?ue.indexOf(ye):fe.indexOf(ye);if(De!==-1)return se.FileIndex[De];var We=!ye.match(Ad);for(ye=ye.replace(Ia,""),We&&(ye=ye.replace(Ad,"!")),De=0;De<ue.length;++De)if((We?ue[De].replace(Ad,"!"):ue[De]).replace(Ia,"")==ye||(We?fe[De].replace(Ad,"!"):fe[De]).replace(Ia,"")==ye)return se.FileIndex[De];return null}var j=64,U=-2,B="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(se,ve,ue){u();var fe=q(se,ue);c.writeFileSync(ve,fe)}function z(se){for(var ve=new Array(se.length),ue=0;ue<se.length;++ue)ve[ue]=String.fromCharCode(se[ue]);return ve.join("")}function ne(se,ve){var ue=q(se,ve);switch(ve&&ve.type||"buffer"){case"file":return u(),c.writeFileSync(ve.filename,ue),ue;case"binary":return typeof ue=="string"?ue:z(ue);case"base64":return $d(typeof ue=="string"?ue:z(ue));case"buffer":if(Yt)return Buffer.isBuffer(ue)?ue:uo(ue);case"array":return typeof ue=="string"?as(ue):ue}return ue}var le;function A(se){try{var ve=se.InflateRaw,ue=new ve;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)le=se;else throw new Error("zlib does not expose bytesRead")}catch(fe){console.error("cannot use native zlib: "+(fe.message||fe))}}function D(se,ve){if(!le)return gt(se,ve);var ue=le.InflateRaw,fe=new ue,xe=fe._processChunk(se.slice(se.l),fe._finishFlushFlag);return se.l+=fe.bytesRead,xe}function L(se){return le?le.deflateRawSync(se):lt(se)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(se){var ve=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(ve>>16|ve>>8|ve)&255}for(var G=typeof Uint8Array<"u",Q=G?new Uint8Array(256):[],de=0;de<256;++de)Q[de]=J(de);function V(se,ve){var ue=Q[se&255];return ve<=8?ue>>>8-ve:(ue=ue<<8|Q[se>>8&255],ve<=16?ue>>>16-ve:(ue=ue<<8|Q[se>>16&255],ue>>>24-ve))}function Ee(se,ve){var ue=ve&7,fe=ve>>>3;return(se[fe]|(ue<=6?0:se[fe+1]<<8))>>>ue&3}function we(se,ve){var ue=ve&7,fe=ve>>>3;return(se[fe]|(ue<=5?0:se[fe+1]<<8))>>>ue&7}function he(se,ve){var ue=ve&7,fe=ve>>>3;return(se[fe]|(ue<=4?0:se[fe+1]<<8))>>>ue&15}function Z(se,ve){var ue=ve&7,fe=ve>>>3;return(se[fe]|(ue<=3?0:se[fe+1]<<8))>>>ue&31}function Se(se,ve){var ue=ve&7,fe=ve>>>3;return(se[fe]|(ue<=1?0:se[fe+1]<<8))>>>ue&127}function ge(se,ve,ue){var fe=ve&7,xe=ve>>>3,ye=(1<<ue)-1,De=se[xe]>>>fe;return ue<8-fe||(De|=se[xe+1]<<8-fe,ue<16-fe)||(De|=se[xe+2]<<16-fe,ue<24-fe)||(De|=se[xe+3]<<24-fe),De&ye}function pe(se,ve,ue){var fe=ve&7,xe=ve>>>3;return fe<=5?se[xe]|=(ue&7)<<fe:(se[xe]|=ue<<fe&255,se[xe+1]=(ue&7)>>8-fe),ve+3}function Ae(se,ve,ue){var fe=ve&7,xe=ve>>>3;return ue=(ue&1)<<fe,se[xe]|=ue,ve+1}function Le(se,ve,ue){var fe=ve&7,xe=ve>>>3;return ue<<=fe,se[xe]|=ue&255,ue>>>=8,se[xe+1]=ue,ve+8}function Pe(se,ve,ue){var fe=ve&7,xe=ve>>>3;return ue<<=fe,se[xe]|=ue&255,ue>>>=8,se[xe+1]=ue&255,se[xe+2]=ue>>>8,ve+16}function Oe(se,ve){var ue=se.length,fe=2*ue>ve?2*ue:ve+5,xe=0;if(ue>=ve)return se;if(Yt){var ye=N5(fe);if(se.copy)se.copy(ye);else for(;xe<se.length;++xe)ye[xe]=se[xe];return ye}else if(G){var De=new Uint8Array(fe);if(De.set)De.set(se);else for(;xe<ue;++xe)De[xe]=se[xe];return De}return se.length=fe,se}function Ve(se){for(var ve=new Array(se),ue=0;ue<se;++ue)ve[ue]=0;return ve}function et(se,ve,ue){var fe=1,xe=0,ye=0,De=0,We=0,Ie=se.length,Be=G?new Uint16Array(32):Ve(32);for(ye=0;ye<32;++ye)Be[ye]=0;for(ye=Ie;ye<ue;++ye)se[ye]=0;Ie=se.length;var ze=G?new Uint16Array(Ie):Ve(Ie);for(ye=0;ye<Ie;++ye)Be[xe=se[ye]]++,fe<xe&&(fe=xe),ze[ye]=0;for(Be[0]=0,ye=1;ye<=fe;++ye)Be[ye+16]=We=We+Be[ye-1]<<1;for(ye=0;ye<Ie;++ye)We=se[ye],We!=0&&(ze[ye]=Be[We+16]++);var nt=0;for(ye=0;ye<Ie;++ye)if(nt=se[ye],nt!=0)for(We=V(ze[ye],fe)>>fe-nt,De=(1<<fe+4-nt)-1;De>=0;--De)ve[We|De<<nt]=nt&15|ye<<4;return fe}var _t=G?new Uint16Array(512):Ve(512),Tt=G?new Uint16Array(32):Ve(32);if(!G){for(var At=0;At<512;++At)_t[At]=0;for(At=0;At<32;++At)Tt[At]=0}(function(){for(var se=[],ve=0;ve<32;ve++)se.push(5);et(se,Tt,32);var ue=[];for(ve=0;ve<=143;ve++)ue.push(8);for(;ve<=255;ve++)ue.push(9);for(;ve<=279;ve++)ue.push(7);for(;ve<=287;ve++)ue.push(8);et(ue,_t,288)})();var pt=(function(){for(var ve=G?new Uint8Array(32768):[],ue=0,fe=0;ue<H.length-1;++ue)for(;fe<H[ue+1];++fe)ve[fe]=ue;for(;fe<32768;++fe)ve[fe]=29;var xe=G?new Uint8Array(259):[];for(ue=0,fe=0;ue<R.length-1;++ue)for(;fe<R[ue+1];++fe)xe[fe]=ue;function ye(We,Ie){for(var Be=0;Be<We.length;){var ze=Math.min(65535,We.length-Be),nt=Be+ze==We.length;for(Ie.write_shift(1,+nt),Ie.write_shift(2,ze),Ie.write_shift(2,~ze&65535);ze-- >0;)Ie[Ie.l++]=We[Be++]}return Ie.l}function De(We,Ie){for(var Be=0,ze=0,nt=G?new Uint16Array(32768):[];ze<We.length;){var st=Math.min(65535,We.length-ze);if(st<10){for(Be=pe(Ie,Be,+(ze+st==We.length)),Be&7&&(Be+=8-(Be&7)),Ie.l=Be/8|0,Ie.write_shift(2,st),Ie.write_shift(2,~st&65535);st-- >0;)Ie[Ie.l++]=We[ze++];Be=Ie.l*8;continue}Be=pe(Ie,Be,+(ze+st==We.length)+2);for(var ft=0;st-- >0;){var at=We[ze];ft=(ft<<5^at)&32767;var dt=-1,Bt=0;if((dt=nt[ft])&&(dt|=ze&-32768,dt>ze&&(dt-=32768),dt<ze))for(;We[dt+Bt]==We[ze+Bt]&&Bt<250;)++Bt;if(Bt>2){at=xe[Bt],at<=22?Be=Le(Ie,Be,Q[at+1]>>1)-1:(Le(Ie,Be,3),Be+=5,Le(Ie,Be,Q[at-23]>>5),Be+=3);var dr=at<8?0:at-4>>2;dr>0&&(Pe(Ie,Be,Bt-R[at]),Be+=dr),at=ve[ze-dt],Be=Le(Ie,Be,Q[at]>>3),Be-=3;var br=at<4?0:at-2>>1;br>0&&(Pe(Ie,Be,ze-dt-H[at]),Be+=br);for(var gn=0;gn<Bt;++gn)nt[ft]=ze&32767,ft=(ft<<5^We[ze])&32767,++ze;st-=Bt-1}else at<=143?at=at+48:Be=Ae(Ie,Be,1),Be=Le(Ie,Be,Q[at]),nt[ft]=ze&32767,++ze}Be=Le(Ie,Be,0)-1}return Ie.l=(Be+7)/8|0,Ie.l}return function(Ie,Be){return Ie.length<8?ye(Ie,Be):De(Ie,Be)}})();function lt(se){var ve=Ge(50+Math.floor(se.length*1.1)),ue=pt(se,ve);return ve.slice(0,ue)}var rt=G?new Uint16Array(32768):Ve(32768),Zt=G?new Uint16Array(32768):Ve(32768),jt=G?new Uint16Array(128):Ve(128),Mr=1,$e=1;function Je(se,ve){var ue=Z(se,ve)+257;ve+=5;var fe=Z(se,ve)+1;ve+=5;var xe=he(se,ve)+4;ve+=4;for(var ye=0,De=G?new Uint8Array(19):Ve(19),We=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ie=1,Be=G?new Uint8Array(8):Ve(8),ze=G?new Uint8Array(8):Ve(8),nt=De.length,st=0;st<xe;++st)De[M[st]]=ye=we(se,ve),Ie<ye&&(Ie=ye),Be[ye]++,ve+=3;var ft=0;for(Be[0]=0,st=1;st<=Ie;++st)ze[st]=ft=ft+Be[st-1]<<1;for(st=0;st<nt;++st)(ft=De[st])!=0&&(We[st]=ze[ft]++);var at=0;for(st=0;st<nt;++st)if(at=De[st],at!=0){ft=Q[We[st]]>>8-at;for(var dt=(1<<7-at)-1;dt>=0;--dt)jt[ft|dt<<at]=at&7|st<<3}var Bt=[];for(Ie=1;Bt.length<ue+fe;)switch(ft=jt[Se(se,ve)],ve+=ft&7,ft>>>=3){case 16:for(ye=3+Ee(se,ve),ve+=2,ft=Bt[Bt.length-1];ye-- >0;)Bt.push(ft);break;case 17:for(ye=3+we(se,ve),ve+=3;ye-- >0;)Bt.push(0);break;case 18:for(ye=11+Se(se,ve),ve+=7;ye-- >0;)Bt.push(0);break;default:Bt.push(ft),Ie<ft&&(Ie=ft);break}var dr=Bt.slice(0,ue),br=Bt.slice(ue);for(st=ue;st<286;++st)dr[st]=0;for(st=fe;st<30;++st)br[st]=0;return Mr=et(dr,rt,286),$e=et(br,Zt,30),ve}function Pt(se,ve){if(se[0]==3&&!(se[1]&3))return[Go(ve),2];for(var ue=0,fe=0,xe=N5(ve||1<<18),ye=0,De=xe.length>>>0,We=0,Ie=0;(fe&1)==0;){if(fe=we(se,ue),ue+=3,fe>>>1)fe>>1==1?(We=9,Ie=5):(ue=Je(se,ue),We=Mr,Ie=$e);else{ue&7&&(ue+=8-(ue&7));var Be=se[ue>>>3]|se[(ue>>>3)+1]<<8;if(ue+=32,Be>0)for(!ve&&De<ye+Be&&(xe=Oe(xe,ye+Be),De=xe.length);Be-- >0;)xe[ye++]=se[ue>>>3],ue+=8;continue}for(;;){!ve&&De<ye+32767&&(xe=Oe(xe,ye+32767),De=xe.length);var ze=ge(se,ue,We),nt=fe>>>1==1?_t[ze]:rt[ze];if(ue+=nt&15,nt>>>=4,(nt>>>8&255)===0)xe[ye++]=nt;else{if(nt==256)break;nt-=257;var st=nt<8?0:nt-4>>2;st>5&&(st=0);var ft=ye+R[nt];st>0&&(ft+=ge(se,ue,st),ue+=st),ze=ge(se,ue,Ie),nt=fe>>>1==1?Tt[ze]:Zt[ze],ue+=nt&15,nt>>>=4;var at=nt<4?0:nt-2>>1,dt=H[nt];for(at>0&&(dt+=ge(se,ue,at),ue+=at),!ve&&De<ft&&(xe=Oe(xe,ft+100),De=xe.length);ye<ft;)xe[ye]=xe[ye-dt],++ye}}}return ve?[xe,ue+7>>>3]:[xe.slice(0,ye),ue+7>>>3]}function gt(se,ve){var ue=se.slice(se.l||0),fe=Pt(ue,ve);return se.l+=fe[1],fe[0]}function Ot(se,ve){if(se)typeof console<"u"&&console.error(ve);else throw new Error(ve)}function yt(se,ve){var ue=se;ia(ue,0);var fe=[],xe=[],ye={FileIndex:fe,FullPaths:xe};I(ye,{root:ve.root});for(var De=ue.length-4;(ue[De]!=80||ue[De+1]!=75||ue[De+2]!=5||ue[De+3]!=6)&&De>=0;)--De;ue.l=De+4,ue.l+=4;var We=ue.read_shift(2);ue.l+=6;var Ie=ue.read_shift(4);for(ue.l=Ie,De=0;De<We;++De){ue.l+=20;var Be=ue.read_shift(4),ze=ue.read_shift(4),nt=ue.read_shift(2),st=ue.read_shift(2),ft=ue.read_shift(2);ue.l+=8;var at=ue.read_shift(4),dt=o(ue.slice(ue.l+nt,ue.l+nt+st));ue.l+=nt+st+ft;var Bt=ue.l;ue.l=at+4,tr(ue,Be,ze,ye,dt),ue.l=Bt}return ye}function tr(se,ve,ue,fe,xe){se.l+=2;var ye=se.read_shift(2),De=se.read_shift(2),We=i(se);if(ye&8257)throw new Error("Unsupported ZIP encryption");for(var Ie=se.read_shift(4),Be=se.read_shift(4),ze=se.read_shift(4),nt=se.read_shift(2),st=se.read_shift(2),ft="",at=0;at<nt;++at)ft+=String.fromCharCode(se[se.l++]);if(st){var dt=o(se.slice(se.l,se.l+st));(dt[21589]||{}).mt&&(We=dt[21589].mt),((xe||{})[21589]||{}).mt&&(We=xe[21589].mt)}se.l+=st;var Bt=se.slice(se.l,se.l+Be);switch(De){case 8:Bt=D(se,ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var dr=!1;ye&8&&(Ie=se.read_shift(4),Ie==134695760&&(Ie=se.read_shift(4),dr=!0),Be=se.read_shift(4),ze=se.read_shift(4)),Be!=ve&&Ot(dr,"Bad compressed size: "+ve+" != "+Be),ze!=ue&&Ot(dr,"Bad uncompressed size: "+ue+" != "+ze),En(fe,ft,Bt,{unsafe:!0,mt:We})}function fr(se,ve){var ue=ve||{},fe=[],xe=[],ye=Ge(1),De=ue.compression?8:0,We=0,Ie=0,Be=0,ze=0,nt=0,st=se.FullPaths[0],ft=st,at=se.FileIndex[0],dt=[],Bt=0;for(Ie=1;Ie<se.FullPaths.length;++Ie)if(ft=se.FullPaths[Ie].slice(st.length),at=se.FileIndex[Ie],!(!at.size||!at.content||ft=="Sh33tJ5")){var dr=ze,br=Ge(ft.length);for(Be=0;Be<ft.length;++Be)br.write_shift(1,ft.charCodeAt(Be)&127);br=br.slice(0,br.l),dt[nt]=E7.buf(at.content,0);var gn=at.content;De==8&&(gn=L(gn)),ye=Ge(30),ye.write_shift(4,67324752),ye.write_shift(2,20),ye.write_shift(2,We),ye.write_shift(2,De),at.mt?s(ye,at.mt):ye.write_shift(4,0),ye.write_shift(-4,dt[nt]),ye.write_shift(4,gn.length),ye.write_shift(4,at.content.length),ye.write_shift(2,br.length),ye.write_shift(2,0),ze+=ye.length,fe.push(ye),ze+=br.length,fe.push(br),ze+=gn.length,fe.push(gn),ye=Ge(46),ye.write_shift(4,33639248),ye.write_shift(2,0),ye.write_shift(2,20),ye.write_shift(2,We),ye.write_shift(2,De),ye.write_shift(4,0),ye.write_shift(-4,dt[nt]),ye.write_shift(4,gn.length),ye.write_shift(4,at.content.length),ye.write_shift(2,br.length),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(4,0),ye.write_shift(4,dr),Bt+=ye.l,xe.push(ye),Bt+=br.length,xe.push(br),++nt}return ye=Ge(22),ye.write_shift(4,101010256),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,nt),ye.write_shift(2,nt),ye.write_shift(4,Bt),ye.write_shift(4,ze),ye.write_shift(2,0),Xn([Xn(fe),Xn(xe),ye])}var Vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function It(se,ve){if(se.ctype)return se.ctype;var ue=se.name||"",fe=ue.match(/\.([^\.]+)$/);return fe&&Vt[fe[1]]||ve&&(fe=(ue=ve).match(/[\.\\]([^\.\\])+$/),fe&&Vt[fe[1]])?Vt[fe[1]]:"application/octet-stream"}function Xt(se){for(var ve=$d(se),ue=[],fe=0;fe<ve.length;fe+=76)ue.push(ve.slice(fe,fe+76));return ue.join(`\r
`)+`\r
`}function rr(se){var ve=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Be){var ze=Be.charCodeAt(0).toString(16).toUpperCase();return"="+(ze.length==1?"0"+ze:ze)});ve=ve.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ve.charAt(0)==`
`&&(ve="=0D"+ve.slice(1)),ve=ve.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],fe=ve.split(`\r
`),xe=0;xe<fe.length;++xe){var ye=fe[xe];if(ye.length==0){ue.push("");continue}for(var De=0;De<ye.length;){var We=76,Ie=ye.slice(De,De+We);Ie.charAt(We-1)=="="?We--:Ie.charAt(We-2)=="="?We-=2:Ie.charAt(We-3)=="="&&(We-=3),Ie=ye.slice(De,De+We),De+=We,De<ye.length&&(Ie+="="),ue.push(Ie)}}return ue.join(`\r
`)}function nr(se){for(var ve=[],ue=0;ue<se.length;++ue){for(var fe=se[ue];ue<=se.length&&fe.charAt(fe.length-1)=="=";)fe=fe.slice(0,fe.length-1)+se[++ue];ve.push(fe)}for(var xe=0;xe<ve.length;++xe)ve[xe]=ve[xe].replace(/[=][0-9A-Fa-f]{2}/g,function(ye){return String.fromCharCode(parseInt(ye.slice(1),16))});return as(ve.join(`\r
`))}function Cn(se,ve,ue){for(var fe="",xe="",ye="",De,We=0;We<10;++We){var Ie=ve[We];if(!Ie||Ie.match(/^\s*$/))break;var Be=Ie.match(/^(.*?):\s*([^\s].*)$/);if(Be)switch(Be[1].toLowerCase()){case"content-location":fe=Be[2].trim();break;case"content-type":ye=Be[2].trim();break;case"content-transfer-encoding":xe=Be[2].trim();break}}switch(++We,xe.toLowerCase()){case"base64":De=as(us(ve.slice(We).join("")));break;case"quoted-printable":De=nr(ve.slice(We));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xe)}var ze=En(se,fe.slice(ue.length),De,{unsafe:!0});ye&&(ze.ctype=ye)}function Ma(se,ve){if(z(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=ve&&ve.root||"",fe=(Yt&&Buffer.isBuffer(se)?se.toString("binary"):z(se)).split(`\r
`),xe=0,ye="";for(xe=0;xe<fe.length;++xe)if(ye=fe[xe],!!/^Content-Location:/i.test(ye)&&(ye=ye.slice(ye.indexOf("file")),ue||(ue=ye.slice(0,ye.lastIndexOf("/")+1)),ye.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),ye.slice(0,ue.length)!=ue););var De=(fe[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var We="--"+(De[1]||""),Ie=[],Be=[],ze={FileIndex:Ie,FullPaths:Be};I(ze);var nt,st=0;for(xe=0;xe<fe.length;++xe){var ft=fe[xe];ft!==We&&ft!==We+"--"||(st++&&Cn(ze,fe.slice(nt,xe),ue),nt=xe)}return ze}function xt(se,ve){var ue=ve||{},fe=ue.boundary||"SheetJS";fe="------="+fe;for(var xe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+fe.slice(2)+'"',"","",""],ye=se.FullPaths[0],De=ye,We=se.FileIndex[0],Ie=1;Ie<se.FullPaths.length;++Ie)if(De=se.FullPaths[Ie].slice(ye.length),We=se.FileIndex[Ie],!(!We.size||!We.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Bt){return"_x"+Bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Bt){return"_u"+Bt.charCodeAt(0).toString(16)+"_"});for(var Be=We.content,ze=Yt&&Buffer.isBuffer(Be)?Be.toString("binary"):z(Be),nt=0,st=Math.min(1024,ze.length),ft=0,at=0;at<=st;++at)(ft=ze.charCodeAt(at))>=32&&ft<128&&++nt;var dt=nt>=st*4/5;xe.push(fe),xe.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+De),xe.push("Content-Transfer-Encoding: "+(dt?"quoted-printable":"base64")),xe.push("Content-Type: "+It(We,De)),xe.push(""),xe.push(dt?rr(ze):Xt(ze))}return xe.push(fe+`--\r
`),xe.join(`\r
`)}function Un(se){var ve={};return I(ve,se),ve}function En(se,ve,ue,fe){var xe=fe&&fe.unsafe;xe||I(se);var ye=!xe&&Ct.find(se,ve);if(!ye){var De=se.FullPaths[0];ve.slice(0,De.length)==De?De=ve:(De.slice(-1)!="/"&&(De+="/"),De=(De+ve).replace("//","/")),ye={name:a(ve),type:2},se.FileIndex.push(ye),se.FullPaths.push(De),xe||Ct.utils.cfb_gc(se)}return ye.content=ue,ye.size=ue?ue.length:0,fe&&(fe.CLSID&&(ye.clsid=fe.CLSID),fe.mt&&(ye.mt=fe.mt),fe.ct&&(ye.ct=fe.ct)),ye}function zn(se,ve){I(se);var ue=Ct.find(se,ve);if(ue){for(var fe=0;fe<se.FileIndex.length;++fe)if(se.FileIndex[fe]==ue)return se.FileIndex.splice(fe,1),se.FullPaths.splice(fe,1),!0}return!1}function Rr(se,ve,ue){I(se);var fe=Ct.find(se,ve);if(fe){for(var xe=0;xe<se.FileIndex.length;++xe)if(se.FileIndex[xe]==fe)return se.FileIndex[xe].name=a(ue),se.FullPaths[xe]=ue,!0}return!1}function Kr(se){T(se,!0)}return t.find=F,t.read=N,t.parse=d,t.write=ne,t.writeFile=Y,t.utils={cfb_new:Un,cfb_add:En,cfb_del:zn,cfb_mov:Rr,cfb_gc:Kr,ReadShift:Td,CheckField:Zj,prep_blob:ia,bconcat:Xn,use_zlib:A,_deflateRaw:lt,_inflateRaw:gt,consts:ee},t})();function T7(e){return typeof e=="string"?Qm(e):Array.isArray(e)?r7(e):e}function bf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Qm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?bi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([T7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=nl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function P7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function an(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function O5(e,t){for(var r=[],n=an(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function tp(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function rp(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function O7(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var qh=new Date(1899,11,30,0,0,0);function In(e,t){var r=e.getTime(),n=qh.getTime()+(e.getTimezoneOffset()-qh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var Pj=new Date,F7=qh.getTime()+(Pj.getTimezoneOffset()-qh.getTimezoneOffset())*6e4,F5=Pj.getTimezoneOffset();function np(e){var t=new Date;return t.setTime(e*24*60*60*1e3+F7),t.getTimezoneOffset()!==F5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-F5)*6e4),t}function I7(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var I5=new Date("2017-02-19T19:06:09.000Z"),Oj=isNaN(I5.getFullYear())?new Date("2/19/17"):I5,L7=Oj.getFullYear()==2017;function Lr(e,t){var r=new Date(e);if(L7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Oj.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ul(e,t){if(Yt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return bi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return bi(yj(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return bi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return bi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dr(e[r]));return t}function en(e,t){for(var r="";r.length<t;)r+=e;return r}function Qs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var D7=["january","february","march","april","may","june","july","august","september","october","november","december"];function lu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&D7.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var M7=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}})();function Fj(e){return e?e.content&&e.type?Ul(e.content,!0):e.data?Nd(e.data):e.asNodeBuffer&&Yt?Nd(e.asNodeBuffer().toString("binary")):e.asBinary?Nd(e.asBinary()):e._data&&e._data.getContent?Nd(Ul(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ij(e){if(!e)return null;if(e.data)return S5(e.data);if(e.asNodeBuffer&&Yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?S5(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function R7(e){return e&&e.name.slice(-4)===".bin"?Ij(e):Fj(e)}function Cs(e,t){for(var r=e.FullPaths||an(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Xy(e,t){var r=Cs(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function wn(e,t,r){if(!r)return R7(Xy(e,t));if(!t)return null;try{return wn(e,t)}catch{return null}}function ss(e,t,r){if(!r)return Fj(Xy(e,t));if(!t)return null;try{return ss(e,t)}catch{return null}}function B7(e,t,r){return Ij(Xy(e,t))}function L5(e){for(var t=e.FullPaths||an(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Gt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Yt?n=uo(r):n=n7(r),Ct.utils.cfb_add(e,t,n)}Ct.utils.cfb_add(e,t,r)}else e.file(t,r)}function Jy(){return Ct.utils.cfb_new()}function Lj(e,t){switch(t.type){case"base64":return Ct.read(e,{type:"base64"});case"binary":return Ct.read(e,{type:"binary"});case"buffer":case"array":return Ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,U7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,D5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,z7=/<[^>]*>/g,Aa=pn.match(D5)?D5:z7,$7=/<\w*:/,W7=/<(\/?)\w+:/;function Rt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(U7),o=0,c="",u=0,d="",f="",m=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(m=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+m,f.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[h]&&d.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Ci(e){return e.replace(W7,"<$1")}var Dj={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Zy=tp(Dj),sr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,c){return Dj[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}})(),Qy=/[&<>'"]/g,H7=/[\u0000-\u0008\u000b-\u001f]/g;function vr(e){var t=e+"";return t.replace(Qy,function(r){return Zy[r]}).replace(H7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function M5(e){return vr(e).replace(/ /g,"_x0020_")}var Mj=/[\u0000-\u001f]/g;function e2(e){var t=e+"";return t.replace(Qy,function(r){return Zy[r]}).replace(/\n/g,"<br/>").replace(Mj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function q7(e){var t=e+"";return t.replace(Qy,function(r){return Zy[r]}).replace(Mj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var R5=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function G7(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Fr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gg(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function B5(e){var t=Go(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function U5(e){return uo(e,"binary").toString("utf8")}var Y0="foo bar bazâð£",_r=Yt&&(U5(Y0)==Gg(Y0)&&U5||B5(Y0)==Gg(Y0)&&B5)||Gg,bi=Yt?function(e){return uo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Hd=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),Rj=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),V7=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Y7=/<\/?(?:vt:)?variant>/g,K7=/<(?:vt:)([^>]*)>([\s\S]*)</;function z5(e,t){var r=Rt(e),n=e.match(V7(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(Y7,"").match(K7);i&&a.push({v:_r(i[2]),t:i[1]})}),a}var Bj=/(^\s|\s$|\n)/;function oa(e,t){return"<"+e+(t.match(Bj)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function qd(e){return an(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function it(e,t,r){return"<"+e+(r!=null?qd(r):"")+(t!=null?(t.match(Bj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function iv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function X7(e,t){switch(typeof e){case"string":var r=it("vt:lpwstr",vr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return it((e|0)==e?"vt:i4":"vt:r8",vr(String(e)));case"boolean":return it("vt:bool",e?"true":"false")}if(e instanceof Date)return it("vt:filetime",iv(e));throw new Error("Unable to serialize "+e)}function t2(e){if(Yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return _r(nl(Vy(e)));throw new Error("Bad input format: expected Buffer or string")}var Gd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,On={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function J7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Z7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var $5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},W5=Yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:uo(t)})):$5(e)}:$5,H5=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(qi(e,a)));return n.join("").replace(Ia,"")},r2=Yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ia,""):H5(e,t,r)}:H5,q5=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Uj=Yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):q5(e,t,r)}:q5,G5=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Wc(e,a)));return n.join("")},wf=Yt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):G5(t,r,n)}:G5,zj=function(e,t){var r=ns(e,t);return r>0?wf(e,t+4,t+4+r-1):""},$j=zj,Wj=function(e,t){var r=ns(e,t);return r>0?wf(e,t+4,t+4+r-1):""},Hj=Wj,qj=function(e,t){var r=2*ns(e,t);return r>0?wf(e,t+4,t+4+r-1):""},Gj=qj,Vj=function(t,r){var n=ns(t,r);return n>0?r2(t,r+4,r+4+n):""},Yj=Vj,Kj=function(e,t){var r=ns(e,t);return r>0?wf(e,t+4,t+4+r):""},Xj=Kj,Jj=function(e,t){return J7(e,t)},Gh=Jj,n2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Yt&&($j=function(t,r){if(!Buffer.isBuffer(t))return zj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Hj=function(t,r){if(!Buffer.isBuffer(t))return Wj(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Gj=function(t,r){if(!Buffer.isBuffer(t))return qj(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Yj=function(t,r){if(!Buffer.isBuffer(t))return Vj(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Xj=function(t,r){if(!Buffer.isBuffer(t))return Kj(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Gh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Jj(t,r)},n2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wc=function(e,t){return e[t]},qi=function(e,t){return e[t+1]*256+e[t]},Q7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ns=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_l=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Td(e,t){var r="",n,a,s=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(qi(this,u)),u+=2;e*=2;break;case"utf8":r=wf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=r2(this,this.l,this.l+e);break;case"wstr":return Td.call(this,e,"dbcs");case"lpstr-ansi":r=$j(this,this.l),e=4+ns(this,this.l);break;case"lpstr-cp":r=Hj(this,this.l),e=4+ns(this,this.l);break;case"lpwstr":r=Gj(this,this.l),e=4+2*ns(this,this.l);break;case"lpp4":e=4+ns(this,this.l),r=Yj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ns(this,this.l),r=Xj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Wc(this,this.l+e++))!==0;)s.push(V0(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=qi(this,this.l+e))!==0;)s.push(V0(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Wc(this,u),this.l=u+1,o=Td.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(V0(qi(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Wc(this,u),this.l=u+1,o=Td.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(V0(Wc(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Wc(this,this.l),this.l++,n;case 2:return n=(t==="i"?Q7:qi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?_l:eI)(this,this.l),this.l+=4,n):(a=ns(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Gh(this,this.l):a=Gh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Uj(this,this.l,e);break}}return this.l+=e,r}var tI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},rI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function aI(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)nI(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,tI(this,t,this.l);break;case 8:if(n=8,r==="f"){Z7(this,t,this.l);break}case 16:break;case-4:n=4,rI(this,t,this.l);break}return this.l+=n,this}function Zj(e,t){var r=Uj(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ia(e,t){e.l=t,e.read_shift=Td,e.chk=Zj,e.write_shift=aI}function Na(e,t){e.l+=t}function Ge(e){var t=Go(e);return ia(t,0),t}function fo(e,t,r){if(e){var n,a,s;ia(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Zd[o]||Zd[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,o))return}}}function qa(){var e=[],t=Yt?256:2048,r=function(u){var d=Ge(u);return ia(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),Xn(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function Ze(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Zd[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&n2(r)&&e.push(r)}}function Pd(e,t,r){var n=Dr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function V5(e,t,r){var n=Dr(e);return n.s=Pd(n.s,t.s,r),n.e=Pd(n.e,t.s,r),n}function Od(e,t){if(e.cRel&&e.c<0)for(e=Dr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Mt(e);return!e.cRel&&e.cRel!=null&&(r=oI(r)),!e.rRel&&e.rRel!=null&&(r=sI(r)),r}function Vg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+qr(e.s.c)+":"+(e.e.cRel?"":"$")+qr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+mn(e.s.r)+":"+(e.e.rRel?"":"$")+mn(e.e.r):Od(e.s,t.biff)+":"+Od(e.e,t.biff)}function a2(e){return parseInt(iI(e),10)-1}function mn(e){return""+(e+1)}function sI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iI(e){return e.replace(/\$(\d+)$/,"$1")}function s2(e){for(var t=lI(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function qr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oI(e){return e.replace(/^([A-Z])/,"$$$1")}function lI(e){return e.replace(/^\$([A-Z])/,"$1")}function cI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ga(e){var t=e.indexOf(":");return t==-1?{s:Gr(e),e:Gr(e)}:{s:Gr(e.slice(0,t)),e:Gr(e.slice(t+1))}}function qt(e,t){return typeof t>"u"||typeof t=="number"?qt(e.s,e.e):(typeof e!="string"&&(e=Mt(e)),typeof t!="string"&&(t=Mt(t)),e==t?e:e+":"+t)}function ir(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Y5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Os(e.z,r?In(t):t)}catch{}try{return e.w=Os((e.XF||{}).numFmtId||(r?14:0),r?In(t):t)}catch{return""+t}}function eo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ho[e.v]||e.v:t==null?Y5(e,e.v):Y5(e,t))}function al(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Qj(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gr(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=ir(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var h={v:t[f][m]},p=i+f,g=o+m;if(u.s.r>p&&(u.s.r=p),u.s.c>g&&(u.s.c=g),u.e.r<p&&(u.e.r=p),u.e.c<g&&(u.e.c=g),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))h=t[f][m];else if(Array.isArray(h.v)&&(h.f=t[f][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Lt[14],n.cellDates?(h.t="d",h.w=Os(h.z,In(h.v))):(h.t="n",h.v=In(h.v),h.w=Os(h.z,h.v))):h.t="s";if(a)s[p]||(s[p]=[]),s[p][g]&&s[p][g].z&&(h.z=s[p][g].z),s[p][g]=h;else{var v=Mt({c:g,r:p});s[v]&&s[v].z&&(h.z=s[v].z),s[v]=h}}}return u.s.c<1e7&&(s["!ref"]=qt(u)),s}function wu(e,t){return Qj(null,e,t)}function uI(e){return e.read_shift(4,"i")}function ei(e,t){return t||(t=Ge(4)),t.write_shift(4,e),t}function Sa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Jn(e,t){var r=!1;return t==null&&(r=!0,t=Ge(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function fI(e,t){return t||(t=Ge(4)),t.write_shift(2,0),t.write_shift(2,0),t}function i2(e,t){var r=e.l,n=e.read_shift(1),a=Sa(e),s=[],i={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(dI(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function hI(e,t){var r=!1;return t==null&&(r=!0,t=Ge(15+4*e.t.length)),t.write_shift(1,0),Jn(e.t,t),r?t.slice(0,t.l):t}var mI=i2;function pI(e,t){var r=!1;return t==null&&(r=!0,t=Ge(23+4*e.t.length)),t.write_shift(1,1),Jn(e.t,t),t.write_shift(4,1),fI({},t),r?t.slice(0,t.l):t}function Ls(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function rc(e,t){return t==null&&(t=Ge(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function nc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ac(e,t){return t==null&&(t=Ge(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gI=Sa,ek=Jn;function o2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Vh(e,t){var r=!1;return t==null&&(r=!0,t=Ge(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var xI=Sa,ov=o2,l2=Vh;function c2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Gh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_l(t,0)>>2;return r?a/100:a}function tk(e,t){t==null&&(t=Ge(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function rk(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function vI(e,t){return t||(t=Ge(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var sc=rk,Su=vI;function ba(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function zl(e,t){return(t||Ge(8)).write_shift(8,e,"f")}function yI(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Pl[a];u&&(t.rgb=Yd(u));break;case 2:t.rgb=Yd([i,o,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Yh(e,t){if(t||(t=Ge(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function bI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function wI(e,t){t||(t=Ge(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function nk(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function SI(e){return nk(e,1)}function _I(e){return nk(e,2)}var u2=2,Wa=3,K0=11,K5=12,Kh=19,X0=64,NI=65,AI=71,jI=4108,kI=4126,Vn=80,ak=81,CI=[Vn,ak],lv={1:{n:"CodePage",t:u2},2:{n:"Category",t:Vn},3:{n:"PresentationFormat",t:Vn},4:{n:"ByteCount",t:Wa},5:{n:"LineCount",t:Wa},6:{n:"ParagraphCount",t:Wa},7:{n:"SlideCount",t:Wa},8:{n:"NoteCount",t:Wa},9:{n:"HiddenCount",t:Wa},10:{n:"MultimediaClipCount",t:Wa},11:{n:"ScaleCrop",t:K0},12:{n:"HeadingPairs",t:jI},13:{n:"TitlesOfParts",t:kI},14:{n:"Manager",t:Vn},15:{n:"Company",t:Vn},16:{n:"LinksUpToDate",t:K0},17:{n:"CharacterCount",t:Wa},19:{n:"SharedDoc",t:K0},22:{n:"HyperlinksChanged",t:K0},23:{n:"AppVersion",t:Wa,p:"version"},24:{n:"DigSig",t:NI},26:{n:"ContentType",t:Vn},27:{n:"ContentStatus",t:Vn},28:{n:"Language",t:Vn},29:{n:"Version",t:Vn},255:{},2147483648:{n:"Locale",t:Kh},2147483651:{n:"Behavior",t:Kh},1919054434:{}},cv={1:{n:"CodePage",t:u2},2:{n:"Title",t:Vn},3:{n:"Subject",t:Vn},4:{n:"Author",t:Vn},5:{n:"Keywords",t:Vn},6:{n:"Comments",t:Vn},7:{n:"Template",t:Vn},8:{n:"LastAuthor",t:Vn},9:{n:"RevNumber",t:Vn},10:{n:"EditTime",t:X0},11:{n:"LastPrinted",t:X0},12:{n:"CreatedDate",t:X0},13:{n:"ModifiedDate",t:X0},14:{n:"PageCount",t:Wa},15:{n:"WordCount",t:Wa},16:{n:"CharCount",t:Wa},17:{n:"Thumbnail",t:AI},18:{n:"Application",t:Vn},19:{n:"DocSecurity",t:Wa},255:{},2147483648:{n:"Locale",t:Kh},2147483651:{n:"Behavior",t:Kh},1919054434:{}},X5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var PI=TI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pl=Dr(PI),ho={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},J0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function d2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OI(e){var t=d2();if(!e||!e.match)return t;var r={};if((e.match(Aa)||[]).forEach(function(n){var a=Rt(n);switch(a[0].replace($7,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[uv[a.ContentType]]!==void 0&&t[uv[a.ContentType]].push(a.PartName);break}}),t.xmlns!==On.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function ik(e,t){var r=O7(uv),n=[],a;n[n.length]=pn,n[n.length]=it("Types",null,{xmlns:On.CT,"xmlns:xsd":On.xsd,"xmlns:xsi":On.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return it("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=it("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:J0[c][t.bookType]||J0[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=it("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:J0[c][t.bookType]||J0[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=it("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Fd(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Aa)||[]).forEach(function(a){var s=Rt(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:jd(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function Zc(e){var t=[pn,it("Relationships",null,{xmlns:On.RELS})];return an(e["!id"]).forEach(function(r){t[t.length]=it("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function gr(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Kt.HLINK,Kt.XPATH,Kt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var FI="application/vnd.oasis.opendocument.spreadsheet";function II(e,t){for(var r=t2(e),n,a;n=Gd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Rt(n[0],!1),a.path=="/"&&a.type!==FI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function LI(e){var t=[pn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function J5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function DI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MI(e){var t=[pn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(J5(e[r][0],e[r][1])),t.push(DI("",e[r][0]));return t.push(J5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ok(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zh.version+"</meta:generator></office:meta></office:document-meta>"}var Ps=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RI=(function(){for(var e=new Array(Ps.length),t=0;t<Ps.length;++t){var r=Ps[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function lk(e){var t={};e=_r(e);for(var r=0;r<Ps.length;++r){var n=Ps[r],a=e.match(RI[r]);a!=null&&a.length>0&&(t[n[1]]=sr(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Lr(t[n[1]]))}return t}function Yg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=vr(t),n[n.length]=r?it(e,t,r):oa(e,t))}function ck(e,t){var r=t||{},n=[pn,it("cp:coreProperties",null,{"xmlns:cp":On.CORE_PROPS,"xmlns:dc":On.dc,"xmlns:dcterms":On.dcterms,"xmlns:dcmitype":On.dcmitype,"xmlns:xsi":On.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Yg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:iv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Yg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:iv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ps.length;++s){var i=Ps[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Yg(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ol=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dk(e,t,r,n){var a=[];if(typeof e=="string")a=z5(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var i=typeof t=="string"?z5(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function BI(e,t,r){var n={};return t||(t={}),e=_r(e),Ol.forEach(function(a){var s=(e.match(Hd(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=sr(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&dk(n.HeadingPairs,n.TitlesOfParts,t,r),t}function fk(e){var t=[],r=it;return e||(e={}),e.Application="SheetJS",t[t.length]=pn,t[t.length]=it("Properties",null,{xmlns:On.EXT_PROPS,"xmlns:vt":On.vt}),Ol.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=vr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+vr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var UI=/<[^>]+>[^<]*/g;function zI(e,t){var r={},n="",a=e.match(UI);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Rt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=sr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=sr(d);break;case"bool":r[n]=Fr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Lr(d);break;case"cy":case"error":r[n]=sr(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function hk(e){var t=[pn,it("Properties",null,{xmlns:On.CUST_PROPS,"xmlns:vt":On.vt})];if(!e)return t.join("");var r=1;return an(e).forEach(function(a){++r,t[t.length]=it("property",X7(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:vr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Kg;function $I(e,t,r){Kg||(Kg=tp(dv)),t=Kg[t]||t,e[t]=r}function WI(e,t){var r=[];return an(dv).map(function(n){for(var a=0;a<Ps.length;++a)if(Ps[a][1]==n)return Ps[a];for(a=0;a<Ol.length;++a)if(Ol[a][1]==n)return Ol[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(oa(dv[n[1]]||n[1],a))}}),it("DocumentProperties",r.join(""),{xmlns:rs.o})}function HI(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&an(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Ps.length;++i)if(s==Ps[i][1])return;for(i=0;i<Ol.length;++i)if(s==Ol[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(it(M5(s),o,{"dt:dt":c}))}}),t&&an(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(it(M5(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+rs.o+'">'+a.join("")+"</"+n+">"}function f2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=Ge(8);return i.write_shift(4,n),i.write_shift(4,a),i}function mk(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function pk(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function gk(e,t,r){return t===31?pk(e):mk(e,t,r)}function fv(e,t,r){return gk(e,t,r===!1?0:4)}function GI(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return gk(e,t,0)}function VI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ia,""),e.l-a&2&&(e.l+=2)}return r}function YI(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ia,"");return r}function KI(e){var t=e.l,r=Xh(e,ak);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Xh(e,Wa);return[r,n]}function XI(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(KI(e));return r}function Z5(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Ia,"").replace(Ad,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function xk(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Xh(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==K5&&n!==t&&CI.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===K5?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return mk(e,n,4).replace(Ia,"");case 31:return pk(e);case 64:return f2(e);case 65:return xk(e);case 71:return JI(e);case 80:return fv(e,n,!s.raw).replace(Ia,"");case 81:return GI(e,n).replace(Ia,"");case 4108:return XI(e);case 4126:case 4127:return n==4127?VI(e):YI(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Q5(e,t){var r=Ge(4),n=Ge(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ge(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=qI(t);break;case 31:case 80:for(n=Ge(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xn([r,n])}function eS(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,c=-1,u={};for(i=0;i!=a;++i){var d=e.read_shift(4),f=e.read_shift(4);s[i]=[d,f+r]}s.sort(function(S,_){return S[1]-_[1]});var m={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(m[p.n]=Xh(e,p.t,{raw:!0}),p.p==="version"&&(m[p.n]=String(m[p.n]>>16)+"."+("0000"+String(m[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(m[p.n]){case 0:m[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Js(o=m[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[p.n])}}else if(s[i][0]===1){if(o=m.CodePage=Xh(e,u2),Js(o),c!==-1){var g=e.l;e.l=s[c][1],u=Z5(e,o),e.l=g}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}u=Z5(e,o)}else{var v=u[s[i][0]],b;switch(e[e.l]){case 65:e.l+=4,b=xk(e);break;case 30:e.l+=4,b=fv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=fv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=cn(e,4);break;case 64:e.l+=4,b=Lr(f2(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[v]=b}}return e.l=r+n,m}var vk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZI(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function tS(e,t,r){var n=Ge(8),a=[],s=[],i=8,o=0,c=Ge(8),u=Ge(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),i+=8+c.length,!t){u=Ge(8),u.write_shift(4,0),a.unshift(u);var d=[Ge(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=Ge(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Xn(d),s.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(vk.indexOf(e[o][0])>-1||uk.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],h=0;if(t){h=+t[e[o][0]];var p=r[h];if(p.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}c=Q5(p.t,m)}else{var v=ZI(m);v==-1&&(v=31,m=String(m)),c=Q5(v,m)}s.push(c),u=Ge(8),u.write_shift(4,t?h:2+o),a.push(u),i+=8+c.length}var b=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,b),b+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),Xn([n].concat(a).concat(s))}function rS(e,t,r){var n=e.content;if(!n)return{};ia(n,0);var a,s,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Ct.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=eS(n,t),m={SystemIdentifier:u};for(var h in f)m[h]=f[h];if(m.FMTID=s,a===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=eS(n,null)}catch{}for(h in p)m[h]=p[h];return m.FMTID=[s,i],m}function nS(e,t,r,n,a,s){var i=Ge(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ct.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var c=tS(e,r,n);if(o.push(c),a){var u=tS(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Xn(o)}function Lo(e,t){return e.read_shift(t),null}function QI(e,t){t||(t=Ge(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function eL(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function cn(e,t){return e.read_shift(t)===1}function Pa(e,t){return t||(t=Ge(2)),t.write_shift(2,+!!e),t}function Sn(e){return e.read_shift(2,"u")}function Es(e,t){return t||(t=Ge(2)),t.write_shift(2,e),t}function yk(e,t){return eL(e,t,Sn)}function tL(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bk(e,t,r){return r||(r=Ge(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Sf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function rL(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,c={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*i),n&&(e.l+=o),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function nL(e){var t=e.t||"",r=Ge(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ge(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Xn(a)}function $l(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function _f(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):$l(e,n,r)}function ic(e,t,r){if(r.biff>5)return _f(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function wk(e,t,r){return r||(r=Ge(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function aL(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sL(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ia,"");return n&&(e.l+=24),a}function iL(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Ia,"");return r+i}function oL(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sL(e);case"0303000000000000c000000000000046":return iL(e);default:throw new Error("Unsupported Moniker "+r)}}function Z0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ia,""):"";return r}function aS(e,t){t||(t=Ge(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function lL(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,c,u="",d,f;a&16&&(s=Z0(e,r-e.l)),a&128&&(i=Z0(e,r-e.l)),(a&257)===257&&(o=Z0(e,r-e.l)),(a&257)===1&&(c=oL(e,r-e.l)),a&8&&(u=Z0(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=f2(e)),e.l=r;var m=i||o||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function cL(e){var t=Ge(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),aS(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&aS(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Sk(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function _k(e,t){var r=Sk(e);return r[3]=0,r}function Ei(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Wl(e,t,r,n){return n||(n=Ge(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function uL(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dL(e,t,r){return t===0?"":ic(e,t,r)}function fL(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Nk(e){var t=e.read_shift(2),r=c2(e);return[t,r]}function hL(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Sf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ap(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Ak(e,t){return t||(t=Ge(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function jk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var mL=jk;function kk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function pL(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gL(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ua(e){e.l+=2,e.l+=e.read_shift(2)}var xL={0:ua,4:ua,5:ua,6:ua,7:gL,8:ua,9:ua,10:ua,11:ua,12:ua,13:pL,14:ua,15:ua,16:ua,17:ua,18:ua,19:ua,20:ua,21:kk};function vL(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(xL[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Q0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function h2(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ge(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function yL(e,t){return t===0||e.read_shift(2),1200}function bL(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ic(e,0,r);return e.read_shift(t+n-e.l),a}function wL(e,t){var r=!t||t.biff==8,n=Ge(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function SL(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function _L(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Sf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function NL(e,t){var r=!t||t.biff>=8?2:1,n=Ge(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function AL(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(rL(e));return s.Count=n,s.Unique=a,s}function jL(e,t){var r=Ge(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=nL(e[a]);var s=Xn([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function kL(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function CL(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function EL(e){var t=uL(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function TL(e){return e.read_shift(2),e.read_shift(4)}function sS(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function PL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function OL(){var e=Ge(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function FL(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function IL(e){var t=Ge(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function LL(){}function DL(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Sf(e,0,r),n}function ML(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=Ge(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function RL(e){var t=Ei(e);return t.isst=e.read_shift(4),t}function BL(e,t,r,n){var a=Ge(10);return Wl(e,t,n,a),a.write_shift(4,r),a}function UL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ei(e);r.biff==2&&e.l++;var s=_f(e,n-e.l,r);return a.val=s,a}function zL(e,t,r,n,a){var s=!a||a.biff==8,i=Ge(8+ +s+(1+s)*r.length);return Wl(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function $L(e,t,r){var n=e.read_shift(2),a=ic(e,0,r);return[n,a]}function WL(e,t,r,n){var a=r&&r.biff==5;n||(n=Ge(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var HL=ic;function iS(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c}}}function qL(e,t){var r=t.biff==8||!t.biff?4:2,n=Ge(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function GL(e){var t=e.read_shift(2),r=e.read_shift(2),n=Nk(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function VL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Nk(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function YL(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function KL(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=EI[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function XL(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=KL(e,t,n.fStyle,r),n}function oS(e,t,r,n){var a=r&&r.biff==5;n||(n=Ge(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function JL(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ZL(e){var t=Ge(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function lS(e,t,r){var n=Ei(e);(r.biff==2||t==9)&&++e.l;var a=tL(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function QL(e,t,r,n,a,s){var i=Ge(8);return Wl(e,t,n,i),bk(r,s,i),i}function eD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ei(e),a=ba(e);return n.val=a,n}function tD(e,t,r,n){var a=Ge(14);return Wl(e,t,n,a),zl(r,a),a}var cS=dL;function rD(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=$l(e,s),o=[];n>e.l;)o.push(_f(e));return[s,a,i,o]}function uS(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=hL(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var nD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dS(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=$l(e,i,r);a&32&&(u=nD[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:vB(e,d,r,o);return{chKey:s,Name:u,itab:c,rgce:f}}function Ck(e,t,r){if(r.biff<8)return aD(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(fL(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function aD(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Sf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function sD(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=$l(e,n,r),i=$l(e,a,r);return[s,i]}function iD(e,t,r){var n=jk(e);e.l++;var a=e.read_shift(1);return t-=8,[yB(e,t,r),a,n]}function fS(e,t,r){var n=mL(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,gB(e,t,r)]}function oD(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function lD(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=ic(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function cD(e,t,r){return lD(e,t,r)}function uD(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ap(e));return r}function dD(e){var t=Ge(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Ak(e[r],t);return t}function fD(e,t,r){if(r&&r.biff<8)return mD(e,t,r);var n=kk(e),a=vL(e,t-22,n[1]);return{cmo:n,ft:a}}var hD={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function mD(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((hD[n]||Na)(e,t,r)),{cmo:[a,n,s],ft:i}}function pD(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=aL(e,6,r);var o=e.read_shift(2);e.read_shift(2),Sn(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=$l(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function gD(e,t){var r=ap(e);e.l+=16;var n=lL(e,t-24);return[r,n]}function xD(e){var t=Ge(24),r=Gr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Xn([t,cL(e[1])])}function vD(e,t){e.read_shift(2);var r=ap(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ia,""),[r,n]}function yD(e){var t=e[1].Tooltip,r=Ge(10+2*(t.length+1));r.write_shift(2,2048);var n=Gr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function bD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=X5[r]||r,r=e.read_shift(2),t[1]=X5[r]||r,t}function wD(e){return e||(e=Ge(4)),e.write_shift(2,1),e.write_shift(2,1),e}function SD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(_k(e));return r}function _D(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(_k(e));return r}function ND(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Ek(e,t,r){if(!r.cellStyles)return Na(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function AD(e,t){var r=Ge(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function jD(e,t){var r={};return t<32||(e.l+=16,r.header=ba(e),r.footer=ba(e),e.l+=2),r}function kD(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function CD(e){for(var t=Ge(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var ED=Ei,TD=yk,PD=_f;function OD(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function FD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ei(e);++e.l;var a=ic(e,t-7,r);return n.t="str",n.val=a,n}function ID(e){var t=Ei(e);++e.l;var r=ba(e);return t.t="n",t.val=r,t}function LD(e,t,r){var n=Ge(15);return kf(n,e,t),n.write_shift(8,r,"f"),n}function DD(e){var t=Ei(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function MD(e,t,r){var n=Ge(9);return kf(n,e,t),n.write_shift(2,r),n}function RD(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function BD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function UD(e,t,r){var n=e.l+t,a=Ei(e),s=e.read_shift(2),i=$l(e,s,r);return e.l=n,a.t="str",a.val=i,a}var zD=[2,3,48,49,131,139,140,245],hv=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=tp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Go(1);switch(c.type){case"base64":d=as(us(o));break;case"binary":d=as(o);break;case"buffer":case"array":d=o;break}ia(d,0);var f=d.read_shift(1),m=!!(f&136),h=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,v=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(v=d.read_shift(2));var b=d.read_shift(2),S=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(S=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var _=[],E={},P=Math.min(d.length,f==2?521:v-10-(h?264:0)),N=p?32:11;d.l<P&&d[d.l]!=13;)switch(E={},E.name=zd.utils.decode(S,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,E.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),f==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&_.push(E),f!=2&&(d.l+=p?13:14),E.type){case"B":(!h||E.len!=8)&&c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var I=0,k=0;for(u[0]=[],k=0;k!=_.length;++k)u[0][k]=_[k].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++I]=[],k=0,k=0;k!=_.length;++k){var T=d.slice(d.l,d.l+_[k].len);d.l+=_[k].len,ia(T,0);var q=zd.utils.decode(S,T);switch(_[k].type){case"C":q.trim().length&&(u[I][k]=q.replace(/\s+$/,""));break;case"D":q.length===8?u[I][k]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):u[I][k]=q;break;case"F":u[I][k]=parseFloat(q.trim());break;case"+":case"I":u[I][k]=p?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":u[I][k]=!0;break;case"N":case"F":u[I][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[I][k]="##MEMO##"+(p?parseInt(q.trim(),10):T.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(u[I][k]=+q||0);break;case"@":u[I][k]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[I][k]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[I][k]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[I][k]=-T.read_shift(-8,"f");break;case"B":if(h&&_[k].len==8){u[I][k]=T.read_shift(8,"f");break}case"G":case"P":T.l+=_[k].len;break;case"0":if(_[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[k].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=wu(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return al(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&Js(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=qa(),f=Qh(o,{header:1,raw:!0,cellDates:!0}),m=f[0],h=f.slice(1),p=o["!cols"]||[],g=0,v=0,b=0,S=1;for(g=0;g<m.length;++g){if(((p[g]||{}).DBF||{}).name){m[g]=p[g].DBF.name,++b;continue}if(m[g]!=null){if(++b,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(v=0;v<1024;++v)if(m.indexOf(m[g]+"_"+v)==-1){m[g]+="_"+v;break}}}}var _=ir(o["!ref"]),E=[],P=[],N=[];for(g=0;g<=_.e.c-_.s.c;++g){var I="",k="",T=0,q=[];for(v=0;v<h.length;++v)h[v][g]!=null&&q.push(h[v][g]);if(q.length==0||m[g]==null){E[g]="?";continue}for(v=0;v<q.length;++v){switch(typeof q[v]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=q[v]instanceof Date?"D":"C";break;default:k="C"}T=Math.max(T,String(q[v]).length),I=I&&I!=k?"C":k}T>250&&(T=250),k=((p[g]||{}).DBF||{}).type,k=="C"&&p[g].DBF.len>T&&(T=p[g].DBF.len),I=="B"&&k=="N"&&(I="N",N[g]=p[g].DBF.dec,T=p[g].DBF.len),P[g]=I=="C"||k=="N"?T:s[I]||0,S+=P[g],E[g]=I}var F=d.next(32);for(F.write_shift(4,318902576),F.write_shift(4,h.length),F.write_shift(2,296+32*b),F.write_shift(2,S),g=0;g<4;++g)F.write_shift(4,0);for(F.write_shift(4,0|(+t[vj]||3)<<8),g=0,v=0;g<m.length;++g)if(m[g]!=null){var j=d.next(32),U=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,U,"sbcs"),j.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),j.write_shift(4,v),j.write_shift(1,P[g]||s[E[g]]||0),j.write_shift(1,N[g]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),v+=P[g]||s[E[g]]||0}var B=d.next(264);for(B.write_shift(4,13),g=0;g<65;++g)B.write_shift(4,0);for(g=0;g<h.length;++g){var X=d.next(S);for(X.write_shift(1,0),v=0;v<m.length;++v)if(m[v]!=null)switch(E[v]){case"L":X.write_shift(1,h[g][v]==null?63:h[g][v]?84:70);break;case"B":X.write_shift(8,h[g][v]||0,"f");break;case"N":var K="0";for(typeof h[g][v]=="number"&&(K=h[g][v].toFixed(N[v]||0)),b=0;b<P[v]-K.length;++b)X.write_shift(1,32);X.write_shift(1,K,"sbcs");break;case"D":h[g][v]?(X.write_shift(4,("0000"+h[g][v].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(h[g][v].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+h[g][v].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(h[g][v]!=null?h[g][v]:"").slice(0,P[v]);for(X.write_shift(1,ee,"sbcs"),b=0;b<P[v]-ee.length;++b)X.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}})(),Tk=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+an(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var p=e[h];return typeof p=="number"?_5(p):p},n=function(m,h,p){var g=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?m:_5(g)};e["|"]=254;function a(m,h){switch(h.type){case"base64":return s(us(m),h);case"binary":return s(m,h);case"buffer":return s(Yt&&Buffer.isBuffer(m)?m.toString("binary"):nl(m),h);case"array":return s(Ul(m),h)}throw new Error("Unrecognized type "+h.type)}function s(m,h){var p=m.split(/[\n\r]+/),g=-1,v=-1,b=0,S=0,_=[],E=[],P=null,N={},I=[],k=[],T=[],q=0,F;for(+h.codepage>=0&&Js(+h.codepage);b!==p.length;++b){q=0;var j=p[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=j.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),B=U[0],X;if(j.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&E.push(j.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,ee=!1,Y=!1,z=!1,ne=-1,le=-1;for(S=1;S<U.length;++S)switch(U[S].charAt(0)){case"A":break;case"X":v=parseInt(U[S].slice(1))-1,ee=!0;break;case"Y":for(g=parseInt(U[S].slice(1))-1,ee||(v=0),F=_.length;F<=g;++F)_[F]=[];break;case"K":X=U[S].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Qs(X))?isNaN(lu(X).getDate())||(X=Lr(X)):(X=Qs(X),P!==null&&yu(P)&&(X=np(X))),K=!0;break;case"E":z=!0;var A=Qc(U[S].slice(1),{r:g,c:v});_[g][v]=[_[g][v],A];break;case"S":Y=!0,_[g][v]=[_[g][v],"S5S"];break;case"G":break;case"R":ne=parseInt(U[S].slice(1))-1;break;case"C":le=parseInt(U[S].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(K&&(_[g][v]&&_[g][v].length==2?_[g][v][0]=X:_[g][v]=X,P=null),Y){if(z)throw new Error("SYLK shared formula cannot have own formula");var D=ne>-1&&_[ne][le];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");_[g][v][1]=Yk(D[1],{r:g-ne,c:v-le})}break;case"F":var L=0;for(S=1;S<U.length;++S)switch(U[S].charAt(0)){case"X":v=parseInt(U[S].slice(1))-1,++L;break;case"Y":for(g=parseInt(U[S].slice(1))-1,F=_.length;F<=g;++F)_[F]=[];break;case"M":q=parseInt(U[S].slice(1))/20;break;case"F":break;case"G":break;case"P":P=E[parseInt(U[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=U[S].slice(1).split(" "),F=parseInt(T[0],10);F<=parseInt(T[1],10);++F)q=parseInt(T[2],10),k[F-1]=q===0?{hidden:!0}:{wch:q},Vo(k[F-1]);break;case"C":v=parseInt(U[S].slice(1))-1,k[v]||(k[v]={});break;case"R":g=parseInt(U[S].slice(1))-1,I[g]||(I[g]={}),q>0?(I[g].hpt=q,I[g].hpx=uu(q)):q===0&&(I[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}L<1&&(P=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return I.length>0&&(N["!rows"]=I),k.length>0&&(N["!cols"]=k),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,N]}function i(m,h){var p=a(m,h),g=p[0],v=p[1],b=wu(g,h);return an(v).forEach(function(S){b[S]=v[S]}),b}function o(m,h){return al(i(m,h),h)}function c(m,h,p,g){var v="C;Y"+(p+1)+";X"+(g+1)+";K";switch(m.t){case"n":v+=m.v||0,m.f&&!m.F&&(v+=";E"+y2(m.f,{r:p,c:g}));break;case"b":v+=m.v?"TRUE":"FALSE";break;case"e":v+=m.w||m.v;break;case"d":v+='"'+(m.w||m.v)+'"';break;case"s":v+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(m,h){h.forEach(function(p,g){var v="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Kd(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Xd(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&m.push(v)})}function d(m,h){h.forEach(function(p,g){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*Jd(p.hpx)+";"),v.length>2&&m.push(v+"R"+(g+1))})}function f(m,h){var p=["ID;PWXL;N;E"],g=[],v=ir(m["!ref"]),b,S=Array.isArray(m),_=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),m["!cols"]&&u(p,m["!cols"]),m["!rows"]&&d(p,m["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var E=v.s.r;E<=v.e.r;++E)for(var P=v.s.c;P<=v.e.c;++P){var N=Mt({r:E,c:P});b=S?(m[E]||[])[P]:m[N],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,m,E,P))}return p.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:f}})(),Pk=(function(){function e(s,i){switch(i.type){case"base64":return t(us(s),i);case"binary":return t(s,i);case"buffer":return t(Yt&&Buffer.isBuffer(s)?s.toString("binary"):nl(s),i);case"array":return t(Ul(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=o[d].trim().split(","),h=m[0],p=m[1];++d;for(var g=o[d]||"";(g.match(/["]/g)||[]).length&1&&d<o.length-1;)g+=`
`+o[++d];switch(g=g.trim(),+h){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(Qs(p))?isNaN(lu(p).getDate())?f[c][u]=p:f[c][u]=Lr(p):f[c][u]=Qs(p),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return wu(e(s,i),i)}function n(s,i){return al(r(s,i),i)}var a=(function(){var s=function(c,u,d,f,m){c.push(u),c.push(d+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=ir(c["!ref"]),f,m=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var g=Mt({r:h,c:p});if(f=m?(c[h]||[])[p]:c[g],!f){i(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Os(f.z||Lt[14],In(Lr(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var b=`\r
`,S=u.join(b);return S}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),Ok=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var h=f.split(`
`),p=-1,g=-1,v=0,b=[];v!==h.length;++v){var S=h[v].trim().split(":");if(S[0]==="cell"){var _=Gr(S[1]);if(b.length<=_.r)for(p=b.length;p<=_.r;++p)b[p]||(b[p]=[]);switch(p=_.r,g=_.c,S[2]){case"t":b[p][g]=e(S[3]);break;case"v":b[p][g]=+S[3];break;case"vtf":var E=S[S.length-1];case"vtc":switch(S[3]){case"nl":b[p][g]=!!+S[4];break;default:b[p][g]=+S[4];break}S[2]=="vtf"&&(b[p][g]=[b[p][g],E])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function n(f,m){return wu(r(f,m),m)}function a(f,m){return al(n(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],h=[],p,g="",v=Ga(f["!ref"]),b=Array.isArray(f),S=v.s.r;S<=v.e.r;++S)for(var _=v.s.c;_<=v.e.c;++_)if(g=Mt({r:S,c:_}),p=b?(f[S]||[])[_]:f[g],!(!p||p.v==null||p.t==="z")){switch(h=["cell",g,"t"],p.t){case"s":case"str":h.push(t(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=t(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var E=In(Lr(p.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=p.w||Os(p.z||Lt[14],E);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(f){return[s,i,o,i,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),cu=(function(){function e(d,f,m,h,p){p.raw?f[m][h]=d:d===""||(d==="TRUE"?f[m][h]=!0:d==="FALSE"?f[m][h]=!1:isNaN(Qs(d))?isNaN(lu(d).getDate())?f[m][h]=d:f[m][h]=Lr(d):f[m][h]=Qs(d))}function t(d,f){var m=f||{},h=[];if(!d||d.length===0)return h;for(var p=d.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var v=10,b=0,S=0;S<=g;++S)b=p[S].indexOf(" "),b==-1?b=p[S].length:b++,v=Math.max(v,b);for(S=0;S<=g;++S){h[S]=[];var _=0;for(e(p[S].slice(0,v).trim(),h,S,_,m),_=1;_<=(p[S].length-v)/10+1;++_)e(p[S].slice(v+(_-1)*10,v+_*10).trim(),h,S,_,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},m=!1,h=0,p=0;h<d.length;++h)(p=d.charCodeAt(h))==34?m=!m:!m&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h]);if(!p.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&p.push([f[h],h])}return p.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[p.pop()[1]]||44}function s(d,f){var m=f||{},h="",p=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):m&&m.FS?h=m.FS:h=a(d.slice(0,1024));var v=0,b=0,S=0,_=0,E=0,P=h.charCodeAt(0),N=!1,I=0,k=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=m.dateNF!=null?k7(m.dateNF):null;function q(){var F=d.slice(_,E),j={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)j.t="z";else if(m.raw)j.t="s",j.v=F;else if(F.trim().length===0)j.t="s",j.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(j.t="s",j.v=F.slice(2,-1).replace(/""/g,'"')):r9(F)?(j.t="n",j.f=F.slice(1)):(j.t="s",j.v=F);else if(F=="TRUE")j.t="b",j.v=!0;else if(F=="FALSE")j.t="b",j.v=!1;else if(!isNaN(S=Qs(F)))j.t="n",m.cellText!==!1&&(j.w=F),j.v=S;else if(!isNaN(lu(F).getDate())||T&&F.match(T)){j.z=m.dateNF||Lt[14];var U=0;T&&F.match(T)&&(F=C7(F,m.dateNF,F.match(T)||[]),U=1),m.cellDates?(j.t="d",j.v=Lr(F,U)):(j.t="n",j.v=In(Lr(F,U))),m.cellText!==!1&&(j.w=Os(j.z,j.v instanceof Date?In(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=F;if(j.t=="z"||(m.dense?(p[v]||(p[v]=[]),p[v][b]=j):p[Mt({c:b,r:v})]=j),_=E+1,k=d.charCodeAt(_),g.e.c<b&&(g.e.c=b),g.e.r<v&&(g.e.r=v),I==P)++b;else if(b=0,++v,m.sheetRows&&m.sheetRows<=v)return!0}e:for(;E<d.length;++E)switch(I=d.charCodeAt(E)){case 34:k===34&&(N=!N);break;case P:case 10:case 13:if(!N&&q())break e;break}return E-_>0&&q(),p["!ref"]=qt(g),p}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):wu(t(d,f),f)}function o(d,f){var m="",h=f.type=="string"?[0,0,0,0]:k2(d,f);switch(f.type){case"base64":m=us(d);break;case"binary":m=d;break;case"buffer":f.codepage==65001?m=d.toString("utf8"):f.codepage&&typeof zd<"u"||(m=Yt&&Buffer.isBuffer(d)?d.toString("binary"):nl(d));break;case"array":m=Ul(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=_r(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=_r(m):f.type=="binary"&&typeof zd<"u",m.slice(0,19)=="socialcalc:version:"?Ok.to_sheet(f.type=="string"?m:_r(m),f):i(m,f)}function c(d,f){return al(o(d,f),f)}function u(d){for(var f=[],m=ir(d["!ref"]),h,p=Array.isArray(d),g=m.s.r;g<=m.e.r;++g){for(var v=[],b=m.s.c;b<=m.e.c;++b){var S=Mt({r:g,c:b});if(h=p?(d[g]||[])[b]:d[S],!h||h.v==null){v.push("          ");continue}for(var _=(h.w||(eo(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";v.push(_+(b===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function $D(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Tk.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return cu.to_workbook(e,t)}}var Fl=(function(){function e(A,D,L){if(A){ia(A,A.l||0);for(var M=L.Enum||ne;A.l<A.length;){var R=A.read_shift(2),H=M[R]||M[65535],J=A.read_shift(2),G=A.l+J,Q=H.f&&H.f(A,J,L);if(A.l=G,D(Q,H,R))return}}}function t(A,D){switch(D.type){case"base64":return r(as(us(A)),D);case"binary":return r(as(A),D);case"buffer":case"array":return r(A,D)}throw"Unsupported type "+D.type}function r(A,D){if(!A)return A;var L=D||{},M=L.dense?[]:{},R="Sheet1",H="",J=0,G={},Q=[],de=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ee=L.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)L.Enum=ne,e(A,function(Se,ge,pe){switch(pe){case 0:L.vers=Se,Se>=4096&&(L.qpro=!0);break;case 6:V=Se;break;case 204:Se&&(H=Se);break;case 222:H=Se;break;case 15:case 51:L.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:pe==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=L.dateNF||Lt[14],L.cellDates&&(Se[1].t="d",Se[1].v=np(Se[1].v))),L.qpro&&Se[3]>J&&(M["!ref"]=qt(V),G[R]=M,Q.push(R),M=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=Se[3],R=H||"Sheet"+(J+1),H="");var Ae=L.dense?(M[Se[0].r]||[])[Se[0].c]:M[Mt(Se[0])];if(Ae){Ae.t=Se[1].t,Ae.v=Se[1].v,Se[1].z!=null&&(Ae.z=Se[1].z),Se[1].f!=null&&(Ae.f=Se[1].f);break}L.dense?(M[Se[0].r]||(M[Se[0].r]=[]),M[Se[0].r][Se[0].c]=Se[1]):M[Mt(Se[0])]=Se[1];break}},L);else if(A[2]==26||A[2]==14)L.Enum=le,A[2]==14&&(L.qpro=!0,A.l=0),e(A,function(Se,ge,pe){switch(pe){case 204:R=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>J&&(M["!ref"]=qt(V),G[R]=M,Q.push(R),M=L.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=Se[3],R="Sheet"+(J+1)),Ee>0&&Se[0].r>=Ee)break;L.dense?(M[Se[0].r]||(M[Se[0].r]=[]),M[Se[0].r][Se[0].c]=Se[1]):M[Mt(Se[0])]=Se[1],V.e.c<Se[0].c&&(V.e.c=Se[0].c),V.e.r<Se[0].r&&(V.e.r=Se[0].r);break;case 27:Se[14e3]&&(de[Se[14e3][0]]=Se[14e3][1]);break;case 1537:de[Se[0]]=Se[1],Se[0]==J&&(R=Se[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(M["!ref"]=qt(V),G[H||R]=M,Q.push(H||R),!de.length)return{SheetNames:Q,Sheets:G};for(var we={},he=[],Z=0;Z<de.length;++Z)G[Q[Z]]?(he.push(de[Z]||Q[Z]),we[de[Z]]=G[de[Z]]||G[Q[Z]]):(he.push(de[Z]),we[de[Z]]={"!ref":"A1"});return{SheetNames:he,Sheets:we}}function n(A,D){var L=D||{};if(+L.codepage>=0&&Js(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var M=qa(),R=ir(A["!ref"]),H=Array.isArray(A),J=[];ot(M,0,s(1030)),ot(M,6,c(R));for(var G=Math.min(R.e.r,8191),Q=R.s.r;Q<=G;++Q)for(var de=mn(Q),V=R.s.c;V<=R.e.c;++V){Q===R.s.r&&(J[V]=qr(V));var Ee=J[V]+de,we=H?(A[Q]||[])[V]:A[Ee];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?ot(M,13,h(Q,V,we.v)):ot(M,14,g(Q,V,we.v));else{var he=eo(we);ot(M,15,f(Q,V,he.slice(0,239)))}}return ot(M,1),M.end()}function a(A,D){var L=D||{};if(+L.codepage>=0&&Js(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var M=qa();ot(M,0,i(A));for(var R=0,H=0;R<A.SheetNames.length;++R)(A.Sheets[A.SheetNames[R]]||{})["!ref"]&&ot(M,27,z(A.SheetNames[R],H++));var J=0;for(R=0;R<A.SheetNames.length;++R){var G=A.Sheets[A.SheetNames[R]];if(!(!G||!G["!ref"])){for(var Q=ir(G["!ref"]),de=Array.isArray(G),V=[],Ee=Math.min(Q.e.r,8191),we=Q.s.r;we<=Ee;++we)for(var he=mn(we),Z=Q.s.c;Z<=Q.e.c;++Z){we===Q.s.r&&(V[Z]=qr(Z));var Se=V[Z]+he,ge=de?(G[we]||[])[Z]:G[Se];if(!(!ge||ge.t=="z"))if(ge.t=="n")ot(M,23,q(we,Z,J,ge.v));else{var pe=eo(ge);ot(M,22,I(we,Z,J,pe.slice(0,239)))}}++J}}return ot(M,1),M.end()}function s(A){var D=Ge(2);return D.write_shift(2,A),D}function i(A){var D=Ge(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var L=0,M=0,R=0,H=0;H<A.SheetNames.length;++H){var J=A.SheetNames[H],G=A.Sheets[J];if(!(!G||!G["!ref"])){++R;var Q=Ga(G["!ref"]);L<Q.e.r&&(L=Q.e.r),M<Q.e.c&&(M=Q.e.c)}}return L>8191&&(L=8191),D.write_shift(2,L),D.write_shift(1,R),D.write_shift(1,M),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function o(A,D,L){var M={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&L.qpro?(M.s.c=A.read_shift(1),A.l++,M.s.r=A.read_shift(2),M.e.c=A.read_shift(1),A.l++,M.e.r=A.read_shift(2),M):(M.s.c=A.read_shift(2),M.s.r=A.read_shift(2),D==12&&L.qpro&&(A.l+=2),M.e.c=A.read_shift(2),M.e.r=A.read_shift(2),D==12&&L.qpro&&(A.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(A){var D=Ge(8);return D.write_shift(2,A.s.c),D.write_shift(2,A.s.r),D.write_shift(2,A.e.c),D.write_shift(2,A.e.r),D}function u(A,D,L){var M=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(M[0].c=A.read_shift(1),M[3]=A.read_shift(1),M[0].r=A.read_shift(2),A.l+=2):(M[2]=A.read_shift(1),M[0].c=A.read_shift(2),M[0].r=A.read_shift(2)),M}function d(A,D,L){var M=A.l+D,R=u(A,D,L);if(R[1].t="s",L.vers==20768){A.l++;var H=A.read_shift(1);return R[1].v=A.read_shift(H,"utf8"),R}return L.qpro&&A.l++,R[1].v=A.read_shift(M-A.l,"cstr"),R}function f(A,D,L){var M=Ge(7+L.length);M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,A),M.write_shift(1,39);for(var R=0;R<M.length;++R){var H=L.charCodeAt(R);M.write_shift(1,H>=128?95:H)}return M.write_shift(1,0),M}function m(A,D,L){var M=u(A,D,L);return M[1].v=A.read_shift(2,"i"),M}function h(A,D,L){var M=Ge(7);return M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,A),M.write_shift(2,L,"i"),M}function p(A,D,L){var M=u(A,D,L);return M[1].v=A.read_shift(8,"f"),M}function g(A,D,L){var M=Ge(13);return M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,A),M.write_shift(8,L,"f"),M}function v(A,D,L){var M=A.l+D,R=u(A,D,L);if(R[1].v=A.read_shift(8,"f"),L.qpro)A.l=M;else{var H=A.read_shift(2);E(A.slice(A.l,A.l+H),R),A.l+=H}return R}function b(A,D,L){var M=D&32768;return D&=-32769,D=(M?A:0)+(D>=8192?D-16384:D),(M?"":"$")+(L?qr(D):mn(D))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(A,D){ia(A,0);for(var L=[],M=0,R="",H="",J="",G="";A.l<A.length;){var Q=A[A.l++];switch(Q){case 0:L.push(A.read_shift(8,"f"));break;case 1:H=b(D[0].c,A.read_shift(2),!0),R=b(D[0].r,A.read_shift(2),!1),L.push(H+R);break;case 2:{var de=b(D[0].c,A.read_shift(2),!0),V=b(D[0].r,A.read_shift(2),!1);H=b(D[0].c,A.read_shift(2),!0),R=b(D[0].r,A.read_shift(2),!1),L.push(de+V+":"+H+R)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(A.read_shift(2));break;case 6:{for(var Ee="";Q=A[A.l++];)Ee+=String.fromCharCode(Q);L.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:G=L.pop(),J=L.pop(),L.push(["AND","OR"][Q-20]+"("+J+","+G+")");break;default:if(Q<32&&_[Q])G=L.pop(),J=L.pop(),L.push(J+_[Q]+G);else if(S[Q]){if(M=S[Q][1],M==69&&(M=A[A.l++]),M>L.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+L.join("|")+"|");return}var we=L.slice(-M);L.length-=M,L.push(S[Q][0]+"("+we.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}L.length==1?D[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function P(A){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=A.read_shift(2),D[3]=A[A.l++],D[0].c=A[A.l++],D}function N(A,D){var L=P(A);return L[1].t="s",L[1].v=A.read_shift(D-4,"cstr"),L}function I(A,D,L,M){var R=Ge(6+M.length);R.write_shift(2,A),R.write_shift(1,L),R.write_shift(1,D),R.write_shift(1,39);for(var H=0;H<M.length;++H){var J=M.charCodeAt(H);R.write_shift(1,J>=128?95:J)}return R.write_shift(1,0),R}function k(A,D){var L=P(A);L[1].v=A.read_shift(2);var M=L[1].v>>1;if(L[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return L[1].v=M,L}function T(A,D){var L=P(A),M=A.read_shift(4),R=A.read_shift(4),H=A.read_shift(2);if(H==65535)return M===0&&R===3221225472?(L[1].t="e",L[1].v=15):M===0&&R===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var J=H&32768;return H=(H&32767)-16446,L[1].v=(1-J*2)*(R*Math.pow(2,H+32)+M*Math.pow(2,H)),L}function q(A,D,L,M){var R=Ge(14);if(R.write_shift(2,A),R.write_shift(1,L),R.write_shift(1,D),M==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var H=0,J=0,G=0,Q=0;return M<0&&(H=1,M=-M),J=Math.log2(M)|0,M/=Math.pow(2,J-31),Q=M>>>0,(Q&2147483648)==0&&(M/=2,++J,Q=M>>>0),M-=Q,Q|=2147483648,Q>>>=0,M*=Math.pow(2,32),G=M>>>0,R.write_shift(4,G),R.write_shift(4,Q),J+=16383+(H?32768:0),R.write_shift(2,J),R}function F(A,D){var L=T(A);return A.l+=D-14,L}function j(A,D){var L=P(A),M=A.read_shift(4);return L[1].v=M>>6,L}function U(A,D){var L=P(A),M=A.read_shift(8,"f");return L[1].v=M,L}function B(A,D){var L=U(A);return A.l+=D-10,L}function X(A,D){return A[A.l+D-1]==0?A.read_shift(D,"cstr"):""}function K(A,D){var L=A[A.l++];L>D-1&&(L=D-1);for(var M="";M.length<L;)M+=String.fromCharCode(A[A.l++]);return M}function ee(A,D,L){if(!(!L.qpro||D<21)){var M=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var R=A.read_shift(D-21,"cstr");return[M,R]}}function Y(A,D){for(var L={},M=A.l+D;A.l<M;){var R=A.read_shift(2);if(R==14e3){for(L[R]=[0,""],L[R][0]=A.read_shift(2);A[A.l];)L[R][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return L}function z(A,D){var L=Ge(5+A.length);L.write_shift(2,14e3),L.write_shift(2,D);for(var M=0;M<A.length;++M){var R=A.charCodeAt(M);L[L.l++]=R>127?95:R}return L[L.l++]=0,L}var ne={0:{n:"BOF",f:Sn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function WD(e){var t={},r=e.match(Aa),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Rt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Hy[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var HD=(function(){var e=Hd("t"),t=Hd("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:sr(i[1])},c=s.match(t);return c&&(o.s=WD(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}})(),qD=(function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),GD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,VD=/<(?:\w+:)?r>/,YD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function m2(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=sr(_r(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=_r(e),r&&(n.h=e2(n.t))):e.match(VD)&&(n.r=_r(e),n.t=sr(_r((e.replace(YD,"").match(GD)||[]).join("").replace(Aa,""))),r&&(n.h=qD(HD(n.r)))),n):{t:""}}var KD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XD=/<(?:\w+:)?(?:si|sstItem)>/g,JD=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZD(e,t){var r=[],n="";if(!e)return r;var a=e.match(KD);if(a){n=a[2].replace(XD,"").split(JD);for(var s=0;s!=n.length;++s){var i=m2(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Rt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var QD=/^\s|\s$|[\t\n\r]/;function Fk(e,t){if(!t.bookSST)return"";var r=[pn];r[r.length]=it("sst",null,{xmlns:tc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(QD)&&(s+=' xml:space="preserve"'),s+=">"+vr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function eM(e){return[e.read_shift(4),e.read_shift(4)]}function tM(e,t){var r=[],n=!1;return fo(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function rM(e,t){return t||(t=Ge(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var nM=hI;function aM(e){var t=qa();Ze(t,159,rM(e));for(var r=0;r<e.length;++r)Ze(t,19,nM(e[r]));return Ze(t,160),t.end()}function Ik(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ji(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function sM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ji(e,4),t.U=Ji(e,4),t.W=Ji(e,4),t}function iM(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function oM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(iM(e));return t}function lM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function cM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ji(e,4),t.U=Ji(e,4),t.W=Ji(e,4),t}function uM(e){var t=cM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Lk(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Dk(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function dM(e){var t=Ji(e);switch(t.Minor){case 2:return[t.Minor,fM(e)];case 3:return[t.Minor,hM()];case 4:return[t.Minor,mM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function fM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Lk(e,r),a=Dk(e,e.length-e.l);return{t:"Std",h:n,v:a}}function hM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Aa,function(s){var i=Rt(s);switch(Ci(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function pM(e,t){var r={},n=r.EncryptionVersionInfo=Ji(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Lk(e,a),t-=a,r.EncryptionVerifier=Dk(e,t),r}function gM(e){var t={},r=t.EncryptionVersionInfo=Ji(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function p2(e){var t=0,r,n=Ik(e),a=n.length+1,s,i,o,c,u;for(r=Go(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var Mk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=Ik(i),c=s(o),u=o.length,d=Go(16),f=0;f!=16;++f)d[f]=0;var m,h,p;for((u&1)===1&&(m=c>>8,d[u]=a(e[0],m),--u,m=c&255,h=o[o.length-1],d[u]=a(h,m));u>0;)--u,m=c>>8,d[u]=a(o[u],m),--u,m=c&255,d[u]=a(o[u],m);for(u=15,p=15-o.length;p>0;)m=c>>8,d[u]=a(e[p],m),--u,--p,m=c&255,d[u]=a(o[u],m),--u,--p;return d}})(),xM=function(e,t,r,n,a){a||(a=t),n||(n=Mk(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},vM=function(e){var t=0,r=Mk(e);return function(n){var a=xM("",n,t,r);return t=a[1],a[0]}};function yM(e,t,r,n){var a={key:Sn(e),verificationBytes:Sn(e)};return r.password&&(a.verifier=p2(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=vM(r.password)),a}function bM(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=gM(e):n.Data=pM(e,t),n}function wM(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?bM(e,t-2,n):yM(e,r.biff>=8?t:t-2,r,n),n}var Rk=(function(){function e(a,s){switch(s.type){case"base64":return t(us(a),s);case"binary":return t(a,s);case"buffer":return t(Yt&&Buffer.isBuffer(a)?a.toString("binary"):nl(a),s);case"array":return t(Ul(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var m=/\\\w+\b/g,h=0,p,g=-1;p=m.exec(d);){switch(p[0]){case"\\cell":var v=d.slice(h,m.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++g,v.length){var b={v,t:"s"};Array.isArray(o)?o[f][g]=b:o[Mt({r:f,c:g})]=b}break}h=m.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=qt(u),o}function r(a,s){return al(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ir(a["!ref"]),o,c=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Mt({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(eo(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function SM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Yd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function _M(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,c=0,u=a+s;switch(c=i/(u>1?2-u:u),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function NM(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,i[0]+=a,i[1]+=c;break;case 1:c=a*(2-o),i[0]+=c,i[1]+=a;break;case 2:c=a*(o-2),i[1]+=a,i[2]+=c;break;case 3:c=a*(4-o),i[1]+=c,i[2]+=a;break;case 4:c=a*(o-4),i[2]+=a,i[0]+=c;break;case 5:c=a*(6-o),i[2]+=c,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Jh(e,t){if(t===0)return e;var r=_M(SM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Yd(NM(r))}var Bk=6,AM=15,jM=1,va=Bk;function Kd(e){return Math.floor((e+Math.round(128/va)/256)*va)}function Xd(e){return Math.floor((e-5)/va*100+.5)/100}function Zh(e){return Math.round((e*va+5)/va*256)/256}function Xg(e){return Zh(Xd(Kd(e)))}function g2(e){var t=Math.abs(e-Xg(e)),r=va;if(t>.005)for(va=jM;va<AM;++va)Math.abs(e-Xg(e))<=t&&(t=Math.abs(e-Xg(e)),r=va);va=r}function Vo(e){e.width?(e.wpx=Kd(e.width),e.wch=Xd(e.wpx),e.MDW=va):e.wpx?(e.wch=Xd(e.wpx),e.width=Zh(e.wch),e.MDW=va):typeof e.wch=="number"&&(e.width=Zh(e.wch),e.wpx=Kd(e.width),e.MDW=va),e.customWidth&&delete e.customWidth}var kM=96,Uk=kM;function Jd(e){return e*96/Uk}function uu(e){return e*Uk/96}var CM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EM(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Aa)||[]).forEach(function(i){var o=Rt(i);switch(Ci(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Fr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Fr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function TM(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Aa)||[]).forEach(function(i){var o=Rt(i);switch(Ci(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function PM(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Aa)||[]).forEach(function(i){var o=Rt(i);switch(Ci(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=_r(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Fr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Fr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Fr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Fr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Fr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Fr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Fr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Hy[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Fr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Pl[a.color.index];a.color.index==81&&(c=Pl[1]),c||(c=Pl[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Jh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function OM(e,t,r){t.NumberFmt=[];for(var n=an(Lt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Lt[n[a]];var s=e[0].match(Aa);if(s)for(a=0;a<s.length;++a){var i=Rt(s[a]);switch(Ci(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=sr(_r(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Xi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function FM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=it("numFmt",null,{numFmtId:n,formatCode:vr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=it("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var eh=["numFmtId","fillId","fontId","borderId","xfId"],th=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function IM(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Aa)||[]).forEach(function(s){var i=Rt(s),o=0;switch(Ci(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<eh.length;++o)n[eh[o]]&&(n[eh[o]]=parseInt(n[eh[o]],10));for(o=0;o<th.length;++o)n[th[o]]&&(n[th[o]]=Fr(n[th[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Fr(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function LM(e){var t=[];return t[t.length]=it("cellXfs",null),e.forEach(function(r){t[t.length]=it("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=it("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var DM=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&OM(f,d,u),(f=o.match(a))&&PM(f,d,c,u),(f=o.match(n))&&TM(f,d,c,u),(f=o.match(s))&&EM(f,d,c,u),(f=o.match(r))&&IM(f,d,u),d}})();function zk(e,t){var r=[pn,it("styleSheet",null,{xmlns:tc[0],"xmlns:vt":On.vt})],n;return e.SSF&&(n=FM(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=LM(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function MM(e,t){var r=e.read_shift(2),n=Sa(e);return[r,n]}function RM(e,t,r){r||(r=Ge(6+4*t.length)),r.write_shift(2,e),Jn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function BM(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=bI(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=yI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sa(e),n}function UM(e,t){t||(t=Ge(153)),t.write_shift(2,e.sz*20),wI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Yh(e.color,t);var n=0;return n=2,t.write_shift(1,n),Jn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var zM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Jg,$M=Na;function hS(e,t){t||(t=Ge(84)),Jg||(Jg=tp(zM));var r=Jg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Yh({auto:1},t),Yh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function WM(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function $k(e,t,r){r||(r=Ge(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fd(e,t){return t||(t=Ge(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var HM=Na;function qM(e,t){return t||(t=Ge(51)),t.write_shift(1,0),fd(null,t),fd(null,t),fd(null,t),fd(null,t),fd(null,t),t.length>t.l?t.slice(0,t.l):t}function GM(e,t){return t||(t=Ge(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Vh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function VM(e,t,r){var n=Ge(2052);return n.write_shift(4,e),Vh(t,n),Vh(r,n),n.length>n.l?n.slice(0,n.l):n}function YM(e,t,r){var n={};n.NumberFmt=[];for(var a in Lt)n.NumberFmt[a]=Lt[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return fo(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Xi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Jh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(d),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function KM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ze(e,615,ei(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ze(e,44,RM(a,t[a]))}),Ze(e,616))}}function XM(e){var t=1;Ze(e,611,ei(t)),Ze(e,43,UM({sz:12,color:{theme:1},name:"Calibri",family:2})),Ze(e,612)}function JM(e){var t=2;Ze(e,603,ei(t)),Ze(e,45,hS({patternType:"none"})),Ze(e,45,hS({patternType:"gray125"})),Ze(e,604)}function ZM(e){var t=1;Ze(e,613,ei(t)),Ze(e,46,qM()),Ze(e,614)}function QM(e){var t=1;Ze(e,626,ei(t)),Ze(e,47,$k({numFmtId:0},65535)),Ze(e,627)}function eR(e,t){Ze(e,617,ei(t.length)),t.forEach(function(r){Ze(e,47,$k(r,0))}),Ze(e,618)}function tR(e){var t=1;Ze(e,619,ei(t)),Ze(e,48,GM({xfId:0,name:"Normal"})),Ze(e,620)}function rR(e){var t=0;Ze(e,505,ei(t)),Ze(e,506)}function nR(e){var t=0;Ze(e,508,VM(t,"TableStyleMedium9","PivotStyleMedium4")),Ze(e,509)}function aR(e,t){var r=qa();return Ze(r,278),KM(r,e.SSF),XM(r),JM(r),ZM(r),QM(r),eR(r,t.cellXfs),tR(r),rR(r),nR(r),Ze(r,279),r.end()}var sR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function iR(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Aa)||[]).forEach(function(a){var s=Rt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[sR.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function oR(){}function lR(){}var cR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,uR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fR(e,t,r){t.themeElements={};var n;[["clrScheme",cR,iR],["fontScheme",uR,oR],["fmtScheme",dR,lR]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var hR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Wk(e,t){(!e||e.length===0)&&(e=x2());var r,n={};if(!(r=e.match(hR)))throw new Error("themeElements not found in theme");return fR(r[0],n,t),n.raw=e,n}function x2(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mR(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Lj(s,{type:"array"})}catch{return}var o=ss(i,"theme/theme/theme1.xml",!0);if(o)return Wk(o,r)}}function pR(e){return e.read_shift(4)}function gR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=xR(e,4);break;case 2:t.xclrValue=Sk(e);break;case 3:t.xclrValue=pR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function xR(e,t){return Na(e,t)}function vR(e,t){return Na(e,t)}function yR(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=gR(e);break;case 6:n[1]=vR(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function bR(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(yR(e,r-e.l));return{ixfe:n,ext:s}}function wR(e,t){t.forEach(function(r){r[0]})}function SR(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sa(e)}}function _R(e){var t=Ge(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Jn(e.name,t),t.slice(0,t.l)}function NR(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function AR(e){var t=Ge(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function jR(e,t){var r=Ge(8+2*t.length);return r.write_shift(4,e),Jn(t,r),r.slice(0,r.l)}function kR(e){return e.l+=4,e.read_shift(4)!=0}function CR(e,t){var r=Ge(8);return r.write_shift(4,e),r.write_shift(4,1),r}function ER(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return fo(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(d),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function TR(){var e=qa();return Ze(e,332),Ze(e,334,ei(1)),Ze(e,335,_R({name:"XLDAPR",version:12e4,flags:3496657072})),Ze(e,336),Ze(e,339,jR(1,"XLDAPR")),Ze(e,52),Ze(e,35,ei(514)),Ze(e,4096,ei(0)),Ze(e,4097,Es(1)),Ze(e,36),Ze(e,53),Ze(e,340),Ze(e,337,CR(1)),Ze(e,51,AR([[1,0]])),Ze(e,338),Ze(e,333),e.end()}function PR(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Aa,function(o){var c=Rt(o);switch(Ci(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Hk(){var e=[pn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function OR(e){var t=[];if(!e)return t;var r=1;return(e.match(Aa)||[]).forEach(function(n){var a=Rt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function FR(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Mt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IR(e,t,r){var n=[];return fo(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function LR(e,t,r,n){if(!e)return e;var a=n||{},s=!1;fo(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function DR(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Vc=1024;function qk(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[it("xml",null,{"xmlns:v":rs.v,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:mv":rs.mv}).replace(/\/>/,">"),it("o:shapelayout",it("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),it("v:shapetype",[it("v:stroke",null,{joinstyle:"miter"}),it("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vc<e*1e3;)Vc+=1e3;return t.forEach(function(s){var i=Gr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?it("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=it("v:fill",c,o),d={on:"t",obscured:"t"};++Vc,a=a.concat(["<v:shape"+qd({id:"_x0000_s"+Vc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,it("v:shadow",null,d),it("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",oa("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),oa("x:AutoFill","False"),oa("x:Row",String(i.r)),oa("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function mS(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Gr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var c=ir(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=qt(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function MR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Rt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Gr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&m2(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function Gk(e){var t=[pn,it("comments",null,{xmlns:tc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=vr(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(vr(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(oa("t",vr(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(oa("t",vr(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RR(e,t){var r=[],n=!1,a={},s=0;return e.replace(Aa,function(o,c){var u=Rt(o);switch(Ci(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function BR(e,t,r){var n=[pn,it("ThreadedComments",null,{xmlns:On.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(it("threadedComment",oa("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function UR(e,t){var r=[],n=!1;return e.replace(Aa,function(s){var i=Rt(s);switch(Ci(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function zR(e){var t=[pn,it("personList",null,{xmlns:On.TCMNT,"xmlns:x":tc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(it("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $R(e){var t={};t.iauthor=e.read_shift(4);var r=sc(e);return t.rfx=r.s,t.ref=Mt(r.s),e.l+=16,t}function WR(e,t){return t==null&&(t=Ge(36)),t.write_shift(4,e[1].iauthor),Su(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var HR=Sa;function qR(e){return Jn(e.slice(0,54))}function GR(e,t){var r=[],n=[],a={},s=!1;return fo(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function VR(e){var t=qa(),r=[];return Ze(t,628),Ze(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ze(t,632,qR(a.a)))})}),Ze(t,631),Ze(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Gr(n[0]),e:Gr(n[0])};Ze(t,635,WR([s,a])),a.t&&a.t.length>0&&Ze(t,637,pI(a)),Ze(t,636),delete a.iauthor})}),Ze(t,634),Ze(t,629),t.end()}var YR="application/vnd.ms-office.vbaProject";function KR(e){var t=Ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ct.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ct.write(t)}function XR(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ct.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Vk=["xlsb","xlsm","xlam","biff8","xla"];function JR(){return{"!type":"dialog"}}function ZR(){return{"!type":"dialog"}}function QR(){return{"!type":"macro"}}function e9(){return{"!type":"macro"}}var Qc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+qr(d)+(c?"":"$")+mn(u)}return function(a,s){return t=s,a.replace(e,r)}})(),v2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,y2=(function(){return function(t,r){return t.replace(v2,function(n,a,s,i,o,c){var u=s2(i)-(s?0:r.c),d=a2(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",m=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+m})}})();function Yk(e,t){return e.replace(v2,function(r,n,a,s,i,o){return n+(a=="$"?a+s:qr(s2(s)+t.c))+(i=="$"?i+o:mn(a2(o)+t.r))})}function t9(e,t,r){var n=Ga(t),a=n.s,s=Gr(r),i={r:s.r-a.r,c:s.c-a.c};return Yk(e,i)}function r9(e){return e.length!=1}function pS(e){return e.replace(/_xlfn\./g,"")}function bn(e){e.l+=1}function Yo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Kk(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Xk(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Yo(e),o=Yo(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Xk(e){var t=Yo(e),r=Yo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function n9(e,t,r){if(r.biff<8)return Xk(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Yo(e),i=Yo(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function Jk(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return a9(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Yo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function a9(e){var t=Yo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function s9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function i9(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return o9(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function o9(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function l9(e,t,r){var n=(e[e.l++]&96)>>5,a=Kk(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function c9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Kk(e,s,r);return[n,a,i]}function u9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function d9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function f9(e,t,r){var n=(e[e.l++]&96)>>5,a=n9(e,t-1,r);return[n,a]}function h9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function gS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function m9(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function p9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function g9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function x9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function v9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Zk(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function y9(e){return e.read_shift(2),Zk(e)}function b9(e){return e.read_shift(2),Zk(e)}function w9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Jk(e,0,r);return[n,a]}function S9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=i9(e,0,r);return[n,a]}function _9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Jk(e,0,r);return[n,a,s]}function N9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[kB[a],tC[a],n]}function A9(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:j9(e);return[a,(s[0]===0?tC:jB)[s[1]]]}function j9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function k9(e,t,r){e.l+=r&&r.biff==2?3:4}function C9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function E9(e){return e.l++,ho[e.read_shift(1)]}function T9(e){return e.l++,e.read_shift(2)}function P9(e){return e.l++,e.read_shift(1)!==0}function O9(e){return e.l++,ba(e)}function F9(e,t,r){return e.l++,Sf(e,t-1,r)}function I9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ho[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ba(e);break;case 2:r[1]=ic(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function L9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?sc:ap)(e));return a}function D9(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=I9(e,r.biff);return i}function M9(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function R9(e,t,r){if(r.biff==5)return B9(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function B9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function U9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function z9(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function W9(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var H9=Na,q9=Na,G9=Na;function Nf(e,t,r){return e.l+=2,[s9(e)]}function b2(e){return e.l+=6,[]}var V9=Nf,Y9=b2,K9=b2,X9=Nf;function Qk(e){return e.l+=2,[Sn(e),e.read_shift(2)&1]}var J9=Nf,Z9=Qk,Q9=b2,eB=Nf,tB=Nf,rB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=rB[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function aB(e){return e.l+=2,[e.read_shift(4)]}function sB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function iB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cB(e){return e.l+=4,[0,0]}var xS={1:{n:"PtgExp",f:C9},2:{n:"PtgTbl",f:G9},3:{n:"PtgAdd",f:bn},4:{n:"PtgSub",f:bn},5:{n:"PtgMul",f:bn},6:{n:"PtgDiv",f:bn},7:{n:"PtgPower",f:bn},8:{n:"PtgConcat",f:bn},9:{n:"PtgLt",f:bn},10:{n:"PtgLe",f:bn},11:{n:"PtgEq",f:bn},12:{n:"PtgGe",f:bn},13:{n:"PtgGt",f:bn},14:{n:"PtgNe",f:bn},15:{n:"PtgIsect",f:bn},16:{n:"PtgUnion",f:bn},17:{n:"PtgRange",f:bn},18:{n:"PtgUplus",f:bn},19:{n:"PtgUminus",f:bn},20:{n:"PtgPercent",f:bn},21:{n:"PtgParen",f:bn},22:{n:"PtgMissArg",f:bn},23:{n:"PtgStr",f:F9},26:{n:"PtgSheet",f:sB},27:{n:"PtgEndSheet",f:iB},28:{n:"PtgErr",f:E9},29:{n:"PtgBool",f:P9},30:{n:"PtgInt",f:T9},31:{n:"PtgNum",f:O9},32:{n:"PtgArray",f:h9},33:{n:"PtgFunc",f:N9},34:{n:"PtgFuncVar",f:A9},35:{n:"PtgName",f:M9},36:{n:"PtgRef",f:w9},37:{n:"PtgArea",f:l9},38:{n:"PtgMemArea",f:U9},39:{n:"PtgMemErr",f:H9},40:{n:"PtgMemNoMem",f:q9},41:{n:"PtgMemFunc",f:z9},42:{n:"PtgRefErr",f:$9},43:{n:"PtgAreaErr",f:u9},44:{n:"PtgRefN",f:S9},45:{n:"PtgAreaN",f:f9},46:{n:"PtgMemAreaN",f:oB},47:{n:"PtgMemNoMemN",f:lB},57:{n:"PtgNameX",f:R9},58:{n:"PtgRef3d",f:_9},59:{n:"PtgArea3d",f:c9},60:{n:"PtgRefErr3d",f:W9},61:{n:"PtgAreaErr3d",f:d9},255:{}},uB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dB={1:{n:"PtgElfLel",f:Qk},2:{n:"PtgElfRw",f:eB},3:{n:"PtgElfCol",f:V9},6:{n:"PtgElfRwV",f:tB},7:{n:"PtgElfColV",f:X9},10:{n:"PtgElfRadical",f:J9},11:{n:"PtgElfRadicalS",f:Q9},13:{n:"PtgElfColS",f:Y9},15:{n:"PtgElfColSV",f:K9},16:{n:"PtgElfRadicalLel",f:Z9},25:{n:"PtgList",f:nB},29:{n:"PtgSxName",f:aB},255:{}},fB={0:{n:"PtgAttrNoop",f:cB},1:{n:"PtgAttrSemi",f:v9},2:{n:"PtgAttrIf",f:g9},4:{n:"PtgAttrChoose",f:m9},8:{n:"PtgAttrGoto",f:p9},16:{n:"PtgAttrSum",f:k9},32:{n:"PtgAttrBaxcel",f:gS},33:{n:"PtgAttrBaxcel",f:gS},64:{n:"PtgAttrSpace",f:y9},65:{n:"PtgAttrSpaceSemi",f:b9},128:{n:"PtgAttrIfError",f:x9},255:{}};function Af(e,t,r,n){if(n.biff<8)return Na(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=D9(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=L9(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Na(e,t)),s}function jf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=xS[s]||xS[uB[s]],(s===24||s===25)&&(a=(s===24?dB:fB)[e[e.l+1]]),!a||!a.f?Na(e,t):i.push([a.n,a.f(e,t,r)]);return i}function hB(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var mB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function eC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function vS(e,t,r){var n=eC(e,t,r);return n=="#REF"?n:pB(n,r)}function xa(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,m=0,h,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,v="",b=0,S=e[0].length;b<S;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:v=en(" ",e[0][g][1][1]);break;case 1:v=en("\r",e[0][g][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+v,g=-1}o.push(u+mB[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Pd(_[1][1],i,a),o.push(Od(d,s));break;case"PtgRefN":d=r?Pd(_[1][1],r,a):_[1][1],o.push(Od(d,s));break;case"PtgRef3d":f=_[1][1],d=Pd(_[1][2],i,a),p=vS(n,f,a),o.push(p+"!"+Od(d,s));break;case"PtgFunc":case"PtgFuncVar":var E=_[1][0],P=_[1][1];E||(E=0),E&=127;var N=E==0?[]:o.slice(-E);o.length-=E,P==="User"&&(P=N.shift()),o.push(P+"("+N.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=V5(_[1][1],r?{s:r}:i,a),o.push(Vg(h,a));break;case"PtgArea":h=V5(_[1][1],i,a),o.push(Vg(h,a));break;case"PtgArea3d":f=_[1][1],h=_[1][2],p=vS(n,f,a),o.push(p+"!"+Vg(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var I=(n.names||[])[m-1]||(n[0]||[])[m],k=I?I.Name:"SH33TJSNAME"+String(m);k&&k.slice(0,6)=="_xlfn."&&!a.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var T=_[1][1];m=_[1][2];var q;if(a.biff<=5)T<0&&(T=-T),n[T]&&(q=n[T][m]);else{var F="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][m]&&n[T][m].itab>0&&(F=n.SheetNames[n[T][m].itab-1]+"!"):F=n.SheetNames[m-1]+"!"),n[T]&&n[T][m])F+=n[T][m].Name;else if(n[0]&&n[0][m])F+=n[0][m].Name;else{var j=(eC(n,T,a)||"").split(";;");j[m-1]?F=j[m-1]:F+="SH33TJSERRX"}o.push(F);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var U="(",B=")";if(g>=0){switch(v="",e[0][g][1][0]){case 2:U=en(" ",e[0][g][1][1])+U;break;case 3:U=en("\r",e[0][g][1][1])+U;break;case 4:B=en(" ",e[0][g][1][1])+B;break;case 5:B=en("\r",e[0][g][1][1])+B;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(U+o.pop()+B);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[Mt(d)]){var K=n.sharedf[Mt(d)];o.push(xa(K,i,X,n,a))}else{var ee=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(xa(u[1],i,X,n,a)),ee=!0;break}ee||o.push(_[1])}break;case"PtgArray":o.push("{"+hB(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Y.indexOf(e[0][b][0])==-1){_=e[0][g];var z=!0;switch(_[1][0]){case 4:z=!1;case 0:v=en(" ",_[1][1]);break;case 5:z=!1;case 1:v=en("\r",_[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((z?v:"")+o.pop()+(z?"":v)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function gB(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Na(e,t-2)];var o=jf(e,i,r);return t!==i+a&&(s=Af(e,t-i-a,o,r)),e.l=n,[o,s]}function xB(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Na(e,t-2)];var o=jf(e,i,r);return t!==i+a&&(s=Af(e,t-i-a,o,r)),e.l=n,[o,s]}function vB(e,t,r,n){var a=e.l+t,s=jf(e,n,r),i;return a!==e.l&&(i=Af(e,a-e.l,s,r)),[s,i]}function yB(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=jf(e,s,r);return s==65535?[[],Na(e,t-2)]:(t!==s+2&&(a=Af(e,n-s-2,i,r)),[i,a])}function bB(e){var t;if(qi(e,e.l+6)!==65535)return[ba(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function wB(e){if(e==null){var t=Ge(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return zl(e);return zl(0)}function Zg(e,t,r){var n=e.l+t,a=Ei(e);r.biff==2&&++e.l;var s=bB(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=xB(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function SB(e,t,r,n,a){var s=Wl(t,r,a),i=wB(e.v),o=Ge(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=Ge(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Xn([s,i,o,u]);return f}function sp(e,t,r){var n=e.read_shift(4),a=jf(e,n,r),s=e.read_shift(4),i=s>0?Af(e,s,a,r):null;return[a,i]}var _B=sp,ip=sp,NB=sp,AB=sp,jB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function CB(e){var t="of:="+e.replace(v2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Qg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function EB(e){return e.replace(/\./,"!")}var Id={},eu={},Ld=typeof Map<"u";function w2(e,t,r){var n=0,a=e.length;if(r){if(Ld?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ld?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Ld?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function op(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(va=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Xd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Zh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Il(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function sl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Xi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function rC(e,t,r,n,a,s){try{n.cellNF&&(e.z=Lt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Lt[t]==null&&Xi(j7[t]||"General",t),e.t==="e")e.w=e.w||ho[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wd(e.v);else if(e.t==="d"){var i=In(e.v);(i|0)===i?e.w=i.toString(10):e.w=Wd(i)}else{if(e.v===void 0)return"";e.w=Bl(e.v,eu)}else e.t==="d"?e.w=Os(t,In(e.v),eu):e.w=Os(t,e.v,eu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Jh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Jh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function TB(e,t,r){if(e&&e["!ref"]){var n=ir(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function PB(e,t){var r=ir(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=qt(r))}var OB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,FB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IB=/<(?:\w:)?hyperlink [^>]*>/mg,LB=/"(\w*:\w*)"/,DB=/<(?:\w:)?col\b[^>]*[\/]?>/g,MB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RB=/<(?:\w:)?pageMargins[^>]*\/>/g,nC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zB(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(FB);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var m=u.match(nC);m?S2(m[0],o,a,r):(m=u.match(BB))&&WB(m[0],m[1]||"",o,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=u.slice(h,h+50).match(LB);p&&PB(o,p[1])}var g=u.match(UB);g&&g[1]&&rU(g[1],a);var v=[];if(t.cellStyles){var b=u.match(DB);b&&JB(v,b)}f&&sU(f[1],o,t,c,s,i);var S=d.match(MB);S&&(o["!autofilter"]=QB(S[0]));var _=[],E=d.match(OB);if(E)for(h=0;h!=E.length;++h)_[h]=ir(E[h].slice(E[h].indexOf('"')+1));var P=d.match(IB);P&&YB(o,P,n);var N=d.match(RB);if(N&&(o["!margins"]=KB(Rt(N[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=qt(c)),t.sheetRows>0&&o["!ref"]){var I=ir(o["!ref"]);t.sheetRows<=+I.e.r&&(I.e.r=t.sheetRows-1,I.e.r>c.e.r&&(I.e.r=c.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>c.e.c&&(I.e.c=c.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),o["!fullref"]=o["!ref"],o["!ref"]=qt(I))}return v.length>0&&(o["!cols"]=v),_.length>0&&(o["!merges"]=_),o}function $B(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+qt(e[r])+'"/>';return t+"</mergeCells>"}function S2(e,t,r,n){var a=Rt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=sr(_r(a.codeName)))}function WB(e,t,r,n,a){S2(e.slice(0,e.indexOf(">")),r,n,a)}function HB(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,i.codeName=bi(vr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+it("outlinePr",null,u)}!s&&!o||(a[a.length]=it("sheetPr",o,i))}var qB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],GB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function VB(e){var t={sheet:1};return qB.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),GB.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=p2(e.password).toString(16).toUpperCase()),it("sheetProtection",null,t)}function YB(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Rt(_r(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+sr(s.location))):(s.Target="#"+sr(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ir(s.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Mt({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function KB(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function XB(e){return Il(e),it("pageMargins",null,e)}function JB(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Rt(t[n],!0);a.hidden&&(a.hidden=Fr(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,g2(a.width)),Vo(a);s<=i;)e[s++]=Dr(a)}}function ZB(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=it("col",null,op(a,n)));return r[r.length]="</cols>",r.join("")}function QB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function eU(e,t,r,n){var a=typeof e.ref=="string"?e.ref:qt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Ga(a);i.s.r==i.e.r&&(i.e.r=Ga(t["!ref"]).e.r,a=qt(i));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),it("autoFilter",null,{ref:a})}var tU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function rU(e,t){t.Views||(t.Views=[{}]),(e.match(tU)||[]).forEach(function(r,n){var a=Rt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Fr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function nU(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),it("sheetViews",it("sheetView",null,a),{})}function aU(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ho[e.v];break;case"d":n&&n.cellDates?a=Lr(e.v,-1).toISOString():(e=Dr(e),e.t="n",a=""+(e.v=In(Lr(e.v)))),typeof e.z>"u"&&(e.z=Lt[14]);break;default:a=e.v;break}var o=oa("v",vr(a)),c={r:t},u=sl(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=oa("v",""+w2(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=it("f",vr(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),it("c",o,c)}var sU=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Hd("v"),i=Hd("f");return function(c,u,d,f,m,h){for(var p=0,g="",v=[],b=[],S=0,_=0,E=0,P="",N,I,k=0,T=0,q,F,j=0,U=0,B=Array.isArray(h.CellXf),X,K=[],ee=[],Y=Array.isArray(u),z=[],ne={},le=!1,A=!!d.sheetStubs,D=c.split(t),L=0,M=D.length;L!=M;++L){g=D[L].trim();var R=g.length;if(R!==0){var H=0;e:for(p=0;p<R;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(I=Rt(g.slice(H,p),!0),k=I.r!=null?parseInt(I.r,10):k+1,T=-1,d.sheetRows&&d.sheetRows<k)continue;ne={},le=!1,I.ht&&(le=!0,ne.hpt=parseFloat(I.ht),ne.hpx=uu(ne.hpt)),I.hidden=="1"&&(le=!0,ne.hidden=!0),I.outlineLevel!=null&&(le=!0,ne.level=+I.outlineLevel),le&&(z[k-1]=ne)}break;case"<":H=p;break}if(H>=p)break;if(I=Rt(g.slice(H,p),!0),k=I.r!=null?parseInt(I.r,10):k+1,T=-1,!(d.sheetRows&&d.sheetRows<k)){f.s.r>k-1&&(f.s.r=k-1),f.e.r<k-1&&(f.e.r=k-1),d&&d.cellStyles&&(ne={},le=!1,I.ht&&(le=!0,ne.hpt=parseFloat(I.ht),ne.hpx=uu(ne.hpt)),I.hidden=="1"&&(le=!0,ne.hidden=!0),I.outlineLevel!=null&&(le=!0,ne.level=+I.outlineLevel),le&&(z[k-1]=ne)),v=g.slice(p).split(e);for(var J=0;J!=v.length&&v[J].trim().charAt(0)=="<";++J);for(v=v.slice(J),p=0;p!=v.length;++p)if(g=v[p].trim(),g.length!==0){if(b=g.match(r),S=p,_=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(S=0,P=b[1],_=0;_!=P.length&&!((E=P.charCodeAt(_)-64)<1||E>26);++_)S=26*S+E;--S,T=S}else++T;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,I=Rt(g.slice(0,_),!0),I.r||(I.r=Mt({r:k-1,c:T})),P=g.slice(_),N={t:""},(b=P.match(s))!=null&&b[1]!==""&&(N.v=sr(b[1])),d.cellFormula){if((b=P.match(i))!=null&&b[1]!==""){if(N.f=sr(_r(b[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=pS(N.f)),b[0].indexOf('t="array"')>-1)N.F=(P.match(a)||[])[1],N.F.indexOf(":")>-1&&K.push([ir(N.F),N.F]);else if(b[0].indexOf('t="shared"')>-1){F=Rt(b[0]);var G=sr(_r(b[1]));d.xlfn||(G=pS(G)),ee[parseInt(F.si,10)]=[F,G,I.r]}}else(b=P.match(/<f[^>]*\/>/))&&(F=Rt(b[0]),ee[F.si]&&(N.f=t9(ee[F.si][1],ee[F.si][2],I.r)));var Q=Gr(I.r);for(_=0;_<K.length;++_)Q.r>=K[_][0].s.r&&Q.r<=K[_][0].e.r&&Q.c>=K[_][0].s.c&&Q.c<=K[_][0].e.c&&(N.F=K[_][1])}if(I.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(A)N.t="z";else continue;else N.t=I.t||"n";switch(f.s.c>T&&(f.s.c=T),f.e.c<T&&(f.e.c=T),N.t){case"n":if(N.v==""||N.v==null){if(!A)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!A)continue;N.t="z"}else q=Id[parseInt(N.v,10)],N.v=q.t,N.r=q.r,d.cellHTML&&(N.h=q.h);break;case"str":N.t="s",N.v=N.v!=null?_r(N.v):"",d.cellHTML&&(N.h=e2(N.v));break;case"inlineStr":b=P.match(n),N.t="s",b!=null&&(q=m2(b[1]))?(N.v=q.t,d.cellHTML&&(N.h=q.h)):N.v="";break;case"b":N.v=Fr(N.v);break;case"d":d.cellDates?N.v=Lr(N.v,1):(N.v=In(Lr(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=sk[N.v];break}if(j=U=0,X=null,B&&I.s!==void 0&&(X=h.CellXf[I.s],X!=null&&(X.numFmtId!=null&&(j=X.numFmtId),d.cellStyles&&X.fillId!=null&&(U=X.fillId))),rC(N,j,U,d,m,h),d.cellDates&&B&&N.t=="n"&&yu(Lt[j])&&(N.t="d",N.v=np(N.v)),I.cm&&d.xlmeta){var de=(d.xlmeta.Cell||[])[+I.cm-1];de&&de.type=="XLDAPR"&&(N.D=!0)}if(Y){var V=Gr(I.r);u[V.r]||(u[V.r]=[]),u[V.r][V.c]=N}else u[I.r]=N}}}}z.length>0&&(u["!rows"]=z)}})();function iU(e,t,r,n){var a=[],s=[],i=ir(e["!ref"]),o="",c,u="",d=[],f=0,m=0,h=e["!rows"],p=Array.isArray(e),g={r:u},v,b=-1;for(m=i.s.c;m<=i.e.c;++m)d[m]=qr(m);for(f=i.s.r;f<=i.e.r;++f){for(s=[],u=mn(f),m=i.s.c;m<=i.e.c;++m){c=d[m]+u;var S=p?(e[f]||[])[m]:e[c];S!==void 0&&(o=aU(S,c,e,t))!=null&&s.push(o)}(s.length>0||h&&h[f])&&(g={r:u},h&&h[f]&&(v=h[f],v.hidden&&(g.hidden=1),b=-1,v.hpx?b=Jd(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(g.ht=b,g.customHeight=1),v.level&&(g.outlineLevel=v.level)),a[a.length]=it("row",s.join(""),g))}if(h)for(;f<h.length;++f)h&&h[f]&&(g={r:f+1},v=h[f],v.hidden&&(g.hidden=1),b=-1,v.hpx?b=Jd(v.hpx):v.hpt&&(b=v.hpt),b>-1&&(g.ht=b,g.customHeight=1),v.level&&(g.outlineLevel=v.level),a[a.length]=it("row","",g));return a.join("")}function aC(e,t,r,n){var a=[pn,it("worksheet",null,{xmlns:tc[0],"xmlns:r":On.r})],s=r.SheetNames[e],i=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=ir(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=qt(d)}n||(n={}),c["!comments"]=[];var f=[];HB(c,r,e,t,a),a[a.length]=it("dimension",null,{ref:u}),a[a.length]=nU(c,t,e,r),t.sheetFormat&&(a[a.length]=it("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=ZB(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=iU(c,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=VB(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=eU(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=$B(c["!merges"]));var m=-1,h,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=gr(n,-1,vr(g[1].Target).replace(/#.*$/,""),Kt.HLINK),h["r:id"]="rId"+p),(m=g[1].Target.indexOf("#"))>-1&&(h.location=vr(g[1].Target.slice(m+1))),g[1].Tooltip&&(h.tooltip=vr(g[1].Tooltip)),a[a.length]=it("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=XB(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=oa("ignoredErrors",it("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=gr(n,-1,"../drawings/drawing"+(e+1)+".xml",Kt.DRAW),a[a.length]=it("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=gr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Kt.VML),a[a.length]=it("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function oU(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function lU(e,t,r){var n=Ge(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Jd(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,m=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Mt(u)];p&&(f<0&&(f=h),m=h)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,m))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function cU(e,t,r,n){var a=lU(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ze(e,0,a)}var uU=sc,dU=Su;function fU(){}function hU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=gI(e),r}function mU(e,t,r){r==null&&(r=Ge(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Yh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ek(e,r),r.slice(0,r.l)}function pU(e){var t=Ls(e);return[t]}function gU(e,t,r){return r==null&&(r=Ge(8)),rc(t,r)}function xU(e){var t=nc(e);return[t]}function vU(e,t,r){return r==null&&(r=Ge(4)),ac(t,r)}function yU(e){var t=Ls(e),r=e.read_shift(1);return[t,r,"b"]}function bU(e,t,r){return r==null&&(r=Ge(9)),rc(t,r),r.write_shift(1,e.v?1:0),r}function wU(e){var t=nc(e),r=e.read_shift(1);return[t,r,"b"]}function SU(e,t,r){return r==null&&(r=Ge(5)),ac(t,r),r.write_shift(1,e.v?1:0),r}function _U(e){var t=Ls(e),r=e.read_shift(1);return[t,r,"e"]}function NU(e,t,r){return r==null&&(r=Ge(9)),rc(t,r),r.write_shift(1,e.v),r}function AU(e){var t=nc(e),r=e.read_shift(1);return[t,r,"e"]}function jU(e,t,r){return r==null&&(r=Ge(8)),ac(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kU(e){var t=Ls(e),r=e.read_shift(4);return[t,r,"s"]}function CU(e,t,r){return r==null&&(r=Ge(12)),rc(t,r),r.write_shift(4,t.v),r}function EU(e){var t=nc(e),r=e.read_shift(4);return[t,r,"s"]}function TU(e,t,r){return r==null&&(r=Ge(8)),ac(t,r),r.write_shift(4,t.v),r}function PU(e){var t=Ls(e),r=ba(e);return[t,r,"n"]}function OU(e,t,r){return r==null&&(r=Ge(16)),rc(t,r),zl(e.v,r),r}function sC(e){var t=nc(e),r=ba(e);return[t,r,"n"]}function FU(e,t,r){return r==null&&(r=Ge(12)),ac(t,r),zl(e.v,r),r}function IU(e){var t=Ls(e),r=c2(e);return[t,r,"n"]}function LU(e,t,r){return r==null&&(r=Ge(12)),rc(t,r),tk(e.v,r),r}function DU(e){var t=nc(e),r=c2(e);return[t,r,"n"]}function MU(e,t,r){return r==null&&(r=Ge(8)),ac(t,r),tk(e.v,r),r}function RU(e){var t=Ls(e),r=i2(e);return[t,r,"is"]}function BU(e){var t=Ls(e),r=Sa(e);return[t,r,"str"]}function UU(e,t,r){return r==null&&(r=Ge(12+4*e.v.length)),rc(t,r),Jn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zU(e){var t=nc(e),r=Sa(e);return[t,r,"str"]}function $U(e,t,r){return r==null&&(r=Ge(8+4*e.v.length)),ac(t,r),Jn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WU(e,t,r){var n=e.l+t,a=Ls(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=ip(e,n-e.l,r);i[3]=xa(o,null,a,r.supbooks,r)}else e.l=n;return i}function HU(e,t,r){var n=e.l+t,a=Ls(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=ip(e,n-e.l,r);i[3]=xa(o,null,a,r.supbooks,r)}else e.l=n;return i}function qU(e,t,r){var n=e.l+t,a=Ls(e);a.r=r["!row"];var s=ba(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=ip(e,n-e.l,r);i[3]=xa(o,null,a,r.supbooks,r)}else e.l=n;return i}function GU(e,t,r){var n=e.l+t,a=Ls(e);a.r=r["!row"];var s=Sa(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=ip(e,n-e.l,r);i[3]=xa(o,null,a,r.supbooks,r)}else e.l=n;return i}var VU=sc,YU=Su;function KU(e,t){return t==null&&(t=Ge(4)),t.write_shift(4,e),t}function XU(e,t){var r=e.l+t,n=sc(e),a=o2(e),s=Sa(e),i=Sa(e),o=Sa(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function JU(e,t){var r=Ge(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Su({s:Gr(e[0]),e:Gr(e[0])},r),l2("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Jn(a||"",r),Jn(e[1].Tooltip||"",r),Jn("",r),r.slice(0,r.l)}function ZU(){}function QU(e,t,r){var n=e.l+t,a=rk(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=_B(e,n-e.l,r);i[1]=o}else e.l=n;return i}function ez(e,t,r){var n=e.l+t,a=sc(e),s=[a];if(r.cellFormula){var i=AB(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function tz(e,t,r){r==null&&(r=Ge(18));var n=op(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var iC=["left","right","top","bottom","header","footer"];function rz(e){var t={};return iC.forEach(function(r){t[r]=ba(e)}),t}function nz(e,t){return t==null&&(t=Ge(48)),Il(e),iC.forEach(function(r){zl(e[r],t)}),t}function az(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sz(e,t,r){r==null&&(r=Ge(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iz(e){var t=Ge(24);return t.write_shift(4,4),t.write_shift(4,1),Su(e,t),t}function oz(e,t){return t==null&&(t=Ge(66)),t.write_shift(2,e.password?p2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lz(){}function cz(){}function uz(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,h,p,g,v,b,S,_,E,P,N=[];o.biff=12,o["!row"]=0;var I=0,k=!1,T=[],q={},F=o.supbooks||a.supbooks||[[]];if(F.sharedf=q,F.arrayf=T,F.SheetNames=a.SheetNames||a.Sheets.map(function(Y){return Y.name}),!o.supbooks&&(o.supbooks=F,a.Names))for(var j=0;j<a.Names.length;++j)F[0][j+1]=a.Names[j];var U=[],B=[],X=!1;Zd[16]={n:"BrtShortReal",f:sC};var K;if(fo(e,function(z,ne,le){if(!m)switch(le){case 148:u=z;break;case 0:h=z,o.sheetRows&&o.sheetRows<=h.r&&(m=!0),E=mn(v=h.r),o["!row"]=h.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=uu(z.hpt)),B[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:z[2]},z[2]){case"n":p.v=z[1];break;case"s":_=Id[z[1]],p.v=_.t,p.r=_.r;break;case"b":p.v=!!z[1];break;case"e":p.v=z[1],o.cellText!==!1&&(p.w=ho[p.v]);break;case"str":p.t="s",p.v=z[1];break;case"is":p.t="s",p.v=z[1].t;break}if((g=i.CellXf[z[0].iStyleRef])&&rC(p,g.numFmtId,null,o,s,i),b=z[0].c==-1?b+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][b]=p):c[qr(b)+E]=p,o.cellFormula){for(k=!1,I=0;I<T.length;++I){var A=T[I];h.r>=A[0].s.r&&h.r<=A[0].e.r&&b>=A[0].s.c&&b<=A[0].e.c&&(p.F=qt(A[0]),k=!0)}!k&&z.length>3&&(p.f=z[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),o.cellDates&&g&&p.t=="n"&&yu(Lt[g.numFmtId])){var D=jl(p.v);D&&(p.t="d",p.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},b=z[0].c==-1?b+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][b]=p):c[qr(b)+E]=p,d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),K&&(K.type=="XLDAPR"&&(p.D=!0),K=void 0);break;case 176:N.push(z);break;case 49:K=((o.xlmeta||{}).Cell||[])[z-1];break;case 494:var L=n["!id"][z.relId];for(L?(z.Target=L.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=L):z.relId==""&&(z.Target="#"+z.loc),v=z.rfx.s.r;v<=z.rfx.e.r;++v)for(b=z.rfx.s.c;b<=z.rfx.e.c;++b)o.dense?(c[v]||(c[v]=[]),c[v][b]||(c[v][b]={t:"z",v:void 0}),c[v][b].l=z):(S=Mt({c:b,r:v}),c[S]||(c[S]={t:"z",v:void 0}),c[S].l=z);break;case 426:if(!o.cellFormula)break;T.push(z),P=o.dense?c[v][b]:c[qr(b)+E],P.f=xa(z[1],d,{r:h.r,c:b},F,o),P.F=qt(z[0]);break;case 427:if(!o.cellFormula)break;q[Mt(z[0].s)]=z[1],P=o.dense?c[v][b]:c[qr(b)+E],P.f=xa(z[1],d,{r:h.r,c:b},F,o);break;case 60:if(!o.cellStyles)break;for(;z.e>=z.s;)U[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},X||(X=!0,g2(z.w/256)),Vo(U[z.e+1]);break;case 161:c["!autofilter"]={ref:qt(z)};break;case 476:c["!margins"]=z;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),z.name&&(a.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),z.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ne.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=qt(u||d)),o.sheetRows&&c["!ref"]){var ee=ir(c["!ref"]);o.sheetRows<=+ee.e.r&&(ee.e.r=o.sheetRows-1,ee.e.r>d.e.r&&(ee.e.r=d.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>d.e.c&&(ee.e.c=d.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),c["!fullref"]=c["!ref"],c["!ref"]=qt(ee))}return N.length>0&&(c["!merges"]=N),U.length>0&&(c["!cols"]=U),B.length>0&&(c["!rows"]=B),c}function dz(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Dr(t),t.z=t.z||Lt[14],t.v=In(Lr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=sl(a.cellXfs,t,a),t.l&&s["!links"].push([Mt(c),t.l]),t.c&&s["!comments"].push([Mt(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=w2(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,i?Ze(e,18,TU(t,c)):Ze(e,7,CU(t,c))):(c.t="str",i?Ze(e,17,$U(t,c)):Ze(e,6,UU(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Ze(e,13,MU(t,c)):Ze(e,2,LU(t,c)):i?Ze(e,16,FU(t,c)):Ze(e,5,OU(t,c)),!0;case"b":return c.t="b",i?Ze(e,15,SU(t,c)):Ze(e,4,bU(t,c)),!0;case"e":return c.t="e",i?Ze(e,14,jU(t,c)):Ze(e,3,NU(t,c)),!0}return i?Ze(e,12,vU(t,c)):Ze(e,1,gU(t,c)),!0}function fz(e,t,r,n){var a=ir(t["!ref"]||"A1"),s,i="",o=[];Ze(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){i=mn(d),cU(e,t,a,d);var f=!1;if(d<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){d===a.s.r&&(o[m]=qr(m)),s=o[m]+i;var h=c?(t[d]||[])[m]:t[s];if(!h){f=!1;continue}f=dz(e,h,d,m,n,t,f)}}Ze(e,146)}function hz(e,t){!t||!t["!merges"]||(Ze(e,177,KU(t["!merges"].length)),t["!merges"].forEach(function(r){Ze(e,176,YU(r))}),Ze(e,178))}function mz(e,t){!t||!t["!cols"]||(Ze(e,390),t["!cols"].forEach(function(r,n){r&&Ze(e,60,tz(n,r))}),Ze(e,391))}function pz(e,t){!t||!t["!ref"]||(Ze(e,648),Ze(e,649,iz(ir(t["!ref"]))),Ze(e,650))}function gz(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=gr(r,-1,n[1].Target.replace(/#.*$/,""),Kt.HLINK);Ze(e,494,JU(n,a))}}),delete t["!links"]}function xz(e,t,r,n){if(t["!comments"].length>0){var a=gr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Kt.VML);Ze(e,551,l2("rId"+a)),t["!legacy"]=a}}function vz(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:qt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Ga(s);o.s.r==o.e.r&&(o.e.r=Ga(t["!ref"]).e.r,s=qt(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ze(e,161,Su(ir(s))),Ze(e,162)}}function yz(e,t,r){Ze(e,133),Ze(e,137,sz(t,r)),Ze(e,138),Ze(e,134)}function bz(e,t){t["!protect"]&&Ze(e,535,oz(t["!protect"]))}function wz(e,t,r,n){var a=qa(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=ir(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ze(a,129),(r.vbaraw||i["!outline"])&&Ze(a,147,mU(o,i["!outline"])),Ze(a,148,dU(c)),yz(a,i,r.Workbook),mz(a,i),fz(a,i,e,t),bz(a,i),vz(a,i,r,e),hz(a,i),gz(a,i,n),i["!margins"]&&Ze(a,476,nz(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&pz(a,i),xz(a,i,e,n),Ze(a,130),a.end()}function Sz(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=sr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function _z(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=Sz(f);d.s.r=d.s.c=0,d.e.c=o,u=qr(o),m[0].forEach(function(h,p){i[u+mn(p)]={t:"n",v:h,z:m[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=qt(d)),i}function Nz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(nC);return o&&S2(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Az(e,t){e.l+=10;var r=Sa(e);return{name:r}}function jz(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return fo(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var _2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Cz=[],Ez=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bS(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Fr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function wS(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Fr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function oC(e){wS(e.WBProps,_2),wS(e.CalcPr,Ez),bS(e.WBView,kz),bS(e.Sheets,Cz),eu.date1904=Fr(e.WBProps.date1904)}function Tz(e){return!e.Workbook||!e.Workbook.WBProps?"false":Fr(e.Workbook.WBProps.date1904)?"true":"false"}var Pz="][*?/\\".split("");function lC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Pz.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Oz(e,t,r){e.forEach(function(n,a){lC(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Fz(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Oz(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)TB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Iz=/<\w+:workbook/;function Lz(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Aa,function(c,u){var d=Rt(c);switch(Ci(d[0])){case"<?xml":break;case"<workbook":c.match(Iz)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_2.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Fr(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=_r(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=sr(_r(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=_r(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Fr(d.hidden||"0")&&(s.Hidden=!0),i=u+c.length;break;case"</definedName>":s.Ref=sr(_r(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),tc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return oC(r),r}function cC(e){var t=[pn];t[t.length]=it("workbook",null,{xmlns:tc[0],"xmlns:r":On.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(_2.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=it("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:vr(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=it("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=it("definedName",vr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Dz(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ov(e),r.name=Sa(e),r}function Mz(e,t){return t||(t=Ge(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),l2(e.strRelID,t),Jn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Rz(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Sa(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Bz(e,t){t||(t=Ge(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ek(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Uz(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function zz(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=xI(e),i=NB(e,0,r),o=o2(e);e.l=n;var c={Name:s,Ptg:i};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function $z(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Zd[16]={n:"BrtFRTArchID$",f:Uz},fo(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=xa(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),oC(r),r.Names=s,r.supbooks=i,r}function Wz(e,t){Ze(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ze(e,156,Mz(a))}Ze(e,144)}function Hz(e,t){t||(t=Ge(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Jn("SheetJS",t),Jn(zh.version,t),Jn(zh.version,t),Jn("7262",t),t.length>t.l?t.slice(0,t.l):t}function qz(e,t){t||(t=Ge(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Gz(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Ze(e,135),Ze(e,158,qz(a)),Ze(e,136))}}function Vz(e,t){var r=qa();return Ze(r,131),Ze(r,128,Hz()),Ze(r,153,Bz(e.Workbook&&e.Workbook.WBProps||null)),Gz(r,e),Wz(r,e),Ze(r,132),r.end()}function Yz(e,t,r){return t.slice(-4)===".bin"?$z(e,r):Lz(e,r)}function Kz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?uz(e,n,r,a,s,i,o):zB(e,n,r,a,s,i,o)}function Xz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?jz(e,n,r,a,s):Nz(e,n,r,a,s)}function Jz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?QR():e9()}function Zz(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?JR():ZR()}function Qz(e,t,r,n){return t.slice(-4)===".bin"?YM(e,r,n):DM(e,r,n)}function e$(e,t,r){return Wk(e,r)}function t$(e,t,r){return t.slice(-4)===".bin"?tM(e,r):ZD(e,r)}function r$(e,t,r){return t.slice(-4)===".bin"?GR(e,r):MR(e,r)}function n$(e,t,r){return t.slice(-4)===".bin"?IR(e):OR(e)}function a$(e,t,r,n){return r.slice(-4)===".bin"?LR(e,t,r,n):void 0}function s$(e,t,r){return t.slice(-4)===".bin"?ER(e,t,r):PR(e,t,r)}function i$(e,t,r){return(t.slice(-4)===".bin"?Vz:cC)(e)}function o$(e,t,r,n,a){return(t.slice(-4)===".bin"?wz:aC)(e,r,n,a)}function l$(e,t,r){return(t.slice(-4)===".bin"?aR:zk)(e,r)}function c$(e,t,r){return(t.slice(-4)===".bin"?aM:Fk)(e,r)}function u$(e,t,r){return(t.slice(-4)===".bin"?VR:Gk)(e)}function d$(e){return(e.slice(-4)===".bin"?TR:Hk)()}var uC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hs(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(uC),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(dC),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function f$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(uC),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(dC),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Dd;function h$(e,t){var r=Dd[e]||sr(e);return r==="General"?Bl(t):Os(r,t)}function m$(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Fr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Lr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[sr(t)]=a}function p$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ho[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wd(e.v):e.w=Bl(e.v):e.w=h$(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Dd[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&yu(n)){var a=jl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function g$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=CM[n.Pattern]||n.Pattern)}e[t.ID]=t}function x$(e,t,r,n,a,s,i,o,c,u){var d="General",f=n.StyleID,m={};u=u||{};var h=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Fr(e);break;case"String":n.t="s",n.r=R5(sr(e)),n.v=e.indexOf("<")>-1?sr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Lr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=sr(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sk[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=R5(t||e));break}if(p$(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=sr(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Qc(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Qc("RC:RC",a):n.ArrayRange&&(n.F=Qc(n.ArrayRange,a),c.push([ir(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);u.cellStyles&&(h.forEach(function(v){!m.patternType&&v.patternType&&(m.patternType=v.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function v$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ex(e,t){var r=t||{};bu();var n=Nd(t2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=_r(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Dr(r);return i.type="string",cu.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ge){a.indexOf("<"+ge)>=0&&(s=!0)}),s)return nW(n,r);Dd={"General Number":"General","General Date":Lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Lt[15],"Short Date":Lt[14],"Long Time":Lt[19],"Medium Time":Lt[18],"Short Time":Lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Lt[2],Standard:Lt[4],Percent:Lt[10],Scientific:Lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],m=r.dense?[]:{},h="",p={},g={},v=Hs('<Data ss:Type="String">'),b=0,S=0,_=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},N={},I="",k=0,T=[],q={},F={},j=0,U=[],B=[],X={},K=[],ee,Y=!1,z=[],ne=[],le={},A=0,D=0,L={Sheets:[],WBProps:{date1904:!1}},M={};Gd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";o=Gd.exec(n);)switch(o[3]=(R=o[3]).toLowerCase()){case"data":if(R=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?x$(n.slice(b,o.index),I,v,c[c.length-1][0]=="comment"?X:p,{c:S,r:_},P,K[S],g,z,r):(I="",v=Hs(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(B.length>0&&(p.c=B),(!r.sheetRows||r.sheetRows>_)&&p.v!==void 0&&(r.dense?(m[_]||(m[_]=[]),m[_][S]=p):m[qr(S)+mn(_)]=p),p.HRef&&(p.l={Target:sr(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(A=S+(parseInt(p.MergeAcross,10)|0),D=_+(parseInt(p.MergeDown,10)|0),T.push({s:{c:S,r:_},e:{c:A,r:D}})),!r.sheetStubs)p.MergeAcross?S=A+1:++S;else if(p.MergeAcross||p.MergeDown){for(var H=S;H<=A;++H)for(var J=_;J<=D;++J)(H>S||J>_)&&(r.dense?(m[J]||(m[J]=[]),m[J][H]={t:"z"}):m[qr(H)+mn(J)]={t:"z"});S=A+1}else++S;else p=f$(o[0]),p.Index&&(S=+p.Index-1),S<E.s.c&&(E.s.c=S),S>E.e.c&&(E.e.c=S),o[0].slice(-2)==="/>"&&++S,B=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<E.s.r&&(E.s.r=_),_>E.e.r&&(E.e.r=_),o[0].slice(-2)==="/>"&&(g=Hs(o[0]),g.Index&&(_=+g.Index-1)),S=0,++_):(g=Hs(o[0]),g.Index&&(_=+g.Index-1),le={},(g.AutoFitHeight=="0"||g.Height)&&(le.hpx=parseInt(g.Height,10),le.hpt=Jd(le.hpx),ne[_]=le),g.Hidden=="1"&&(le.hidden=!0,ne[_]=le));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(h),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(m["!ref"]=qt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=qt(E))),T.length&&(m["!merges"]=T),K.length>0&&(m["!cols"]=K),ne.length>0&&(m["!rows"]=ne),d[h]=m}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=S=0,c.push([o[3],!1]),u=Hs(o[0]),h=sr(u.Name),m=r.dense?[]:{},T=[],z=[],ne=[],M={name:h,Hidden:0},L.Sheets.push(M);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),K=[],Y=!1}break;case"style":o[1]==="/"?g$(P,N,r):N=Hs(o[0]);break;case"numberformat":N.nf=sr(Hs(o[0]).Format||"General"),Dd[N.nf]&&(N.nf=Dd[N.nf]);for(var G=0;G!=392&&Lt[G]!=N.nf;++G);if(G==392){for(G=57;G!=392;++G)if(Lt[G]==null){Xi(N.nf,G);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ee=Hs(o[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!Y&&ee.wpx>10){Y=!0,va=Bk;for(var Q=0;Q<K.length;++Q)K[Q]&&Vo(K[Q])}Y&&Vo(ee),K[ee.Index-1||K.length]=ee;for(var de=0;de<+ee.Span;++de)K[K.length]=Dr(ee);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var V=Rt(o[0]),Ee={Name:V.Name,Ref:Qc(V.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Ee.Sheet=L.Sheets.length-1),L.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?I+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Hs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$I(q,R,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));v$(X),B.push(X)}else c.push([o[3],!1]),u=Hs(o[0]),X={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var we=Hs(o[0]);m["!autofilter"]={ref:Qc(we.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return jS(n,r);var he=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:he=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:he=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:he=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:he=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else j=o.index+o[0].length;break;case"header":m["!margins"]||Il(m["!margins"]={},"xlml"),isNaN(+Rt(o[0]).Margin)||(m["!margins"].header=+Rt(o[0]).Margin);break;case"footer":m["!margins"]||Il(m["!margins"]={},"xlml"),isNaN(+Rt(o[0]).Margin)||(m["!margins"].footer=+Rt(o[0]).Margin);break;case"pagemargins":var Z=Rt(o[0]);m["!margins"]||Il(m["!margins"]={},"xlml"),isNaN(+Z.Top)||(m["!margins"].top=+Z.Top),isNaN(+Z.Left)||(m["!margins"].left=+Z.Left),isNaN(+Z.Right)||(m["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(m["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:he=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:he=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:he=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:he=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:he=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:he=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:he=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:he=!1}break;case"smarttags":break;default:he=!1;break}if(he||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?m$(F,R,U,n.slice(j,o.index)):(U=o,j=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=d),Se.SheetNames=f,Se.Workbook=L,Se.SSF=Dr(Lt),Se.Props=q,Se.Custprops=F,Se}function mv(e,t){switch(A2(t=t||{}),t.type||"base64"){case"base64":return ex(us(e),t);case"binary":case"buffer":case"file":return ex(e,t);case"array":return ex(nl(e),t)}}function y$(e,t){var r=[];return e.Props&&r.push(WI(e.Props,t)),e.Custprops&&r.push(HI(e.Props,e.Custprops)),r.join("")}function b$(){return""}function w$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(it("NumberFormat",null,{"ss:Format":vr(Lt[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(it("Style",s.join(""),i))}),it("Styles",r.join(""))}function fC(e){return it("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+y2(e.Ref,{r:0,c:0})})}function S$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(fC(a)))}return it("Names",r.join(""))}function _$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(fC(o)))}return s.join("")}function N$(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(it("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(it("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(it("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(it("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(oa("ProtectContents","True")),e["!protect"].objects&&a.push(oa("ProtectObjects","True")),e["!protect"].scenarios&&a.push(oa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(oa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(oa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":it("WorksheetOptions",a.join(""),{xmlns:rs.x})}function A$(e){return e.map(function(t){var r=G7(t.t||""),n=it("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return it("Comment",n,{"ss:Author":t.a})}).join("")}function j$(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+vr(y2(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Gr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=vr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=vr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=ho[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Lt[14]);break;case"s":f="String",m=q7(e.v||"");break}var h=sl(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=i.c+1;var p=e.v!=null?m:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=A$(e.c)),it("Cell",g,o)}function k$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=uu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function C$(e,t,r,n){if(!e["!ref"])return"";var a=ir(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,b){Vo(v);var S=!!v.width,_=op(b,v),E={"ss:Index":b+1};S&&(E["ss:Width"]=Kd(_.width)),v.hidden&&(E["ss:Hidden"]="1"),o.push(it("Column",null,E))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[k$(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var m=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>f)&&!(s[i].s.r>u)&&!(s[i].e.c<f)&&!(s[i].e.r<u)){(s[i].s.c!=f||s[i].s.r!=u)&&(m=!0);break}if(!m){var h={r:u,c:f},p=Mt(h),g=c?(e[u]||[])[f]:e[p];d.push(j$(g,p,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function E$(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?_$(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?C$(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(N$(s,t,e,r)),n.join("")}function T$(e,t){t||(t={}),e.SSF||(e.SSF=Dr(Lt)),e.SSF&&(bu(),ep(e.SSF),t.revssf=rp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],sl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(y$(e,t)),r.push(b$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(it("Worksheet",E$(n,t,e),{"ss:Name":vr(e.SheetNames[n])}));return r[2]=w$(e,t),r[3]=S$(e),pn+it("Workbook",r.join(""),{xmlns:rs.ss,"xmlns:o":rs.o,"xmlns:x":rs.x,"xmlns:ss":rs.ss,"xmlns:dt":rs.dt,"xmlns:html":rs.html})}function P$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=SI(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=_I(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var O$=[60,1084,2066,2165,2175];function F$(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var c=qi(r,r.l),u=pv[c],d=0;u!=null&&O$.indexOf(c)>-1;)s=qi(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,u=pv[c=qi(r,r.l)];var f=Xn(i);ia(f,0);var m=0;f.lens=[];for(var h=0;h<i.length;++h)f.lens.push(m),m+=i[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function hi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Lt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ho[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wd(e.v):e.w=Bl(e.v):e.w=Os(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&yu(Lt[n]||String(n))){var a=jl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function rh(e,t,r){return{v:e,ixfe:t,t:r}}function I$(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,c=[],u="",d={},f,m="",h,p,g,v,b={},S=[],_,E,P=[],N=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},T=function(lt){return lt<8?Pl[lt]:lt<64&&N[lt-8]||Pl[lt]},q=function(lt,rt,Zt){var jt=rt.XF.data;if(!(!jt||!jt.patternType||!Zt||!Zt.cellStyles)){rt.s={},rt.s.patternType=jt.patternType;var Mr;(Mr=Yd(T(jt.icvFore)))&&(rt.s.fgColor={rgb:Mr}),(Mr=Yd(T(jt.icvBack)))&&(rt.s.bgColor={rgb:Mr})}},F=function(lt,rt,Zt){if(!(le>1)&&!(Zt.sheetRows&&lt.r>=Zt.sheetRows)){if(Zt.cellStyles&&rt.XF&&rt.XF.data&&q(lt,rt,Zt),delete rt.ixfe,delete rt.XF,f=lt,m=Mt(lt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<i.s.r&&(i.s.r=lt.r),lt.c<i.s.c&&(i.s.c=lt.c),lt.r+1>i.e.r&&(i.e.r=lt.r+1),lt.c+1>i.e.c&&(i.e.c=lt.c+1),Zt.cellFormula&&rt.f){for(var jt=0;jt<S.length;++jt)if(!(S[jt][0].s.c>lt.c||S[jt][0].s.r>lt.r)&&!(S[jt][0].e.c<lt.c||S[jt][0].e.r<lt.r)){rt.F=qt(S[jt][0]),(S[jt][0].s.c!=lt.c||S[jt][0].s.r!=lt.r)&&delete rt.f,rt.f&&(rt.f=""+xa(S[jt][1],i,lt,z,j));break}}Zt.dense?(a[lt.r]||(a[lt.r]=[]),a[lt.r][lt.c]=rt):a[m]=rt}},j={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var U,B=[],X=[],K=[],ee=[],Y=!1,z=[];z.SheetNames=j.snames,z.sharedf=j.sharedf,z.arrayf=j.arrayf,z.names=[],z.XTI=[];var ne=0,le=0,A=0,D=[],L=[],M;j.codepage=1200,Js(1200);for(var R=!1;e.l<e.length-1;){var H=e.l,J=e.read_shift(2);if(J===0&&ne===10)break;var G=e.l===e.length?0:e.read_shift(2),Q=pv[J];if(Q&&Q.f){if(t.bookSheets&&ne===133&&J!==133)break;if(ne=J,Q.r===2||Q.r==12){var de=e.read_shift(2);if(G-=2,!j.enc&&de!==J&&((de&255)<<8|de>>8)!==J)throw new Error("rt mismatch: "+de+"!="+J);Q.r==12&&(e.l+=10,G-=10)}var V={};if(J===10?V=Q.f(e,G,j):V=F$(J,Q,e,G,j),le==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(J){case 34:r.opts.Date1904=I.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=V;break;case 66:var Ee=Number(V);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}Js(j.codepage=Ee),R=!0;break;case 317:j.rrtabid=V;break;case 25:j.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:j.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:P.push(V);break;case 430:z.push([V]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(V);break;case 24:case 536:M={Name:V.Name,Ref:xa(V.rgce,i,null,z,j)},V.itab>0&&(M.Sheet=V.itab-1),z.names.push(M),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(L[V.itab-1]={ref:qt(V.rgce[0][0][1][2])});break;case 22:j.ExternCount=V;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(V),z.XTI=z.XTI.concat(V);break;case 2196:if(j.biff<8)break;M!=null&&(M.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&j.WTF&&console.error("Password verifier: "+V);break;case 133:s[V.pos]=V,j.snames.push(V.name);break;case 10:{if(--le)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=qt(i),t.sheetRows&&t.sheetRows<=i.e.r){var we=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=qt(i),i.e.r=we}i.e.r++,i.e.c++}B.length>0&&(a["!merges"]=B),X.length>0&&(a["!objects"]=X),K.length>0&&(a["!cols"]=K),ee.length>0&&(a["!rows"]=ee),I.Sheets.push(k)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),j.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(j.biff=5,R=!0,Js(j.codepage=28591)),j.biff==8&&V.BIFFVer==0&&V.dt==16&&(j.biff=2),le++)break;if(a=t.dense?[]:{},j.biff<8&&!R&&(R=!0,Js(j.codepage=t.codepage||1252)),j.biff<5||V.BIFFVer==0&&V.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:e.l-G,name:u};s[he.pos]=he,j.snames.push(u)}else u=(s[H]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),B=[],X=[],j.arrayf=S=[],K=[],ee=[],Y=!1,k={Hidden:(s[H]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[V.r]||[])[V.c]:a[Mt({c:V.c,r:V.r})])&&++V.c,_={ixfe:V.ixfe,XF:P[V.ixfe]||{},v:V.val,t:"n"},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t);break;case 5:case 517:_={ixfe:V.ixfe,XF:P[V.ixfe],v:V.val,t:V.t},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t);break;case 638:_={ixfe:V.ixfe,XF:P[V.ixfe],v:V.rknum,t:"n"},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t);break;case 189:for(var Z=V.c;Z<=V.C;++Z){var Se=V.rkrec[Z-V.c][0];_={ixfe:Se,XF:P[Se],v:V.rkrec[Z-V.c][1],t:"n"},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:Z,r:V.r},_,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(_=rh(V.val,V.cell.ixfe,V.tt),_.XF=P[_.ixfe],t.cellFormula){var ge=V.formula;if(ge&&ge[0]&&ge[0][0]&&ge[0][0][0]=="PtgExp"){var pe=ge[0][0][1][0],Ae=ge[0][0][1][1],Le=Mt({r:pe,c:Ae});b[Le]?_.f=""+xa(V.formula,i,V.cell,z,j):_.F=((t.dense?(a[pe]||[])[Ae]:a[Le])||{}).F}else _.f=""+xa(V.formula,i,V.cell,z,j)}A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F(V.cell,_,t),o=V}break;case 7:case 519:if(o)o.val=V,_=rh(V,o.cell.ixfe,"s"),_.XF=P[_.ixfe],t.cellFormula&&(_.f=""+xa(o.formula,i,o.cell,z,j)),A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(V);var Pe=Mt(V[0].s);if(h=t.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Pe],t.cellFormula&&h){if(!o||!Pe||!h)break;h.f=""+xa(V[1],i,V[0],z,j),h.F=qt(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;b[Mt(o.cell)]=V[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Mt(o.cell)],(h||{}).f=""+xa(V[0],i,f,z,j)}}break;case 253:_=rh(c[V.isst].t,V.ixfe,"s"),c[V.isst].h&&(_.h=c[V.isst].h),_.XF=P[_.ixfe],A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:V.ixfe,XF:P[V.ixfe],t:"z"},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t));break;case 190:if(t.sheetStubs)for(var Oe=V.c;Oe<=V.C;++Oe){var Ve=V.ixfe[Oe-V.c];_={ixfe:Ve,XF:P[Ve],t:"z"},A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:Oe,r:V.r},_,t)}break;case 214:case 516:case 4:_=rh(V.val,V.ixfe,"s"),_.XF=P[_.ixfe],A>0&&(_.z=D[_.ixfe>>8&63]),hi(_,t,r.opts.Date1904),F({c:V.c,r:V.r},_,t);break;case 0:case 512:le===1&&(i=V);break;case 252:c=V;break;case 1054:if(j.biff==4){D[A++]=V[1];for(var et=0;et<A+163&&Lt[et]!=V[1];++et);et>=163&&Xi(V[1],A+163)}else Xi(V[1],V[0]);break;case 30:{D[A++]=V;for(var _t=0;_t<A+163&&Lt[_t]!=V;++_t);_t>=163&&Xi(V,A+163)}break;case 229:B=B.concat(V);break;case 93:X[V.cmo[0]]=j.lastobj=V;break;case 438:j.lastobj.TxO=V;break;case 127:j.lastobj.ImData=V;break;case 440:for(v=V[0].s.r;v<=V[0].e.r;++v)for(g=V[0].s.c;g<=V[0].e.c;++g)h=t.dense?(a[v]||[])[g]:a[Mt({c:g,r:v})],h&&(h.l=V[1]);break;case 2048:for(v=V[0].s.r;v<=V[0].e.r;++v)for(g=V[0].s.c;g<=V[0].e.c;++g)h=t.dense?(a[v]||[])[g]:a[Mt({c:g,r:v})],h&&h.l&&(h.l.Tooltip=V[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;h=t.dense?(a[V[0].r]||[])[V[0].c]:a[Mt(V[0])];var Tt=X[V[2]];h||(t.dense?(a[V[0].r]||(a[V[0].r]=[]),h=a[V[0].r][V[0].c]={t:"z"}):h=a[Mt(V[0])]={t:"z"},i.e.r=Math.max(i.e.r,V[0].r),i.s.r=Math.min(i.s.r,V[0].r),i.e.c=Math.max(i.e.c,V[0].c),i.s.c=Math.min(i.s.c,V[0].c)),h.c||(h.c=[]),p={a:V[1],t:Tt.TxO.t},h.c.push(p)}break;case 2173:wR(P[V.ixfe],V.ext);break;case 125:{if(!j.cellStyles)break;for(;V.e>=V.s;)K[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},Y||(Y=!0,g2(V.w/256)),Vo(K[V.e+1])}break;case 520:{var At={};V.level!=null&&(ee[V.r]=At,At.level=V.level),V.hidden&&(ee[V.r]=At,At.hidden=!0),V.hpt&&(ee[V.r]=At,At.hpt=V.hpt,At.hpx=uu(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Il(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=V;break;case 161:a["!margins"]||Il(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(I.Views[0].RTL=!0);break;case 146:N=V;break;case 2198:U=V;break;case 140:E=V;break;case 442:u?k.CodeName=V||k.name:I.WBProps.CodeName=V||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=G}return r.SheetNames=an(s).sort(function(pt,lt){return Number(pt)-Number(lt)}).map(function(pt){return s[pt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&L.forEach(function(pt,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=pt}),r.Strings=c,r.SSF=Dr(Lt),j.enc&&(r.Encryption=j.enc),U&&(r.Themes=U),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),z.names.length>0&&(I.Names=z.names),r.Workbook=I,r}var Md={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function L$(e,t,r){var n=Ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=rS(n,lv,Md.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=Ct.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=rS(i,cv,Md.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(dk(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function D$(e,t){var r=[],n=[],a=[],s=0,i,o=O5(lv,"n"),c=O5(cv,"n");if(e.Props)for(i=an(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=an(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)vk.indexOf(a[s][0])>-1||uk.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Ct.utils.cfb_add(t,"/SummaryInformation",nS(n,Md.SI,c,cv)),(r.length||u.length)&&Ct.utils.cfb_add(t,"/DocumentSummaryInformation",nS(r,Md.DSI,o,lv,u.length?u:null,Md.UDI))}function hC(e,t){t||(t={}),A2(t),Gy(),t.codepage&&qy(t.codepage);var r,n;if(e.FullPaths){if(Ct.find(e,"/encryption"))throw new Error("File is password-protected");r=Ct.find(e,"!CompObj"),n=Ct.find(e,"/Workbook")||Ct.find(e,"/Book")}else{switch(t.type){case"base64":e=as(us(e));break;case"binary":e=as(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ia(e,0),n={content:e}}var a,s;if(r&&P$(r),t.bookProps&&!t.bookSheets)a={};else{var i=Yt?"buffer":"array";if(n&&n.content)a=I$(n.content,t);else if((s=Ct.find(e,"PerfectOffice_MAIN"))&&s.content)a=Fl.to_workbook(s.content,(t.type=i,t));else if((s=Ct.find(e,"NativeContent_MAIN"))&&s.content)a=Fl.to_workbook(s.content,(t.type=i,t));else throw(s=Ct.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=KR(e))}var o={};return e.FullPaths&&L$(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function M$(e,t){var r=t||{},n=Ct.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ct.utils.cfb_add(n,a,mC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&D$(e,n),r.biff==8&&e.vbaraw&&XR(n,Ct.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Zd={0:{f:oU},1:{f:pU},2:{f:IU},3:{f:_U},4:{f:yU},5:{f:PU},6:{f:BU},7:{f:kU},8:{f:GU},9:{f:qU},10:{f:WU},11:{f:HU},12:{f:xU},13:{f:DU},14:{f:AU},15:{f:wU},16:{f:sC},17:{f:zU},18:{f:EU},19:{f:i2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zz},40:{},42:{},43:{f:BM},44:{f:MM},45:{f:$M},46:{f:HM},47:{f:WM},48:{},49:{f:uI},50:{},51:{f:NR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ek},62:{f:RU},63:{f:FR},64:{f:lz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Na,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:az},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hU},148:{f:uU,p:16},151:{f:ZU},152:{},153:{f:Rz},154:{},155:{},156:{f:Dz},157:{},158:{},159:{T:1,f:eM},160:{T:-1},161:{T:1,f:sc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SR},336:{T:-1},337:{f:kR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ov},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ck},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QU},427:{f:ez},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ov},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HR},633:{T:1},634:{T:-1},635:{T:1,f:$R},636:{T:-1},637:{f:mI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Az},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},pv={6:{f:Zg},10:{f:Lo},12:{f:Sn},13:{f:Sn},14:{f:cn},15:{f:cn},16:{f:ba},17:{f:cn},18:{f:cn},19:{f:Sn},20:{f:cS},21:{f:cS},23:{f:Ck},24:{f:dS},25:{f:cn},26:{},27:{},28:{f:cD},29:{},34:{f:cn},35:{f:uS},38:{f:ba},39:{f:ba},40:{f:ba},41:{f:ba},42:{f:cn},43:{f:cn},47:{f:wM},49:{f:DL},51:{f:Sn},60:{},61:{f:PL},64:{f:cn},65:{f:LL},66:{f:Sn},77:{},80:{},81:{},82:{},85:{f:Sn},89:{},90:{},91:{},92:{f:bL},93:{f:fD},94:{},95:{f:cn},96:{},97:{},99:{f:cn},125:{f:Ek},128:{f:JL},129:{f:SL},130:{f:Sn},131:{f:cn},132:{f:cn},133:{f:_L},134:{},140:{f:bD},141:{f:Sn},144:{},146:{f:_D},151:{},152:{},153:{},154:{},155:{},156:{f:Sn},157:{},158:{},160:{f:TD},161:{f:jD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:VL},190:{f:YL},193:{f:Lo},197:{},198:{},199:{},200:{},201:{},202:{f:cn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sn},220:{},221:{f:cn},222:{},224:{f:XL},225:{f:yL},226:{f:Lo},227:{},229:{f:uD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:AL},253:{f:RL},255:{f:kL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cn},353:{f:Lo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rD},431:{f:cn},432:{},433:{},434:{},437:{},438:{f:pD},439:{f:cn},440:{f:gD},441:{},442:{f:_f},443:{},444:{f:Sn},445:{},446:{},448:{f:Lo},449:{f:TL,r:2},450:{f:Lo},512:{f:iS},513:{f:ED},515:{f:eD},516:{f:UL},517:{f:lS},519:{f:PD},520:{f:CL},523:{},545:{f:fS},549:{f:sS},566:{},574:{f:FL},638:{f:GL},659:{},1048:{},1054:{f:$L},1084:{},1212:{f:iD},2048:{f:vD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Q0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Lo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ND,r:12},2173:{f:bR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sD,r:12},2197:{},2198:{f:mR,r:12},2199:{},2200:{},2201:{},2202:{f:oD,r:12},2203:{f:Lo},2204:{},2205:{},2206:{},2207:{},2211:{f:EL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:kD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:SD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:iS},1:{},2:{f:DD},3:{f:ID},4:{f:FD},5:{f:lS},7:{f:RD},8:{},9:{f:Q0},11:{},22:{f:Sn},30:{f:HL},31:{},32:{},33:{f:fS},36:{},37:{f:sS},50:{f:BD},62:{},52:{},67:{},68:{f:Sn},69:{},86:{},126:{},127:{f:OD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:UD},223:{},234:{},354:{},421:{},518:{f:Zg},521:{f:Q0},536:{f:dS},547:{f:uS},561:{},579:{},1030:{f:Zg},1033:{f:Q0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ot(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&n2(r)&&e.push(r)}}function R$(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ot(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function kf(e,t,r){return e||(e=Ge(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function B$(e,t,r,n){var a=Ge(9);return kf(a,e,t),bk(r,n||"b",a),a}function U$(e,t,r){var n=Ge(8+2*r.length);return kf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function z$(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?In(Lr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ot(e,2,MD(r,n,a)):ot(e,3,LD(r,n,a));return;case"b":case"e":ot(e,5,B$(r,n,t.v,t.t));return;case"s":case"str":ot(e,4,U$(r,n,(t.v||"").slice(0,255)));return}ot(e,1,kf(null,r,n))}function $$(e,t,r,n){var a=Array.isArray(t),s=ir(t["!ref"]||"A1"),i,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=qt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=mn(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=qr(d)),i=c[d]+o;var f=a?(t[u]||[])[d]:t[i];f&&z$(e,f,u,d)}}}function W$(e,t){for(var r=t||{},n=qa(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ot(n,r.biff==4?1033:r.biff==3?521:9,h2(e,16,r)),$$(n,e.Sheets[e.SheetNames[a]],a,r),ot(n,10),n.end()}function H$(e,t,r){ot(e,49,ML({sz:12,name:"Arial"},r))}function q$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ot(e,1054,WL(a,t[a],r))})}function G$(e,t){var r=Ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ot(e,2151,r),r=Ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ak(ir(t["!ref"]||"A1"),r),r.write_shift(4,4),ot(e,2152,r)}function V$(e,t){for(var r=0;r<16;++r)ot(e,224,oS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ot(e,224,oS(n,0,t))})}function Y$(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ot(e,440,xD(n)),n[1].Tooltip&&ot(e,2048,yD(n))}delete t["!links"]}function K$(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ot(e,125,AD(op(a,n),a))})}}function X$(e,t,r,n,a){var s=16+sl(a.cellXfs,t,a);if(t.v==null&&!t.bf){ot(e,513,Wl(r,n,s));return}if(t.bf)ot(e,6,SB(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?In(Lr(t.v)):t.v;ot(e,515,tD(r,n,i,s));break;case"b":case"e":ot(e,517,QL(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=w2(a.Strings,t.v,a.revStrings);ot(e,253,BL(r,n,o,s))}else ot(e,516,zL(r,n,(t.v||"").slice(0,255),s,a));break;default:ot(e,513,Wl(r,n,s))}}function J$(e,t,r){var n=qa(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",m=[],h=ir(s["!ref"]||"A1"),p=u?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}ot(n,2057,h2(r,16,t)),ot(n,13,Es(1)),ot(n,12,Es(100)),ot(n,15,Pa(!0)),ot(n,17,Pa(!1)),ot(n,16,zl(.001)),ot(n,95,Pa(!0)),ot(n,42,Pa(!1)),ot(n,43,Pa(!1)),ot(n,130,Es(1)),ot(n,128,ZL()),ot(n,131,Pa(!1)),ot(n,132,Pa(!1)),u&&K$(n,s["!cols"]),ot(n,512,qL(h,t)),u&&(s["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){f=mn(g);for(var v=h.s.c;v<=h.e.c;++v){g===h.s.r&&(m[v]=qr(v)),d=m[v]+f;var b=c?(s[g]||[])[v]:s[d];b&&(X$(n,b,g,v,t),u&&b.l&&s["!links"].push([d,b.l]))}}var S=o.CodeName||o.name||a;return u&&ot(n,574,IL((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&ot(n,229,dD(s["!merges"])),u&&Y$(n,s),ot(n,442,wk(S)),u&&G$(n,s),ot(n,10),n.end()}function Z$(e,t,r){var n=qa(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(ot(n,2057,h2(e,5,r)),r.bookType=="xla"&&ot(n,135),ot(n,225,o?Es(1200):null),ot(n,193,QI(2)),c&&ot(n,191),c&&ot(n,192),ot(n,226),ot(n,92,wL("SheetJS",r)),ot(n,66,Es(o?1200:1252)),o&&ot(n,353,Es(0)),o&&ot(n,448),ot(n,317,CD(e.SheetNames.length)),o&&e.vbaraw&&ot(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";ot(n,442,wk(u))}ot(n,156,Es(17)),ot(n,25,Pa(!1)),ot(n,18,Pa(!1)),ot(n,19,Es(0)),o&&ot(n,431,Pa(!1)),o&&ot(n,444,Es(0)),ot(n,61,OL()),ot(n,64,Pa(!1)),ot(n,141,Es(0)),ot(n,34,Pa(Tz(e)=="true")),ot(n,14,Pa(!0)),o&&ot(n,439,Pa(!1)),ot(n,218,Es(0)),H$(n,e,r),q$(n,e.SSF,r),V$(n,r),o&&ot(n,352,Pa(!1));var d=n.end(),f=qa();o&&ot(f,140,wD()),o&&r.Strings&&R$(f,252,jL(r.Strings)),ot(f,10);var m=f.end(),h=qa(),p=0,g=0;for(g=0;g<e.SheetNames.length;++g)p+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var v=d.length+p+m.length;for(g=0;g<e.SheetNames.length;++g){var b=s[g]||{};ot(h,133,NL({pos:v,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),v+=t[g].length}var S=h.end();if(p!=S.length)throw new Error("BS8 "+p+" != "+S.length);var _=[];return d.length&&_.push(d),S.length&&_.push(S),m.length&&_.push(m),Xn(_)}function Q$(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Dr(Lt)),e&&e.SSF&&(bu(),ep(e.SSF),r.revssf=rp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,j2(r),r.cellXfs=[],sl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=J$(a,r,e);return n.unshift(Z$(e,n,r)),Xn(n)}function mC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ga(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Q$(e,t);case 4:case 3:case 2:return W$(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function SS(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,c=M7(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<c.length;++i){var g=c[i].trim(),v=g.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var b=g.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var S=b[o].trim();if(S.match(/<t[dh]/i)){for(var _=S,E=0;_.charAt(0)=="<"&&(E=_.indexOf(">"))>-1;)_=_.slice(E+1);for(var P=0;P<p.length;++P){var N=p[P];N.s.c==d&&N.s.r<u&&u<=N.e.r&&(d=N.e.c+1,P=-1)}var I=Rt(S.slice(0,S.indexOf(">")));m=I.colspan?+I.colspan:1,((f=+I.rowspan)>1||m>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+m-1}});var k=I.t||I["data-t"]||"";if(!_.length){d+=m;continue}if(_=Rj(_),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!_.length){d+=m;continue}var T={t:"s",v:_};r.raw||!_.trim().length||k=="s"||(_==="TRUE"?T={t:"b",v:!0}:_==="FALSE"?T={t:"b",v:!1}:isNaN(Qs(_))?isNaN(lu(_).getDate())||(T={t:"d",v:Lr(_)},r.cellDates||(T={t:"n",v:In(T.v)}),T.z=r.dateNF||Lt[14]):T={t:"n",v:Qs(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=T):n[Mt({r:u,c:d})]=T,d+=m}}}}return n["!ref"]=qt(h),p.length&&(n["!merges"]=p),n}function eW(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=Mt({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],m=f&&f.v!=null&&(f.h||e2(f.w||(eo(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(it("td",m,h))}}var p="<tr>";return p+s.join("")+"</tr>"}var tW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rW="</body></html>";function nW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return al(SS(r[0],t),t);var n=E2();return r.forEach(function(a,s){T2(n,SS(a,t),"Sheet"+(s+1))}),n}function aW(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pC(e,t){var r=t||{},n=r.header!=null?r.header:tW,a=r.footer!=null?r.footer:rW,s=[n],i=Ga(e["!ref"]);r.dense=Array.isArray(e),s.push(aW(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(eW(e,i,o,r));return s.push("</table>"+a),s.join("")}function gC(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Gr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=Ga(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],m=0,h=e["!rows"]||(e["!rows"]=[]),p=0,g=0,v=0,b=0,S=0,_=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var E=o[p];if(_S(E)){if(n.display)continue;h[g]={hidden:!0}}var P=E.children;for(v=b=0;v<P.length;++v){var N=P[v];if(!(n.display&&_S(N))){var I=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Rj(N.innerHTML),k=N.getAttribute("data-z")||N.getAttribute("z");for(m=0;m<f.length;++m){var T=f[m];T.s.c==b+s&&T.s.r<g+a&&g+a<=T.e.r&&(b=T.e.c+1-s,m=-1)}_=+N.getAttribute("colspan")||1,((S=+N.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:g+a,c:b+s},e:{r:g+a+(S||1)-1,c:b+s+(_||1)-1}});var q={t:"s",v:I},F=N.getAttribute("data-t")||N.getAttribute("t")||"";I!=null&&(I.length==0?q.t=F||"z":n.raw||I.trim().length==0||F=="s"||(I==="TRUE"?q={t:"b",v:!0}:I==="FALSE"?q={t:"b",v:!1}:isNaN(Qs(I))?isNaN(lu(I).getDate())||(q={t:"d",v:Lr(I)},n.cellDates||(q={t:"n",v:In(q.v)}),q.z=n.dateNF||Lt[14]):q={t:"n",v:Qs(I)})),q.z===void 0&&k!=null&&(q.z=k);var j="",U=N.getElementsByTagName("A");if(U&&U.length)for(var B=0;B<U.length&&!(U[B].hasAttribute("href")&&(j=U[B].getAttribute("href"),j.charAt(0)!="#"));++B);j&&j.charAt(0)!="#"&&(q.l={Target:j}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][b+s]=q):e[Mt({c:b+s,r:g+a})]=q,u.e.c<b+s&&(u.e.c=b+s),b+=_}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=qt(u),g>=c&&(e["!fullref"]=qt((u.e.r=o.length-p+g-1+a,u))),e}function xC(e,t){var r=t||{},n=r.dense?[]:{};return gC(n,e,t)}function sW(e,t){return al(xC(e,t),t)}function _S(e){var t="",r=iW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=sr(t.replace(/<[^>]*>/g,""));return[r]}var NS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vC(e,t){var r=t||{},n=t2(e),a=[],s,i,o={name:""},c="",u=0,d,f,m={},h=[],p=r.dense?[]:{},g,v,b={value:""},S="",_=0,E=[],P=-1,N=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,T={},q=[],F={},j=0,U=0,B=[],X=1,K=1,ee=[],Y={Names:[]},z={},ne=["",""],le=[],A={},D="",L=0,M=!1,R=!1,H=0;for(Gd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Gd.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?p["!ref"]=qt(I):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(p["!fullref"]=p["!ref"],I.e.r=r.sheetRows-1,p["!ref"]=qt(I)),q.length&&(p["!merges"]=q),B.length&&(p["!rows"]=B),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),m[d.name]=p,R=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Rt(g[0],!1),P=N=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,p=r.dense?[]:{},q=[],B=[],R=!0);break;case"table-row-group":g[1]==="/"?--k:++k;break;case"table-row":case"行":if(g[1]==="/"){P+=X,X=1;break}if(f=Rt(g[0],!1),f.行号?P=f.行号-1:P==-1&&(P=0),X=+f["number-rows-repeated"]||1,X<10)for(H=0;H<X;++H)k>0&&(B[P+H]={level:k});N=-1;break;case"covered-table-cell":g[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[P]||(p[P]=[]),p[P][N]={t:"z"}):p[Mt({r:P,c:N})]={t:"z"}),S="",E=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++N,b=Rt(g[0],!1),K=parseInt(b["number-columns-repeated"]||"1",10),v={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(v.f=yS(sr(b.formula))),(b.数据类型||b["value-type"])=="string"&&(v.t="s",v.v=sr(b["string-value"]||""),r.dense?(p[P]||(p[P]=[]),p[P][N]=v):p[Mt({r:P,c:N})]=v),N+=K-1;else if(g[1]!=="/"){++N,S="",_=0,E=[],K=1;var J=X?P+X-1:P;if(N>I.e.c&&(I.e.c=N),N<I.s.c&&(I.s.c=N),P<I.s.r&&(I.s.r=P),J>I.e.r&&(I.e.r=J),b=Rt(g[0],!1),le=[],A={},v={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=sr(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(j=parseInt(b["number-matrix-rows-spanned"],10)||0,U=parseInt(b["number-matrix-columns-spanned"],10)||0,F={s:{r:P,c:N},e:{r:P+j-1,c:N+U-1}},v.F=qt(F),ee.push([F,v.F])),b.formula)v.f=yS(b.formula);else for(H=0;H<ee.length;++H)P>=ee[H][0].s.r&&P<=ee[H][0].e.r&&N>=ee[H][0].s.c&&N<=ee[H][0].e.c&&(v.F=ee[H][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(j=parseInt(b["number-rows-spanned"],10)||0,U=parseInt(b["number-columns-spanned"],10)||0,F={s:{r:P,c:N},e:{r:P+j-1,c:N+U-1}},q.push(F)),b["number-columns-repeated"]&&(K=parseInt(b["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Fr(b["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(b.value);break;case"percentage":v.t="n",v.v=parseFloat(b.value);break;case"currency":v.t="n",v.v=parseFloat(b.value);break;case"date":v.t="d",v.v=Lr(b["date-value"]),r.cellDates||(v.t="n",v.v=In(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=I7(b["time-value"])/86400,r.cellDates&&(v.t="d",v.v=np(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(b.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",b["string-value"]!=null&&(S=sr(b["string-value"]),E=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(M=!1,v.t==="s"&&(v.v=S||"",E.length&&(v.R=E),M=_==0),z.Target&&(v.l=z),le.length>0&&(v.c=le,le=[]),S&&r.cellText!==!1&&(v.w=S),M&&(v.t="z",delete v.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var G=0;G<X;++G){if(K=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(p[P+G]||(p[P+G]=[]),p[P+G][N]=G==0?v:Dr(v);--K>0;)p[P+G][N+K]=Dr(v);else for(p[Mt({r:P+G,c:N})]=v;--K>0;)p[Mt({r:P+G,c:N+K})]=Dr(v);I.e.c<=N&&(I.e.c=N)}K=parseInt(b["number-columns-repeated"]||"1",10),N+=K-1,K=0,v={},S="",E=[]}z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s;A.t=S,E.length&&(A.R=E),A.a=D,le.push(A)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);D="",L=0,S="",_=0,E=[];break;case"creator":g[1]==="/"?D=n.slice(L,g.index):L=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);S="",_=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(T[o.name]=c,(s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=Rt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Rt(g[0],!1),c+=NS[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Rt(g[0],!1),c+=NS[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":i=Rt(g[0],!1),ne=Qg(i["cell-range-address"]);var Q={Name:i.name,Ref:ne[0]+"!"+ne[1]};R&&(Q.Sheet=h.length),Y.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var de=oW(n.slice(_,g.index));S=(S.length>0?S+`
`:"")+de[0]}else Rt(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ne=Qg(Rt(g[0])["target-range-address"]),m[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(z=Rt(g[0],!1),!z.href)break;z.Target=sr(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ne=Qg(z.Target.slice(1)),z.Target="#"+ne[0]+"!"+ne[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var V={Sheets:m,SheetNames:h,Workbook:Y};return r.bookSheets&&delete V.Sheets,V}function AS(e,t){t=t||{},Cs(e,"META-INF/manifest.xml")&&II(wn(e,"META-INF/manifest.xml"),t);var r=ss(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=vC(_r(r),t);return Cs(e,"meta.xml")&&(n.Props=lk(wn(e,"meta.xml"))),n}function jS(e,t){return vC(e,t)}var lW=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+qd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pn+t}})(),kS=(function(){var e=function(s){return vr(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var c=[];c.push('      <table:table table:name="'+vr(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=Ga(s["!ref"]||"A1"),m=s["!merges"]||[],h=0,p=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",v=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,S={},_="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>d)&&!(m[h].s.r>u)&&!(m[h].e.c<d)&&!(m[h].e.r<u)){(m[h].s.c!=d||m[h].s.r!=u)&&(b=!0),S["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,S["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(b){c.push(r);continue}var E=Mt({r:u,c:d}),P=p?(s[u]||[])[d]:s[E];if(P&&P.f&&(S["table:formula"]=vr(CB(P.f)),P.F&&P.F.slice(0,E.length)==E)){var N=Ga(P.F);S["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,S["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!P){c.push(t);continue}switch(P.t){case"b":_=P.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=P.v?"true":"false";break;case"n":_=P.w||String(P.v||0),S["office:value-type"]="float",S["office:value"]=P.v||0;break;case"s":case"str":_=P.v==null?"":P.v,S["office:value-type"]="string";break;case"d":_=P.w||Lr(P.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Lr(P.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(t);continue}var I=e(_);if(P.l&&P.l.Target){var k=P.l.Target;k=k.charAt(0)=="#"?"#"+EB(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),I=it("text:a",I,{"xlink:href":k.replace(/&/g,"&amp;")})}c.push("          "+it("table:table-cell",it("text:p",I,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Vo(f),f.ods=o;var m=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var c=[pn],u=qd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=qd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(ok().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function yC(e,t){if(t.bookType=="fods")return kS(e,t);var r=Jy(),n="",a=[],s=[];return n="mimetype",Gt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Gt(r,n,kS(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Gt(r,n,lW(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Gt(r,n,pn+ok()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Gt(r,n,MI(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Gt(r,n,LI(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):_r(nl(e))}function cW(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):as(bi(e))}function uW(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ko(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function CS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function fW(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Qd(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function pr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function nn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function or(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Qd(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Qd(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function na(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(pr(n*8+a.type)),a.type==2&&t.push(pr(a.data.length)),t.push(a.data))})}),Ko(t)}function N2(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ns(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Qd(e,n),s=or(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:nn(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=or(o.data),u=nn(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=nn(s[3][0].data)>>>0>0),r.push(i)}return r}function Lc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:pr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:pr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:pr(i.data.length)}],n[2].push({data:na(i.meta),type:2})});var s=na(n);t.push(pr(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),Ko(t)}function hW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Qd(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ko(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Ko(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function As(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hW(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ko(t)}function Dc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=pr(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return Ko(t)}function mW(e,t,r,n){var a=Hl(e),s=a.getUint32(4,!0),i=(n>1?12:8)+CS(s&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=CS(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function pW(e,t,r){var n=Hl(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=dW(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function tx(e,t){var r=new Uint8Array(32),n=Hl(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,fW(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function rx(e,t){var r=new Uint8Array(32),n=Hl(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function gW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mW(e,t,r,e[0]);case 5:return pW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ga(e){var t=or(e);return Qd(t[1][0].data)}function ES(e,t){var r=or(t.data),n=nn(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=or(i.data),c=nn(o[1][0].data)>>>0;switch(n){case 1:s[c]=gv(o[3][0].data);break;case 8:{var u=e[ga(o[9][0].data)][0],d=or(u.data),f=e[ga(d[1][0].data)][0],m=nn(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=or(f.data);s[c]=h[3].map(function(p){return gv(p.data)}).join("")}break}}),s}function xW(e,t){var r,n,a,s,i,o,c,u,d,f,m,h,p,g,v=or(e),b=nn(v[1][0].data)>>>0,S=nn(v[2][0].data)>>>0,_=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&nn(v[8][0].data)>0||!1,E,P;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)E=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,P=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)E=(h=(m=v[4])==null?void 0:m[0])==null?void 0:h.data,P=(g=(p=v[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=_?4:1,I=Hl(E),k=[],T=0;T<E.length/2;++T){var q=I.getUint16(T*2,!0);q<65535&&k.push([T,q])}if(k.length!=S)throw"Expected ".concat(S," cells, found ").concat(k.length);var F=[];for(T=0;T<k.length-1;++T)F[k[T][0]]=P.subarray(k[T][1]*N,k[T+1][1]*N);return k.length>=1&&(F[k[k.length-1][0]]=P.subarray(k[k.length-1][1]*N)),{R:b,cells:F}}function vW(e,t){var r,n=or(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?nn(n[7][0].data)>>>0>0?1:0:-1,s=N2(n[5],function(i){return xW(i,a)});return{nrows:nn(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function yW(e,t,r){var n,a=or(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(nn(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(nn(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=qt(s);var i=or(a[4][0].data),o=ES(e,e[ga(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?ES(e,e[ga(i[17][0].data)][0]):[],u=or(i[3][0].data),d=0;u[1].forEach(function(f){var m=or(f.data),h=e[ga(m[2][0].data)][0],p=nn(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=vW(e,h);g.data.forEach(function(v,b){v.forEach(function(S,_){var E=Mt({r:d+b,c:_}),P=gW(S,o,c);P&&(r[E]=P)})}),d+=g.nrows})}function bW(e,t){var r=or(t.data),n={"!ref":"A1"},a=e[ga(r[2][0].data)],s=nn(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return yW(e,a[0],n),n}function wW(e,t){var r,n=or(t.data),a={name:(r=n[1])!=null&&r[0]?gv(n[1][0].data):"",sheets:[]},s=N2(n[2],ga);return s.forEach(function(i){e[i].forEach(function(o){var c=nn(o.meta[1][0].data);c==6e3&&a.sheets.push(bW(e,o))})}),a}function SW(e,t){var r=E2(),n=or(t.data),a=N2(n[1],ga);if(a.forEach(function(s){e[s].forEach(function(i){var o=nn(i.meta[1][0].data);if(o==2){var c=wW(e,i);c.sheets.forEach(function(u,d){T2(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function nx(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=As(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Ns(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&nn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(u){var d=nn(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return SW(s,o)}function _W(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&nn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Hl(e[7][0].data),d=0,f=[],m=Hl(e[4][0].data),h=0,p=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),m.setUint16(g*2,h,!0);var v,b;switch(typeof t[g]){case"string":v=tx({t:"s",v:t[g]},r),b=rx({t:"s",v:t[g]},r);break;case"number":v=tx({t:"n",v:t[g]},r),b=rx({t:"n",v:t[g]},r);break;case"boolean":v=tx({t:"b",v:t[g]},r),b=rx({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(v),d+=v.length,p.push(b),h+=b.length,++c}for(e[2][0].data=pr(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return e[6][0].data=Ko(f),e[3][0].data=Ko(p),c}function NW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ga(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(qt(n)));var s=Qh(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(D){return D.forEach(function(L){typeof L=="string"&&i.push(L)})});var o={},c=[],u=Ct.read(t.numbers,{type:"base64"});u.FileIndex.map(function(D,L){return[D,u.FullPaths[L]]}).forEach(function(D){var L=D[0],M=D[1];if(L.type==2&&L.name.match(/\.iwa/)){var R=L.content,H=As(R),J=Ns(H);J.forEach(function(G){c.push(G.id),o[G.id]={deps:[],location:M,type:nn(G.messages[0].meta[1][0].data)}})}}),c.sort(function(D,L){return D-L});var d=c.filter(function(D){return D>1}).map(function(D){return[D,pr(D)]});u.FileIndex.map(function(D,L){return[D,u.FullPaths[L]]}).forEach(function(D){var L=D[0];if(D[1],!!L.name.match(/\.iwa/)){var M=Ns(As(L.content));M.forEach(function(R){R.messages.forEach(function(H){d.forEach(function(J){R.messages.some(function(G){return nn(G.meta[1][0].data)!=11006&&uW(G.data,J[1])})&&o[J[0]].deps.push(R.id)})})})}});for(var f=Ct.find(u,o[1].location),m=Ns(As(f.content)),h,p=0;p<m.length;++p){var g=m[p];g.id==1&&(h=g)}var v=ga(or(h.messages[0].data)[1][0].data);for(f=Ct.find(u,o[v].location),m=Ns(As(f.content)),p=0;p<m.length;++p)g=m[p],g.id==v&&(h=g);for(v=ga(or(h.messages[0].data)[2][0].data),f=Ct.find(u,o[v].location),m=Ns(As(f.content)),p=0;p<m.length;++p)g=m[p],g.id==v&&(h=g);for(v=ga(or(h.messages[0].data)[2][0].data),f=Ct.find(u,o[v].location),m=Ns(As(f.content)),p=0;p<m.length;++p)g=m[p],g.id==v&&(h=g);var b=or(h.messages[0].data);{b[6][0].data=pr(n.e.r+1),b[7][0].data=pr(n.e.c+1);var S=ga(b[46][0].data),_=Ct.find(u,o[S].location),E=Ns(As(_.content));{for(var P=0;P<E.length&&E[P].id!=S;++P);if(E[P].id!=S)throw"Bad ColumnRowUIDMapArchive";var N=or(E[P].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var I=0;I<=n.e.c;++I){var k=[];k[1]=k[2]=[{type:0,data:pr(I+420690)}],N[1].push({type:2,data:na(k)}),N[2].push({type:0,data:pr(I)}),N[3].push({type:0,data:pr(I)})}N[4]=[],N[5]=[],N[6]=[];for(var T=0;T<=n.e.r;++T)k=[],k[1]=k[2]=[{type:0,data:pr(T+726270)}],N[4].push({type:2,data:na(k)}),N[5].push({type:0,data:pr(T)}),N[6].push({type:0,data:pr(T)});E[P].messages[0].data=na(N)}_.content=Dc(Lc(E)),_.size=_.content.length,delete b[46];var q=or(b[4][0].data);{q[7][0].data=pr(n.e.r+1);var F=or(q[1][0].data),j=ga(F[2][0].data);_=Ct.find(u,o[j].location),E=Ns(As(_.content));{if(E[0].id!=j)throw"Bad HeaderStorageBucket";var U=or(E[0].messages[0].data);for(T=0;T<s.length;++T){var B=or(U[2][0].data);B[1][0].data=pr(T),B[4][0].data=pr(s[T].length),U[2][T]={type:U[2][0].type,data:na(B)}}E[0].messages[0].data=na(U)}_.content=Dc(Lc(E)),_.size=_.content.length;var X=ga(q[2][0].data);_=Ct.find(u,o[X].location),E=Ns(As(_.content));{if(E[0].id!=X)throw"Bad HeaderStorageBucket";for(U=or(E[0].messages[0].data),I=0;I<=n.e.c;++I)B=or(U[2][0].data),B[1][0].data=pr(I),B[4][0].data=pr(n.e.r+1),U[2][I]={type:U[2][0].type,data:na(B)};E[0].messages[0].data=na(U)}_.content=Dc(Lc(E)),_.size=_.content.length;var K=ga(q[4][0].data);(function(){for(var D=Ct.find(u,o[K].location),L=Ns(As(D.content)),M,R=0;R<L.length;++R){var H=L[R];H.id==K&&(M=H)}var J=or(M.messages[0].data);{J[3]=[];var G=[];i.forEach(function(V,Ee){G[1]=[{type:0,data:pr(Ee)}],G[2]=[{type:0,data:pr(1)}],G[3]=[{type:2,data:cW(V)}],J[3].push({type:2,data:na(G)})})}M.messages[0].data=na(J);var Q=Lc(L),de=Dc(Q);D.content=de,D.size=D.content.length})();var ee=or(q[3][0].data);{var Y=ee[1][0];delete ee[2];var z=or(Y.data);{var ne=ga(z[2][0].data);(function(){for(var D=Ct.find(u,o[ne].location),L=Ns(As(D.content)),M,R=0;R<L.length;++R){var H=L[R];H.id==ne&&(M=H)}var J=or(M.messages[0].data);{delete J[6],delete ee[7];var G=new Uint8Array(J[5][0].data);J[5]=[];for(var Q=0,de=0;de<=n.e.r;++de){var V=or(G);Q+=_W(V,s[de],i),V[1][0].data=pr(de),J[5].push({data:na(V),type:2})}J[1]=[{type:0,data:pr(n.e.c+1)}],J[2]=[{type:0,data:pr(n.e.r+1)}],J[3]=[{type:0,data:pr(Q)}],J[4]=[{type:0,data:pr(n.e.r+1)}]}M.messages[0].data=na(J);var Ee=Lc(L),we=Dc(Ee);D.content=we,D.size=D.content.length})()}Y.data=na(z)}q[3][0].data=na(ee)}b[4][0].data=na(q)}h.messages[0].data=na(b);var le=Lc(m),A=Dc(le);return f.content=A,f.size=f.content.length,u}function bC(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function A2(e){bC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function j2(e){bC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function AW(e){return Kt.WS.indexOf(e)>-1?"sheet":e==Kt.CS?"chart":e==Kt.DS?"dialog":e==Kt.MS?"macro":e&&e.length?e:"sheet"}function jW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,AW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kW(e,t,r,n,a,s,i,o,c,u,d,f){try{s[n]=Fd(ss(e,r,!0),t);var m=wn(e,t),h;switch(o){case"sheet":h=Kz(m,t,a,c,s[n],u,d,f);break;case"chart":if(h=Xz(m,t,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var p=jd(h["!drawel"].Target,t),g=Vd(p),v=DR(ss(e,p,!0),Fd(ss(e,g,!0),p)),b=jd(v,p),S=Vd(b);h=_z(ss(e,b,!0),b,c,Fd(ss(e,S,!0),b),u,h);break;case"macro":h=Jz(m,t,a,c,s[n],u,d,f);break;case"dialog":h=Zz(m,t,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var _=[];s&&s[n]&&an(s[n]).forEach(function(E){var P="";if(s[n][E].Type==Kt.CMNT){P=jd(s[n][E].Target,t);var N=r$(wn(e,P,!0),P,c);if(!N||!N.length)return;mS(h,N,!1)}s[n][E].Type==Kt.TCMNT&&(P=jd(s[n][E].Target,t),_=_.concat(RR(wn(e,P,!0),c)))}),_&&_.length&&mS(h,_,!0,c.people||[])}catch(E){if(c.WTF)throw E}}function bs(e){return e.charAt(0)=="/"?e.slice(1):e}function CW(e,t){if(bu(),t=t||{},A2(t),Cs(e,"META-INF/manifest.xml")||Cs(e,"objectdata.xml"))return AS(e,t);if(Cs(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nx<"u"){if(e.FileIndex)return nx(e);var r=Ct.utils.cfb_new();return L5(e).forEach(function(B){Gt(r,B,B7(e,B))}),nx(r)}throw new Error("Unsupported NUMBERS file")}if(!Cs(e,"[Content_Types].xml"))throw Cs(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cs(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=L5(e),a=OI(ss(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",wn(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!wn(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Id=[],a.sst)try{Id=t$(wn(e,bs(a.sst)),a.sst,t)}catch(B){if(t.WTF)throw B}t.cellStyles&&a.themes.length&&(c=e$(ss(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Qz(wn(e,bs(a.style)),a.style,c,t))}a.links.map(function(B){try{var X=Fd(ss(e,Vd(bs(B))),B);return a$(wn(e,bs(B)),X,B,t)}catch{}});var d=Yz(wn(e,bs(a.workbooks[0])),a.workbooks[0],t),f={},m="";a.coreprops.length&&(m=wn(e,bs(a.coreprops[0]),!0),m&&(f=lk(m)),a.extprops.length!==0&&(m=wn(e,bs(a.extprops[0]),!0),m&&BI(m,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=ss(e,bs(a.custprops[0]),!0),m&&(h=zI(m,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=h),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var g={};t.bookDeps&&a.calcchain&&(g=n$(wn(e,bs(a.calcchain)),a.calcchain));var v=0,b={},S,_;{var E=d.Sheets;f.Worksheets=E.length,f.SheetNames=[];for(var P=0;P!=E.length;++P)f.SheetNames[P]=E[P].name}var N=s?"bin":"xml",I=a.workbooks[0].lastIndexOf("/"),k=(a.workbooks[0].slice(0,I+1)+"_rels/"+a.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");Cs(e,k)||(k="xl/_rels/workbook."+N+".rels");var T=Fd(ss(e,k,!0),k.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=s$(wn(e,bs(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=UR(wn(e,bs(a.people[0])),t)),T&&(T=jW(T,d.Sheets));var q=wn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var F="sheet";if(T&&T[v]?(S="xl/"+T[v][1].replace(/[\/]?xl\//,""),Cs(e,S)||(S=T[v][1]),Cs(e,S)||(S=k.replace(/_rels\/.*$/,"")+T[v][1]),F=T[v][2]):(S="xl/worksheets/sheet"+(v+1-q)+"."+N,S=S.replace(/sheet0\./,"sheet.")),_=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,U=0;U!=t.sheets.length;++U)typeof t.sheets[U]=="number"&&t.sheets[U]==v&&(j=1),typeof t.sheets[U]=="string"&&t.sheets[U].toLowerCase()==f.SheetNames[v].toLowerCase()&&(j=1);if(!j)continue e}}kW(e,S,_,f.SheetNames[v],v,b,i,F,t,d,c,u)}return p={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:g,Sheets:i,SheetNames:f.SheetNames,Strings:Id,Styles:u,Themes:c,SSF:Dr(Lt)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(B,X){B=B.replace(/^Root Entry[\/]/,""),p.keys.push(B),p.files[B]=e.FileIndex[X]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=wn(e,bs(a.vba[0]),!0):a.defaults&&a.defaults.bin===YR&&(p.vbaraw=wn(e,"xl/vbaProject.bin",!0))),p}function EW(e,t){var r=t||{},n="Workbook",a=Ct.find(e,n);try{if(n="/!DataSpaces/Version",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(sM(a.content),n="/!DataSpaces/DataSpaceMap",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=oM(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=lM(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);uM(a.content)}catch{}if(n="/EncryptionInfo",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=dM(a.content);if(n="/EncryptedPackage",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function TW(e,t){return t.bookType=="ods"?yC(e,t):t.bookType=="numbers"?NW(e,t):t.bookType=="xlsb"?PW(e,t):OW(e,t)}function PW(e,t){Vc=1024,e&&!e.SSF&&(e.SSF=Dr(Lt)),e&&e.SSF&&(bu(),ep(e.SSF),t.revssf=rp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ld?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Vk.indexOf(t.bookType)>-1,a=d2();j2(t=t||{});var s=Jy(),i="",o=0;if(t.cellXfs=[],sl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Gt(s,i,ck(e.Props,t)),a.coreprops.push(i),gr(t.rels,2,i,Kt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Gt(s,i,fk(e.Props)),a.extprops.push(i),gr(t.rels,3,i,Kt.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Gt(s,i,hk(e.Custprops)),a.custprops.push(i),gr(t.rels,4,i,Kt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Gt(s,i,o$(o-1,i,t,e,d)),a.sheets.push(i),gr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Kt.WS[0])}if(f){var h=f["!comments"],p=!1,g="";h&&h.length>0&&(g="xl/comments"+o+"."+r,Gt(s,g,u$(h,g)),a.comments.push(g),gr(d,-1,"../comments"+o+"."+r,Kt.CMNT),p=!0),f["!legacy"]&&p&&Gt(s,"xl/drawings/vmlDrawing"+o+".vml",qk(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Gt(s,Vd(i),Zc(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Gt(s,i,c$(t.Strings,i,t)),a.strs.push(i),gr(t.wbrels,-1,"sharedStrings."+r,Kt.SST)),i="xl/workbook."+r,Gt(s,i,i$(e,i)),a.workbooks.push(i),gr(t.rels,1,i,Kt.WB),i="xl/theme/theme1.xml",Gt(s,i,x2(e.Themes,t)),a.themes.push(i),gr(t.wbrels,-1,"theme/theme1.xml",Kt.THEME),i="xl/styles."+r,Gt(s,i,l$(e,i,t)),a.styles.push(i),gr(t.wbrels,-1,"styles."+r,Kt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Gt(s,i,e.vbaraw),a.vba.push(i),gr(t.wbrels,-1,"vbaProject.bin",Kt.VBA)),i="xl/metadata."+r,Gt(s,i,d$(i)),a.metadata.push(i),gr(t.wbrels,-1,"metadata."+r,Kt.XLMETA),Gt(s,"[Content_Types].xml",ik(a,t)),Gt(s,"_rels/.rels",Zc(t.rels)),Gt(s,"xl/_rels/workbook."+r+".rels",Zc(t.wbrels)),delete t.revssf,delete t.ssf,s}function OW(e,t){Vc=1024,e&&!e.SSF&&(e.SSF=Dr(Lt)),e&&e.SSF&&(bu(),ep(e.SSF),t.revssf=rp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ld?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Vk.indexOf(t.bookType)>-1,a=d2();j2(t=t||{});var s=Jy(),i="",o=0;if(t.cellXfs=[],sl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Gt(s,i,ck(e.Props,t)),a.coreprops.push(i),gr(t.rels,2,i,Kt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Gt(s,i,fk(e.Props)),a.extprops.push(i),gr(t.rels,3,i,Kt.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Gt(s,i,hk(e.Custprops)),a.custprops.push(i),gr(t.rels,4,i,Kt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Gt(s,i,aC(o-1,t,e,f)),a.sheets.push(i),gr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Kt.WS[0])}if(m){var p=m["!comments"],g=!1,v="";if(p&&p.length>0){var b=!1;p.forEach(function(S){S[1].forEach(function(_){_.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+o+"."+r,Gt(s,v,BR(p,d,t)),a.threadedcomments.push(v),gr(f,-1,"../threadedComments/threadedComment"+o+"."+r,Kt.TCMNT)),v="xl/comments"+o+"."+r,Gt(s,v,Gk(p)),a.comments.push(v),gr(f,-1,"../comments"+o+"."+r,Kt.CMNT),g=!0}m["!legacy"]&&g&&Gt(s,"xl/drawings/vmlDrawing"+o+".vml",qk(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&Gt(s,Vd(i),Zc(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Gt(s,i,Fk(t.Strings,t)),a.strs.push(i),gr(t.wbrels,-1,"sharedStrings."+r,Kt.SST)),i="xl/workbook."+r,Gt(s,i,cC(e)),a.workbooks.push(i),gr(t.rels,1,i,Kt.WB),i="xl/theme/theme1.xml",Gt(s,i,x2(e.Themes,t)),a.themes.push(i),gr(t.wbrels,-1,"theme/theme1.xml",Kt.THEME),i="xl/styles."+r,Gt(s,i,zk(e,t)),a.styles.push(i),gr(t.wbrels,-1,"styles."+r,Kt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Gt(s,i,e.vbaraw),a.vba.push(i),gr(t.wbrels,-1,"vbaProject.bin",Kt.VBA)),i="xl/metadata."+r,Gt(s,i,Hk()),a.metadata.push(i),gr(t.wbrels,-1,"metadata."+r,Kt.XLMETA),d.length>1&&(i="xl/persons/person.xml",Gt(s,i,zR(d)),a.people.push(i),gr(t.wbrels,-1,"persons/person.xml",Kt.PEOPLE)),Gt(s,"[Content_Types].xml",ik(a,t)),Gt(s,"_rels/.rels",Zc(t.rels)),Gt(s,"xl/_rels/workbook."+r+".rels",Zc(t.wbrels)),delete t.revssf,delete t.ssf,s}function k2(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=us(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function FW(e,t){return Ct.find(e,"EncryptedPackage")?EW(e,t):hC(e,t)}function IW(e,t){var r,n=e,a=t||{};return a.type||(a.type=Yt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Lj(n,a),CW(r,a)}function wC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return mv(e.slice(r),t);default:break e}return cu.to_workbook(e,t)}function LW(e,t){var r="",n=k2(e,t);switch(t.type){case"base64":r=us(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ul(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=_r(r)),t.type="binary",wC(r,t)}function DW(e,t){var r=e;return t.type=="base64"&&(r=us(r)),r=zd.utils.decode(1200,r.slice(2),"str"),t.type="binary",wC(r,t)}function MW(e){return e.match(/[^\x00-\x7F]/)?bi(e):e}function ax(e,t,r,n){return n?(r.type="string",cu.to_workbook(e,r)):cu.to_workbook(t,r)}function xv(e,t){Gy();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xv(new Uint8Array(e),(r=Dr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eu={},r.dateNF&&(eu.dateNF=r.dateNF),r.type||(r.type=Yt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Yt?"buffer":"binary",n=P7(e),typeof Uint8Array<"u"&&!Yt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=MW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Dr(r),r.type="array",xv(Vy(n),r)}switch((a=k2(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return FW(Ct.read(n,r),r);break;case 9:if(a[1]<=8)return hC(n,r);break;case 60:return mv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return $D(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Pk.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?IW(n,r):ax(e,n,r,s);case 239:return a[3]===60?mv(n,r):ax(e,n,r,s);case 255:if(a[1]===254)return DW(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Fl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Fl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return hv.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Rk.to_workbook(n,r);break;case 10:case 13:case 32:return LW(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return zD.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?hv.to_workbook(n,r):ax(e,n,r,s)}function SC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bf(t.file,Ct.write(e,{type:Yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ct.write(e,t)}function RW(e,t){var r=Dr(t||{}),n=TW(e,r);return BW(n,r)}function BW(e,t){var r={},n=Yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ct.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Qm(a))}return t.password&&typeof encrypt_agile<"u"?SC(encrypt_agile(a,t.password),t):t.type==="file"?bf(t.file,a):t.type=="string"?_r(a):a}function UW(e,t){var r=t||{},n=M$(e,r);return SC(n,r)}function gi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return $d(bi(n));case"binary":return bi(n);case"string":return e;case"file":return bf(t.file,n,"utf8");case"buffer":return Yt?uo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):gi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function zW(e,t){switch(t.type){case"base64":return $d(e);case"binary":return e;case"string":return e;case"file":return bf(t.file,e,"binary");case"buffer":return Yt?uo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?$d(r):t.type=="string"?_r(r):r;case"file":return bf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Cf(e,t){Gy(),Fz(e);var r=Dr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Cf(e,r);return r.type="array",Qm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return gi(T$(e,r),r);case"slk":case"sylk":return gi(Tk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return gi(pC(e.Sheets[e.SheetNames[a]],r),r);case"txt":return zW(_C(e.Sheets[e.SheetNames[a]],r),r);case"csv":return gi(C2(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return gi(Pk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return nh(hv.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return gi(cu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return gi(Rk.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return gi(Ok.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return gi(yC(e,r),r);case"wk1":return nh(Fl.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return nh(Fl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),nh(mC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),UW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $W(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function lp(e,t,r){var n={};return n.type="file",n.file=t,$W(n),Cf(e,n)}function WW(e,t,r,n,a,s,i,o){var c=mn(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var p=i?e[r][h]:e[n[h]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;s[h]!=null&&(m[s[h]]=u);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[h]!=null){if(g==null)if(p.t=="e"&&g===null)m[s[h]]=null;else if(u!==void 0)m[s[h]]=u;else if(d&&g===null)m[s[h]]=null;else continue;else m[s[h]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?g:eo(p,g,o);g!=null&&(f=!1)}}return{row:m,isempty:f}}function Qh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ir(d);break;case"number":c=ir(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=mn(c.s.r),m=[],h=[],p=0,g=0,v=Array.isArray(e),b=c.s.r,S=0,_={};v&&!e[b]&&(e[b]=[]);var E=u.skipHidden&&e["!cols"]||[],P=u.skipHidden&&e["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(E[S]||{}).hidden)switch(m[S]=qr(S),r=v?e[b][S]:e[m[S]+f],n){case 1:s[S]=S-c.s.c;break;case 2:s[S]=m[S];break;case 3:s[S]=u.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=eo(r,null,u),g=_[i]||0,!g)_[i]=1;else{do o=i+"_"+g++;while(_[o]);_[i]=g,_[o]=1}s[S]=o}for(b=c.s.r+a;b<=c.e.r;++b)if(!(P[b]||{}).hidden){var N=WW(e,c,b,m,n,s,v,u);(N.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[p++]=N.row)}return h.length=p,h}var TS=/"/g;function HW(e,t,r,n,a,s,i,o){for(var c=!0,u=[],d="",f=mn(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var h=o.dense?(e[r]||[])[m]:e[n[m]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(o.rawNumbers&&h.t=="n"?h.v:eo(h,null,o));for(var p=0,g=0;p!==d.length;++p)if((g=d.charCodeAt(p))===a||g===s||g===34||o.forceQuotes){d='"'+d.replace(TS,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(TS,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function C2(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ir(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(m[p]||{}).hidden||(f[p]=qr(p));for(var g=0,v=a.s.r;v<=a.e.r;++v)(h[v]||{}).hidden||(d=HW(e,a,v,f,i,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?o:"")+d)));return delete n.dense,r.join("")}function _C(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=C2(e,t);return r}function qW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ir(e["!ref"]),s="",i=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=qr(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=mn(d),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function NC(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gr(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=ir(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+a)}else i==-1&&(i=0,d.e.r=t.length-1+a);var m=n.header||[],h=0;t.forEach(function(g,v){an(g).forEach(function(b){(h=m.indexOf(b))==-1&&(m[h=m.length]=b);var S=g[b],_="z",E="",P=Mt({c:o+h,r:i+v+a});u=ef(s,P),S&&typeof S=="object"&&!(S instanceof Date)?s[P]=S:(typeof S=="number"?_="n":typeof S=="boolean"?_="b":typeof S=="string"?_="s":S instanceof Date?(_="d",n.cellDates||(_="n",S=In(S)),E=n.dateNF||Lt[14]):S===null&&n.nullError&&(_="e",S=0),u?(u.t=_,u.v=S,delete u.w,delete u.R,E&&(u.z=E)):s[P]=u={t:_,v:S},E&&(u.z=E))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var p=mn(i);if(a)for(h=0;h<m.length;++h)s[qr(h+o)+p]={t:"s",v:m[h]};return s["!ref"]=qt(d),s}function GW(e,t){return NC(null,e,t)}function ef(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Gr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ef(e,Mt(t)):ef(e,Mt({r:t,c:r||0}))}function VW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function E2(){return{SheetNames:[],Sheets:{}}}function T2(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(lC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function YW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=VW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function KW(e,t){return e.z=t,e}function AC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function XW(e,t,r){return AC(e,"#"+t,r)}function JW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ZW(e,t,r,n){for(var a=typeof t!="string"?t:ir(t),s=typeof t=="string"?t:qt(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=ef(e,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var rn={encode_col:qr,encode_row:mn,encode_cell:Mt,encode_range:qt,decode_col:s2,decode_row:a2,split_cell:cI,decode_cell:Gr,decode_range:Ga,format_cell:eo,sheet_add_aoa:Qj,sheet_add_json:NC,sheet_add_dom:gC,aoa_to_sheet:wu,json_to_sheet:GW,table_to_sheet:xC,table_to_book:sW,sheet_to_csv:C2,sheet_to_txt:_C,sheet_to_json:Qh,sheet_to_html:pC,sheet_to_formulae:qW,sheet_to_row_object_array:Qh,sheet_get_cell:ef,book_new:E2,book_append_sheet:T2,book_set_sheet_visibility:YW,cell_set_number_format:KW,cell_set_hyperlink:AC,cell_set_internal_link:XW,cell_add_comment:JW,sheet_set_array_formula:ZW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const QW=()=>{const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState([]),[m,h]=y.useState(""),[p,g]=y.useState([]),[v,b]=y.useState(""),[S,_]=y.useState([]),[E,P]=y.useState(""),[N,I]=y.useState([]),[k,T]=y.useState(0),[q,F]=y.useState([]),[j,U]=y.useState(!1),[B,X]=y.useState(!1),[K,ee]=y.useState(null);y.useEffect(()=>{const R=localStorage.getItem("academicYear")||"",H=localStorage.getItem("user");let J="All";if(H)try{const G=JSON.parse(H);if(G.role==="Admin"||G.branch==="All"||G.branch==="AllBranches"){const Q=localStorage.getItem("currentBranch");Q&&Q!=="All"&&Q!=="All Locations"&&(J=Q)}else J=G.branch||"All";G.role}catch(G){console.error("Error parsing user",G)}t(R),s(J),n([{branch_name:J,branch_code:J}])},[]),y.useEffect(()=>{a&&ke.get(`/classes?branch=${a}`).then(R=>o(R.data.classes||R.data)).catch(R=>console.error(R))},[a]),y.useEffect(()=>{const R=i.find(H=>H.id==c);if(!R){f([]);return}ke.get(`/sections?class=${R.class_name}`).then(H=>f(H.data.sections||[])).catch(H=>{console.error(H),f([])})},[c,i]),y.useEffect(()=>{!c||!e||ke.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:c}}).then(R=>{g(R.data)}).catch(R=>console.error(R))},[c,e,a]),y.useEffect(()=>{if(!v){_([]);return}const R=p.find(H=>H.test_id==v);R&&R.subjects?_(R.subjects):_([])},[v,p]);const[Y,z]=y.useState(null),ne=()=>{if(!v||!E){ee({type:"error",text:"Please select Test and Subject"});return}U(!0),ee(null),z(null),I([]),ke.get("/marks/entry/subject",{params:{academic_year:e,branch:a,class_id:c,section:m,test_id:v,subject_id:E}}).then(R=>{I(R.data.students),T(R.data.subject_total_marks),F(R.data.grading_scale),z(R.data.class_test_id)}).catch(R=>{var H,J;console.error(R),ee({type:"error",text:((J=(H=R.response)==null?void 0:H.data)==null?void 0:J.error)||"Failed to load marks"})}).finally(()=>U(!1))},le=(R,H)=>{I(J=>J.map(G=>G.student_id!==R?G:{...G,marks_obtained:H}))},A=R=>{I(H=>H.map(J=>{if(J.student_id!==R)return J;let G=J.marks_obtained,Q=!1;if(typeof G=="string"){const V=G.trim().toUpperCase();if(V==="AB")Q=!0,G="AB";else if(V==="")G="";else{const Ee=parseFloat(V);if(!isNaN(Ee)&&isFinite(Ee)){let we=Math.round(Ee);we<0&&(we=0),we>k?(alert(`Marks cannot exceed ${k}`),G=""):G=String(we)}else G=""}}let de="";if(!Q){if(G!==""&&G!==null&&G!==void 0){const V=parseInt(String(G),10),Ee=q.find(we=>V>=we.min&&V<=we.max);Ee&&(de=Ee.grade)}}return{...J,marks_obtained:G,is_absent:Q,grade:de}}))},D=()=>{if(N.length===0)return;if(!Y){ee({type:"error",text:"Internal Error: Missing Class Test ID. Please reload data."});return}X(!0),ee(null);const R={class_test_id:Y,subject_id:E,academic_year:e,branch:a,class_id:c,section:m,user_id:1,marks:N.map(H=>({student_id:H.student_id,value:H.is_absent?"AB":H.marks_obtained}))};ke.post("/marks/entry/subject",R).then(H=>{ee({type:"success",text:"Marks saved successfully!"})}).catch(H=>{var J,G;console.error(H),ee({type:"error",text:((G=(J=H.response)==null?void 0:J.data)==null?void 0:G.error)||"Failed to save marks"})}).finally(()=>X(!1))},L=()=>{ne()},M=()=>{var we,he,Z;if(N.length===0){ee({type:"error",text:"No data to download."});return}const R=((we=i.find(Se=>Se.id==c))==null?void 0:we.class_name)||"Class",H=((he=S.find(Se=>Se.id==E))==null?void 0:he.subject_name)||"Subject",J=((Z=p.find(Se=>Se.test_id==v))==null?void 0:Z.test_name)||"Test",G=["S.No","Roll No","Admission No","Student Name","Marks","Grade","Status"],Q=N.map((Se,ge)=>[ge+1,Se.roll_number,Se.admission_no,Se.name,Se.is_absent?"AB":Se.marks_obtained,Se.grade||"-",Se.is_absent?"Absent":Se.marks_obtained!==""&&Se.marks_obtained!==null&&Se.marks_obtained!==void 0?"Present":"-"]),de=rn.aoa_to_sheet([G,...Q]),V=rn.book_new();rn.book_append_sheet(V,de,"Marks");const Ee=`${R}_${H}_${J}_Marks.xlsx`;lp(V,Ee)};return l.jsxs("div",{className:"p-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4 border-b pb-2",children:"Enter Subject Marks"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6 bg-white p-4 rounded shadow-sm",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),l.jsx("select",{value:a,onChange:R=>s(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",disabled:r.length<=1,children:r.map(R=>l.jsx("option",{value:R.branch_code,children:R.branch_name},R.branch_code))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Class"}),i.map(R=>l.jsx("option",{value:R.id,children:R.class_name},R.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:m,onChange:R=>h(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Section"}),d.map(R=>l.jsx("option",{value:R,children:R},R))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test"}),l.jsxs("select",{value:v,onChange:R=>b(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Test"}),p.map(R=>l.jsx("option",{value:R.test_id,children:R.test_name},R.test_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),l.jsxs("select",{value:E,onChange:R=>P(R.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Subject"}),S.map(R=>l.jsx("option",{value:R.id,children:R.subject_name},R.id))]})]})]}),l.jsx("div",{className:"mb-4",children:l.jsx("button",{type:"button",onClick:ne,disabled:j||!v||!E,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400",children:j?"Loading...":"Get Marks"})}),K&&l.jsx("div",{className:`p-3 rounded mb-4 ${K.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:K.text}),N.length>0&&l.jsxs("div",{className:"bg-white shadow rounded overflow-hidden",children:[l.jsxs("div",{className:"p-3 bg-gray-50 border-b flex justify-between items-center",children:[l.jsxs("span",{className:"font-semibold text-gray-700",children:["Max Marks: ",k]}),l.jsxs("div",{className:"text-sm text-gray-500",children:["Valid inputs: 0-",k,', "AB" (Absent)']})]}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S.No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admission No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marks"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map((R,H)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H+1}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R.roll_number}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R.admission_no}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:R.name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"text",value:R.is_absent?"AB":R.marks_obtained!==null&&R.marks_obtained!==void 0?String(R.marks_obtained).split(".")[0]:"",onChange:J=>le(R.student_id,J.target.value),onBlur:()=>A(R.student_id),className:`border rounded px-2 py-1 w-24 focus:outline-none focus:ring-2 
                                                ${R.is_absent?"bg-red-50 border-red-300 text-red-700 font-bold":"border-gray-300"}
                                            `,placeholder:"-"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 font-bold",children:R.grade||"-"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:R.is_absent?l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Absent"}):R.marks_obtained!==""&&R.marks_obtained!==null&&R.marks_obtained!==void 0?l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Present"}):l.jsx("span",{className:"text-gray-400",children:"-"})})]},R.student_id))})]}),l.jsxs("div",{className:"p-4 bg-gray-50 border-t flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:L,disabled:B,className:`bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 flex items-center gap-2 ${B?"opacity-50 cursor-not-allowed":""}`,children:"Cancel"}),l.jsxs("button",{type:"button",onClick:M,disabled:B||N.length===0,className:`bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 flex items-center gap-2 ${B||N.length===0?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(Wy,{size:18}),"Download Excel"]}),l.jsxs("button",{type:"button",onClick:D,disabled:B,className:`bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 flex items-center gap-2 ${B?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(ec,{size:18}),B?"Saving...":"Save Marks"]})]})]})]})},eH=()=>{const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState([]),[m,h]=y.useState(""),[p,g]=y.useState([]),[v,b]=y.useState(""),[S,_]=y.useState([]),[E,P]=y.useState(""),[N,I]=y.useState([]),[k,T]=y.useState(0),[q,F]=y.useState([]),[j,U]=y.useState(null),[B,X]=y.useState(!1),[K,ee]=y.useState(!1),[Y,z]=y.useState(null),ne=y.useRef(null);y.useEffect(()=>{const L=localStorage.getItem("academicYear")||"",M=localStorage.getItem("user");let R="All";if(M)try{const H=JSON.parse(M);if(H.role==="Admin"||H.branch==="All"||H.branch==="AllBranches"){const J=localStorage.getItem("currentBranch");J&&J!=="All"&&J!=="All Locations"&&(R=J)}else R=H.branch||"All"}catch(H){console.error("Error parsing user",H)}t(L),s(R),n([{branch_name:R,branch_code:R}])},[]),y.useEffect(()=>{a&&ke.get(`/classes?branch=${a}`).then(L=>o(L.data.classes||L.data)).catch(L=>console.error(L))},[a]),y.useEffect(()=>{!c||!e||ke.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:c}}).then(L=>g(L.data)).catch(L=>console.error(L))},[c,e,a]),y.useEffect(()=>{if(!v){_([]);return}const L=p.find(M=>M.test_id==v);L&&L.subjects?_(L.subjects):_([])},[v,p]),y.useEffect(()=>{!v||!E||!c||(X(!0),ke.get("/marks/entry/subject",{params:{academic_year:e,branch:a,class_id:c,section:m,test_id:v,subject_id:E}}).then(L=>{I(L.data.students),T(L.data.subject_total_marks),F(L.data.grading_scale),U(L.data.class_test_id)}).catch(L=>{console.error(L),z({type:"error",text:"Failed to load class configuration."})}).finally(()=>X(!1)))},[v,E,c,m]);const le=()=>{var V,Ee,we;if(N.length===0){z({type:"error",text:"No students found to generate template."});return}const L=((V=i.find(he=>he.id==c))==null?void 0:V.class_name)||"Class",M=((Ee=S.find(he=>he.id==E))==null?void 0:Ee.subject_name)||"Subject",R=((we=p.find(he=>he.test_id==v))==null?void 0:we.test_name)||"Test",H=["Student ID","Roll No","Admission No","Student Name","Marks (Max: "+k+")"],J=N.map(he=>[he.student_id,he.roll_number,he.admission_no,he.name,""]),G=rn.aoa_to_sheet([H,...J]),Q=rn.book_new();rn.book_append_sheet(Q,G,"MarksEntry");const de=`${L}_${M}_${R}_Template.xlsx`;lp(Q,de)},A=()=>{ne.current&&(ne.current.value="",ne.current.click())},D=L=>{var H;const M=(H=L.target.files)==null?void 0:H[0];if(!M)return;if(!j){z({type:"error",text:"System Error: Missing active class test ID."});return}ee(!0),z(null);const R=new FileReader;R.onload=J=>{var G;try{const Q=(G=J.target)==null?void 0:G.result,de=xv(Q,{type:"binary"}),V=de.SheetNames[0],Ee=de.Sheets[V],we=rn.sheet_to_json(Ee,{header:1}),he=[];let Z=[];for(let ge=1;ge<we.length;ge++){const pe=we[ge];if(!pe||pe.length===0)continue;const Ae=parseInt(pe[0]);let Le=pe[4];const Pe=N.find(et=>et.student_id===Ae);if(!Pe)continue;let Oe="",Ve=!1;if(!(Le==null||String(Le).trim()==="")){{const et=String(Le).trim().toUpperCase();if(et==="AB"||et==="ABSENT")Ve=!0,Oe="AB";else{const _t=parseFloat(et);if(isNaN(_t)){Z.push(`Row ${ge+1}: Invalid mark '${Le}' for ${Pe.name}`);continue}if(_t<0||_t>k){Z.push(`Row ${ge+1}: Mark ${_t} exceeds max ${k} for ${Pe.name}`);continue}Oe=_t}}he.push({student_id:Ae,value:Ve?"AB":Oe})}}if(Z.length>0){alert(`Issues found in Excel:
`+Z.slice(0,10).join(`
`)),ee(!1);return}if(he.length===0){z({type:"error",text:"No valid marks found in file."}),ee(!1);return}const Se={class_test_id:j,subject_id:E,academic_year:e,branch:a,class_id:c,user_id:1,marks:he};ke.post("/marks/entry/subject",Se).then(ge=>{z({type:"success",text:`Successfully saved marks for ${he.length} students!`})}).catch(ge=>{var pe,Ae;console.error(ge),z({type:"error",text:((Ae=(pe=ge.response)==null?void 0:pe.data)==null?void 0:Ae.error)||"Failed to save marks"})}).finally(()=>ee(!1))}catch(Q){console.error(Q),z({type:"error",text:"Failed to parse Excel file."}),ee(!1)}},R.readAsBinaryString(M)};return l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"mb-6 bg-rose-50 border border-rose-200 p-4 rounded text-sm text-gray-700",children:[l.jsx("h3",{className:"text-red-600 font-bold mb-2",children:"Important!!"}),l.jsx("p",{className:"mb-1 text-gray-800 font-medium",children:"Note :Please read the following instructions:"}),l.jsxs("ul",{className:"list-decimal pl-5 space-y-1",children:[l.jsx("li",{children:"Please don't make any changes in given template."}),l.jsx("li",{children:"Only 80 records are accepted in the list at a time."}),l.jsx("li",{children:"The data should be in valid format to upload successfully."}),l.jsx("li",{children:"For Ispresent column enter score for Absent  use 'AB' in Marks column"}),l.jsx("li",{children:"In mark column you can enter mark, grade and absent remark."})]})]}),l.jsxs("h2",{className:"text-xl font-bold text-gray-700 mb-4 flex items-center gap-2",children:[l.jsx(w5,{size:24,className:"text-blue-600"}),"Import Subject Marks"]}),l.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Class ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:c,onChange:L=>u(L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Class"}),i.map(L=>l.jsx("option",{value:L.id,children:L.class_name},L.id))]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Schedule Test ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:v,onChange:L=>b(L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Test"}),p.map(L=>l.jsx("option",{value:L.test_id,children:L.test_name},L.test_id))]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Subject ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:E,onChange:L=>P(L.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 bg-white",children:[l.jsx("option",{value:"",children:"Select Subject"}),S.map(L=>l.jsx("option",{value:L.id,children:L.subject_name},L.id))]})]})]}),l.jsxs("div",{className:"flex flex-col md:flex-row items-end gap-4 border-t pt-4",children:[l.jsxs("div",{className:"flex-1 w-full",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Browse for the excel sheet:"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",readOnly:!0,placeholder:"No file chosen",className:"block w-full rounded-md border-gray-300 shadow-sm sm:text-sm border p-2 bg-gray-50 text-gray-500"}),l.jsx("input",{type:"file",ref:ne,style:{display:"none"},accept:".xlsx, .xls",onChange:D}),l.jsx("button",{type:"button",onClick:A,className:"bg-gray-200 border border-gray-300 text-gray-700 px-3 py-2 rounded hover:bg-gray-300 text-xs whitespace-nowrap",children:"Choose File"})]})]}),l.jsx("button",{type:"button",onClick:A,disabled:K||!v||!E,className:`bg-blue-500 text-white px-6 py-2.5 rounded hover:bg-blue-600 flex items-center gap-2 font-medium ${K||!v?"opacity-50 cursor-not-allowed":""}`,children:K?"Uploading...":"Upload Excel"}),l.jsxs("button",{type:"button",onClick:le,disabled:B||!v||N.length===0,className:`bg-emerald-500 text-white px-6 py-2.5 rounded hover:bg-emerald-600 flex items-center gap-2 font-medium ${N.length===0?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(Wy,{size:18}),"Download Template"]})]})]}),Y&&l.jsxs("div",{className:`p-3 rounded mb-4 flex items-center gap-2 ${Y.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[Y.type==="error"?l.jsx(Uh,{size:18}):l.jsx(w5,{size:18}),Y.text]})]})};function jC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=jC(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=jC(e))&&(n&&(n+=" "),n+=t);return n}var tH=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function P2(e){if(typeof e!="string")return!1;var t=tH;return t.includes(e)}var rH=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],nH=new Set(rH);function kC(e){return typeof e!="string"?!1:nH.has(e)}function CC(e){return typeof e=="string"&&e.startsWith("data-")}function ds(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(kC(r)||CC(r))&&(t[r]=e[r]);return t}function ql(e){if(e==null)return null;if(y.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return ds(t)}return typeof e=="object"&&!Array.isArray(e)?ds(e):null}function La(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(kC(r)||CC(r)||P2(r))&&(t[r]=e[r]);return t}function aH(e){return e==null?null:y.isValidElement(e)?La(e.props):typeof e=="object"&&!Array.isArray(e)?La(e):null}var sH=["children","width","height","viewBox","className","style","title","desc"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(null,arguments)}function iH(e,t){if(e==null)return{};var r,n,a=oH(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var O2=y.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:s,className:i,style:o,title:c,desc:u}=e,d=iH(e,sH),f=s||{width:n,height:a,x:0,y:0},m=lr("recharts-surface",i);return y.createElement("svg",vv({},La(d),{className:m,width:n,height:a,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),y.createElement("title",null,c),y.createElement("desc",null,u),r)}),lH=["children","className"];function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yv.apply(null,arguments)}function cH(e,t){if(e==null)return{};var r,n,a=uH(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Qn=y.forwardRef((e,t)=>{var{children:r,className:n}=e,a=cH(e,lH),s=lr("recharts-layer",n);return y.createElement("g",yv({className:s},La(a),{ref:t}),r)}),EC=y.createContext(null),dH=()=>y.useContext(EC);function Tr(e){return function(){return e}}const TC=Math.cos,em=Math.sin,ai=Math.sqrt,tm=Math.PI,cp=2*tm,bv=Math.PI,wv=2*bv,yl=1e-6,fH=wv-yl;function PC(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function hH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return PC;const r=10**t;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class mH{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?PC:hH(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,s,i){this._append`C${+t},${+r},${+n},${+a},${this._x1=+s},${this._y1=+i}`}arcTo(t,r,n,a,s){if(t=+t,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let i=this._x1,o=this._y1,c=n-t,u=a-r,d=i-t,f=o-r,m=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>yl)if(!(Math.abs(f*c-u*d)>yl)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-i,p=a-o,g=c*c+u*u,v=h*h+p*p,b=Math.sqrt(g),S=Math.sqrt(m),_=s*Math.tan((bv-Math.acos((g+m-v)/(2*b*S)))/2),E=_/S,P=_/b;Math.abs(E-1)>yl&&this._append`L${t+E*d},${r+E*f}`,this._append`A${s},${s},0,0,${+(f*h>d*p)},${this._x1=t+P*c},${this._y1=r+P*u}`}}arc(t,r,n,a,s,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,d=r+c,f=1^i,m=i?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>yl||Math.abs(this._y1-d)>yl)&&this._append`L${u},${d}`,n&&(m<0&&(m=m%wv+wv),m>fH?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:m>yl&&this._append`A${n},${n},0,${+(m>=bv)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function F2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new mH(t)}function I2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function OC(e){this._context=e}OC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function up(e){return new OC(e)}function FC(e){return e[0]}function IC(e){return e[1]}function LC(e,t){var r=Tr(!0),n=null,a=up,s=null,i=F2(o);e=typeof e=="function"?e:e===void 0?FC:Tr(e),t=typeof t=="function"?t:t===void 0?IC:Tr(t);function o(c){var u,d=(c=I2(c)).length,f,m=!1,h;for(n==null&&(s=a(h=i())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(f,u,c),+t(f,u,c));if(h)return s=null,h+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Tr(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Tr(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Tr(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),o):n},o}function ah(e,t,r){var n=null,a=Tr(!0),s=null,i=up,o=null,c=F2(u);e=typeof e=="function"?e:e===void 0?FC:Tr(+e),t=typeof t=="function"?t:Tr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?IC:Tr(+r);function u(f){var m,h,p,g=(f=I2(f)).length,v,b=!1,S,_=new Array(g),E=new Array(g);for(s==null&&(o=i(S=c())),m=0;m<=g;++m){if(!(m<g&&a(v=f[m],m,f))===b)if(b=!b)h=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=m-1;p>=h;--p)o.point(_[p],E[p]);o.lineEnd(),o.areaEnd()}b&&(_[m]=+e(v,m,f),E[m]=+t(v,m,f),o.point(n?+n(v,m,f):_[m],r?+r(v,m,f):E[m]))}if(S)return o=null,S+""||null}function d(){return LC().defined(a).curve(i).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Tr(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Tr(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Tr(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Tr(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Tr(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Tr(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Tr(!!f),u):a},u.curve=function(f){return arguments.length?(i=f,s!=null&&(o=i(s)),u):i},u.context=function(f){return arguments.length?(f==null?s=o=null:o=i(s=f),u):s},u}class DC{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function pH(e){return new DC(e,!0)}function gH(e){return new DC(e,!1)}const L2={draw(e,t){const r=ai(t/tm);e.moveTo(r,0),e.arc(0,0,r,0,cp)}},xH={draw(e,t){const r=ai(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},MC=ai(1/3),vH=MC*2,yH={draw(e,t){const r=ai(t/vH),n=r*MC;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},bH={draw(e,t){const r=ai(t),n=-r/2;e.rect(n,n,r,r)}},wH=.8908130915292852,RC=em(tm/10)/em(7*tm/10),SH=em(cp/10)*RC,_H=-TC(cp/10)*RC,NH={draw(e,t){const r=ai(t*wH),n=SH*r,a=_H*r;e.moveTo(0,-r),e.lineTo(n,a);for(let s=1;s<5;++s){const i=cp*s/5,o=TC(i),c=em(i);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},sx=ai(3),AH={draw(e,t){const r=-ai(t/(sx*3));e.moveTo(0,r*2),e.lineTo(-sx*r,-r),e.lineTo(sx*r,-r),e.closePath()}},ws=-.5,Ss=ai(3)/2,Sv=1/ai(12),jH=(Sv/2+1)*3,kH={draw(e,t){const r=ai(t/jH),n=r/2,a=r*Sv,s=n,i=r*Sv+r,o=-s,c=i;e.moveTo(n,a),e.lineTo(s,i),e.lineTo(o,c),e.lineTo(ws*n-Ss*a,Ss*n+ws*a),e.lineTo(ws*s-Ss*i,Ss*s+ws*i),e.lineTo(ws*o-Ss*c,Ss*o+ws*c),e.lineTo(ws*n+Ss*a,ws*a-Ss*n),e.lineTo(ws*s+Ss*i,ws*i-Ss*s),e.lineTo(ws*o+Ss*c,ws*c-Ss*o),e.closePath()}};function CH(e,t){let r=null,n=F2(a);e=typeof e=="function"?e:Tr(e||L2),t=typeof t=="function"?t:Tr(t===void 0?64:+t);function a(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:Tr(s),a):e},a.size=function(s){return arguments.length?(t=typeof s=="function"?s:Tr(+s),a):t},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function rm(){}function nm(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function BC(e){this._context=e}BC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:nm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:nm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function EH(e){return new BC(e)}function UC(e){this._context=e}UC.prototype={areaStart:rm,areaEnd:rm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:nm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TH(e){return new UC(e)}function zC(e){this._context=e}zC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:nm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PH(e){return new zC(e)}function $C(e){this._context=e}$C.prototype={areaStart:rm,areaEnd:rm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function OH(e){return new $C(e)}function PS(e){return e<0?-1:1}function OS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(n||a<0&&-0),i=(r-e._y1)/(a||n<0&&-0),o=(s*a+i*n)/(n+a);return(PS(s)+PS(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(o))||0}function FS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function ix(e,t,r){var n=e._x0,a=e._y0,s=e._x1,i=e._y1,o=(s-n)/3;e._context.bezierCurveTo(n+o,a+o*t,s-o,i-o*r,s,i)}function am(e){this._context=e}am.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ix(this,this._t0,FS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ix(this,FS(this,r=OS(this,e,t)),r);break;default:ix(this,this._t0,r=OS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function WC(e){this._context=new HC(e)}(WC.prototype=Object.create(am.prototype)).point=function(e,t){am.prototype.point.call(this,t,e)};function HC(e){this._context=e}HC.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,s){this._context.bezierCurveTo(t,e,n,r,s,a)}};function FH(e){return new am(e)}function IH(e){return new WC(e)}function qC(e){this._context=e}qC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=IS(e),a=IS(t),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function IS(e){var t,r=e.length-1,n,a=new Array(r),s=new Array(r),i=new Array(r);for(a[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,i[t]-=n*i[t-1];for(a[r-1]=i[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(i[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function LH(e){return new qC(e)}function dp(e,t){this._context=e,this._t=t}dp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function DH(e){return new dp(e,.5)}function MH(e){return new dp(e,0)}function RH(e){return new dp(e,1)}function Gl(e,t){if((i=e.length)>1)for(var r=1,n,a,s=e[t[0]],i,o=s.length;r<i;++r)for(a=s,s=e[t[r]],n=0;n<o;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function _v(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function BH(e,t){return e[t]}function UH(e){const t=[];return t.key=e,t}function zH(){var e=Tr([]),t=_v,r=Gl,n=BH;function a(s){var i=Array.from(e.apply(this,arguments),UH),o,c=i.length,u=-1,d;for(const f of s)for(o=0,++u;o<c;++o)(i[o][u]=[0,+n(f,i[o].key,u,s)]).data=f;for(o=0,d=I2(t(i));o<c;++o)i[d[o]].index=o;return r(i,d),i}return a.keys=function(s){return arguments.length?(e=typeof s=="function"?s:Tr(Array.from(s)),a):e},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:Tr(+s),a):n},a.order=function(s){return arguments.length?(t=s==null?_v:typeof s=="function"?s:Tr(Array.from(s)),a):t},a.offset=function(s){return arguments.length?(r=s??Gl,a):r},a}function $H(e,t){if((n=e.length)>0){for(var r,n,a=0,s=e[0].length,i;a<s;++a){for(i=r=0;r<n;++r)i+=e[r][a][1]||0;if(i)for(r=0;r<n;++r)e[r][a][1]/=i}Gl(e,t)}}function WH(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,s=n.length;r<s;++r){for(var i=0,o=0;i<a;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}Gl(e,t)}}function HH(e,t){if(!(!((i=e.length)>0)||!((s=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,s,i;n<s;++n){for(var o=0,c=0,u=0;o<i;++o){for(var d=e[t[o]],f=d[n][1]||0,m=d[n-1][1]||0,h=(f-m)/2,p=0;p<o;++p){var g=e[t[p]],v=g[n][1]||0,b=g[n-1][1]||0;h+=v-b}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Gl(e,t)}}var ox={},lx={},LS;function qH(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(lx)),lx}var cx={},DS;function GC(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(cx)),cx}var ux={},MS;function D2(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(ux)),ux}var dx={},fx={},RS;function GH(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(fx)),fx}var BS;function M2(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GH(),r=D2();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const s=[],i=a.length;if(i===0)return s;let o=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),o++);o<i;){const f=a[o];u?f==="\\"&&o+1<i?(o++,c+=a[o]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,o++}return c&&s.push(c),s}e.toPath=n})(dx)),dx}var US;function R2(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qH(),r=GC(),n=D2(),a=M2();function s(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?s(o,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return i(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function i(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})(ox)),ox}var hx,zS;function VH(){return zS||(zS=1,hx=R2().get),hx}var YH=VH();const Vl=co(YH);var KH=4;function Wo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KH,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Qr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,s,i)=>{var o=r[i-1];return typeof o=="string"?a+o+s:o!==void 0?a+Wo(o)+s:a+s},"")}var Zn=e=>e===0?0:e>0?1:-1,ri=e=>typeof e=="number"&&e!=+e,to=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,bt=e=>(typeof e=="number"||e instanceof Number)&&!ri(e),Ai=e=>bt(e)||typeof e=="string",XH=0,tf=e=>{var t=++XH;return"".concat(e||"").concat(t)},_a=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!bt(t)&&typeof t!="string")return n;var s;if(to(t)){if(r==null)return n;var i=t.indexOf("%");s=r*parseFloat(t.slice(0,i))/100}else s=+t;return ri(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},VC=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Ur(e,t,r){return bt(e)&&bt(t)?Wo(e+r*(t-e)):t}function YC(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Vl(n,t))===r)}var $r=e=>e===null||typeof e>"u",Ef=e=>$r(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function JH(e){return e!=null}function Tf(){}var ZH=["type","size","sizeType"];function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nv.apply(null,arguments)}function $S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$S(Object(r),!0).forEach(function(n){QH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$S(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QH(e,t,r){return(t=eq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eq(e){var t=tq(e,"string");return typeof t=="symbol"?t:t+""}function tq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rq(e,t){if(e==null)return{};var r,n,a=nq(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KC={symbolCircle:L2,symbolCross:xH,symbolDiamond:yH,symbolSquare:bH,symbolStar:NH,symbolTriangle:AH,symbolWye:kH},aq=Math.PI/180,sq=e=>{var t="symbol".concat(Ef(e));return KC[t]||L2},iq=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*aq;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},oq=(e,t)=>{KC["symbol".concat(Ef(e))]=t},B2=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=rq(e,ZH),s=WS(WS({},a),{},{type:t,size:r,sizeType:n}),i="circle";typeof t=="string"&&(i=t);var o=()=>{var m=sq(i),h=CH().type(m).size(iq(r,n,i)),p=h();if(p!==null)return p},{className:c,cx:u,cy:d}=s,f=La(s);return bt(u)&&bt(d)&&bt(r)?y.createElement("path",Nv({},f,{className:lr("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};B2.registerSymbol=oq;var XC=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,U2=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(y.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{P2(a)&&(n[a]=(s=>r[a](r,s)))}),n},lq=(e,t,r)=>n=>(e(t,r,n),null),Pf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var s=e[a];P2(a)&&typeof s=="function"&&(n||(n={}),n[a]=lq(s,t,r))}),n};function HS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HS(Object(r),!0).forEach(function(n){uq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uq(e,t,r){return(t=dq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dq(e){var t=fq(e,"string");return typeof t=="symbol"?t:t+""}function fq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kn(e,t){var r=cq({},e),n=t,a=Object.keys(t),s=a.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return s}function sm(){return sm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sm.apply(null,arguments)}function qS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qS(Object(r),!0).forEach(function(n){mq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mq(e,t,r){return(t=pq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pq(e){var t=gq(e,"string");return typeof t=="symbol"?t:t+""}function gq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ks=32,xq={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function vq(e){var{data:t,iconType:r,inactiveColor:n}=e,a=ks/2,s=ks/6,i=ks/3,o=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return y.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:ks,y2:a,className:"recharts-legend-icon"})}if(c==="line")return y.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*i,",").concat(a,`
            H`).concat(ks,"M").concat(2*i,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return y.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(ks/8,"h").concat(ks,"v").concat(ks*3/4,"h").concat(-ks,"z"),className:"recharts-legend-icon"});if(y.isValidElement(t.legendIcon)){var d=hq({},t);return delete d.legendIcon,y.cloneElement(t.legendIcon,d)}return y.createElement(B2,{fill:o,cx:a,cy:a,size:ks,sizeType:"diameter",type:c})}function yq(e){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:i}=e,o={x:0,y:0,width:ks,height:ks},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var m=d.formatter||a,h=lr({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var p=d.inactive?s:d.color,g=m?m(d.value,d,f):d.value;return y.createElement("li",sm({className:h,style:c,key:"legend-item-".concat(f)},Pf(e,d,f)),y.createElement(O2,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(g," legend icon")},y.createElement(vq,{data:d,iconType:i,inactiveColor:s})),y.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},g))})}var bq=e=>{var t=kn(e,xq),{payload:r,layout:n,align:a}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return y.createElement("ul",{className:"recharts-default-legend",style:s},y.createElement(yq,sm({},t,{payload:r})))},mx={},px={},GS;function wq(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let s=0;s<r.length;s++){const i=r[s],o=n(i,s,r);a.has(o)||a.set(o,i)}return Array.from(a.values())}e.uniqBy=t})(px)),px}var gx={},VS;function Sq(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(gx)),gx}var xx={},YS;function JC(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(xx)),xx}var vx={},yx={},bx={},KS;function _q(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(bx)),bx}var XS;function z2(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_q();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(yx)),yx}var wx={},JS;function Nq(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(wx)),wx}var ZS;function Aq(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z2(),r=Nq();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(vx)),vx}var Sx={},_x={},QS;function jq(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R2();function r(n){return function(a){return t.get(a,n)}}e.property=r})(_x)),_x}var Nx={},Ax={},jx={},kx={},e_;function ZC(){return e_||(e_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(kx)),kx}var Cx={},t_;function QC(){return t_||(t_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Cx)),Cx}var Ex={},r_;function e6(){return r_||(r_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(Ex)),Ex}var n_;function kq(){return n_||(n_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZC(),r=QC(),n=e6();function a(d,f,m){return typeof m!="function"?a(d,f,()=>{}):s(d,f,function h(p,g,v,b,S,_){const E=m(p,g,v,b,S,_);return E!==void 0?!!E:s(p,g,h,_)},new Map)}function s(d,f,m,h){if(f===d)return!0;switch(typeof f){case"object":return i(d,f,m,h);case"function":return Object.keys(f).length>0?s(d,{...f},m,h):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function i(d,f,m,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,m,h);if(f instanceof Map)return o(d,f,m,h);if(f instanceof Set)return u(d,f,m,h);const p=Object.keys(f);if(d==null||r.isPrimitive(d))return p.length===0;if(p.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let g=0;g<p.length;g++){const v=p[g];if(!r.isPrimitive(d)&&!(v in d)||f[v]===void 0&&d[v]!==void 0||f[v]===null&&d[v]!==null||!m(d[v],f[v],v,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function o(d,f,m,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[p,g]of f.entries()){const v=d.get(p);if(m(v,g,p,d,f,h)===!1)return!1}return!0}function c(d,f,m,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const p=new Set;for(let g=0;g<f.length;g++){const v=f[g];let b=!1;for(let S=0;S<d.length;S++){if(p.has(S))continue;const _=d[S];let E=!1;if(m(_,v,g,d,f,h)&&(E=!0),E){p.add(S),b=!0;break}}if(!b)return!1}return!0}function u(d,f,m,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],m,h):!1}e.isMatchWith=a,e.isSetMatch=u})(jx)),jx}var a_;function t6(){return a_||(a_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kq();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Ax)),Ax}var Tx={},Px={},Ox={},s_;function Cq(){return s_||(s_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Ox)),Ox}var Fx={},i_;function $2(){return i_||(i_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Fx)),Fx}var Ix={},o_;function r6(){return o_||(o_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",i="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",m="[object ArrayBuffer]",h="[object Object]",p="[object Error]",g="[object DataView]",v="[object Uint8Array]",b="[object Uint8ClampedArray]",S="[object Uint16Array]",_="[object Uint32Array]",E="[object BigUint64Array]",P="[object Int8Array]",N="[object Int16Array]",I="[object Int32Array]",k="[object BigInt64Array]",T="[object Float32Array]",q="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=m,e.arrayTag=d,e.bigInt64ArrayTag=k,e.bigUint64ArrayTag=E,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=p,e.float32ArrayTag=T,e.float64ArrayTag=q,e.functionTag=f,e.int16ArrayTag=N,e.int32ArrayTag=I,e.int8ArrayTag=P,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=S,e.uint32ArrayTag=_,e.uint8ArrayTag=v,e.uint8ClampedArrayTag=b})(Ix)),Ix}var Lx={},l_;function Eq(){return l_||(l_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Lx)),Lx}var c_;function n6(){return c_||(c_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Cq(),r=$2(),n=r6(),a=QC(),s=Eq();function i(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,m,h=new Map,p=void 0){const g=p==null?void 0:p(d,f,m,h);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const v=new Array(d.length);h.set(d,v);for(let b=0;b<d.length;b++)v[b]=o(d[b],b,m,h,p);return Object.hasOwn(d,"index")&&(v.index=d.index),Object.hasOwn(d,"input")&&(v.input=d.input),v}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const v=new RegExp(d.source,d.flags);return v.lastIndex=d.lastIndex,v}if(d instanceof Map){const v=new Map;h.set(d,v);for(const[b,S]of d)v.set(b,o(S,b,m,h,p));return v}if(d instanceof Set){const v=new Set;h.set(d,v);for(const b of d)v.add(o(b,void 0,m,h,p));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const v=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,v);for(let b=0;b<d.length;b++)v[b]=o(d[b],b,m,h,p);return v}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const v=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,v),c(v,d,m,h,p),v}if(typeof File<"u"&&d instanceof File){const v=new File([d],d.name,{type:d.type});return h.set(d,v),c(v,d,m,h,p),v}if(typeof Blob<"u"&&d instanceof Blob){const v=new Blob([d],{type:d.type});return h.set(d,v),c(v,d,m,h,p),v}if(d instanceof Error){const v=new d.constructor;return h.set(d,v),v.message=d.message,v.name=d.name,v.stack=d.stack,v.cause=d.cause,c(v,d,m,h,p),v}if(d instanceof Boolean){const v=new Boolean(d.valueOf());return h.set(d,v),c(v,d,m,h,p),v}if(d instanceof Number){const v=new Number(d.valueOf());return h.set(d,v),c(v,d,m,h,p),v}if(d instanceof String){const v=new String(d.valueOf());return h.set(d,v),c(v,d,m,h,p),v}if(typeof d=="object"&&u(d)){const v=Object.create(Object.getPrototypeOf(d));return h.set(d,v),c(v,d,m,h,p),v}return d}function c(d,f,m=d,h,p){const g=[...Object.keys(f),...t.getSymbols(f)];for(let v=0;v<g.length;v++){const b=g[v],S=Object.getOwnPropertyDescriptor(d,b);(S==null||S.writable)&&(d[b]=o(f[b],b,m,h,p))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=c})(Px)),Px}var u_;function Tq(){return u_||(u_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n6();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Tx)),Tx}var d_;function Pq(){return d_||(d_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t6(),r=Tq();function n(a){return a=r.cloneDeep(a),s=>t.isMatch(s,a)}e.matches=n})(Nx)),Nx}var Dx={},Mx={},Rx={},f_;function Oq(){return f_||(f_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n6(),r=$2(),n=r6();function a(s,i){return t.cloneDeepWith(s,(o,c,u,d)=>{const f=i==null?void 0:i(o,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const m={};return d.set(s,m),t.copyProperties(m,s,u,d),m}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const m=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(m,s),m}case n.argumentsTag:{const m={};return t.copyProperties(m,s),m.length=s.length,m[Symbol.iterator]=s[Symbol.iterator],m}default:return}}})}e.cloneDeepWith=a})(Rx)),Rx}var h_;function Fq(){return h_||(h_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oq();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Mx)),Mx}var Bx={},Ux={},m_;function a6(){return m_||(m_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Ux)),Ux}var zx={},p_;function Iq(){return p_||(p_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$2();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(zx)),zx}var g_;function Lq(){return g_||(g_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GC(),r=a6(),n=Iq(),a=M2();function s(i,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(i==null?void 0:i[o])==null?c=a.toPath(o):c=[o],c.length===0)return!1;let u=i;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(Bx)),Bx}var x_;function Dq(){return x_||(x_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t6(),r=D2(),n=Fq(),a=R2(),s=Lq();function i(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,o);return d===void 0?s.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=i})(Dx)),Dx}var v_;function Mq(){return v_||(v_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JC(),r=jq(),n=Pq(),a=Dq();function s(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?a.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=s})(Sx)),Sx}var y_;function Rq(){return y_||(y_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wq(),r=Sq(),n=JC(),a=Aq(),s=Mq();function i(o,c=n.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),r.ary(s.iteratee(c),1)):[]}e.uniqBy=i})(mx)),mx}var $x,b_;function Bq(){return b_||(b_=1,$x=Rq().uniqBy),$x}var Uq=Bq();const w_=co(Uq);function s6(e,t,r){return t===!0?w_(e,r):typeof t=="function"?w_(e,t):e}var Wx={exports:{}},Hx={},qx={exports:{}},Gx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function zq(){if(S_)return Gx;S_=1;var e=Zm();function t(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function o(f,m){var h=m(),p=n({inst:{value:h,getSnapshot:m}}),g=p[0].inst,v=p[1];return s(function(){g.value=h,g.getSnapshot=m,c(g)&&v({inst:g})},[f,h,m]),a(function(){return c(g)&&v({inst:g}),f(function(){c(g)&&v({inst:g})})},[f]),i(h),h}function c(f){var m=f.getSnapshot;f=f.value;try{var h=m();return!r(f,h)}catch{return!0}}function u(f,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Gx.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,Gx}var __;function $q(){return __||(__=1,qx.exports=zq()),qx.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N_;function Wq(){if(N_)return Hx;N_=1;var e=Zm(),t=$q();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return Hx.useSyncExternalStoreWithSelector=function(u,d,f,m,h){var p=s(null);if(p.current===null){var g={hasValue:!1,value:null};p.current=g}else g=p.current;p=o(function(){function b(N){if(!S){if(S=!0,_=N,N=m(N),h!==void 0&&g.hasValue){var I=g.value;if(h(I,N))return E=I}return E=N}if(I=E,n(_,N))return I;var k=m(N);return h!==void 0&&h(I,k)?(_=N,I):(_=N,E=k)}var S=!1,_,E,P=f===void 0?null:f;return[function(){return b(d())},P===null?void 0:function(){return b(P())}]},[d,f,m,h]);var v=a(u,p[0],p[1]);return i(function(){g.hasValue=!0,g.value=v},[v]),c(v),v},Hx}var A_;function Hq(){return A_||(A_=1,Wx.exports=Wq()),Wx.exports}var qq=Hq(),W2=y.createContext(null),Gq=e=>e,Pr=()=>{var e=y.useContext(W2);return e?e.store.dispatch:Gq},kh=()=>{},Vq=()=>kh,Yq=(e,t)=>e===t;function St(e){var t=y.useContext(W2);return qq.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Vq,t?t.store.getState:kh,t?t.store.getState:kh,t?e:kh,Yq)}function Kq(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Xq(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Jq(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var j_=e=>Array.isArray(e)?e:[e];function Zq(e){const t=Array.isArray(e[0])?e[0]:e;return Jq(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Qq(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var eG=class{constructor(e){this.value=e}deref(){return this.value}},tG=typeof WeakRef<"u"?WeakRef:eG,rG=0,k_=1;function sh(){return{s:rG,v:void 0,o:null,p:null}}function i6(e,t={}){let r=sh();const{resultEqualityCheck:n}=t;let a,s=0;function i(){var f;let o=r;const{length:c}=arguments;for(let m=0,h=c;m<h;m++){const p=arguments[m];if(typeof p=="function"||typeof p=="object"&&p!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const v=g.get(p);v===void 0?(o=sh(),g.set(p,o)):o=v}else{let g=o.p;g===null&&(o.p=g=new Map);const v=g.get(p);v===void 0?(o=sh(),g.set(p,o)):o=v}}const u=o;let d;if(o.s===k_)d=o.v;else if(d=e.apply(null,arguments),s++,n){const m=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;m!=null&&n(m,d)&&(d=m,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new tG(d):d}return u.s=k_,u.v=d,d}return i.clearCache=()=>{r=sh(),i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function nG(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let s=0,i=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),Kq(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:m=[],argsMemoize:h=i6,argsMemoizeOptions:p=[]}=d,g=j_(m),v=j_(p),b=Zq(a),S=f(function(){return s++,u.apply(null,arguments)},...g),_=h(function(){i++;const P=Qq(b,arguments);return o=S.apply(null,P),o},...v);return Object.assign(_,{resultFunc:u,memoizedResultFunc:S,dependencies:b,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Ue=nG(i6),aG=Object.assign((e,t=Ue)=>{Xq(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((i,o,c)=>(i[r[c]]=o,i),{}))},{withTypes:()=>aG}),Vx={},Yx={},Kx={},C_;function sG(){return C_||(C_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const i=t(n),o=t(a);if(i===o&&i===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?o-i:i-o}return 0};e.compareValues=r})(Kx)),Kx}var Xx={},Jx={},E_;function o6(){return E_||(E_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Jx)),Jx}var T_;function iG(){return T_||(T_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o6(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,i){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||i!=null&&Object.hasOwn(i,s)}e.isKey=a})(Xx)),Xx}var P_;function oG(){return P_||(P_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sG(),r=iG(),n=M2();function a(s,i,o,c){if(s==null)return[];o=c?void 0:o,Array.isArray(s)||(s=Object.values(s)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(h=>String(h));const u=(h,p)=>{let g=h;for(let v=0;v<p.length&&g!=null;++v)g=g[p[v]];return g},d=(h,p)=>p==null||h==null?p:typeof h=="object"&&"key"in h?Object.hasOwn(p,h.key)?p[h.key]:u(p,h.path):typeof h=="function"?h(p):Array.isArray(h)?u(p,h):typeof p=="object"?p[h]:p,f=i.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(p=>d(p,h))})).slice().sort((h,p)=>{for(let g=0;g<f.length;g++){const v=t.compareValues(h.criteria[g],p.criteria[g],o[g]);if(v!==0)return v}return 0}).map(h=>h.original)}e.orderBy=a})(Yx)),Yx}var Zx={},O_;function lG(){return O_||(O_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],s=Math.floor(n),i=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<s?i(d,c+1):a.push(d)}};return i(r,0),a}e.flatten=t})(Zx)),Zx}var Qx={},F_;function l6(){return F_||(F_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a6(),r=z2(),n=ZC(),a=e6();function s(i,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?a.isEqualsSameValueZero(c[o],i):!1}e.isIterateeCall=s})(Qx)),Qx}var I_;function cG(){return I_||(I_=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oG(),r=lG(),n=l6();function a(s,...i){const o=i.length;return o>1&&n.isIterateeCall(s,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(s,r.flatten(i),["asc"])}e.sortBy=a})(Vx)),Vx}var e1,L_;function uG(){return L_||(L_=1,e1=cG().sortBy),e1}var dG=uG();const fp=co(dG);var c6=e=>e.legend.settings,fG=e=>e.legend.size,hG=e=>e.legend.payload,mG=Ue([hG,c6],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?fp(n,r):n});function pG(){return St(mG)}var ih=1;function u6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=y.useState({height:0,left:0,top:0,width:0}),n=y.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),i={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(i.height-t.height)>ih||Math.abs(i.left-t.left)>ih||Math.abs(i.top-t.top)>ih||Math.abs(i.width-t.width)>ih)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function aa(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var gG=typeof Symbol=="function"&&Symbol.observable||"@@observable",D_=gG,t1=()=>Math.random().toString(36).substring(7).split("").join("."),xG={INIT:`@@redux/INIT${t1()}`,REPLACE:`@@redux/REPLACE${t1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${t1()}`},im=xG;function H2(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function d6(e,t,r){if(typeof e!="function")throw new Error(aa(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(aa(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(aa(1));return r(d6)(e,t)}let n=e,a=t,s=new Map,i=s,o=0,c=!1;function u(){i===s&&(i=new Map,s.forEach((v,b)=>{i.set(b,v)}))}function d(){if(c)throw new Error(aa(3));return a}function f(v){if(typeof v!="function")throw new Error(aa(4));if(c)throw new Error(aa(5));let b=!0;u();const S=o++;return i.set(S,v),function(){if(b){if(c)throw new Error(aa(6));b=!1,u(),i.delete(S),s=null}}}function m(v){if(!H2(v))throw new Error(aa(7));if(typeof v.type>"u")throw new Error(aa(8));if(typeof v.type!="string")throw new Error(aa(17));if(c)throw new Error(aa(9));try{c=!0,a=n(a,v)}finally{c=!1}return(s=i).forEach(S=>{S()}),v}function h(v){if(typeof v!="function")throw new Error(aa(10));n=v,m({type:im.REPLACE})}function p(){const v=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(aa(11));function S(){const E=b;E.next&&E.next(d())}return S(),{unsubscribe:v(S)}},[D_](){return this}}}return m({type:im.INIT}),{dispatch:m,subscribe:f,getState:d,replaceReducer:h,[D_]:p}}function vG(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:im.INIT})>"u")throw new Error(aa(12));if(typeof r(void 0,{type:im.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(aa(13))})}function f6(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const i=t[s];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let a;try{vG(r)}catch(s){a=s}return function(i={},o){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],m=r[f],h=i[f],p=m(h,o);if(typeof p>"u")throw o&&o.type,new Error(aa(14));u[f]=p,c=c||p!==h}return c=c||n.length!==Object.keys(i).length,c?u:i}}function om(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function yG(...e){return t=>(r,n)=>{const a=t(r,n);let s=()=>{throw new Error(aa(15))};const i={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},o=e.map(c=>c(i));return s=om(...o)(a.dispatch),{...a,dispatch:s}}}function h6(e){return H2(e)&&"type"in e&&typeof e.type=="string"}var m6=Symbol.for("immer-nothing"),M_=Symbol.for("immer-draftable"),Da=Symbol.for("immer-state");function Ys(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var os=Object,du=os.getPrototypeOf,lm="constructor",hp="prototype",Av="configurable",cm="enumerable",Ch="writable",rf="value",ro=e=>!!e&&!!e[Da];function ni(e){var t;return e?p6(e)||pp(e)||!!e[M_]||!!((t=e[lm])!=null&&t[M_])||gp(e)||xp(e):!1}var bG=os[hp][lm].toString(),R_=new WeakMap;function p6(e){if(!e||!q2(e))return!1;const t=du(e);if(t===null||t===os[hp])return!0;const r=os.hasOwnProperty.call(t,lm)&&t[lm];if(r===Object)return!0;if(!Hc(r))return!1;let n=R_.get(r);return n===void 0&&(n=Function.toString.call(r),R_.set(r,n)),n===bG}function mp(e,t,r=!0){Of(e)===0?(r?Reflect.ownKeys(e):os.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Of(e){const t=e[Da];return t?t.type_:pp(e)?1:gp(e)?2:xp(e)?3:0}var B_=(e,t,r=Of(e))=>r===2?e.has(t):os[hp].hasOwnProperty.call(e,t),jv=(e,t,r=Of(e))=>r===2?e.get(t):e[t],um=(e,t,r,n=Of(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function wG(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var pp=Array.isArray,gp=e=>e instanceof Map,xp=e=>e instanceof Set,q2=e=>typeof e=="object",Hc=e=>typeof e=="function",r1=e=>typeof e=="boolean";function SG(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var $i=e=>e.copy_||e.base_,G2=e=>e.modified_?e.copy_:e.base_;function kv(e,t){if(gp(e))return new Map(e);if(xp(e))return new Set(e);if(pp(e))return Array[hp].slice.call(e);const r=p6(e);if(t===!0||t==="class_only"&&!r){const n=os.getOwnPropertyDescriptors(e);delete n[Da];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const i=a[s],o=n[i];o[Ch]===!1&&(o[Ch]=!0,o[Av]=!0),(o.get||o.set)&&(n[i]={[Av]:!0,[Ch]:!0,[cm]:o[cm],[rf]:e[i]})}return os.create(du(e),n)}else{const n=du(e);if(n!==null&&r)return{...e};const a=os.create(n);return os.assign(a,e)}}function V2(e,t=!1){return vp(e)||ro(e)||!ni(e)||(Of(e)>1&&os.defineProperties(e,{set:oh,add:oh,clear:oh,delete:oh}),os.freeze(e),t&&mp(e,(r,n)=>{V2(n,!0)},!1)),e}function _G(){Ys(2)}var oh={[rf]:_G};function vp(e){return e===null||!q2(e)?!0:os.isFrozen(e)}var dm="MapSet",Cv="Patches",U_="ArrayMethods",g6={};function Yl(e){const t=g6[e];return t||Ys(0,e),t}var z_=e=>!!g6[e],nf,x6=()=>nf,NG=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:z_(dm)?Yl(dm):void 0,arrayMethodsPlugin_:z_(U_)?Yl(U_):void 0});function $_(e,t){t&&(e.patchPlugin_=Yl(Cv),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Ev(e){Tv(e),e.drafts_.forEach(AG),e.drafts_=null}function Tv(e){e===nf&&(nf=e.parent_)}var W_=e=>nf=NG(nf,e);function AG(e){const t=e[Da];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function H_(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[Da].modified_&&(Ev(t),Ys(4)),ni(e)&&(e=q_(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[Da].base_,e,t)}else e=q_(t,r);return jG(t,e,!0),Ev(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==m6?e:void 0}function q_(e,t){if(vp(t))return t;const r=t[Da];if(!r)return fm(t,e.handledSet_,e);if(!yp(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);b6(r,e)}return r.copy_}function jG(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&V2(t,r)}function v6(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var yp=(e,t)=>e.scope_===t,kG=[];function y6(e,t,r,n){const a=$i(e),s=e.type_;if(n!==void 0&&jv(a,n,s)===t){um(a,n,r,s);return}if(!e.draftLocations_){const o=e.draftLocations_=new Map;mp(a,(c,u)=>{if(ro(u)){const d=o.get(u)||[];d.push(c),o.set(u,d)}})}const i=e.draftLocations_.get(t)??kG;for(const o of i)um(a,o,r,s)}function CG(e,t,r){e.callbacks_.push(function(a){var o;const s=t;if(!s||!yp(s,a))return;(o=a.mapSetPlugin_)==null||o.fixSetContents(s);const i=G2(s);y6(e,s.draft_??s,i,r),b6(s,a)})}function b6(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=t;if(a){const s=a.getPath(e);s&&a.generatePatches_(e,s,t)}v6(e)}}function EG(e,t,r){const{scope_:n}=e;if(ro(r)){const a=r[Da];yp(a,n)&&a.callbacks_.push(function(){Eh(e);const i=G2(a);y6(e,r,i,t)})}else ni(r)&&e.callbacks_.push(function(){const s=$i(e);e.type_===3?s.has(r)&&fm(r,n.handledSet_,n):jv(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&fm(jv(e.copy_,t,e.type_),n.handledSet_,n)})}function fm(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ro(e)||t.has(e)||!ni(e)||vp(e)||(t.add(e),mp(e,(n,a)=>{if(ro(a)){const s=a[Da];if(yp(s,r)){const i=G2(s);um(e,n,i,e.type_),v6(s)}}else ni(a)&&fm(a,t,r)})),e}function TG(e,t){const r=pp(e),n={type_:r?1:0,scope_:t?t.scope_:x6(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=hm;r&&(a=[n],s=af);const{revoke:i,proxy:o}=Proxy.revocable(a,s);return n.draft_=o,n.revoke_=i,[o,n]}var hm={get(e,t){if(t===Da)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=$i(e);if(!B_(a,t,e.type_))return PG(e,a,t);const s=a[t];if(e.finalized_||!ni(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&SG(t))return s;if(s===n1(e.base_,t)){Eh(e);const i=e.type_===1?+t:t,o=Ov(e.scope_,s,e,i);return e.copy_[i]=o}return s},has(e,t){return t in $i(e)},ownKeys(e){return Reflect.ownKeys($i(e))},set(e,t,r){const n=w6($i(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=n1($i(e),t),s=a==null?void 0:a[Da];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(wG(r,a)&&(r!==void 0||B_(e.base_,t,e.type_)))return!0;Eh(e),Pv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),EG(e,t,r)),!0},deleteProperty(e,t){return Eh(e),n1(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),Pv(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=$i(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Ch]:!0,[Av]:e.type_!==1||t!=="length",[cm]:n[cm],[rf]:r[t]}},defineProperty(){Ys(11)},getPrototypeOf(e){return du(e.base_)},setPrototypeOf(){Ys(12)}},af={};for(let e in hm){let t=hm[e];af[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}af.deleteProperty=function(e,t){return af.set.call(this,e,t,void 0)};af.set=function(e,t,r){return hm.set.call(this,e[0],t,r,e[0])};function n1(e,t){const r=e[Da];return(r?$i(r):e)[t]}function PG(e,t,r){var a;const n=w6(t,r);return n?rf in n?n[rf]:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function w6(e,t){if(!(t in e))return;let r=du(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=du(r)}}function Pv(e){e.modified_||(e.modified_=!0,e.parent_&&Pv(e.parent_))}function Eh(e){e.copy_||(e.assigned_=new Map,e.copy_=kv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var OG=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Hc(r)&&!Hc(n)){const i=n;n=r;const o=this;return function(u=i,...d){return o.produce(u,f=>n.call(this,f,...d))}}Hc(n)||Ys(6),a!==void 0&&!Hc(a)&&Ys(7);let s;if(ni(r)){const i=W_(this),o=Ov(i,r,void 0);let c=!0;try{s=n(o),c=!1}finally{c?Ev(i):Tv(i)}return $_(i,a),H_(s,i)}else if(!r||!q2(r)){if(s=n(r),s===void 0&&(s=r),s===m6&&(s=void 0),this.autoFreeze_&&V2(s,!0),a){const i=[],o=[];Yl(Cv).generateReplacementPatches_(r,s,{patches_:i,inversePatches_:o}),a(i,o)}return s}else Ys(1,r)},this.produceWithPatches=(r,n)=>{if(Hc(r))return(o,...c)=>this.produceWithPatches(o,u=>r(u,...c));let a,s;return[this.produce(r,n,(o,c)=>{a=o,s=c}),a,s]},r1(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),r1(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),r1(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){ni(t)||Ys(8),ro(t)&&(t=ti(t));const r=W_(this),n=Ov(r,t,void 0);return n[Da].isManual_=!0,Tv(r),n}finishDraft(t,r){const n=t&&t[Da];(!n||!n.isManual_)&&Ys(9);const{scope_:a}=n;return $_(a,r),H_(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const a=Yl(Cv).applyPatches_;return ro(t)?a(t,r):this.produce(t,s=>a(s,r))}};function Ov(e,t,r,n){const[a,s]=gp(t)?Yl(dm).proxyMap_(t,r):xp(t)?Yl(dm).proxySet_(t,r):TG(t,r);return((r==null?void 0:r.scope_)??x6()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?CG(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function ti(e){return ro(e)||Ys(10,e),S6(e)}function S6(e){if(!ni(e)||vp(e))return e;const t=e[Da];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=kv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=kv(e,!0);return mp(r,(a,s)=>{um(r,a,S6(s))},n),t&&(t.finalized_=!1),r}var FG=new OG,_6=FG.produce;function N6(e){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,e):a(s)}var IG=N6(),LG=N6,DG=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?om:om.apply(null,arguments)};function Fs(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(cs(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>h6(n)&&n.type===e,r}var A6=class kd extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,kd.prototype)}static get[Symbol.species](){return kd}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new kd(...t[0].concat(this)):new kd(...t.concat(this))}};function G_(e){return ni(e)?_6(e,()=>{}):e}function lh(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function MG(e){return typeof e=="boolean"}var RG=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=t??{};let i=new A6;return r&&(MG(r)?i.push(IG):i.push(LG(r.extraArgument))),i},j6="RTK_autoBatch",Br=()=>e=>({payload:e,meta:{[j6]:!0}}),V_=e=>t=>{setTimeout(t,e)},k6=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,s=!1,i=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:V_(10):e.type==="callback"?e.queueNotification:V_(e.timeout),u=()=>{i=!1,s&&(s=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),m=n.subscribe(f);return o.add(d),()=>{m(),o.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[j6]),s=!a,s&&(i||(i=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},BG=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new A6(e);return n&&a.push(k6(typeof n=="object"?n:void 0)),a};function UG(e){const t=RG(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(H2(r))o=f6(r);else throw new Error(cs(1));let c;typeof n=="function"?c=n(t):c=t();let u=om;a&&(u=DG({trace:!1,...typeof a=="object"&&a}));const d=yG(...c),f=BG(d);let m=typeof i=="function"?i(f):f();const h=u(...m);return d6(o,s,h)}function C6(e){const t={},r=[];let n;const a={addCase(s,i){const o=typeof s=="string"?s:s.type;if(!o)throw new Error(cs(28));if(o in t)throw new Error(cs(29));return t[o]=i,a},addAsyncThunk(s,i){return i.pending&&(t[s.pending.type]=i.pending),i.rejected&&(t[s.rejected.type]=i.rejected),i.fulfilled&&(t[s.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:s.settled,reducer:i.settled}),a},addMatcher(s,i){return r.push({matcher:s,reducer:i}),a},addDefaultCase(s){return n=s,a}};return e(a),[t,r,n]}function zG(e){return typeof e=="function"}function $G(e,t){let[r,n,a]=C6(t),s;if(zG(e))s=()=>G_(e());else{const o=G_(e);s=()=>o}function i(o=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(ro(d)){const h=f(d,c);return h===void 0?d:h}else{if(ni(d))return _6(d,m=>f(m,c));{const m=f(d,c);if(m===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return d},o)}return i.getInitialState=s,i}var WG="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",HG=(e=21)=>{let t="",r=e;for(;r--;)t+=WG[Math.random()*64|0];return t},qG=Symbol.for("rtk-slice-createasyncthunk");function GG(e,t){return`${e}/${t}`}function VG({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[qG];return function(a){const{name:s,reducerPath:i=s}=a;if(!s)throw new Error(cs(11));const o=(typeof a.reducers=="function"?a.reducers(KG()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(E,P){const N=typeof E=="string"?E:E.type;if(!N)throw new Error(cs(12));if(N in u.sliceCaseReducersByType)throw new Error(cs(13));return u.sliceCaseReducersByType[N]=P,d},addMatcher(E,P){return u.sliceMatchers.push({matcher:E,reducer:P}),d},exposeAction(E,P){return u.actionCreators[E]=P,d},exposeCaseReducer(E,P){return u.sliceCaseReducersByName[E]=P,d}};c.forEach(E=>{const P=o[E],N={reducerName:E,type:GG(s,E),createNotation:typeof a.reducers=="function"};JG(P)?QG(N,P,d,t):XG(N,P,d)});function f(){const[E={},P=[],N=void 0]=typeof a.extraReducers=="function"?C6(a.extraReducers):[a.extraReducers],I={...E,...u.sliceCaseReducersByType};return $G(a.initialState,k=>{for(let T in I)k.addCase(T,I[T]);for(let T of u.sliceMatchers)k.addMatcher(T.matcher,T.reducer);for(let T of P)k.addMatcher(T.matcher,T.reducer);N&&k.addDefaultCase(N)})}const m=E=>E,h=new Map,p=new WeakMap;let g;function v(E,P){return g||(g=f()),g(E,P)}function b(){return g||(g=f()),g.getInitialState()}function S(E,P=!1){function N(k){let T=k[E];return typeof T>"u"&&P&&(T=lh(p,N,b)),T}function I(k=m){const T=lh(h,P,()=>new WeakMap);return lh(T,k,()=>{const q={};for(const[F,j]of Object.entries(a.selectors??{}))q[F]=YG(j,k,()=>lh(p,k,b),P);return q})}return{reducerPath:E,getSelectors:I,get selectors(){return I(N)},selectSlice:N}}const _={name:s,reducer:v,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...S(i),injectInto(E,{reducerPath:P,...N}={}){const I=P??i;return E.inject({reducerPath:I,reducer:v},N),{..._,...S(I,!0)}}};return _}}function YG(e,t,r,n){function a(s,...i){let o=t(s);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return a.unwrapped=e,a}var Va=VG();function KG(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function XG({type:e,reducerName:t,createNotation:r},n,a){let s,i;if("reducer"in n){if(r&&!ZG(n))throw new Error(cs(17));s=n.reducer,i=n.prepare}else s=n;a.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,i?Fs(e,i):Fs(e))}function JG(e){return e._reducerDefinitionType==="asyncThunk"}function ZG(e){return e._reducerDefinitionType==="reducerWithPrepare"}function QG({type:e,reducerName:t},r,n,a){if(!a)throw new Error(cs(18));const{payloadCreator:s,fulfilled:i,pending:o,rejected:c,settled:u,options:d}=r,f=a(e,s,d);n.exposeAction(t,f),i&&n.addCase(f.fulfilled,i),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:i||ch,pending:o||ch,rejected:c||ch,settled:u||ch})}function ch(){}var eV="task",E6="listener",T6="completed",Y2="cancelled",tV=`task-${Y2}`,rV=`task-${T6}`,Fv=`${E6}-${Y2}`,nV=`${E6}-${T6}`,bp=class{constructor(e){zg(this,"name","TaskAbortError");zg(this,"message");this.code=e,this.message=`${eV} ${Y2} (reason: ${e})`}},K2=(e,t)=>{if(typeof e!="function")throw new TypeError(cs(32))},mm=()=>{},P6=(e,t=mm)=>(e.catch(t),e),O6=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ll=e=>{if(e.aborted)throw new bp(e.reason)};function F6(e,t){let r=mm;return new Promise((n,a)=>{const s=()=>a(new bp(e.reason));if(e.aborted){s();return}r=O6(e,s),t.finally(()=>r()).then(n,a)}).finally(()=>{r=mm})}var aV=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof bp?"cancelled":"rejected",error:r}}finally{t==null||t()}},pm=e=>t=>P6(F6(e,t).then(r=>(Ll(e),r))),I6=e=>{const t=pm(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:tu}=Object,Y_={},wp="listenerMiddleware",sV=(e,t)=>{const r=n=>O6(e,()=>n.abort(e.reason));return(n,a)=>{K2(n);const s=new AbortController;r(s);const i=aV(async()=>{Ll(e),Ll(s.signal);const o=await n({pause:pm(s.signal),delay:I6(s.signal),signal:s.signal});return Ll(s.signal),o},()=>s.abort(rV));return a!=null&&a.autoJoin&&t.push(i.catch(mm)),{result:pm(e)(i),cancel(){s.abort(tV)}}}},iV=(e,t)=>{const r=async(n,a)=>{Ll(t);let s=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,m)=>{m.unsubscribe(),c([f,m.getState(),m.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&o.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await F6(t,Promise.race(o));return Ll(t),c}finally{s()}};return(n,a)=>P6(r(n,a))},L6=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:s}=e;if(t)a=Fs(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(cs(21));return K2(s),{predicate:a,type:t,effect:s}},D6=tu(e=>{const{type:t,predicate:r,effect:n}=L6(e);return{id:HG(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(cs(22))}}},{withTypes:()=>D6}),K_=(e,t)=>{const{type:r,effect:n,predicate:a}=L6(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},Iv=e=>{e.pending.forEach(t=>{t.abort(Fv)})},oV=(e,t)=>()=>{for(const r of t.keys())Iv(r);e.clear()},X_=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},M6=tu(Fs(`${wp}/add`),{withTypes:()=>M6}),lV=Fs(`${wp}/removeAll`),R6=tu(Fs(`${wp}/remove`),{withTypes:()=>R6}),cV=(...e)=>{console.error(`${wp}/error`,...e)},Ff=(e={})=>{const t=new Map,r=new Map,n=h=>{const p=r.get(h)??0;r.set(h,p+1)},a=h=>{const p=r.get(h)??1;p===1?r.delete(h):r.set(h,p-1)},{extra:s,onError:i=cV}=e;K2(i);const o=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),p=>{h.unsubscribe(),p!=null&&p.cancelActive&&Iv(h)}),c=h=>{const p=K_(t,h)??D6(h);return o(p)};tu(c,{withTypes:()=>c});const u=h=>{const p=K_(t,h);return p&&(p.unsubscribe(),h.cancelActive&&Iv(p)),!!p};tu(u,{withTypes:()=>u});const d=async(h,p,g,v)=>{const b=new AbortController,S=iV(c,b.signal),_=[];try{h.pending.add(b),n(h),await Promise.resolve(h.effect(p,tu({},g,{getOriginalState:v,condition:(E,P)=>S(E,P).then(Boolean),take:S,delay:I6(b.signal),pause:pm(b.signal),extra:s,signal:b.signal,fork:sV(b.signal,_),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((E,P,N)=>{E!==b&&(E.abort(Fv),N.delete(E))})},cancel:()=>{b.abort(Fv),h.pending.delete(b)},throwIfCancelled:()=>{Ll(b.signal)}})))}catch(E){E instanceof bp||X_(i,E,{raisedBy:"effect"})}finally{await Promise.all(_),b.abort(nV),a(h),h.pending.delete(b)}},f=oV(t,r);return{middleware:h=>p=>g=>{if(!h6(g))return p(g);if(M6.match(g))return c(g.payload);if(lV.match(g)){f();return}if(R6.match(g))return u(g.payload);let v=h.getState();const b=()=>{if(v===Y_)throw new Error(cs(23));return v};let S;try{if(S=p(g),t.size>0){const _=h.getState(),E=Array.from(t.values());for(const P of E){let N=!1;try{N=P.predicate(g,_,v)}catch(I){N=!1,X_(i,I,{raisedBy:"predicate"})}N&&d(P,g,h,b)}}}finally{v=Y_}return S},startListening:c,stopListening:u,clearListeners:f}};function cs(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var uV={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},B6=Va({name:"chartLayout",initialState:uV,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:dV,setLayout:fV,setChartSize:hV,setScale:mV}=B6.actions,pV=B6.reducer;function U6(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Vr(e){return Number.isFinite(e)}function ji(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function J_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J_(Object(r),!0).forEach(function(n){gV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gV(e,t,r){return(t=xV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xV(e){var t=vV(e,"string");return typeof t=="symbol"?t:t+""}function vV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nr(e,t,r){return $r(e)||$r(t)?r:Ai(t)?Vl(e,t,r):typeof t=="function"?t(e):r}var yV=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:s,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&s!=="center"&&bt(e[s]))return Yc(Yc({},e),{},{[s]:e[s]+(n||0)});if((o==="horizontal"||o==="vertical"&&s==="center")&&i!=="middle"&&bt(e[i]))return Yc(Yc({},e),{},{[i]:e[i]+(a||0)})}return e},il=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",z6=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var a,s,i=e.map(o=>(o.coordinate===t&&(a=!0),o.coordinate===r&&(s=!0),o.coordinate));return a||i.push(t),s||i.push(r),i},$6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:s,scale:i,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:m,axisType:h}=e;if(!i)return null;var p=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,g=a==="category"&&i.bandwidth?i.bandwidth()/p:0;if(g=h==="angleAxis"&&s&&s.length>=2?Zn(s[0]-s[1])*2*g:g,f||m){var v=(f||m||[]).map((b,S)=>{var _=n?n.indexOf(b):b;return{coordinate:i(_)+g,value:b,offset:g,index:S}});return v.filter(b=>!ri(b.coordinate))}return c&&u?u.map((b,S)=>({coordinate:i(b)+g,value:b,index:S,offset:g})):i.ticks&&d!=null?i.ticks(d).map((b,S)=>({coordinate:i(b)+g,value:b,offset:g,index:S})):i.domain().map((b,S)=>({coordinate:i(b)+g,value:n?n[b]:b,index:S,offset:g}))},Z_=1e-4,bV=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Z_,s=Math.max(n[0],n[1])+Z_,i=e(t[0]),o=e(t[r-1]);(i<a||i>s||o<a||o>s)&&e.domain([t[0],t[r-1]])}},wV=(e,t)=>{if(!t||t.length!==2||!bt(t[0])||!bt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!bt(e[0])||e[0]<r)&&(a[0]=r),(!bt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},SV=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,i=0,o=0;o<r;++o){var c=e[o],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],m=ri(d)?f:d;m>=0?(u[0]=s,u[1]=s+m,s=d):(u[0]=i,u[1]=i+m,i=d)}}}},_V=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,i=0;i<r;++i){var o=e[i],c=o==null?void 0:o[a];if(c!=null){var u=ri(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},NV={sign:SV,expand:$H,none:Gl,silhouette:WH,wiggle:HH,positive:_V},AV=(e,t,r)=>{var n,a=(n=NV[r])!==null&&n!==void 0?n:Gl,s=zH().keys(t).value((o,c)=>Number(Nr(o,c,0))).order(_v).offset(a),i=s(e);return i.forEach((o,c)=>{o.forEach((u,d)=>{var f=Nr(e[d],t[c],0);Array.isArray(f)&&f.length===2&&bt(f[0])&&bt(f[1])&&(u[0]=f[0],u[1]=f[1])})}),i};function jV(e){return e==null?void 0:String(e)}function Q_(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:s,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!$r(a[t.dataKey])){var o=YC(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var c=Nr(a,$r(i)?t.dataKey:i);return $r(c)?null:t.scale(c)}var e4=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:s,index:i}=e;if(t.type==="category")return r[i]?r[i].coordinate+n:null;var o=Nr(s,t.dataKey,t.scale.domain()[i]);return $r(o)?null:t.scale(o)-a/2+n},kV=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},CV=e=>{var t=e.flat(2).filter(bt);return[Math.min(...t),Math.max(...t)]},EV=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],TV=(e,t,r)=>{if(e!=null)return EV(Object.keys(e).reduce((n,a)=>{var s=e[a];if(!s)return n;var{stackedData:i}=s,o=i.reduce((c,u)=>{var d=U6(u,t,r),f=CV(d);return!Vr(f[0])||!Vr(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},t4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,r4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=fp(t,d=>d.coordinate),s=1/0,i=1,o=a.length;i<o;i++){var c=a[i],u=a[i-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function n4(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:s}=e;return Yc(Yc({},t),{},{dataKey:r,payload:n,value:a,name:s})}function _u(e,t){if(e)return String(e);if(typeof t=="string")return t}var PV=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},OV=(e,t)=>t==="centric"?e.angle:e.radius,mo=e=>e.layout.width,po=e=>e.layout.height,FV=e=>e.layout.scale,W6=e=>e.layout.margin,Sp=Ue(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),_p=Ue(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),H6="data-recharts-item-index",q6="data-recharts-item-id",If=60;function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(n){IV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IV(e,t,r){return(t=LV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e){var t=DV(e,"string");return typeof t=="symbol"?t:t+""}function DV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MV=e=>e.brush.height;function RV(e){var t=_p(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:If;return r+a}return r},0)}function BV(e){var t=_p(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:If;return r+a}return r},0)}function UV(e){var t=Sp(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function zV(e){var t=Sp(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Dn=Ue([mo,po,W6,MV,RV,BV,UV,zV,c6,fG],(e,t,r,n,a,s,i,o,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+i,bottom:(r.bottom||0)+o},m=uh(uh({},f),d),h=m.bottom;m.bottom+=n,m=yV(m,c,u);var p=e-m.left-m.right,g=t-m.top-m.bottom;return uh(uh({brushBottom:h},m),{},{width:Math.max(p,0),height:Math.max(g,0)})}),$V=Ue(Dn,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),X2=Ue(mo,po,(e,t)=>({x:0,y:0,width:e,height:t})),WV=y.createContext(null),ja=()=>y.useContext(WV)!=null,Np=e=>e.brush,Ap=Ue([Np,Dn,W6],(e,t,r)=>({height:e.height,x:bt(e.x)?e.x:t.left,y:bt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:bt(e.width)?e.width:t.width})),a1={},s1={},i1={},s4;function HV(){return s4||(s4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:s}={}){let i,o=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},f=()=>{u&&d(),g()};let m=null;const h=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},n)},p=()=>{m!==null&&(clearTimeout(m),m=null)},g=()=>{p(),i=void 0,o=null},v=()=>{d()},b=function(...S){if(a!=null&&a.aborted)return;i=this,o=S;const _=m==null;h(),c&&_&&d()};return b.schedule=h,b.cancel=g,b.flush=v,a==null||a.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(i1)),i1}var i4;function qV(){return i4||(i4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HV();function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:i=!1,trailing:o=!0,maxWait:c}=s,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const m=t.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:u}),h=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),m.cancel(),m.schedule(),d):(m.apply(this,g),d)},p=()=>(m.flush(),d);return h.cancel=m.cancel,h.flush=p,h}e.debounce=r})(s1)),s1}var o4;function GV(){return o4||(o4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qV();function r(n,a=0,s={}){const{leading:i=!0,trailing:o=!0}=s;return t.debounce(n,a,{leading:i,maxWait:a,trailing:o})}e.throttle=r})(a1)),a1}var o1,l4;function VV(){return l4||(l4=1,o1=GV().throttle),o1}var YV=VV();const KV=co(YV);var gm=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;console.warn(r.replace(/%s/g,()=>a[i++]))}},G6=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:i}=r,o=to(n)?e:Number(n),c=to(a)?t:Number(a);return s&&s>0&&(o?c=o/s:c&&(o=c*s),i&&c!=null&&c>i&&(c=i)),{calculatedWidth:o,calculatedHeight:c}},XV={width:0,height:0,overflow:"visible"},JV={width:0,overflowX:"visible"},ZV={height:0,overflowY:"visible"},QV={},eY=e=>{var{width:t,height:r}=e,n=to(t),a=to(r);return n&&a?XV:n?JV:a?ZV:QV};function tY(e){var{width:t,height:r,aspect:n}=e,a=t,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lv.apply(null,arguments)}function c4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c4(Object(r),!0).forEach(function(n){rY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rY(e,t,r){return(t=nY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nY(e){var t=aY(e,"string");return typeof t=="symbol"?t:t+""}function aY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V6=y.createContext({width:-1,height:-1});function sY(e){return ji(e.width)&&ji(e.height)}function Y6(e){var{children:t,width:r,height:n}=e,a=y.useMemo(()=>({width:r,height:n}),[r,n]);return sY(a)?y.createElement(V6.Provider,{value:a},t):null}var J2=()=>y.useContext(V6),iY=y.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:i=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:m,onResize:h,style:p={}}=e,g=y.useRef(null),v=y.useRef();v.current=h,y.useImperativeHandle(t,()=>g.current);var[b,S]=y.useState({containerWidth:n.width,containerHeight:n.height}),_=y.useCallback((k,T)=>{S(q=>{var F=Math.round(k),j=Math.round(T);return q.containerWidth===F&&q.containerHeight===j?q:{containerWidth:F,containerHeight:j}})},[]);y.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return Tf;var k=j=>{var U,{width:B,height:X}=j[0].contentRect;_(B,X),(U=v.current)===null||U===void 0||U.call(v,B,X)};d>0&&(k=KV(k,d,{trailing:!0,leading:!1}));var T=new ResizeObserver(k),{width:q,height:F}=g.current.getBoundingClientRect();return _(q,F),T.observe(g.current),()=>{T.disconnect()}},[_,d]);var{containerWidth:E,containerHeight:P}=b;gm(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:N,calculatedHeight:I}=G6(E,P,{width:a,height:s,aspect:r,maxHeight:c});return gm(N!=null&&N>0||I!=null&&I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,I,a,s,i,o,r),y.createElement("div",{id:f?"".concat(f):void 0,className:lr("recharts-responsive-container",m),style:u4(u4({},p),{},{width:a,height:s,minWidth:i,minHeight:o,maxHeight:c}),ref:g},y.createElement("div",{style:eY({width:a,height:s})},y.createElement(Y6,{width:N,height:I},u)))}),dh=y.forwardRef((e,t)=>{var r=J2();if(ji(r.width)&&ji(r.height))return e.children;var{width:n,height:a}=tY({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:i}=G6(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return bt(s)&&bt(i)?y.createElement(Y6,{width:s,height:i},e.children):y.createElement(iY,Lv({},e,{width:n,height:a,ref:t}))});function K6(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var jp=()=>{var e,t=ja(),r=St($V),n=St(Ap),a=(e=St(Np))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},oY={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},X6=()=>{var e;return(e=St(Dn))!==null&&e!==void 0?e:oY},Z2=()=>St(mo),Q2=()=>St(po),lY=()=>St(e=>e.layout.margin),er=e=>e.layout.layoutType,Nu=()=>St(er),cY=()=>{var e=Nu();return e!==void 0},kp=e=>{var t=Pr(),r=ja(),{width:n,height:a}=e,s=J2(),i=n,o=a;return s&&(i=s.width>0?s.width:n,o=s.height>0?s.height:a),y.useEffect(()=>{!r&&ji(i)&&ji(o)&&t(hV({width:i,height:o}))},[t,r,i,o]),null},J6=Symbol.for("immer-nothing"),d4=Symbol.for("immer-draftable"),fs=Symbol.for("immer-state");function Ks(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var sf=Object.getPrototypeOf;function hu(e){return!!e&&!!e[fs]}function Kl(e){var t;return e?Z6(e)||Array.isArray(e)||!!e[d4]||!!((t=e.constructor)!=null&&t[d4])||Lf(e)||Ep(e):!1}var uY=Object.prototype.constructor.toString(),f4=new WeakMap;function Z6(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=f4.get(r);return n===void 0&&(n=Function.toString.call(r),f4.set(r,n)),n===uY}function xm(e,t,r=!0){Cp(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Cp(e){const t=e[fs];return t?t.type_:Array.isArray(e)?1:Lf(e)?2:Ep(e)?3:0}function Dv(e,t){return Cp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Q6(e,t,r){const n=Cp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function dY(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Lf(e){return e instanceof Map}function Ep(e){return e instanceof Set}function bl(e){return e.copy_||e.base_}function Mv(e,t){if(Lf(e))return new Map(e);if(Ep(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Z6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[fs];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const i=a[s],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(sf(e),n)}else{const n=sf(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function eb(e,t=!1){return Tp(e)||hu(e)||!Kl(e)||(Cp(e)>1&&Object.defineProperties(e,{set:fh,add:fh,clear:fh,delete:fh}),Object.freeze(e),t&&Object.values(e).forEach(r=>eb(r,!0))),e}function fY(){Ks(2)}var fh={value:fY};function Tp(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var hY={};function Xl(e){const t=hY[e];return t||Ks(0,e),t}var of;function eE(){return of}function mY(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function h4(e,t){t&&(Xl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Rv(e){Bv(e),e.drafts_.forEach(pY),e.drafts_=null}function Bv(e){e===of&&(of=e.parent_)}function m4(e){return of=mY(of,e)}function pY(e){const t=e[fs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function p4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[fs].modified_&&(Rv(t),Ks(4)),Kl(e)&&(e=vm(t,e),t.parent_||ym(t,e)),t.patches_&&Xl("Patches").generateReplacementPatches_(r[fs].base_,e,t.patches_,t.inversePatches_)):e=vm(t,r,[]),Rv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==J6?e:void 0}function vm(e,t,r){if(Tp(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[fs];if(!a)return xm(t,(s,i)=>g4(e,a,t,s,i,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return ym(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let i=s,o=!1;a.type_===3&&(i=new Set(s),s.clear(),o=!0),xm(i,(c,u)=>g4(e,a,s,c,u,r,o),n),ym(e,s,!1),r&&e.patches_&&Xl("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function g4(e,t,r,n,a,s,i){if(a==null||typeof a!="object"&&!i)return;const o=Tp(a);if(!(o&&!i)){if(hu(a)){const c=s&&t&&t.type_!==3&&!Dv(t.assigned_,n)?s.concat(n):void 0,u=vm(e,a,c);if(Q6(r,n,u),hu(u))e.canAutoFreeze_=!1;else return}else i&&r.add(a);if(Kl(a)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&o)return;vm(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Lf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&ym(e,a)}}}function ym(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&eb(t,r)}function gY(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:eE(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=tb;r&&(a=[n],s=lf);const{revoke:i,proxy:o}=Proxy.revocable(a,s);return n.draft_=o,n.revoke_=i,o}var tb={get(e,t){if(t===fs)return e;const r=bl(e);if(!Dv(r,t))return xY(e,r,t);const n=r[t];return e.finalized_||!Kl(n)?n:n===l1(e.base_,t)?(c1(e),e.copy_[t]=zv(n,e)):n},has(e,t){return t in bl(e)},ownKeys(e){return Reflect.ownKeys(bl(e))},set(e,t,r){const n=tE(bl(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=l1(bl(e),t),s=a==null?void 0:a[fs];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(dY(r,a)&&(r!==void 0||Dv(e.base_,t)))return!0;c1(e),Uv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return l1(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,c1(e),Uv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=bl(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ks(11)},getPrototypeOf(e){return sf(e.base_)},setPrototypeOf(){Ks(12)}},lf={};xm(tb,(e,t)=>{lf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});lf.deleteProperty=function(e,t){return lf.set.call(this,e,t,void 0)};lf.set=function(e,t,r){return tb.set.call(this,e[0],t,r,e[0])};function l1(e,t){const r=e[fs];return(r?bl(r):e)[t]}function xY(e,t,r){var a;const n=tE(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function tE(e,t){if(!(t in e))return;let r=sf(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=sf(r)}}function Uv(e){e.modified_||(e.modified_=!0,e.parent_&&Uv(e.parent_))}function c1(e){e.copy_||(e.copy_=Mv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var vY=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const i=this;return function(c=s,...u){return i.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Ks(6),n!==void 0&&typeof n!="function"&&Ks(7);let a;if(Kl(t)){const s=m4(this),i=zv(t,void 0);let o=!0;try{a=r(i),o=!1}finally{o?Rv(s):Bv(s)}return h4(s,n),p4(a,s)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===J6&&(a=void 0),this.autoFreeze_&&eb(a,!0),n){const s=[],i=[];Xl("Patches").generateReplacementPatches_(t,a,s,i),n(s,i)}return a}else Ks(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,c=>t(c,...o));let n,a;return[this.produce(t,r,(i,o)=>{n=i,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Kl(e)||Ks(8),hu(e)&&(e=yY(e));const t=m4(this),r=zv(e,void 0);return r[fs].isManual_=!0,Bv(t),r}finishDraft(e,t){const r=e&&e[fs];(!r||!r.isManual_)&&Ks(9);const{scope_:n}=r;return h4(n,t),p4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Xl("Patches").applyPatches_;return hu(e)?n(e,t):this.produce(e,a=>n(a,t))}};function zv(e,t){const r=Lf(e)?Xl("MapSet").proxyMap_(e,t):Ep(e)?Xl("MapSet").proxySet_(e,t):gY(e,t);return(t?t.scope_:eE()).drafts_.push(r),r}function yY(e){return hu(e)||Ks(10,e),rE(e)}function rE(e){if(!Kl(e)||Tp(e))return e;const t=e[fs];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Mv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Mv(e,!0);return xm(r,(a,s)=>{Q6(r,a,rE(s))},n),t&&(t.finalized_=!1),r}var bY=new vY;bY.produce;var wY={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},nE=Va({name:"legend",initialState:wY,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Br()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ti(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:Br()},removeLegendPayload:{reducer(e,t){var r=ti(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Br()}}}),{setLegendSize:x4,setLegendSettings:SY,addLegendPayload:aE,replaceLegendPayload:sE,removeLegendPayload:iE}=nE.actions,_Y=nE.reducer,NY=["contextPayload"];function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$v.apply(null,arguments)}function v4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v4(Object(r),!0).forEach(function(n){AY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AY(e,t,r){return(t=jY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jY(e){var t=kY(e,"string");return typeof t=="symbol"?t:t+""}function kY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CY(e,t){if(e==null)return{};var r,n,a=EY(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function EY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function TY(e){return e.value}function PY(e){var{contextPayload:t}=e,r=CY(e,NY),n=s6(t,e.payloadUniqBy,TY),a=mu(mu({},r),{},{payload:n});return y.isValidElement(e.content)?y.cloneElement(e.content,a):typeof e.content=="function"?y.createElement(e.content,a):y.createElement(bq,a)}function OY(e,t,r,n,a,s){var{layout:i,align:o,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&i==="vertical"?u={left:((n||0)-s.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),mu(mu({},u),d)}function FY(e){var t=Pr();return y.useEffect(()=>{t(SY(e))},[t,e]),null}function IY(e){var t=Pr();return y.useEffect(()=>(t(x4(e)),()=>{t(x4({width:0,height:0}))}),[t,e]),null}function LY(e,t,r,n){return e==="vertical"&&bt(t)?{height:t}:e==="horizontal"?{width:r||n}:null}var DY={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function Wv(e){var t=kn(e,DY),r=pG(),n=dH(),a=lY(),{width:s,height:i,wrapperStyle:o,portal:c}=t,[u,d]=u6([r]),f=Z2(),m=Q2();if(f==null||m==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),p=LY(t.layout,i,s,h),g=c?o:mu(mu({position:"absolute",width:(p==null?void 0:p.width)||s||"auto",height:(p==null?void 0:p.height)||i||"auto"},OY(o,t,a,f,m,u)),o),v=c??n;if(v==null||r==null)return null;var b=y.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},y.createElement(FY,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&y.createElement(IY,{width:u.width,height:u.height}),y.createElement(PY,$v({},t,p,{margin:a,chartWidth:f,chartHeight:m,contextPayload:r})));return zy.createPortal(b,v)}Wv.displayName="Legend";function Hv(){return Hv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hv.apply(null,arguments)}function y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y4(Object(r),!0).forEach(function(n){MY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MY(e,t,r){return(t=RY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RY(e){var t=BY(e,"string");return typeof t=="symbol"?t:t+""}function BY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UY(e){return Array.isArray(e)&&Ai(e[0])&&Ai(e[1])?e.join(" ~ "):e}var zY=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:i,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:m=!1}=e,h=()=>{if(s&&s.length){var P={padding:0,margin:0},N=(o?fp(s,o):s).map((I,k)=>{if(I.type==="none")return null;var T=I.formatter||i||UY,{value:q,name:F}=I,j=q,U=F;if(T){var B=T(q,F,I,k,s);if(Array.isArray(B))[j,U]=B;else if(B!=null)j=B;else return null}var X=u1({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},n);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(k),style:X},Ai(U)?y.createElement("span",{className:"recharts-tooltip-item-name"},U):null,Ai(U)?y.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,y.createElement("span",{className:"recharts-tooltip-item-value"},j),y.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:P},N)}return null},p=u1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=u1({margin:0},a),v=!$r(d),b=v?d:"",S=lr("recharts-default-tooltip",c),_=lr("recharts-tooltip-label",u);v&&f&&s!==void 0&&s!==null&&(b=f(d,s));var E=m?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",Hv({className:S,style:p},E),y.createElement("p",{className:_,style:g},y.isValidElement(b)?b:"".concat(b)),h())},hd="recharts-tooltip-wrapper",$Y={visibility:"hidden"};function WY(e){var{coordinate:t,translateX:r,translateY:n}=e;return lr(hd,{["".concat(hd,"-right")]:bt(r)&&t&&bt(t.x)&&r>=t.x,["".concat(hd,"-left")]:bt(r)&&t&&bt(t.x)&&r<t.x,["".concat(hd,"-bottom")]:bt(n)&&t&&bt(t.y)&&n>=t.y,["".concat(hd,"-top")]:bt(n)&&t&&bt(t.y)&&n<t.y})}function b4(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(s&&bt(s[n]))return s[n];var d=r[n]-o-(a>0?a:0),f=r[n]+a;if(t[n])return i[n]?d:f;var m=c[n];if(m==null)return 0;if(i[n]){var h=d,p=m;return h<p?Math.max(f,m):Math.max(d,m)}if(u==null)return 0;var g=f+o,v=m+u;return g>v?Math.max(d,m):Math.max(f,m)}function HY(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function qY(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:i,useTranslate3d:o,viewBox:c}=e,u,d,f;return i.height>0&&i.width>0&&r?(d=b4({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=b4({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=HY({translateX:d,translateY:f,useTranslate3d:o})):u=$Y,{cssProperties:u,cssClasses:WY({translateX:d,translateY:f,coordinate:r})}}function w4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w4(Object(r),!0).forEach(function(n){qv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qv(e,t,r){return(t=GY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GY(e){var t=VY(e,"string");return typeof t=="symbol"?t:t+""}function VY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class YY extends y.PureComponent{constructor(){super(...arguments),qv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),qv(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:i,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:m,viewBox:h,wrapperStyle:p,lastBoundingBox:g,innerRef:v,hasPortalFromProps:b}=this.props,{cssClasses:S,cssProperties:_}=qY({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:m,viewBox:h}),E=b?{}:hh(hh({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),P=hh(hh({},E),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},p);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:P,ref:v},s)}}var oE=()=>{var e;return(e=St(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(null,arguments)}function S4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S4(Object(r),!0).forEach(function(n){KY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KY(e,t,r){return(t=XY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XY(e){var t=JY(e,"string");return typeof t=="symbol"?t:t+""}function JY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N4={curveBasisClosed:TH,curveBasisOpen:PH,curveBasis:EH,curveBumpX:pH,curveBumpY:gH,curveLinearClosed:OH,curveLinear:up,curveMonotoneX:FH,curveMonotoneY:IH,curveNatural:LH,curveStep:DH,curveStepAfter:RH,curveStepBefore:MH},bm=e=>Vr(e.x)&&Vr(e.y),A4=e=>e.base!=null&&bm(e.base)&&bm(e),md=e=>e.x,pd=e=>e.y,ZY=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Ef(e));return(r==="curveMonotone"||r==="curveBump")&&t?N4["".concat(r).concat(t==="vertical"?"Y":"X")]:N4[r]||up},QY=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=e,i=ZY(t,a),o=s?r.filter(bm):r,c;if(Array.isArray(n)){var u=r.map((h,p)=>_4(_4({},h),{},{base:n[p]}));a==="vertical"?c=ah().y(pd).x1(md).x0(h=>h.base.x):c=ah().x(md).y1(pd).y0(h=>h.base.y);var d=c.defined(A4).curve(i),f=s?u.filter(A4):u;return d(f)}a==="vertical"&&bt(n)?c=ah().y(pd).x1(md).x0(n):bt(n)?c=ah().x(md).y1(pd).y0(n):c=LC().x(md).y(pd);var m=c.defined(bm).curve(i);return m(o)},rb=e=>{var{className:t,points:r,path:n,pathRef:a}=e,s=Nu();if((!r||!r.length)&&!n)return null;var i={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},o=r&&r.length?QY(i):n;return y.createElement("path",Gv({},ds(e),U2(e),{className:lr("recharts-curve",t),d:o===null?void 0:o,ref:a}))},eK=["x","y","top","left","width","height","className"];function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vv.apply(null,arguments)}function j4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j4(Object(r),!0).forEach(function(n){rK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rK(e,t,r){return(t=nK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nK(e){var t=aK(e,"string");return typeof t=="symbol"?t:t+""}function aK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sK(e,t){if(e==null)return{};var r,n,a=iK(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var oK=(e,t,r,n,a,s)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),lK=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:s=0,height:i=0,className:o}=e,c=sK(e,eK),u=tK({x:t,y:r,top:n,left:a,width:s,height:i},c);return!bt(t)||!bt(r)||!bt(s)||!bt(i)||!bt(n)||!bt(a)?null:y.createElement("path",Vv({},La(u),{className:lr("recharts-cross",o),d:oK(t,r,s,i,n,a)}))};function cK(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function k4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k4(Object(r),!0).forEach(function(n){uK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uK(e,t,r){return(t=dK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dK(e){var t=fK(e,"string");return typeof t=="symbol"?t:t+""}function fK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hK=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),lE=(e,t,r)=>e.map(n=>"".concat(hK(n)," ").concat(t,"ms ").concat(r)).join(","),mK=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),cf=(e,t)=>Object.keys(t).reduce((r,n)=>C4(C4({},r),{},{[n]:e(n,t[n])}),{});function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){pK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=xK(e,"string");return typeof t=="symbol"?t:t+""}function xK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wm=(e,t,r)=>e+(t-e)*r,Yv=e=>{var{from:t,to:r}=e;return t!==r},cE=(e,t,r)=>{var n=cf((a,s)=>{if(Yv(s)){var[i,o]=e(s.from,s.to,s.velocity);return Pn(Pn({},s),{},{from:i,velocity:o})}return s},t);return r<1?cf((a,s)=>Yv(s)&&n[a]!=null?Pn(Pn({},s),{},{velocity:wm(s.velocity,n[a].velocity,r),from:wm(s.from,n[a].from,r)}):s,t):cE(e,n,r-1)};function vK(e,t,r,n,a,s){var i,o=n.reduce((m,h)=>Pn(Pn({},m),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>cf((m,h)=>h.from,o),u=()=>!Object.values(o).filter(Yv).length,d=null,f=m=>{i||(i=m);var h=m-i,p=h/r.dt;o=cE(r,o,p),a(Pn(Pn(Pn({},e),t),c())),i=m,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var m;(m=d)===null||m===void 0||m()})}function yK(e,t,r,n,a,s,i){var o=null,c=a.reduce((f,m)=>{var h=e[m],p=t[m];return h==null||p==null?f:Pn(Pn({},f),{},{[m]:[h,p]})},{}),u,d=f=>{u||(u=f);var m=(f-u)/n,h=cf((g,v)=>wm(...v,r(m)),c);if(s(Pn(Pn(Pn({},e),t),h)),m<1)o=i.setTimeout(d);else{var p=cf((g,v)=>wm(...v,r(1)),c);s(Pn(Pn(Pn({},e),t),p))}};return()=>(o=i.setTimeout(d),()=>{var f;(f=o)===null||f===void 0||f()})}const bK=(e,t,r,n,a,s)=>{var i=mK(e,t);return r==null?()=>(a(Pn(Pn({},e),t)),()=>{}):r.isStepper===!0?vK(e,t,r,i,a,s):yK(e,t,r,n,i,a,s)};var Sm=1e-4,uE=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],dE=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),T4=(e,t)=>r=>{var n=uE(e,t);return dE(n,r)},wK=(e,t)=>r=>{var n=uE(e,t),a=[...n.map((s,i)=>s*i).slice(1),0];return dE(a,r)},SK=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},_K=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=SK(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},NK=(e,t,r,n)=>{var a=T4(e,r),s=T4(t,n),i=wK(e,r),o=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,m=0;m<8;++m){var h=a(f)-d,p=i(f);if(Math.abs(h-d)<Sm||p<Sm)return s(f);f=o(f-h/p)}return s(f)};return c.isStepper=!1,c},P4=function(){return NK(..._K(...arguments))},AK=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,s=(i,o,c)=>{var u=-(i-o)*r,d=c*n,f=c+(u-d)*a/1e3,m=c*a/1e3+i;return Math.abs(m-o)<Sm&&Math.abs(f)<Sm?[o,0]:[m,f]};return s.isStepper=!0,s.dt=a,s},jK=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return P4(e);case"spring":return AK();default:if(e.split("(")[0]==="cubic-bezier")return P4(e)}return typeof e=="function"?e:null};function kK(e){var t,r=()=>null,n=!1,a=null,s=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[c,...u]=o;if(typeof c=="number"){a=e.setTimeout(s.bind(null,u),c);return}s(c),a=e.setTimeout(s.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,a&&(a(),a=null),s(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class CK{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function EK(){return kK(new CK)}var TK=y.createContext(EK);function PK(e,t){var r=y.useContext(TK);return y.useMemo(()=>t??r(e),[e,t,r])}var OK=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Pp={isSsr:OK()},FK={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},O4={t:0},d1={t:1};function Df(e){var t=kn(e,FK),{isActive:r,canBegin:n,duration:a,easing:s,begin:i,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=r==="auto"?!Pp.isSsr:r,f=PK(t.animationId,t.animationManager),[m,h]=y.useState(d?O4:d1),p=y.useRef(null);return y.useEffect(()=>{d||h(d1)},[d]),y.useEffect(()=>{if(!d||!n)return Tf;var g=bK(O4,d1,jK(s),a,h,f.getTimeoutController()),v=()=>{p.current=g()};return f.start([c,i,v,a,o]),()=>{f.stop(),p.current&&p.current(),o()}},[d,n,a,s,i,c,o,f]),u(m.t)}function Mf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=y.useRef(tf(t)),n=y.useRef(e);return n.current!==e&&(r.current=tf(t),n.current=e),r.current}var IK=["radius"],LK=["radius"],F4,I4,L4,D4,M4,R4,B4,U4,z4,$4;function W4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function H4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W4(Object(r),!0).forEach(function(n){DK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DK(e,t,r){return(t=MK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MK(e){var t=RK(e,"string");return typeof t=="symbol"?t:t+""}function RK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _m(){return _m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_m.apply(null,arguments)}function q4(e,t){if(e==null)return{};var r,n,a=BK(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mi(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var G4=(e,t,r,n,a)=>{var s=Wo(r),i=Wo(n),o=Math.min(Math.abs(s)/2,Math.abs(i)/2),c=i>=0?1:-1,u=s>=0?1:-1,d=i>=0&&s>=0||i<0&&s<0?1:0,f;if(o>0&&a instanceof Array){for(var m=[0,0,0,0],h=0,p=4;h<p;h++)m[h]=a[h]>o?o:a[h];f=Qr(F4||(F4=mi(["M",",",""])),e,t+c*m[0]),m[0]>0&&(f+=Qr(I4||(I4=mi(["A ",",",",0,0,",",",",",""])),m[0],m[0],d,e+u*m[0],t)),f+=Qr(L4||(L4=mi(["L ",",",""])),e+r-u*m[1],t),m[1]>0&&(f+=Qr(D4||(D4=mi(["A ",",",",0,0,",`,
        `,",",""])),m[1],m[1],d,e+r,t+c*m[1])),f+=Qr(M4||(M4=mi(["L ",",",""])),e+r,t+n-c*m[2]),m[2]>0&&(f+=Qr(R4||(R4=mi(["A ",",",",0,0,",`,
        `,",",""])),m[2],m[2],d,e+r-u*m[2],t+n)),f+=Qr(B4||(B4=mi(["L ",",",""])),e+u*m[3],t+n),m[3]>0&&(f+=Qr(U4||(U4=mi(["A ",",",",0,0,",`,
        `,",",""])),m[3],m[3],d,e,t+n-c*m[3])),f+="Z"}else if(o>0&&a===+a&&a>0){var g=Math.min(o,a);f=Qr(z4||(z4=mi(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*g,g,g,d,e+u*g,t,e+r-u*g,t,g,g,d,e+r,t+c*g,e+r,t+n-c*g,g,g,d,e+r-u*g,t+n,e+u*g,t+n,g,g,d,e,t+n-c*g)}else f=Qr($4||($4=mi(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},V4={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fE=e=>{var t=kn(e,V4),r=y.useRef(null),[n,a]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ee=r.current.getTotalLength();ee&&a(ee)}catch{}},[]);var{x:s,y:i,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:m,animationBegin:h,isAnimationActive:p,isUpdateAnimationActive:g}=t,v=y.useRef(o),b=y.useRef(c),S=y.useRef(s),_=y.useRef(i),E=y.useMemo(()=>({x:s,y:i,width:o,height:c,radius:u}),[s,i,o,c,u]),P=Mf(E,"rectangle-");if(s!==+s||i!==+i||o!==+o||c!==+c||o===0||c===0)return null;var N=lr("recharts-rectangle",d);if(!g){var I=La(t),{radius:k}=I,T=q4(I,IK);return y.createElement("path",_m({},T,{x:Wo(s),y:Wo(i),width:Wo(o),height:Wo(c),radius:typeof u=="number"?u:void 0,className:N,d:G4(s,i,o,c,u)}))}var q=v.current,F=b.current,j=S.current,U=_.current,B="0px ".concat(n===-1?1:n,"px"),X="".concat(n,"px 0px"),K=lE(["strokeDasharray"],m,typeof f=="string"?f:V4.animationEasing);return y.createElement(Df,{animationId:P,key:P,canBegin:n>0,duration:m,easing:f,isActive:g,begin:h},ee=>{var Y=Ur(q,o,ee),z=Ur(F,c,ee),ne=Ur(j,s,ee),le=Ur(U,i,ee);r.current&&(v.current=Y,b.current=z,S.current=ne,_.current=le);var A;p?ee>0?A={transition:K,strokeDasharray:X}:A={strokeDasharray:B}:A={strokeDasharray:X};var D=La(t),{radius:L}=D,M=q4(D,LK);return y.createElement("path",_m({},M,{radius:typeof u=="number"?u:void 0,className:N,d:G4(ne,le,Y,z,u),ref:r,style:H4(H4({},A),t.style)}))})};function Y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y4(Object(r),!0).forEach(function(n){UK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UK(e,t,r){return(t=zK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zK(e){var t=$K(e,"string");return typeof t=="symbol"?t:t+""}function $K(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nm=Math.PI/180,WK=e=>e*180/Math.PI,Nn=(e,t,r,n)=>({x:e+Math.cos(-Nm*n)*r,y:t+Math.sin(-Nm*n)*r}),hE=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},HK=(e,t)=>{var{x:r,y:n}=e,{x:a,y:s}=t;return Math.sqrt((r-a)**2+(n-s)**2)},qK=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:s}=t,i=HK({x:r,y:n},{x:a,y:s});if(i<=0)return{radius:i,angle:0};var o=(r-a)/i,c=Math.acos(o);return n>s&&(c=2*Math.PI-c),{radius:i,angle:WK(c),angleInRadian:c}},GK=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:t-s*360,endAngle:r-s*360}},VK=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),s=Math.floor(n/360),i=Math.min(a,s);return e+i*360},YK=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:s}=qK({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(a<i||a>o||a===0)return null;var{startAngle:c,endAngle:u}=GK(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?K4(K4({},t),{},{radius:a,angle:VK(d,t)}):null};function mE(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:s}=e,i=Nn(t,r,n,a),o=Nn(t,r,n,s);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:s}}var X4,J4,Z4,Q4,eN,tN,rN;function Kv(){return Kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kv.apply(null,arguments)}function kl(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var KK=(e,t)=>{var r=Zn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},mh=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:s,isExternal:i,cornerRadius:o,cornerIsExternal:c}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/Nm,f=c?a:a+s*d,m=Nn(t,r,u,f),h=Nn(t,r,n,f),p=c?a-s*d:a,g=Nn(t,r,u*Math.cos(d*Nm),p);return{center:m,circleTangency:h,lineTangency:g,theta:d}},pE=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:i}=e,o=KK(s,i),c=s+o,u=Nn(t,r,a,s),d=Nn(t,r,a,c),f=Qr(X4||(X4=kl(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(o)>180),+(s>c),d.x,d.y);if(n>0){var m=Nn(t,r,n,s),h=Nn(t,r,n,c);f+=Qr(J4||(J4=kl(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(o)>180),+(s<=c),m.x,m.y)}else f+=Qr(Z4||(Z4=kl(["L ",","," Z"])),t,r);return f},XK=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:i,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=Zn(u-c),{circleTangency:f,lineTangency:m,theta:h}=mh({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:o}),{circleTangency:p,lineTangency:g,theta:v}=mh({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:o}),b=o?Math.abs(c-u):Math.abs(c-u)-h-v;if(b<0)return i?Qr(Q4||(Q4=kl(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),m.x,m.y,s,s,s*2,s,s,-s*2):pE({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var S=Qr(eN||(eN=kl(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),m.x,m.y,s,s,+(d<0),f.x,f.y,a,a,+(b>180),+(d<0),p.x,p.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:_,lineTangency:E,theta:P}=mh({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),{circleTangency:N,lineTangency:I,theta:k}=mh({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),T=o?Math.abs(c-u):Math.abs(c-u)-P-k;if(T<0&&s===0)return"".concat(S,"L").concat(t,",").concat(r,"Z");S+=Qr(tN||(tN=kl(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),I.x,I.y,s,s,+(d<0),N.x,N.y,n,n,+(T>180),+(d>0),_.x,_.y,s,s,+(d<0),E.x,E.y)}else S+=Qr(rN||(rN=kl(["L",",","Z"])),t,r);return S},JK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gE=e=>{var t=kn(e,JK),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<a||u===d)return null;var m=lr("recharts-sector",f),h=s-a,p=_a(i,h,0,!0),g;return p>0&&Math.abs(u-d)<360?g=XK({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(p,h/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):g=pE({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),y.createElement("path",Kv({},La(t),{className:m,d:g}))};function ZK(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(XC(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:i,angle:o}=t,c=Nn(n,a,s,o),u=Nn(n,a,i,o);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return mE(t)}}var f1={},h1={},m1={},nN;function QK(){return nN||(nN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o6();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(m1)),m1}var aN;function eX(){return aN||(aN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QK();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(h1)),h1}var sN;function tX(){return sN||(sN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l6(),r=eX();function n(a,s,i){i&&typeof i!="number"&&t.isIterateeCall(a,s,i)&&(s=i=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),i=i===void 0?a<s?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((s-a)/(i||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=a,a+=i;return c}e.range=n})(f1)),f1}var p1,iN;function rX(){return iN||(iN=1,p1=tX().range),p1}var nX=rX();const xE=co(nX);function qo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function aX(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nb(e){let t,r,n;e.length!==2?(t=qo,r=(o,c)=>qo(e(o),c),n=(o,c)=>e(o)-c):(t=e===qo||e===aX?e:sX,r=e,n=e);function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){const f=a(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:a,center:i,right:s}}function sX(){return 0}function vE(e){return e===null?NaN:+e}function*iX(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const oX=nb(qo),Rf=oX.right;nb(vE).center;class oN extends Map{constructor(t,r=uX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(lN(this,t))}has(t){return super.has(lN(this,t))}set(t,r){return super.set(lX(this,t),r)}delete(t){return super.delete(cX(this,t))}}function lN({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function lX({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function cX({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function uX(e){return e!==null&&typeof e=="object"?e.valueOf():e}function dX(e=qo){if(e===qo)return yE;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function yE(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const fX=Math.sqrt(50),hX=Math.sqrt(10),mX=Math.sqrt(2);function Am(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),i=s>=fX?10:s>=hX?5:s>=mX?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/i,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*i,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Am(e,t,r*2):[o,c,u]}function Xv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,s,i]=n?Am(t,e,r):Am(e,t,r);if(!(s>=a))return[];const o=s-a+1,c=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)c[u]=(s-u)/-i;else for(let u=0;u<o;++u)c[u]=(s-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(a+u)/-i;else for(let u=0;u<o;++u)c[u]=(a+u)*i;return c}function Jv(e,t,r){return t=+t,e=+e,r=+r,Am(e,t,r)[2]}function Zv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Jv(t,e,r):Jv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function cN(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function uN(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function bE(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?yE:dX(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*f/c+m)),p=Math.min(n,Math.floor(t+(c-u)*f/c+m));bE(e,t,h,p,a)}const s=e[t];let i=r,o=n;for(gd(e,r,t),a(e[n],s)>0&&gd(e,r,n);i<o;){for(gd(e,i,o),++i,--o;a(e[i],s)<0;)++i;for(;a(e[o],s)>0;)--o}a(e[r],s)===0?gd(e,r,o):(++o,gd(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function gd(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function pX(e,t,r){if(e=Float64Array.from(iX(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return uN(e);if(t>=1)return cN(e);var n,a=(n-1)*t,s=Math.floor(a),i=cN(bE(e,s).subarray(0,s+1)),o=uN(e.subarray(s+1));return i+(o-i)*(a-s)}}function gX(e,t,r=vE){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,s=Math.floor(a),i=+r(e[s],s,e),o=+r(e[s+1],s+1,e);return i+(o-i)*(a-s)}}function xX(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(a);++n<a;)s[n]=e+n*r;return s}function Ds(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function go(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Qv=Symbol("implicit");function ab(){var e=new oN,t=[],r=[],n=Qv;function a(s){let i=e.get(s);if(i===void 0){if(n!==Qv)return n;e.set(s,i=t.push(s)-1)}return r[i%r.length]}return a.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new oN;for(const i of s)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return ab(t,r).unknown(n)},Ds.apply(a,arguments),a}function sb(){var e=ab().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,s,i,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var m=t().length,h=a<n,p=h?a:n,g=h?n:a;s=(g-p)/Math.max(1,m-c+u*2),o&&(s=Math.floor(s)),p+=(g-p-s*(m-c))*d,i=s*(1-c),o&&(p=Math.round(p),i=Math.round(i));var v=xX(m).map(function(b){return p+s*b});return r(h?v.reverse():v)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,o=!0,f()},e.bandwidth=function(){return i},e.step=function(){return s},e.round=function(m){return arguments.length?(o=!!m,f()):o},e.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),f()):d},e.copy=function(){return sb(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ds.apply(f(),arguments)}function wE(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return wE(t())},e}function vX(){return wE(sb.apply(null,arguments).paddingInner(1))}function ib(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function SE(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Bf(){}var uf=.7,jm=1/uf,ru="\\s*([+-]?\\d+)\\s*",df="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_i="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yX=/^#([0-9a-f]{3,8})$/,bX=new RegExp(`^rgb\\(${ru},${ru},${ru}\\)$`),wX=new RegExp(`^rgb\\(${_i},${_i},${_i}\\)$`),SX=new RegExp(`^rgba\\(${ru},${ru},${ru},${df}\\)$`),_X=new RegExp(`^rgba\\(${_i},${_i},${_i},${df}\\)$`),NX=new RegExp(`^hsl\\(${df},${_i},${_i}\\)$`),AX=new RegExp(`^hsla\\(${df},${_i},${_i},${df}\\)$`),dN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ib(Bf,ff,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:fN,formatHex:fN,formatHex8:jX,formatHsl:kX,formatRgb:hN,toString:hN});function fN(){return this.rgb().formatHex()}function jX(){return this.rgb().formatHex8()}function kX(){return _E(this).formatHsl()}function hN(){return this.rgb().formatRgb()}function ff(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=yX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?mN(t):r===3?new Ha(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ph(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ph(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=bX.exec(e))?new Ha(t[1],t[2],t[3],1):(t=wX.exec(e))?new Ha(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=SX.exec(e))?ph(t[1],t[2],t[3],t[4]):(t=_X.exec(e))?ph(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=NX.exec(e))?xN(t[1],t[2]/100,t[3]/100,1):(t=AX.exec(e))?xN(t[1],t[2]/100,t[3]/100,t[4]):dN.hasOwnProperty(e)?mN(dN[e]):e==="transparent"?new Ha(NaN,NaN,NaN,0):null}function mN(e){return new Ha(e>>16&255,e>>8&255,e&255,1)}function ph(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ha(e,t,r,n)}function CX(e){return e instanceof Bf||(e=ff(e)),e?(e=e.rgb(),new Ha(e.r,e.g,e.b,e.opacity)):new Ha}function ey(e,t,r,n){return arguments.length===1?CX(e):new Ha(e,t,r,n??1)}function Ha(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ib(Ha,ey,SE(Bf,{brighter(e){return e=e==null?jm:Math.pow(jm,e),new Ha(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?uf:Math.pow(uf,e),new Ha(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ha(Dl(this.r),Dl(this.g),Dl(this.b),km(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pN,formatHex:pN,formatHex8:EX,formatRgb:gN,toString:gN}));function pN(){return`#${Cl(this.r)}${Cl(this.g)}${Cl(this.b)}`}function EX(){return`#${Cl(this.r)}${Cl(this.g)}${Cl(this.b)}${Cl((isNaN(this.opacity)?1:this.opacity)*255)}`}function gN(){const e=km(this.opacity);return`${e===1?"rgb(":"rgba("}${Dl(this.r)}, ${Dl(this.g)}, ${Dl(this.b)}${e===1?")":`, ${e})`}`}function km(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Dl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Cl(e){return e=Dl(e),(e<16?"0":"")+e.toString(16)}function xN(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Xs(e,t,r,n)}function _E(e){if(e instanceof Xs)return new Xs(e.h,e.s,e.l,e.opacity);if(e instanceof Bf||(e=ff(e)),!e)return new Xs;if(e instanceof Xs)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),s=Math.max(t,r,n),i=NaN,o=s-a,c=(s+a)/2;return o?(t===s?i=(r-n)/o+(r<n)*6:r===s?i=(n-t)/o+2:i=(t-r)/o+4,o/=c<.5?s+a:2-s-a,i*=60):o=c>0&&c<1?0:i,new Xs(i,o,c,e.opacity)}function TX(e,t,r,n){return arguments.length===1?_E(e):new Xs(e,t,r,n??1)}function Xs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ib(Xs,TX,SE(Bf,{brighter(e){return e=e==null?jm:Math.pow(jm,e),new Xs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?uf:Math.pow(uf,e),new Xs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Ha(g1(e>=240?e-240:e+120,a,n),g1(e,a,n),g1(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Xs(vN(this.h),gh(this.s),gh(this.l),km(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=km(this.opacity);return`${e===1?"hsl(":"hsla("}${vN(this.h)}, ${gh(this.s)*100}%, ${gh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function vN(e){return e=(e||0)%360,e<0?e+360:e}function gh(e){return Math.max(0,Math.min(1,e||0))}function g1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const ob=e=>()=>e;function PX(e,t){return function(r){return e+r*t}}function OX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function FX(e){return(e=+e)==1?NE:function(t,r){return r-t?OX(t,r,e):ob(isNaN(t)?r:t)}}function NE(e,t){var r=t-e;return r?PX(e,r):ob(isNaN(e)?t:e)}const yN=(function e(t){var r=FX(t);function n(a,s){var i=r((a=ey(a)).r,(s=ey(s)).r),o=r(a.g,s.g),c=r(a.b,s.b),u=NE(a.opacity,s.opacity);return function(d){return a.r=i(d),a.g=o(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n})(1);function IX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=e[a]*(1-s)+t[a]*s;return n}}function LX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function DX(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),s=new Array(r),i;for(i=0;i<n;++i)a[i]=Au(e[i],t[i]);for(;i<r;++i)s[i]=t[i];return function(o){for(i=0;i<n;++i)s[i]=a[i](o);return s}}function MX(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Cm(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function RX(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Au(e[a],t[a]):n[a]=t[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var ty=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x1=new RegExp(ty.source,"g");function BX(e){return function(){return e}}function UX(e){return function(t){return e(t)+""}}function zX(e,t){var r=ty.lastIndex=x1.lastIndex=0,n,a,s,i=-1,o=[],c=[];for(e=e+"",t=t+"";(n=ty.exec(e))&&(a=x1.exec(t));)(s=a.index)>r&&(s=t.slice(r,s),o[i]?o[i]+=s:o[++i]=s),(n=n[0])===(a=a[0])?o[i]?o[i]+=a:o[++i]=a:(o[++i]=null,c.push({i,x:Cm(n,a)})),r=x1.lastIndex;return r<t.length&&(s=t.slice(r),o[i]?o[i]+=s:o[++i]=s),o.length<2?c[0]?UX(c[0].x):BX(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function Au(e,t){var r=typeof t,n;return t==null||r==="boolean"?ob(t):(r==="number"?Cm:r==="string"?(n=ff(t))?(t=n,yN):zX:t instanceof ff?yN:t instanceof Date?MX:LX(t)?IX:Array.isArray(t)?DX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?RX:Cm)(e,t)}function lb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function $X(e,t){t===void 0&&(t=e,e=Au);for(var r=0,n=t.length-1,a=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(a,a=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return s[o](i-o)}}function WX(e){return function(){return e}}function Em(e){return+e}var bN=[0,1];function Fa(e){return e}function ry(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:WX(isNaN(t)?NaN:.5)}function HX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function qX(e,t,r){var n=e[0],a=e[1],s=t[0],i=t[1];return a<n?(n=ry(a,n),s=r(i,s)):(n=ry(n,a),s=r(s,i)),function(o){return s(n(o))}}function GX(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),s=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)a[i]=ry(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(o){var c=Rf(e,o,1,n)-1;return s[c](a[c](o))}}function Uf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Op(){var e=bN,t=bN,r=Au,n,a,s,i=Fa,o,c,u;function d(){var m=Math.min(e.length,t.length);return i!==Fa&&(i=HX(e[0],e[m-1])),o=m>2?GX:qX,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?s:(c||(c=o(e.map(n),t,r)))(n(i(m)))}return f.invert=function(m){return i(a((u||(u=o(t,e.map(n),Cm)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,Em),d()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=lb,d()},f.clamp=function(m){return arguments.length?(i=m?!0:Fa,d()):i!==Fa},f.interpolate=function(m){return arguments.length?(r=m,d()):r},f.unknown=function(m){return arguments.length?(s=m,f):s},function(m,h){return n=m,a=h,d()}}function cb(){return Op()(Fa,Fa)}function VX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Tm(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function pu(e){return e=Tm(Math.abs(e)),e?e[1]:NaN}function YX(e,t){return function(r,n){for(var a=r.length,s=[],i=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),s.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[i=(i+1)%e.length];return s.reverse().join(t)}}function KX(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var XX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hf(e){if(!(t=XX.exec(e)))throw new Error("invalid format: "+e);var t;return new ub({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hf.prototype=ub.prototype;function ub(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ub.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function JX(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Pm;function ZX(e,t){var r=Tm(e,t);if(!r)return Pm=void 0,e.toPrecision(t);var n=r[0],a=r[1],s=a-(Pm=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=n.length;return s===i?n:s>i?n+new Array(s-i+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Tm(e,Math.max(0,t+s-1))[0]}function wN(e,t){var r=Tm(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const SN={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:VX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wN(e*100,t),r:wN,s:ZX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _N(e){return e}var NN=Array.prototype.map,AN=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function QX(e){var t=e.grouping===void 0||e.thousands===void 0?_N:YX(NN.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?_N:KX(NN.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,m){f=hf(f);var h=f.fill,p=f.align,g=f.sign,v=f.symbol,b=f.zero,S=f.width,_=f.comma,E=f.precision,P=f.trim,N=f.type;N==="n"?(_=!0,N="g"):SN[N]||(E===void 0&&(E=12),P=!0,N="g"),(b||h==="0"&&p==="=")&&(b=!0,h="0",p="=");var I=(m&&m.prefix!==void 0?m.prefix:"")+(v==="$"?r:v==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():""),k=(v==="$"?n:/[%p]/.test(N)?i:"")+(m&&m.suffix!==void 0?m.suffix:""),T=SN[N],q=/[defgprs%]/.test(N);E=E===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function F(j){var U=I,B=k,X,K,ee;if(N==="c")B=T(j)+B,j="";else{j=+j;var Y=j<0||1/j<0;if(j=isNaN(j)?c:T(Math.abs(j),E),P&&(j=JX(j)),Y&&+j==0&&g!=="+"&&(Y=!1),U=(Y?g==="("?g:o:g==="-"||g==="("?"":g)+U,B=(N==="s"&&!isNaN(j)&&Pm!==void 0?AN[8+Pm/3]:"")+B+(Y&&g==="("?")":""),q){for(X=-1,K=j.length;++X<K;)if(ee=j.charCodeAt(X),48>ee||ee>57){B=(ee===46?a+j.slice(X+1):j.slice(X))+B,j=j.slice(0,X);break}}}_&&!b&&(j=t(j,1/0));var z=U.length+j.length+B.length,ne=z<S?new Array(S-z+1).join(h):"";switch(_&&b&&(j=t(ne+j,ne.length?S-B.length:1/0),ne=""),p){case"<":j=U+j+B+ne;break;case"=":j=U+ne+j+B;break;case"^":j=ne.slice(0,z=ne.length>>1)+U+j+B+ne.slice(z);break;default:j=ne+U+j+B;break}return s(j)}return F.toString=function(){return f+""},F}function d(f,m){var h=Math.max(-8,Math.min(8,Math.floor(pu(m)/3)))*3,p=Math.pow(10,-h),g=u((f=hf(f),f.type="f",f),{suffix:AN[8+h/3]});return function(v){return g(p*v)}}return{format:u,formatPrefix:d}}var xh,db,AE;eJ({thousands:",",grouping:[3],currency:["$",""]});function eJ(e){return xh=QX(e),db=xh.format,AE=xh.formatPrefix,xh}function tJ(e){return Math.max(0,-pu(Math.abs(e)))}function rJ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pu(t)/3)))*3-pu(Math.abs(e)))}function nJ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,pu(t)-pu(e))+1}function jE(e,t,r,n){var a=Zv(e,t,r),s;switch(n=hf(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=rJ(a,i))&&(n.precision=s),AE(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=nJ(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=tJ(a))&&(n.precision=s-(n.type==="%")*2);break}}return db(n)}function ol(e){var t=e.domain;return e.ticks=function(r){var n=t();return Xv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return jE(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,s=n.length-1,i=n[a],o=n[s],c,u,d=10;for(o<i&&(u=i,i=o,o=u,u=a,a=s,s=u);d-- >0;){if(u=Jv(i,o,r),u===c)return n[a]=i,n[s]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function kE(){var e=cb();return e.copy=function(){return Uf(e,kE())},Ds.apply(e,arguments),ol(e)}function CE(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Em),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return CE(e).unknown(t)},e=arguments.length?Array.from(e,Em):[0,1],ol(r)}function EE(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],s=e[n],i;return s<a&&(i=r,r=n,n=i,i=a,a=s,s=i),e[r]=t.floor(a),e[n]=t.ceil(s),e}function jN(e){return Math.log(e)}function kN(e){return Math.exp(e)}function aJ(e){return-Math.log(-e)}function sJ(e){return-Math.exp(-e)}function iJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function oJ(e){return e===10?iJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function lJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function CN(e){return(t,r)=>-e(-t,r)}function fb(e){const t=e(jN,kN),r=t.domain;let n=10,a,s;function i(){return a=lJ(n),s=oJ(n),r()[0]<0?(a=CN(a),s=CN(s),e(aJ,sJ)):e(jN,kN),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let m=a(u),h=a(d),p,g;const v=o==null?10:+o;let b=[];if(!(n%1)&&h-m<v){if(m=Math.floor(m),h=Math.ceil(h),u>0){for(;m<=h;++m)for(p=1;p<n;++p)if(g=m<0?p/s(-m):p*s(m),!(g<u)){if(g>d)break;b.push(g)}}else for(;m<=h;++m)for(p=n-1;p>=1;--p)if(g=m>0?p/s(-m):p*s(m),!(g<u)){if(g>d)break;b.push(g)}b.length*2<v&&(b=Xv(u,d,v))}else b=Xv(m,h,Math.min(h-m,v)).map(s);return f?b.reverse():b},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=hf(c)).precision==null&&(c.trim=!0),c=db(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(EE(r(),{floor:o=>s(Math.floor(a(o))),ceil:o=>s(Math.ceil(a(o)))})),t}function TE(){const e=fb(Op()).domain([1,10]);return e.copy=()=>Uf(e,TE()).base(e.base()),Ds.apply(e,arguments),e}function EN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function TN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function hb(e){var t=1,r=e(EN(t),TN(t));return r.constant=function(n){return arguments.length?e(EN(t=+n),TN(t)):t},ol(r)}function PE(){var e=hb(Op());return e.copy=function(){return Uf(e,PE()).constant(e.constant())},Ds.apply(e,arguments)}function PN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function cJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function uJ(e){return e<0?-e*e:e*e}function mb(e){var t=e(Fa,Fa),r=1;function n(){return r===1?e(Fa,Fa):r===.5?e(cJ,uJ):e(PN(r),PN(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ol(t)}function pb(){var e=mb(Op());return e.copy=function(){return Uf(e,pb()).exponent(e.exponent())},Ds.apply(e,arguments),e}function dJ(){return pb.apply(null,arguments).exponent(.5)}function ON(e){return Math.sign(e)*e*e}function fJ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function OE(){var e=cb(),t=[0,1],r=!1,n;function a(s){var i=fJ(e(s));return isNaN(i)?n:r?Math.round(i):i}return a.invert=function(s){return e.invert(ON(s))},a.domain=function(s){return arguments.length?(e.domain(s),a):e.domain()},a.range=function(s){return arguments.length?(e.range((t=Array.from(s,Em)).map(ON)),a):t.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(e.clamp(s),a):e.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return OE(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ds.apply(a,arguments),ol(a)}function FE(){var e=[],t=[],r=[],n;function a(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=gX(e,i/o);return s}function s(i){return i==null||isNaN(i=+i)?n:t[Rf(r,i)]}return s.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},s.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(qo),a()},s.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},s.unknown=function(i){return arguments.length?(n=i,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return FE().domain(e).range(t).unknown(n)},Ds.apply(s,arguments)}function IE(){var e=0,t=1,r=1,n=[.5],a=[0,1],s;function i(c){return c!=null&&c<=c?a[Rf(n,c,0,r)]:s}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},i.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},i.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(s=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return IE().domain([e,t]).range(a).unknown(s)},Ds.apply(ol(i),arguments)}function LE(){var e=[.5],t=[0,1],r,n=1;function a(s){return s!=null&&s<=s?t[Rf(e,s,0,n)]:r}return a.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(s){var i=t.indexOf(s);return[e[i-1],e[i]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return LE().domain(e).range(t).unknown(r)},Ds.apply(a,arguments)}const v1=new Date,y1=new Date;function Mn(e,t,r,n){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(e(s=new Date(+s)),s),a.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),a.round=s=>{const i=a(s),o=a.ceil(s);return s-i<o-s?i:o},a.offset=(s,i)=>(t(s=new Date(+s),i==null?1:Math.floor(i)),s),a.range=(s,i,o)=>{const c=[];if(s=a.ceil(s),o=o==null?1:Math.floor(o),!(s<i)||!(o>0))return c;let u;do c.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<i);return c},a.filter=s=>Mn(i=>{if(i>=i)for(;e(i),!s(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!s(i););else for(;--o>=0;)for(;t(i,1),!s(i););}),r&&(a.count=(s,i)=>(v1.setTime(+s),y1.setTime(+i),e(v1),e(y1),Math.floor(r(v1,y1))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?i=>n(i)%s===0:i=>a.count(0,i)%s===0):a)),a}const Om=Mn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Om.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Mn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Om);Om.range;const Gi=1e3,Ts=Gi*60,Vi=Ts*60,no=Vi*24,gb=no*7,FN=no*30,b1=no*365,El=Mn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Gi)},(e,t)=>(t-e)/Gi,e=>e.getUTCSeconds());El.range;const xb=Mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gi)},(e,t)=>{e.setTime(+e+t*Ts)},(e,t)=>(t-e)/Ts,e=>e.getMinutes());xb.range;const vb=Mn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ts)},(e,t)=>(t-e)/Ts,e=>e.getUTCMinutes());vb.range;const yb=Mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gi-e.getMinutes()*Ts)},(e,t)=>{e.setTime(+e+t*Vi)},(e,t)=>(t-e)/Vi,e=>e.getHours());yb.range;const bb=Mn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Vi)},(e,t)=>(t-e)/Vi,e=>e.getUTCHours());bb.range;const zf=Mn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ts)/no,e=>e.getDate()-1);zf.range;const Fp=Mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/no,e=>e.getUTCDate()-1);Fp.range;const DE=Mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/no,e=>Math.floor(e/no));DE.range;function oc(e){return Mn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ts)/gb)}const Ip=oc(0),Fm=oc(1),hJ=oc(2),mJ=oc(3),gu=oc(4),pJ=oc(5),gJ=oc(6);Ip.range;Fm.range;hJ.range;mJ.range;gu.range;pJ.range;gJ.range;function lc(e){return Mn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/gb)}const Lp=lc(0),Im=lc(1),xJ=lc(2),vJ=lc(3),xu=lc(4),yJ=lc(5),bJ=lc(6);Lp.range;Im.range;xJ.range;vJ.range;xu.range;yJ.range;bJ.range;const wb=Mn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wb.range;const Sb=Mn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Sb.range;const ao=Mn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ao.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ao.range;const so=Mn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());so.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Mn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});so.range;function ME(e,t,r,n,a,s){const i=[[El,1,Gi],[El,5,5*Gi],[El,15,15*Gi],[El,30,30*Gi],[s,1,Ts],[s,5,5*Ts],[s,15,15*Ts],[s,30,30*Ts],[a,1,Vi],[a,3,3*Vi],[a,6,6*Vi],[a,12,12*Vi],[n,1,no],[n,2,2*no],[r,1,gb],[t,1,FN],[t,3,3*FN],[e,1,b1]];function o(u,d,f){const m=d<u;m&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),p=h?h.range(u,+d+1):[];return m?p.reverse():p}function c(u,d,f){const m=Math.abs(d-u)/f,h=nb(([,,v])=>v).right(i,m);if(h===i.length)return e.every(Zv(u/b1,d/b1,f));if(h===0)return Om.every(Math.max(Zv(u,d,f),1));const[p,g]=i[m/i[h-1][2]<i[h][2]/m?h-1:h];return p.every(g)}return[o,c]}const[wJ,SJ]=ME(so,Sb,Lp,DE,bb,vb),[_J,NJ]=ME(ao,wb,Ip,zf,yb,xb);function w1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function S1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function AJ(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,s=e.days,i=e.shortDays,o=e.months,c=e.shortMonths,u=vd(a),d=yd(a),f=vd(s),m=yd(s),h=vd(i),p=yd(i),g=vd(o),v=yd(o),b=vd(c),S=yd(c),_={a:ee,A:Y,b:z,B:ne,c:null,d:BN,e:BN,f:YJ,g:aZ,G:iZ,H:qJ,I:GJ,j:VJ,L:RE,m:KJ,M:XJ,p:le,q:A,Q:$N,s:WN,S:JJ,u:ZJ,U:QJ,V:eZ,w:tZ,W:rZ,x:null,X:null,y:nZ,Y:sZ,Z:oZ,"%":zN},E={a:D,A:L,b:M,B:R,c:null,d:UN,e:UN,f:dZ,g:wZ,G:_Z,H:lZ,I:cZ,j:uZ,L:UE,m:fZ,M:hZ,p:H,q:J,Q:$N,s:WN,S:mZ,u:pZ,U:gZ,V:xZ,w:vZ,W:yZ,x:null,X:null,y:bZ,Y:SZ,Z:NZ,"%":zN},P={a:q,A:F,b:j,B:U,c:B,d:MN,e:MN,f:zJ,g:DN,G:LN,H:RN,I:RN,j:MJ,L:UJ,m:DJ,M:RJ,p:T,q:LJ,Q:WJ,s:HJ,S:BJ,u:TJ,U:PJ,V:OJ,w:EJ,W:FJ,x:X,X:K,y:DN,Y:LN,Z:IJ,"%":$J};_.x=N(r,_),_.X=N(n,_),_.c=N(t,_),E.x=N(r,E),E.X=N(n,E),E.c=N(t,E);function N(G,Q){return function(de){var V=[],Ee=-1,we=0,he=G.length,Z,Se,ge;for(de instanceof Date||(de=new Date(+de));++Ee<he;)G.charCodeAt(Ee)===37&&(V.push(G.slice(we,Ee)),(Se=IN[Z=G.charAt(++Ee)])!=null?Z=G.charAt(++Ee):Se=Z==="e"?" ":"0",(ge=Q[Z])&&(Z=ge(de,Se)),V.push(Z),we=Ee+1);return V.push(G.slice(we,Ee)),V.join("")}}function I(G,Q){return function(de){var V=xd(1900,void 0,1),Ee=k(V,G,de+="",0),we,he;if(Ee!=de.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(Q&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(we=S1(xd(V.y,0,1)),he=we.getUTCDay(),we=he>4||he===0?Im.ceil(we):Im(we),we=Fp.offset(we,(V.V-1)*7),V.y=we.getUTCFullYear(),V.m=we.getUTCMonth(),V.d=we.getUTCDate()+(V.w+6)%7):(we=w1(xd(V.y,0,1)),he=we.getDay(),we=he>4||he===0?Fm.ceil(we):Fm(we),we=zf.offset(we,(V.V-1)*7),V.y=we.getFullYear(),V.m=we.getMonth(),V.d=we.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),he="Z"in V?S1(xd(V.y,0,1)).getUTCDay():w1(xd(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(he+5)%7:V.w+V.U*7-(he+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,S1(V)):w1(V)}}function k(G,Q,de,V){for(var Ee=0,we=Q.length,he=de.length,Z,Se;Ee<we;){if(V>=he)return-1;if(Z=Q.charCodeAt(Ee++),Z===37){if(Z=Q.charAt(Ee++),Se=P[Z in IN?Q.charAt(Ee++):Z],!Se||(V=Se(G,de,V))<0)return-1}else if(Z!=de.charCodeAt(V++))return-1}return V}function T(G,Q,de){var V=u.exec(Q.slice(de));return V?(G.p=d.get(V[0].toLowerCase()),de+V[0].length):-1}function q(G,Q,de){var V=h.exec(Q.slice(de));return V?(G.w=p.get(V[0].toLowerCase()),de+V[0].length):-1}function F(G,Q,de){var V=f.exec(Q.slice(de));return V?(G.w=m.get(V[0].toLowerCase()),de+V[0].length):-1}function j(G,Q,de){var V=b.exec(Q.slice(de));return V?(G.m=S.get(V[0].toLowerCase()),de+V[0].length):-1}function U(G,Q,de){var V=g.exec(Q.slice(de));return V?(G.m=v.get(V[0].toLowerCase()),de+V[0].length):-1}function B(G,Q,de){return k(G,t,Q,de)}function X(G,Q,de){return k(G,r,Q,de)}function K(G,Q,de){return k(G,n,Q,de)}function ee(G){return i[G.getDay()]}function Y(G){return s[G.getDay()]}function z(G){return c[G.getMonth()]}function ne(G){return o[G.getMonth()]}function le(G){return a[+(G.getHours()>=12)]}function A(G){return 1+~~(G.getMonth()/3)}function D(G){return i[G.getUTCDay()]}function L(G){return s[G.getUTCDay()]}function M(G){return c[G.getUTCMonth()]}function R(G){return o[G.getUTCMonth()]}function H(G){return a[+(G.getUTCHours()>=12)]}function J(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var Q=N(G+="",_);return Q.toString=function(){return G},Q},parse:function(G){var Q=I(G+="",!1);return Q.toString=function(){return G},Q},utcFormat:function(G){var Q=N(G+="",E);return Q.toString=function(){return G},Q},utcParse:function(G){var Q=I(G+="",!0);return Q.toString=function(){return G},Q}}}var IN={"-":"",_:" ",0:"0"},ea=/^\s*\d+/,jJ=/^%/,kJ=/[\\^$*+?|[\]().{}]/g;function cr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(t)+a:a)}function CJ(e){return e.replace(kJ,"\\$&")}function vd(e){return new RegExp("^(?:"+e.map(CJ).join("|")+")","i")}function yd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function EJ(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function TJ(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function PJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function OJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function FJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function LN(e,t,r){var n=ea.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function DN(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function IJ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function LJ(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function DJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function MN(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function MJ(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function RN(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function RJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function BJ(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function UJ(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function zJ(e,t,r){var n=ea.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function $J(e,t,r){var n=jJ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function WJ(e,t,r){var n=ea.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function HJ(e,t,r){var n=ea.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function BN(e,t){return cr(e.getDate(),t,2)}function qJ(e,t){return cr(e.getHours(),t,2)}function GJ(e,t){return cr(e.getHours()%12||12,t,2)}function VJ(e,t){return cr(1+zf.count(ao(e),e),t,3)}function RE(e,t){return cr(e.getMilliseconds(),t,3)}function YJ(e,t){return RE(e,t)+"000"}function KJ(e,t){return cr(e.getMonth()+1,t,2)}function XJ(e,t){return cr(e.getMinutes(),t,2)}function JJ(e,t){return cr(e.getSeconds(),t,2)}function ZJ(e){var t=e.getDay();return t===0?7:t}function QJ(e,t){return cr(Ip.count(ao(e)-1,e),t,2)}function BE(e){var t=e.getDay();return t>=4||t===0?gu(e):gu.ceil(e)}function eZ(e,t){return e=BE(e),cr(gu.count(ao(e),e)+(ao(e).getDay()===4),t,2)}function tZ(e){return e.getDay()}function rZ(e,t){return cr(Fm.count(ao(e)-1,e),t,2)}function nZ(e,t){return cr(e.getFullYear()%100,t,2)}function aZ(e,t){return e=BE(e),cr(e.getFullYear()%100,t,2)}function sZ(e,t){return cr(e.getFullYear()%1e4,t,4)}function iZ(e,t){var r=e.getDay();return e=r>=4||r===0?gu(e):gu.ceil(e),cr(e.getFullYear()%1e4,t,4)}function oZ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+cr(t/60|0,"0",2)+cr(t%60,"0",2)}function UN(e,t){return cr(e.getUTCDate(),t,2)}function lZ(e,t){return cr(e.getUTCHours(),t,2)}function cZ(e,t){return cr(e.getUTCHours()%12||12,t,2)}function uZ(e,t){return cr(1+Fp.count(so(e),e),t,3)}function UE(e,t){return cr(e.getUTCMilliseconds(),t,3)}function dZ(e,t){return UE(e,t)+"000"}function fZ(e,t){return cr(e.getUTCMonth()+1,t,2)}function hZ(e,t){return cr(e.getUTCMinutes(),t,2)}function mZ(e,t){return cr(e.getUTCSeconds(),t,2)}function pZ(e){var t=e.getUTCDay();return t===0?7:t}function gZ(e,t){return cr(Lp.count(so(e)-1,e),t,2)}function zE(e){var t=e.getUTCDay();return t>=4||t===0?xu(e):xu.ceil(e)}function xZ(e,t){return e=zE(e),cr(xu.count(so(e),e)+(so(e).getUTCDay()===4),t,2)}function vZ(e){return e.getUTCDay()}function yZ(e,t){return cr(Im.count(so(e)-1,e),t,2)}function bZ(e,t){return cr(e.getUTCFullYear()%100,t,2)}function wZ(e,t){return e=zE(e),cr(e.getUTCFullYear()%100,t,2)}function SZ(e,t){return cr(e.getUTCFullYear()%1e4,t,4)}function _Z(e,t){var r=e.getUTCDay();return e=r>=4||r===0?xu(e):xu.ceil(e),cr(e.getUTCFullYear()%1e4,t,4)}function NZ(){return"+0000"}function zN(){return"%"}function $N(e){return+e}function WN(e){return Math.floor(+e/1e3)}var Mc,$E,WE;AZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function AZ(e){return Mc=AJ(e),$E=Mc.format,Mc.parse,WE=Mc.utcFormat,Mc.utcParse,Mc}function jZ(e){return new Date(e)}function kZ(e){return e instanceof Date?+e:+new Date(+e)}function _b(e,t,r,n,a,s,i,o,c,u){var d=cb(),f=d.invert,m=d.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),v=u("%I %p"),b=u("%a %d"),S=u("%b %d"),_=u("%B"),E=u("%Y");function P(N){return(c(N)<N?h:o(N)<N?p:i(N)<N?g:s(N)<N?v:n(N)<N?a(N)<N?b:S:r(N)<N?_:E)(N)}return d.invert=function(N){return new Date(f(N))},d.domain=function(N){return arguments.length?m(Array.from(N,kZ)):m().map(jZ)},d.ticks=function(N){var I=m();return e(I[0],I[I.length-1],N??10)},d.tickFormat=function(N,I){return I==null?P:u(I)},d.nice=function(N){var I=m();return(!N||typeof N.range!="function")&&(N=t(I[0],I[I.length-1],N??10)),N?m(EE(I,N)):d},d.copy=function(){return Uf(d,_b(e,t,r,n,a,s,i,o,c,u))},d}function CZ(){return Ds.apply(_b(_J,NJ,ao,wb,Ip,zf,yb,xb,El,$E).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function EZ(){return Ds.apply(_b(wJ,SJ,so,Sb,Lp,Fp,bb,vb,El,WE).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Dp(){var e=0,t=1,r,n,a,s,i=Fa,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(a===0?.5:(f=(s(f)-r)*a,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(i=f,u):i};function d(f){return function(m){var h,p;return arguments.length?([h,p]=m,i=f(h,p),u):[i(0),i(1)]}}return u.range=d(Au),u.rangeRound=d(lb),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function ll(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function HE(){var e=ol(Dp()(Fa));return e.copy=function(){return ll(e,HE())},go.apply(e,arguments)}function qE(){var e=fb(Dp()).domain([1,10]);return e.copy=function(){return ll(e,qE()).base(e.base())},go.apply(e,arguments)}function GE(){var e=hb(Dp());return e.copy=function(){return ll(e,GE()).constant(e.constant())},go.apply(e,arguments)}function Nb(){var e=mb(Dp());return e.copy=function(){return ll(e,Nb()).exponent(e.exponent())},go.apply(e,arguments)}function TZ(){return Nb.apply(null,arguments).exponent(.5)}function VE(){var e=[],t=Fa;function r(n){if(n!=null&&!isNaN(n=+n))return t((Rf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(qo),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>pX(e,s/n))},r.copy=function(){return VE(t).domain(e)},go.apply(r,arguments)}function Mp(){var e=0,t=.5,r=1,n=1,a,s,i,o,c,u=Fa,d,f=!1,m;function h(g){return isNaN(g=+g)?m:(g=.5+((g=+d(g))-s)*(n*g<n*s?o:c),u(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=d(e=+e),s=d(t=+t),i=d(r=+r),o=a===s?0:.5/(s-a),c=s===i?0:.5/(i-s),n=s<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u};function p(g){return function(v){var b,S,_;return arguments.length?([b,S,_]=v,u=$X(g,[b,S,_]),h):[u(0),u(.5),u(1)]}}return h.range=p(Au),h.rangeRound=p(lb),h.unknown=function(g){return arguments.length?(m=g,h):m},function(g){return d=g,a=g(e),s=g(t),i=g(r),o=a===s?0:.5/(s-a),c=s===i?0:.5/(i-s),n=s<a?-1:1,h}}function YE(){var e=ol(Mp()(Fa));return e.copy=function(){return ll(e,YE())},go.apply(e,arguments)}function KE(){var e=fb(Mp()).domain([.1,1,10]);return e.copy=function(){return ll(e,KE()).base(e.base())},go.apply(e,arguments)}function XE(){var e=hb(Mp());return e.copy=function(){return ll(e,XE()).constant(e.constant())},go.apply(e,arguments)}function Ab(){var e=mb(Mp());return e.copy=function(){return ll(e,Ab()).exponent(e.exponent())},go.apply(e,arguments)}function PZ(){return Ab.apply(null,arguments).exponent(.5)}const Cd=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:sb,scaleDiverging:YE,scaleDivergingLog:KE,scaleDivergingPow:Ab,scaleDivergingSqrt:PZ,scaleDivergingSymlog:XE,scaleIdentity:CE,scaleImplicit:Qv,scaleLinear:kE,scaleLog:TE,scaleOrdinal:ab,scalePoint:vX,scalePow:pb,scaleQuantile:FE,scaleQuantize:IE,scaleRadial:OE,scaleSequential:HE,scaleSequentialLog:qE,scaleSequentialPow:Nb,scaleSequentialQuantile:VE,scaleSequentialSqrt:TZ,scaleSequentialSymlog:GE,scaleSqrt:dJ,scaleSymlog:PE,scaleThreshold:LE,scaleTime:CZ,scaleUtc:EZ,tickFormat:jE},Symbol.toStringTag,{value:"Module"}));var xo=e=>e.chartData,Rp=Ue([xo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),jb=(e,t,r,n)=>n?Rp(e):xo(e),OZ=(e,t,r)=>r?Rp(e):xo(e);function Xo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Vr(t)&&Vr(r))return!0}return!1}function HN(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function JE(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,s;if(Vr(r))a=r;else if(typeof r=="function")return;if(Vr(n))s=n;else if(typeof n=="function")return;var i=[a,s];if(Xo(i))return i}}function FZ(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Xo(n))return HN(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,s]=e,i,o;if(a==="auto")t!=null&&(i=Math.min(...t));else if(bt(a))i=a;else if(typeof a=="function")try{t!=null&&(i=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&t4.test(a)){var c=t4.exec(a);if(c==null||c[1]==null||t==null)i=void 0;else{var u=+c[1];i=t[0]-u}}else i=t==null?void 0:t[0];if(s==="auto")t!=null&&(o=Math.max(...t));else if(bt(s))o=s;else if(typeof s=="function")try{t!=null&&(o=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&r4.test(s)){var d=r4.exec(s);if(d==null||d[1]==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t==null?void 0:t[1];var m=[i,o];if(Xo(m))return t==null?m:HN(m,t,r)}}}var ju=1e9,IZ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Cb,zr=!0,Is="[DecimalError] ",Ml=Is+"Invalid argument: ",kb=Is+"Exponent out of range: ",ku=Math.floor,wl=Math.pow,LZ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,is,Yn=1e7,Or=7,ZE=9007199254740991,Lm=ku(ZE/Or),vt={};vt.absoluteValue=vt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};vt.comparedTo=vt.cmp=function(e){var t,r,n,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};vt.decimalPlaces=vt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Or;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};vt.dividedBy=vt.div=function(e){return Zi(this,new this.constructor(e))};vt.dividedToIntegerBy=vt.idiv=function(e){var t=this,r=t.constructor;return kr(Zi(t,new r(e),0,1),r.precision)};vt.equals=vt.eq=function(e){return!this.cmp(e)};vt.exponent=function(){return jn(this)};vt.greaterThan=vt.gt=function(e){return this.cmp(e)>0};vt.greaterThanOrEqualTo=vt.gte=function(e){return this.cmp(e)>=0};vt.isInteger=vt.isint=function(){return this.e>this.d.length-2};vt.isNegative=vt.isneg=function(){return this.s<0};vt.isPositive=vt.ispos=function(){return this.s>0};vt.isZero=function(){return this.s===0};vt.lessThan=vt.lt=function(e){return this.cmp(e)<0};vt.lessThanOrEqualTo=vt.lte=function(e){return this.cmp(e)<1};vt.logarithm=vt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,s=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(is))throw Error(Is+"NaN");if(r.s<1)throw Error(Is+(r.s?"NaN":"-Infinity"));return r.eq(is)?new n(0):(zr=!1,t=Zi(mf(r,s),mf(e,s),s),zr=!0,kr(t,a))};vt.minus=vt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?tT(t,e):QE(t,(e.s=-e.s,e))};vt.modulo=vt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Is+"NaN");return r.s?(zr=!1,t=Zi(r,e,0,1).times(e),zr=!0,r.minus(t)):kr(new n(r),a)};vt.naturalExponential=vt.exp=function(){return eT(this)};vt.naturalLogarithm=vt.ln=function(){return mf(this)};vt.negated=vt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};vt.plus=vt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?QE(t,e):tT(t,(e.s=-e.s,e))};vt.precision=vt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ml+e);if(t=jn(a)+1,n=a.d.length-1,r=n*Or+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};vt.squareRoot=vt.sqrt=function(){var e,t,r,n,a,s,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Is+"NaN")}for(e=jn(o),zr=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=wi(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ku((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=i=r+3;;)if(s=n,n=s.plus(Zi(o,s,i+2)).times(.5),wi(s.d).slice(0,i)===(t=wi(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(kr(s,r+1,0),s.times(s).eq(o)){n=s;break}}else if(t!="9999")break;i+=4}return zr=!0,kr(n,r)};vt.times=vt.mul=function(e){var t,r,n,a,s,i,o,c,u,d=this,f=d.constructor,m=d.d,h=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=m.length,u=h.length,c<u&&(s=m,m=h,h=s,i=c,c=u,u=i),s=[],i=c+u,n=i;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=s[a]+h[n]*m[a-n-1]+t,s[a--]=o%Yn|0,t=o/Yn|0;s[a]=(s[a]+t)%Yn|0}for(;!s[--i];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,zr?kr(e,f.precision):e};vt.toDecimalPlaces=vt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ki(e,0,ju),t===void 0?t=n.rounding:ki(t,0,8),kr(r,e+jn(r)+1,t))};vt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Jl(n,!0):(ki(e,0,ju),t===void 0?t=a.rounding:ki(t,0,8),n=kr(new a(n),e+1,t),r=Jl(n,!0,e+1)),r};vt.toFixed=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?Jl(a):(ki(e,0,ju),t===void 0?t=s.rounding:ki(t,0,8),n=kr(new s(a),e+jn(a)+1,t),r=Jl(n.abs(),!1,e+jn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};vt.toInteger=vt.toint=function(){var e=this,t=e.constructor;return kr(new t(e),jn(e)+1,t.rounding)};vt.toNumber=function(){return+this};vt.toPower=vt.pow=function(e){var t,r,n,a,s,i,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(is);if(o=new c(o),!o.s){if(e.s<1)throw Error(Is+"Infinity");return o}if(o.eq(is))return o;if(n=c.precision,e.eq(is))return kr(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,s=o.s,i){if((r=d<0?-d:d)<=ZE){for(a=new c(is),t=Math.ceil(n/Or+4),zr=!1;r%2&&(a=a.times(o),GN(a.d,t)),r=ku(r/2),r!==0;)o=o.times(o),GN(o.d,t);return zr=!0,e.s<0?new c(is).div(a):kr(a,n)}}else if(s<0)throw Error(Is+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,zr=!1,a=e.times(mf(o,n+u)),zr=!0,a=eT(a),a.s=s,a};vt.toPrecision=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?(r=jn(a),n=Jl(a,r<=s.toExpNeg||r>=s.toExpPos)):(ki(e,1,ju),t===void 0?t=s.rounding:ki(t,0,8),a=kr(new s(a),e,t),r=jn(a),n=Jl(a,e<=r||r<=s.toExpNeg,e)),n};vt.toSignificantDigits=vt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ki(e,1,ju),t===void 0?t=n.rounding:ki(t,0,8)),kr(new n(r),e,t)};vt.toString=vt.valueOf=vt.val=vt.toJSON=vt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=jn(e),r=e.constructor;return Jl(e,t<=r.toExpNeg||t>=r.toExpPos)};function QE(e,t){var r,n,a,s,i,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),zr?kr(t,f):t;if(c=e.d,u=t.d,i=e.e,a=t.e,c=c.slice(),s=i-a,s){for(s<0?(n=c,s=-s,o=u.length):(n=u,a=i,o=c.length),i=Math.ceil(f/Or),o=i>o?i+1:o+1,s>o&&(s=o,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(o=c.length,s=u.length,o-s<0&&(s=o,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Yn|0,c[s]%=Yn;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,zr?kr(t,f):t}function ki(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ml+e)}function wi(e){var t,r,n,a=e.length-1,s="",i=e[0];if(a>0){for(s+=i,t=1;t<a;t++)n=e[t]+"",r=Or-n.length,r&&(s+=Ro(r)),s+=n;i=e[t],n=i+"",r=Or-n.length,r&&(s+=Ro(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return s+i}var Zi=(function(){function e(n,a){var s,i=0,o=n.length;for(n=n.slice();o--;)s=n[o]*a+i,n[o]=s%Yn|0,i=s/Yn|0;return i&&n.unshift(i),n}function t(n,a,s,i){var o,c;if(s!=i)c=s>i?1:-1;else for(o=c=0;o<s;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,s){for(var i=0;s--;)n[s]-=i,i=n[s]<a[s]?1:0,n[s]=i*Yn+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,i){var o,c,u,d,f,m,h,p,g,v,b,S,_,E,P,N,I,k,T=n.constructor,q=n.s==a.s?1:-1,F=n.d,j=a.d;if(!n.s)return new T(n);if(!a.s)throw Error(Is+"Division by zero");for(c=n.e-a.e,I=j.length,P=F.length,h=new T(q),p=h.d=[],u=0;j[u]==(F[u]||0);)++u;if(j[u]>(F[u]||0)&&--c,s==null?S=s=T.precision:i?S=s+(jn(n)-jn(a))+1:S=s,S<0)return new T(0);if(S=S/Or+2|0,u=0,I==1)for(d=0,j=j[0],S++;(u<P||d)&&S--;u++)_=d*Yn+(F[u]||0),p[u]=_/j|0,d=_%j|0;else{for(d=Yn/(j[0]+1)|0,d>1&&(j=e(j,d),F=e(F,d),I=j.length,P=F.length),E=I,g=F.slice(0,I),v=g.length;v<I;)g[v++]=0;k=j.slice(),k.unshift(0),N=j[0],j[1]>=Yn/2&&++N;do d=0,o=t(j,g,I,v),o<0?(b=g[0],I!=v&&(b=b*Yn+(g[1]||0)),d=b/N|0,d>1?(d>=Yn&&(d=Yn-1),f=e(j,d),m=f.length,v=g.length,o=t(f,g,m,v),o==1&&(d--,r(f,I<m?k:j,m))):(d==0&&(o=d=1),f=j.slice()),m=f.length,m<v&&f.unshift(0),r(g,f,v),o==-1&&(v=g.length,o=t(j,g,I,v),o<1&&(d++,r(g,I<v?k:j,v))),v=g.length):o===0&&(d++,g=[0]),p[u++]=d,o&&g[0]?g[v++]=F[E]||0:(g=[F[E]],v=1);while((E++<P||g[0]!==void 0)&&S--)}return p[0]||p.shift(),h.e=c,kr(h,i?s+jn(h)+1:s)}})();function eT(e,t){var r,n,a,s,i,o,c=0,u=0,d=e.constructor,f=d.precision;if(jn(e)>16)throw Error(kb+jn(e));if(!e.s)return new d(is);for(zr=!1,o=f,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(wl(2,u))/Math.LN10*2+5|0,o+=n,r=a=s=new d(is),d.precision=o;;){if(a=kr(a.times(e),o),r=r.times(++c),i=s.plus(Zi(a,r,o)),wi(i.d).slice(0,o)===wi(s.d).slice(0,o)){for(;u--;)s=kr(s.times(s),o);return d.precision=f,t==null?(zr=!0,kr(s,f)):s}s=i}}function jn(e){for(var t=e.e*Or,r=e.d[0];r>=10;r/=10)t++;return t}function _1(e,t,r){if(t>e.LN10.sd())throw zr=!0,r&&(e.precision=r),Error(Is+"LN10 precision limit exceeded");return kr(new e(e.LN10),t)}function Ro(e){for(var t="";e--;)t+="0";return t}function mf(e,t){var r,n,a,s,i,o,c,u,d,f=1,m=10,h=e,p=h.d,g=h.constructor,v=g.precision;if(h.s<1)throw Error(Is+(h.s?"NaN":"-Infinity"));if(h.eq(is))return new g(0);if(t==null?(zr=!1,u=v):u=t,h.eq(10))return t==null&&(zr=!0),_1(g,u);if(u+=m,g.precision=u,r=wi(p),n=r.charAt(0),s=jn(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=wi(h.d),n=r.charAt(0),f++;s=jn(h),n>1?(h=new g("0."+r),s++):h=new g(n+"."+r.slice(1))}else return c=_1(g,u+2,v).times(s+""),h=mf(new g(n+"."+r.slice(1)),u-m).plus(c),g.precision=v,t==null?(zr=!0,kr(h,v)):h;for(o=i=h=Zi(h.minus(is),h.plus(is),u),d=kr(h.times(h),u),a=3;;){if(i=kr(i.times(d),u),c=o.plus(Zi(i,new g(a),u)),wi(c.d).slice(0,u)===wi(o.d).slice(0,u))return o=o.times(2),s!==0&&(o=o.plus(_1(g,u+2,v).times(s+""))),o=Zi(o,new g(f),u),g.precision=v,t==null?(zr=!0,kr(o,v)):o;o=c,a+=2}}function qN(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ku(r/Or),e.d=[],n=(r+1)%Or,r<0&&(n+=Or),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Or;n<a;)e.d.push(+t.slice(n,n+=Or));t=t.slice(n),n=Or-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),zr&&(e.e>Lm||e.e<-Lm))throw Error(kb+r)}else e.s=0,e.e=0,e.d=[0];return e}function kr(e,t,r){var n,a,s,i,o,c,u,d,f=e.d;for(i=1,s=f[0];s>=10;s/=10)i++;if(n=t-i,n<0)n+=Or,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Or),s=f.length,d>=s)return e;for(u=s=f[d],i=1;s>=10;s/=10)i++;n%=Or,a=n-Or+i}if(r!==void 0&&(s=wl(10,i-a-1),o=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/wl(10,i-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=jn(e),f.length=1,t=t-s-1,f[0]=wl(10,(Or-t%Or)%Or),e.e=ku(-t/Or)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=wl(10,Or-n),f[d]=a>0?(u/wl(10,i-a)%wl(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Yn&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=Yn)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(zr&&(e.e>Lm||e.e<-Lm))throw Error(kb+jn(e));return e}function tT(e,t){var r,n,a,s,i,o,c,u,d,f,m=e.constructor,h=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),zr?kr(t,h):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,o=f.length):(r=f,n=u,o=c.length),a=Math.max(Math.ceil(h/Or),o)+2,i>a&&(i=a,r.length=1),r.reverse(),a=i;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=f.length,d=a<o,d&&(o=a),a=0;a<o;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}i=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,a=f.length-o;a>0;--a)c[o++]=0;for(a=f.length;a>i;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Yn-1;--c[s],c[a]+=Yn}c[a]-=f[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,zr?kr(t,h):t):new m(0)}function Jl(e,t,r){var n,a=jn(e),s=wi(e.d),i=s.length;return t?(r&&(n=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+Ro(n):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+Ro(-a-1)+s,r&&(n=r-i)>0&&(s+=Ro(n))):a>=i?(s+=Ro(a+1-i),r&&(n=r-a-1)>0&&(s=s+"."+Ro(n))):((n=a+1)<i&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-i)>0&&(a+1===i&&(s+="."),s+=Ro(n))),e.s<0?"-"+s:s}function GN(e,t){if(e.length>t)return e.length=t,!0}function rT(e){var t,r,n;function a(s){var i=this;if(!(i instanceof a))return new a(s);if(i.constructor=a,s instanceof a){i.s=s.s,i.e=s.e,i.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ml+s);if(s>0)i.s=1;else if(s<0)s=-s,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(s===~~s&&s<1e7){i.e=0,i.d=[s];return}return qN(i,s.toString())}else if(typeof s!="string")throw Error(Ml+s);if(s.charCodeAt(0)===45?(s=s.slice(1),i.s=-1):i.s=1,LZ.test(s))qN(i,s);else throw Error(Ml+s)}if(a.prototype=vt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=rT,a.config=a.set=DZ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function DZ(e){if(!e||typeof e!="object")throw Error(Is+"Object expected");var t,r,n,a=["precision",1,ju,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ku(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ml+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ml+r+": "+n);return this}var Cb=rT(IZ);is=new Cb(1);const xr=Cb;var MZ=e=>e,nT={},aT=e=>e===nT,VN=e=>function t(){return arguments.length===0||arguments.length===1&&aT(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},sT=(e,t)=>e===1?t:VN(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(i=>i!==nT).length;return s>=e?t(...n):sT(e-s,VN(function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];var u=n.map(d=>aT(d)?o.shift():d);return t(...u,...o)}))}),RZ=e=>sT(e.length,e),ny=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},BZ=RZ((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),UZ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return MZ;var a=r.reverse(),s=a[0],i=a.slice(1);return function(){return i.reduce((o,c)=>c(o),s(...arguments))}};function iT(e){var t;return e===0?t=1:t=Math.floor(new xr(e).abs().log(10).toNumber())+1,t}function oT(e,t,r){for(var n=new xr(e),a=0,s=[];n.lt(t)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var lT=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},cT=(e,t,r)=>{if(e.lte(0))return new xr(0);var n=iT(e.toNumber()),a=new xr(10).pow(n),s=e.div(a),i=n!==1?.05:.1,o=new xr(Math.ceil(s.div(i).toNumber())).add(r).mul(i),c=o.mul(a);return t?new xr(c.toNumber()):new xr(Math.ceil(c.toNumber()))},zZ=(e,t,r)=>{var n=new xr(1),a=new xr(e);if(!a.isint()&&r){var s=Math.abs(e);s<1?(n=new xr(10).pow(iT(e)-1),a=new xr(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new xr(Math.floor(e)))}else e===0?a=new xr(Math.floor((t-1)/2)):r||(a=new xr(Math.floor(e)));var i=Math.floor((t-1)/2),o=UZ(BZ(c=>a.add(new xr(c-i).mul(n)).toNumber()),ny);return o(0,t)},uT=function(t,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new xr(0),tickMin:new xr(0),tickMax:new xr(0)};var i=cT(new xr(r).sub(t).div(n-1),a,s),o;t<=0&&r>=0?o=new xr(0):(o=new xr(t).add(r).div(2),o=o.sub(new xr(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new xr(r).sub(o).div(i).toNumber()),d=c+u+1;return d>n?uT(t,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:i,tickMin:o.sub(new xr(c).mul(i)),tickMax:o.add(new xr(u).mul(i))})},$Z=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),[o,c]=lT([r,n]);if(o===-1/0||c===1/0){var u=c===1/0?[o,...ny(0,a-1).map(()=>1/0)]:[...ny(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(o===c)return zZ(o,a,s);var{step:d,tickMin:f,tickMax:m}=uT(o,c,i,s,0),h=oT(f,m.add(new xr(.1).mul(d)),d);return r>n?h.reverse():h},WZ=function(t,r){var[n,a]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=lT([n,a]);if(i===-1/0||o===1/0)return[n,a];if(i===o)return[i];var c=Math.max(r,2),u=cT(new xr(o).sub(i).div(c-1),s,0),d=[...oT(new xr(i),new xr(o),u),o];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},dT=e=>e.rootProps.maxBarSize,HZ=e=>e.rootProps.barGap,fT=e=>e.rootProps.barCategoryGap,qZ=e=>e.rootProps.barSize,$f=e=>e.rootProps.stackOffset,hT=e=>e.rootProps.reverseStackOrder,Eb=e=>e.options.chartName,Tb=e=>e.rootProps.syncId,mT=e=>e.rootProps.syncMethod,Pb=e=>e.options.eventEmitter,An={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Wi={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ts={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Bp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},GZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Wi.angleAxisId,includeHidden:!1,name:void 0,reversed:Wi.reversed,scale:Wi.scale,tick:Wi.tick,tickCount:void 0,ticks:void 0,type:Wi.type,unit:void 0},VZ={allowDataOverflow:ts.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ts.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ts.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ts.scale,tick:ts.tick,tickCount:ts.tickCount,ticks:void 0,type:ts.type,unit:void 0},YZ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Wi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Wi.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Wi.scale,tick:Wi.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},KZ={allowDataOverflow:ts.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ts.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ts.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ts.scale,tick:ts.tick,tickCount:ts.tickCount,ticks:void 0,type:"category",unit:void 0},Ob=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?YZ:GZ,Fb=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?KZ:VZ,Up=e=>e.polarOptions,Ib=Ue([mo,po,Dn],hE),pT=Ue([Up,Ib],(e,t)=>{if(e!=null)return _a(e.innerRadius,t,0)}),gT=Ue([Up,Ib],(e,t)=>{if(e!=null)return _a(e.outerRadius,t,t*.8)}),XZ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},xT=Ue([Up],XZ);Ue([Ob,xT],Bp);var vT=Ue([Ib,pT,gT],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Ue([Fb,vT],Bp);var yT=Ue([er,Up,pT,gT,mo,po],(e,t,r,n,a,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:c,endAngle:u}=t;return{cx:_a(i,a,a/2),cy:_a(o,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Wr=(e,t)=>t,Wf=(e,t,r)=>r;function Lb(e){return e==null?void 0:e.id}function bT(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:s}=r,i=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=Lb(o);u.forEach((f,m)=>{var h=s==null||a?m:String(Nr(f,s,null)),p=Nr(f,o.dataKey,0),g;i.has(h)?g=i.get(h):g={},Object.assign(g,{[d]:p}),i.set(h,g)})}}),Array.from(i.values())}function zp(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var $p=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Wp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function JZ(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Rn=e=>{var t=er(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Cu=e=>e.tooltip.settings.axisId;function YN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YN(Object(r),!0).forEach(function(n){ZZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZZ(e,t,r){return(t=QZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QZ(e){var t=eQ(e,"string");return typeof t=="symbol"?t:t+""}function eQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ay=[0,"auto"],qn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},wT=(e,t)=>e.cartesianAxis.xAxis[t],vo=(e,t)=>{var r=wT(e,t);return r??qn},Gn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ay,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:If},ST=(e,t)=>e.cartesianAxis.yAxis[t],yo=(e,t)=>{var r=ST(e,t);return r??Gn},tQ={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Db=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??tQ},Yr=(e,t,r)=>{switch(t){case"xAxis":return vo(e,r);case"yAxis":return yo(e,r);case"zAxis":return Db(e,r);case"angleAxis":return Ob(e,r);case"radiusAxis":return Fb(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rQ=(e,t,r)=>{switch(t){case"xAxis":return vo(e,r);case"yAxis":return yo(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Hf=(e,t,r)=>{switch(t){case"xAxis":return vo(e,r);case"yAxis":return yo(e,r);case"angleAxis":return Ob(e,r);case"radiusAxis":return Fb(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},_T=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Mb(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Hp=e=>e.graphicalItems.cartesianItems,nQ=Ue([Wr,Wf],Mb),Rb=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),qf=Ue([Hp,Yr,nQ],Rb,{memoizeOptions:{resultEqualityCheck:Wp}}),NT=Ue([qf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(zp)),AT=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),aQ=Ue([qf],AT),Bb=e=>e.map(t=>t.data).filter(Boolean).flat(1),sQ=Ue([qf],Bb,{memoizeOptions:{resultEqualityCheck:Wp}}),Ub=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},zb=Ue([sQ,jb],Ub),$b=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Nr(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Nr(a,n)}))):e.map(n=>({value:n})),qp=Ue([zb,Yr,qf],$b);function jT(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Th(e){if(Ai(e)||e instanceof Date){var t=Number(e);if(Vr(t))return t}}function KN(e){if(Array.isArray(e)){var t=[Th(e[0]),Th(e[1])];return Xo(t)?t:void 0}var r=Th(e);if(r!=null)return[r,r]}function io(e){return e.map(Th).filter(JH)}function iQ(e,t,r){return!r||typeof t!="number"||ri(t)?[]:r.length?io(r.flatMap(n=>{var a=Nr(e,n.dataKey),s,i;if(Array.isArray(a)?[s,i]=a:s=i=a,!(!Vr(s)||!Vr(i)))return[t-s,t+i]})):[]}var Bn=e=>{var t=Rn(e),r=Cu(e);return Hf(e,t,r)},Gf=Ue([Bn],e=>e==null?void 0:e.dataKey),oQ=Ue([NT,jb,Bn],bT),kT=(e,t,r,n)=>{var a={},s=t.reduce((i,o)=>{if(o.stackId==null)return i;var c=i[o.stackId];return c==null&&(c=[]),c.push(o),i[o.stackId]=c,i},a);return Object.fromEntries(Object.entries(s).map(i=>{var[o,c]=i,u=n?[...c].reverse():c,d=u.map(Lb);return[o,{stackedData:AV(e,d,r),graphicalItems:u}]}))},sy=Ue([oQ,NT,$f,hT],kT),CT=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var i=TV(e,a,s);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},lQ=Ue([Yr],e=>e.allowDataOverflow),Wb=e=>{var t;if(e==null||!("domain"in e))return ay;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=io(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:ay},Hb=Ue([Yr],Wb),qb=Ue([Hb,lQ],JE),cQ=Ue([sy,xo,Wr,qb],CT,{memoizeOptions:{resultEqualityCheck:$p}}),Gp=e=>e.errorBars,uQ=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>jT(r,n)),Mm=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),i=Math.min(...s),o=Math.max(...s);return[i,o]}},Gb=(e,t,r,n,a)=>{var s,i;if(r.length>0&&e.forEach(o=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>jT(a,b)),m=Nr(o,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),h=iQ(o,m,f);if(h.length>=2){var p=Math.min(...h),g=Math.max(...h);(s==null||p<s)&&(s=p),(i==null||g>i)&&(i=g)}var v=KN(m);v!=null&&(s=s==null?v[0]:Math.min(s,v[0]),i=i==null?v[1]:Math.max(i,v[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(o=>{var c=KN(Nr(o,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),i=i==null?c[1]:Math.max(i,c[1]))}),Vr(s)&&Vr(i))return[s,i]},dQ=Ue([zb,Yr,aQ,Gp,Wr],Gb,{memoizeOptions:{resultEqualityCheck:$p}});function fQ(e){var{value:t}=e;if(Ai(t)||t instanceof Date)return t}var hQ=(e,t,r)=>{var n=e.map(fQ).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&VC(n))?xE(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},ET=e=>e.referenceElements.dots,Eu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),mQ=Ue([ET,Wr,Wf],Eu),TT=e=>e.referenceElements.areas,pQ=Ue([TT,Wr,Wf],Eu),PT=e=>e.referenceElements.lines,gQ=Ue([PT,Wr,Wf],Eu),OT=(e,t)=>{if(e!=null){var r=io(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},xQ=Ue(mQ,Wr,OT),FT=(e,t)=>{if(e!=null){var r=io(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},vQ=Ue([pQ,Wr],FT);function yQ(e){var t;if(e.x!=null)return io([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:io(r)}function bQ(e){var t;if(e.y!=null)return io([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:io(r)}var IT=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?yQ(n):bQ(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},wQ=Ue([gQ,Wr],IT),SQ=Ue(xQ,wQ,vQ,(e,t,r)=>Mm(e,r,t)),Vb=(e,t,r,n,a,s,i,o)=>{if(r!=null)return r;var c=i==="vertical"&&o==="xAxis"||i==="horizontal"&&o==="yAxis",u=c?Mm(n,s,a):Mm(s,a);return FZ(t,u,e.allowDataOverflow)},_Q=Ue([Yr,Hb,qb,cQ,dQ,SQ,er,Wr],Vb,{memoizeOptions:{resultEqualityCheck:$p}}),NQ=[0,1],Yb=(e,t,r,n,a,s,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:c}=e,u=il(t,s);if(u&&o==null){var d;return xE(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?hQ(n,e,u):a==="expand"?NQ:i}},Kb=Ue([Yr,er,zb,qp,$f,Wr,_Q],Yb),LT=(e,t,r,n,a)=>{if(e!=null){var{scale:s,type:i}=e;if(s==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof s=="string"){var o="scale".concat(Ef(s));return o in Cd?o:"point"}}},Tu=Ue([Yr,er,_T,Eb,Wr],LT);function AQ(e){if(e!=null){if(e in Cd)return Cd[e]();var t="scale".concat(Ef(e));if(t in Cd)return Cd[t]()}}function Xb(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=AQ(t);if(a!=null){var s=a.domain(r).range(n);return bV(s),s}}}var Jb=(e,t,r)=>{var n=Wb(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Xo(e))return $Z(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Xo(e))return WZ(e,t.tickCount,t.allowDecimals)}},Zb=Ue([Kb,Hf,Tu],Jb),Qb=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Xo(t)&&Array.isArray(r)&&r.length>0){var a=t[0],s=r[0],i=t[1],o=r[r.length-1];return[Math.min(a,s),Math.max(i,o)]}return t},jQ=Ue([Yr,Kb,Zb,Wr],Qb),kQ=Ue(qp,Yr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(io(e.map(f=>f.value))).sort((f,m)=>f-m),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var i=s-a;if(i===0)return 1/0;for(var o=0;o<n.length-1;o++){var c=n[o],u=n[o+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/i}}),DT=Ue(kQ,er,fT,Dn,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!Vr(e))return 0;var s=t==="vertical"?n.height:n.width;if(a==="gap")return e*s/2;if(a==="no-gap"){var i=_a(r,e*s),o=e*s/2;return o-i-(o-i)/s*i}return 0}),CQ=(e,t,r)=>{var n=vo(e,t);return n==null||typeof n.padding!="string"?0:DT(e,"xAxis",t,r,n.padding)},EQ=(e,t,r)=>{var n=yo(e,t);return n==null||typeof n.padding!="string"?0:DT(e,"yAxis",t,r,n.padding)},TQ=Ue(vo,CQ,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),PQ=Ue(yo,EQ,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),OQ=Ue([Dn,TQ,Ap,Np,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),FQ=Ue([Dn,er,PQ,Ap,Np,(e,t,r)=>r],(e,t,r,n,a,s)=>{var{padding:i}=a;return s?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Vf=(e,t,r,n)=>{var a;switch(t){case"xAxis":return OQ(e,r,n);case"yAxis":return FQ(e,r,n);case"zAxis":return(a=Db(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return xT(e);case"radiusAxis":return vT(e,r);default:return}},MT=Ue([Yr,Vf],Bp),Vp=Ue([Yr,Tu,jQ,MT],Xb);Ue([qf,Gp,Wr],uQ);function RT(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Yp=(e,t)=>t,Kp=(e,t,r)=>r,IQ=Ue(Sp,Yp,Kp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(RT)),LQ=Ue(_p,Yp,Kp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(RT)),BT=(e,t)=>({width:e.width,height:t.height}),DQ=(e,t)=>{var r=typeof t.width=="number"?t.width:If;return{width:r,height:e.height}},UT=Ue(Dn,vo,BT),MQ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},RQ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},BQ=Ue(po,Dn,IQ,Yp,Kp,(e,t,r,n,a)=>{var s={},i;return r.forEach(o=>{var c=BT(t,o);i==null&&(i=MQ(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;s[o.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),s}),UQ=Ue(mo,Dn,LQ,Yp,Kp,(e,t,r,n,a)=>{var s={},i;return r.forEach(o=>{var c=DQ(t,o);i==null&&(i=RQ(t,n,e));var u=n==="left"&&!a||n==="right"&&a;s[o.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),s}),zQ=(e,t)=>{var r=vo(e,t);if(r!=null)return BQ(e,r.orientation,r.mirror)},$Q=Ue([Dn,vo,zQ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),WQ=(e,t)=>{var r=yo(e,t);if(r!=null)return UQ(e,r.orientation,r.mirror)},HQ=Ue([Dn,yo,WQ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),zT=Ue(Dn,yo,(e,t)=>{var r=typeof t.width=="number"?t.width:If;return{width:r,height:e.height}}),XN=(e,t,r)=>{switch(t){case"xAxis":return UT(e,r).width;case"yAxis":return zT(e,r).height;default:return}},$T=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:i}=r,o=il(e,n),c=t.map(u=>u.value);if(i&&o&&s==="category"&&a&&VC(c))return c}},ew=Ue([er,qp,Yr,Wr],$T),WT=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,i=il(e,n);if(i&&(a==="number"||s!=="auto"))return t.map(o=>o.value)}},tw=Ue([er,qp,Hf,Wr],WT),JN=Ue([er,rQ,Tu,Vp,ew,tw,Vf,Zb,Wr],(e,t,r,n,a,s,i,o,c)=>{if(t!=null){var u=il(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}}),qQ=(e,t,r,n,a,s,i,o,c)=>{if(!(t==null||n==null)){var u=il(e,c),{type:d,ticks:f,tickCount:m}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,p=d==="category"&&n.bandwidth?n.bandwidth()/h:0;p=c==="angleAxis"&&s!=null&&s.length>=2?Zn(s[0]-s[1])*2*p:p;var g=f||a;if(g){var v=g.map((b,S)=>{var _=i?i.indexOf(b):b;return{index:S,coordinate:n(_)+p,value:b,offset:p}});return v.filter(b=>Vr(b.coordinate))}return u&&o?o.map((b,S)=>({coordinate:n(b)+p,value:b,index:S,offset:p})).filter(b=>Vr(b.coordinate)):n.ticks?n.ticks(m).map(b=>({coordinate:n(b)+p,value:b,offset:p})):n.domain().map((b,S)=>({coordinate:n(b)+p,value:i?i[b]:b,index:S,offset:p}))}},HT=Ue([er,Hf,Tu,Vp,Zb,Vf,ew,tw,Wr],qQ),GQ=(e,t,r,n,a,s,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=il(e,i),{tickCount:c}=t,u=0;return u=i==="angleAxis"&&(n==null?void 0:n.length)>=2?Zn(n[0]-n[1])*2*u:u,o&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Jo=Ue([er,Hf,Vp,Vf,ew,tw,Wr],GQ),Zo=Ue(Yr,Vp,(e,t)=>{if(!(e==null||t==null))return Dm(Dm({},e),{},{scale:t})}),VQ=Ue([Yr,Tu,Kb,MT],Xb);Ue((e,t,r)=>Db(e,r),VQ,(e,t)=>{if(!(e==null||t==null))return Dm(Dm({},e),{},{scale:t})});var YQ=Ue([er,Sp,_p],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),qT=e=>e.options.defaultTooltipEventType,GT=e=>e.options.validateTooltipEventTypes;function VT(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function rw(e,t){var r=qT(e),n=GT(e);return VT(t,r,n)}function KQ(e){return St(t=>rw(t,e))}var YT=(e,t)=>{var r,n=Number(t);if(!(ri(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},XQ=e=>e.tooltip.settings,Uo={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},JQ={itemInteraction:{click:Uo,hover:Uo},axisInteraction:{click:Uo,hover:Uo},keyboardInteraction:Uo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},KT=Va({name:"tooltip",initialState:JQ,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Br()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ti(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:Br()},removeTooltipEntrySettings:{reducer(e,t){var r=ti(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Br()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:ZQ,replaceTooltipEntrySettings:QQ,removeTooltipEntrySettings:eee,setTooltipSettingsState:tee,setActiveMouseOverItemIndex:XT,mouseLeaveItem:ree,mouseLeaveChart:JT,setActiveClickItemIndex:nee,setMouseOverAxisIndex:ZT,setMouseClickAxisIndex:aee,setSyncInteraction:iy,setKeyboardInteraction:oy}=KT.actions,see=KT.reducer;function ZN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZN(Object(r),!0).forEach(function(n){iee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iee(e,t,r){return(t=oee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oee(e){var t=lee(e,"string");return typeof t=="symbol"?t:t+""}function lee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cee(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function uee(e){return e.index!=null}var QT=(e,t,r,n)=>{if(t==null)return Uo;var a=cee(e,t,r);if(a==null)return Uo;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(uee(a)){if(s)return vh(vh({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return vh(vh({},Uo),{},{coordinate:a.coordinate})};function dee(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function fee(e,t){var r=dee(e),n=t[0],a=t[1];if(r===void 0)return!1;var s=Math.min(n,a),i=Math.max(n,a);return r>=s&&r<=i}function hee(e,t,r){if(r==null||t==null)return!0;var n=Nr(e,t);return n==null||!Xo(r)?!0:fee(n,r)}var nw=(e,t,r,n)=>{var a=e==null?void 0:e.index;if(a==null)return null;var s=Number(a);if(!Vr(s))return a;var i=0,o=1/0;t.length>0&&(o=t.length-1);var c=Math.max(i,Math.min(s,o)),u=t[c];return u==null||hee(u,r,n)?String(c):null},eP=(e,t,r,n,a,s,i,o)=>{if(!(s==null||o==null)){var c=i[0],u=c==null?void 0:o(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},tP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.graphicalItemId)===a})},Yf=e=>e.options.tooltipPayloadSearcher,Pu=e=>e.tooltip;function QN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QN(Object(r),!0).forEach(function(n){mee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mee(e,t,r){return(t=pee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pee(e){var t=gee(e,"string");return typeof t=="symbol"?t:t+""}function gee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xee(e,t){return e??t}var rP=(e,t,r,n,a,s,i)=>{if(!(t==null||s==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((m,h)=>{var p,{dataDefinedOnItem:g,settings:v}=h,b=xee(g,o),S=Array.isArray(b)?U6(b,u,d):b,_=(p=v==null?void 0:v.dataKey)!==null&&p!==void 0?p:n,E=v==null?void 0:v.nameKey,P;if(n&&Array.isArray(S)&&!Array.isArray(S[0])&&i==="axis"?P=YC(S,n,a):P=s(S,t,c,E),Array.isArray(P))P.forEach(I=>{var k=e3(e3({},v),{},{name:I.name,unit:I.unit,color:void 0,fill:void 0});m.push(n4({tooltipEntrySettings:k,dataKey:I.dataKey,payload:I.payload,value:Nr(I.payload,I.dataKey),name:I.name}))});else{var N;m.push(n4({tooltipEntrySettings:v,dataKey:_,payload:P,value:Nr(P,_),name:(N=Nr(P,E))!==null&&N!==void 0?N:v==null?void 0:v.name}))}return m},f)}},aw=Ue([Bn,er,_T,Eb,Rn],LT),vee=Ue([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),yee=Ue([Rn,Cu],Mb),Ou=Ue([vee,Bn,yee],Rb,{memoizeOptions:{resultEqualityCheck:Wp}}),bee=Ue([Ou],e=>e.filter(zp)),wee=Ue([Ou],Bb,{memoizeOptions:{resultEqualityCheck:Wp}}),Fu=Ue([wee,xo],Ub),See=Ue([bee,xo,Bn],bT),sw=Ue([Fu,Bn,Ou],$b),nP=Ue([Bn],Wb),_ee=Ue([Bn],e=>e.allowDataOverflow),aP=Ue([nP,_ee],JE),Nee=Ue([Ou],e=>e.filter(zp)),Aee=Ue([See,Nee,$f,hT],kT),jee=Ue([Aee,xo,Rn,aP],CT),kee=Ue([Ou],AT),Cee=Ue([Fu,Bn,kee,Gp,Rn],Gb,{memoizeOptions:{resultEqualityCheck:$p}}),Eee=Ue([ET,Rn,Cu],Eu),Tee=Ue([Eee,Rn],OT),Pee=Ue([TT,Rn,Cu],Eu),Oee=Ue([Pee,Rn],FT),Fee=Ue([PT,Rn,Cu],Eu),Iee=Ue([Fee,Rn],IT),Lee=Ue([Tee,Iee,Oee],Mm),Dee=Ue([Bn,nP,aP,jee,Cee,Lee,er,Rn],Vb),Kf=Ue([Bn,er,Fu,sw,$f,Rn,Dee],Yb),Mee=Ue([Kf,Bn,aw],Jb),Ree=Ue([Bn,Kf,Mee,Rn],Qb),sP=e=>{var t=Rn(e),r=Cu(e),n=!1;return Vf(e,t,r,n)},iP=Ue([Bn,sP],Bp),oP=Ue([Bn,aw,Ree,iP],Xb),Bee=Ue([er,sw,Bn,Rn],$T),Uee=Ue([er,sw,Bn,Rn],WT),zee=(e,t,r,n,a,s,i,o)=>{if(t){var{type:c}=t,u=il(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Zn(a[0]-a[1])*2*f:f,u&&i?i.map((m,h)=>({coordinate:n(m)+f,value:m,index:h,offset:f})):n.domain().map((m,h)=>({coordinate:n(m)+f,value:s?s[m]:m,index:h,offset:f}))}}},bo=Ue([er,Bn,aw,oP,sP,Bee,Uee,Rn],zee),iw=Ue([qT,GT,XQ],(e,t,r)=>VT(r.shared,e,t)),lP=e=>e.tooltip.settings.trigger,ow=e=>e.tooltip.settings.defaultIndex,Xf=Ue([Pu,iw,lP,ow],QT),Qo=Ue([Xf,Fu,Gf,Kf],nw),cP=Ue([bo,Qo],YT),lw=Ue([Xf],e=>{if(e)return e.dataKey}),$ee=Ue([Xf],e=>{if(e)return e.graphicalItemId}),uP=Ue([Pu,iw,lP,ow],tP),Wee=Ue([mo,po,er,Dn,bo,ow,uP,Yf],eP),Hee=Ue([Xf,Wee],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),qee=Ue([Xf],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Gee=Ue([uP,Qo,xo,Gf,cP,Yf,iw],rP),Vee=Ue([Gee],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function t3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t3(Object(r),!0).forEach(function(n){Yee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yee(e,t,r){return(t=Kee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kee(e){var t=Xee(e,"string");return typeof t=="symbol"?t:t+""}function Xee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jee=()=>St(Bn),Zee=()=>{var e=Jee(),t=St(bo),r=St(oP);return fu(!e||!r?void 0:r3(r3({},e),{},{scale:r}),t)};function n3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n3(Object(r),!0).forEach(function(n){Qee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qee(e,t,r){return(t=ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ete(e){var t=tte(e,"string");return typeof t=="symbol"?t:t+""}function tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rte=(e,t,r,n)=>{var a=t.find(s=>s&&s.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},nte=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="centric"){var s=a.coordinate,{radius:i}=n;return Rc(Rc(Rc({},n),Nn(n.cx,n.cy,i,s)),{},{angle:s,radius:i})}var o=a.coordinate,{angle:c}=n;return Rc(Rc(Rc({},n),Nn(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function ate(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var dP=(e,t,r,n,a)=>{var s,i=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(i<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var o=0;o<i;o++){var c,u,d,f,m,h=o>0?(c=r[o-1])===null||c===void 0?void 0:c.coordinate:(u=r[i-1])===null||u===void 0?void 0:u.coordinate,p=(d=r[o])===null||d===void 0?void 0:d.coordinate,g=o>=i-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(m=r[o+1])===null||m===void 0?void 0:m.coordinate,v=void 0;if(!(h==null||p==null||g==null))if(Zn(p-h)!==Zn(g-p)){var b=[];if(Zn(g-p)===Zn(a[1]-a[0])){v=g;var S=p+a[1]-a[0];b[0]=Math.min(S,(S+h)/2),b[1]=Math.max(S,(S+h)/2)}else{v=h;var _=g+a[1]-a[0];b[0]=Math.min(p,(_+p)/2),b[1]=Math.max(p,(_+p)/2)}var E=[Math.min(p,(v+p)/2),Math.max(p,(v+p)/2)];if(e>E[0]&&e<=E[1]||e>=b[0]&&e<=b[1]){var P;return(P=r[o])===null||P===void 0?void 0:P.index}}else{var N=Math.min(h,g),I=Math.max(h,g);if(e>(N+p)/2&&e<=(I+p)/2){var k;return(k=r[o])===null||k===void 0?void 0:k.index}}}else if(t)for(var T=0;T<i;T++){var q=t[T];if(q!=null){var F=t[T+1],j=t[T-1];if(T===0&&F!=null&&e<=(q.coordinate+F.coordinate)/2||T===i-1&&j!=null&&e>(q.coordinate+j.coordinate)/2||T>0&&T<i-1&&j!=null&&F!=null&&e>(q.coordinate+j.coordinate)/2&&e<=(q.coordinate+F.coordinate)/2)return q.index}}return-1},ste=()=>St(Eb),cw=(e,t)=>t,fP=(e,t,r)=>r,uw=(e,t,r,n)=>n,ite=Ue(bo,e=>fp(e,t=>t.coordinate)),dw=Ue([Pu,cw,fP,uw],QT),fw=Ue([dw,Fu,Gf,Kf],nw),ote=(e,t,r)=>{if(t!=null){var n=Pu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},hP=Ue([Pu,cw,fP,uw],tP),Rm=Ue([mo,po,er,Dn,bo,uw,hP,Yf],eP),lte=Ue([dw,Rm],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),mP=Ue([bo,fw],YT),cte=Ue([hP,fw,xo,Gf,mP,Yf,cw],rP),ute=Ue([dw,fw],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),dte=(e,t,r,n,a,s,i)=>{if(!(!e||!r||!n||!a)&&ate(e,i)){var o=PV(e,t),c=dP(o,s,a,r,n),u=rte(t,a,c,e);return{activeIndex:String(c),activeCoordinate:u}}},fte=(e,t,r,n,a,s,i)=>{if(!(!e||!n||!a||!s||!r)){var o=YK(e,r);if(o){var c=OV(o,t),u=dP(c,i,s,n,a),d=nte(t,s,u,o);return{activeIndex:String(u),activeCoordinate:d}}}},hte=(e,t,r,n,a,s,i,o)=>{if(!(!e||!t||!n||!a||!s))return t==="horizontal"||t==="vertical"?dte(e,t,n,a,s,i,o):fte(e,t,r,n,a,s,i)},mte=Ue(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),pte=Ue(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(An)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:JZ}});function a3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(r),!0).forEach(function(n){gte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gte(e,t,r){return(t=xte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xte(e){var t=vte(e,"string");return typeof t=="symbol"?t:t+""}function vte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yte={},bte={zIndexMap:Object.values(An).reduce((e,t)=>s3(s3({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),yte)},wte=new Set(Object.values(An));function Ste(e){return wte.has(e)}var pP=Va({name:"zIndex",initialState:bte,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Br()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!Ste(r)&&delete e.zIndexMap[r])},prepare:Br()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Br()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:Br()}}}),{registerZIndexPortal:_te,unregisterZIndexPortal:Nte,registerZIndexPortalElement:Ate,unregisterZIndexPortalElement:jte}=pP.actions,kte=pP.reducer;function Ya(e){var{zIndex:t,children:r}=e,n=cY(),a=n&&t!==void 0&&t!==0,s=ja(),i=Pr();y.useLayoutEffect(()=>a?(i(_te({zIndex:t})),()=>{i(Nte({zIndex:t}))}):Tf,[i,t,a]);var o=St(c=>mte(c,t,s));return a?o?zy.createPortal(r,o):null:r}function ly(){return ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ly.apply(null,arguments)}function i3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i3(Object(r),!0).forEach(function(n){Cte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cte(e,t,r){return(t=Ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ete(e){var t=Tte(e,"string");return typeof t=="symbol"?t:t+""}function Tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pte(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return y.isValidElement(t)?y.cloneElement(t,n):y.createElement(r,n)}function Ote(e){var t,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:i,layout:o,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,m=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var p,g,v;if(d==="ScatterChart")p=f,g=lK,v=An.cursorLine;else if(d==="BarChart")p=cK(o,f,s,i),g=fE,v=An.cursorRectangle;else if(o==="radial"&&XC(f)){var{cx:b,cy:S,radius:_,startAngle:E,endAngle:P}=mE(f);p={cx:b,cy:S,startAngle:E,endAngle:P,innerRadius:_,outerRadius:_},g=gE,v=An.cursorLine}else p={points:ZK(o,f,s)},g=rb,v=An.cursorLine;var N=typeof c=="object"&&"className"in c?c.className:void 0,I=yh(yh(yh(yh({stroke:"#ccc",pointerEvents:"none"},s),p),ql(c)),{},{payload:m,payloadIndex:h,className:lr("recharts-tooltip-cursor",N)});return y.createElement(Ya,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:v},y.createElement(Pte,{cursor:c,cursorComp:g,cursorProps:I}))}function Fte(e){var t=Zee(),r=X6(),n=Nu(),a=ste();return t==null||r==null||n==null||a==null?null:y.createElement(Ote,ly({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var gP=y.createContext(null),Ite=()=>y.useContext(gP),N1={exports:{}},o3;function Lte(){return o3||(o3=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,m),p=r?r+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,h=f.length,p=new Array(h);m<h;m++)p[m]=f[m].fn;return p},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,m,h,p){var g=r?r+u:u;if(!this._events[g])return!1;var v=this._events[g],b=arguments.length,S,_;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),b){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,m),!0;case 5:return v.fn.call(v.context,d,f,m,h),!0;case 6:return v.fn.call(v.context,d,f,m,h,p),!0}for(_=1,S=new Array(b-1);_<b;_++)S[_-1]=arguments[_];v.fn.apply(v.context,S)}else{var E=v.length,P;for(_=0;_<E;_++)switch(v[_].once&&this.removeListener(u,v[_].fn,void 0,!0),b){case 1:v[_].fn.call(v[_].context);break;case 2:v[_].fn.call(v[_].context,d);break;case 3:v[_].fn.call(v[_].context,d,f);break;case 4:v[_].fn.call(v[_].context,d,f,m);break;default:if(!S)for(P=1,S=new Array(b-1);P<b;P++)S[P-1]=arguments[P];v[_].fn.apply(v[_].context,S)}}return!0},o.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,m){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return i(this,h),this;var p=this._events[h];if(p.fn)p.fn===d&&(!m||p.once)&&(!f||p.context===f)&&i(this,h);else{for(var g=0,v=[],b=p.length;g<b;g++)(p[g].fn!==d||m&&!p[g].once||f&&p[g].context!==f)&&v.push(p[g]);v.length?this._events[h]=v.length===1?v[0]:v:i(this,h)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(N1)),N1.exports}var Dte=Lte();const Mte=co(Dte);var pf=new Mte,cy="recharts.syncEvent.tooltip",l3="recharts.syncEvent.brush";function hw(e,t){if(t){var r=Number.parseInt(t,10);if(!ri(r))return e==null?void 0:e[r]}}var Rte={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},xP=Va({name:"options",initialState:Rte,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Bte=xP.reducer,{createEventEmitter:Ute}=xP.actions;function zte(e){return e.tooltip.syncInteraction}var $te={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},vP=Va({name:"chartData",initialState:$te,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:c3,setDataStartEndIndexes:Wte,setComputedData:Ude}=vP.actions,Hte=vP.reducer,qte=["x","y"];function u3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u3(Object(r),!0).forEach(function(n){Gte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gte(e,t,r){return(t=Vte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vte(e){var t=Yte(e,"string");return typeof t=="symbol"?t:t+""}function Yte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kte(e,t){if(e==null)return{};var r,n,a=Xte(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Xte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Jte(){var e=St(Tb),t=St(Pb),r=Pr(),n=St(mT),a=St(bo),s=Nu(),i=jp(),o=St(c=>c.rootProps.className);y.useEffect(()=>{if(e==null)return Tf;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var m;if(i&&d!==null&&d!==void 0&&(m=d.payload)!==null&&m!==void 0&&m.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:p,y:g}=h,v=Kte(h,qte),{x:b,y:S,width:_,height:E}=d.payload.sourceViewBox,P=Bc(Bc({},v),{},{x:i.x+(_?(p-b)/_:0)*i.width,y:i.y+(E?(g-S)/E:0)*i.height});r(Bc(Bc({},d),{},{payload:Bc(Bc({},d.payload),{},{coordinate:P})}))}else r(d);return}if(a!=null){var N;if(typeof n=="function"){var I={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},k=n(a,I);N=a[k]}else n==="value"&&(N=a.find(K=>String(K.value)===d.payload.label));var{coordinate:T}=d.payload;if(N==null||d.payload.active===!1||T==null||i==null){r(iy({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:q,y:F}=T,j=Math.min(q,i.x+i.width),U=Math.min(F,i.y+i.height),B={x:s==="horizontal"?N.coordinate:j,y:s==="horizontal"?U:N.coordinate},X=iy({active:d.payload.active,coordinate:B,dataKey:d.payload.dataKey,index:String(N.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(X)}}};return pf.on(cy,c),()=>{pf.off(cy,c)}},[o,r,t,e,n,a,s,i])}function Zte(){var e=St(Tb),t=St(Pb),r=Pr();y.useEffect(()=>{if(e==null)return Tf;var n=(a,s,i)=>{t!==i&&e===a&&r(Wte(s))};return pf.on(l3,n),()=>{pf.off(l3,n)}},[r,t,e])}function Qte(){var e=Pr();y.useEffect(()=>{e(Ute())},[e]),Jte(),Zte()}function ere(e,t,r,n,a,s){var i=St(h=>ote(h,e,t)),o=St(Pb),c=St(Tb),u=St(mT),d=St(zte),f=d==null?void 0:d.active,m=jp();y.useEffect(()=>{if(!f&&c!=null&&o!=null){var h=iy({active:s,coordinate:r,dataKey:i,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:m,graphicalItemId:void 0});pf.emit(cy,c,h,o)}},[f,r,i,a,n,o,c,u,s,m])}function d3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d3(Object(r),!0).forEach(function(n){tre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tre(e,t,r){return(t=rre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rre(e){var t=nre(e,"string");return typeof t=="symbol"?t:t+""}function nre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function are(e){return e.dataKey}function sre(e,t){return y.isValidElement(e)?y.cloneElement(e,t):typeof e=="function"?y.createElement(e,t):y.createElement(zY,t)}var h3=[],ire={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function A1(e){var t,r,n=kn(e,ire),{active:a,allowEscapeViewBox:s,animationDuration:i,animationEasing:o,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:m,position:h,reverseDirection:p,useTranslate3d:g,wrapperStyle:v,cursor:b,shared:S,trigger:_,defaultIndex:E,portal:P,axisId:N}=n,I=Pr(),k=typeof E=="number"?String(E):E;y.useEffect(()=>{I(tee({shared:S,trigger:_,axisId:N,active:a,defaultIndex:k}))},[I,S,_,N,a,k]);var T=jp(),q=oE(),F=KQ(S),{activeIndex:j,isActive:U}=(t=St(H=>ute(H,F,_,k)))!==null&&t!==void 0?t:{},B=St(H=>cte(H,F,_,k)),X=St(H=>mP(H,F,_,k)),K=St(H=>lte(H,F,_,k)),ee=B,Y=Ite(),z=(r=a??U)!==null&&r!==void 0?r:!1,[ne,le]=u6([ee,z]),A=F==="axis"?X:void 0;ere(F,_,K,A,j,z);var D=P??Y;if(D==null||T==null||F==null)return null;var L=ee??h3;z||(L=h3),u&&L.length&&(L=s6(L.filter(H=>H.value!=null&&(H.hide!==!0||n.includeHidden)),m,are));var M=L.length>0,R=y.createElement(YY,{allowEscapeViewBox:s,animationDuration:i,animationEasing:o,isAnimationActive:d,active:z,coordinate:K,hasPayload:M,offset:f,position:h,reverseDirection:p,useTranslate3d:g,viewBox:T,wrapperStyle:v,lastBoundingBox:ne,innerRef:le,hasPortalFromProps:!!P},sre(c,f3(f3({},n),{},{payload:L,label:A,active:z,activeIndex:j,coordinate:K,accessibilityLayer:q})));return y.createElement(y.Fragment,null,zy.createPortal(R,D),z&&y.createElement(Fte,{cursor:b,tooltipEventType:F,coordinate:K,payload:L,index:j}))}var vu=e=>null;vu.displayName="Cell";function ore(e,t,r){return(t=lre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lre(e){var t=cre(e,"string");return typeof t=="symbol"?t:t+""}function cre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class ure{constructor(t){ore(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function m3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m3(Object(r),!0).forEach(function(n){fre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fre(e,t,r){return(t=hre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hre(e){var t=mre(e,"string");return typeof t=="symbol"?t:t+""}function mre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pre={cacheSize:2e3,enableCache:!0},yP=dre({},pre),p3=new ure(yP.cacheSize),gre={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},g3="recharts_measurement_span";function xre(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",s=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(i,"|").concat(o)}var x3=(e,t)=>{try{var r=document.getElementById(g3);r||(r=document.createElement("span"),r.setAttribute("id",g3),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,gre,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Rd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Pp.isSsr)return{width:0,height:0};if(!yP.enableCache)return x3(t,r);var n=xre(t,r),a=p3.get(n);if(a)return a;var s=x3(t,r);return p3.set(n,s),s},bP;function vre(e,t,r){return(t=yre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yre(e){var t=bre(e,"string");return typeof t=="symbol"?t:t+""}function bre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,y3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,wre=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Sre=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_re={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Nre=["cm","mm","pt","pc","in","Q","px"];function Are(e){return Nre.includes(e)}var Kc="NaN";function jre(e,t){return e*_re[t]}class sa{static parse(t){var r,[,n,a]=(r=Sre.exec(t))!==null&&r!==void 0?r:[];return n==null?sa.NaN:new sa(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ri(t)&&(this.unit=""),r!==""&&!wre.test(r)&&(this.num=NaN,this.unit=""),Are(r)&&(this.num=jre(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new sa(NaN,""):new sa(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new sa(NaN,""):new sa(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new sa(NaN,""):new sa(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new sa(NaN,""):new sa(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ri(this.num)}}bP=sa;vre(sa,"NaN",new bP(NaN,""));function wP(e){if(e==null||e.includes(Kc))return Kc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,s]=(r=v3.exec(t))!==null&&r!==void 0?r:[],i=sa.parse(n??""),o=sa.parse(s??""),c=a==="*"?i.multiply(o):i.divide(o);if(c.isNaN())return Kc;t=t.replace(v3,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,m]=(u=y3.exec(t))!==null&&u!==void 0?u:[],h=sa.parse(d??""),p=sa.parse(m??""),g=f==="+"?h.add(p):h.subtract(p);if(g.isNaN())return Kc;t=t.replace(y3,g.toString())}return t}var b3=/\(([^()]*)\)/;function kre(e){for(var t=e,r;(r=b3.exec(t))!=null;){var[,n]=r;t=t.replace(b3,wP(n))}return t}function Cre(e){var t=e.replace(/\s+/g,"");return t=kre(t),t=wP(t),t}function Ere(e){try{return Cre(e)}catch{return Kc}}function j1(e){var t=Ere(e.slice(5,-1));return t===Kc?"":t}var Tre=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Pre=["dx","dy","angle","className","breakAll"];function uy(){return uy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uy.apply(null,arguments)}function w3(e,t){if(e==null)return{};var r,n,a=Ore(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ore(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SP=/[ \f\n\r\t\v\u2028\u2029]+/,_P=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];$r(t)||(r?a=t.toString().split(""):a=t.toString().split(SP));var s=a.map(o=>({word:o,width:Rd(o,n).width})),i=r?0:Rd(" ",n).width;return{wordsWithComputedWidth:s,spaceWidth:i}}catch{return null}};function Fre(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var NP=(e,t,r,n)=>e.reduce((a,s)=>{var{word:i,width:o}=s,c=a[a.length-1];if(c&&o!=null&&(t==null||n||c.width+o+r<Number(t)))c.words.push(i),c.width+=o+r;else{var u={words:[i],width:o};a.push(u)}return a},[]),AP=e=>e.reduce((t,r)=>t.width>r.width?t:r),Ire="…",S3=(e,t,r,n,a,s,i,o)=>{var c=e.slice(0,t),u=_P({breakAll:r,style:n,children:c+Ire});if(!u)return[!1,[]];var d=NP(u.wordsWithComputedWidth,s,i,o),f=d.length>a||AP(d).width>Number(s);return[f,d]},Lre=(e,t,r,n,a)=>{var{maxLines:s,children:i,style:o,breakAll:c}=e,u=bt(s),d=String(i),f=NP(t,n,r,a);if(!u||a)return f;var m=f.length>s||AP(f).width>Number(n);if(!m)return f;for(var h=0,p=d.length-1,g=0,v;h<=p&&g<=d.length-1;){var b=Math.floor((h+p)/2),S=b-1,[_,E]=S3(d,S,c,o,s,n,r,a),[P]=S3(d,b,c,o,s,n,r,a);if(!_&&!P&&(h=b+1),_&&P&&(p=b-1),!_&&P){v=E;break}g++}return v||f},_3=e=>{var t=$r(e)?[]:e.toString().split(SP);return[{words:t,width:void 0}]},Dre=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:i}=e;if((t||r)&&!Pp.isSsr){var o,c,u=_P({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return _3(n);return Lre({breakAll:s,children:n,maxLines:i,style:a},o,c,t,!!r)}return _3(n)},jP="#808080",Mre={angle:0,breakAll:!1,capHeight:"0.71em",fill:jP,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Xp=y.forwardRef((e,t)=>{var r=kn(e,Mre),{x:n,y:a,lineHeight:s,capHeight:i,fill:o,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=w3(r,Tre),m=y.useMemo(()=>Dre({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:p,angle:g,className:v,breakAll:b}=f,S=w3(f,Pre);if(!Ai(n)||!Ai(a)||m.length===0)return null;var _=Number(n)+(bt(h)?h:0),E=Number(a)+(bt(p)?p:0);if(!Vr(_)||!Vr(E))return null;var P;switch(d){case"start":P=j1("calc(".concat(i,")"));break;case"middle":P=j1("calc(".concat((m.length-1)/2," * -").concat(s," + (").concat(i," / 2))"));break;default:P=j1("calc(".concat(m.length-1," * -").concat(s,")"));break}var N=[];if(c){var I=m[0].width,{width:k}=f;N.push("scale(".concat(bt(k)&&bt(I)?k/I:1,")"))}return g&&N.push("rotate(".concat(g,", ").concat(_,", ").concat(E,")")),N.length&&(S.transform=N.join(" ")),y.createElement("text",uy({},La(S),{ref:t,x:_,y:E,className:lr("recharts-text",v),textAnchor:u,fill:o.includes("url")?jP:o}),m.map((T,q)=>{var F=T.words.join(b?"":" ");return y.createElement("tspan",{x:_,dy:q===0?P:s,key:"".concat(F,"-").concat(q)},F)}))});Xp.displayName="Text";var Rre=["labelRef"],Bre=["content"];function N3(e,t){if(e==null)return{};var r,n,a=Ure(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ure(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A3(Object(r),!0).forEach(function(n){zre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zre(e,t,r){return(t=$re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $re(e){var t=Wre(e,"string");return typeof t=="symbol"?t:t+""}function Wre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hi(){return Hi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hi.apply(null,arguments)}var kP=y.createContext(null),Hre=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:s,height:i,children:o}=e,c=y.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:s,height:i}),[t,r,n,a,s,i]);return y.createElement(kP.Provider,{value:c},o)},CP=()=>{var e=y.useContext(kP),t=jp();return e||K6(t)},qre=y.createContext(null),Gre=()=>{var e=y.useContext(qre),t=St(yT);return e||t},Vre=e=>{var{value:t,formatter:r}=e,n=$r(e.children)?t:e.children;return typeof r=="function"?r(n):n},mw=e=>e!=null&&typeof e=="function",Yre=(e,t)=>{var r=Zn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Kre=(e,t,r,n,a)=>{var{offset:s,className:i}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:m,clockWise:h}=a,p=(u+d)/2,g=Yre(f,m),v=g>=0?1:-1,b,S;switch(t){case"insideStart":b=f+v*s,S=h;break;case"insideEnd":b=m-v*s,S=!h;break;case"end":b=m+v*s,S=h;break;default:throw new Error("Unsupported position ".concat(t))}S=g<=0?S:!S;var _=Nn(o,c,p,b),E=Nn(o,c,p,b+(S?1:-1)*359),P="M".concat(_.x,",").concat(_.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(S?0:1,`,
    `).concat(E.x,",").concat(E.y),N=$r(e.id)?tf("recharts-radial-line-"):e.id;return y.createElement("text",Hi({},n,{dominantBaseline:"central",className:lr("recharts-radial-bar-label",i)}),y.createElement("defs",null,y.createElement("path",{id:N,d:P})),y.createElement("textPath",{xlinkHref:"#".concat(N)},r))},Xre=(e,t,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:i,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=Nn(n,a,i+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(s+i)/2,{x:h,y:p}=Nn(n,a,m,u);return{x:h,y:p,textAnchor:"middle",verticalAnchor:"middle"}},dy=e=>"cx"in e&&bt(e.cx),Jre=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,s;r!=null&&!dy(r)&&(s=r);var{x:i,y:o,upperWidth:c,lowerWidth:u,height:d}=t,f=i,m=i+(c-u)/2,h=(f+m)/2,p=(c+u)/2,g=f+c/2,v=d>=0?1:-1,b=v*n,S=v>0?"end":"start",_=v>0?"start":"end",E=c>=0?1:-1,P=E*n,N=E>0?"end":"start",I=E>0?"start":"end";if(a==="top"){var k={x:f+c/2,y:o-b,textAnchor:"middle",verticalAnchor:S};return un(un({},k),s?{height:Math.max(o-s.y,0),width:c}:{})}if(a==="bottom"){var T={x:m+u/2,y:o+d+b,textAnchor:"middle",verticalAnchor:_};return un(un({},T),s?{height:Math.max(s.y+s.height-(o+d),0),width:u}:{})}if(a==="left"){var q={x:h-P,y:o+d/2,textAnchor:N,verticalAnchor:"middle"};return un(un({},q),s?{width:Math.max(q.x-s.x,0),height:d}:{})}if(a==="right"){var F={x:h+p+P,y:o+d/2,textAnchor:I,verticalAnchor:"middle"};return un(un({},F),s?{width:Math.max(s.x+s.width-F.x,0),height:d}:{})}var j=s?{width:p,height:d}:{};return a==="insideLeft"?un({x:h+P,y:o+d/2,textAnchor:I,verticalAnchor:"middle"},j):a==="insideRight"?un({x:h+p-P,y:o+d/2,textAnchor:N,verticalAnchor:"middle"},j):a==="insideTop"?un({x:f+c/2,y:o+b,textAnchor:"middle",verticalAnchor:_},j):a==="insideBottom"?un({x:m+u/2,y:o+d-b,textAnchor:"middle",verticalAnchor:S},j):a==="insideTopLeft"?un({x:f+P,y:o+b,textAnchor:I,verticalAnchor:_},j):a==="insideTopRight"?un({x:f+c-P,y:o+b,textAnchor:N,verticalAnchor:_},j):a==="insideBottomLeft"?un({x:m+P,y:o+d-b,textAnchor:I,verticalAnchor:S},j):a==="insideBottomRight"?un({x:m+u-P,y:o+d-b,textAnchor:N,verticalAnchor:S},j):a&&typeof a=="object"&&(bt(a.x)||to(a.x))&&(bt(a.y)||to(a.y))?un({x:i+_a(a.x,p),y:o+_a(a.y,d),textAnchor:"end",verticalAnchor:"end"},j):un({x:g,y:o+d/2,textAnchor:"middle",verticalAnchor:"middle"},j)},Zre={angle:0,offset:5,zIndex:An.label,position:"middle",textBreakAll:!1};function Bo(e){var t=kn(e,Zre),{viewBox:r,position:n,value:a,children:s,content:i,className:o="",textBreakAll:c,labelRef:u}=t,d=Gre(),f=CP(),m=n==="center"?f:d??f,h,p,g;if(r==null?h=m:dy(r)?h=r:h=K6(r),!h||$r(a)&&$r(s)&&!y.isValidElement(i)&&typeof i!="function")return null;var v=un(un({},t),{},{viewBox:h});if(y.isValidElement(i)){var{labelRef:b}=v,S=N3(v,Rre);return y.cloneElement(i,S)}if(typeof i=="function"){var{content:_}=v,E=N3(v,Bre);if(p=y.createElement(i,E),y.isValidElement(p))return p}else p=Vre(t);var P=La(t);if(dy(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return Kre(t,n,p,P,h);g=Xre(h,t.offset,t.position)}else g=Jre(t,h);return y.createElement(Ya,{zIndex:t.zIndex},y.createElement(Xp,Hi({ref:u,className:lr("recharts-label",o)},P,g,{textAnchor:Fre(P.textAnchor)?P.textAnchor:g.textAnchor,breakAll:c}),p))}Bo.displayName="Label";var Qre=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?y.createElement(Bo,Hi({key:"label-implicit"},n)):Ai(e)?y.createElement(Bo,Hi({key:"label-implicit",value:e},n)):y.isValidElement(e)?e.type===Bo?y.cloneElement(e,un({key:"label-implicit"},n)):y.createElement(Bo,Hi({key:"label-implicit",content:e},n)):mw(e)?y.createElement(Bo,Hi({key:"label-implicit",content:e},n)):e&&typeof e=="object"?y.createElement(Bo,Hi({},e,{key:"label-implicit"},n)):null};function ene(e){var{label:t,labelRef:r}=e,n=CP();return Qre(t,n,r)||null}var k1={},C1={},j3;function tne(){return j3||(j3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(C1)),C1}var E1={},k3;function rne(){return k3||(k3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(E1)),E1}var C3;function nne(){return C3||(C3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tne(),r=rne(),n=z2();function a(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=a})(k1)),k1}var T1,E3;function ane(){return E3||(E3=1,T1=nne().last),T1}var sne=ane();const ine=co(sne);var one=["valueAccessor"],lne=["dataKey","clockWise","id","textBreakAll","zIndex"];function Bm(){return Bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bm.apply(null,arguments)}function T3(e,t){if(e==null)return{};var r,n,a=cne(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function cne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var une=e=>Array.isArray(e.value)?ine(e.value):e.value,EP=y.createContext(void 0),TP=EP.Provider,PP=y.createContext(void 0),dne=PP.Provider;function fne(){return y.useContext(EP)}function hne(){return y.useContext(PP)}function Ph(e){var{valueAccessor:t=une}=e,r=T3(e,one),{dataKey:n,clockWise:a,id:s,textBreakAll:i,zIndex:o}=r,c=T3(r,lne),u=fne(),d=hne(),f=u||d;return!f||!f.length?null:y.createElement(Ya,{zIndex:o??An.label},y.createElement(Qn,{className:"recharts-label-list"},f.map((m,h)=>{var p,g=$r(n)?t(m,h):Nr(m&&m.payload,n),v=$r(s)?{}:{id:"".concat(s,"-").concat(h)};return y.createElement(Bo,Bm({key:"label-".concat(h)},La(m),c,v,{fill:(p=r.fill)!==null&&p!==void 0?p:m.fill,parentViewBox:m.parentViewBox,value:g,textBreakAll:i,viewBox:m.viewBox,index:h,zIndex:0}))})))}Ph.displayName="LabelList";function pw(e){var{label:t}=e;return t?t===!0?y.createElement(Ph,{key:"labelList-implicit"}):y.isValidElement(t)||mw(t)?y.createElement(Ph,{key:"labelList-implicit",content:t}):typeof t=="object"?y.createElement(Ph,Bm({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function fy(){return fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fy.apply(null,arguments)}var OP=e=>{var{cx:t,cy:r,r:n,className:a}=e,s=lr("recharts-dot",a);return bt(t)&&bt(r)&&bt(n)?y.createElement("circle",fy({},ds(e),U2(e),{className:s,cx:t,cy:r,r:n})):null},FP=e=>e.graphicalItems.polarItems,mne=Ue([Wr,Wf],Mb),Jp=Ue([FP,Yr,mne],Rb),pne=Ue([Jp],Bb),Zp=Ue([pne,Rp],Ub),gne=Ue([Zp,Yr,Jp],$b);Ue([Zp,Yr,Jp],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var s,i=Nr(n,(s=t.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:i,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Nr(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var P3=()=>{},xne=Ue([Zp,Yr,Jp,Gp,Wr],Gb),vne=Ue([Yr,Hb,qb,P3,xne,P3,er,Wr],Vb),IP=Ue([Yr,er,Zp,gne,$f,Wr,vne],Yb),yne=Ue([IP,Yr,Tu],Jb);Ue([Yr,IP,yne,Wr],Qb);var bne={radiusAxis:{},angleAxis:{}},LP=Va({name:"polarAxis",initialState:bne,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:zde,removeRadiusAxis:$de,addAngleAxis:Wde,removeAngleAxis:Hde}=LP.actions,wne=LP.reducer;function O3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O3(Object(r),!0).forEach(function(n){Sne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sne(e,t,r){return(t=_ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ne(e){var t=Nne(e,"string");return typeof t=="symbol"?t:t+""}function Nne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ane=(e,t)=>t,gw=Ue([FP,Ane],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),jne=[],xw=(e,t,r)=>(r==null?void 0:r.length)===0?jne:r,DP=Ue([Rp,gw,xw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>F3(F3({},t.presentationProps),s.props))),a!=null)return a}}),kne=Ue([DP,gw,xw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var s,i=Nr(n,t.nameKey,t.name),o;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:_u(i,t.dataKey),color:o,payload:n,type:t.legendType}})}),Cne=Ue([DP,gw,xw,Dn],(e,t,r,n)=>{if(!(t==null||e==null))return Tae({offset:n,pieSettings:t,displayedData:e,cells:r})}),P1={exports:{}},Sr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I3;function Ene(){if(I3)return Sr;I3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),h=Symbol.for("react.client.reference");function p(g){if(typeof g=="object"&&g!==null){var v=g.$$typeof;switch(v){case e:switch(g=g.type,g){case r:case a:case n:case c:case u:case m:return g;default:switch(g=g&&g.$$typeof,g){case i:case o:case f:case d:return g;case s:return g;default:return v}}case t:return v}}}return Sr.ContextConsumer=s,Sr.ContextProvider=i,Sr.Element=e,Sr.ForwardRef=o,Sr.Fragment=r,Sr.Lazy=f,Sr.Memo=d,Sr.Portal=t,Sr.Profiler=a,Sr.StrictMode=n,Sr.Suspense=c,Sr.SuspenseList=u,Sr.isContextConsumer=function(g){return p(g)===s},Sr.isContextProvider=function(g){return p(g)===i},Sr.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},Sr.isForwardRef=function(g){return p(g)===o},Sr.isFragment=function(g){return p(g)===r},Sr.isLazy=function(g){return p(g)===f},Sr.isMemo=function(g){return p(g)===d},Sr.isPortal=function(g){return p(g)===t},Sr.isProfiler=function(g){return p(g)===a},Sr.isStrictMode=function(g){return p(g)===n},Sr.isSuspense=function(g){return p(g)===c},Sr.isSuspenseList=function(g){return p(g)===u},Sr.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===c||g===u||typeof g=="object"&&g!==null&&(g.$$typeof===f||g.$$typeof===d||g.$$typeof===i||g.$$typeof===s||g.$$typeof===o||g.$$typeof===h||g.getModuleId!==void 0)},Sr.typeOf=p,Sr}var L3;function Tne(){return L3||(L3=1,P1.exports=Ene()),P1.exports}var Pne=Tne(),D3=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",M3=null,O1=null,MP=e=>{if(e===M3&&Array.isArray(O1))return O1;var t=[];return y.Children.forEach(e,r=>{$r(r)||(Pne.isFragment(r)?t=t.concat(MP(r.props.children)):t.push(r))}),O1=t,M3=e,t};function vw(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>D3(a)):n=[D3(t)],MP(e).forEach(a=>{var s=Vl(a,"type.displayName")||Vl(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var RP=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,F1={},R3;function One(){return R3||(R3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(F1)),F1}var I1,B3;function Fne(){return B3||(B3=1,I1=One().isPlainObject),I1}var Ine=Fne();const Lne=co(Ine);var U3,z3,$3,W3,H3;function q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function G3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q3(Object(r),!0).forEach(function(n){Dne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dne(e,t,r){return(t=Mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mne(e){var t=Rne(e,"string");return typeof t=="symbol"?t:t+""}function Rne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Um(){return Um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Um.apply(null,arguments)}function bd(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var V3=(e,t,r,n,a)=>{var s=r-n,i;return i=Qr(U3||(U3=bd(["M ",",",""])),e,t),i+=Qr(z3||(z3=bd(["L ",",",""])),e+r,t),i+=Qr($3||($3=bd(["L ",",",""])),e+r-s/2,t+a),i+=Qr(W3||(W3=bd(["L ",",",""])),e+r-s/2-n,t+a),i+=Qr(H3||(H3=bd(["L ",","," Z"])),e,t),i},Bne={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Une=e=>{var t=kn(e,Bne),{x:r,y:n,upperWidth:a,lowerWidth:s,height:i,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,m=y.useRef(null),[h,p]=y.useState(-1),g=y.useRef(a),v=y.useRef(s),b=y.useRef(i),S=y.useRef(r),_=y.useRef(n),E=Mf(e,"trapezoid-");if(y.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var B=m.current.getTotalLength();B&&p(B)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||i!==+i||a===0&&s===0||i===0)return null;var P=lr("recharts-trapezoid",o);if(!f)return y.createElement("g",null,y.createElement("path",Um({},La(t),{className:P,d:V3(r,n,a,s,i)})));var N=g.current,I=v.current,k=b.current,T=S.current,q=_.current,F="0px ".concat(h===-1?1:h,"px"),j="".concat(h,"px 0px"),U=lE(["strokeDasharray"],u,c);return y.createElement(Df,{animationId:E,key:E,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},B=>{var X=Ur(N,a,B),K=Ur(I,s,B),ee=Ur(k,i,B),Y=Ur(T,r,B),z=Ur(q,n,B);m.current&&(g.current=X,v.current=K,b.current=ee,S.current=Y,_.current=z);var ne=B>0?{transition:U,strokeDasharray:j}:{strokeDasharray:F};return y.createElement("path",Um({},La(t),{className:P,d:V3(Y,z,X,K,ee),ref:m,style:G3(G3({},ne),t.style)}))})},zne=["option","shapeType","activeClassName"];function $ne(e,t){if(e==null)return{};var r,n,a=Wne(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Wne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y3(Object(r),!0).forEach(function(n){Hne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hne(e,t,r){return(t=qne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qne(e){var t=Gne(e,"string");return typeof t=="symbol"?t:t+""}function Gne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vne(e,t){return zm(zm({},t),e)}function Yne(e,t){return e==="symbols"}function K3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return y.createElement(fE,r);case"trapezoid":return y.createElement(Une,r);case"sector":return y.createElement(gE,r);case"symbols":if(Yne(t))return y.createElement(B2,r);break;case"curve":return y.createElement(rb,r);default:return null}}function Kne(e){return y.isValidElement(e)?e.props:e}function yw(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=$ne(e,zne),s;if(y.isValidElement(t))s=y.cloneElement(t,zm(zm({},a),Kne(t)));else if(typeof t=="function")s=t(a,a.index);else if(Lne(t)&&typeof t!="boolean"){var i=Vne(t,a);s=y.createElement(K3,{shapeType:r,elementProps:i})}else{var o=a;s=y.createElement(K3,{shapeType:r,elementProps:o})}return a.isActive?y.createElement(Qn,{className:n},s):s}var bw=(e,t,r)=>{var n=Pr();return(a,s)=>i=>{e==null||e(a,s,i),n(XT({activeIndex:String(s),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},ww=e=>{var t=Pr();return(r,n)=>a=>{e==null||e(r,n,a),t(ree())}},Sw=(e,t,r)=>{var n=Pr();return(a,s)=>i=>{e==null||e(a,s,i),n(nee({activeIndex:String(s),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function _w(e){var{tooltipEntrySettings:t}=e,r=Pr(),n=ja(),a=y.useRef(null);return y.useLayoutEffect(()=>{n||(a.current===null?r(ZQ(t)):a.current!==t&&r(QQ({prev:a.current,next:t})),a.current=t)},[t,r,n]),y.useLayoutEffect(()=>()=>{a.current&&(r(eee(a.current)),a.current=null)},[r]),null}function BP(e){var{legendPayload:t}=e,r=Pr(),n=ja(),a=y.useRef(null);return y.useLayoutEffect(()=>{n||(a.current===null?r(aE(t)):a.current!==t&&r(sE({prev:a.current,next:t})),a.current=t)},[r,n,t]),y.useLayoutEffect(()=>()=>{a.current&&(r(iE(a.current)),a.current=null)},[r]),null}function Xne(e){var{legendPayload:t}=e,r=Pr(),n=St(er),a=y.useRef(null);return y.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(aE(t)):a.current!==t&&r(sE({prev:a.current,next:t})),a.current=t)},[r,n,t]),y.useLayoutEffect(()=>()=>{a.current&&(r(iE(a.current)),a.current=null)},[r]),null}var L1,Jne=()=>{var[e]=y.useState(()=>tf("uid-"));return e},Zne=(L1=YO.useId)!==null&&L1!==void 0?L1:Jne;function Qne(e,t){var r=Zne();return t||(e?"".concat(e,"-").concat(r):r)}var eae=y.createContext(void 0),Nw=e=>{var{id:t,type:r,children:n}=e,a=Qne("recharts-".concat(r),t);return y.createElement(eae.Provider,{value:a},n(a))},tae={cartesianItems:[],polarItems:[]},UP=Va({name:"graphicalItems",initialState:tae,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Br()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ti(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Br()},removeCartesianGraphicalItem:{reducer(e,t){var r=ti(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Br()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Br()},removePolarGraphicalItem:{reducer(e,t){var r=ti(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Br()}}}),{addCartesianGraphicalItem:rae,replaceCartesianGraphicalItem:nae,removeCartesianGraphicalItem:aae,addPolarGraphicalItem:sae,removePolarGraphicalItem:iae}=UP.actions,oae=UP.reducer,lae=e=>{var t=Pr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(rae(e)):r.current!==e&&t(nae({prev:r.current,next:e})),r.current=e},[t,e]),y.useLayoutEffect(()=>()=>{r.current&&(t(aae(r.current)),r.current=null)},[t]),null},zP=y.memo(lae);function cae(e){var t=Pr();return y.useLayoutEffect(()=>(t(sae(e)),()=>{t(iae(e))}),[t,e]),null}var uae=["key"],dae=["onMouseEnter","onClick","onMouseLeave"],fae=["id"],hae=["id"];function X3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X3(Object(r),!0).forEach(function(n){mae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mae(e,t,r){return(t=pae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pae(e){var t=gae(e,"string");return typeof t=="symbol"?t:t+""}function gae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function el(){return el=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},el.apply(null,arguments)}function Qp(e,t){if(e==null)return{};var r,n,a=xae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vae(e){var t=y.useMemo(()=>vw(e.children,vu),[e.children]),r=St(n=>kne(n,e.id,t));return r==null?null:y.createElement(Xne,{legendPayload:r})}var yae=y.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:i,name:o,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(m=>m.tooltipPayload),positions:n.map(m=>m.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:i,dataKey:t,nameKey:r,name:_u(o,t),hide:c,type:u,color:i,unit:"",graphicalItemId:d}};return y.createElement(_w,{tooltipEntrySettings:f})}),bae=(e,t)=>e>t?"start":e<t?"end":"middle",wae=(e,t,r)=>_a(typeof t=="function"?t(e):t,r,r*.8),Sae=(e,t,r)=>{var{top:n,left:a,width:s,height:i}=t,o=hE(s,i),c=a+_a(e.cx,s,s/2),u=n+_a(e.cy,i,i/2),d=_a(e.innerRadius,o,0),f=wae(r,e.outerRadius,o),m=e.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:m}},_ae=(e,t)=>{var r=Zn(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function Nae(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Aae=(e,t)=>{if(y.isValidElement(e))return y.cloneElement(e,t);if(typeof e=="function")return e(t);var r=lr("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=Qp(t,uae);return y.createElement(rb,el({},a,{type:"linear",className:r}))},jae=(e,t,r)=>{if(y.isValidElement(e))return y.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),y.isValidElement(n)))return n;var a=lr("recharts-pie-label-text",Nae(e));return y.createElement(Xp,el({},t,{alignmentBaseline:"middle",className:a}),n)};function kae(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:s,dataKey:i}=r;if(!n||!a||!t)return null;var o=ds(r),c=ql(a),u=ql(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((m,h)=>{var p=(m.startAngle+m.endAngle)/2,g=Nn(m.cx,m.cy,m.outerRadius+d,p),v=tn(tn(tn(tn({},o),m),{},{stroke:"none"},c),{},{index:h,textAnchor:bae(g.x,m.cx)},g),b=tn(tn(tn(tn({},o),m),{},{fill:"none",stroke:m.fill},u),{},{index:h,points:[Nn(m.cx,m.cy,m.outerRadius,p),g],key:"line"});return y.createElement(Ya,{zIndex:An.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(h)},y.createElement(Qn,null,s&&Aae(s,b),jae(a,v,Nr(m,i))))});return y.createElement(Qn,{className:"recharts-pie-labels"},f)}function Cae(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?y.createElement(pw,{label:a}):y.createElement(kae,{sectors:t,props:r,showLabels:n})}function Eae(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:i}=e,o=St(Qo),c=St(lw),u=St($ee),{onMouseEnter:d,onClick:f,onMouseLeave:m}=a,h=Qp(a,dae),p=bw(d,a.dataKey,i),g=ww(m),v=Sw(f,a.dataKey,i);return t==null||t.length===0?null:y.createElement(y.Fragment,null,t.map((b,S)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var _=u==null||u===i,E=String(S)===o&&(c==null||a.dataKey===c)&&_,P=o?n:null,N=r&&E?r:P,I=tn(tn({},b),{},{stroke:b.stroke,tabIndex:-1,[H6]:S,[q6]:i});return y.createElement(Qn,el({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(S),tabIndex:-1,className:"recharts-pie-sector"},Pf(h,b,S),{onMouseEnter:p(b,S),onMouseLeave:g(b,S),onClick:v(b,S)}),y.createElement(yw,el({option:s??N,index:S,shapeType:"sector",isActive:E},I)))}))}function Tae(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:s}=e,{cornerRadius:i,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,m=Math.abs(r.minAngle),h=_ae(o,c),p=Math.abs(h),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,v=n.filter(N=>Nr(N,u,0)!==0).length,b=(p>=360?v:v-1)*g,S=p-v*m-b,_=n.reduce((N,I)=>{var k=Nr(I,u,0);return N+(bt(k)?k:0)},0),E;if(_>0){var P;E=n.map((N,I)=>{var k=Nr(N,u,0),T=Nr(N,d,I),q=Sae(r,s,N),F=(bt(k)?k:0)/_,j,U=tn(tn({},N),a&&a[I]&&a[I].props);I?j=P.endAngle+Zn(h)*g*(k!==0?1:0):j=o;var B=j+Zn(h)*((k!==0?m:0)+F*S),X=(j+B)/2,K=(q.innerRadius+q.outerRadius)/2,ee=[{name:T,value:k,payload:U,dataKey:u,type:f,graphicalItemId:r.id}],Y=Nn(q.cx,q.cy,K,X);return P=tn(tn(tn(tn({},r.presentationProps),{},{percent:F,cornerRadius:typeof i=="string"?parseFloat(i):i,name:T,tooltipPayload:ee,midAngle:X,middleRadius:K,tooltipPosition:Y},U),q),{},{value:k,dataKey:u,startAngle:j,endAngle:B,payload:U,paddingAngle:Zn(h)*g}),P})}return E}function Pae(e){var{showLabels:t,sectors:r,children:n}=e,a=y.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return y.createElement(dne,{value:t?a:void 0},n)}function Oae(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:s,animationBegin:i,animationDuration:o,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:m}=t,h=Mf(t,"recharts-pie-"),p=r.current,[g,v]=y.useState(!1),b=y.useCallback(()=>{typeof m=="function"&&m(),v(!1)},[m]),S=y.useCallback(()=>{typeof f=="function"&&f(),v(!0)},[f]);return y.createElement(Pae,{showLabels:!g,sectors:a},y.createElement(Df,{animationId:h,begin:i,duration:o,isActive:s,easing:c,onAnimationStart:S,onAnimationEnd:b,key:h},_=>{var E=[],P=a&&a[0],N=P==null?void 0:P.startAngle;return a==null||a.forEach((I,k)=>{var T=p&&p[k],q=k>0?Vl(I,"paddingAngle",0):0;if(T){var F=Ur(T.endAngle-T.startAngle,I.endAngle-I.startAngle,_),j=tn(tn({},I),{},{startAngle:N+q,endAngle:N+F+q});E.push(j),N=j.endAngle}else{var{endAngle:U,startAngle:B}=I,X=Ur(0,U-B,_),K=tn(tn({},I),{},{startAngle:N+q,endAngle:N+X+q});E.push(K),N=K.endAngle}}),r.current=E,y.createElement(Qn,null,y.createElement(Eae,{sectors:E,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),y.createElement(Cae,{showLabels:!g,sectors:a,props:t}),t.children)}var Fae={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:An.area};function Iae(e){var{id:t}=e,r=Qp(e,fae),{hide:n,className:a,rootTabIndex:s}=e,i=y.useMemo(()=>vw(e.children,vu),[e.children]),o=St(d=>Cne(d,t,i)),c=y.useRef(null),u=lr("recharts-pie",a);return n||o==null?(c.current=null,y.createElement(Qn,{tabIndex:s,className:u})):y.createElement(Ya,{zIndex:e.zIndex},y.createElement(yae,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:o,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),y.createElement(Qn,{tabIndex:s,className:u},y.createElement(Oae,{props:tn(tn({},r),{},{sectors:o}),previousSectorsRef:c,id:t})))}function hy(e){var t=kn(e,Fae),{id:r}=t,n=Qp(t,hae),a=ds(n);return y.createElement(Nw,{id:r,type:"pie"},s=>y.createElement(y.Fragment,null,y.createElement(cae,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),y.createElement(vae,el({},n,{id:s})),y.createElement(Iae,el({},n,{id:s}))))}hy.displayName="Pie";var Lae=["points"];function J3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J3(Object(r),!0).forEach(function(n){Dae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dae(e,t,r){return(t=Mae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mae(e){var t=Rae(e,"string");return typeof t=="symbol"?t:t+""}function Rae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $m(){return $m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$m.apply(null,arguments)}function Bae(e,t){if(e==null)return{};var r,n,a=Uae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Uae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function zae(e){var{option:t,dotProps:r,className:n}=e;if(y.isValidElement(t))return y.cloneElement(t,r);if(typeof t=="function")return t(r);var a=lr(n,typeof t!="boolean"?t.className:""),s=r??{},{points:i}=s,o=Bae(s,Lae);return y.createElement(OP,$m({},o,{className:a}))}function $ae(e,t){return e==null?!1:t?!0:e.length===1}function Wae(e){var{points:t,dot:r,className:n,dotClassName:a,dataKey:s,baseProps:i,needClip:o,clipPathId:c,zIndex:u=An.scatter}=e;if(!$ae(t,r))return null;var d=RP(r),f=aH(r),m=t.map((p,g)=>{var v,b,S=D1(D1(D1({r:3},i),f),{},{index:g,cx:(v=p.x)!==null&&v!==void 0?v:void 0,cy:(b=p.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:p.value,payload:p.payload,points:t});return y.createElement(zae,{key:"dot-".concat(g),option:r,dotProps:S,className:a})}),h={};return o&&c!=null&&(h.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),y.createElement(Ya,{zIndex:u},y.createElement(Qn,$m({className:n},h),m))}function Z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(r),!0).forEach(function(n){Hae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hae(e,t,r){return(t=qae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qae(e){var t=Gae(e,"string");return typeof t=="symbol"?t:t+""}function Gae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $P=0,Vae={xAxis:{},yAxis:{},zAxis:{}},WP=Va({name:"cartesianAxis",initialState:Vae,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Br()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:Br()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Br()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Br()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:Br()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Br()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Br()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:Br()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Br()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var i=[...s,n].slice(-3);e.yAxis[r]=Q3(Q3({},e.yAxis[r]),{},{width:n,widthHistory:i})}}}}),{addXAxis:Yae,replaceXAxis:Kae,removeXAxis:Xae,addYAxis:Jae,replaceYAxis:Zae,removeYAxis:Qae,addZAxis:qde,replaceZAxis:Gde,removeZAxis:Vde,updateYAxisWidth:ese}=WP.actions,tse=WP.reducer,rse=Ue([Dn],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),nse=Ue([rse,mo,po],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Aw=()=>St(nse),ase=()=>St(Vee);function eA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eA(Object(r),!0).forEach(function(n){sse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sse(e,t,r){return(t=ise(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ise(e){var t=ose(e,"string");return typeof t=="symbol"?t:t+""}function ose(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lse=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:s,clipPath:i}=e;if(a===!1||t.x==null||t.y==null)return null;var o={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=M1(M1(M1({},o),ql(a)),U2(a)),u;return y.isValidElement(a)?u=y.cloneElement(a,c):typeof a=="function"?u=a(c):u=y.createElement(OP,c),y.createElement(Qn,{className:"recharts-active-dot",clipPath:i},u)};function cse(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a,clipPath:s,zIndex:i=An.activeDot}=e,o=St(Qo),c=ase();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return $r(u)?null:y.createElement(Ya,{zIndex:i},y.createElement(lse,{point:u,childIndex:Number(o),mainColor:r,dataKey:a,activeDot:n,clipPath:s}))}var tA=(e,t,r)=>{var n=r??e;if(!$r(n))return _a(n,t,0)},use=(e,t,r)=>{var n={},a=e.filter(zp),s=e.filter(u=>u.stackId==null),i=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),o=Object.entries(i).map(u=>{var[d,f]=u,m=f.map(p=>p.dataKey),h=tA(t,r,f[0].barSize);return{stackId:d,dataKeys:m,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(m=>m!=null),f=tA(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...o,...c]};function rA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rA(Object(r),!0).forEach(function(n){dse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dse(e,t,r){return(t=fse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fse(e){var t=hse(e,"string");return typeof t=="symbol"?t:t+""}function hse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mse(e,t,r,n,a){var s=n.length;if(!(s<1)){var i=_a(e,r,0,!0),o,c=[];if(Vr(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((b,S)=>b+(S.barSize||0),0);f+=(s-1)*i,f>=r&&(f-=(s-1)*i,i=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var m=(r-f)/2>>0,h={offset:m-i,size:0};o=n.reduce((b,S)=>{var _,E={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:h.offset+h.size+i,size:u?d:(_=S.barSize)!==null&&_!==void 0?_:0}},P=[...b,E];return h=P[P.length-1].position,P},c)}else{var p=_a(t,r,0,!0);r-2*p-(s-1)*i<=0&&(i=0);var g=(r-2*p-(s-1)*i)/s;g>1&&(g>>=0);var v=Vr(a)?Math.min(g,a):g;o=n.reduce((b,S,_)=>[...b,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:p+(g+i)*_+(g-v)/2,size:v}}],c)}return o}}var pse=(e,t,r,n,a,s,i)=>{var o=$r(i)?t:i,c=mse(r,n,a!==s?a:s,e,o);return a!==s&&c!=null&&(c=c.map(u=>bh(bh({},u),{},{position:bh(bh({},u.position),{},{offset:u.position.offset-a/2})}))),c},gse=(e,t)=>{var r=Lb(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:s}=a;if(s)return s.find(i=>i.key===r)}}}};function xse(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&Vr(e.zIndex)?e.zIndex:t}var HP=e=>{var{chartData:t}=e,r=Pr(),n=ja();return y.useEffect(()=>n?()=>{}:(r(c3(t)),()=>{r(c3(void 0))}),[t,r,n]),null},nA={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},qP=Va({name:"brush",initialState:nA,reducers:{setBrushSettings(e,t){return t.payload==null?nA:t.payload}}}),{setBrushSettings:Yde}=qP.actions,vse=qP.reducer;function yse(e,t,r){return(t=bse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bse(e){var t=wse(e,"string");return typeof t=="symbol"?t:t+""}function wse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jw{static create(t){return new jw(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}yse(jw,"EPS",1e-4);function Sse(e){return(e%180+180)%180}var _se=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=Sse(a),i=s*Math.PI/180,o=Math.atan(n/r),c=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},Nse={dots:[],areas:[],lines:[]},GP=Va({name:"referenceElements",initialState:Nse,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ti(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ti(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ti(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Kde,removeDot:Xde,addArea:Jde,removeArea:Zde,addLine:Qde,removeLine:efe}=GP.actions,Ase=GP.reducer,jse=y.createContext(void 0),kse=e=>{var{children:t}=e,[r]=y.useState("".concat(tf("recharts"),"-clip")),n=Aw();if(n==null)return null;var{x:a,y:s,width:i,height:o}=n;return y.createElement(jse.Provider,{value:r},y.createElement("defs",null,y.createElement("clipPath",{id:r},y.createElement("rect",{x:a,y:s,height:o,width:i}))),t)};function VP(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function Cse(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return _se(n,r)}function Ese(e,t,r){var n=r==="width",{x:a,y:s,width:i,height:o}=e;return t===1?{start:n?a:s,end:n?a+i:s+o}:{start:n?a+i:s+o,end:n?a:s}}function gf(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-a)<=0}function Tse(e,t){return VP(e,t+1)}function Pse(e,t,r,n,a){for(var s=(n||[]).slice(),{start:i,end:o}=t,c=0,u=1,d=i,f=function(){var p=n==null?void 0:n[c];if(p===void 0)return{v:VP(n,u)};var g=c,v,b=()=>(v===void 0&&(v=r(p,g)),v),S=p.coordinate,_=c===0||gf(e,S,b,d,o);_||(c=0,d=i,u+=1),_&&(d=S+e*(b()/2+a),c+=u)},m;u<=s.length;)if(m=f(),m)return m.v;return[]}function Ose(e,t,r,n,a){var s=(n||[]).slice(),i=s.length;if(i===0)return[];for(var{start:o,end:c}=t,u=1;u<=i;u++){for(var d=(i-1)%u,f=o,m=!0,h=function(){var S=n[p],_=p,E,P=()=>(E===void 0&&(E=r(S,_)),E),N=S.coordinate,I=p===d||gf(e,N,P,f,c);if(!I)return m=!1,1;I&&(f=N+e*(P()/2+a))},p=d;p<i&&!h();p+=u);if(m){for(var g=[],v=d;v<i;v+=u)g.push(n[v]);return g}}return[]}function aA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aA(Object(r),!0).forEach(function(n){Fse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fse(e,t,r){return(t=Ise(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ise(e){var t=Lse(e,"string");return typeof t=="symbol"?t:t+""}function Lse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dse(e,t,r,n,a){for(var s=(n||[]).slice(),i=s.length,{start:o}=t,{end:c}=t,u=function(m){var h=s[m],p,g=()=>(p===void 0&&(p=r(h,m)),p);if(m===i-1){var v=e*(h.coordinate+e*g()/2-c);s[m]=h=pa(pa({},h),{},{tickCoord:v>0?h.coordinate-v*e:h.coordinate})}else s[m]=h=pa(pa({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var b=gf(e,h.tickCoord,g,o,c);b&&(c=h.tickCoord-e*(g()/2+a),s[m]=pa(pa({},h),{},{isShow:!0}))}},d=i-1;d>=0;d--)u(d);return s}function Mse(e,t,r,n,a,s){var i=(n||[]).slice(),o=i.length,{start:c,end:u}=t;if(s){var d=n[o-1],f=r(d,o-1),m=e*(d.coordinate+e*f/2-u);if(i[o-1]=d=pa(pa({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate}),d.tickCoord!=null){var h=gf(e,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-e*(f/2+a),i[o-1]=pa(pa({},d),{},{isShow:!0}))}}for(var p=s?o-1:o,g=function(S){var _=i[S],E,P=()=>(E===void 0&&(E=r(_,S)),E);if(S===0){var N=e*(_.coordinate-e*P()/2-c);i[S]=_=pa(pa({},_),{},{tickCoord:N<0?_.coordinate-N*e:_.coordinate})}else i[S]=_=pa(pa({},_),{},{tickCoord:_.coordinate});if(_.tickCoord!=null){var I=gf(e,_.tickCoord,P,c,u);I&&(c=_.tickCoord+e*(P()/2+a),i[S]=pa(pa({},_),{},{isShow:!0}))}},v=0;v<p;v++)g(v);return i}function kw(e,t,r){var{tick:n,ticks:a,viewBox:s,minTickGap:i,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(bt(c)||Pp.isSsr){var m;return(m=Tse(a,bt(c)?c:0))!==null&&m!==void 0?m:[]}var h=[],p=o==="top"||o==="bottom"?"width":"height",g=d&&p==="width"?Rd(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(_,E)=>{var P=typeof u=="function"?u(_.value,E):_.value;return p==="width"?Cse(Rd(P,{fontSize:t,letterSpacing:r}),g,f):Rd(P,{fontSize:t,letterSpacing:r})[p]},b=a.length>=2?Zn(a[1].coordinate-a[0].coordinate):1,S=Ese(s,b,p);return c==="equidistantPreserveStart"?Pse(b,S,v,a,i):c==="equidistantPreserveEnd"?Ose(b,S,v,a,i):(c==="preserveStart"||c==="preserveStartEnd"?h=Mse(b,S,v,a,i,c==="preserveStartEnd"):h=Dse(b,S,v,a,i),h.filter(_=>_.isShow))}var Rse=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=e,i=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>i&&(i=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=a+s,u=i+c+o+(r?n:0);return Math.round(u)}return 0},Bse=["axisLine","width","height","className","hide","ticks","axisType"];function Use(e,t){if(e==null)return{};var r,n,a=zse(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zl.apply(null,arguments)}function sA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sA(Object(r),!0).forEach(function(n){$se(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $se(e,t,r){return(t=Wse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wse(e){var t=Hse(e,"string");return typeof t=="symbol"?t:t+""}function Hse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qi={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:An.axis};function qse(e){var{x:t,y:r,width:n,height:a,orientation:s,mirror:i,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=_n(_n(_n({},c),ds(o)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!i||s==="bottom"&&i);u=_n(_n({},u),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var f=+(s==="left"&&!i||s==="right"&&i);u=_n(_n({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return y.createElement("line",Zl({},u,{className:lr("recharts-cartesian-axis-line",Vl(o,"className"))}))}function Gse(e,t,r,n,a,s,i,o,c){var u,d,f,m,h,p,g=o?-1:1,v=e.tickSize||i,b=bt(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,m=r+ +!o*a,f=m-g*v,p=f-g*c,h=b;break;case"left":f=m=e.coordinate,d=t+ +!o*n,u=d-g*v,h=u-g*c,p=b;break;case"right":f=m=e.coordinate,d=t+ +o*n,u=d+g*v,h=u+g*c,p=b;break;default:u=d=e.coordinate,m=r+ +o*a,f=m+g*v,p=f+g*c,h=b;break}return{line:{x1:u,y1:f,x2:d,y2:m},tick:{x:h,y:p}}}function Vse(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Yse(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Kse(e){var{option:t,tickProps:r,value:n}=e,a,s=lr(r.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(t))a=y.cloneElement(t,_n(_n({},r),{},{className:s}));else if(typeof t=="function")a=t(_n(_n({},r),{},{className:s}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=lr(i,t==null?void 0:t.className)),a=y.createElement(Xp,Zl({},r,{className:i}),n)}return a}var Xse=y.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:i,unit:o,padding:c,tickTextProps:u,orientation:d,mirror:f,x:m,y:h,width:p,height:g,tickSize:v,tickMargin:b,fontSize:S,letterSpacing:_,getTicksConfig:E,events:P,axisType:N}=e,I=kw(_n(_n({},E),{},{ticks:r}),S,_),k=Vse(d,f),T=Yse(d,f),q=ds(E),F=ql(n),j={};typeof a=="object"&&(j=a);var U=_n(_n({},q),{},{fill:"none"},j),B=I.map(ee=>_n({entry:ee},Gse(ee,m,h,p,g,d,v,f,b))),X=B.map(ee=>{var{entry:Y,line:z}=ee;return y.createElement(Qn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},a&&y.createElement("line",Zl({},U,z,{className:lr("recharts-cartesian-axis-tick-line",Vl(a,"className"))})))}),K=B.map((ee,Y)=>{var{entry:z,tick:ne}=ee,le=_n(_n(_n(_n({textAnchor:k,verticalAnchor:T},q),{},{stroke:"none",fill:s},F),ne),{},{index:Y,payload:z,visibleTicksCount:I.length,tickFormatter:i,padding:c},u);return y.createElement(Qn,Zl({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},Pf(P,z,Y)),n&&y.createElement(Kse,{option:n,tickProps:le,value:"".concat(typeof i=="function"?i(z.value,Y):z.value).concat(o||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(N,"-ticks")},K.length>0&&y.createElement(Ya,{zIndex:An.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(N,"-tick-labels"),ref:t},K)),X.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(N,"-tick-lines")},X))}),Jse=y.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:s,hide:i,ticks:o,axisType:c}=e,u=Use(e,Bse),[d,f]=y.useState(""),[m,h]=y.useState(""),p=y.useRef(null);y.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return Rse({ticks:p.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=y.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=b;var S=b[0];if(S){var _=window.getComputedStyle(S),E=_.fontSize,P=_.letterSpacing;(E!==d||P!==m)&&(f(E),h(P))}}},[d,m]);return i||n!=null&&n<=0||a!=null&&a<=0?null:y.createElement(Ya,{zIndex:e.zIndex},y.createElement(Qn,{className:lr("recharts-cartesian-axis",s)},y.createElement(qse,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:ds(e)}),y.createElement(Xse,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:m,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:o,unit:e.unit,width:e.width,x:e.x,y:e.y}),y.createElement(Hre,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},y.createElement(ene,{label:e.label,labelRef:e.labelRef}),e.children)))}),Cw=y.forwardRef((e,t)=>{var r=kn(e,Qi);return y.createElement(Jse,Zl({},r,{ref:t}))});Cw.displayName="CartesianAxis";var Zse=["x1","y1","x2","y2","key"],Qse=["offset"],eie=["xAxisId","yAxisId"],tie=["xAxisId","yAxisId"];function iA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iA(Object(r),!0).forEach(function(n){rie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rie(e,t,r){return(t=nie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nie(e){var t=aie(e,"string");return typeof t=="symbol"?t:t+""}function aie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tl.apply(null,arguments)}function Wm(e,t){if(e==null)return{};var r,n,a=sie(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iie=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:s,height:i,ry:o}=e;return y.createElement("rect",{x:n,y:a,ry:o,width:s,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function YP(e){var{option:t,lineItemProps:r}=e,n;if(y.isValidElement(t))n=y.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:s,y1:i,x2:o,y2:c,key:u}=r,d=Wm(r,Zse),f=(a=ds(d))!==null&&a!==void 0?a:{},{offset:m}=f,h=Wm(f,Qse);n=y.createElement("line",Tl({},h,{x1:s,y1:i,x2:o,y2:c,fill:"none",key:u}))}return n}function oie(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:i}=e,o=Wm(e,eie),c=a.map((u,d)=>{var f=ya(ya({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return y.createElement(YP,{key:"line-".concat(d),option:n,lineItemProps:f})});return y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function lie(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:i}=e,o=Wm(e,tie),c=a.map((u,d)=>{var f=ya(ya({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return y.createElement(YP,{option:n,lineItemProps:f,key:"line-".concat(d)})});return y.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function cie(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:s,height:i,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length||o==null)return null;var u=o.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==u[0]&&u.unshift(0);var d=u.map((f,m)=>{var h=!u[m+1],p=h?a+i-f:u[m+1]-f;if(p<=0)return null;var g=m%t.length;return y.createElement("rect",{key:"react-".concat(m),y:f,x:n,height:p,width:s,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function uie(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:s,width:i,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==u[0]&&u.unshift(0);var d=u.map((f,m)=>{var h=!u[m+1],p=h?a+i-f:u[m+1]-f;if(p<=0)return null;var g=m%r.length;return y.createElement("rect",{key:"react-".concat(m),x:f,y:s,width:p,height:o,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var die=(e,t)=>{var{xAxis:r,width:n,height:a,offset:s}=e;return z6(kw(ya(ya(ya({},Qi),r),{},{ticks:$6(r),viewBox:{x:0,y:0,width:n,height:a}})),s.left,s.left+s.width,t)},fie=(e,t)=>{var{yAxis:r,width:n,height:a,offset:s}=e;return z6(kw(ya(ya(ya({},Qi),r),{},{ticks:$6(r),viewBox:{x:0,y:0,width:n,height:a}})),s.top,s.top+s.height,t)},hie={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:An.grid};function my(e){var t=Z2(),r=Q2(),n=X6(),a=ya(ya({},kn(e,hie)),{},{x:bt(e.x)?e.x:n.left,y:bt(e.y)?e.y:n.top,width:bt(e.width)?e.width:n.width,height:bt(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:i,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:m,verticalValues:h}=a,p=ja(),g=St(T=>JN(T,"xAxis",s,p)),v=St(T=>JN(T,"yAxis",i,p));if(!ji(u)||!ji(d)||!bt(o)||!bt(c))return null;var b=a.verticalCoordinatesGenerator||die,S=a.horizontalCoordinatesGenerator||fie,{horizontalPoints:_,verticalPoints:E}=a;if((!_||!_.length)&&typeof S=="function"){var P=m&&m.length,N=S({yAxis:v?ya(ya({},v),{},{ticks:P?m:v.ticks}):void 0,width:t??u,height:r??d,offset:n},P?!0:f);gm(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(_=N)}if((!E||!E.length)&&typeof b=="function"){var I=h&&h.length,k=b({xAxis:g?ya(ya({},g),{},{ticks:I?h:g.ticks}):void 0,width:t??u,height:r??d,offset:n},I?!0:f);gm(Array.isArray(k),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(E=k)}return y.createElement(Ya,{zIndex:a.zIndex},y.createElement("g",{className:"recharts-cartesian-grid"},y.createElement(iie,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),y.createElement(cie,Tl({},a,{horizontalPoints:_})),y.createElement(uie,Tl({},a,{verticalPoints:E})),y.createElement(oie,Tl({},a,{offset:n,horizontalPoints:_,xAxis:g,yAxis:v})),y.createElement(lie,Tl({},a,{offset:n,verticalPoints:E,xAxis:g,yAxis:v}))))}my.displayName="CartesianGrid";var mie={},KP=Va({name:"errorBars",initialState:mie,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:tfe,replaceErrorBar:rfe,removeErrorBar:nfe}=KP.actions,pie=KP.reducer,gie=["children"];function xie(e,t){if(e==null)return{};var r,n,a=vie(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yie={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},bie=y.createContext(yie);function XP(e){var{children:t}=e,r=xie(e,gie);return y.createElement(bie.Provider,{value:r},t)}function Ew(e,t){var r,n,a=St(u=>vo(u,e)),s=St(u=>yo(u,t)),i=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:qn.allowDataOverflow,o=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Gn.allowDataOverflow,c=i||o;return{needClip:c,needClipX:i,needClipY:o}}function JP(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Aw(),{needClipX:s,needClipY:i,needClip:o}=Ew(t,r);if(!o||!a)return null;var{x:c,y:u,width:d,height:f}=a;return y.createElement("clipPath",{id:"clipPath-".concat(n)},y.createElement("rect",{x:s?c:c-d/2,y:i?u:u-f/2,width:s?d:d*2,height:i?f:f*2}))}var ZP=(e,t,r,n)=>Zo(e,"xAxis",t,n),QP=(e,t,r,n)=>Jo(e,"xAxis",t,n),e8=(e,t,r,n)=>Zo(e,"yAxis",r,n),t8=(e,t,r,n)=>Jo(e,"yAxis",r,n),wie=Ue([er,ZP,e8,QP,t8],(e,t,r,n,a)=>il(e,"xAxis")?fu(t,n,!1):fu(r,a,!1)),Sie=(e,t,r,n,a)=>a;function _ie(e){return e.type==="line"}var Nie=Ue([Hp,Sie],(e,t)=>e.filter(_ie).find(r=>r.id===t)),Aie=Ue([er,ZP,e8,QP,t8,Nie,wie,jb],(e,t,r,n,a,s,i,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(s==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||i==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:m}=s,h;if(m!=null&&m.length>0?h=m:h=c==null?void 0:c.slice(u,d+1),h!=null)return uoe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:i,displayedData:h})}});function jie(e){var t=ql(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:s}=t,i=Number(a),o=Number(s);return(Number.isNaN(i)||i<0)&&(i=r),(Number.isNaN(o)||o<0)&&(o=n),{r:i,strokeWidth:o}}return{r,strokeWidth:n}}var R1={exports:{}},B1={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oA;function kie(){if(oA)return B1;oA=1;var e=Zm();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,s=e.useEffect,i=e.useMemo,o=e.useDebugValue;return B1.useSyncExternalStoreWithSelector=function(c,u,d,f,m){var h=a(null);if(h.current===null){var p={hasValue:!1,value:null};h.current=p}else p=h.current;h=i(function(){function v(P){if(!b){if(b=!0,S=P,P=f(P),m!==void 0&&p.hasValue){var N=p.value;if(m(N,P))return _=N}return _=P}if(N=_,r(S,P))return N;var I=f(P);return m!==void 0&&m(N,I)?(S=P,N):(S=P,_=I)}var b=!1,S,_,E=d===void 0?null:d;return[function(){return v(u())},E===null?void 0:function(){return v(E())}]},[u,d,f,m]);var g=n(c,h[0],h[1]);return s(function(){p.hasValue=!0,p.value=g},[g]),o(g),g},B1}var lA;function Cie(){return lA||(lA=1,R1.exports=kie()),R1.exports}Cie();function Eie(e){e()}function Tie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Eie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var cA={notify(){},get:()=>[]};function Pie(e,t){let r,n=cA,a=0,s=!1;function i(g){d();const v=n.subscribe(g);let b=!1;return()=>{b||(b=!0,v(),f())}}function o(){n.notify()}function c(){p.onStateChange&&p.onStateChange()}function u(){return s}function d(){a++,r||(r=e.subscribe(c),n=Tie())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=cA)}function m(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const p={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:h,getListeners:()=>n};return p}var Oie=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Fie=Oie(),Iie=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Lie=Iie(),Die=()=>Fie||Lie?y.useLayoutEffect:y.useEffect,Mie=Die();function uA(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Rie(e,t){if(uA(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!uA(e[r[a]],t[r[a]]))return!1;return!0}var U1=Symbol.for("react-redux-context"),z1=typeof globalThis<"u"?globalThis:{};function Bie(){if(!y.createContext)return{};const e=z1[U1]??(z1[U1]=new Map);let t=e.get(y.createContext);return t||(t=y.createContext(null),e.set(y.createContext,t)),t}var Uie=Bie();function zie(e){const{children:t,context:r,serverState:n,store:a}=e,s=y.useMemo(()=>{const c=Pie(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),i=y.useMemo(()=>a.getState(),[a]);Mie(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,i]);const o=r||Uie;return y.createElement(o.Provider,{value:s},t)}var $ie=zie,Wie=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Hie(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function eg(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(Wie.has(n)){if(e[n]==null&&t[n]==null)continue;if(!Rie(e[n],t[n]))return!1}else if(!Hie(e[n],t[n]))return!1;return!0}var qie=["id"],Gie=["type","layout","connectNulls","needClip","shape"],Vie=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function xf(){return xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xf.apply(null,arguments)}function dA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dA(Object(r),!0).forEach(function(n){Yie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yie(e,t,r){return(t=Kie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kie(e){var t=Xie(e,"string");return typeof t=="symbol"?t:t+""}function Xie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tw(e,t){if(e==null)return{};var r,n,a=Jie(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Jie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zie=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:_u(r,t),payload:e}]},Qie=y.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:s,name:i,hide:o,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:s,dataKey:t,nameKey:void 0,name:_u(i,t),hide:o,type:u,color:n,unit:c,graphicalItemId:d}};return y.createElement(_w,{tooltipEntrySettings:f})}),r8=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function eoe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var toe=(e,t,r)=>{var n=r.reduce((f,m)=>f+m);if(!n)return r8(t,e);for(var a=Math.floor(e/n),s=e%n,i=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>s){o=[...r.slice(0,c),s-u];break}var d=o.length%2===0?[0,i]:[i];return[...eoe(r,a),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function roe(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:s,needClip:i}=n,{id:o}=n,c=Tw(n,qie),u=ds(c);return y.createElement(Wae,{points:r,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:i,clipPathId:t})}function noe(e){var{showLabels:t,children:r,points:n}=e,a=y.useMemo(()=>n==null?void 0:n.map(s=>{var i,o,c={x:(i=s.x)!==null&&i!==void 0?i:0,y:(o=s.y)!==null&&o!==void 0?o:0,width:0,lowerWidth:0,upperWidth:0,height:0};return vi(vi({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return y.createElement(TP,{value:t?a:void 0},r)}function fA(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:s}=e,{type:i,layout:o,connectNulls:c,needClip:u,shape:d}=s,f=Tw(s,Gie),m=vi(vi({},La(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:c,strokeDasharray:a??s.strokeDasharray});return y.createElement(y.Fragment,null,(n==null?void 0:n.length)>1&&y.createElement(yw,xf({shapeType:"curve",option:d},m,{pathRef:r})),y.createElement(roe,{points:n,clipPathId:t,props:s}))}function aoe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function soe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:s}=e,{points:i,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:m,width:h,height:p,onAnimationEnd:g,onAnimationStart:v}=r,b=a.current,S=Mf(i,"recharts-line-"),_=y.useRef(S),[E,P]=y.useState(!1),N=!E,I=y.useCallback(()=>{typeof g=="function"&&g(),P(!1)},[g]),k=y.useCallback(()=>{typeof v=="function"&&v(),P(!0)},[v]),T=aoe(n.current),q=y.useRef(0);_.current!==S&&(q.current=s.current,_.current=S);var F=q.current;return y.createElement(noe,{points:i,showLabels:N},r.children,y.createElement(Df,{animationId:S,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:I,onAnimationStart:k,key:S},j=>{var U=Ur(F,T+F,j),B=Math.min(U,T),X;if(c)if(o){var K="".concat(o).split(/[,\s]+/gim).map(z=>parseFloat(z));X=toe(B,T,K)}else X=r8(T,B);else X=o==null?void 0:String(o);if(j>0&&T>0&&(a.current=i,s.current=Math.max(s.current,B)),b){var ee=b.length/i.length,Y=j===1?i:i.map((z,ne)=>{var le=Math.floor(ne*ee);if(b[le]){var A=b[le];return vi(vi({},z),{},{x:Ur(A.x,z.x,j),y:Ur(A.y,z.y,j)})}return m?vi(vi({},z),{},{x:Ur(h*2,z.x,j),y:Ur(p/2,z.y,j)}):vi(vi({},z),{},{x:z.x,y:z.y})});return a.current=Y,y.createElement(fA,{props:r,points:Y,clipPathId:t,pathRef:n,strokeDasharray:X})}return y.createElement(fA,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:X})}),y.createElement(pw,{label:r.label}))}function ioe(e){var{clipPathId:t,props:r}=e,n=y.useRef(null),a=y.useRef(0),s=y.useRef(null);return y.createElement(soe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:s})}var ooe=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Nr(e.payload,t)}};class loe extends y.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:s,yAxisId:i,top:o,left:c,width:u,height:d,id:f,needClip:m,zIndex:h}=this.props;if(t)return null;var p=lr("recharts-line",a),g=f,{r:v,strokeWidth:b}=jie(r),S=RP(r),_=v*2+b,E=m?"url(#clipPath-".concat(S?"":"dots-").concat(g,")"):void 0;return y.createElement(Ya,{zIndex:h},y.createElement(Qn,{className:p},m&&y.createElement("defs",null,y.createElement(JP,{clipPathId:g,xAxisId:s,yAxisId:i}),!S&&y.createElement("clipPath",{id:"clipPath-dots-".concat(g)},y.createElement("rect",{x:c-_/2,y:o-_/2,width:u+_,height:d+_}))),y.createElement(XP,{xAxisId:s,yAxisId:i,data:n,dataPointFormatter:ooe,errorBarOffset:0},y.createElement(ioe,{props:this.props,clipPathId:g}))),y.createElement(cse,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:E}))}}var n8={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:An.line,type:"linear"};function coe(e){var t=kn(e,n8),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:s,animationEasing:i,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:m,xAxisId:h,yAxisId:p,id:g}=t,v=Tw(t,Vie),{needClip:b}=Ew(h,p),S=Aw(),_=Nu(),E=ja(),P=St(q=>Aie(q,h,p,E,g));if(_!=="horizontal"&&_!=="vertical"||P==null||S==null)return null;var{height:N,width:I,x:k,y:T}=S;return y.createElement(loe,xf({},v,{id:g,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:s,animationEasing:i,isAnimationActive:d,hide:u,label:f,legendType:m,xAxisId:h,yAxisId:p,points:P,layout:_,height:N,width:I,left:k,top:T,needClip:b}))}function uoe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,dataKey:i,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=Nr(u,i);if(t==="horizontal"){var m=Q_({axis:r,ticks:a,bandSize:o,entry:u,index:d}),h=$r(f)?null:n.scale(f);return{x:m,y:h,value:f,payload:u}}var p=$r(f)?null:r.scale(f),g=Q_({axis:n,ticks:s,bandSize:o,entry:u,index:d});return p==null||g==null?null:{x:p,y:g,value:f,payload:u}}).filter(Boolean)}function doe(e){var t=kn(e,n8),r=ja();return y.createElement(Nw,{id:t.id,type:"line"},n=>y.createElement(y.Fragment,null,y.createElement(BP,{legendPayload:Zie(t)}),y.createElement(Qie,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),y.createElement(zP,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),y.createElement(coe,xf({},t,{id:n}))))}var py=y.memo(doe,eg);py.displayName="Line";function cc(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:$P}function uc(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:$P}var foe="Invariant failed";function hoe(e,t){throw new Error(foe)}function gy(){return gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gy.apply(null,arguments)}function Hm(e){return y.createElement(yw,gy({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var moe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(bt(t))return t;var s=bt(n)||$r(n);return s?t(n,a):(s||hoe(),r)}},poe=(e,t,r)=>r,goe=(e,t)=>t,Jf=Ue([Hp,goe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),xoe=Ue([Jf],e=>e==null?void 0:e.maxBarSize),voe=(e,t,r,n)=>n,yoe=Ue([er,Hp,cc,uc,poe],(e,t,r,n,a)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),boe=(e,t,r)=>{var n=er(e),a=cc(e,t),s=uc(e,t);if(!(a==null||s==null))return n==="horizontal"?sy(e,"yAxis",s,r):sy(e,"xAxis",a,r)},woe=(e,t)=>{var r=er(e),n=cc(e,t),a=uc(e,t);if(!(n==null||a==null))return r==="horizontal"?XN(e,"xAxis",n):XN(e,"yAxis",a)},Soe=Ue([yoe,qZ,woe],use),_oe=(e,t,r)=>{var n,a,s=Jf(e,t);if(s!=null){var i=cc(e,t),o=uc(e,t);if(!(i==null||o==null)){var c=er(e),u=dT(e),{maxBarSize:d}=s,f=$r(d)?u:d,m,h;return c==="horizontal"?(m=Zo(e,"xAxis",i,r),h=Jo(e,"xAxis",i,r)):(m=Zo(e,"yAxis",o,r),h=Jo(e,"yAxis",o,r)),(n=(a=fu(m,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},a8=(e,t,r)=>{var n=er(e),a=cc(e,t),s=uc(e,t);if(!(a==null||s==null)){var i,o;return n==="horizontal"?(i=Zo(e,"xAxis",a,r),o=Jo(e,"xAxis",a,r)):(i=Zo(e,"yAxis",s,r),o=Jo(e,"yAxis",s,r)),fu(i,o)}},Noe=Ue([Soe,dT,HZ,fT,_oe,a8,xoe],pse),Aoe=(e,t,r)=>{var n=cc(e,t);if(n!=null)return Zo(e,"xAxis",n,r)},joe=(e,t,r)=>{var n=uc(e,t);if(n!=null)return Zo(e,"yAxis",n,r)},koe=(e,t,r)=>{var n=cc(e,t);if(n!=null)return Jo(e,"xAxis",n,r)},Coe=(e,t,r)=>{var n=uc(e,t);if(n!=null)return Jo(e,"yAxis",n,r)},Eoe=Ue([Noe,Jf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Toe=Ue([boe,Jf],gse),Poe=Ue([Dn,X2,Aoe,joe,koe,Coe,Eoe,er,OZ,a8,Toe,Jf,voe],(e,t,r,n,a,s,i,o,c,u,d,f,m)=>{var{chartData:h,dataStartIndex:p,dataEndIndex:g}=c;if(!(f==null||i==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:v}=f,b;if(v!=null&&v.length>0?b=v:b=h==null?void 0:h.slice(p,g+1),b!=null)return ile({layout:o,barSettings:f,pos:i,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:b,offset:e,cells:m,dataStartIndex:p})}}),Ooe=["index"];function xy(){return xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xy.apply(null,arguments)}function Foe(e,t){if(e==null)return{};var r,n,a=Ioe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ioe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var s8=y.createContext(void 0),Loe=e=>{var t=y.useContext(s8);if(t!=null)return t.stackId;if(e!=null)return jV(e)},Doe=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),Moe=e=>{var t=y.useContext(s8);if(t!=null){var{stackId:r}=t;return"url(#".concat(Doe(r,e),")")}},Roe=e=>{var{index:t}=e,r=Foe(e,Ooe),n=Moe(t);return y.createElement(Qn,xy({className:"recharts-bar-stack-layer",clipPath:n},r))},Boe=["onMouseEnter","onMouseLeave","onClick"],Uoe=["value","background","tooltipPosition"],zoe=["id"],$oe=["onMouseEnter","onClick","onMouseLeave"];function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oo.apply(null,arguments)}function hA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Oa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hA(Object(r),!0).forEach(function(n){Woe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Woe(e,t,r){return(t=Hoe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hoe(e){var t=qoe(e,"string");return typeof t=="symbol"?t:t+""}function qoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qm(e,t){if(e==null)return{};var r,n,a=Goe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Goe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Voe=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:_u(r,t),payload:e}]},Yoe=y.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:s,hide:i,unit:o,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:_u(s,t),hide:i,type:c,color:a,unit:o,graphicalItemId:u}};return y.createElement(_w,{tooltipEntrySettings:d})});function Koe(e){var t=St(Qo),{data:r,dataKey:n,background:a,allOtherBarProps:s}=e,{onMouseEnter:i,onMouseLeave:o,onClick:c}=s,u=qm(s,Boe),d=bw(i,n,s.id),f=ww(o),m=Sw(c,n,s.id);if(!a||r==null)return null;var h=ql(a);return y.createElement(Ya,{zIndex:xse(a,An.barBackground)},r.map((p,g)=>{var{value:v,background:b,tooltipPosition:S}=p,_=qm(p,Uoe);if(!b)return null;var E=d(p,g),P=f(p,g),N=m(p,g),I=Oa(Oa(Oa(Oa(Oa({option:a,isActive:String(g)===t},_),{},{fill:"#eee"},b),h),Pf(u,p,g)),{},{onMouseEnter:E,onMouseLeave:P,onClick:N,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return y.createElement(Hm,oo({key:"background-bar-".concat(g)},I))}))}function Xoe(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(s=>{var i={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Oa(Oa({},i),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:i,fill:s.fill})});return y.createElement(TP,{value:t?a:void 0},r)}function Joe(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:s,dataKey:i}=e,o=St(Qo),c=St(lw),u=r&&String(s)===o&&(c==null||i===c),d=u?r:t;return u?y.createElement(Ya,{zIndex:An.activeBar},y.createElement(Hm,oo({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:i}))):y.createElement(Hm,oo({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:i}))}function Zoe(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:s}=e;return y.createElement(Hm,oo({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:s}))}function Qoe(e){var t,{data:r,props:n}=e,a=(t=ds(n))!==null&&t!==void 0?t:{},{id:s}=a,i=qm(a,zoe),{shape:o,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:m}=n,h=qm(n,$oe),p=bw(d,c,s),g=ww(m),v=Sw(f,c,s);return r?y.createElement(y.Fragment,null,r.map((b,S)=>y.createElement(Roe,oo({index:S,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(S),className:"recharts-bar-rectangle"},Pf(h,b,S),{onMouseEnter:p(b,S),onMouseLeave:g(b,S),onClick:v(b,S)}),u?y.createElement(Joe,{shape:o,activeBar:u,baseProps:i,entry:b,index:S,dataKey:c}):y.createElement(Zoe,{shape:o,baseProps:i,entry:b,index:S,dataKey:c})))):null}function ele(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:s,animationBegin:i,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,m=Mf(t,"recharts-bar-"),[h,p]=y.useState(!1),g=!h,v=y.useCallback(()=>{typeof u=="function"&&u(),p(!1)},[u]),b=y.useCallback(()=>{typeof d=="function"&&d(),p(!0)},[d]);return y.createElement(Xoe,{showLabels:g,rects:n},y.createElement(Df,{animationId:m,begin:i,duration:o,isActive:s,easing:c,onAnimationEnd:v,onAnimationStart:b,key:m},S=>{var _=S===1?n:n==null?void 0:n.map((E,P)=>{var N=f&&f[P];if(N)return Oa(Oa({},E),{},{x:Ur(N.x,E.x,S),y:Ur(N.y,E.y,S),width:Ur(N.width,E.width,S),height:Ur(N.height,E.height,S)});if(a==="horizontal"){var I=Ur(0,E.height,S),k=Ur(E.stackedBarStart,E.y,S);return Oa(Oa({},E),{},{y:k,height:I})}var T=Ur(0,E.width,S),q=Ur(E.stackedBarStart,E.x,S);return Oa(Oa({},E),{},{width:T,x:q})});return S>0&&(r.current=_??null),_==null?null:y.createElement(Qn,null,y.createElement(Qoe,{props:t,data:_}))}),y.createElement(pw,{label:t.label}),t.children)}function tle(e){var t=y.useRef(null);return y.createElement(ele,{previousRectanglesRef:t,props:e})}var i8=0,rle=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Nr(e,t)}};class nle extends y.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:i,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=lr("recharts-bar",a),f=u;return y.createElement(Qn,{className:d,id:u},o&&y.createElement("defs",null,y.createElement(JP,{clipPathId:f,xAxisId:s,yAxisId:i})),y.createElement(Qn,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(f,")"):void 0},y.createElement(Koe,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),y.createElement(tle,this.props)))}}var ale={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:i8,xAxisId:0,yAxisId:0,zIndex:An.bar};function sle(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:i,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=Ew(t,r),m=Nu(),h=ja(),p=vw(e.children,vu),g=St(S=>Poe(S,e.id,h,p));if(m!=="vertical"&&m!=="horizontal")return null;var v,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?v=0:v=m==="vertical"?b.height/2:b.width/2,y.createElement(XP,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:rle,errorBarOffset:v},y.createElement(nle,oo({},e,{layout:m,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:i,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function ile(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:i,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:m,cells:h,parentViewBox:p,dataStartIndex:g}=e,v=t==="horizontal"?o:i,b=d?v.scale.domain():null,S=kV({numericAxis:v}),_=v.scale(S);return f.map((E,P)=>{var N,I,k,T,q,F;if(d){var j=d[P+g];if(j==null)return null;N=wV(j,b)}else N=Nr(E,r),Array.isArray(N)||(N=[S,N]);var U=moe(n,i8)(N[1],P);if(t==="horizontal"){var B,[X,K]=[o.scale(N[0]),o.scale(N[1])];I=e4({axis:i,ticks:c,bandSize:s,offset:a.offset,entry:E,index:P}),k=(B=K??X)!==null&&B!==void 0?B:void 0,T=a.size;var ee=X-K;if(q=ri(ee)?0:ee,F={x:I,y:m.top,width:T,height:m.height},Math.abs(U)>0&&Math.abs(q)<Math.abs(U)){var Y=Zn(q||U)*(Math.abs(U)-Math.abs(q));k-=Y,q+=Y}}else{var[z,ne]=[i.scale(N[0]),i.scale(N[1])];if(I=z,k=e4({axis:o,ticks:u,bandSize:s,offset:a.offset,entry:E,index:P}),T=ne-z,q=a.size,F={x:m.left,y:k,width:m.width,height:q},Math.abs(U)>0&&Math.abs(T)<Math.abs(U)){var le=Zn(T||U)*(Math.abs(U)-Math.abs(T));T+=le}}if(I==null||k==null||T==null||q==null)return null;var A=Oa(Oa({},E),{},{stackedBarStart:_,x:I,y:k,width:T,height:q,value:d?N:N[1],payload:E,background:F,tooltipPosition:{x:I+T/2,y:k+q/2},parentViewBox:p},h&&h[P]&&h[P].props);return A}).filter(Boolean)}function ole(e){var t=kn(e,ale),r=Loe(t.stackId),n=ja();return y.createElement(Nw,{id:t.id,type:"bar"},a=>y.createElement(y.Fragment,null,y.createElement(BP,{legendPayload:Voe(t)}),y.createElement(Yoe,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),y.createElement(zP,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),y.createElement(Ya,{zIndex:t.zIndex},y.createElement(sle,oo({},t,{id:a})))))}var vy=y.memo(ole,eg);vy.displayName="Bar";var lle=["domain","range"],cle=["domain","range"];function mA(e,t){if(e==null)return{};var r,n,a=ule(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ule(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function pA(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function o8(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=mA(e,lle),{domain:s,range:i}=t,o=mA(t,cle);return!pA(r,s)||!pA(n,i)?!1:eg(a,o)}var dle=["dangerouslySetInnerHTML","ticks","scale"],fle=["id","scale"];function yy(){return yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yy.apply(null,arguments)}function gA(e,t){if(e==null)return{};var r,n,a=hle(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mle(e){var t=Pr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(Yae(e)):r.current!==e&&t(Kae({prev:r.current,next:e})),r.current=e},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(t(Xae(r.current)),r.current=null)},[t]),null}var ple=e=>{var{xAxisId:t,className:r}=e,n=St(X2),a=ja(),s="xAxis",i=St(b=>HT(b,s,t,a)),o=St(b=>UT(b,t)),c=St(b=>$Q(b,t)),u=St(b=>wT(b,t));if(o==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:m}=e,h=gA(e,dle),{id:p,scale:g}=u,v=gA(u,fle);return y.createElement(Cw,yy({},h,v,{x:c.x,y:c.y,width:o.width,height:o.height,className:lr("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:i,axisType:s}))},gle={allowDataOverflow:qn.allowDataOverflow,allowDecimals:qn.allowDecimals,allowDuplicatedCategory:qn.allowDuplicatedCategory,angle:qn.angle,axisLine:Qi.axisLine,height:qn.height,hide:!1,includeHidden:qn.includeHidden,interval:qn.interval,minTickGap:qn.minTickGap,mirror:qn.mirror,orientation:qn.orientation,padding:qn.padding,reversed:qn.reversed,scale:qn.scale,tick:qn.tick,tickCount:qn.tickCount,tickLine:Qi.tickLine,tickSize:Qi.tickSize,type:qn.type,xAxisId:0},xle=e=>{var t=kn(e,gle);return y.createElement(y.Fragment,null,y.createElement(mle,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),y.createElement(ple,t))},by=y.memo(xle,o8);by.displayName="XAxis";var vle=["dangerouslySetInnerHTML","ticks","scale"],yle=["id","scale"];function wy(){return wy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wy.apply(null,arguments)}function xA(e,t){if(e==null)return{};var r,n,a=ble(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ble(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wle(e){var t=Pr(),r=y.useRef(null);return y.useLayoutEffect(()=>{r.current===null?t(Jae(e)):r.current!==e&&t(Zae({prev:r.current,next:e})),r.current=e},[e,t]),y.useLayoutEffect(()=>()=>{r.current&&(t(Qae(r.current)),r.current=null)},[t]),null}var Sle=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,s=y.useRef(null),i=y.useRef(null),o=St(X2),c=ja(),u=Pr(),d="yAxis",f=St(N=>zT(N,t)),m=St(N=>HQ(N,t)),h=St(N=>HT(N,d,t,c)),p=St(N=>ST(N,t));if(y.useLayoutEffect(()=>{if(!(n!=="auto"||!f||mw(a)||y.isValidElement(a)||p==null)){var N=s.current;if(N){var I=N.getCalculatedWidth();Math.round(f.width)!==Math.round(I)&&u(ese({id:t,width:I}))}}},[h,f,u,a,t,n,p]),f==null||m==null||p==null)return null;var{dangerouslySetInnerHTML:g,ticks:v,scale:b}=e,S=xA(e,vle),{id:_,scale:E}=p,P=xA(p,yle);return y.createElement(Cw,wy({},S,P,{ref:s,labelRef:i,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:lr("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:h,axisType:d}))},_le={allowDataOverflow:Gn.allowDataOverflow,allowDecimals:Gn.allowDecimals,allowDuplicatedCategory:Gn.allowDuplicatedCategory,angle:Gn.angle,axisLine:Qi.axisLine,hide:!1,includeHidden:Gn.includeHidden,interval:Gn.interval,minTickGap:Gn.minTickGap,mirror:Gn.mirror,orientation:Gn.orientation,padding:Gn.padding,reversed:Gn.reversed,scale:Gn.scale,tick:Gn.tick,tickCount:Gn.tickCount,tickLine:Qi.tickLine,tickSize:Qi.tickSize,type:Gn.type,width:Gn.width,yAxisId:0},Nle=e=>{var t=kn(e,_le);return y.createElement(y.Fragment,null,y.createElement(wle,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),y.createElement(Sle,t))},Sy=y.memo(Nle,o8);Sy.displayName="YAxis";var Ale=(e,t)=>t,Pw=Ue([Ale,er,yT,Rn,iP,bo,ite,Dn],hte),Ow=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},l8=Fs("mouseClick"),c8=Ff();c8.startListening({actionCreator:l8,effect:(e,t)=>{var r=e.payload,n=Pw(t.getState(),Ow(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(aee({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var _y=Fs("mouseMove"),u8=Ff(),wh=null;u8.startListening({actionCreator:_y,effect:(e,t)=>{var r=e.payload;wh!==null&&cancelAnimationFrame(wh);var n=Ow(r);wh=requestAnimationFrame(()=>{var a=t.getState(),s=rw(a,a.tooltip.settings.shared);if(s==="axis"){var i=Pw(a,n);(i==null?void 0:i.activeIndex)!=null?t.dispatch(ZT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(JT())}wh=null})}});function jle(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var vA={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},d8=Va({name:"rootProps",initialState:vA,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:vA.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),kle=d8.reducer,{updateOptions:Cle}=d8.actions,f8=Va({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Ele}=f8.actions,Tle=f8.reducer,h8=Fs("keyDown"),m8=Fs("focus"),Fw=Ff();Fw.startListening({actionCreator:h8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var i=nw(a,Fu(r),Gf(r),Kf(r)),o=i==null?-1:Number(i);if(!(!Number.isFinite(o)||o<0)){var c=bo(r);if(s==="Enter"){var u=Rm(r,"axis","hover",String(a.index));t.dispatch(oy({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=YQ(r),f=d==="left-to-right"?1:-1,m=s==="ArrowRight"?1:-1,h=o+m*f;if(!(c==null||h>=c.length||h<0)){var p=Rm(r,"axis","hover",String(h));t.dispatch(oy({active:!0,activeIndex:h.toString(),activeCoordinate:p}))}}}}}});Fw.startListening({actionCreator:m8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",i=Rm(r,"axis","hover",String(s));t.dispatch(oy({active:!0,activeIndex:s,activeCoordinate:i}))}}}});var js=Fs("externalEvent"),p8=Ff(),$1=new Map;p8.startListening({actionCreator:js,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,s=$1.get(a);s!==void 0&&cancelAnimationFrame(s);var i=requestAnimationFrame(()=>{try{var o=t.getState(),c={activeCoordinate:Hee(o),activeDataKey:lw(o),activeIndex:Qo(o),activeLabel:cP(o),activeTooltipIndex:Qo(o),isTooltipActive:qee(o)};r(c,n)}finally{$1.delete(a)}});$1.set(a,i)}}});var Ple=Ue([Pu],e=>e.tooltipItemPayloads),Ole=Ue([Ple,Yf,(e,t)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var i=t(s,r);return i}}}),g8=Fs("touchMove"),x8=Ff();x8.startListening({actionCreator:g8,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=rw(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var i=Pw(n,Ow({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(ZT({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var o,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(H6),f=(o=u.getAttribute(q6))!==null&&o!==void 0?o:void 0,m=Ou(n).find(g=>g.id===f);if(d==null||m==null||f==null)return;var{dataKey:h}=m,p=Ole(n,d,f);t.dispatch(XT({activeDataKey:h,activeIndex:d,activeCoordinate:p,activeGraphicalItemId:f}))}}}});var Fle=f6({brush:vse,cartesianAxis:tse,chartData:Hte,errorBars:pie,graphicalItems:oae,layout:pV,legend:_Y,options:Bte,polarAxis:wne,polarOptions:Tle,referenceElements:Ase,rootProps:kle,tooltip:see,zIndex:kte}),Ile=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return UG({reducer:Fle,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([c8.middleware,u8.middleware,Fw.middleware,p8.middleware,x8.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(k6({type:"raf"}))},devTools:{serialize:{replacer:jle},name:"recharts-".concat(r)}})};function v8(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=ja(),s=y.useRef(null);if(a)return r;s.current==null&&(s.current=Ile(t,n));var i=W2;return y.createElement($ie,{context:i,store:s.current},r)}function Lle(e){var{layout:t,margin:r}=e,n=Pr(),a=ja();return y.useEffect(()=>{a||(n(fV(t)),n(dV(r)))},[n,a,t,r]),null}var y8=y.memo(Lle,eg);function b8(e){var t=Pr();return y.useEffect(()=>{t(Cle(e))},[t,e]),null}function yA(e){var{zIndex:t,isPanorama:r}=e,n=y.useRef(null),a=Pr();return y.useLayoutEffect(()=>(n.current&&a(Ate({zIndex:t,element:n.current,isPanorama:r})),()=>{a(jte({zIndex:t,isPanorama:r}))}),[a,t,r]),y.createElement("g",{tabIndex:-1,ref:n})}function bA(e){var{children:t,isPanorama:r}=e,n=St(pte);if(!n||n.length===0)return t;var a=n.filter(i=>i<0),s=n.filter(i=>i>0);return y.createElement(y.Fragment,null,a.map(i=>y.createElement(yA,{key:i,zIndex:i,isPanorama:r})),t,s.map(i=>y.createElement(yA,{key:i,zIndex:i,isPanorama:r})))}var Dle=["children"];function Mle(e,t){if(e==null)return{};var r,n,a=Rle(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gm.apply(null,arguments)}var Ble={width:"100%",height:"100%",display:"block"},Ule=y.forwardRef((e,t)=>{var r=Z2(),n=Q2(),a=oE();if(!ji(r)||!ji(n))return null;var{children:s,otherAttributes:i,title:o,desc:c}=e,u,d;return i!=null&&(typeof i.tabIndex=="number"?u=i.tabIndex:u=a?0:void 0,typeof i.role=="string"?d=i.role:d=a?"application":void 0),y.createElement(O2,Gm({},i,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:Ble,ref:t}),s)}),zle=e=>{var{children:t}=e,r=St(Ap);if(!r)return null;var{width:n,height:a,y:s,x:i}=r;return y.createElement(O2,{width:n,height:a,x:i,y:s},t)},wA=y.forwardRef((e,t)=>{var{children:r}=e,n=Mle(e,Dle),a=ja();return a?y.createElement(zle,null,y.createElement(bA,{isPanorama:!0},r)):y.createElement(Ule,Gm({ref:t},n),y.createElement(bA,{isPanorama:!1},r))});function $le(){var e=Pr(),[t,r]=y.useState(null),n=St(FV);return y.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),s=a.width/t.offsetWidth;Vr(s)&&s!==n&&e(mV(s))}},[t,e,n]),r}function SA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wle(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SA(Object(r),!0).forEach(function(n){Hle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hle(e,t,r){return(t=qle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qle(e){var t=Gle(e,"string");return typeof t=="symbol"?t:t+""}function Gle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ql(){return Ql=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ql.apply(null,arguments)}var Vle=()=>(Qte(),null);function Vm(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Yle=y.forwardRef((e,t)=>{var r,n,a=y.useRef(null),[s,i]=y.useState({containerWidth:Vm((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Vm((n=e.style)===null||n===void 0?void 0:n.height)}),o=y.useCallback((u,d)=>{i(f=>{var m=Math.round(u),h=Math.round(d);return f.containerWidth===m&&f.containerHeight===h?f:{containerWidth:m,containerHeight:h}})},[]),c=y.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();o(d,f);var m=p=>{var{width:g,height:v}=p[0].contentRect;o(g,v)},h=new ResizeObserver(m);h.observe(u),a.current=h}},[t,o]);return y.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[o]),y.createElement(y.Fragment,null,y.createElement(kp,{width:s.containerWidth,height:s.containerHeight}),y.createElement("div",Ql({ref:c},e)))}),Kle=y.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,s]=y.useState({containerWidth:Vm(r),containerHeight:Vm(n)}),i=y.useCallback((c,u)=>{s(d=>{var f=Math.round(c),m=Math.round(u);return d.containerWidth===f&&d.containerHeight===m?d:{containerWidth:f,containerHeight:m}})},[]),o=y.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();i(u,d)}},[t,i]);return y.createElement(y.Fragment,null,y.createElement(kp,{width:a.containerWidth,height:a.containerHeight}),y.createElement("div",Ql({ref:o},e)))}),Xle=y.forwardRef((e,t)=>{var{width:r,height:n}=e;return y.createElement(y.Fragment,null,y.createElement(kp,{width:r,height:n}),y.createElement("div",Ql({ref:t},e)))}),Jle=y.forwardRef((e,t)=>{var{width:r,height:n}=e;return to(r)||to(n)?y.createElement(Kle,Ql({},e,{ref:t})):y.createElement(Xle,Ql({},e,{ref:t}))});function Zle(e){return e===!0?Yle:Jle}var Qle=y.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:i,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:m,onTouchEnd:h,onTouchMove:p,onTouchStart:g,style:v,width:b,responsive:S,dispatchTouchEvents:_=!0}=e,E=y.useRef(null),P=Pr(),[N,I]=y.useState(null),[k,T]=y.useState(null),q=$le(),F=J2(),j=(F==null?void 0:F.width)>0?F.width:b,U=(F==null?void 0:F.height)>0?F.height:a,B=y.useCallback(G=>{q(G),typeof t=="function"&&t(G),I(G),T(G),G!=null&&(E.current=G)},[q,t,I,T]),X=y.useCallback(G=>{P(l8(G)),P(js({handler:s,reactEvent:G}))},[P,s]),K=y.useCallback(G=>{P(_y(G)),P(js({handler:u,reactEvent:G}))},[P,u]),ee=y.useCallback(G=>{P(JT()),P(js({handler:d,reactEvent:G}))},[P,d]),Y=y.useCallback(G=>{P(_y(G)),P(js({handler:f,reactEvent:G}))},[P,f]),z=y.useCallback(()=>{P(m8())},[P]),ne=y.useCallback(G=>{P(h8(G.key))},[P]),le=y.useCallback(G=>{P(js({handler:i,reactEvent:G}))},[P,i]),A=y.useCallback(G=>{P(js({handler:o,reactEvent:G}))},[P,o]),D=y.useCallback(G=>{P(js({handler:c,reactEvent:G}))},[P,c]),L=y.useCallback(G=>{P(js({handler:m,reactEvent:G}))},[P,m]),M=y.useCallback(G=>{P(js({handler:g,reactEvent:G}))},[P,g]),R=y.useCallback(G=>{_&&P(g8(G)),P(js({handler:p,reactEvent:G}))},[P,_,p]),H=y.useCallback(G=>{P(js({handler:h,reactEvent:G}))},[P,h]),J=Zle(S);return y.createElement(gP.Provider,{value:N},y.createElement(EC.Provider,{value:k},y.createElement(J,{width:j??(v==null?void 0:v.width),height:U??(v==null?void 0:v.height),className:lr("recharts-wrapper",n),style:Wle({position:"relative",cursor:"default",width:j,height:U},v),onClick:X,onContextMenu:le,onDoubleClick:A,onFocus:z,onKeyDown:ne,onMouseDown:D,onMouseEnter:K,onMouseLeave:ee,onMouseMove:Y,onMouseUp:L,onTouchEnd:H,onTouchMove:R,onTouchStart:M,ref:B},y.createElement(Vle,null),r)))}),ece=["width","height","responsive","children","className","style","compact","title","desc"];function tce(e,t){if(e==null)return{};var r,n,a=rce(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var w8=y.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:s,className:i,style:o,compact:c,title:u,desc:d}=e,f=tce(e,ece),m=ds(f);return c?y.createElement(y.Fragment,null,y.createElement(kp,{width:r,height:n}),y.createElement(wA,{otherAttributes:m,title:u,desc:d},s)):y.createElement(Qle,{className:i,style:o,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},y.createElement(wA,{otherAttributes:m,title:u,desc:d,ref:t},y.createElement(kse,null,s)))});function Ny(){return Ny=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ny.apply(null,arguments)}var nce={top:5,right:5,bottom:5,left:5},ace={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:nce,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},S8=y.forwardRef(function(t,r){var n,a=kn(t.categoricalChartProps,ace),{chartName:s,defaultTooltipEventType:i,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:i,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,eventEmitter:void 0};return y.createElement(v8,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},y.createElement(HP,{chartData:u.data}),y.createElement(y8,{layout:a.layout,margin:a.margin}),y.createElement(b8,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),y.createElement(w8,Ny({},a,{ref:r})))}),sce=["axis"],ice=y.forwardRef((e,t)=>y.createElement(S8,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:sce,tooltipPayloadSearcher:hw,categoricalChartProps:e,ref:t})),oce=["axis","item"],lce=y.forwardRef((e,t)=>y.createElement(S8,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:oce,tooltipPayloadSearcher:hw,categoricalChartProps:e,ref:t}));function cce(e){var t=Pr();return y.useEffect(()=>{t(Ele(e))},[t,e]),null}var uce=["layout"];function Ay(){return Ay=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ay.apply(null,arguments)}function dce(e,t){if(e==null)return{};var r,n,a=fce(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hce={top:5,right:5,bottom:5,left:5},_8={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:hce,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},mce=y.forwardRef(function(t,r){var n,a=kn(t.categoricalChartProps,_8),{layout:s}=a,i=dce(a,uce),{chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return y.createElement(v8,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:o},y.createElement(HP,{chartData:a.data}),y.createElement(y8,{layout:s,margin:a.margin}),y.createElement(b8,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),y.createElement(cce,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),y.createElement(w8,Ay({},i,{ref:r})))});function _A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_A(Object(r),!0).forEach(function(n){pce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_A(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pce(e,t,r){return(t=gce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gce(e){var t=xce(e,"string");return typeof t=="symbol"?t:t+""}function xce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vce=["item"],yce=NA(NA({},_8),{},{layout:"centric",startAngle:0,endAngle:360}),AA=y.forwardRef((e,t)=>{var r=kn(e,yce);return y.createElement(mce,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:vce,tooltipPayloadSearcher:hw,categoricalChartProps:r,ref:t})});const bce="/assets/logo1-BYHsmwG2.png",jA=({data:e})=>{var s,i,o,c,u,d,f,m,h,p,g,v,b,S,_,E,P,N,I,k;yf.useEffect(()=>{var T,q;console.log("=== REPORT CARD DATA DEBUG ==="),console.log("1. Data exists:",!!e),console.log("2. Grading Scales:",e==null?void 0:e.gradingScales),console.log("3. HIFZ Data length:",(T=e==null?void 0:e.hifzData)==null?void 0:T.length),console.log("4. Academic Performance length:",(q=e==null?void 0:e.academicPerformance)==null?void 0:q.length),console.log("5. Hifz Target Level:",e==null?void 0:e.hifzTargetLevel),console.log("6. Teacher Remark:",e==null?void 0:e.teacherRemark),e!=null&&e.hifzData&&e.hifzData.forEach((F,j)=>{var U,B;console.log(`HIFZ Item ${j}:`,{subject:F.subject,urduSubject:F.urduSubject,grade:F.grade,hasUrdu:!!((U=F.urduSubject)!=null&&U.trim()),isArabic:(B=F.urduSubject)!=null&&B.match(/[\u0600-\u06FF]/)?"Yes":"No"})})},[e]);const t=((s=e==null?void 0:e.hifzData)==null?void 0:s.filter(T=>T&&T.subject&&T.subject!=="Total/Grade"&&T.subject!=="").map(T=>({name:T.subject||"Subject","Total Marks":T.totalMarks||0,"Secured Marks":T.securedMarks||0,"Class Marks":T.classMarks||0})))||[],r=((i=e==null?void 0:e.academicPerformance)==null?void 0:i.filter(T=>T&&T.subject&&T.subject!=="Total/Grade"&&T.subject!=="").map(T=>({name:T.subject||"Subject",value:T.percentage||0,color:T.color||"#cccccc"})))||[],n=(o=e==null?void 0:e.attendance)!=null&&o.summary?[{name:"Present",value:e.attendance.summary.presentCount||0,color:"#4ade80"},{name:"Absent",value:e.attendance.summary.absentCount||0,color:"#f87171"}]:[{name:"Present",value:0,color:"#4ade80"},{name:"Absent",value:0,color:"#f87171"}],a=()=>{var q;if(!(e!=null&&e.gradingScales)||e.gradingScales.length===0||!((q=e.gradingScales[0])!=null&&q.values)||e.gradingScales[0].values.length<2)return l.jsx("div",{className:"text-center p-2 text-gray-500 text-xs",children:"Grading scale not available"});const T=["E","D","C","B2","B1","A2","A1"];return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-[10px] border-collapse",children:[l.jsx("thead",{children:l.jsx("tr",{children:T.map((F,j)=>l.jsx("th",{className:`border border-white text-white p-1 
                  ${j<2?"bg-red-500":j<4?"bg-orange-500":"bg-green-600"}`,children:F},j))})}),l.jsx("tbody",{children:e.gradingScales.map((F,j)=>{var U,B;return l.jsx("tr",{children:(B=(U=F.values)==null?void 0:U.slice(1))==null?void 0:B.map((X,K)=>l.jsx("td",{className:"border border-gray-300 p-0.5 text-center",children:X||"-"},K))},j)})})]})})};return e?l.jsxs("div",{className:"report-card-container bg-white shadow-2xl rounded-lg border border-gray-200 p-2",children:[l.jsx("style",{children:`
          .font-arabic {
            font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
            font-weight: 600;
            font-size: inherit;
            line-height: 1.6; /* Adjust line height for Nastaliq */
          }
          [dir="rtl"] {
            direction: rtl;
            unicode-bidi: bidi-override;
            font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
          }
          @media print {
            .font-arabic {
              font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
              font-weight: 600;
              font-size: inherit;
              line-height: 1.6;
            }
            [dir="rtl"] {
              font-family: 'Noto Nastaliq Urdu', 'Noto Naskh Arabic', 'Noto Sans Arabic', 'Arial Unicode MS', 'Simplified Arabic', 'Traditional Arabic', 'Arial', sans-serif !important;
            }
          }
        `}),l.jsxs("div",{className:"flex justify-between items-center mb-0",children:[l.jsx("div",{className:"logo-container",style:{width:"auto",height:"auto",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:l.jsx("img",{src:"https://mshifzacademy.com/assets/images/ms-logo.jpg",alt:"MS HIFZ Academy Logo",referrerPolicy:"no-referrer",style:{maxWidth:"250px",maxHeight:"80px",width:"auto",height:"80px",objectFit:"contain"},onError:T=>{T.currentTarget.style.display="none",console.log("Logo 2 failed to load")}})}),l.jsx("div",{className:"logo-container",style:{width:"auto",height:"auto",display:"flex",alignItems:"center",justifyContent:"flex-start",marginRight:"20px"},children:l.jsx("img",{src:bce,alt:"MS Education Academy Logo",referrerPolicy:"no-referrer",style:{maxWidth:"100px",maxHeight:"50px",width:"auto",height:"80px",objectFit:"contain"},onError:T=>{T.currentTarget.style.display="none",console.log("Logo 1 failed to load")}})})]}),l.jsx("div",{className:"bg-violet-800 text-white text-center py-2 font-bold tracking-widest text-lg mb-0 shadow-md uppercase",children:e.reportTitle||"Student Progress Report"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-0.5",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold",children:"Student Detail"}),l.jsxs("div",{className:"p-4 grid grid-cols-[1fr,2fr] gap-y-2 text-sm font-semibold",children:[l.jsx("span",{className:"text-black-600",children:"Student Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((c=e.student)==null?void 0:c.studentName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Father's Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((u=e.student)==null?void 0:u.fathersName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Class/ Section"}),l.jsxs("span",{className:"text-black-900",children:[": ",((d=e.student)==null?void 0:d.classSection)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Group/ Roll No"}),l.jsxs("span",{className:"text-black-900",children:[": ",((f=e.student)==null?void 0:f.groupRollNo)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Branch Name"}),l.jsxs("span",{className:"text-black-900",children:[": ",((m=e.student)==null?void 0:m.branchName)||"N/A"]}),l.jsx("span",{className:"text-black-600",children:"Academic Year"}),l.jsxs("span",{className:"text-black-900",children:[": ",((h=e.student)==null?void 0:h.academicYear)||"N/A"]})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"GRADING SCALE"}),l.jsx("div",{className:"p-2 text-sm font-bold",children:a()})]})]}),e.hifzData&&e.hifzData.length>0&&e.hifzData.some(T=>T.subject&&T.subject!=="")?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-0.5",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsxs("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"HIFZ"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"حفظ قرآن رپورٹ"})]}),l.jsx("div",{className:"p-2",style:{height:"240px"},children:t.length>0?l.jsx(dh,{width:400,height:220,children:l.jsxs(lce,{data:t,barSize:30,children:[l.jsx(my,{strokeDasharray:"3 3",vertical:!1}),l.jsx(by,{dataKey:"name",fontSize:10}),l.jsx(Sy,{fontSize:10,domain:[0,"auto"]}),l.jsx(A1,{}),l.jsx(Wv,{iconType:"rect",wrapperStyle:{fontSize:"10px"}}),l.jsx(vy,{dataKey:"Total Marks",fill:"#22c55e"}),l.jsx(vy,{dataKey:"Secured Marks",fill:"#38bdf8"})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No HIFZ chart data available"})})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"HIFZ REPORT"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"حفظ قرآن رپورٹ"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-100 border-b border-indigo-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left font-arabic",children:"گریڈ"}),l.jsx("th",{className:"p-2 text-left font-arabic",children:"حاصل شدہ نمبرات"}),l.jsx("th",{className:"p-2 text-left font-arabic",children:"کل نمبرات"}),l.jsx("th",{className:"p-2 text-right font-arabic",children:"مضامین"})]})}),l.jsx("tbody",{children:e.hifzData.map((T,q)=>!T.subject||T.subject===""?null:l.jsxs("tr",{className:`border-b ${T.subject==="Total/Grade"?"border-t-2 border-indigo-900 bg-gray-50 font-bold":"border-gray-200"}`,children:[l.jsx("td",{className:"p-2",children:T.grade&&T.grade!=="-"?l.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] text-white font-bold
                              ${["A1","A2"].includes(T.grade)?"bg-green-600":["B1","B2"].includes(T.grade)?"bg-orange-400":["C","C1","C2"].includes(T.grade)?"bg-orange-600":"bg-red-500"}`,children:T.grade}):l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"p-2 font-semibold",children:T.securedMarks||0}),l.jsx("td",{className:"p-2 font-medium",children:T.totalMarks||0}),l.jsxs("td",{className:"p-2 text-right font-bold",children:[l.jsx("span",{className:"block text-[10px] text-gray-600 font-arabic",dir:"rtl",children:T.urduSubject||" "}),T.subject]})]},q)).filter(Boolean)})]})})]})]}):l.jsx("div",{className:"border border-indigo-900 rounded-lg p-4 mb-2 text-center text-gray-500",children:"No HIFZ data available for this student"}),e.academicPerformance&&e.academicPerformance.length>0&&e.academicPerformance.some(T=>T.subject&&T.subject!=="")?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-0.5",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold",children:"ACADEMIC PERFORMANCE"}),l.jsxs("div",{className:"p-4 grid grid-cols-[1fr,1.5fr]",style:{height:"220px"},children:[l.jsx("div",{className:"flex flex-col justify-center space-y-2",children:e.academicPerformance.filter(T=>T.subject&&T.subject!=="").map((T,q)=>l.jsxs("div",{className:"flex items-center space-x-2 text-[10px] font-medium",children:[l.jsx("div",{className:"w-3 h-3",style:{backgroundColor:T.color||"#f8f8f8ff"}}),l.jsxs("span",{children:[T.subject,": ",T.percentage||0,"%"]})]},q))}),l.jsx("div",{className:"relative",style:{width:"220px",height:"220px"},children:r.length>0?l.jsx(dh,{width:220,height:220,children:l.jsxs(AA,{children:[l.jsx(hy,{data:r,cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,paddingAngle:0,startAngle:90,endAngle:-270,dataKey:"value",children:r.map((T,q)=>l.jsx(vu,{fill:T.color},`cell-${q}`))}),l.jsx(A1,{})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"No academic data"})})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold flex justify-between",children:[l.jsx("span",{children:"ACADEMIC PERFORMANCE"}),l.jsx("span",{dir:"rtl",className:"font-arabic",children:"تعلیمی مظاہرہ"})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-100 border-b border-indigo-900",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left font-arabic",children:"گریڈ"}),l.jsx("th",{className:"p-2 text-left font-arabic",children:"حاصل شدہ نمبرات"}),l.jsx("th",{className:"p-2 text-left font-arabic",children:"کل نمبرات"}),l.jsx("th",{className:"p-2 text-right font-arabic",children:"مضامین"})]})}),l.jsx("tbody",{children:e.academicPerformance.filter(T=>T.subject&&T.subject!=="").map((T,q)=>l.jsxs("tr",{className:`border-b ${T.subject==="Total/Grade"?"border-t-2 border-indigo-900 bg-gray-50 font-bold":"border-gray-200"}`,children:[l.jsx("td",{className:"p-2",children:T.grade&&T.grade!=="-"?l.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] text-white font-bold
                              ${["A1","A2"].includes(T.grade)?"bg-green-600":["B1","B2"].includes(T.grade)?"bg-orange-400":["C","C1","C2"].includes(T.grade)?"bg-orange-600":"bg-red-500"}`,children:T.grade}):l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"p-2 font-medium",children:T.securedMarks||0}),l.jsx("td",{className:"p-2 font-medium",children:T.totalMarks||0}),l.jsxs("td",{className:"p-2 text-right font-bold",children:[l.jsx("span",{className:"block text-[10px] text-gray-600 font-arabic",dir:"rtl",children:T.urduSubject||" "}),T.subject]})]},q))})]})})]})]}):l.jsx("div",{className:"border border-indigo-900 rounded-lg p-4 mb-2 text-center text-gray-500",children:"No academic performance data available"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-0.5",children:[l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#4a235a] text-white px-4 py-2 text-sm font-semibold uppercase",children:"Attendance"}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsx("div",{className:"w-24 h-24",children:l.jsx(dh,{width:"100%",height:"100%",children:l.jsx(AA,{children:l.jsx(hy,{data:n,cx:"50%",cy:"50%",innerRadius:25,outerRadius:45,dataKey:"value",startAngle:90,endAngle:-270,children:n.map((T,q)=>l.jsx(vu,{fill:T.color},`cell-${q}`))})})})}),l.jsxs("div",{className:"flex-1 ml-4",children:[l.jsx("h4",{className:"text-red-500 text-xs font-bold mb-2 uppercase text-center",children:"Monthly Attendance"}),(p=e.attendance)!=null&&p.monthly&&e.attendance.monthly.length>0?l.jsxs("table",{className:"w-full text-[10px] border border-gray-200",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-indigo-100",children:[l.jsx("th",{className:"border p-1"}),e.attendance.monthly.map((T,q)=>l.jsx("th",{className:"border p-1",children:T.month||`Month ${q+1}`},q))]})}),l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Total"}),e.attendance.monthly.map((T,q)=>l.jsx("td",{className:"border p-1 text-center",children:T.total||0},q))]}),l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Present"}),e.attendance.monthly.map((T,q)=>l.jsx("td",{className:"border p-1 text-center",children:T.present||0},q))]}),l.jsxs("tr",{children:[l.jsx("td",{className:"border p-1 font-bold bg-gray-50 uppercase",children:"Absent"}),e.attendance.monthly.map((T,q)=>l.jsx("td",{className:"border p-1 text-center",children:T.absent||0},q))]})]})]}):l.jsx("p",{className:"text-gray-400 text-center text-sm",children:"No attendance data available"})]})]}),l.jsxs("div",{className:"flex justify-center space-x-6 text-[10px] font-bold mt-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-green-400"}),l.jsxs("span",{children:["PRESENT : ",((v=(g=e.attendance)==null?void 0:g.summary)==null?void 0:v.presentCount)||0," (",((S=(b=e.attendance)==null?void 0:b.summary)==null?void 0:S.presentPercentage)||0,"%)"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 bg-red-400"}),l.jsxs("span",{children:["ABSENT : ",((E=(_=e.attendance)==null?void 0:_.summary)==null?void 0:E.absentCount)||0," (",((N=(P=e.attendance)==null?void 0:P.summary)==null?void 0:N.absentPercentage)||0,"%)"]})]}),l.jsx("div",{className:"flex items-center space-x-2 text-indigo-900",children:l.jsxs("span",{children:["TOTAL : ",((k=(I=e.attendance)==null?void 0:I.summary)==null?void 0:k.totalCount)||0]})})]})]})]}),l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden flex flex-col shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"HIFZ TARGET LEVEL"}),l.jsx("div",{className:"p-4",style:{height:"220px"},children:e.hifzTargetLevel&&e.hifzTargetLevel.length>0?l.jsx(dh,{width:450,height:220,children:l.jsxs(ice,{data:e.hifzTargetLevel,children:[l.jsx(my,{strokeDasharray:"3 3"}),l.jsx(by,{dataKey:"month",label:{value:"MONTHS",position:"insideBottom",offset:-5,fontSize:10},fontSize:10}),l.jsx(Sy,{label:{value:"PARAS",angle:-90,position:"insideLeft",fontSize:10},fontSize:10}),l.jsx(A1,{}),l.jsx(Wv,{iconType:"circle",wrapperStyle:{fontSize:"10px"}}),l.jsx(py,{type:"monotone",dataKey:"targetParas",name:"Nazira+Hifz",stroke:"#4a235a",strokeWidth:2,dot:{r:3}}),l.jsx(py,{type:"monotone",dataKey:"actualParas",name:"Student Performance",stroke:"#ef4444",strokeWidth:2,dot:{r:4},connectNulls:!0})]})}):l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:l.jsx("span",{children:"No target data available"})})})]})]}),l.jsxs("div",{className:"border border-gray-300 rounded p-2 mb-8 bg-gray-50 relative",children:[l.jsxs("div",{className:"absolute top-2 right-4 text-right",children:[l.jsx("span",{dir:"rtl",className:"font-arabic text-green-700",children:"معلم تاثرات:"}),l.jsx("span",{className:"font-bold text-sm block",children:": Teacher's Remark"})]}),l.jsx("div",{className:"pt-6 text-gray-700 italic mt-2 min-h-[40px]",children:e.teacherRemark||"No remarks provided."})]}),l.jsxs("div",{className:"flex justify-between items-end mt-10 pt-0 border-t border-gray-200",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Parent"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Teacher"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"border-t-2 border-dotted border-gray-400 w-48 mb-2 mx-auto"}),l.jsx("span",{className:"font-bold text-sm text-indigo-900",children:"Signature of Principal"})]})]})]}):l.jsx("div",{className:"report-card-container p-8 text-center text-gray-500",children:"No report data available"})},wce=()=>{yf.useEffect(()=>{const pe=document.createElement("style");return pe.id="student-report-print-styles",pe.textContent=`
      @media print {
        @page {
          margin: 5mm;
        }

        /* 1. RESET OUTER APP SHELL (Allow scrolling/flow) */
        html, body, #root, #app, .h-screen, .min-h-screen, .student-reports-wrapper {
          margin: 0 !important;
          padding: 0 !important;
          height: auto !important;
          min-height: 0 !important;
          overflow: visible !important;
        }

        /* 2. HIDE UI CHROME (Sidebar, Header, Menu, Back Buttons) */
        .no-print, 
        aside, nav, header, footer,
        button, a[href*="back"], 
        .sidebar, .menu,
        /* Explicitly hide the sidebar/menu container based on the screenshot artifact */
        [class*="sidebar-container"],
        [class*="nav-container"] {
          display: none !important;
        }

        /* 3. REPORT CARD CONTAINER (Preserve internal layout) */
        .report-card-container {
          /* Important: Do NOT reset display to block if it needs to be flex/grid 
             But usually the container itself is a block. 
             We just ensure it has width and no shadow. */
          width: 100% !important;
          margin: 0 !important;
          padding: 15px !important;
          box-shadow: none !important;
          border: none !important;
          
          /* Separation between reports */
          margin-bottom: 20px !important; 
          page-break-after: always; /* Re-introducing clean page break per report */
        }
        
        /* 4. PRESERVE INTERNAL LAYOUT */
        /* Avoid resetting visibility globally on all children as it unhides tooltips */
        
        /* Explicitly hide recharts tooltip in print */
        .recharts-tooltip-wrapper {
          display: none !important;
          visibility: hidden !important;
        }

        /* 5. FIX CHARTS AND IMAGES */
        svg, img {
          max-width: 100% !important;
          /* height: auto !important; <--- Removed this as it might squash fixed-height charts */
          display: block; 
          overflow: visible !important;
        }
          margins{
          left: 0;
          right:0;
          top:0;
          bottom:99;
          }

        /* 6. HIDE PARENT BACKGROUNDS used for screens */
        body {
          background: white !important;
        }
      }
    `,document.head.appendChild(pe),()=>{const Ae=document.getElementById("student-report-print-styles");Ae&&Ae.remove()}},[]);const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState([]),[c,u]=y.useState([]),[d,f]=y.useState([]),[m,h]=y.useState([]),[p,g]=y.useState(""),[v,b]=y.useState(""),[S,_]=y.useState(""),[E,P]=y.useState(""),[N,I]=y.useState(!1),[k,T]=y.useState(!1),[q,F]=y.useState(!1),[j,U]=y.useState(!1),[B,X]=y.useState(!1),[K,ee]=y.useState(!1),[Y,z]=y.useState(!1),[ne,le]=y.useState(null),[A,D]=y.useState(null),[L,M]=y.useState([]),R=()=>{window.print()},H=async()=>{var Ae,Le;if(!S||m.length===0){le({type:"error",text:"Please select Test and ensure students are loaded"});return}z(!0),le(null);const pe=[];try{for(const Pe of m){const Oe=Pe.student_id||Pe.id,Ve=await ke.get("/report/student",{params:{student_id:Oe,test_id:S,academic_year:e,branch:a,class_id:p,section:v}});pe.push(Ve.data)}M(pe),le({type:"success",text:`Successfully loaded ${pe.length} student reports! You can now print.`})}catch(Pe){console.error("Error fetching all student reports:",Pe),le({type:"error",text:((Le=(Ae=Pe.response)==null?void 0:Ae.data)==null?void 0:Le.error)||"Failed to load all student reports"})}finally{z(!1)}};y.useEffect(()=>{const pe=localStorage.getItem("academicYear")||"",Ae=localStorage.getItem("user");let Le="All";if(Ae)try{const Pe=JSON.parse(Ae);if(Pe.role==="Admin"||Pe.branch==="All"||Pe.branch==="AllBranches"){const Oe=localStorage.getItem("currentBranch");Oe&&Oe!=="All"&&Oe!=="All Locations"&&(Le=Oe)}else Le=Pe.branch||"All"}catch(Pe){console.error("Error parsing user",Pe)}t(pe),s(Le),n([{branch_name:Le,branch_code:Le}])},[]),y.useEffect(()=>{a&&(T(!0),ke.get("/classes",{params:{branch:a}}).then(pe=>{const Ae=pe.data.classes||pe.data||[];o(Ae)}).catch(pe=>{console.error("Error fetching classes:",pe),le({type:"error",text:"Failed to load classes"})}).finally(()=>T(!1)))},[a]),y.useEffect(()=>{const pe=i.find(Ae=>String(Ae.id)===p);if(!pe){u([]),b("");return}F(!0),ke.get("/sections",{params:{class:pe.class_name}}).then(Ae=>{const Le=Ae.data.sections||Ae.data||[];u(Le)}).catch(Ae=>{console.error("Error fetching sections:",Ae),u([])}).finally(()=>F(!1))},[p,i]),y.useEffect(()=>{if(!p||!e){f([]),_("");return}U(!0),ke.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:p}}).then(pe=>{const Ae=pe.data||[];f(Ae)}).catch(pe=>{console.error("Error fetching tests:",pe),f([])}).finally(()=>U(!1))},[p,e,a]),y.useEffect(()=>{if(!p||!v){h([]),P("");return}const pe=i.find(Ae=>String(Ae.id)===p);pe&&(X(!0),ke.get("/students",{params:{branch:a,class:pe.class_name,section:v,academic_year:e}}).then(Ae=>{const Le=Ae.data.students||Ae.data||[];h(Le)}).catch(Ae=>{console.error("Error fetching students:",Ae),h([])}).finally(()=>X(!1)))},[p,v,a,e,i]);const J=()=>{if(!E||!S){le({type:"error",text:"Please select Test and Student"});return}ee(!0),le(null),D(null),ke.get("/report/student",{params:{student_id:E,test_id:S,academic_year:e,branch:a,class_id:p,section:v}}).then(pe=>{D(pe.data),le({type:"success",text:"Report loaded successfully!"})}).catch(pe=>{var Ae,Le;console.error("Error fetching report:",pe),le({type:"error",text:((Le=(Ae=pe.response)==null?void 0:Ae.data)==null?void 0:Le.error)||"Failed to load report"})}).finally(()=>ee(!1))},G=pe=>{s(pe.target.value),g(""),b(""),_(""),P(""),D(null)},Q=pe=>{g(pe.target.value),b(""),_(""),P(""),D(null)},de=pe=>{b(pe.target.value),P(""),D(null)},V=pe=>{_(pe.target.value),D(null)},Ee=pe=>{P(pe.target.value),D(null)},we=()=>{g(""),b(""),_(""),P(""),u([]),f([]),h([]),D(null),le(null)},he=()=>{var pe,Ae,Le,Pe;return l.jsxs("div",{className:"bg-white p-4 rounded shadow-sm mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h2",{className:"text-lg font-bold text-gray-700 flex items-center",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Select Report Filters"]}),l.jsxs("button",{onClick:we,className:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Branch ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("select",{value:a,onChange:G,disabled:r.length<=1,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:r.map(Oe=>l.jsx("option",{value:Oe.branch_code,children:Oe.branch_name},Oe.branch_code))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Class ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:p,onChange:Q,disabled:k,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:k?"Loading...":"Select Class"}),i.map(Oe=>l.jsx("option",{value:Oe.id,children:Oe.class_name},Oe.id))]}),k&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Section ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:v,onChange:de,disabled:!p||q,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:p?q?"Loading...":"Select Section":"Select Class First"}),c.map(Oe=>l.jsx("option",{value:Oe,children:Oe},Oe))]}),q&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Test/Exam ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:S,onChange:V,disabled:!p||j,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:p?j?"Loading...":"Select Test":"Select Class First"}),d.map(Oe=>l.jsx("option",{value:Oe.test_id,children:Oe.test_name},Oe.test_id))]}),j&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:N?"all":E,onChange:Ee,disabled:!v||B||N,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 disabled:bg-gray-100",children:[l.jsx("option",{value:"",children:v?B?"Loading...":`Select Student (${m.length})`:"Select Section First"}),m.map(Oe=>l.jsxs("option",{value:Oe.student_id||Oe.id,children:[Oe.roll_number," - ",Oe.name||Oe.student_name]},Oe.student_id||Oe.id))]}),B&&l.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:l.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),m.length>0&&l.jsxs("label",{className:"flex items-center text-sm text-gray-700 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:N,onChange:Oe=>{I(Oe.target.checked),Oe.target.checked&&(P(""),D(null))},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),l.jsxs("span",{className:"font-medium",children:["Select All Students (",m.length,")"]})]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[N?l.jsx("button",{type:"button",onClick:H,disabled:Y||!S||m.length===0,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:Y?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading ",m.length," Reports..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Get Reports (",m.length,")"]})}):l.jsx("button",{type:"button",onClick:J,disabled:K||!S||!E,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:K?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading Report..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Get Report"]})}),(A||L.length>0)&&l.jsxs("button",{type:"button",onClick:R,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),L.length>0?`Print All Reports (${L.length})`:"Print Report"]}),(p||v||S||E||N)&&l.jsxs("div",{className:"flex flex-wrap gap-2",children:[p&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Class: ",(pe=i.find(Oe=>String(Oe.id)===p))==null?void 0:pe.class_name]}),v&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Section: ",v]}),S&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Test: ",(Ae=d.find(Oe=>String(Oe.test_id)===S))==null?void 0:Ae.test_name]}),N&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["All Students (",m.length,")"]}),E&&!N&&l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["Student: ",((Le=m.find(Oe=>String(Oe.student_id||Oe.id)===E))==null?void 0:Le.name)||((Pe=m.find(Oe=>String(Oe.student_id||Oe.id)===E))==null?void 0:Pe.student_name)]})]})]})]})},Z=()=>l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[l.jsx("div",{className:"bg-blue-50 rounded-full p-6 mb-6",children:l.jsx("svg",{className:"w-16 h-16 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Report Selected"}),l.jsx("p",{className:"text-gray-500 text-center max-w-md mb-4",children:'Please select Class, Section, Test, and Student from the filters above, then click "Get Report" to view the progress report.'}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{children:"Tip: All filters are required to generate the report"})]})]}),Se=()=>l.jsx("div",{className:"flex items-center justify-center py-16 bg-white rounded shadow",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600 font-medium text-lg",children:"Loading Report Data..."}),l.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we fetch the student report"})]})}),ge=()=>{if(!(A!=null&&A.historicalPerformance)||A.historicalPerformance.length<=1)return null;const pe=A.historicalPerformance.filter(Ae=>Ae.academicYear!==A.student.academicYear);return pe.length===0?null:l.jsx("div",{className:"mb-8 no-print",children:l.jsxs("div",{className:"border border-indigo-900 rounded-lg overflow-hidden shadow-sm",children:[l.jsx("div",{className:"bg-[#1a5276] text-white px-4 py-2 text-sm font-semibold",children:"PREVIOUS YEAR PERFORMANCE"}),l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"space-y-4",children:pe.map((Ae,Le)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[l.jsx("div",{className:"bg-gray-100 px-4 py-2 flex justify-between items-center",children:l.jsxs("span",{className:"font-semibold text-gray-700",children:[Ae.academicYear," - Class ",Ae.class," ",Ae.section]})}),l.jsx("div",{className:"p-3",children:Ae.tests.map((Pe,Oe)=>l.jsxs("div",{className:"mb-3 last:mb-0",children:[l.jsx("h5",{className:"text-sm font-medium text-indigo-700 mb-2",children:Pe.testName}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Pe.subjects.map((Ve,et)=>l.jsxs("div",{className:`text-xs p-2 rounded 
                              ${Ve.isAbsent?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:[l.jsx("span",{className:"font-medium",children:Ve.subject}),l.jsx("span",{className:"float-right",children:Ve.isAbsent?"AB":`${Ve.securedMarks}/${Ve.maxMarks}`})]},et))}),l.jsxs("div",{className:"mt-2 text-right text-sm",children:[l.jsx("span",{className:"font-medium",children:"Total: "}),l.jsxs("span",{className:"text-indigo-600",children:[Pe.securedMarks,"/",Pe.totalMarks,"(",Pe.totalMarks>0?Math.round(Pe.securedMarks/Pe.totalMarks*100):0,"%)"]})]})]},Oe))})]},Le))})})]})})};return l.jsxs("div",{className:"p-4 student-reports-wrapper",children:[l.jsx("h2",{className:"no-print text-xl font-bold text-gray-700 mb-4 border-b pb-2",children:"Student Progress Report"}),l.jsx("div",{className:"no-print",children:he()}),ne&&l.jsxs("div",{className:`no-print p-3 rounded mb-4 flex items-center ${ne.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[ne.type==="error"?l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ne.text]}),K||Y?Se():!A&&L.length===0?Z():l.jsxs("div",{className:"all-reports-container",children:[A&&ge(),A&&l.jsx(jA,{data:A}),L.length>0&&L.map((pe,Ae)=>l.jsx(jA,{data:pe},Ae))]})]})},Sce=()=>{const[e,t]=y.useState(localStorage.getItem("academicYear")||""),[r,n]=y.useState(""),[a,s]=y.useState(""),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState([]),[m,h]=y.useState(""),[p,g]=y.useState([]),[v,b]=y.useState(null),[S,_]=y.useState(!1),[E,P]=y.useState(!1),[N,I]=y.useState(!1),[k,T]=y.useState([]),[q,F]=y.useState(new Set),[j,U]=y.useState(!1),[B,X]=y.useState(!1),[K,ee]=y.useState(null);y.useEffect(()=>{const R=localStorage.getItem("user");if(R){const H=JSON.parse(R);n(H.role),s(H.branch),H.role==="Admin"||H.branch==="All"||H.branch==="AllBranches"?Y().then(J=>{const G=localStorage.getItem("currentBranch");if(G&&G!=="All"&&G!=="All Locations"&&J){const Q=J.find(de=>de.branch_code===G||de.branch_name===G);Q?u(Q.branch_code):J.length>0&&u(J[0].branch_code)}else J&&J.length>0&&u(J[0].branch_code)}):(u(H.branch),o([{branch_code:H.branch,branch_name:H.branch}]))}},[]),y.useEffect(()=>{if(e){const[R,H]=e.split("-"),J=parseInt(R),G=parseInt(H);if(!isNaN(J)&&!isNaN(G)){const Q=[],de=["","January","February","March","April","May","June","July","August","September","October","November","December"];for(let V=1;V<=12;V++)Q.push({name:de[V],month:V,year:J,key:`${V}-${J}`});for(let V=1;V<=12;V++)Q.push({name:de[V],month:V,year:G,key:`${V}-${G}`});T(Q)}}},[e]),y.useEffect(()=>{c?(z(),h(""),g([]),b(null)):(f([]),g([]),h(""))},[c,e]),y.useEffect(()=>{c&&m?(ne(),b(null)):(g([]),b(null))},[c,m,e]),y.useEffect(()=>{v&&c&&m?le():F(new Set)},[v,c,m]);const Y=async()=>{_(!0);try{const H=(await ke.get("/branches")).data.branches||[];return o(H),H}catch(R){return console.error("Failed to fetch branches",R),[]}finally{_(!1)}},z=async()=>{P(!0);try{const R=await ke.get("/classes",{params:{branch:c}});f(R.data.classes||[])}catch(R){console.error("Failed to fetch classes",R)}finally{P(!1)}},ne=async()=>{I(!0);try{const R=await ke.get("/class-tests/list",{params:{academic_year:e,branch:c,class_id:m}}),J=Array.from(new Map(R.data.map(G=>[G.test_id,G])).values()).map(G=>({id:G.test_id,test_name:G.test_name,is_active:!0}));g(J)}catch(R){console.error("Failed to fetch class tests",R),g([])}finally{I(!1)}},le=async()=>{if(!(!v||!c||!m)){U(!0),ee(null);try{const R=await ke.get("/test-attendance",{params:{test_id:v,academic_year:e,branch:c,class_id:m}}),H=new Set;R.data.forEach(J=>{H.add(`${J.month}-${J.year}`)}),F(H)}catch(R){console.error("Failed to fetch mapping",R),ee({type:"error",text:"Failed to load existing attendance settings."})}finally{U(!1)}}},A=async()=>{var R,H;if(!(!v||!c||!m)){X(!0),ee(null);try{const J=Array.from(q).map(G=>{const[Q,de]=G.split("-").map(Number);return{month:Q,year:de}});await ke.post("/test-attendance",{test_id:v,academic_year:e,branch:c,class_id:m,months:J}),ee({type:"success",text:"Attendance settings saved successfully!"})}catch(J){console.error("Save error",J),ee({type:"error",text:((H=(R=J.response)==null?void 0:R.data)==null?void 0:H.error)||"Failed to save settings."})}finally{X(!1)}}},D=R=>{const H=new Set(q);if(H.has(R))H.delete(R);else{if(H.size>=12){alert("You cannot select more than 12 months.");return}H.add(R)}F(H)},L=()=>{q.size>0?F(new Set):ee({type:"error",text:"Please manually select the months (Max 12)."})},M=R=>{const H=k.filter(J=>J.year===R);return H.length===0?null:l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"font-bold text-gray-700 mb-3 border-b pb-1",children:R}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:H.map(J=>l.jsxs("label",{className:`
                                flex items-center gap-3 p-3 rounded border cursor-pointer transition-all
                                ${q.has(J.key)?"bg-blue-50 border-blue-200 ring-1 ring-blue-200":"hover:bg-gray-50 border-gray-200"}
                            `,children:[l.jsx("input",{type:"checkbox",checked:q.has(J.key),onChange:()=>D(J.key),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),l.jsx("div",{children:l.jsx("div",{className:"font-medium text-gray-800",children:J.name})})]},J.key))})]})};return l.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[l.jsx(LF,{className:"text-[#337ab7]"}),"Set Exam Attendance"]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("div",{className:"p-2 bg-gray-100 rounded border text-gray-700 font-medium",children:e})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsxs("select",{value:c,disabled:!0,onChange:R=>{u(R.target.value),h("")},className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"-- Select Branch --"}),i.map(R=>l.jsx("option",{value:R.branch_code,children:R.branch_name},R.branch_code))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsxs("select",{value:m,onChange:R=>h(R.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",disabled:!c||E,children:[l.jsx("option",{value:"",children:"-- Select Class --"}),d.map(R=>l.jsx("option",{value:R.id,children:R.class_name},R.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Exam"}),l.jsxs("select",{value:v||"",onChange:R=>b(Number(R.target.value)||null),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",disabled:N,children:[l.jsx("option",{value:"",children:"-- Select Exam --"}),p.map(R=>l.jsx("option",{value:R.id,children:R.test_name},R.id))]})]})]}),l.jsxs("div",{className:"bg-blue-50 text-blue-800 p-4 rounded-md text-sm mb-6 flex items-start gap-2",children:[l.jsx(Uh,{size:18,className:"mt-0.5"}),l.jsxs("p",{children:["Select the months that should be considered for attendance calculation for this specific ",l.jsx("strong",{children:"Class & Exam"}),".",l.jsx("br",{}),"Allowed range: ",l.jsx("strong",{children:"Jan 2025 - Dec 2026"}),". Max selection: ",l.jsx("strong",{children:"12 months"}),"."]})]}),v&&c&&m&&l.jsxs("div",{className:"animate-fade-in",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h3",{className:"font-semibold text-gray-700",children:["Attendance Months (",q.size,"/12)"]}),l.jsx("button",{onClick:L,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Clear Selection"})]}),j?l.jsx("div",{className:"py-8 text-center text-gray-500",children:"Loading settings..."}):l.jsx("div",{children:e.split("-").map(R=>{const H=parseInt(R);return isNaN(H)?null:M(H)})}),l.jsxs("div",{className:"mt-8 flex items-center justify-between border-t pt-4",children:[l.jsx("div",{children:K&&l.jsxs("span",{className:`text-sm flex items-center gap-1 ${K.type==="error"?"text-red-600":"text-green-600"}`,children:[K.type==="success"?l.jsx(DF,{size:16}):l.jsx(Uh,{size:16}),K.text]})}),l.jsx("button",{onClick:A,disabled:B||j||q.size===0,className:"bg-[#337ab7] text-white px-6 py-2 rounded shadow hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 font-medium",children:B?"Saving...":l.jsxs(l.Fragment,{children:[l.jsx(ec,{size:18})," Save Settings"]})})]})]}),(!v||!c||!m)&&l.jsx("div",{className:"text-center py-10 text-gray-400",children:"Please select Branch, Class, and Exam to configure attendance."})]})]})},_ce=()=>{const[e,t]=y.useState(""),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState([]),[m,h]=y.useState(""),[p,g]=y.useState([]),[v,b]=y.useState(""),[S,_]=y.useState("All"),[E,P]=y.useState([]),[N,I]=y.useState({}),[k,T]=y.useState({}),[q,F]=y.useState({}),[j,U]=y.useState([]),[B,X]=y.useState([]),[K,ee]=y.useState({}),[Y,z]=y.useState(!1),[ne,le]=y.useState(new Set),[A,D]=y.useState(new Set),[L,M]=y.useState(null);y.useEffect(()=>{const we=localStorage.getItem("academicYear")||"",he=localStorage.getItem("user");let Z="All";if(he)try{const Se=JSON.parse(he);if(Se.role==="Admin"||Se.branch==="All"||Se.branch==="AllBranches"){const ge=localStorage.getItem("currentBranch");ge&&ge!=="All"&&ge!=="All Locations"&&(Z=ge)}else Z=Se.branch||"All"}catch(Se){console.error(Se)}t(we),s(Z),n([{branch_name:Z,branch_code:Z}]),ke.get("/academic/subjects",{params:{academic_year:we}}).then(Se=>{const ge={};Se.data.forEach(pe=>{ge[pe.id]={type:pe.subject_type||"Academic",name:pe.subject_name}}),I(ge)}).catch(console.error)},[]),y.useEffect(()=>{a&&ke.get(`/classes?branch=${a}`).then(we=>o(we.data.classes||we.data)).catch(we=>console.error(we))},[a]),y.useEffect(()=>{const we=i.find(he=>he.id==c);if(!we){f([]);return}ke.get(`/sections?class=${we.class_name}`).then(he=>f(he.data.sections||[])).catch(he=>f([]))},[c,i]),y.useEffect(()=>{!c||!e||ke.get("/class-tests/list",{params:{academic_year:e,branch:a,class_id:c}}).then(we=>g(we.data)).catch(console.error)},[c,e,a]),y.useEffect(()=>{const we=p.find(he=>he.test_id==v);we&&we.subjects?(P(we.subjects),U(we.subjects.map(he=>he.id))):(P([]),U([]))},[v,p]);const H=!E||E.length===0?[]:S==="All"?E:E.filter(we=>{const he=we.id,Z=N[he];return(Z&&Z.type||"Academic").toLowerCase()===S.toLowerCase()});y.useEffect(()=>{const we=H.map(he=>he.id);U(we)},[S,E,N]);const J=async()=>{if(!v||E.length===0){M({type:"error",text:"Please select a test with subjects."});return}z(!0),M(null),le(new Set),ee({}),F({}),T({});try{const we=i.find(Pe=>Pe.id==c),he=await ke.get("/students",{params:{branch:a,class:we==null?void 0:we.class_name,section:m,academic_year:e}}),Z=he.data.students||he.data||[];if(Z.length===0){M({type:"error",text:"No students found."}),z(!1);return}Z.sort((Pe,Oe)=>parseInt(Pe.roll_number||0)-parseInt(Oe.roll_number||0)),X(Z);const Se=E.filter(Pe=>j.includes(Pe.id)),ge={},pe={},Ae={};Z.forEach(Pe=>{ge[Pe.student_id||Pe.id]={}});const Le=Se.map(async Pe=>{try{const Oe=await ke.get("/marks/entry/subject",{params:{academic_year:e,branch:a,class_id:c,section:m,test_id:v,subject_id:Pe.id}});Oe.data.class_test_id&&(pe[Pe.id]=Oe.data.class_test_id),Oe.data.subject_total_marks&&(Ae[Pe.id]=Oe.data.subject_total_marks),Oe.data.students.forEach(Ve=>{const et=Ve.student_id;ge[et]&&(ge[et][Pe.id]={value:Ve.is_absent?"AB":Ve.marks_obtained!==null?String(Ve.marks_obtained).split(".")[0]:"",is_absent:Ve.is_absent})})}catch(Oe){console.error(`Failed to fetch marks for subject ${Pe.id}`,Oe)}});await Promise.all(Le),ee(ge),F(pe),T(Ae)}catch(we){console.error(we),M({type:"error",text:"Failed to load data. Please check connection."})}finally{z(!1)}},G=(we,he,Z)=>{ee(Se=>{var ge;return{...Se,[we]:{...Se[we],[he]:{...(ge=Se[we])==null?void 0:ge[he],value:Z,is_absent:Z.trim().toUpperCase()==="AB"}}}})},Q=(we,he)=>{var Ae,Le;const Z=((Le=(Ae=K[we])==null?void 0:Ae[he])==null?void 0:Le.value)||"",Se=k[he]||100;let ge=Z,pe=!1;if(Z.trim().toUpperCase()==="AB")ge="AB",pe=!0;else if(Z.trim()!==""){const Pe=parseFloat(Z);if(isNaN(Pe))ge="";else{let Oe=Math.round(Pe);Oe<0&&(Oe=0),Oe>Se&&(Oe=Math.round(Se)),ge=String(Oe)}}ee(Pe=>({...Pe,[we]:{...Pe[we],[he]:{value:ge,is_absent:pe}}}))},de=we=>{le(he=>new Set(he).add(we))},V=async we=>{D(he=>new Set(he).add(we));try{const he=E.filter(Se=>j.includes(Se.id)).map(async Se=>{var Le;const ge=q[Se.id];if(!ge)return;const pe=(Le=K[we])==null?void 0:Le[Se.id],Ae=pe!=null&&pe.is_absent?"AB":(pe==null?void 0:pe.value)||"";await ke.post("/marks/entry/subject",{class_test_id:ge,subject_id:Se.id,academic_year:e,branch:a,class_id:c,section:m,marks:[{student_id:we,value:Ae}],user_id:1})});await Promise.all(he);const Z=new Set(ne);Z.delete(we),le(Z)}catch(he){console.error("Save failed for student "+we,he),alert("Failed to save marks for this student. Please check inputs.")}finally{const he=new Set(A);he.delete(we),D(he)}},Ee=()=>{if(B.length===0)return;const we=B.map(Se=>{const ge={"Roll No":Se.roll_number,Name:Se.name,"Admission No":Se.admission_no};return E.filter(pe=>j.includes(pe.id)).forEach(pe=>{var Le;const Ae=(Le=K[Se.student_id||Se.id])==null?void 0:Le[pe.id];ge[pe.subject_name]=Ae!=null&&Ae.is_absent?"AB":(Ae==null?void 0:Ae.value)||""}),ge}),he=rn.json_to_sheet(we),Z=rn.book_new();rn.book_append_sheet(Z,he,"Marks"),lp(Z,"Marks_Export.xlsx")};return l.jsxs("div",{className:"p-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-700 mb-4 border-b pb-2",children:"Enter All Subject Marks"}),l.jsxs("div",{className:"bg-white p-4 rounded shadow-sm mb-6 grid grid-cols-1 md:grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:c,onChange:we=>u(we.target.value),className:"mt-1 block w-full rounded-md border p-2 border-gray-300 shadow-sm",children:[l.jsx("option",{value:"",children:"Select Class"}),i.map(we=>l.jsx("option",{value:we.id,children:we.class_name},we.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:m,onChange:we=>h(we.target.value),className:"mt-1 block w-full rounded-md border p-2 border-gray-300 shadow-sm",children:[l.jsx("option",{value:"",children:"Select Section"}),d.map(we=>l.jsx("option",{value:we,children:we},we))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject Type"}),l.jsxs("select",{value:S,onChange:we=>_(we.target.value),className:"mt-1 block w-full rounded-md border p-2 border-gray-300 shadow-sm",children:[l.jsx("option",{value:"All",children:"All Types"}),l.jsx("option",{value:"Academic",children:"Academic"}),l.jsx("option",{value:"Hifz",children:"Hifz"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Exam Type"}),l.jsxs("select",{value:v,onChange:we=>b(we.target.value),className:"mt-1 block w-full rounded-md border p-2 border-gray-300 shadow-sm",children:[l.jsx("option",{value:"",children:"Select Exam"}),p.map(we=>l.jsx("option",{value:we.test_id,children:we.test_name},we.test_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select Subjects"}),l.jsxs("div",{className:"relative group",children:[l.jsx("button",{className:"mt-1 block w-full text-left rounded-md border p-2 border-gray-300 shadow-sm bg-white overflow-hidden text-ellipsis whitespace-nowrap",children:j.length===H.length&&H.length>0?`All ${S==="All"?"":S} Subjects`:`${j.length} Selected`}),l.jsx("div",{className:"absolute hidden group-hover:block z-10 w-full bg-white border shadow-lg max-h-60 overflow-y-auto p-2",children:H.map(we=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-gray-50 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:j.includes(we.id),onChange:he=>{he.target.checked?U(Z=>[...Z,we.id]):U(Z=>Z.filter(Se=>Se!==we.id))},className:"rounded text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-700",children:we.subject_name})]},we.id))})]})]})]}),l.jsx("div",{className:"mb-6 flex justify-end",children:l.jsx("button",{onClick:J,disabled:Y||!v,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:bg-gray-400",children:Y?"Loading...":"GET Button"})}),L&&l.jsx("div",{className:`p-3 rounded mb-4 ${L.type==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:L.text}),B.length>0&&l.jsxs("div",{className:"bg-white shadow rounded overflow-hidden",children:[l.jsx("div",{className:"p-3 bg-gray-50 border-b flex justify-between items-center",children:l.jsx("div",{className:"font-bold text-gray-700",children:"Student Marks"})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10",children:"S.no"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-12 bg-gray-50 z-10",children:"Student Name"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll No"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Adm No"}),E.filter(we=>j.includes(we.id)).map(we=>{const he=k[we.id];return l.jsxs("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]",children:[we.subject_name," (",he!==void 0?he:"-",")"]},we.id)}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map((we,he)=>{const Z=we.student_id||we.id,Se=ne.has(Z),ge=A.has(Z);return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500 sticky left-0 bg-white",children:he+1}),l.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 sticky left-12 bg-white",children:we.name}),l.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:we.roll_number}),l.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:we.admission_no}),E.filter(pe=>j.includes(pe.id)).map(pe=>{var Ve;const Ae=(Ve=K[Z])==null?void 0:Ve[pe.id],Le=(Ae==null?void 0:Ae.value)||"",Pe=(Ae==null?void 0:Ae.is_absent)||!1,Oe=Ae!==void 0;return l.jsx("td",{className:"px-2 py-2 text-center",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("input",{type:"text",value:Oe?Le:"",disabled:!Se||!Oe,onChange:et=>G(Z,pe.id,et.target.value),onBlur:()=>Q(Z,pe.id),placeholder:Oe?"":"-",className:`w-16 text-center border rounded py-1 focus:ring-2 focus:outline-none 
                                                                ${Pe?"bg-red-50 text-red-600 font-bold border-red-300":"border-gray-300"}
                                                                ${!Se||!Oe?"bg-gray-100":""}
                                                                ${Oe?"":"cursor-not-allowed opacity-50 placeholder-gray-400"}
                                                            `})})},pe.id)}),l.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:Se?l.jsx("button",{onClick:()=>V(Z),disabled:ge,className:"flex items-center gap-1 text-white bg-green-600 hover:bg-green-700 font-medium text-xs px-2 py-1 rounded shadow-sm disabled:bg-gray-400",children:ge?"...":l.jsxs(l.Fragment,{children:[l.jsx(ec,{size:14})," Save"]})}):l.jsxs("button",{onClick:()=>de(Z),className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium text-xs px-2 py-1 border border-blue-200 rounded hover:bg-blue-50",children:[l.jsx(sv,{size:14})," Edit"]})})]},Z)})})]})})]}),B.length>0&&l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsxs("button",{onClick:Ee,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:[l.jsx(Wy,{size:16})," Download Excel"]})})]})},wd=({title:e,items:t})=>{const[r,n]=y.useState(!1);return l.jsxs("div",{className:"relative",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[l.jsxs("button",{className:"flex items-center gap-1 px-3 py-2 text-sm font-medium text-white bg-[#337ab7] hover:bg-[#286090] rounded",children:[e," ",l.jsx(RF,{size:14})]}),r&&l.jsx("div",{className:"absolute right-0 z-50 w-64 bg-white border shadow rounded-b py-2",children:t.map((a,s)=>l.jsxs("button",{onClick:a.disabled?void 0:a.onClick,disabled:a.disabled,className:`block w-full text-left px-4 py-2 text-sm
                ${a.disabled?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100 hover:text-[#337ab7]"}
              `,children:[a.label,a.disabled&&l.jsx("span",{className:"ml-2 text-xs",children:"(Coming soon)"})]},s))})]})},Nce=()=>{const[e,t]=y.useState("HOME");return l.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:l.jsx("div",{className:"flex-1 flex flex-col",children:l.jsxs("div",{className:"bg-white flex-1 flex flex-col",children:[e==="HOME"&&l.jsxs("div",{className:"p-4 flex flex-wrap justify-between border-b",children:[l.jsxs("h1",{className:"flex items-center gap-2 text-[#337ab7] font-semibold",children:[l.jsx(y5,{className:"text-gray-400"}),"ACADEMICS MANAGEMENT"]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx(wd,{title:"Enter Marks",items:[{label:"Subject Wise",onClick:()=>t("MARKS_ENTRY_SUBJECT")},{label:"Enter All Subject Marks",onClick:()=>t("MARKS_ENTRY_ALL_SUBJECTS")},{label:"Upload Exam Marks",onClick:()=>t("MARKS_ENTRY_UPLOAD")},{label:"Marks Progress Report",disabled:!0},{label:"Student Health Details",disabled:!0}]}),l.jsx(wd,{title:"Config",items:[{label:"Student Health Config",disabled:!0},{label:"Assign Favorites to Class",disabled:!0}]}),l.jsx(wd,{title:"Academic Actions",items:[{label:"Assign Class Subjects",onClick:()=>t("ASSIGN_SUBJECTS")},{label:"Assign Student Subjects",onClick:()=>t("ASSIGN_STUDENT_SUBJECTS")},{label:"Assign Subject Tests",onClick:()=>t("ASSIGN_SUBJECT_TESTS")},{label:"Assign Test to Students",onClick:()=>t("ASSIGN_STUDENT_TESTS")},{label:"Set Exam Roaster",disabled:!0},{label:"Set Exam Attendance",onClick:()=>t("SET_EXAM_ATTENDANCE")},{label:"Freeze Marks",disabled:!0},{label:"Publish Report Card",disabled:!0}]}),l.jsx(wd,{title:"Masters",items:[...JSON.parse(localStorage.getItem("user")||"{}").role==="Admin"?[{label:"Subjects",onClick:()=>t("SUBJECTS")}]:[],{label:"Create Test",onClick:()=>t("CREATE_TEST")},{label:"Add Exam",onClick:()=>t("ADD_EXAM")},{label:"Grading",onClick:()=>t("GRADING")},{label:"Academic Setting",disabled:!0}]}),l.jsx(wd,{title:"Reports",items:[{label:"Student Report Card",onClick:()=>t("STUDENT_REPORT_CARD")},{label:"Absent Report",disabled:!0},{label:"Subject Wise Toppers",disabled:!0},{label:"Performance Index",disabled:!0}]})]})]}),l.jsxs("div",{className:`flex-1 bg-slate-50 ${e==="ADD_EXAM"?"p-2":"p-6"}`,children:[e!=="HOME"&&l.jsx("button",{onClick:()=>t("HOME"),className:"no-print mb-4 text-sm text-gray-600 hover:text-[#337ab7] flex items-center gap-1",children:"← Back to Menu"}),e==="HOME"&&l.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400 h-full py-20",children:[l.jsx(y5,{size:48,className:"mb-2 opacity-20"}),l.jsx("p",{children:"Select an action from the menu above to manage academic data."})]}),e==="SUBJECTS"&&l.jsx(HF,{}),e==="ASSIGN_SUBJECTS"&&l.jsx(qF,{}),e==="ASSIGN_STUDENT_SUBJECTS"&&l.jsx(VF,{}),e==="ASSIGN_SUBJECT_TESTS"&&l.jsx(XF,{}),e==="ASSIGN_STUDENT_TESTS"&&l.jsx(JF,{}),e==="CREATE_TEST"&&l.jsx(YF,{}),e==="ADD_EXAM"&&l.jsx(GF,{}),e==="GRADING"&&l.jsx(ZF,{}),e==="MARKS_ENTRY_SUBJECT"&&l.jsx(QW,{}),e==="MARKS_ENTRY_UPLOAD"&&l.jsx(eH,{}),e==="STUDENT_REPORT_CARD"&&l.jsx(wce,{}),e==="SET_EXAM_ATTENDANCE"&&l.jsx(Sce,{}),e==="MARKS_ENTRY_ALL_SUBJECTS"&&l.jsx(_ce,{}),!["HOME","SUBJECTS","ASSIGN_SUBJECTS","ASSIGN_STUDENT_SUBJECTS"].includes(e)&&l.jsx("div",{className:"text-gray-500"})]})]})})})};var Oh={exports:{}},Ace=Oh.exports,kA;function jce(){return kA||(kA=1,(function(e,t){(function(r,n){n()})(Ace,function(){function r(u,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function n(u,d,f){var m=new XMLHttpRequest;m.open("GET",u),m.responseType="blob",m.onload=function(){c(m.response,d,f)},m.onerror=function(){console.error("could not download file")},m.send()}function a(u){var d=new XMLHttpRequest;d.open("HEAD",u,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function s(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(d)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof q0=="object"&&q0.global===q0?q0:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(u,d,f){var m=i.URL||i.webkitURL,h=document.createElement("a");d=d||u.name||"download",h.download=d,h.rel="noopener",typeof u=="string"?(h.href=u,h.origin===location.origin?s(h):a(h.href)?n(u,d,f):s(h,h.target="_blank")):(h.href=m.createObjectURL(u),setTimeout(function(){m.revokeObjectURL(h.href)},4e4),setTimeout(function(){s(h)},0))}:"msSaveOrOpenBlob"in navigator?function(u,d,f){if(d=d||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(r(u,f),d);else if(a(u))n(u,d,f);else{var m=document.createElement("a");m.href=u,m.target="_blank",setTimeout(function(){s(m)})}}:function(u,d,f,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof u=="string")return n(u,d,f);var h=u.type==="application/octet-stream",p=/constructor/i.test(i.HTMLElement)||i.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||h&&p||o)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var _=v.result;_=g?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=_:location=_,m=null},v.readAsDataURL(u)}else{var b=i.URL||i.webkitURL,S=b.createObjectURL(u);m?m.location=S:location.href=S,m=null,setTimeout(function(){b.revokeObjectURL(S)},4e4)}});i.saveAs=c.saveAs=c,e.exports=c})})(Oh)),Oh.exports}var Iw=jce();const kce=({activeTab:e,onTabChange:t,onAction:r})=>{const[n,a]=y.useState(null),s="px-3 py-1.5 text-sm border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",i="px-3 py-1.5 text-sm border border-transparent bg-sky-600 text-white rounded-md",o=({title:u,children:d})=>{const f=n===u;return l.jsxs("div",{className:"relative inline-block text-left",children:[l.jsxs("button",{type:"button",className:`${s} flex items-center`,onClick:()=>a(f?null:u),onBlur:()=>setTimeout(()=>a(null),200),children:[u,l.jsx(Al,{className:"w-4 h-4 ml-1"})]}),f&&l.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:l.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:d})})]})},c=({children:u,action:d})=>l.jsx("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",onClick:f=>{f.preventDefault(),d&&r(d)},children:u});return l.jsx("div",{className:"bg-white p-3 border-b",children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[l.jsx("div",{children:l.jsxs("h2",{className:"text-lg font-semibold text-gray-700",children:["STUDENT ATTENDANCE",l.jsx("span",{className:"text-gray-400 mx-2",children:"/"}),l.jsx("span",{className:"text-sm bg-gray-200 text-gray-600 font-medium px-2 py-1 rounded",children:"Non Biometric"})]})}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("button",{className:e==="take"?i:s,onClick:()=>t("take"),children:"Take Attendance"}),l.jsx("button",{className:e==="register"?i:s,onClick:()=>t("register"),children:"Register View"}),l.jsxs(o,{title:"Reports",children:[l.jsx(c,{action:"Absent Report",children:"Absent Report"}),l.jsx(c,{action:"SMS",children:"Send SMS To All Present Students"}),l.jsx(c,{action:"Month Report",children:"Month Report"})]})]})]})})},CA=()=>{const[e,t]=y.useState([]),[r,n]=y.useState({}),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState(new Date().toISOString().split("T")[0]),[d,f]=y.useState(!1),[m,h]=y.useState([]),[p,g]=y.useState(!1),[v,b]=y.useState(0),[S,_]=y.useState(null);y.useEffect(()=>{ke.get("/classes").then(k=>h(k.data.classes||[])).catch(k=>console.error("Failed to load classes",k))},[]);const E=async()=>{if(!a){alert("Please select a class");return}f(!0);try{const k=localStorage.getItem("currentBranch")||"All",T=k==="All Branches"||k==="All"?"All":k,q=await ke.get("/attendance",{params:{class:a,section:i,date:c,branch:T}}),F=q.data.students||[],j=q.data.attendance||{};t(F),b(q.data.class_update_count||0),_(q.data.last_modified);const U={};F.forEach(X=>{const K=j[X.student_id]||"Present";U[X.student_id]=K}),n(U);const B=Object.keys(j).length>0;g(B)}catch(k){console.error("Error fetching students:",k),alert("Failed to fetch students")}finally{f(!1)}},P=(k,T)=>{n(q=>({...q,[k]:T}))},N=k=>{const T=e.reduce((q,F)=>(q[F.student_id]=k,q),{});n(T)},I=async()=>{f(!0);try{const k={date:c,attendance:Object.entries(r).map(([T,q])=>({student_id:parseInt(T),status:q}))};await ke.post("/attendance",k),alert("Attendance saved successfully!"),E()}catch(k){console.error("Error saving attendance:",k),alert("Failed to save attendance")}finally{f(!1)}};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsx("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg",children:"TAKE ATTENDANCE"}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Attendance Date"}),l.jsx("input",{type:"date",value:c,onChange:k=>u(k.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:a,onChange:k=>s(k.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"--Select Class--"}),m.map(k=>l.jsx("option",{value:k.class_name,children:k.class_name},k.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:i,onChange:k=>o(k.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm",children:[l.jsx("option",{value:"",children:"--All Sections--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("button",{onClick:E,disabled:d,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:d?"Loading...":"Get Students"})]}),e.length>0&&l.jsxs("div",{className:"overflow-x-auto border rounded-lg",children:[l.jsxs("div",{className:"p-2 bg-gray-50 border-b flex gap-2",children:[l.jsx("button",{onClick:()=>N("Present"),className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded border border-green-200 hover:bg-green-200",children:"Mark All Present"}),l.jsx("button",{onClick:()=>N("Holiday"),className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded border border-gray-200 hover:bg-gray-200",children:"Mark All Holiday"}),l.jsx("button",{onClick:()=>N("Sunday"),className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded border border-red-200 hover:bg-red-200",children:"Mark All Sunday"})]}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-m",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No."}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Adm No."}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Student Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Father Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Phone"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(k=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.rollNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.admNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium text-gray-900",children:k.name}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:k.father}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:k.smsNo||k.fatherMobile}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("div",{className:"flex items-center space-x-5",children:[{val:"Present",label:"P",color:"green"},{val:"Absent",label:"A",color:"red"},{val:"Holiday",label:"H",color:"gray"},{val:"Sunday",label:"S",color:"pink"}].map(T=>l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"radio",name:`status-${k.student_id}`,checked:r[k.student_id]===T.val,onChange:()=>P(k.student_id,T.val),className:`h-5 w-5 text-${T.color}-600 border-gray-300 focus:ring-${T.color}-500`}),l.jsx("span",{className:`ml-1 text-${T.color}-700 font-medium`,children:T.label})]},T.val))})})]},k.student_id))})]}),l.jsx("div",{className:"p-4 bg-gray-50 border-t flex justify-end",children:l.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l.jsx("button",{onClick:I,disabled:d,className:`${p?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"} text-white px-6 py-2 rounded-md text-sm font-semibold disabled:bg-gray-400`,children:d?p?"Updating...":"Saving...":p?`Update Attendance (Updates: ${v})`:"Save Attendance"}),p&&S&&l.jsxs("div",{className:"text-xs text-gray-500",children:["Last Modified: ",new Date(S).toLocaleString()]})]})})]})]})]})})},Cce=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,s]=y.useState(new Date().getMonth()+1),[i,o]=y.useState(new Date().getFullYear()),[c,u]=y.useState([]),[d,f]=y.useState(null),[m,h]=y.useState(!1);y.useEffect(()=>{ke.get("/classes").then(E=>u(E.data.classes||[])).catch(E=>console.error("Failed to load classes",E))},[]);const p=async()=>{if(!e){alert("Please select a class");return}h(!0);try{const E=localStorage.getItem("currentBranch")||"All",P=E==="All Branches"||E==="All"?"All":E,N=await ke.get("/attendance",{params:{class:e,section:r,month:a,year:i,branch:P}});f(N.data)}catch(E){console.error("Error fetching report:",E),alert("Failed to fetch report")}finally{h(!1)}},g=new Date(i,a,0).getDate(),v=Array.from({length:g},(E,P)=>P+1),b=E=>{switch(E){case"Present":return"bg-green-100 text-green-800";case"Absent":return"bg-red-100 text-red-800";case"Leave":return"bg-yellow-100 text-yellow-800";case"Holiday":return"bg-gray-100 text-gray-800";case"Sunday":return"bg-pink-100 text-pink-800";case"Weekoff":return"bg-blue-100 text-blue-800";default:return""}},S=E=>E?E.charAt(0):"-",_=()=>{if(!d)return;const E=[],P=["Student Name","Admission No",...v.map(q=>q.toString()),"Present","Absent","Total Working Days","Attendance %"];E.push(P),d.students.forEach(q=>{const F=d.attendance[q.student_id]||{};let j=0,U=0;const B=v.map(ee=>{const Y=`${i}-${String(a).padStart(2,"0")}-${String(ee).padStart(2,"0")}`,z=F[Y];return z==="Present"?(j++,"P"):z==="Absent"?(U++,"A"):"-"}),X=j+U,K=X>0?(j/X*100).toFixed(1):"0.0";E.push([q.name,q.admNo,...B,j,U,X,`${K}%`])});const N=rn.aoa_to_sheet(E),I=rn.book_new();rn.book_append_sheet(I,N,"Attendance Register");const k=Cf(I,{bookType:"xlsx",type:"array"}),T=new Blob([k],{type:"application/octet-stream"});Iw.saveAs(T,`Attendance_${e}_${a}_${i}.xlsx`)};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsx("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg",children:"ATTENDANCE REGISTER"}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:e,onChange:E=>t(E.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select Class--"}),c.map(E=>l.jsx("option",{value:E.class_name,children:E.class_name},E.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:r,onChange:E=>n(E.target.value),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--All Sections--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Month"}),l.jsx("select",{value:a,onChange:E=>s(parseInt(E.target.value)),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:Array.from({length:12},(E,P)=>P+1).map(E=>l.jsx("option",{value:E,children:new Date(0,E-1).toLocaleString("default",{month:"long"})},E))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year"}),l.jsx("input",{type:"number",value:i,onChange:E=>o(parseInt(E.target.value)),className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),l.jsx("button",{onClick:p,disabled:m,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:m?"Loading...":"Get Register"})]}),d&&l.jsx("div",{className:"overflow-x-auto border rounded-lg mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-2 py-2 text-left font-medium text-gray-500 sticky left-0 bg-gray-50 z-10 w-48",children:"Student"}),v.map(E=>{const N=new Date(i,a-1,E).toLocaleDateString("en-US",{weekday:"short"});return l.jsx("th",{className:"px-1 py-2 text-center font-medium text-gray-500 w-8 border-l border-gray-100",children:l.jsxs("div",{className:"flex flex-col items-center justify-center leading-tight",children:[l.jsx("span",{children:E}),l.jsx("span",{className:"text-[10px] font-normal text-gray-400",children:N})]})},E)}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50 border-l border-blue-100",children:"Present"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Absent"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Total Working Days"}),l.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700 bg-blue-50",children:"Attendance %"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.students.map(E=>{const P=d.attendance[E.student_id]||{};let N=0,I=0;v.forEach(q=>{const F=`${i}-${String(a).padStart(2,"0")}-${String(q).padStart(2,"0")}`,j=P[F];j==="Present"&&N++,j==="Absent"&&I++});const k=N+I,T=k>0?(N/k*100).toFixed(1):"0.0";return l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[l.jsxs("td",{className:"px-2 py-1 whitespace-nowrap font-medium text-gray-900 sticky left-0 bg-white z-10 border-r shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:[l.jsx("div",{children:E.name}),l.jsx("div",{className:"text-[10px] text-gray-500",children:E.admNo})]}),v.map(q=>{const F=`${i}-${String(a).padStart(2,"0")}-${String(q).padStart(2,"0")}`,j=P[F];return l.jsx("td",{className:`px-1 py-1 text-center border-l border-gray-100 ${b(j)}`,children:S(j)},q)}),l.jsx("td",{className:"px-2 py-1 text-center font-bold text-green-700 bg-blue-50 border-l border-blue-100",children:N}),l.jsx("td",{className:"px-2 py-1 text-center font-bold text-red-700 bg-blue-50",children:I}),l.jsx("td",{className:"px-2 py-1 text-center font-semibold text-gray-700 bg-blue-50",children:k}),l.jsxs("td",{className:"px-2 py-1 text-center font-bold text-blue-700 bg-blue-50",children:[T,"%"]})]},E.student_id)})}),l.jsxs("div",{className:"right p-2 mt-2",children:[l.jsx("button",{onClick:_,disabled:!d,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 text-sm disabled:bg-gray-400",children:"Export Excel"})," "]})]})})]})]})})},Ece=()=>{const[e,t]=y.useState("today"),[r,n]=y.useState(new Date().toISOString().split("T")[0]),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState(""),[d,f]=y.useState([]),[m,h]=y.useState(null),[p,g]=y.useState([]),[v,b]=y.useState(!1),[S,_]=y.useState([]);y.useEffect(()=>{ke.get("/classes").then(k=>_(k.data.classes||[])).catch(k=>console.error("Failed to load classes",k))},[]);const E=async()=>{if(!c){alert("Please enter a search term");return}b(!0);try{const k=localStorage.getItem("currentBranch")||"All",T=k==="All Branches"||k==="All"?"All":k,F=(await ke.get("/students",{params:{search:c,branch:T}})).data.students||[];F.length===0?(alert("No students found"),f([])):F.length===1?(f([]),P(F[0])):(f(F),h(null))}catch(k){console.error("Error searching students:",k),alert("Failed to search students")}finally{b(!1)}},P=k=>{h(k),f([]),N(k.student_id)},N=async k=>{b(!0);try{const q=(await ke.get("/attendance",{params:{student_id:k}})).data.attendance||{},F=[];q[k]&&Object.entries(q[k]).forEach(([j,U])=>{F.push({date:j,status:U})}),F.sort((j,U)=>new Date(U.date).getTime()-new Date(j.date).getTime()),g(F)}catch(T){console.error("Error fetching report:",T),alert("Failed to fetch report")}finally{b(!1)}},I=async()=>{b(!0),g([]);try{const k=localStorage.getItem("currentBranch")||"All",q={date:r,branch:k==="All Branches"||k==="All"?"All":k};a&&(q.class=a);const F=await ke.get("/attendance",{params:q}),j=F.data.students||[],U=F.data.attendance||{},B=j.filter(X=>{const K=U[X.student_id];return K==="Absent"||K==="Leave"}).map(X=>({...X,status:U[X.student_id]}));g(B)}catch(k){console.error("Error fetching report:",k),alert("Failed to fetch report")}finally{b(!1)}};return l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsxs("div",{className:"bg-sky-600 text-white font-semibold p-3 rounded-t-lg flex justify-between items-center",children:[l.jsx("span",{children:"ABSENT REPORT"}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>{t("today"),g([]),h(null)},className:`px-3 py-1 text-xs rounded ${e==="today"?"bg-white text-sky-600":"bg-sky-700 text-white"}`,children:"Today's Absentees"}),l.jsx("button",{onClick:()=>{t("student"),g([])},className:`px-3 py-1 text-xs rounded ${e==="student"?"bg-white text-sky-600":"bg-sky-700 text-white"}`,children:"Student Report"})]})]}),l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-4 items-end",children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),l.jsx("input",{type:"date",value:r,onChange:k=>n(k.target.value),className:"mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class (Optional)"}),l.jsxs("select",{value:a,onChange:k=>s(k.target.value),className:"mt-1 px-3 py-2 border border-gray-300 rounded-md text-sm w-40",children:[l.jsx("option",{value:"",children:"All Classes"}),S.map(k=>l.jsx("option",{value:k.class_name,children:k.class_name},k.id))]})]}),l.jsx("button",{onClick:I,disabled:v,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:v?"Searching...":"Search"})]}):l.jsxs("div",{className:"w-full space-y-4",children:[l.jsxs("div",{className:"bg-gray-50 p-3 rounded-md border",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Find Student by Class & Section"}),l.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Class"}),l.jsxs("select",{value:a,onChange:k=>{s(k.target.value),k.target.value},className:"mt-1 w-40 px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select--"}),S.map(k=>l.jsx("option",{value:k.class_name,children:k.class_name},k.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Section"}),l.jsxs("select",{value:i,onChange:k=>o(k.target.value),className:"mt-1 w-40 px-3 py-2 border border-gray-300 rounded-md text-sm",children:[l.jsx("option",{value:"",children:"--Select--"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("button",{onClick:async()=>{if(!a){alert("Please select a class");return}b(!0);try{const k=localStorage.getItem("currentBranch")||"All",q={class:a,branch:k==="All Branches"||k==="All"?"All":k};i&&(q.section=i);const F=await ke.get("/students",{params:q});f(F.data.students||[]),h(null)}catch(k){console.error(k),alert("Error fetching students")}finally{b(!1)}},disabled:v,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:"Get Students"})]})]}),l.jsxs("div",{className:"relative flex items-center py-2",children:[l.jsx("div",{className:"flex-grow border-t border-gray-300"}),l.jsx("span",{className:"flex-shrink-0 mx-4 text-gray-400 text-xs",children:"OR SEARCH BY DETAILS"}),l.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),l.jsxs("div",{className:"flex gap-2 items-end",children:[l.jsxs("div",{className:"flex-grow",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Search Student (Name, Adm No, Phone)"}),l.jsx("input",{type:"text",value:c,onChange:k=>u(k.target.value),placeholder:"Enter Name, Admission No, or Phone",className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md text-sm",onKeyDown:k=>k.key==="Enter"&&E()})]}),l.jsx("button",{onClick:E,disabled:v,className:"bg-violet-600 text-white px-4 py-2 rounded-md hover:bg-violet-700 text-sm disabled:bg-gray-400",children:"Find"})]}),d.length>0&&l.jsx("div",{className:"mt-2 border rounded-md max-h-40 overflow-y-auto bg-gray-50",children:d.map(k=>l.jsxs("div",{onClick:()=>P(k),className:"p-2 hover:bg-violet-100 cursor-pointer border-b last:border-b-0 text-sm",children:[l.jsxs("span",{className:"font-semibold",children:[k.first_name," ",k.last_name]}),l.jsxs("span",{className:"text-gray-500 ml-2",children:["(",k.admission_no,") - Class ",k.class," ",k.section?`- Sec ${k.section}`:""]})]},k.student_id))}),m&&l.jsxs("div",{className:"mt-6 bg-white border rounded-lg shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"bg-violet-50 px-4 py-3 border-b border-violet-100 flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-violet-800",children:"Student Profile"}),l.jsx("button",{onClick:()=>h(null),className:"text-sm text-violet-600 hover:text-violet-800 hover:underline",children:"Change Student"})]}),l.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"md:col-span-1 flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full mb-3 flex items-center justify-center overflow-hidden border-2 border-white shadow-md",children:m.photo?l.jsx("img",{src:m.photo,alt:m.name,className:"w-full h-full object-cover"}):l.jsx("span",{className:"text-3xl text-gray-400",children:"👤"})}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:m.name}),l.jsx("p",{className:"text-sm text-gray-500",children:m.admNo}),l.jsx("div",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]}),l.jsxs("div",{className:"md:col-span-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-2 uppercase text-xs tracking-wider",children:"Academic Details"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Class & Section:"}),l.jsxs("span",{className:"font-medium text-gray-900",children:[m.class," - ",m.section||"N/A"]})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Roll Number:"}),l.jsx("span",{className:"font-medium text-gray-900",children:m.rollNo||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Admission Date:"}),l.jsx("span",{className:"font-medium text-gray-900",children:m.admission_date||"-"})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-2 uppercase text-xs tracking-wider",children:"Personal Details"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Father Name:"}),l.jsx("span",{className:"font-medium text-gray-900",children:m.father||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"Mobile:"}),l.jsx("span",{className:"font-medium text-gray-900",children:m.smsNo||m.fatherMobile||"-"})]}),l.jsxs("div",{className:"flex justify-between border-b border-gray-100 py-1",children:[l.jsx("span",{className:"text-gray-600",children:"DOB:"}),l.jsx("span",{className:"font-medium text-gray-900",children:m.dob||"-"})]})]})]}),l.jsxs("div",{className:"sm:col-span-2 mt-2",children:[l.jsx("h4",{className:"font-semibold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Address"}),l.jsx("p",{className:"text-gray-700 bg-gray-50 p-2 rounded border border-gray-100",children:m.address||"No address provided"})]})]})]}),p.length>0&&l.jsxs("div",{className:"bg-gray-50 border-t px-4 py-3 grid grid-cols-2 sm:grid-cols-5 gap-4 text-center",children:[l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Total Days"}),l.jsx("div",{className:"text-xl font-bold text-gray-800",children:p.length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-green-600 uppercase font-semibold",children:"Present"}),l.jsx("div",{className:"text-xl font-bold text-green-700",children:p.filter(k=>k.status==="Present").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-red-600 uppercase font-semibold",children:"Absent"}),l.jsx("div",{className:"text-xl font-bold text-red-700",children:p.filter(k=>k.status==="Absent").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-yellow-600 uppercase font-semibold",children:"Leave"}),l.jsx("div",{className:"text-xl font-bold text-yellow-700",children:p.filter(k=>k.status==="Leave").length})]}),l.jsxs("div",{className:"bg-white p-2 rounded border shadow-sm",children:[l.jsx("div",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Percentage"}),l.jsxs("div",{className:"text-xl font-bold text-blue-700",children:[p.length>0?Math.round(p.filter(k=>k.status==="Present").length/p.length*100):0,"%"]})]})]})]})]})}),p.length>0?l.jsx("div",{className:"overflow-x-auto border rounded-lg mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsx("tr",{children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Class"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Adm No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Father Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Phone"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]}):l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Date"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"})]})})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map((k,T)=>l.jsx("tr",{children:e==="today"?l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.class}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.rollNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.admNo}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-medium",children:k.name}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:k.father}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-gray-500",children:k.smsNo||k.fatherMobile}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${k.status==="Absent"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:k.status})})]}):l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:k.date}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${k.status==="Present"?"bg-green-100 text-green-800":k.status==="Absent"?"bg-red-100 text-red-800":k.status==="Leave"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:k.status})})]})},T))})]})}):!v&&(e==="today"||m)&&l.jsx("div",{className:"text-center text-gray-500 mt-4",children:"No records found"})]})]})})},EA=({navigateTo:e,defaultTab:t="take"})=>{const[r,n]=y.useState(t),a=i=>{i==="Absent Report"?n("absent-report"):i==="Month Report"&&n("register")},s=()=>{switch(r){case"take":return l.jsx(CA,{});case"register":return l.jsx(Cce,{});case"absent-report":return l.jsx(Ece,{});case"today":return l.jsx("div",{className:"p-4 text-center text-gray-500",children:"Today's Report Coming Soon"});default:return l.jsx(CA,{})}};return l.jsxs("div",{className:"h-full overflow-y-auto bg-gray-100",children:[l.jsx(kce,{activeTab:r,onTabChange:n,onAction:a}),s()]})},Tce=({onImportSuccess:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(""),s=u=>{u.target.files&&u.target.files.length>0&&(r(u.target.files[0]),a(""))},i=async()=>{if(t){const u=new FormData;u.append("file",t),a("Uploading...");try{const f=(await ke.post("/students/upload_csv",u,{headers:{"Content-Type":"multipart/form-data"}})).data;a(f.message||"Upload successful!"),setTimeout(()=>{e()},1500)}catch(d){if(console.error("Upload error:",d),d.response){console.error("Backend response data:",d.response.data);const f=d.response.data;f.errors&&f.errors.length>0?a(`Upload failed. Errors: ${f.errors.join(", ")}`):a(`Error: ${f.error||f.message||"Upload failed"}`)}else d.request?a("Network error: No response from server. Ensure backend is running."):a(`Error: ${d.message}`)}}else a("Please select a file to upload.")},o=async()=>{var u;try{const d=await ke.get("/students/template",{responseType:"blob"}),f=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=f,m.setAttribute("download","student_import_template.xlsx"),document.body.appendChild(m),m.click(),(u=m.parentNode)==null||u.removeChild(m),window.URL.revokeObjectURL(f)}catch(d){console.error("Error downloading template:",d),alert("Failed to download template. Please check if backend is running.")}},c=["Please don't make any changes in given template.","Only 2000 records are accepted in the list at a time.","The data should be in valid format to upload successfully.","Student and father first name is mandatory field to import data.","Mobile no and Adhar no should be in text format.(Setting- Format cells)","Date should be in DD/MM/YYYY Format only using separators (/, - , .)","For Status please enter 0 for new and 1 for Promoted student.","For Gender please enter 1 for male, 2 for female, 3 for other.","Please make a separate file for each class.","Section column is mandatory.","For student type (Enter 1 for day scholar and 2 for hosteller) otherwise considered as day scholar."];return l.jsx("div",{className:"p-4 md:p-6 bg-gray-100",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md border",children:[l.jsxs("div",{className:"p-4 border-b flex items-center space-x-2",children:[l.jsx(oF,{className:"w-6 h-6 text-gray-600"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Import Student Data"}),l.jsx("a",{href:"#",className:"text-sm text-blue-500 hover:underline",children:"Get Help"})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("label",{className:"block text-md font-medium text-gray-800",children:"Browse for the excel sheet:"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"cursor-pointer bg-white border border-gray-300 rounded-l-md px-4 py-2 text-gray-700 hover:bg-gray-50 whitespace-nowrap",children:["Choose File",l.jsx("input",{type:"file",className:"hidden",onChange:s,accept:".csv, .xlsx, .xls"})]}),l.jsx("input",{type:"text",value:t?t.name:"No file chosen",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-r-md bg-gray-50 focus:outline-none"}),l.jsx("button",{onClick:i,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 whitespace-nowrap",children:"Upload Excel"})]}),n&&l.jsx("p",{className:`mt-2 text-sm ${n.includes("successfully")?"text-green-600":"text-red-600"}`,children:n})]})]}),l.jsx("div",{className:"bg-[#fff0f0] rounded-lg shadow-md border-l-4 border-red-500",children:l.jsxs("div",{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-bold text-red-700 mb-3",children:"Important Instruction"}),l.jsx("p",{className:"text-sm text-gray-800 mb-4",children:"Note: Please read the following instructions:"}),l.jsx("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700",children:c.map((u,d)=>l.jsx("li",{children:u},d))}),l.jsx("div",{className:"mt-6",children:l.jsxs("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center space-x-2 shadow-md",children:[l.jsx(dj,{className:"w-5 h-5"}),l.jsx("span",{children:"Download Excel Template"})]})})]})})]})})},W1="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-violet-500 focus:border-violet-500 text-sm disabled:bg-gray-100 disabled:text-gray-500",N8="block text-sm font-medium text-gray-700 mb-1",Uc=yf.memo(({title:e,children:t,defaultOpen:r=!1})=>{const[n,a]=y.useState(r);return l.jsxs("div",{className:"md:col-span-4 mt-6 border rounded-lg overflow-hidden shadow-sm bg-white",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 cursor-pointer border-b hover:bg-gray-100 transition-colors",onClick:()=>a(!n),children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:e}),l.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:underline font-medium focus:outline-none",children:n?"Collapse":"Expand"})]}),n&&l.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4",children:t})]})}),Nt=yf.memo(({label:e,name:t,value:r,checked:n,onChange:a,type:s="text",required:i=!1,as:o="input",children:c,disabled:u=!1,placeholder:d,className:f})=>{const m=`field_${t}`;return s==="checkbox"?l.jsxs("div",{className:`flex items-center pt-6 ${f||""}`,children:[l.jsx("input",{type:"checkbox",name:t,id:m,checked:n,onChange:a,className:"h-5 w-5 text-violet-600 border-gray-300 rounded focus:ring-violet-500 cursor-pointer",disabled:u}),l.jsx("label",{htmlFor:m,className:"ml-2 text-sm text-gray-700 cursor-pointer select-none",children:e}),c]}):l.jsxs("div",{className:f,children:[l.jsxs("label",{htmlFor:m,className:N8,children:[e," ",i&&l.jsx("span",{className:"text-red-500",children:"*"})]}),o==="input"&&l.jsx("input",{type:s,name:t,id:m,value:r||"",onChange:a,className:W1,disabled:u,placeholder:d}),o==="select"&&l.jsx("select",{name:t,id:m,value:r||"",onChange:a,className:W1,disabled:u,children:c}),o==="textarea"&&l.jsx("textarea",{name:t,id:m,value:r||"",onChange:a,className:W1,rows:2,disabled:u,placeholder:d})]})}),Pce=yf.memo(({title:e,photo:t,onPhotoChange:r,id:n,isViewMode:a})=>l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("label",{className:N8,children:e}),l.jsx("div",{className:"w-28 h-28 rounded-md bg-gray-100 mb-2 flex items-center justify-center overflow-hidden border-2 border-dashed border-gray-300 hover:border-violet-500 transition-colors",children:t?l.jsx("img",{src:t,alt:e,className:"w-full h-full object-cover"}):l.jsx(yi,{className:"w-12 h-12 text-gray-400"})}),!a&&l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"file",id:n,className:"hidden",accept:"image/*",onChange:r}),l.jsx("label",{htmlFor:n,className:"cursor-pointer bg-gray-600 text-white px-3 py-1 rounded-md hover:bg-gray-700 text-xs shadow-sm w-full text-center",children:"Upload"})]})]})),Fh=({mode:e,studentData:t,onSave:r,onCancel:n,onEdit:a})=>{const s=y.useRef(null),[i,o]=y.useState([]),[c,u]=y.useState([]),[d,f]=y.useState([]),[m,h]=y.useState([]),p=e==="view",g=localStorage.getItem("currentBranch"),b=e==="create"&&(g==="All"||g==="All Branches"),S=localStorage.getItem("currentLocation"),E=e==="create"&&(S==="All"||S==="All Locations"),P={admissionNo:"",first_name:"",last_name:"",gender:"",dob:"",Doa:"",BloodGroup:"",Adharcardno:"",Religion:"",phone:"",email:"",address:"",Category:"",class:"",section:"",Roll_Number:"",admission_date:"",status:"Active",MotherTongue:"",Caste:"",StudentType:"",House:"",StudentHeight:"",StudentWeight:"",SamagraId:"",ChildId:"",PEN:"",permanentCity:"",previousSchoolName:"",primaryIncomePerYear:"",secondaryIncomePerYear:"",primaryOfficeAddress:"",secondaryOfficeAddress:"",Hobbies:"",SecondLanguage:"",ThirdLanguage:"",GroupUniqueId:"",serviceNumber:"",EmploymentservingStatus:"",StudentStatus:"",ApaarId:"",Stream:"",EmploymentCategory:"",Fatherfirstname:"",FatherLastName:"",FatherPhone:"",SmsNo:"",FatherEmail:"",PrimaryQualification:"",FatherOccuption:"",FatherCompany:"",FatherDesignation:"",FatherAadhar:"",FatherOrganizationId:"",FatherOtherOrganization:"",Motherfirstname:"",MothermiddleName:"",Motherlastname:"",SecondaryPhone:"",SecondaryEmail:"",SecondaryQualification:"",SecondaryOccupation:"",SecondaryCompany:"",SecondaryDesignation:"",MotherAadhar:"",MotherOrganizationId:"",MotherOtherOrganization:"",GuardianName:"",GuardianRelation:"",GuardianQualification:"",GuardianOccupation:"",GuardianDesignation:"",GuardianDepartment:"",GuardianOfficeAddress:"",GuardianContactNo:"",AdmissionCategory:"",AdmissionClass:"",location:localStorage.getItem("location")||"",branch:localStorage.getItem("branch")||"",academic_year:localStorage.getItem("academicYear")||"",presentAddress:"",presentCity:"",presentPin:"",permanentAddress:"",permanentCity_ui:"",isSameAddress:!1,SchoolName:"",PreviousSchoolClass:"",TCNumber:"",PreviousAdmissionNumber:""},[N,I]=y.useState(P);t!=null&&t.branch,N.branch;const k=(H,J,G)=>{const Q=J.find(de=>de.branch_name===H);if(Q){const de=(Q.location_code||"").trim().toUpperCase(),V=G.find(Ee=>Ee.code.toUpperCase()===de);if(V)return V.name}return""},[T,q]=y.useState(null),[F,j]=y.useState(null),[U,B]=y.useState(null),[X,K]=y.useState(null),[ee,Y]=y.useState([]),[z,ne]=y.useState([]);y.useEffect(()=>{var H,J;if(t){console.log("CreateStudent received studentData:",t),console.log("Keys in studentData:",Object.keys(t));const G={...P};Object.keys(P).forEach(de=>{const V=t[de]??t[de.replace(/_/g,"")]??t[de.toLowerCase()]??G[de];G[de]=V,["Roll_Number","AdmissionCategory","StudentStatus","BloodGroup"].includes(de)&&console.log(`Mapping ${de}: studentData[${de}]=${t[de]}, Result=${V}`)});const Q=["Hyderabad","Mumbai","Bangalore"];if(G.location){const de=Q.find(V=>V.toLowerCase()===G.location.trim().toLowerCase());de&&(G.location=de)}G.admissionNo=t.admission_no??G.admissionNo,G.presentAddress=t.address??"",G.class=t.class??t.clazz??"",G.SchoolName=t.SchoolName||"",G.PreviousSchoolClass=t.PreviousSchoolClass||"",G.TCNumber=t.TCNumber||"",G.PreviousAdmissionNumber=t.AdmissionNumber||"",console.log("Mapped formData:",G),I(G),ne(t.documents||[]),B(((H=t.photos)==null?void 0:H.mother)||null),K(((J=t.photos)==null?void 0:J.guardian)||null),(t.student_id||t.id)&&ke.get(`/students/${t.student_id||t.id}/history`).then(de=>Y(de.data.history||[])).catch(console.error)}},[t]),y.useEffect(()=>{},[]),y.useEffect(()=>{ke.get("/classes").then(H=>{const J=H.data.classes||[];J.sort((G,Q)=>G.id-Q.id),o(J.map(G=>G.class_name))}).catch(H=>{console.error("Failed to load classes",H)}),Promise.all([ke.get("/branches"),ke.get("/org/locations"),ke.get("/org/academic-years")]).then(([H,J,G])=>{const Q=J.data.locations||[];f(Q);const de=G.data.academic_years||[];h(de);let V=[];if(H.data.branches&&(V=H.data.branches.map(Ee=>({branch_name:Ee.branch_name,location_code:Ee.location_code})),u(V)),e==="create"){const Ee=localStorage.getItem("currentBranch"),we=localStorage.getItem("user");let he="",Z="";if(we)try{const pe=JSON.parse(we);he=pe.role,Z=pe.branch}catch(pe){console.error("Error parsing user from localStorage",pe)}let Se="";const ge=Ee==="All"||Ee==="All Branches";if(he==="Admin"?Ee&&!ge&&(Se=Ee):Z&&(Se=Z),!Se&&!ge){const pe=localStorage.getItem("branch")||"";pe?Se=pe:V.length>0&&(Se=V[0].branch_name)}if(Se){const pe=k(Se,V,Q);let Ae=N.academic_year;const Le=localStorage.getItem("academicYear")||"",Pe=de.find(Oe=>Oe.name.replace(/\s/g,"")===Le.replace(/\s/g,""));Pe&&(Ae=Pe.name),I(Oe=>({...Oe,branch:Se,location:pe||Oe.location,academic_year:Ae}))}else ge&&I(pe=>({...pe,branch:"",location:"",academic_year:pe.academic_year||localStorage.getItem("academicYear")||""}))}}).catch(H=>console.error("Failed to load master data",H))},[e]);const le=y.useCallback(H=>{var de;const{name:J,value:G,type:Q}=H.target;if(!p){if(J==="branch"){const V=k(G,c,d);I(Ee=>({...Ee,[J]:G,location:V||Ee.location}));return}if(Q==="checkbox"){const V=H.target.checked;I(Ee=>{const we={...Ee,[J]:V};return J==="isSameAddress"&&(we.permanentAddress=V?Ee.presentAddress:"",we.permanentCity_ui=V?Ee.presentCity:"",we.permanentPin=V?Ee.presentPin:""),we});return}if(J==="Adharcardno"||J==="FatherAadhar"||J==="MotherAadhar"){const Ee=((de=G.replace(/\D/g,"").slice(0,12).match(/.{1,4}/g))==null?void 0:de.join("-"))||"";I(we=>({...we,[J]:Ee}));return}if(J==="presentPin"){const V=G.replace(/\D/g,"").slice(0,6);I(Ee=>({...Ee,presentPin:V}));return}if(J==="Roll_Number"){const V=G.replace(/\D/g,"");I(Ee=>({...Ee,Roll_Number:V}));return}if(J==="phone"||J==="FatherPhone"||J==="SecondaryPhone"||J==="SmsNo"||J==="GuardianContactNo"){let V=G;V.startsWith("+91 ")||(V="+91 "+V.replace(/\D/g,""));let Ee=V.replace("+91 ","").replace(/\D/g,"");Ee=Ee.slice(0,10);const we="+91 "+Ee;I(he=>({...he,[J]:we}));return}I(V=>({...V,[J]:G}))}},[p]),A=(H,J)=>{if(H.target.files&&H.target.files[0]){const G=new FileReader;G.onloadend=()=>J(G.result),G.readAsDataURL(H.target.files[0])}},D=()=>{I(P),q(null),j(null),B(null),K(null),ne([])},L=H=>{H.preventDefault(),D()},M=()=>({admission_no:N.admissionNo,first_name:N.first_name,last_name:N.last_name,gender:N.gender,dob:N.dob,Doa:N.Doa,BloodGroup:N.BloodGroup,Adharcardno:N.Adharcardno,Religion:N.Religion,phone:N.phone,email:N.email,address:N.presentAddress,Category:N.Category,class:N.class,section:N.section,Roll_Number:N.Roll_Number?Number(N.Roll_Number):null,admission_date:N.admission_date,status:N.status,MotherTongue:N.MotherTongue,Caste:N.Caste,StudentType:N.StudentType,House:N.House,Fatherfirstname:N.Fatherfirstname,FatherPhone:N.FatherPhone,SmsNo:N.SmsNo,FatherEmail:N.FatherEmail,PrimaryQualification:N.PrimaryQualification,FatherOccuption:N.FatherOccuption,FatherCompany:N.FatherCompany,FatherDesignation:N.FatherDesignation,FatherAadhar:N.FatherAadhar,FatherOrganizationId:N.FatherOrganizationId,FatherOtherOrganization:N.FatherOtherOrganization,Motherfirstname:N.Motherfirstname,MothermiddleName:N.MothermiddleName,Motherlastname:N.Motherlastname,SecondaryPhone:N.SecondaryPhone,SecondaryEmail:N.SecondaryEmail,SecondaryQualification:N.SecondaryQualification,SecondaryOccupation:N.SecondaryOccupation,SecondaryCompany:N.SecondaryCompany,SecondaryDesignation:N.SecondaryDesignation,MotherAadhar:N.MotherAadhar,MotherOrganizationId:N.MotherOrganizationId,MotherOtherOrganization:N.MotherOtherOrganization,GuardianName:N.GuardianName,GuardianRelation:N.GuardianRelation,GuardianQualification:N.GuardianQualification,GuardianOccupation:N.GuardianOccupation,GuardianDesignation:N.GuardianDesignation,GuardianDepartment:N.GuardianDepartment,GuardianOfficeAddress:N.GuardianOfficeAddress,GuardianContactNo:N.GuardianContactNo,AdmissionCategory:N.AdmissionCategory,AdmissionClass:N.AdmissionClass,StudentHeight:N.StudentHeight?Number(N.StudentHeight):null,StudentWeight:N.StudentWeight?Number(N.StudentWeight):null,SamagraId:N.SamagraId,ChildId:N.ChildId,PEN:N.PEN,permanentCity:N.permanentCity_id,previousSchoolName:N.previousSchoolName,primaryIncomePerYear:N.primaryIncomePerYear?Number(N.primaryIncomePerYear):null,secondaryIncomePerYear:N.secondaryIncomePerYear?Number(N.secondaryIncomePerYear):null,primaryOfficeAddress:N.primaryOfficeAddress,secondaryOfficeAddress:N.secondaryOfficeAddress,Hobbies:N.Hobbies,SecondLanguage:N.SecondLanguage,ThirdLanguage:N.ThirdLanguage,GroupUniqueId:N.GroupUniqueId,serviceNumber:N.serviceNumber,EmploymentservingStatus:N.EmploymentservingStatus,StudentStatus:N.StudentStatus,ApaarId:N.ApaarId,Stream:N.Stream,location:N.location,branch:N.branch,academic_year:N.academic_year,photos:{student:T,father:F,mother:U,guardian:X},documents:z,feeInstallments:N.feeInstallments,SchoolName:N.SchoolName,PreviousSchoolClass:N.PreviousSchoolClass,TCNumber:N.TCNumber,AdmissionNumber:N.PreviousAdmissionNumber}),R=async H=>{if(e==="create"&&(!N.first_name||!N.last_name||!N.admissionNo||!N.admission_date||!N.AdmissionCategory||!N.AdmissionClass||!N.branch||!N.academic_year||!N.class||!N.gender||!N.dob||!N.phone||!N.email||!N.Adharcardno||!N.section||!N.Fatherfirstname||!N.FatherPhone||!N.Motherfirstname)){alert("Fill required fields");return}const J=M();try{if(e==="create"){const G=await ke.post("/students",J);alert("Student created successfully!"),r&&r(G.data,H)}else if(e==="edit"){const G=(t==null?void 0:t.student_id)||(t==null?void 0:t.id);if(!G){alert("Error: Student ID is missing for update.");return}const Q=await ke.put(`/students/${G}`,J);alert("Student updated successfully!"),r&&r(Q.data.student,H)}}catch(G){console.error("Error saving student:",G),alert("Failed to save student.")}};return l.jsx("div",{className:"p-4 md:p-6 bg-gray-50 min-h-screen",children:l.jsx("form",{ref:s,id:"create-student-form",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4 bg-gray-100 p-4 -m-6 rounded-t-lg",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:e==="create"?"Create New Student":e==="edit"?"Edit Student":"Student Details"}),e==="view"&&l.jsx("button",{type:"button",onClick:a,className:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700 transition-colors text-sm font-medium",children:"Edit Student"})]}),l.jsxs("div",{className:"md:col-span-4 border p-4 rounded-md grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 bg-white",children:[l.jsxs(Nt,{label:"Class",name:"class",as:"select",required:!0,value:N.class,onChange:le,disabled:p,children:[l.jsx("option",{value:"",children:"-- Select --"}),i.map(H=>l.jsx("option",{value:H,children:H},H))]}),l.jsxs(Nt,{label:"Section",name:"section",as:"select",required:!0,value:N.section,onChange:le,disabled:p,children:[l.jsx("option",{value:"",children:"-- Select --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"})]}),l.jsx(Nt,{label:"Admission No",name:"admissionNo",required:!0,value:N.admissionNo,onChange:le,disabled:p}),l.jsx(Nt,{label:"Admission Date",name:"admission_date",type:"date",required:!0,value:N.admission_date,onChange:le,disabled:p}),l.jsx(Nt,{label:"Roll Number",name:"Roll_Number",type:"number",value:N.Roll_Number,onChange:le,disabled:p}),l.jsxs(Nt,{label:"Admission Category",name:"AdmissionCategory",as:"select",required:!0,value:N.AdmissionCategory,onChange:le,disabled:p,children:[l.jsx("option",{value:"",children:"-- Select --"}),l.jsx("option",{value:"Hifz",children:"Hifz"}),l.jsx("option",{value:"Nazira",children:"Hifz+Nazira"})]}),l.jsx(Nt,{label:"Admission Class",name:"AdmissionClass",value:N.AdmissionClass,required:!0,onChange:le,disabled:p||e==="edit"&&N.AdmissionClass}),l.jsxs(Nt,{label:"Location",name:"location",as:"select",value:N.location,onChange:le,disabled:p||!E,className:p||!E?"bg-gray-100 cursor-not-allowed":"",children:[l.jsx("option",{value:"",children:"-- Select --"}),d.map(H=>l.jsx("option",{value:H.name,children:H.name},H.code))]}),l.jsxs(Nt,{label:"Branch",name:"branch",as:"select",required:!0,value:N.branch,onChange:le,disabled:p||!b,className:p||!b?"bg-gray-100 cursor-not-allowed":"",children:[l.jsx("option",{value:"",children:"-- Select --"}),c.map(H=>l.jsx("option",{value:H.branch_name,children:H.branch_name},H.branch_name))]}),l.jsx(Nt,{label:"Academic Year",name:"academic_year",as:"select",value:N.academic_year,onChange:le,disabled:!0,className:"bg-gray-100 cursor-not-allowed",children:m.length>0?m.map(H=>l.jsx("option",{value:H.name,children:H.name},H.code)):l.jsx("option",{value:N.academic_year,children:N.academic_year})})]}),l.jsxs(Uc,{title:"Personal Details",defaultOpen:!0,children:[l.jsx(Nt,{label:"First Name",name:"first_name",required:!0,value:N.first_name,onChange:le,disabled:p}),l.jsx(Nt,{label:"Last Name",name:"last_name",required:!0,value:N.last_name,onChange:le,disabled:p}),l.jsxs(Nt,{label:"Gender",name:"gender",as:"select",required:!0,value:N.gender,onChange:le,disabled:p,children:[l.jsx("option",{value:"",children:"-- Select --"}),l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"})]}),l.jsx(Nt,{label:"Date of Birth",name:"dob",type:"date",required:!0,value:N.dob,onChange:le,disabled:p}),l.jsx(Nt,{label:"Blood Group",name:"BloodGroup",value:N.BloodGroup,onChange:le,disabled:p}),l.jsx(Nt,{label:"Aadhar Card No",name:"Adharcardno",required:!0,value:N.Adharcardno,onChange:le,disabled:p}),l.jsx(Nt,{label:"Religion",name:"Religion",value:N.Religion,onChange:le,disabled:p}),l.jsx(Nt,{label:"Mother Tongue",name:"MotherTongue",value:N.MotherTongue,onChange:le,disabled:p}),l.jsx(Nt,{label:"Caste",name:"Caste",value:N.Caste,onChange:le,disabled:p}),l.jsx(Nt,{label:"Category",name:"Category",value:N.Category,onChange:le,disabled:p}),l.jsx(Nt,{label:"Student Type",name:"StudentType",value:N.StudentType,onChange:le,disabled:p}),l.jsx(Nt,{label:"House",name:"House",value:N.House,onChange:le,disabled:p}),l.jsx(Nt,{label:"Height (cm)",name:"StudentHeight",type:"number",value:N.StudentHeight,onChange:le,disabled:p}),l.jsx(Nt,{label:"Weight (kg)",name:"StudentWeight",type:"number",value:N.StudentWeight,onChange:le,disabled:p}),l.jsx(Nt,{label:"Samagra ID",name:"SamagraId",value:N.SamagraId,onChange:le,disabled:p}),l.jsx(Nt,{label:"Child ID",name:"ChildId",value:N.ChildId,onChange:le,disabled:p}),l.jsx(Nt,{label:"PEN",name:"PEN",value:N.PEN,onChange:le,disabled:p})]}),l.jsxs(Uc,{title:"Contact Details",children:[l.jsx(Nt,{label:"Phone",name:"phone",required:!0,value:N.phone,onChange:le,disabled:p}),l.jsx(Nt,{label:"Email",name:"email",type:"email",required:!0,value:N.email,onChange:le,disabled:p}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(Nt,{label:"Present Address",name:"presentAddress",as:"textarea",value:N.presentAddress,onChange:le,disabled:p})}),l.jsx(Nt,{label:"Present City",name:"presentCity",value:N.presentCity,onChange:le,disabled:p}),l.jsx(Nt,{label:"Present Pin",name:"presentPin",value:N.presentPin,onChange:le,disabled:p}),l.jsx("div",{className:"md:col-span-4",children:l.jsx(Nt,{label:"Same as Present Address",name:"isSameAddress",type:"checkbox",checked:N.isSameAddress,onChange:le,disabled:p})}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(Nt,{label:"Permanent Address",name:"permanentAddress",as:"textarea",value:N.permanentAddress,onChange:le,disabled:p||N.isSameAddress})}),l.jsx(Nt,{label:"Permanent City",name:"permanentCity_ui",value:N.permanentCity_ui,onChange:le,disabled:p||N.isSameAddress})]}),l.jsxs(Uc,{title:"Parent Details",children:[l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-2 mb-2 border-b pb-1",children:"Father's Details"}),l.jsx(Nt,{label:"Father Name",name:"Fatherfirstname",required:!0,value:N.Fatherfirstname,onChange:le,disabled:p}),l.jsx(Nt,{label:"FatherPhone",name:"FatherPhone",required:!0,value:N.FatherPhone,onChange:le,disabled:p}),l.jsx(Nt,{label:"SMS No",name:"SmsNo",value:N.SmsNo,onChange:le,disabled:p}),l.jsx(Nt,{label:"Email",name:"FatherEmail",type:"email",value:N.FatherEmail,onChange:le,disabled:p}),l.jsx(Nt,{label:"Qualification",name:"PrimaryQualification",value:N.PrimaryQualification,onChange:le,disabled:p}),l.jsx(Nt,{label:"Occupation",name:"FatherOccuption",value:N.FatherOccuption,onChange:le,disabled:p}),l.jsx(Nt,{label:"Company",name:"FatherCompany",value:N.FatherCompany,onChange:le,disabled:p}),l.jsx(Nt,{label:"Designation",name:"FatherDesignation",value:N.FatherDesignation,onChange:le,disabled:p}),l.jsx(Nt,{label:"Aadhar No",name:"FatherAadhar",value:N.FatherAadhar,onChange:le,disabled:p}),l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-4 mb-2 border-b pb-1",children:"Mother's Details"}),l.jsx(Nt,{label:"Mother Name",name:"Motherfirstname",required:!0,value:N.Motherfirstname,onChange:le,disabled:p}),l.jsx(Nt,{label:"Phone",name:"SecondaryPhone",value:N.SecondaryPhone,onChange:le,disabled:p}),l.jsx(Nt,{label:"Email",name:"SecondaryEmail",type:"email",value:N.SecondaryEmail,onChange:le,disabled:p}),l.jsx(Nt,{label:"Qualification",name:"SecondaryQualification",value:N.SecondaryQualification,onChange:le,disabled:p}),l.jsx(Nt,{label:"Occupation",name:"SecondaryOccupation",value:N.SecondaryOccupation,onChange:le,disabled:p}),l.jsx(Nt,{label:"Company",name:"SecondaryCompany",value:N.SecondaryCompany,onChange:le,disabled:p}),l.jsx(Nt,{label:"Designation",name:"SecondaryDesignation",value:N.SecondaryDesignation,onChange:le,disabled:p}),l.jsx(Nt,{label:"Aadhar No",name:"MotherAadhar",value:N.MotherAadhar,onChange:le,disabled:p}),l.jsx("h4",{className:"md:col-span-4 font-medium text-gray-700 mt-4 mb-2 border-b pb-1",children:"Guardian's Details"}),l.jsx(Nt,{label:"Name",name:"GuardianName",value:N.GuardianName,onChange:le,disabled:p}),l.jsx(Nt,{label:"Relation",name:"GuardianRelation",value:N.GuardianRelation,onChange:le,disabled:p}),l.jsx(Nt,{label:"Phone",name:"GuardianContactNo",value:N.GuardianContactNo,onChange:le,disabled:p}),l.jsx(Nt,{label:"Qualification",name:"GuardianQualification",value:N.GuardianQualification,onChange:le,disabled:p}),l.jsx(Nt,{label:"Occupation",name:"GuardianOccupation",value:N.GuardianOccupation,onChange:le,disabled:p}),l.jsx(Nt,{label:"Office Address",name:"GuardianOfficeAddress",value:N.GuardianOfficeAddress,onChange:le,disabled:p})]}),l.jsxs(Uc,{title:"Previous School Details",children:[l.jsx(Nt,{label:"School Name",name:"SchoolName",value:N.SchoolName,onChange:le,disabled:p}),l.jsx(Nt,{label:"School Class",name:"PreviousSchoolClass",value:N.PreviousSchoolClass,onChange:le,disabled:p}),l.jsx(Nt,{label:"TC Number",name:"TCNumber",value:N.TCNumber,onChange:le,disabled:p}),l.jsx(Nt,{label:"Admission Number",name:"PreviousAdmissionNumber",value:N.PreviousAdmissionNumber,onChange:le,disabled:p})]}),l.jsx(Uc,{title:"Upload Photo",children:l.jsx("div",{className:"md:col-span-4 grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:l.jsx(Pce,{title:"Student Photo",photo:T,onPhotoChange:H=>A(H,q),id:"student-photo",isViewMode:p})})}),(e==="view"||e==="edit")&&ee.length>0&&l.jsx(Uc,{title:"Promotion History",defaultOpen:!0,children:l.jsx("div",{className:"md:col-span-4 overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200 border",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Academic Year"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Class"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Section"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Roll No"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Status"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-500",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(H=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:H.academic_year}),l.jsx("td",{className:"px-4 py-2",children:H.class}),l.jsx("td",{className:"px-4 py-2",children:H.section}),l.jsx("td",{className:"px-4 py-2",children:H.roll_no||"-"}),l.jsx("td",{className:"px-4 py-2",children:H.is_promoted?l.jsx("span",{className:"text-green-600 bg-green-50 px-2 py-0.5 rounded text-xs",children:"Promoted"}):l.jsx("span",{className:"text-gray-500 bg-gray-50 px-2 py-0.5 rounded text-xs",children:"Enrolled"})}),l.jsx("td",{className:"px-4 py-2 text-gray-500 text-xs",children:H.promoted_date?new Date(H.promoted_date).toLocaleDateString():H.created_at?new Date(H.created_at).toLocaleDateString():"-"})]},H.id))})]})})}),l.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t mt-6",children:[l.jsx("button",{type:"button",onClick:n,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:e==="view"?"Back":"Cancel"}),e!=="view"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",onClick:L,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Reset"}),l.jsx("button",{type:"button",onClick:()=>R(!1),className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500",children:"Save"}),l.jsx("button",{type:"button",onClick:()=>R(!0),className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Save & Exit"})]})]})]})})})},Oce=({onBack:e})=>{const[t,r]=y.useState(localStorage.getItem("academicYear")||""),[n,a]=y.useState(""),[s,i]=y.useState(""),[o,c]=y.useState([]),[u,d]=y.useState([]),[f,m]=y.useState(""),[h,p]=y.useState(""),[g,v]=y.useState(""),[b,S]=y.useState(""),[_,E]=y.useState([]),[P,N]=y.useState([]),[I,k]=y.useState([]),[T,q]=y.useState(!1),[F,j]=y.useState(!1),[U,B]=y.useState(!1);y.useEffect(()=>{ke.get("/classes").then(Y=>k(Y.data.classes||[])),ke.get("/org/academic-years").then(Y=>{var ne;const z=((ne=Y.data.academic_years)==null?void 0:ne.map(le=>le.name))||[];N(z)})},[]),y.useEffect(()=>{if(!t||!n)return;q(!0);const Y=localStorage.getItem("currentBranch")||"All";ke.get("/students",{params:{class:n,section:s,search:f,branch:Y},headers:{"X-Academic-Year":t}}).then(z=>c(z.data.students||[])).catch(z=>{var ne,le;console.error(z),alert("Error fetching source students: "+(((le=(ne=z.response)==null?void 0:ne.data)==null?void 0:le.error)||z.message))}).finally(()=>q(!1))},[t,n,s,f]),y.useEffect(()=>{if(!h||!g)return;j(!0);const Y=localStorage.getItem("currentBranch")||"All";ke.get("/students",{params:{class:g,section:b,branch:Y},headers:{"X-Academic-Year":h}}).then(z=>E(z.data.students||[])).catch(z=>console.error(z)).finally(()=>j(!1))},[h,g,b]);const X=Y=>{Y.target.checked?d(o.map(z=>z.student_id).filter(z=>z!==void 0)):d([])},K=Y=>{Y&&(u.includes(Y)?d(u.filter(z=>z!==Y)):d([...u,Y]))},ee=async()=>{if(u.length===0)return alert("Select students to upgrade");if(!h||!g)return alert("Select Target Year and Class");if(t===h)return alert("Source and Target Year cannot be same");if(confirm(`Promote ${u.length} students to Class ${g} (${h})?`)){B(!0);try{await ke.post("/students/promote-bulk",{student_ids:u,target_year:h,target_class:g,target_section:b}),alert("Students Promoted Successfully!"),c(ne=>ne.filter(le=>le.student_id===void 0||!u.includes(le.student_id))),d([]);const Y=localStorage.getItem("currentBranch")||"All",z=await ke.get("/students",{params:{class:g,section:b,branch:Y},headers:{"X-Academic-Year":h}});E(z.data.students||[])}catch(Y){console.error(Y),alert("Failed to promote students Please Check If students are already in targeted class and Academic Year")}finally{B(!1)}}};return l.jsxs("div",{className:"p-4 bg-gray-100 min-h-screen",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Bulk Student Upgrade"}),e&&l.jsx("button",{onClick:e,className:"text-sm bg-gray-200 px-3 py-1 rounded",children:"Back"})]}),l.jsxs("div",{className:"flex gap-4 h-[80vh]",children:[l.jsxs("div",{className:"flex-1 bg-white rounded shadow flex flex-col",children:[l.jsxs("div",{className:"p-3 border-b bg-indigo-50 rounded-t",children:[l.jsx("h3",{className:"font-semibold text-indigo-700",children:"Source (Current State)"}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("select",{value:t,onChange:Y=>r(Y.target.value),className:"border p-1 rounded text-sm w-1/3",children:P.map(Y=>l.jsx("option",{value:Y,children:Y},Y))}),l.jsxs("select",{value:n,onChange:Y=>a(Y.target.value),className:"border p-1 rounded text-sm w-1/3",children:[l.jsx("option",{value:"",children:"Select Class"}),I.map(Y=>l.jsx("option",{value:Y.class_name,children:Y.class_name},Y.id))]}),l.jsxs("select",{value:s,onChange:Y=>i(Y.target.value),className:"border p-1 rounded text-sm w-1/4",children:[l.jsx("option",{value:"",children:"All Sec"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]}),l.jsx("input",{placeholder:"Search Source Students...",className:"w-full border p-1 rounded text-sm mt-2",value:f,onChange:Y=>m(Y.target.value)})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[l.jsxs("h4",{className:"text-sm font-bold mb-2",children:[o.length," Students Found"]}),l.jsxs("table",{className:"w-full text-sm border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100 text-left",children:[l.jsx("th",{className:"p-2 border",children:l.jsx("input",{type:"checkbox",onChange:X,checked:o.length>0&&u.length===o.length})}),l.jsx("th",{className:"p-2 border",children:"Adm No"}),l.jsx("th",{className:"p-2 border",children:"Name"}),l.jsx("th",{className:"p-2 border",children:"Class"})]})}),l.jsx("tbody",{children:T?l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Loading..."})}):o.map(Y=>l.jsxs("tr",{className:"hover:bg-indigo-50",children:[l.jsx("td",{className:"p-2 border",children:l.jsx("input",{type:"checkbox",checked:Y.student_id?u.includes(Y.student_id):!1,onChange:()=>K(Y.student_id)})}),l.jsx("td",{className:"p-2 border",children:Y.admNo}),l.jsxs("td",{className:"p-2 border",children:[Y.first_name||Y.name," ",Y.last_name||""]}),l.jsxs("td",{className:"p-2 border",children:[Y.class," ",Y.section]})]},Y.student_id))})]})]})]}),l.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 w-32",children:[l.jsx("button",{onClick:ee,disabled:u.length===0||U,className:`px-4 py-8 rounded font-bold shadow-lg transform transition-all 
                            ${u.length>0&&!U?"bg-indigo-600 text-white hover:scale-105 hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}
                        `,children:U?"...":"Upgrade >>"}),l.jsxs("div",{className:"text-xs text-center text-gray-500",children:[u.length," Selected"]})]}),l.jsxs("div",{className:"flex-1 bg-white rounded shadow flex flex-col",children:[l.jsxs("div",{className:"p-3 border-b bg-green-50 rounded-t",children:[l.jsx("h3",{className:"font-semibold text-green-700",children:"Target (Promote To)"}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("select",{value:h,onChange:Y=>p(Y.target.value),className:"border p-1 rounded text-sm w-1/2",children:P.map(Y=>l.jsx("option",{value:Y,children:Y},Y))}),l.jsxs("select",{value:g,onChange:Y=>v(Y.target.value),className:"border p-1 rounded text-sm w-1/3",children:[l.jsx("option",{value:"",children:"Select Class"}),I.map(Y=>l.jsx("option",{value:Y.class_name,children:Y.class_name},Y.id))]}),l.jsxs("select",{value:b,onChange:Y=>S(Y.target.value),className:"border p-1 rounded text-sm w-1/4",children:[l.jsx("option",{value:"",children:"All Sec"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]})]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-2",children:[l.jsxs("h4",{className:"text-sm font-bold mb-2",children:[_.length," Students Already in Target"]}),l.jsxs("table",{className:"w-full text-sm border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100 text-left",children:[l.jsx("th",{className:"p-2 border",children:"Adm No"}),l.jsx("th",{className:"p-2 border",children:"Name"}),l.jsx("th",{className:"p-2 border",children:"Status"})]})}),l.jsxs("tbody",{children:[F?l.jsx("tr",{children:l.jsx("td",{colSpan:3,className:"p-4 text-center",children:"Loading..."})}):_.map(Y=>l.jsxs("tr",{children:[l.jsx("td",{className:"p-2 border",children:Y.admNo}),l.jsx("td",{className:"p-2 border",children:Y.first_name||Y.name}),l.jsx("td",{className:"p-2 border text-green-600",children:"Promoted"})]},Y.student_id)),_.length===0&&!F&&l.jsx("tr",{children:l.jsx("td",{colSpan:3,className:"p-4 text-center text-red-400",children:"No Records Found"})})]})]})]})]})]})]})},Fce=({onBack:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(!1),[s,i]=y.useState("All"),[o,c]=y.useState(null),[u,d]=y.useState(null),[f,m]=y.useState([]),[h,p]=y.useState(!1),[g,v]=y.useState(""),[b,S]=y.useState("summary"),_=f.filter(B=>B.gender==="Male").length,E=f.filter(B=>B.gender==="Female").length,P=()=>{const B=f.map((ee,Y)=>({"S.No":Y+1,"Roll No":ee.rollNo,"Admission No":ee.admNo,Name:ee.name,Gender:ee.gender,Class:ee.class,Section:ee.section,"Father Name":ee.father,"Phone Number":ee.fatherMobile,Status:ee.status})),X=rn.json_to_sheet(B),K=rn.book_new();rn.book_append_sheet(K,X,"Class Summary"),lp(K,`ClassSummary_${o||"All"}_${u||"All"}.xlsx`)},N=()=>{window.print()};y.useEffect(()=>{I()},[]),y.useEffect(()=>{o?k():m([])},[o,u,s,g]);const I=async()=>{try{a(!0);const B=localStorage.getItem("currentBranch"),X=await ke.get("/students/summary",{headers:{"X-Branch":B||"All"}});r(X.data),X.data.structure&&X.data.structure.length>0}catch(B){console.error("Failed to fetch summary",B)}finally{a(!1)}},k=async()=>{try{p(!0);const B=localStorage.getItem("currentBranch");let K=(await ke.get("/students",{params:{class:o,section:u,search:g,include_inactive:"true"},headers:{"X-Branch":B||"All"}})).data.students||[];s!=="All"&&(K=K.filter(ee=>ee.status===s)),m(K)}catch(B){console.error("Failed to fetch students",B)}finally{p(!1)}},T=t==null?void 0:t.structure.find(B=>B.name===o),q=f.length,F=()=>{if(!t)return l.jsx("div",{children:"Loading inputs..."});const B=["All","Active","Inactive","TC"];return l.jsxs("div",{className:"bg-white rounded-lg shadow h-full flex flex-col border border-gray-200 print:hidden",children:[l.jsxs("div",{className:"p-2 border-b bg-white",children:[l.jsx("div",{className:"relative mb-2",children:l.jsx("select",{className:"w-full border border-gray-300 rounded-md px-3 py-1.5 bg-white text-gray-700 font-medium focus:ring-2 focus:ring-blue-500 outline-none",value:s,onChange:X=>i(X.target.value),children:B.map(X=>l.jsx("option",{value:X,children:X},X))})}),l.jsx("div",{className:"grid grid-cols-1 border border-gray-200 rounded-md overflow-hidden text-sm",children:l.jsxs("div",{className:"flex justify-between p-2 bg-blue-600 text-white cursor-pointer",onClick:()=>i("All"),children:[l.jsx("span",{className:"font-semibold",children:"All"}),l.jsx("span",{className:"font-bold",children:t.stats.total})]})}),l.jsxs("div",{className:"grid grid-cols-1 border border-gray-200 mt-2 rounded-md overflow-hidden text-sm divide-y",children:[l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>i("Active"),children:[l.jsx("span",{children:"Active"}),l.jsx("span",{children:t.stats.by_status.Active||0})]}),l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>i("Inactive"),children:[l.jsx("span",{children:"Inactive"}),l.jsx("span",{children:t.stats.by_status.Inactive||0})]}),l.jsxs("div",{className:"flex justify-between px-3 py-2 bg-white hover:bg-gray-50 cursor-pointer text-gray-600",onClick:()=>i("TC"),children:[l.jsx("span",{children:"TC"}),l.jsx("span",{children:t.stats.by_status.TC||0})]})]})]}),l.jsxs("div",{className:"bg-gray-50 border-b px-3 py-2 flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wider",children:[l.jsx("span",{children:"Class"}),l.jsx("span",{children:"Total"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsx("table",{className:"w-full text-sm text-left",children:l.jsx("tbody",{className:"divide-y divide-gray-100",children:t.structure.map(X=>l.jsxs("tr",{onClick:()=>{c(X.name),d(null)},className:`cursor-pointer transition-colors ${o===X.name?"bg-blue-50":"hover:bg-gray-50"}`,children:[l.jsx("td",{className:`px-3 py-2.5 font-medium ${o===X.name?"text-blue-700":"text-gray-700"}`,children:X.name}),l.jsx("td",{className:`px-3 py-2.5 text-right font-semibold ${o===X.name?"text-blue-700":"text-blue-500"}`,children:X.count})]},X.name))})})})]})},j=()=>!o||!T?l.jsx("div",{className:"bg-white rounded-lg shadow h-full flex items-center justify-center text-gray-400 text-sm p-4 text-center border border-gray-200 print:hidden",children:l.jsx("span",{className:"italic",children:"Select Class"})}):l.jsxs("div",{className:"bg-white rounded-lg shadow h-full flex flex-col border border-green-100 print:hidden",children:[l.jsxs("div",{className:"p-3 border-b border-green-100 flex justify-between items-center text-green-700 bg-white",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{className:"font-bold text-lg",children:"Section"})]}),l.jsx("button",{className:"text-green-600 hover:text-green-800",title:"Refresh",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),l.jsxs("div",{className:"bg-gray-50 border-b px-3 py-2 flex justify-between text-xs font-bold text-gray-500 uppercase tracking-wider",children:[l.jsx("span",{children:"Total"}),l.jsx("span",{children:T.count})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 border-b hidden",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2",children:"Section"}),l.jsx("th",{className:"px-3 py-2 text-right",children:"Total"})]})}),l.jsxs("tbody",{className:"divide-y divide-green-50",children:[l.jsxs("tr",{onClick:()=>d(null),className:`cursor-pointer transition-colors ${u===null?"bg-green-100":"hover:bg-green-50"}`,children:[l.jsx("td",{className:"px-3 py-2.5 font-medium text-gray-700",children:"All"}),l.jsx("td",{className:"px-3 py-2.5 text-right text-gray-600",children:T.count})]}),T.sections.map(B=>l.jsxs("tr",{onClick:()=>d(B.name),className:`cursor-pointer transition-colors ${u===B.name?"bg-lime-100 border-l-4 border-lime-500":"hover:bg-green-50 border-l-4 border-transparent"}`,children:[l.jsx("td",{className:"px-3 py-2.5 font-semibold text-gray-700",children:B.name}),l.jsx("td",{className:"px-3 py-2.5 text-right text-blue-600 font-bold",children:B.count})]},B.name))]})]})})]}),U=()=>b==="create"?l.jsxs("div",{className:"bg-white rounded-lg shadow h-full p-4 overflow-y-auto",children:[l.jsx("button",{onClick:()=>S("summary"),className:"mb-4 text-sm text-blue-600 hover:underline",children:"← Back to List"}),l.jsx(Fh,{mode:"create",onSave:()=>{S("summary"),k(),I()},onCancel:()=>S("summary")})]}):l.jsx("div",{className:"h-full flex flex-col gap-4 print:h-auto print:block",children:l.jsxs("div",{className:"bg-white rounded-lg shadow flex-1 flex flex-col overflow-hidden print:shadow-none print:h-auto",children:[l.jsxs("div",{className:"p-3 bg-violet-50 border-b flex justify-between items-center flex-wrap gap-2 print:bg-white print:border-none",children:[l.jsxs("div",{className:"font-bold text-gray-800 text-lg flex items-center gap-2",children:[o||"All Classes"," ",u||"",l.jsxs("span",{className:"text-gray-500 font-normal text-base ml-2",children:["Records : ",q]})]}),l.jsxs("div",{className:"flex items-center gap-4 print:hidden",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[l.jsxs("div",{className:"px-3 py-1 bg-green-500 text-white rounded shadow-sm",children:["Males: ",_]}),l.jsxs("div",{className:"px-3 py-1 bg-orange-400 text-white rounded shadow-sm",children:["Females: ",E]})]}),l.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[l.jsx("button",{title:"Excel",onClick:P,className:"text-green-600 hover:text-green-800",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("button",{title:"PDF",onClick:N,className:"text-red-500 hover:text-red-700",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})})]}),l.jsx("div",{className:"relative",children:l.jsx("input",{className:"border border-purple-200 rounded-full px-4 py-1 text-sm w-48 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Search",value:g,onChange:B=>v(B.target.value)})})]})]}),l.jsx("div",{className:"flex-1 overflow-auto print:overflow-visible",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-500 font-semibold print:bg-white print:border-b-2 print:border-black",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left w-12 text-gray-700",children:"#"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Roll"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Class"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Adm.No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"PhoneNumber"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:h?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-500",children:"Loading students data..."})}):f.length===0?l.jsx("tr",{children:l.jsxs("td",{colSpan:7,className:"p-8 text-center text-gray-500 flex flex-col items-center",children:[l.jsx("span",{className:"text-lg",children:"No students found"}),l.jsx("span",{className:"text-xs",children:"Try adjusting filters or search"})]})}):f.map((B,X)=>{var K;return l.jsxs("tr",{className:"hover:bg-blue-50 group transition-colors",children:[l.jsx("td",{className:"px-4 py-3 font-mono text-gray-500",children:X+1}),l.jsx("td",{className:"px-4 py-3 text-gray-600 font-medium",children:B.rollNo||"-"}),l.jsx("td",{className:"px-4 py-3",children:B.status==="Active"?l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-orange-400 text-white text-xs font-bold",title:"Present/Active",children:"P"}):B.status==="Inactive"?l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-red-500 text-white text-xs font-bold",title:"Inactive",children:"I"}):l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded shadow-sm bg-green-500 text-white text-xs font-bold",title:B.status,children:(K=B.status)==null?void 0:K[0]})}),l.jsxs("td",{className:"px-4 py-3",children:[l.jsx("div",{className:"font-medium text-blue-600 group-hover:underline cursor-pointer",children:B.name}),B.status==="Inactive"&&l.jsx("div",{className:"text-xs text-red-500 mt-0.5",children:"(InActive)"})]}),l.jsxs("td",{className:"px-4 py-3 text-gray-700 font-semibold",children:[B.class," ",B.section]}),l.jsx("td",{className:"px-4 py-3 text-gray-600 font-mono text-xs",children:B.admNo}),l.jsx("td",{className:"px-4 py-3 text-gray-700",children:B.father}),l.jsx("td",{className:"px-4 py-3 text-gray-600 text-sm",children:B.fatherMobile})]},B.id)})})]})})]})});return l.jsxs("div",{className:"flex h-full gap-4 p-4 overflow-hidden bg-gray-100 print:bg-white print:p-0 print:h-auto print:overflow-visible",children:[l.jsx("div",{className:"w-1/5 min-w-[200px] flex-shrink-0 print:hidden",children:F()}),l.jsx("div",{className:"w-[15%] min-w-[150px] flex-shrink-0 print:hidden",children:j()}),l.jsx("div",{className:"flex-1 min-w-0 print:w-full",children:U()})]})},TA=({title:e,isOpen:t,onToggle:r,children:n})=>l.jsxs("div",{className:"relative inline-block text-left",children:[l.jsxs("button",{className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",onClick:r,children:[e,l.jsx(Al,{className:"ml-2 h-5 w-5"})]}),t&&l.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-20",children:l.jsx("div",{className:"py-1",children:n})})]}),Sh=({children:e,onClick:t})=>l.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),t==null||t()},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:e}),Ice=({activeView:e,setActiveView:t})=>{const[r,n]=y.useState(null),a=i=>n(r===i?null:i),s=i=>`px-3 py-2 text-sm rounded-md ${e===i?"bg-violet-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`;return l.jsx("div",{className:"bg-gray-50 p-3 border-b border-gray-300",children:l.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"STUDENTS"}),l.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[l.jsx("button",{className:s("students"),onClick:()=>t("students"),children:"Students"}),l.jsx("button",{className:s("addStudent"),onClick:()=>t("addStudent"),children:"Create Student"}),l.jsx("button",{className:s("search"),onClick:()=>t("search"),children:"Search"}),l.jsx("button",{className:s("summary"),onClick:()=>t("summary"),children:"Class Summary"}),l.jsxs(TA,{title:"Report",isOpen:r==="report",onToggle:()=>a("report"),children:[l.jsx(Sh,{children:"Custom Download"}),l.jsx(Sh,{children:"Pre-defined Download"})]}),l.jsxs(TA,{title:"Certificates",isOpen:r==="certs",onToggle:()=>a("certs"),children:[l.jsx(Sh,{children:"Student Certificate"}),l.jsx(Sh,{children:"Teacher Certificate"})]}),l.jsx("button",{className:s("upgrade"),onClick:()=>t("upgrade"),children:"Upgrade"})]})]})})},Lce=({onView:e,onEdit:t,setActiveView:r})=>{const[n,a]=y.useState([]),[s,i]=y.useState(!1),[o,c]=y.useState(!1),[u,d]=y.useState(""),[f,m]=y.useState(""),[h,p]=y.useState(""),[g,v]=y.useState(!1),[b,S]=y.useState([]),[_,E]=y.useState(!1),[P,N]=y.useState(""),[I,k]=y.useState(null),[T,q]=y.useState(!1),[F,j]=y.useState(null);y.useEffect(()=>{const z=localStorage.getItem("user");if(z){const ne=JSON.parse(z);v(ne.role==="Admin")}ke.get("/classes").then(ne=>S(ne.data.classes||[])).catch(()=>console.log("Failed loading classes")),U()},[]),y.useEffect(()=>{U()},[u,f,h,o]);const U=()=>{i(!0);const z=localStorage.getItem("currentBranch")||"";ke.get("/students",{params:{class:u||"",section:f||"",search:h||"",include_inactive:o?"true":"false",branch:z==="All"||z==="All Branches"?"All":z}}).then(ne=>a(ne.data.students||[])).catch(()=>a([])).finally(()=>i(!1))},B=z=>{k(z),N(""),E(!0)},X=async z=>{if(window.confirm(`Are you sure you want to Activate ${z.name}?`))try{await ke.put(`/students/${z.student_id||z.id}`,{status:"Active"}),alert("Student Activated successfully"),U()}catch(ne){console.error(ne),alert("Failed to activate student")}},K=async()=>{if(!P)return alert("Please enter password");try{if((await ke.post("/verify-any-password",{password:P})).data.success){const ne=I.student_id||I.id;await ke.delete(`/students/${ne}`),alert("Student marked as Inactive successfully"),E(!1),U()}else alert("Invalid Password")}catch(z){console.error(z),z.response&&z.response.data&&z.response.data.error?alert(z.response.data.error):alert("Error deleting student")}},ee=z=>{const ne=window.open("","","width=900,height=800");ne&&(ne.document.write(`
                     <html>
                         <head>
                            <title>Student Report - ${z.name}</title>
                            <style>
                                body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 40px; color: #333; }
                                h1 { text-align: center; color: #4c1d95; margin-bottom: 10px; }
                                h2 { border-bottom: 2px solid #4c1d95; padding-bottom: 5px; margin-top: 30px; color: #5b21b6; font-size: 18px; }
                                .header { text-align: center; margin-bottom: 40px; }
                                .photo-box { width: 120px; height: 120px; border: 1px solid #ddd; margin: 0 auto 10px; object-fit: cover; display: block; }
                                .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
                                .field { margin-bottom: 8px; }
                                .label { font-weight: bold; color: #555; width: 140px; display: inline-block; }
                                .value { color: #000; }
                                table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 14px; }
                                th { bg-color: #f3f4f6; }
                            </style>
                         </head>
                         <body>
                             <div class="header">
                                <img src="https://www.mshifzacademy.com/assets/images/ms-logo.jpg" style="max-width: 300px; height: auto; margin-bottom: 10px;" />
                                <p>Student Profile Report</p>
                             </div>

                             <img src="${z.photo||"https://via.placeholder.com/150"}" class="photo-box" />
                             <h2 style="text-align:center; border:none;">${z.name}</h2>
                             <p style="text-align:center;">${z.admNo} | Class: ${z.class} - ${z.section}</p>

                             <h2>Academic Details</h2>
                             <div class="grid">
                                <div>
                                    <div class="field"><span class="label">Admission No:</span> <span class="value">${z.admNo||"-"}</span></div>
                                    <div class="field"><span class="label">Roll No:</span> <span class="value">${z.rollNo||"-"}</span></div>
                                    <div class="field"><span class="label">Class:</span> <span class="value">${z.class||"-"}</span></div>
                                    <div class="field"><span class="label">Section:</span> <span class="value">${z.section||"-"}</span></div>
                                </div>
                                <div>
                                    <div class="field"><span class="label">Admission Date:</span> <span class="value">${z.admission_date||"-"}</span></div>
                                    <div class="field"><span class="label">Status:</span> <span class="value">${z.status||"-"}</span></div>
                                    <div class="field"><span class="label">Category:</span> <span class="value">${z.Category||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Personal Details</h2>
                             <div class="grid">
                                <div>
                                    <div class="field"><span class="label">First Name:</span> <span class="value">${z.first_name||"-"}</span></div>
                                    <div class="field"><span class="label">Last Name:</span> <span class="value">${z.last_name||"-"}</span></div>
                                    <div class="field"><span class="label">Gender:</span> <span class="value">${z.gender||"-"}</span></div>
                                    <div class="field"><span class="label">DOB:</span> <span class="value">${z.dob||"-"}</span></div>
                                    <div class="field"><span class="label">Blood Group:</span> <span class="value">${z.BloodGroup||"-"}</span></div>
                                </div>
                                <div>
                                    <div class="field"><span class="label">Aadhar No:</span> <span class="value">${z.Adharcardno||"-"}</span></div>
                                    <div class="field"><span class="label">Religion:</span> <span class="value">${z.Religion||"-"}</span></div>
                                    <div class="field"><span class="label">Caste:</span> <span class="value">${z.Caste||"-"}</span></div>
                                    <div class="field"><span class="label">Mother Tongue:</span> <span class="value">${z.MotherTongue||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Contact Info</h2>
                             <div class="field"><span class="label">Mobile:</span> <span class="value">${z.phone||"-"}</span></div>
                             <div class="field"><span class="label">Email:</span> <span class="value">${z.email||"-"}</span></div>
                             <div class="field"><span class="label">Address:</span> <span class="value">${z.address||"-"}</span></div>

                             <h2>Parent / Guardian Details</h2>
                             <div class="grid">
                                <div>
                                    <h3>Father</h3>
                                    <div class="field"><span class="label">Name:</span> <span class="value">${z.Fatherfirstname||"-"}</span></div>
                                    <div class="field"><span class="label">Phone:</span> <span class="value">${z.FatherPhone||"-"}</span></div>
                                    <div class="field"><span class="label">Occupation:</span> <span class="value">${z.FatherOccuption||"-"}</span></div>
                                </div>
                                <div>
                                    <h3>Mother</h3>
                                    <div class="field"><span class="label">Name:</span> <span class="value">${z.Motherfirstname||"-"}</span></div>
                                    <div class="field"><span class="label">Phone:</span> <span class="value">${z.SecondaryPhone||"-"}</span></div>
                                    <div class="field"><span class="label">Occupation:</span> <span class="value">${z.SecondaryOccupation||"-"}</span></div>
                                </div>
                             </div>

                             <h2>Previous School Details</h2>
                             <div class="grid">
                                <div class="field"><span class="label">School Name:</span> <span class="value">${z.SchoolName||"-"}</span></div>
                                <div class="field"><span class="label">Admission No:</span> <span class="value">${z.AdmissionNumber||"-"}</span></div>
                                <div class="field"><span class="label">TC No:</span> <span class="value">${z.TCNumber||"-"}</span></div>
                                <div class="field"><span class="label">Previous School Class:</span> <span class="value">${z.PreviousSchoolClass||"-"}</span></div>
                             </div>

                             <script>window.print();<\/script>
                         </body>
                     </html>
                 `),ne.document.close())},Y=()=>s?l.jsx("div",{className:"p-6 text-gray-600 text-center",children:"Loading..."}):n.length?l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full text-sm divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-violet-600 text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left",children:"Student Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Adm No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Roll No."}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Class"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Branch"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father/ Guardian Name"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Father Mobile"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Tools"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.map(z=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsxs("td",{className:"px-4 py-2 flex items-center gap-2",children:[l.jsx("img",{src:z.photo||"https://via.placeholder.com/32",className:"w-8 h-8 rounded-full object-cover border"}),l.jsx("span",{className:"font-medium text-blue-600",children:z.name})]}),l.jsx("td",{className:"px-4 py-2",children:z.admNo}),l.jsx("td",{className:"px-4 py-2",children:z.rollNo}),l.jsxs("td",{className:"px-4 py-2",children:[z.class," ",z.section]}),l.jsx("td",{className:"px-4 py-2",children:z.branch}),l.jsx("td",{className:"px-4 py-2",children:z.father}),l.jsx("td",{className:"px-4 py-2",children:z.fatherMobile}),l.jsx("td",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("button",{onClick:()=>e(z),className:"px-2 py-1 text-xs bg-indigo-100 text-indigo-700 rounded hover:bg-indigo-200 flex items-center gap-1",title:"Details",children:[l.jsx("span",{children:"ℹ️"})," Details"]}),l.jsxs("button",{onClick:()=>t(z),className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 flex items-center gap-1",title:"Edit",children:[l.jsx("span",{children:"✏️"})," Edit"]}),l.jsxs("button",{onClick:()=>ee(z),className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded hover:bg-orange-200 flex items-center gap-1",title:"Print",children:[l.jsx("span",{children:"🖨️"})," Print"]}),l.jsxs("button",{onClick:()=>B(z),className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 flex items-center gap-1",title:"Deactivate",children:[l.jsx("span",{children:"🚫"})," Inactivate"]}),z.status==="Inactive"&&l.jsxs("button",{onClick:()=>X(z),className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 flex items-center gap-1",title:"Activate",children:[l.jsx("span",{children:"✅"})," Activate"]})]})})]},z.admNo))})]})}):l.jsx("div",{className:"p-6 text-gray-600 text-center",children:"No students found"});return l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6",children:[l.jsxs("select",{value:u,onChange:z=>d(z.target.value),className:"border px-3 py-2 rounded-md",children:[l.jsx("option",{value:"",children:"-- All Classes --"}),Array.isArray(b)&&b.map(z=>l.jsx("option",{value:z.class_name,children:z.class_name},z.id))]}),l.jsxs("select",{value:f,onChange:z=>m(z.target.value),className:"border px-3 py-2 rounded-md",children:[l.jsx("option",{value:"",children:"-- All Sections --"}),l.jsx("option",{value:"A",children:"A"}),l.jsx("option",{value:"B",children:"B"}),l.jsx("option",{value:"C",children:"C"})]}),l.jsxs("div",{className:"md:col-span-2 relative",children:[l.jsx("input",{className:"border px-3 py-2 w-full rounded-md pl-10",placeholder:"Search by Name, Adm No...",value:h,onChange:z=>p(z.target.value)}),l.jsx(lj,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),l.jsx("button",{onClick:U,className:"bg-violet-600 text-white px-4 py-2 rounded-md",children:"Search"}),l.jsx("div",{className:"flex items-center",children:l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:o,onChange:z=>c(z.target.checked),className:"h-4 w-4 text-violet-600 focus:ring-violet-500 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Show Inactive"})]})})]}),Y(),_&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[l.jsx("h3",{className:"text-lg font-bold mb-4",children:"Confirm Deactivation"}),l.jsxs("p",{className:"mb-4 text-gray-600",children:["Enter your password to mark ",l.jsx("b",{children:I==null?void 0:I.name})," as Inactive."]}),l.jsx("input",{type:"password",className:"w-full border p-2 rounded mb-4",placeholder:"Password",value:P,onChange:z=>N(z.target.value)}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:K,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Deactivate"})]})]})})]})},Dce=({navigateTo:e})=>{const[t,r]=y.useState("students"),[n,a]=y.useState(null),s=()=>{switch(t){case"students":return l.jsx(Lce,{onView:i=>{a(i),r("viewStudent")},onEdit:i=>{a(i),r("editStudent")},setActiveView:r});case"addStudent":return l.jsx(Fh,{mode:"create",onSave:()=>r("students"),onCancel:()=>r("students")});case"viewStudent":return l.jsx(Fh,{mode:"view",studentData:n,onCancel:()=>r("students"),onEdit:()=>r("editStudent")});case"editStudent":return l.jsx(Fh,{mode:"edit",studentData:n,onSave:()=>r("students"),onCancel:()=>r("students")});case"import":return l.jsx(Tce,{onImportSuccess:()=>r("students")});case"upgrade":return l.jsx(Oce,{onBack:()=>r("students")});case"summary":return l.jsx(Fce,{onBack:()=>r("students")});default:return l.jsx(pj,{pageTitle:"Coming Soon"})}};return l.jsxs("div",{className:"h-full bg-gray-100 overflow-y-auto",children:[l.jsx(Ice,{activeView:t,setActiveView:r}),s()]})},Mce=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState(""),[i,o]=y.useState(""),[c,u]=y.useState(localStorage.getItem("academicYear")||""),[d,f]=y.useState("All"),[m,h]=y.useState(!0),[p,g]=y.useState(!1),[v,b]=y.useState(""),[S,_]=y.useState({}),[E,P]=y.useState(!1),[N,I]=y.useState(""),[k,T]=y.useState(""),[q,F]=y.useState(!1),[j,U]=y.useState(""),[B,X]=y.useState([]),[K,ee]=y.useState(""),[Y,z]=y.useState(new Set),[ne,le]=y.useState(!1),[A,D]=y.useState(!1),L=y.useRef(null);y.useEffect(()=>{function Z(Se){L.current&&!L.current.contains(Se.target)&&le(!1)}return document.addEventListener("mousedown",Z),()=>{document.removeEventListener("mousedown",Z)}},[]),y.useEffect(()=>{const Z=JSON.parse(localStorage.getItem("user")||"{}"),Se=Z.role!=="Admin";let ge="All";Se&&Z.branch?ge=Z.branch:ge=localStorage.getItem("currentBranch")||"All",f(ge),ge!=="All"&&ge!=="All Branches"&&ke.get("/branches").then(pe=>{const Ae=pe.data.branches||[],Le=Ae.map(Oe=>({id:Oe.id,name:Oe.branch_name,location_name:Oe.location_name||"Unknown Location"}));X(Le);const Pe=Ae.find(Oe=>Oe.branch_name.toLowerCase()===ge.toLowerCase());Pe&&ee(Pe.id)}).catch(pe=>console.error("Error fetching branch info:",pe)),M(),R()},[]);const M=async()=>{try{const Z=await ke.get("/fee-types");t(Z.data.fee_types),H(Z.data.fee_types)}catch(Z){console.error("Error fetching fee types:",Z)}},R=async()=>{try{const Z=await ke.get("/concessions"),Se=localStorage.getItem("currentBranch")||"All",ge=JSON.parse(localStorage.getItem("user")||"{}"),pe=Z.data.concessions;let Ae=pe;ge.role==="Admin"?Ae=Se==="All"||Se==="All Branches"?pe:pe.filter(Le=>Le.branch===Se||Le.branch==="All"):Ae=pe,n(Ae)}catch(Z){console.error("Error fetching concessions:",Z)}},H=Z=>{const Se={};Z.forEach(ge=>{Se[ge.id]=0}),_(Se),_(Se)},J=Z=>{const Se=new Set(Y);Se.has(Z)?Se.delete(Z):Se.add(Z),z(Se)},G=async()=>{var Z,Se;if(Y.size===0){alert("Please select at least one branch to copy to.");return}if(confirm(`Are you sure you want to copy all concessions to ${Y.size} branches? Duplicates will be skipped.`)){D(!0);try{await ke.post("/fees/copy-concessions",{source_branch_id:K,target_branch_ids:Array.from(Y),academic_year:c}),alert("Concessions copied successfully!"),z(new Set),le(!1)}catch(ge){console.error("Copy failed",ge),alert(((Se=(Z=ge.response)==null?void 0:Z.data)==null?void 0:Se.error)||"Failed to copy concessions.")}finally{D(!1)}}},Q=()=>{if(!v)return;const Z=parseFloat(v);if(isNaN(Z))return;const Se={...S};e.forEach(ge=>{Se[ge.id]=Z}),_(Se)},de=(Z,Se)=>{const ge=parseFloat(Se)||0;_(pe=>({...pe,[Z]:ge}))},V=Z=>{s(Z.title),o(Z.description||""),u(Z.academic_year),f(Z.branch||"All"),h(Z.is_percentage),g(Z.show_in_payment||!1);const Se={};e.forEach(ge=>Se[ge.id]=0),Z.items.forEach(ge=>{Se[ge.fee_type_id]=ge.percentage}),_(Se),P(!0),I(Z.title),T(Z.academic_year),window.scrollTo({top:0,behavior:"smooth"}),U("Editing mode enabled. Make changes and click Update.")},Ee=async(Z,Se)=>{if(window.confirm(`Are you sure you want to delete "${Z}" for ${Se}?`))try{await ke.delete(`/concessions/${Z}/${Se}`),U("Concession deleted successfully"),R()}catch(ge){console.error("Error deleting concession:",ge),alert("Student record exist for this concession,Cannot delete")}},we=async()=>{var Z,Se;if(!a||!c){alert("Please fill Title and Academic Year");return}F(!0),U("");try{const ge=Object.keys(S).map(Ae=>({fee_type_id:parseInt(Ae),percentage:S[parseInt(Ae)]})),pe={title:a,description:i,academic_year:c,branch:d,is_percentage:m,show_in_payment:p,items:ge};E?(await ke.put(`/concessions/${N}/${k}`,pe),U("Concession updated successfully!")):(await ke.post("/concessions",pe),U("Concession created successfully!")),he(),R()}catch(ge){console.error("Error saving concession:",ge),U(`Error: ${((Se=(Z=ge.response)==null?void 0:Z.data)==null?void 0:Se.error)||ge.message}`)}finally{F(!1)}},he=()=>{s(""),o(""),b(""),u(localStorage.getItem("academicYear")||"");const Z=JSON.parse(localStorage.getItem("user")||"{}");Z.role!=="Admin"&&Z.branch?f(Z.branch):f(localStorage.getItem("currentBranch")||"All"),g(!1),P(!1),I(""),T(""),H(e)};return l.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-md border p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6 border-b pb-4",children:[l.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:E?"Edit Concession Type":"Add Concession Type"})]}),B.length>0&&K&&l.jsxs("div",{className:"flex justify-end mb-4 relative",ref:L,children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center gap-2 shadow-sm bottom-10",onClick:()=>le(!ne),children:[l.jsx("span",{children:"Copy to Branches"}),l.jsx("span",{className:"text-xs",children:"▼"})]}),ne&&l.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-white border shadow-xl rounded z-50 p-2 max-h-96 overflow-y-auto",children:[l.jsx("div",{className:"mb-2 text-sm font-semibold text-gray-700 pb-2 border-b px-2",children:"Select Target Branches"}),(()=>{const Z=B.filter(ge=>String(ge.id)!==String(K)&&ge.name!=="All Branches"&&ge.name!=="All"),Se={};return Z.forEach(ge=>{Se[ge.location_name]||(Se[ge.location_name]=[]),Se[ge.location_name].push(ge)}),Object.keys(Se).length===0?l.jsx("div",{className:"text-gray-500 text-sm p-4 text-center",children:"No other branches available"}):Object.keys(Se).map(ge=>l.jsxs("div",{className:"mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-gray-900 px-3 py-2 bg-gray-50 border-b border-gray-100",children:ge}),l.jsx("div",{className:"py-1",children:Se[ge].map(pe=>l.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors pl-6",children:[l.jsx("input",{type:"checkbox",checked:Y.has(String(pe.id)),onChange:()=>J(String(pe.id)),className:"w-4 h-4 accent-blue-600 rounded border-gray-300"}),l.jsx("span",{className:"text-sm text-gray-700",children:pe.name})]},pe.id))})]},ge))})(),l.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center sticky bottom-0 bg-white p-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:[Y.size," selected"]}),l.jsx("button",{onClick:G,disabled:A||Y.size===0,className:`px-3 py-1 text-xs text-white rounded ${A||Y.size===0?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:A?"Copying...":"Confirm Copy"})]})]})]}),l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title*"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-violet-500 focus:border-violet-500",value:a,onChange:Z=>s(Z.target.value),placeholder:"e.g. Sibling Discount"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-violet-500 focus:border-violet-500",value:i,onChange:Z=>o(Z.target.value)})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-100 cursor-not-allowed",value:c,readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch"}),l.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-100 cursor-not-allowed",value:d,readOnly:!0})]})]}),l.jsxs("div",{className:"flex items-center justify-between bg-pink-50 p-4 rounded-md border border-pink-100",children:[l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-violet-600 rounded",checked:m,onChange:Z=>h(Z.target.checked)}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Is Concession in percentage?"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-3 py-2 w-40",placeholder:"Enter Percentage",value:v,onChange:Z=>b(Z.target.value),disabled:!m}),l.jsx("button",{onClick:Q,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 font-medium",children:"Copy"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx("input",{type:"checkbox",id:"showInPayment",className:"form-checkbox h-5 w-5 text-violet-600 rounded",checked:p,onChange:Z=>g(Z.target.checked)}),l.jsx("label",{htmlFor:"showInPayment",className:"text-gray-700 font-medium cursor-pointer",children:"Show in Fee Payment Dropdown?"})]})]}),l.jsx("div",{className:"border rounded-md overflow-hidden mb-6",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:l.jsx("input",{type:"checkbox",className:"rounded"})}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Concession Percentage"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(Z=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"checkbox",className:"rounded"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Z.fee_type}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("input",{type:"number",className:"border border-gray-300 rounded-md px-3 py-1 w-full focus:ring-violet-500 focus:border-violet-500",value:S[Z.id]||0,onChange:Se=>de(Z.id,Se.target.value)})})]},Z.id))})]})}),j&&l.jsx("div",{className:`p-4 mb-4 rounded-md ${j.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:j}),l.jsxs("div",{className:"flex justify-end space-x-3 border-t pt-4",children:[l.jsx("button",{onClick:he,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:E?"Cancel Edit":"Reset"}),l.jsx("button",{onClick:we,disabled:q,className:"px-6 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 disabled:opacity-50",children:q?"Saving...":E?"Update Concession":"Save Concession"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md border p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Existing Concessions"}),r.length===0?l.jsx("p",{className:"text-gray-500 text-center py-4",children:"No concessions found."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academic Year"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Show in Payment"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((Z,Se)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:Z.title}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:Z.academic_year}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${!Z.branch||Z.branch==="All"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Z.branch||"All"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:Z.show_in_payment?l.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Yes"}):l.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:"No"})}),l.jsx("td",{className:"px-6 py-4 text-gray-500",children:Z.description}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>V(Z),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),l.jsx("button",{onClick:()=>Ee(Z.title,Z.academic_year),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},Se))})]})})]})]})})},Rce=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState([]),[i,o]=y.useState([]),[c,u]=y.useState(""),[d,f]=y.useState(""),[m,h]=y.useState(null),[p,g]=y.useState(""),[v,b]=y.useState(""),[S,_]=y.useState(!1),[E,P]=y.useState([]),[N,I]=y.useState([]),[k,T]=y.useState({}),[q,F]=y.useState(!1),[j,U]=y.useState("");y.useEffect(()=>{B(),X();const ne=localStorage.getItem("user");if(ne){const le=JSON.parse(ne);_(le.role==="Admin")}},[]);const B=async()=>{try{const le=(await ke.get("/classes")).data.classes.map(A=>String(A.class_name));t([...new Set(le)])}catch(ne){console.error("Error fetching classes:",ne)}},X=async()=>{try{const ne=await ke.get("/concessions"),le=localStorage.getItem("academicYear")||"",A=ne.data.concessions.filter(D=>D.academic_year===le);o(A)}catch(ne){console.error("Error fetching concessions:",ne)}};y.useEffect(()=>{if(!c){n([]);return}(async()=>{try{const le=new URLSearchParams;le.append("class",c);const A=localStorage.getItem("currentBranch")||"All",D=A==="All Branches"||A==="All"?"All":A;le.append("branch",D);const M=(await ke.get(`/students?${le}`)).data,H=(Array.isArray(M)?M:M.students||[]).map(G=>G.section),J=[...new Set(H.filter(Boolean))].sort();n(J)}catch(le){console.error("Error fetching sections:",le)}})()},[c]),y.useEffect(()=>{(async()=>{try{const le=new URLSearchParams;c&&le.append("class",c),d&&le.append("section",d),v&&le.append("search",v);const A=localStorage.getItem("currentBranch")||"All",D=A==="All Branches"||A==="All"?"All":A;le.append("branch",D);const M=(await ke.get(`/students?${le}`)).data;s(Array.isArray(M)?M:M.students||[])}catch(le){console.error("Error fetching students:",le)}})()},[c,d,v]),y.useEffect(()=>{if(!m){P([]);return}(async()=>{try{const le=await ke.get(`/fees/student-details/${m}`);P(le.data.installments||[]),I([]),T({})}catch(le){console.error("Error fetching installments:",le)}})()},[m]),y.useEffect(()=>{if(!p||E.length===0){T({});return}const ne=i.find(A=>A.title===p);if(!ne)return;const le={};E.forEach(A=>{if(!A.student_fee_id)return;const D=ne.items.find(L=>L.fee_type_id===A.fee_type_id);if(D){const L=A.payable;let M=0;ne.is_percentage?M=L*(D.percentage/100):M=Math.min(L,D.percentage),le[A.student_fee_id]=Math.round(M)}}),T(le)},[p,E]);const K=ne=>{I(le=>le.includes(ne)?le.filter(A=>A!==ne):[...le,ne])},ee=ne=>{if(ne.target.checked){const le=E.filter(A=>{const D=A.student_fee_id&&k[A.student_fee_id]!==void 0,L=(A.paidAmount||0)>0,M=(A.concession||0)>0;return D&&!L&&!M}).map(A=>A.student_fee_id);I(le)}else I([])},Y=async()=>{var ne,le;if(!m||!p||N.length===0){alert("Please select a student, a concession, and at least one installment.");return}if(window.confirm(`Assign concession to ${N.length} installments? This will update the fee records.`)){F(!0);try{const A=i.find(L=>L.title===p);await ke.post("/fees/assign-concession",{student_id:m,concession_title:p,academic_year:(A==null?void 0:A.academic_year)||localStorage.getItem("academicYear")||"",installments:N}),U("Concession assigned successfully!");const D=await ke.get(`/fees/student-details/${m}`);P(D.data.installments||[]),I([])}catch(A){console.error("Error assigning concession:",A),U(`Error: ${((le=(ne=A.response)==null?void 0:ne.data)==null?void 0:le.error)||A.message}`)}finally{F(!1)}}},z=i.find(ne=>ne.title===p);return l.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[l.jsx("span",{className:"text-violet-600 mr-2",children:"₹"})," Student Concession"]}),l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border grid grid-cols-1 md:grid-cols-5 gap-4",children:[l.jsx("input",{type:"text",placeholder:"Search Admission No...",className:"border p-2 rounded",value:v,onChange:ne=>b(ne.target.value)}),l.jsxs("select",{className:"border p-2 rounded",value:c,onChange:ne=>{u(ne.target.value),f("")},children:[l.jsx("option",{value:"",children:"Select Class"}),e.map(ne=>l.jsx("option",{value:ne,children:ne},ne))]}),l.jsxs("select",{className:"border p-2 rounded",value:d,onChange:ne=>f(ne.target.value),children:[l.jsx("option",{value:"",children:"Select Section"}),r.map(ne=>l.jsx("option",{value:ne,children:ne},ne))]}),l.jsxs("select",{className:"border p-2 rounded",value:m||"",onChange:ne=>h(Number(ne.target.value)||null),children:[l.jsx("option",{value:"",children:"Select Student"}),a.map(ne=>l.jsxs("option",{value:ne.student_id,children:[ne.name," (",ne.admNo,")"]},ne.student_id))]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Concession Template"}),l.jsxs("select",{className:"w-full border p-2 rounded focus:ring-violet-500 focus:border-violet-500",value:p,onChange:ne=>g(ne.target.value),children:[l.jsx("option",{value:"",children:"-- Select Concession --"}),i.map((ne,le)=>l.jsx("option",{value:ne.title,children:ne.title},le))]})]}),z&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Concession Rules"}),l.jsx("div",{className:"border rounded overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Fee Type"}),l.jsxs("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:["Value (",z.is_percentage?"%":"₹",")"]})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.items.map((ne,le)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-3 py-2 text-gray-900",children:ne.fee_type_name}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ne.percentage})]},le))})]})})]})]}),l.jsxs("div",{className:"lg:col-span-2 bg-white p-4 rounded-lg shadow border",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-800",children:"Student Installments"}),j&&l.jsx("span",{className:`text-sm ${j.includes("Error")?"text-red-600":"text-green-600"}`,children:j})]}),E.length===0?l.jsx("p",{className:"text-gray-500 text-center py-8",children:"Select a student to view installments."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 w-10",children:l.jsx("input",{type:"checkbox",onChange:ee})}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Installment"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Total Fee"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Paid"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Current Concession"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-violet-600",children:"New Concession"}),l.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-500",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(ne=>{const le=ne.student_fee_id?k[ne.student_fee_id]:void 0,A=le!==void 0,D=(ne.paidAmount||0)>0,L=(ne.concession||0)>0,M=D||L;let R="";return D?R="Cannot apply concession to paid/partial fees":L&&(R="Fee already has a concession"),l.jsxs("tr",{className:A?"bg-violet-50":"",children:[l.jsx("td",{className:"px-3 py-2 text-center",title:R,children:l.jsx("input",{type:"checkbox",checked:ne.student_fee_id?N.includes(ne.student_fee_id):!1,onChange:()=>ne.student_fee_id&&!M&&K(ne.student_fee_id),disabled:!A||M})}),l.jsxs("td",{className:"px-3 py-2 text-gray-900",children:[ne.title,M&&l.jsxs("span",{className:"ml-2 text-xs text-red-500",children:["(",D?"Paid":"Has Concession",")"]})]}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ne.payable}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ne.paidAmount||0}),l.jsx("td",{className:"px-3 py-2 text-right text-gray-900",children:ne.concession||0}),l.jsx("td",{className:"px-3 py-2 text-right font-bold text-violet-600",children:A&&!M?le:"-"}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ne.paid?"bg-green-100 text-green-800":(ne.paidAmount||0)>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ne.paid?"Paid":(ne.paidAmount||0)>0?"Partial":"Pending"})})]},ne.sr)})})]})}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx("button",{onClick:Y,disabled:q||N.length===0,className:"bg-violet-600 text-white px-6 py-2 rounded shadow hover:bg-violet-700 disabled:opacity-50",children:q?"Assigning...":"Assign Concession"})})]})]})]})})},Bce=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,s]=y.useState(""),[i,o]=y.useState(null),[c,u]=y.useState([]),[d,f]=y.useState([]),[m,h]=y.useState([]),[p,g]=y.useState([]),[v,b]=y.useState(!1),[S,_]=y.useState(null),[E,P]=y.useState(!1);y.useEffect(()=>{const B=JSON.parse(localStorage.getItem("user")||"{}");P(B.role==="Admin"),N(),I()},[]),y.useEffect(()=>{(r||e)&&k()},[r,a,e]),y.useEffect(()=>{i?T():f([])},[i]);const N=async()=>{try{const X=(await ke.get("/classes")).data.classes.map(K=>K.class_name);h(X)}catch(B){console.error("Error fetching classes:",B)}},I=async()=>{try{const B=await ke.get("/fee-types");g(B.data.fee_types||[])}catch(B){console.error("Error fetching fee types:",B)}},k=async()=>{try{const B=new URLSearchParams;r&&B.append("class",r),a&&B.append("section",a),e&&B.append("search",e);const X=JSON.parse(localStorage.getItem("user")||"{}");let K=localStorage.getItem("currentBranch")||"All";X.role!=="Admin"&&X.branch&&(K=X.branch);const ee=K==="All Branches"||K==="All"?"All":K;B.append("branch",ee);const Y=await ke.get(`/fees/students?${B.toString()}`);u(Array.isArray(Y.data)?Y.data:Y.data.students||[])}catch(B){console.error("Error fetching students:",B)}},T=async()=>{if(i)try{const B=await ke.get(`/fees/student-details/${i}`);f(B.data.installments||[])}catch(B){console.error("Error fetching installments:",B)}},q=async(B,X,K)=>{var ee,Y;try{await ke.put(`/fees/student-fee/${B}`,{total_fee:X,concession:K}),T(),_(null),alert("Fee updated successfully")}catch(z){alert(((Y=(ee=z.response)==null?void 0:ee.data)==null?void 0:Y.error)||"Failed to update fee")}},F=async B=>{var X,K;if(window.confirm("Are you sure you want to delete this fee?"))try{await ke.delete(`/fees/student-fee/${B}`),T(),alert("Fee deleted successfully")}catch(ee){alert(((K=(X=ee.response)==null?void 0:X.data)==null?void 0:K.error)||"Failed to delete fee")}},j=async(B,X,K)=>{var ee,Y;if(i)try{await ke.post("/fees/student-fee/add",{student_id:i,fee_type_id:B,amount:X,month:K}),T(),b(!1),alert("Fee added successfully")}catch(z){alert(((Y=(ee=z.response)==null?void 0:ee.data)==null?void 0:Y.error)||"Failed to add fee")}},U=c.find(B=>B.student_id===i);return l.jsxs("div",{className:"container-fluid mx-auto p-4 bg-gray-50 min-h-screen",children:[l.jsxs("div",{className:"bg-indigo-50 border-l-4 border-indigo-500 p-4 mb-6 flex justify-between items-center rounded-r shadow-sm",children:[l.jsx("div",{className:"flex items-center",children:l.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[l.jsx("span",{children:"📋"})," Update student fee structure"]})}),l.jsxs("div",{className:"flex gap-2 items-center",children:[(()=>{const B=JSON.parse(localStorage.getItem("user")||"{}"),K=B.role!=="Admin"&&B.branch?B.branch:localStorage.getItem("currentBranch")||"All";return l.jsx("input",{type:"text",value:K,readOnly:!0,className:"border rounded px-2 py-1 text-sm outline-none bg-gray-100 cursor-not-allowed w-32 focus:ring-2 ring-indigo-300",title:"Current Branch"})})(),l.jsx("input",{type:"text",placeholder:"Search Name/AdmNo",value:e,onChange:B=>t(B.target.value),className:"border rounded px-3 py-1 text-sm outline-none w-40 focus:ring-2 ring-indigo-300"}),l.jsxs("select",{value:r,onChange:B=>n(B.target.value),className:"border rounded px-2 py-1 text-sm outline-none w-24 focus:ring-2 ring-indigo-300",children:[l.jsx("option",{value:"",children:"Class"}),m.map(B=>l.jsx("option",{value:B,children:B},B))]}),l.jsxs("select",{value:i||"",onChange:B=>o(Number(B.target.value)||null),className:"border rounded px-2 py-1 text-sm outline-none w-64 focus:ring-2 ring-indigo-300",children:[l.jsx("option",{value:"",children:"Select Student"}),c.map(B=>l.jsxs("option",{value:B.student_id,children:[B.name," (",B.admNo,")"]},B.student_id))]})]})]}),i?l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:["Fee Installments for ",l.jsx("span",{className:"text-indigo-600 font-bold",children:U==null?void 0:U.name})]}),d.length===0?l.jsx("div",{className:"text-center py-10 text-gray-500",children:"No installments found for this student."}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:d.map(B=>l.jsx(Uce,{installment:B,onEdit:()=>_(B),onDelete:()=>F(B.student_fee_id)},B.sr))})]}):l.jsx("div",{className:"text-center py-20 text-gray-400",children:"Please select a student to view and update fee structure."}),S&&l.jsx(zce,{fee:S,onClose:()=>_(null),onSave:q}),v&&l.jsx($ce,{feeTypes:p,onClose:()=>b(!1),onSave:j})]})},Uce=({installment:e,onEdit:t,onDelete:r})=>{const n=e.status==="Paid",a=e.status==="Partial",s=n?"bg-green-600 text-white":"bg-orange-500 text-white",i=n?"bg-green-50":"bg-orange-50";return l.jsxs("div",{className:"bg-white rounded shadow-sm border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:`px-4 py-2 flex justify-between items-center ${i}`,children:[l.jsx("span",{className:"font-semibold text-gray-700 text-sm",children:e.title}),l.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s}`,children:e.status})]}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tuition Fee"}),l.jsx("span",{className:"text-sm font-bold text-gray-800",children:e.payable})]}),l.jsxs("div",{className:"text-xs text-gray-500 text-right mb-2",children:[e.payable," - ",e.concession," = ",e.payable-e.concession]}),l.jsxs("div",{className:"border-t pt-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs text-gray-400",children:"Total"}),l.jsxs("span",{className:"font-bold text-gray-800",children:["₹ ",e.payable-e.concession]})]}),!n&&l.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[l.jsx("button",{onClick:t,className:"p-1.5 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",title:"Edit",children:l.jsx(av,{className:"w-4 h-4"})}),e.paidAmount===0&&l.jsx("button",{onClick:r,className:"p-1.5 bg-red-100 text-red-600 rounded hover:bg-red-200",title:"Delete",children:l.jsx(fj,{className:"w-4 h-4"})})]})]})]})},zce=({fee:e,onClose:t,onSave:r})=>{const[n,a]=y.useState(e.payable),[s,i]=y.useState(e.concession);return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[l.jsxs("h3",{className:"text-lg font-bold mb-4",children:["Edit Fee: ",e.title]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Total Amount"}),l.jsx("input",{type:"number",value:n,onChange:o=>a(parseFloat(o.target.value)||0),className:"w-full border rounded px-3 py-2",disabled:e.paidAmount>0}),e.paidAmount>0&&l.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Cannot change total amount for partially paid fees."})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Concession"}),l.jsx("input",{type:"number",value:s,onChange:o=>i(parseFloat(o.target.value)||0),className:"w-full border rounded px-3 py-2"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:()=>r(e.student_fee_id,n,s),className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Save"})]})]})})},$ce=({feeTypes:e,onClose:t,onSave:r})=>{const[n,a]=y.useState(""),[s,i]=y.useState(""),[o,c]=y.useState("One-Time"),u=["January","February","March","April","May","June","July","August","September","October","November","December","One-Time"];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:l.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[l.jsx("h3",{className:"text-lg font-bold mb-4",children:"Add Student Fee"}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Fee Type"}),l.jsxs("select",{value:n,onChange:d=>a(Number(d.target.value)),className:"w-full border rounded px-3 py-2",children:[l.jsx("option",{value:"",children:"Select Fee Type"}),e.map(d=>l.jsx("option",{value:d.id,children:d.fee_type},d.id))]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Month / Label"}),l.jsx("select",{value:o,onChange:d=>c(d.target.value),className:"w-full border rounded px-3 py-2",children:u.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Amount"}),l.jsx("input",{type:"number",value:s,onChange:d=>i(parseFloat(d.target.value)),className:"w-full border rounded px-3 py-2"})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:()=>n&&s&&r(n,s,o),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:!n||!s,children:"Add"})]})]})})},Wce="modulepreload",Hce=function(e){return"/"+e},PA={},jy=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let i=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=i(r.map(u=>{if(u=Hce(u),u in PA)return;PA[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Wce,d||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((h,p)=>{m.addEventListener("load",h),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};function yr(e){"@babel/helpers - typeof";return yr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(e)}var wa=Uint8Array,ls=Uint16Array,Lw=Int32Array,tg=new wa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rg=new wa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ky=new wa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A8=function(e,t){for(var r=new ls(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new Lw(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},j8=A8(tg,2),k8=j8.b,Cy=j8.r;k8[28]=258,Cy[258]=28;var C8=A8(rg,0),qce=C8.b,OA=C8.r,Ey=new ls(32768);for(var Ir=0;Ir<32768;++Ir){var Do=(Ir&43690)>>1|(Ir&21845)<<1;Do=(Do&52428)>>2|(Do&13107)<<2,Do=(Do&61680)>>4|(Do&3855)<<4,Ey[Ir]=((Do&65280)>>8|(Do&255)<<8)>>1}var Ni=(function(e,t,r){for(var n=e.length,a=0,s=new ls(t);a<n;++a)e[a]&&++s[e[a]-1];var i=new ls(t);for(a=1;a<t;++a)i[a]=i[a-1]+s[a-1]<<1;var o;if(r){o=new ls(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],d=t-e[a],f=i[e[a]-1]++<<d,m=f|(1<<d)-1;f<=m;++f)o[Ey[f]>>c]=u}else for(o=new ls(n),a=0;a<n;++a)e[a]&&(o[a]=Ey[i[e[a]-1]++]>>15-e[a]);return o}),tl=new wa(288);for(var Ir=0;Ir<144;++Ir)tl[Ir]=8;for(var Ir=144;Ir<256;++Ir)tl[Ir]=9;for(var Ir=256;Ir<280;++Ir)tl[Ir]=7;for(var Ir=280;Ir<288;++Ir)tl[Ir]=8;var vf=new wa(32);for(var Ir=0;Ir<32;++Ir)vf[Ir]=5;var Gce=Ni(tl,9,0),Vce=Ni(tl,9,1),Yce=Ni(vf,5,0),Kce=Ni(vf,5,1),H1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},qs=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},q1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Dw=function(e){return(e+7)/8|0},E8=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new wa(e.subarray(t,r))},Xce=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Vs=function(e,t,r){var n=new Error(t||Xce[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Vs),!r)throw n;return n},Jce=function(e,t,r,n){var a=e.length,s=0;if(!a||t.f&&!t.l)return r||new wa(0);var i=!r,o=i||t.i!=2,c=t.i;i&&(r=new wa(a*3));var u=function(de){var V=r.length;if(de>V){var Ee=new wa(Math.max(V*2,de));Ee.set(r),r=Ee}},d=t.f||0,f=t.p||0,m=t.b||0,h=t.l,p=t.d,g=t.m,v=t.n,b=a*8;do{if(!h){d=qs(e,f,1);var S=qs(e,f+1,3);if(f+=3,S)if(S==1)h=Vce,p=Kce,g=9,v=5;else if(S==2){var N=qs(e,f,31)+257,I=qs(e,f+10,15)+4,k=N+qs(e,f+5,31)+1;f+=14;for(var T=new wa(k),q=new wa(19),F=0;F<I;++F)q[ky[F]]=qs(e,f+F*3,7);f+=I*3;for(var j=H1(q),U=(1<<j)-1,B=Ni(q,j,1),F=0;F<k;){var X=B[qs(e,f,U)];f+=X&15;var _=X>>4;if(_<16)T[F++]=_;else{var K=0,ee=0;for(_==16?(ee=3+qs(e,f,3),f+=2,K=T[F-1]):_==17?(ee=3+qs(e,f,7),f+=3):_==18&&(ee=11+qs(e,f,127),f+=7);ee--;)T[F++]=K}}var Y=T.subarray(0,N),z=T.subarray(N);g=H1(Y),v=H1(z),h=Ni(Y,g,1),p=Ni(z,v,1)}else Vs(1);else{var _=Dw(f)+4,E=e[_-4]|e[_-3]<<8,P=_+E;if(P>a){c&&Vs(0);break}o&&u(m+E),r.set(e.subarray(_,P),m),t.b=m+=E,t.p=f=P*8,t.f=d;continue}if(f>b){c&&Vs(0);break}}o&&u(m+131072);for(var ne=(1<<g)-1,le=(1<<v)-1,A=f;;A=f){var K=h[q1(e,f)&ne],D=K>>4;if(f+=K&15,f>b){c&&Vs(0);break}if(K||Vs(2),D<256)r[m++]=D;else if(D==256){A=f,h=null;break}else{var L=D-254;if(D>264){var F=D-257,M=tg[F];L=qs(e,f,(1<<M)-1)+k8[F],f+=M}var R=p[q1(e,f)&le],H=R>>4;R||Vs(3),f+=R&15;var z=qce[H];if(H>3){var M=rg[H];z+=q1(e,f)&(1<<M)-1,f+=M}if(f>b){c&&Vs(0);break}o&&u(m+131072);var J=m+L;if(m<z){var G=s-z,Q=Math.min(z,J);for(G+m<0&&Vs(3);m<Q;++m)r[m]=n[G+m]}for(;m<J;++m)r[m]=r[m-z]}}t.l=h,t.p=A,t.b=m,t.f=d,h&&(d=1,t.m=g,t.d=p,t.n=v)}while(!d);return m!=r.length&&i?E8(r,0,m):r.subarray(0,m)},zi=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Sd=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},G1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,s=r.slice();if(!a)return{t:P8,l:0};if(a==1){var i=new wa(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(P,N){return P.f-N.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=a-1;)o=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var m=s[0].s,n=1;n<a;++n)s[n].s>m&&(m=s[n].s);var h=new ls(m+1),p=Ty(r[d-1],h,0);if(p>t){var n=0,g=0,v=p-t,b=1<<v;for(s.sort(function(N,I){return h[I.s]-h[N.s]||N.f-I.f});n<a;++n){var S=s[n].s;if(h[S]>t)g+=b-(1<<p-h[S]),h[S]=t;else break}for(g>>=v;g>0;){var _=s[n].s;h[_]<t?g-=1<<t-h[_]++-1:++n}for(;n>=0&&g;--n){var E=s[n].s;h[E]==t&&(--h[E],++g)}p=t}return{t:new wa(h),l:p}},Ty=function(e,t,r){return e.s==-1?Math.max(Ty(e.l,t,r+1),Ty(e.r,t,r+1)):t[e.s]=r},FA=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ls(++t),n=0,a=e[0],s=1,i=function(c){r[n++]=c},o=1;o<=t;++o)if(e[o]==a&&o!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(a),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(a);s=1,a=e[o]}return{c:r.subarray(0,n),n:t}},_d=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},T8=function(e,t,r){var n=r.length,a=Dw(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var s=0;s<n;++s)e[a+s+4]=r[s];return(a+4+n)*8},IA=function(e,t,r,n,a,s,i,o,c,u,d){zi(t,d++,r),++a[256];for(var f=G1(a,15),m=f.t,h=f.l,p=G1(s,15),g=p.t,v=p.l,b=FA(m),S=b.c,_=b.n,E=FA(g),P=E.c,N=E.n,I=new ls(19),k=0;k<S.length;++k)++I[S[k]&31];for(var k=0;k<P.length;++k)++I[P[k]&31];for(var T=G1(I,7),q=T.t,F=T.l,j=19;j>4&&!q[ky[j-1]];--j);var U=u+5<<3,B=_d(a,tl)+_d(s,vf)+i,X=_d(a,m)+_d(s,g)+i+14+3*j+_d(I,q)+2*I[16]+3*I[17]+7*I[18];if(c>=0&&U<=B&&U<=X)return T8(t,d,e.subarray(c,c+u));var K,ee,Y,z;if(zi(t,d,1+(X<B)),d+=2,X<B){K=Ni(m,h,0),ee=m,Y=Ni(g,v,0),z=g;var ne=Ni(q,F,0);zi(t,d,_-257),zi(t,d+5,N-1),zi(t,d+10,j-4),d+=14;for(var k=0;k<j;++k)zi(t,d+3*k,q[ky[k]]);d+=3*j;for(var le=[S,P],A=0;A<2;++A)for(var D=le[A],k=0;k<D.length;++k){var L=D[k]&31;zi(t,d,ne[L]),d+=q[L],L>15&&(zi(t,d,D[k]>>5&127),d+=D[k]>>12)}}else K=Gce,ee=tl,Y=Yce,z=vf;for(var k=0;k<o;++k){var M=n[k];if(M>255){var L=M>>18&31;Sd(t,d,K[L+257]),d+=ee[L+257],L>7&&(zi(t,d,M>>23&31),d+=tg[L]);var R=M&31;Sd(t,d,Y[R]),d+=z[R],R>3&&(Sd(t,d,M>>5&8191),d+=rg[R])}else Sd(t,d,K[M]),d+=ee[M]}return Sd(t,d,K[256]),d+ee[256]},Zce=new Lw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),P8=new wa(0),Qce=function(e,t,r,n,a,s){var i=s.z||e.length,o=new wa(n+i+5*(1+Math.ceil(i/7e3))+a),c=o.subarray(n,o.length-a),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=Zce[t-1],m=f>>13,h=f&8191,p=(1<<r)-1,g=s.p||new ls(32768),v=s.h||new ls(p+1),b=Math.ceil(r/3),S=2*b,_=function(we){return(e[we]^e[we+1]<<b^e[we+2]<<S)&p},E=new Lw(25e3),P=new ls(288),N=new ls(32),I=0,k=0,T=s.i||0,q=0,F=s.w||0,j=0;T+2<i;++T){var U=_(T),B=T&32767,X=v[U];if(g[B]=X,v[U]=B,F<=T){var K=i-T;if((I>7e3||q>24576)&&(K>423||!u)){d=IA(e,c,0,E,P,N,k,q,j,T-j,d),q=I=k=0,j=T;for(var ee=0;ee<286;++ee)P[ee]=0;for(var ee=0;ee<30;++ee)N[ee]=0}var Y=2,z=0,ne=h,le=B-X&32767;if(K>2&&U==_(T-le))for(var A=Math.min(m,K)-1,D=Math.min(32767,T),L=Math.min(258,K);le<=D&&--ne&&B!=X;){if(e[T+Y]==e[T+Y-le]){for(var M=0;M<L&&e[T+M]==e[T+M-le];++M);if(M>Y){if(Y=M,z=le,M>A)break;for(var R=Math.min(le,M-2),H=0,ee=0;ee<R;++ee){var J=T-le+ee&32767,G=g[J],Q=J-G&32767;Q>H&&(H=Q,X=J)}}}B=X,X=g[B],le+=B-X&32767}if(z){E[q++]=268435456|Cy[Y]<<18|OA[z];var de=Cy[Y]&31,V=OA[z]&31;k+=tg[de]+rg[V],++P[257+de],++N[V],F=T+Y,++I}else E[q++]=e[T],++P[e[T]]}}for(T=Math.max(T,F);T<i;++T)E[q++]=e[T],++P[e[T]];d=IA(e,c,u,E,P,N,k,q,j,T-j,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=v,s.p=g,s.i=T,s.w=F)}else{for(var T=s.w||0;T<i+u;T+=65535){var Ee=T+65535;Ee>=i&&(c[d/8|0]=u,Ee=i),d=T8(c,d+1,e.subarray(T,Ee))}s.i=i}return E8(o,0,n+Dw(d)+a)},O8=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,s=r.length|0,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)a+=n+=r[i];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},eue=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new wa(s.length+e.length);i.set(s),i.set(e,s.length),e=i,a.w=s.length}return Qce(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},F8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},tue=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=O8();a.p(t.dictionary),F8(e,2,a.d())}},rue=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Vs(6,"invalid zlib data"),(e[1]>>5&1)==1&&Vs(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Py(e,t){t||(t={});var r=O8();r.p(e);var n=eue(e,t,t.dictionary?6:2,4);return tue(n,t),F8(n,n.length-4,r.d()),n}function nue(e,t){return Jce(e.subarray(rue(e),-4),{i:2},t,t)}var aue=typeof TextDecoder<"u"&&new TextDecoder,sue=0;try{aue.decode(P8,{stream:!0}),sue=1}catch{}var Dt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function V1(){Dt.console&&typeof Dt.console.log=="function"&&Dt.console.log.apply(Dt.console,arguments)}var jr={log:V1,warn:function(e){Dt.console&&(typeof Dt.console.warn=="function"?Dt.console.warn.apply(Dt.console,arguments):V1.call(null,arguments))},error:function(e){Dt.console&&(typeof Dt.console.error=="function"?Dt.console.error.apply(Dt.console,arguments):V1(e))}};function Y1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Sl(n.response,t,r)},n.onerror=function(){jr.error("could not download file")},n.send()}function LA(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function _h(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Bd,Oy,Sl=Dt.saveAs||((typeof window>"u"?"undefined":yr(window))!=="object"||window!==Dt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Dt.URL||Dt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?LA(a.href)?Y1(e,t,r):_h(a,a.target="_blank"):_h(a)):(a.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(a.href)}),4e4),setTimeout((function(){_h(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(LA(e))Y1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout((function(){_h(n)}))}else navigator.msSaveOrOpenBlob((function(a,s){return s===void 0?s={autoBom:!1}:yr(s)!=="object"&&(jr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a})(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Y1(e,t,r);var a=e.type==="application/octet-stream",s=/constructor/i.test(Dt.HTMLElement)||Dt.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&s)&&(typeof FileReader>"u"?"undefined":yr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=i?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},o.readAsDataURL(e)}else{var c=Dt.URL||Dt.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout((function(){c.revokeObjectURL(u)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function I8(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,i=a.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+o+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function K1(e,t){var r=e[0],n=e[1],a=e[2],s=e[3];r=da(r,n,a,s,t[0],7,-680876936),s=da(s,r,n,a,t[1],12,-389564586),a=da(a,s,r,n,t[2],17,606105819),n=da(n,a,s,r,t[3],22,-1044525330),r=da(r,n,a,s,t[4],7,-176418897),s=da(s,r,n,a,t[5],12,1200080426),a=da(a,s,r,n,t[6],17,-1473231341),n=da(n,a,s,r,t[7],22,-45705983),r=da(r,n,a,s,t[8],7,1770035416),s=da(s,r,n,a,t[9],12,-1958414417),a=da(a,s,r,n,t[10],17,-42063),n=da(n,a,s,r,t[11],22,-1990404162),r=da(r,n,a,s,t[12],7,1804603682),s=da(s,r,n,a,t[13],12,-40341101),a=da(a,s,r,n,t[14],17,-1502002290),r=fa(r,n=da(n,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=fa(s,r,n,a,t[6],9,-1069501632),a=fa(a,s,r,n,t[11],14,643717713),n=fa(n,a,s,r,t[0],20,-373897302),r=fa(r,n,a,s,t[5],5,-701558691),s=fa(s,r,n,a,t[10],9,38016083),a=fa(a,s,r,n,t[15],14,-660478335),n=fa(n,a,s,r,t[4],20,-405537848),r=fa(r,n,a,s,t[9],5,568446438),s=fa(s,r,n,a,t[14],9,-1019803690),a=fa(a,s,r,n,t[3],14,-187363961),n=fa(n,a,s,r,t[8],20,1163531501),r=fa(r,n,a,s,t[13],5,-1444681467),s=fa(s,r,n,a,t[2],9,-51403784),a=fa(a,s,r,n,t[7],14,1735328473),r=ha(r,n=fa(n,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=ha(s,r,n,a,t[8],11,-2022574463),a=ha(a,s,r,n,t[11],16,1839030562),n=ha(n,a,s,r,t[14],23,-35309556),r=ha(r,n,a,s,t[1],4,-1530992060),s=ha(s,r,n,a,t[4],11,1272893353),a=ha(a,s,r,n,t[7],16,-155497632),n=ha(n,a,s,r,t[10],23,-1094730640),r=ha(r,n,a,s,t[13],4,681279174),s=ha(s,r,n,a,t[0],11,-358537222),a=ha(a,s,r,n,t[3],16,-722521979),n=ha(n,a,s,r,t[6],23,76029189),r=ha(r,n,a,s,t[9],4,-640364487),s=ha(s,r,n,a,t[12],11,-421815835),a=ha(a,s,r,n,t[15],16,530742520),r=ma(r,n=ha(n,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=ma(s,r,n,a,t[7],10,1126891415),a=ma(a,s,r,n,t[14],15,-1416354905),n=ma(n,a,s,r,t[5],21,-57434055),r=ma(r,n,a,s,t[12],6,1700485571),s=ma(s,r,n,a,t[3],10,-1894986606),a=ma(a,s,r,n,t[10],15,-1051523),n=ma(n,a,s,r,t[1],21,-2054922799),r=ma(r,n,a,s,t[8],6,1873313359),s=ma(s,r,n,a,t[15],10,-30611744),a=ma(a,s,r,n,t[6],15,-1560198380),n=ma(n,a,s,r,t[13],21,1309151649),r=ma(r,n,a,s,t[4],6,-145523070),s=ma(s,r,n,a,t[11],10,-1120210379),a=ma(a,s,r,n,t[2],15,718787259),n=ma(n,a,s,r,t[9],21,-343485551),e[0]=Ho(r,e[0]),e[1]=Ho(n,e[1]),e[2]=Ho(a,e[2]),e[3]=Ho(s,e[3])}function ng(e,t,r,n,a,s){return t=Ho(Ho(t,e),Ho(n,s)),Ho(t<<a|t>>>32-a,r)}function da(e,t,r,n,a,s,i){return ng(t&r|~t&n,e,t,a,s,i)}function fa(e,t,r,n,a,s,i){return ng(t&n|r&~n,e,t,a,s,i)}function ha(e,t,r,n,a,s,i){return ng(t^r^n,e,t,a,s,i)}function ma(e,t,r,n,a,s,i){return ng(r^(t|~n),e,t,a,s,i)}function L8(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)K1(n,iue(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(K1(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,K1(n,a),n}function iue(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Bd=Dt.atob.bind(Dt),Oy=Dt.btoa.bind(Dt);var DA="0123456789abcdef".split("");function oue(e){for(var t="",r=0;r<4;r++)t+=DA[e>>8*r+4&15]+DA[e>>8*r&15];return t}function lue(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Fy(e){return L8(e).map(lue).join("")}var cue=(function(e){for(var t=0;t<e.length;t++)e[t]=oue(e[t]);return e.join("")})(L8("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ho(e,t){if(cue){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Iy(e,t){var r,n,a,s;if(e!==r){for(var i=(a=e,s=1+(256/e.length>>0),new Array(s+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var u=0;for(c=0;c<256;c++){var d=o[c];u=(u+d+i.charCodeAt(c))%256,o[c]=o[u],o[u]=d}r=e,n=o}else o=n;var f=t.length,m=0,h=0,p="";for(c=0;c<f;c++)h=(h+(d=o[m=(m+1)%256]))%256,o[m]=o[h],o[h]=d,i=o[(o[m]+o[h])%256],p+=String.fromCharCode(t.charCodeAt(c)^i);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var MA={print:4,modify:8,copy:16,"annot-forms":32};function qc(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach((function(o){if(MA.perm!==void 0)throw new Error("Invalid permission: "+o);a+=MA[o]})),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^a)),this.encryptionKey=Fy(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Iy(this.encryptionKey,this.padding)}function Gc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function RA(e){if(yr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[r]){var i=t[r][s];try{i[0].apply(e,n)}catch(o){Dt.console&&jr.error("jsPDF PubSub Error",o.message,o)}i[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Ym(e){if(!(this instanceof Ym))return new Ym(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function D8(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Nl(e,t,r,n,a){if(!(this instanceof Nl))return new Nl(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,D8.call(this,n,a)}function Xc(e,t,r,n,a){if(!(this instanceof Xc))return new Xc(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,D8.call(this,n,a)}function Ft(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],i=[],o=1,c=16,u="S",d=null;yr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),i=e.filters||(s===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=RA;var p="1.3",g=h.__private__.getPdfVersion=function(){return p};h.__private__.setPdfVersion=function(C){p=C};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return v};var b=h.__private__.getPageFormat=function(C){return v[C]};a=a||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},_=S.COMPAT;function E(){this.saveGraphicsState(),Z(new xt(rt,0,0,-rt,0,_o()*rt).toString()+" cm"),this.setFontSize(this.getFontSize()/rt),u="n",_=S.ADVANCED}function P(){this.restoreGraphicsState(),u="S",_=S.COMPAT}var N=h.__private__.combineFontStyleAndFontWeight=function(C,re){if(C=="bold"&&re=="normal"||C=="bold"&&re==400||C=="normal"&&re=="italic"||C=="bold"&&re=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return re&&(C=re==400||re==="normal"?C==="italic"?"italic":"normal":re!=700&&re!=="bold"||C!=="normal"?(re==700?"bold":re)+""+C:"bold"),C};h.advancedAPI=function(C){var re=_===S.COMPAT;return re&&E.call(this),typeof C!="function"||(C(this),re&&P.call(this)),this},h.compatAPI=function(C){var re=_===S.ADVANCED;return re&&P.call(this),typeof C!="function"||(C(this),re&&E.call(this)),this},h.isAdvancedAPI=function(){return _===S.ADVANCED};var I,k=function(C){if(_!==S.ADVANCED)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=h.roundToPrecision=h.__private__.roundToPrecision=function(C,re){var be=t||re;if(isNaN(C)||isNaN(be))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(be).replace(/0+$/,"")};I=h.hpf=h.__private__.hpf=typeof c=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return T(C,c)}:c==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return T(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return T(C,16)};var q=h.f2=h.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return T(C,2)},F=h.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return T(C,3)},j=h.scale=h.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return _===S.COMPAT?C*rt:_===S.ADVANCED?C:void 0},U=function(C){return _===S.COMPAT?_o()-C:_===S.ADVANCED?C:void 0},B=function(C){return j(U(C))};h.__private__.setPrecision=h.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(t=parseInt(C,10))};var X,K="00000000000000000000000000000000",ee=h.__private__.getFileId=function(){return K},Y=h.__private__.setFileId=function(C){return K=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():K.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),d!==null&&(la=new qc(d.userPermissions,d.userPassword,d.ownerPassword,K)),K};h.setFileId=function(C){return Y(C),this},h.getFileId=function(){return ee()};var z=h.__private__.convertDateToPDFDate=function(C){var re=C.getTimezoneOffset(),be=re<0?"+":"-",_e=Math.floor(Math.abs(re/60)),Fe=Math.abs(re%60),qe=[be,L(_e),"'",L(Fe),"'"].join("");return["D:",C.getFullYear(),L(C.getMonth()+1),L(C.getDate()),L(C.getHours()),L(C.getMinutes()),L(C.getSeconds()),qe].join("")},ne=h.__private__.convertPDFDateToDate=function(C){var re=parseInt(C.substr(2,4),10),be=parseInt(C.substr(6,2),10)-1,_e=parseInt(C.substr(8,2),10),Fe=parseInt(C.substr(10,2),10),qe=parseInt(C.substr(12,2),10),tt=parseInt(C.substr(14,2),10);return new Date(re,be,_e,Fe,qe,tt,0)},le=h.__private__.setCreationDate=function(C){var re;if(C===void 0&&(C=new Date),C instanceof Date)re=z(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");re=C}return X=re},A=h.__private__.getCreationDate=function(C){var re=X;return C==="jsDate"&&(re=ne(X)),re};h.setCreationDate=function(C){return le(C),this},h.getCreationDate=function(C){return A(C)};var D,L=h.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},M=h.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},R=0,H=[],J=[],G=0,Q=[],de=[],V=!1,Ee=J,we=function(){R=0,G=0,J=[],H=[],Q=[],ue=Kr(),fe=Kr()};h.__private__.setCustomOutputDestination=function(C){V=!0,Ee=C};var he=function(C){V||(Ee=C)};h.__private__.resetCustomOutputDestination=function(){V=!1,Ee=J};var Z=h.__private__.out=function(C){return C=C.toString(),G+=C.length+1,Ee.push(C),Ee},Se=h.__private__.write=function(C){return Z(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},ge=h.__private__.getArrayBuffer=function(C){for(var re=C.length,be=new ArrayBuffer(re),_e=new Uint8Array(be);re--;)_e[re]=C.charCodeAt(re);return be},pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return pe};var Ae=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(C){return Ae=_===S.ADVANCED?C/rt:C,this};var Le,Pe=h.__private__.getFontSize=h.getFontSize=function(){return _===S.COMPAT?Ae:Ae*rt},Oe=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(C){return Oe=C,this},h.__private__.getR2L=h.getR2L=function(){return Oe};var Ve,et=h.__private__.setZoomMode=function(C){var re=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))Le=C;else if(isNaN(C)){if(re.indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');Le=C}else Le=parseInt(C,10)};h.__private__.getZoomMode=function(){return Le};var _t,Tt=h.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');Ve=C};h.__private__.getPageMode=function(){return Ve};var At=h.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');_t=C};h.__private__.getLayoutMode=function(){return _t},h.__private__.setDisplayMode=h.setDisplayMode=function(C,re,be){return et(C),At(re),Tt(be),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(C){if(Object.keys(pt).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[C]},h.__private__.getDocumentProperties=function(){return pt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(C){for(var re in pt)pt.hasOwnProperty(re)&&C[re]&&(pt[re]=C[re]);return this},h.__private__.setDocumentProperty=function(C,re){if(Object.keys(pt).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[C]=re};var lt,rt,Zt,jt,Mr,$e={},Je={},Pt=[],gt={},Ot={},yt={},tr={},fr=null,Vt=0,It=[],Xt=new RA(h),rr=e.hotfixes||[],nr={},Cn={},Ma=[],xt=function C(re,be,_e,Fe,qe,tt){if(!(this instanceof C))return new C(re,be,_e,Fe,qe,tt);isNaN(re)&&(re=1),isNaN(be)&&(be=0),isNaN(_e)&&(_e=0),isNaN(Fe)&&(Fe=1),isNaN(qe)&&(qe=0),isNaN(tt)&&(tt=0),this._matrix=[re,be,_e,Fe,qe,tt]};Object.defineProperty(xt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(xt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(xt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(xt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(xt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(xt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(xt.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(xt.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(xt.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(xt.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(xt.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(xt.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(xt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(xt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(xt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(xt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),xt.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(C)},xt.prototype.multiply=function(C){var re=C.sx*this.sx+C.shy*this.shx,be=C.sx*this.shy+C.shy*this.sy,_e=C.shx*this.sx+C.sy*this.shx,Fe=C.shx*this.shy+C.sy*this.sy,qe=C.tx*this.sx+C.ty*this.shx+this.tx,tt=C.tx*this.shy+C.ty*this.sy+this.ty;return new xt(re,be,_e,Fe,qe,tt)},xt.prototype.decompose=function(){var C=this.sx,re=this.shy,be=this.shx,_e=this.sy,Fe=this.tx,qe=this.ty,tt=Math.sqrt(C*C+re*re),ht=(C/=tt)*be+(re/=tt)*_e;be-=C*ht,_e-=re*ht;var kt=Math.sqrt(be*be+_e*_e);return ht/=kt,C*(_e/=kt)<re*(be/=kt)&&(C=-C,re=-re,ht=-ht,tt=-tt),{scale:new xt(tt,0,0,kt,0,0),translate:new xt(1,0,0,1,Fe,qe),rotate:new xt(C,re,-re,C,0,0),skew:new xt(1,0,ht,1,0,0)}},xt.prototype.toString=function(C){return this.join(" ")},xt.prototype.inversed=function(){var C=this.sx,re=this.shy,be=this.shx,_e=this.sy,Fe=this.tx,qe=this.ty,tt=1/(C*_e-re*be),ht=_e*tt,kt=-re*tt,Wt=-be*tt,zt=C*tt;return new xt(ht,kt,Wt,zt,-ht*Fe-Wt*qe,-kt*Fe-zt*qe)},xt.prototype.applyToPoint=function(C){var re=C.x*this.sx+C.y*this.shx+this.tx,be=C.x*this.shy+C.y*this.sy+this.ty;return new vc(re,be)},xt.prototype.applyToRectangle=function(C){var re=this.applyToPoint(C),be=this.applyToPoint(new vc(C.x+C.w,C.y+C.h));return new qu(re.x,re.y,be.x-re.x,be.y-re.y)},xt.prototype.clone=function(){var C=this.sx,re=this.shy,be=this.shx,_e=this.sy,Fe=this.tx,qe=this.ty;return new xt(C,re,be,_e,Fe,qe)},h.Matrix=xt;var Un=h.matrixMult=function(C,re){return re.multiply(C)},En=new xt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=En;var zn=function(C,re){if(!Ot[C]){var be=(re instanceof Nl?"Sh":"P")+(Object.keys(gt).length+1).toString(10);re.id=be,Ot[C]=be,gt[be]=re,Xt.publish("addPattern",re)}};h.ShadingPattern=Nl,h.TilingPattern=Xc,h.addShadingPattern=function(C,re){return k("addShadingPattern()"),zn(C,re),this},h.beginTilingPattern=function(C){k("beginTilingPattern()"),y0(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},h.endTilingPattern=function(C,re){k("endTilingPattern()"),re.stream=de[D].join(`
`),zn(C,re),Xt.publish("endTilingPattern",re),Ma.pop().restore()};var Rr=h.__private__.newObject=function(){var C=Kr();return se(C,!0),C},Kr=h.__private__.newObjectDeferred=function(){return R++,H[R]=function(){return G},R},se=function(C,re){return re=typeof re=="boolean"&&re,H[C]=G,re&&Z(C+" 0 obj"),C},ve=h.__private__.newAdditionalObject=function(){var C={objId:Kr(),content:""};return Q.push(C),C},ue=Kr(),fe=Kr(),xe=h.__private__.decodeColorString=function(C){var re=C.split(" ");if(re.length!==2||re[1]!=="g"&&re[1]!=="G")re.length===5&&(re[4]==="k"||re[4]==="K")&&(re=[(1-re[0])*(1-re[3]),(1-re[1])*(1-re[3]),(1-re[2])*(1-re[3]),"r"]);else{var be=parseFloat(re[0]);re=[be,be,be,"r"]}for(var _e="#",Fe=0;Fe<3;Fe++)_e+=("0"+Math.floor(255*parseFloat(re[Fe])).toString(16)).slice(-2);return _e},ye=h.__private__.encodeColorString=function(C){var re;typeof C=="string"&&(C={ch1:C});var be=C.ch1,_e=C.ch2,Fe=C.ch3,qe=C.ch4,tt=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof be=="string"&&be.charAt(0)!=="#"){var ht=new I8(be);if(ht.ok)be=ht.toHex();else if(!/^\d*\.?\d*$/.test(be))throw new Error('Invalid color "'+be+'" passed to jsPDF.encodeColorString.')}if(typeof be=="string"&&/^#[0-9A-Fa-f]{3}$/.test(be)&&(be="#"+be[1]+be[1]+be[2]+be[2]+be[3]+be[3]),typeof be=="string"&&/^#[0-9A-Fa-f]{6}$/.test(be)){var kt=parseInt(be.substr(1),16);be=kt>>16&255,_e=kt>>8&255,Fe=255&kt}if(_e===void 0||qe===void 0&&be===_e&&_e===Fe)if(typeof be=="string")re=be+" "+tt[0];else switch(C.precision){case 2:re=q(be/255)+" "+tt[0];break;case 3:default:re=F(be/255)+" "+tt[0]}else if(qe===void 0||yr(qe)==="object"){if(qe&&!isNaN(qe.a)&&qe.a===0)return re=["1.","1.","1.",tt[1]].join(" ");if(typeof be=="string")re=[be,_e,Fe,tt[1]].join(" ");else switch(C.precision){case 2:re=[q(be/255),q(_e/255),q(Fe/255),tt[1]].join(" ");break;default:case 3:re=[F(be/255),F(_e/255),F(Fe/255),tt[1]].join(" ")}}else if(typeof be=="string")re=[be,_e,Fe,qe,tt[2]].join(" ");else switch(C.precision){case 2:re=[q(be),q(_e),q(Fe),q(qe),tt[2]].join(" ");break;case 3:default:re=[F(be),F(_e),F(Fe),F(qe),tt[2]].join(" ")}return re},De=h.__private__.getFilters=function(){return i},We=h.__private__.putStream=function(C){var re=(C=C||{}).data||"",be=C.filters||De(),_e=C.alreadyAppliedFilters||[],Fe=C.addLength1||!1,qe=re.length,tt=C.objectId,ht=function(ca){return ca};if(d!==null&&tt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(ht=la.encryptor(tt,0));var kt={};be===!0&&(be=["FlateEncode"]);var Wt=C.additionalKeyValues||[],zt=(kt=Ft.API.processDataByFilters!==void 0?Ft.API.processDataByFilters(re,be):{data:re,reverseChain:[]}).reverseChain+(Array.isArray(_e)?_e.join(" "):_e.toString());if(kt.data.length!==0&&(Wt.push({key:"Length",value:kt.data.length}),Fe===!0&&Wt.push({key:"Length1",value:qe})),zt.length!=0)if(zt.split("/").length-1==1)Wt.push({key:"Filter",value:zt});else{Wt.push({key:"Filter",value:"["+zt+"]"});for(var Qt=0;Qt<Wt.length;Qt+=1)if(Wt[Qt].key==="DecodeParms"){for(var Hr=[],Xr=0;Xr<kt.reverseChain.split("/").length-1;Xr+=1)Hr.push("null");Hr.push(Wt[Qt].value),Wt[Qt].value="["+Hr.join(" ")+"]"}}Z("<<");for(var xn=0;xn<Wt.length;xn++)Z("/"+Wt[xn].key+" "+Wt[xn].value);Z(">>"),kt.data.length!==0&&(Z("stream"),Z(ht(kt.data)),Z("endstream"))},Ie=h.__private__.putPage=function(C){var re=C.number,be=C.data,_e=C.objId,Fe=C.contentsObjId;se(_e,!0),Z("<</Type /Page"),Z("/Parent "+C.rootDictionaryObjId+" 0 R"),Z("/Resources "+C.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(I(C.mediaBox.bottomLeftX))+" "+parseFloat(I(C.mediaBox.bottomLeftY))+" "+I(C.mediaBox.topRightX)+" "+I(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&Z("/CropBox ["+I(C.cropBox.bottomLeftX)+" "+I(C.cropBox.bottomLeftY)+" "+I(C.cropBox.topRightX)+" "+I(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&Z("/BleedBox ["+I(C.bleedBox.bottomLeftX)+" "+I(C.bleedBox.bottomLeftY)+" "+I(C.bleedBox.topRightX)+" "+I(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&Z("/TrimBox ["+I(C.trimBox.bottomLeftX)+" "+I(C.trimBox.bottomLeftY)+" "+I(C.trimBox.topRightX)+" "+I(C.trimBox.topRightY)+"]"),C.artBox!==null&&Z("/ArtBox ["+I(C.artBox.bottomLeftX)+" "+I(C.artBox.bottomLeftY)+" "+I(C.artBox.topRightX)+" "+I(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&Z("/UserUnit "+C.userUnit),Xt.publish("putPage",{objId:_e,pageContext:It[re],pageNumber:re,page:be}),Z("/Contents "+Fe+" 0 R"),Z(">>"),Z("endobj");var qe=be.join(`
`);return _===S.ADVANCED&&(qe+=`
Q`),se(Fe,!0),We({data:qe,filters:De(),objectId:Fe}),Z("endobj"),_e},Be=h.__private__.putPages=function(){var C,re,be=[];for(C=1;C<=Vt;C++)It[C].objId=Kr(),It[C].contentsObjId=Kr();for(C=1;C<=Vt;C++)be.push(Ie({number:C,data:de[C],objId:It[C].objId,contentsObjId:It[C].contentsObjId,mediaBox:It[C].mediaBox,cropBox:It[C].cropBox,bleedBox:It[C].bleedBox,trimBox:It[C].trimBox,artBox:It[C].artBox,userUnit:It[C].userUnit,rootDictionaryObjId:ue,resourceDictionaryObjId:fe}));se(ue,!0),Z("<</Type /Pages");var _e="/Kids [";for(re=0;re<Vt;re++)_e+=be[re]+" 0 R ";Z(_e+"]"),Z("/Count "+Vt),Z(">>"),Z("endobj"),Xt.publish("postPutPages")},ze=function(C){Xt.publish("putFont",{font:C,out:Z,newObject:Rr,putStream:We}),C.isAlreadyPutted!==!0&&(C.objectNumber=Rr(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Gc(C.postScriptName)),Z("/Subtype /Type1"),typeof C.encoding=="string"&&Z("/Encoding /"+C.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},nt=function(){for(var C in $e)$e.hasOwnProperty(C)&&(f===!1||f===!0&&m.hasOwnProperty(C))&&ze($e[C])},st=function(C){C.objectNumber=Rr();var re=[];re.push({key:"Type",value:"/XObject"}),re.push({key:"Subtype",value:"/Form"}),re.push({key:"BBox",value:"["+[I(C.x),I(C.y),I(C.x+C.width),I(C.y+C.height)].join(" ")+"]"}),re.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var be=C.pages[1].join(`
`);We({data:be,additionalKeyValues:re,objectId:C.objectNumber}),Z("endobj")},ft=function(){for(var C in nr)nr.hasOwnProperty(C)&&st(nr[C])},at=function(C,re){var be,_e=[],Fe=1/(re-1);for(be=0;be<1;be+=Fe)_e.push(be);if(_e.push(1),C[0].offset!=0){var qe={offset:0,color:C[0].color};C.unshift(qe)}if(C[C.length-1].offset!=1){var tt={offset:1,color:C[C.length-1].color};C.push(tt)}for(var ht="",kt=0,Wt=0;Wt<_e.length;Wt++){for(be=_e[Wt];be>C[kt+1].offset;)kt++;var zt=C[kt].offset,Qt=(be-zt)/(C[kt+1].offset-zt),Hr=C[kt].color,Xr=C[kt+1].color;ht+=M(Math.round((1-Qt)*Hr[0]+Qt*Xr[0]).toString(16))+M(Math.round((1-Qt)*Hr[1]+Qt*Xr[1]).toString(16))+M(Math.round((1-Qt)*Hr[2]+Qt*Xr[2]).toString(16))}return ht.trim()},dt=function(C,re){re||(re=21);var be=Rr(),_e=at(C.colors,re),Fe=[];Fe.push({key:"FunctionType",value:"0"}),Fe.push({key:"Domain",value:"[0.0 1.0]"}),Fe.push({key:"Size",value:"["+re+"]"}),Fe.push({key:"BitsPerSample",value:"8"}),Fe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),We({data:_e,additionalKeyValues:Fe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:be}),Z("endobj"),C.objectNumber=Rr(),Z("<< /ShadingType "+C.type),Z("/ColorSpace /DeviceRGB");var qe="/Coords ["+I(parseFloat(C.coords[0]))+" "+I(parseFloat(C.coords[1]))+" ";C.type===2?qe+=I(parseFloat(C.coords[2]))+" "+I(parseFloat(C.coords[3])):qe+=I(parseFloat(C.coords[2]))+" "+I(parseFloat(C.coords[3]))+" "+I(parseFloat(C.coords[4]))+" "+I(parseFloat(C.coords[5])),Z(qe+="]"),C.matrix&&Z("/Matrix ["+C.matrix.toString()+"]"),Z("/Function "+be+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},Bt=function(C,re){var be=Kr(),_e=Rr();re.push({resourcesOid:be,objectOid:_e}),C.objectNumber=_e;var Fe=[];Fe.push({key:"Type",value:"/Pattern"}),Fe.push({key:"PatternType",value:"1"}),Fe.push({key:"PaintType",value:"1"}),Fe.push({key:"TilingType",value:"1"}),Fe.push({key:"BBox",value:"["+C.boundingBox.map(I).join(" ")+"]"}),Fe.push({key:"XStep",value:I(C.xStep)}),Fe.push({key:"YStep",value:I(C.yStep)}),Fe.push({key:"Resources",value:be+" 0 R"}),C.matrix&&Fe.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),We({data:C.stream,additionalKeyValues:Fe,objectId:C.objectNumber}),Z("endobj")},dr=function(C){var re;for(re in gt)gt.hasOwnProperty(re)&&(gt[re]instanceof Nl?dt(gt[re]):gt[re]instanceof Xc&&Bt(gt[re],C))},br=function(C){for(var re in C.objectNumber=Rr(),Z("<<"),C)switch(re){case"opacity":Z("/ca "+q(C[re]));break;case"stroke-opacity":Z("/CA "+q(C[re]))}Z(">>"),Z("endobj")},gn=function(){var C;for(C in yt)yt.hasOwnProperty(C)&&br(yt[C])},Ms=function(){for(var C in Z("/XObject <<"),nr)nr.hasOwnProperty(C)&&nr[C].objectNumber>=0&&Z("/"+C+" "+nr[C].objectNumber+" 0 R");Xt.publish("putXobjectDict"),Z(">>")},Pi=function(){la.oid=Rr(),Z("<<"),Z("/Filter /Standard"),Z("/V "+la.v),Z("/R "+la.r),Z("/U <"+la.toHexString(la.U)+">"),Z("/O <"+la.toHexString(la.O)+">"),Z("/P "+la.P),Z(">>"),Z("endobj")},oi=function(){for(var C in Z("/Font <<"),$e)$e.hasOwnProperty(C)&&(f===!1||f===!0&&m.hasOwnProperty(C))&&Z("/"+C+" "+$e[C].objectNumber+" 0 R");Z(">>")},Rs=function(){if(Object.keys(gt).length>0){for(var C in Z("/Shading <<"),gt)gt.hasOwnProperty(C)&&gt[C]instanceof Nl&&gt[C].objectNumber>=0&&Z("/"+C+" "+gt[C].objectNumber+" 0 R");Xt.publish("putShadingPatternDict"),Z(">>")}},li=function(C){if(Object.keys(gt).length>0){for(var re in Z("/Pattern <<"),gt)gt.hasOwnProperty(re)&&gt[re]instanceof h.TilingPattern&&gt[re].objectNumber>=0&&gt[re].objectNumber<C&&Z("/"+re+" "+gt[re].objectNumber+" 0 R");Xt.publish("putTilingPatternDict"),Z(">>")}},Xa=function(){if(Object.keys(yt).length>0){var C;for(C in Z("/ExtGState <<"),yt)yt.hasOwnProperty(C)&&yt[C].objectNumber>=0&&Z("/"+C+" "+yt[C].objectNumber+" 0 R");Xt.publish("putGStateDict"),Z(">>")}},sn=function(C){se(C.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),oi(),Rs(),li(C.objectOid),Xa(),Ms(),Z(">>"),Z("endobj")},a0=function(){var C=[];nt(),gn(),ft(),dr(C),Xt.publish("putResources"),C.forEach(sn),sn({resourcesOid:fe,objectOid:Number.MAX_SAFE_INTEGER}),Xt.publish("postPutResources")},s0=function(){Xt.publish("putAdditionalObjects");for(var C=0;C<Q.length;C++){var re=Q[C];se(re.objId,!0),Z(re.content),Z("endobj")}Xt.publish("postPutAdditionalObjects")},i0=function(C){Je[C.fontName]=Je[C.fontName]||{},Je[C.fontName][C.fontStyle]=C.id},Du=function(C,re,be,_e,Fe){var qe={id:"F"+(Object.keys($e).length+1).toString(10),postScriptName:C,fontName:re,fontStyle:be,encoding:_e,isStandardFont:Fe||!1,metadata:{}};return Xt.publish("addFont",{font:qe,instance:this}),$e[qe.id]=qe,i0(qe),qe.id},sg=function(C){for(var re=0,be=pe.length;re<be;re++){var _e=Du.call(this,C[re][0],C[re][1],C[re][2],pe[re][3],!0);f===!1&&(m[_e]=!0);var Fe=C[re][0].split("-");i0({id:_e,fontName:Fe[0],fontStyle:Fe[1]||""})}Xt.publish("addFonts",{fonts:$e,dictionary:Je})},Bs=function(C){return C.foo=function(){try{return C.apply(this,arguments)}catch(_e){var re=_e.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var be="Error in function "+re.split(`
`)[0].split("<")[0]+": "+_e.message;if(!Dt.console)throw new Error(be);Dt.console.error(be,_e),Dt.alert&&alert(be)}},C.foo.bar=C,C.foo},fc=function(C,re){var be,_e,Fe,qe,tt,ht,kt,Wt,zt;if(Fe=(re=re||{}).sourceEncoding||"Unicode",tt=re.outputEncoding,(re.autoencode||tt)&&$e[lt].metadata&&$e[lt].metadata[Fe]&&$e[lt].metadata[Fe].encoding&&(qe=$e[lt].metadata[Fe].encoding,!tt&&$e[lt].encoding&&(tt=$e[lt].encoding),!tt&&qe.codePages&&(tt=qe.codePages[0]),typeof tt=="string"&&(tt=qe[tt]),tt)){for(kt=!1,ht=[],be=0,_e=C.length;be<_e;be++)(Wt=tt[C.charCodeAt(be)])?ht.push(String.fromCharCode(Wt)):ht.push(C[be]),ht[be].charCodeAt(0)>>8&&(kt=!0);C=ht.join("")}for(be=C.length;kt===void 0&&be!==0;)C.charCodeAt(be-1)>>8&&(kt=!0),be--;if(!kt)return C;for(ht=re.noBOM?[]:[254,255],be=0,_e=C.length;be<_e;be++){if((zt=(Wt=C.charCodeAt(be))>>8)>>8)throw new Error("Character at position "+be+" of string '"+C+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ht.push(zt),ht.push(Wt-(zt<<8))}return String.fromCharCode.apply(void 0,ht)},Ra=h.__private__.pdfEscape=h.pdfEscape=function(C,re){return fc(C,re).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mu=h.__private__.beginPage=function(C){de[++Vt]=[],It[Vt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},l0(Vt),he(de[D])},o0=function(C,re){var be,_e,Fe;switch(r=re||r,typeof C=="string"&&(be=b(C.toLowerCase()),Array.isArray(be)&&(_e=be[0],Fe=be[1])),Array.isArray(C)&&(_e=C[0]*rt,Fe=C[1]*rt),isNaN(_e)&&(_e=a[0],Fe=a[1]),(_e>14400||Fe>14400)&&(jr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),_e=Math.min(14400,_e),Fe=Math.min(14400,Fe)),a=[_e,Fe],r.substr(0,1)){case"l":Fe>_e&&(a=[Fe,_e]);break;case"p":_e>Fe&&(a=[Fe,_e])}Mu(a),m0(zu),Z(Us),Wu!==0&&Z(Wu+" J"),Hu!==0&&Z(Hu+" j"),Xt.publish("addPage",{pageNumber:Vt})},ig=function(C){C>0&&C<=Vt&&(de.splice(C,1),It.splice(C,1),Vt--,D>Vt&&(D=Vt),this.setPage(D))},l0=function(C){C>0&&C<=Vt&&(D=C)},og=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return de.length-1},c0=function(C,re,be){var _e,Fe=void 0;return be=be||{},C=C!==void 0?C:$e[lt].fontName,re=re!==void 0?re:$e[lt].fontStyle,_e=C.toLowerCase(),Je[_e]!==void 0&&Je[_e][re]!==void 0?Fe=Je[_e][re]:Je[C]!==void 0&&Je[C][re]!==void 0?Fe=Je[C][re]:be.disableWarning===!1&&jr.warn("Unable to look up font label for font '"+C+"', '"+re+"'. Refer to getFontList() for available fonts."),Fe||be.noFallback||(Fe=Je.times[re])==null&&(Fe=Je.times.normal),Fe},lg=h.__private__.putInfo=function(){var C=Rr(),re=function(_e){return _e};for(var be in d!==null&&(re=la.encryptor(C,0)),Z("<<"),Z("/Producer ("+Ra(re("jsPDF "+Ft.version))+")"),pt)pt.hasOwnProperty(be)&&pt[be]&&Z("/"+be.substr(0,1).toUpperCase()+be.substr(1)+" ("+Ra(re(pt[be]))+")");Z("/CreationDate ("+Ra(re(X))+")"),Z(">>"),Z("endobj")},Ru=h.__private__.putCatalog=function(C){var re=(C=C||{}).rootDictionaryObjId||ue;switch(Rr(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+re+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var be=""+Le;be.substr(be.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+q(Le)+"]")}switch(_t||(_t="continuous"),_t){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}Ve&&Z("/PageMode /"+Ve),Xt.publish("putCatalog"),Z(">>"),Z("endobj")},cg=h.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(R+1)),Z("/Root "+R+" 0 R"),Z("/Info "+(R-1)+" 0 R"),d!==null&&Z("/Encrypt "+la.oid+" 0 R"),Z("/ID [ <"+K+"> <"+K+"> ]"),Z(">>")},ug=h.__private__.putHeader=function(){Z("%PDF-"+p),Z("%ºß¬à")},dg=h.__private__.putXRef=function(){var C="0000000000";Z("xref"),Z("0 "+(R+1)),Z("0000000000 65535 f ");for(var re=1;re<=R;re++)typeof H[re]=="function"?Z((C+H[re]()).slice(-10)+" 00000 n "):H[re]!==void 0?Z((C+H[re]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},Oi=h.__private__.buildDocument=function(){we(),he(J),Xt.publish("buildDocument"),ug(),Be(),s0(),a0(),d!==null&&Pi(),lg(),Ru();var C=G;return dg(),cg(),Z("startxref"),Z(""+C),Z("%%EOF"),he(de[D]),J.join(`
`)},hc=h.__private__.getBlob=function(C){return new Blob([ge(C)],{type:"application/pdf"})},mc=h.output=h.__private__.output=Bs((function(C,re){switch(typeof(re=re||{})=="string"?re={filename:re}:re.filename=re.filename||"generated.pdf",C){case void 0:return Oi();case"save":h.save(re.filename);break;case"arraybuffer":return ge(Oi());case"blob":return hc(Oi());case"bloburi":case"bloburl":if(Dt.URL!==void 0&&typeof Dt.URL.createObjectURL=="function")return Dt.URL&&Dt.URL.createObjectURL(hc(Oi()))||void 0;jr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var be="",_e=Oi();try{be=Oy(_e)}catch{be=Oy(unescape(encodeURIComponent(_e)))}return"data:application/pdf;filename="+re.filename+";base64,"+be;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Dt)==="[object Window]"){var Fe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",qe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';re.pdfObjectUrl&&(Fe=re.pdfObjectUrl,qe="");var tt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Fe+'"'+qe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(re)+");<\/script></body></html>",ht=Dt.open();return ht!==null&&ht.document.write(tt),ht}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Dt)==="[object Window]"){var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(re.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+re.filename+'" width="500px" height="400px" /></body></html>',Wt=Dt.open();if(Wt!==null){Wt.document.write(kt);var zt=this;Wt.document.documentElement.querySelector("#pdfViewer").onload=function(){Wt.document.title=re.filename,Wt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(zt.output("bloburl"))}}return Wt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Dt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",re)+'"></iframe></body></html>',Hr=Dt.open();if(Hr!==null&&(Hr.document.write(Qt),Hr.document.title=re.filename),Hr||typeof safari>"u")return Hr;break;case"datauri":case"dataurl":return Dt.document.location.href=this.output("datauristring",re);default:return null}})),u0=function(C){return Array.isArray(rr)===!0&&rr.indexOf(C)>-1};switch(n){case"pt":rt=1;break;case"mm":rt=72/25.4;break;case"cm":rt=72/2.54;break;case"in":rt=72;break;case"px":rt=u0("px_scaling")==1?.75:96/72;break;case"pc":case"em":rt=12;break;case"ex":rt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);rt=n}var la=null;le(),Y();var fg=function(C){return d!==null?la.encryptor(C,0):function(re){return re}},d0=h.__private__.getPageInfo=h.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:It[C].objId,pageNumber:C,pageContext:It[C]}},Ut=h.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var re in It)if(It[re].objId===C)break;return d0(re)},hg=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:It[D].objId,pageNumber:D,pageContext:It[D]}};h.addPage=function(){return o0.apply(this,arguments),this},h.setPage=function(){return l0.apply(this,arguments),he.call(this,de[D]),this},h.insertPage=function(C){return this.addPage(),this.movePage(D,C),this},h.movePage=function(C,re){var be,_e;if(C>re){be=de[C],_e=It[C];for(var Fe=C;Fe>re;Fe--)de[Fe]=de[Fe-1],It[Fe]=It[Fe-1];de[re]=be,It[re]=_e,this.setPage(re)}else if(C<re){be=de[C],_e=It[C];for(var qe=C;qe<re;qe++)de[qe]=de[qe+1],It[qe]=It[qe+1];de[re]=be,It[re]=_e,this.setPage(re)}return this},h.deletePage=function(){return ig.apply(this,arguments),this},h.__private__.text=h.text=function(C,re,be,_e,Fe){var qe,tt,ht,kt,Wt,zt,Qt,Hr,Xr,xn=(_e=_e||{}).scope||this;if(typeof C=="number"&&typeof re=="number"&&(typeof be=="string"||Array.isArray(be))){var ca=be;be=re,re=C,C=ca}if(arguments[3]instanceof xt?(k("The transform parameter of text() with a Matrix value"),Xr=Fe):(ht=arguments[4],kt=arguments[5],yr(Qt=arguments[3])==="object"&&Qt!==null||(typeof ht=="string"&&(kt=ht,ht=null),typeof Qt=="string"&&(kt=Qt,Qt=null),typeof Qt=="number"&&(ht=Qt,Qt=null),_e={flags:Qt,angle:ht,align:kt})),isNaN(re)||isNaN(be)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return xn;var $n="",zs=!1,Ja=typeof _e.lineHeightFactor=="number"?_e.lineHeightFactor:ul,di=xn.internal.scaleFactor;function b0(Cr){return Cr=Cr.split("	").join(Array(_e.TabLen||9).join(" ")),Ra(Cr,Qt)}function Ku(Cr){for(var Er,ln=Cr.concat(),Tn=[],Mi=ln.length;Mi--;)typeof(Er=ln.shift())=="string"?Tn.push(Er):Array.isArray(Cr)&&(Er.length===1||Er[1]===void 0&&Er[2]===void 0)?Tn.push(Er[0]):Tn.push([Er[0],Er[1],Er[2]]);return Tn}function Xu(Cr,Er){var ln;if(typeof Cr=="string")ln=Er(Cr)[0];else if(Array.isArray(Cr)){for(var Tn,Mi,ad=Cr.concat(),Ec=[],A0=ad.length;A0--;)typeof(Tn=ad.shift())=="string"?Ec.push(Er(Tn)[0]):Array.isArray(Tn)&&typeof Tn[0]=="string"&&(Mi=Er(Tn[0],Tn[1],Tn[2]),Ec.push([Mi[0],Mi[1],Mi[2]]));ln=Ec}return ln}var bc=!1,Ju=!0;if(typeof C=="string")bc=!0;else if(Array.isArray(C)){var Zu=C.concat();tt=[];for(var wc,ta=Zu.length;ta--;)(typeof(wc=Zu.shift())!="string"||Array.isArray(wc)&&typeof wc[0]!="string")&&(Ju=!1);bc=Ju}if(bc===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var Sc=Ae/xn.internal.scaleFactor,_c=Sc*(Ja-1);switch(_e.baseline){case"bottom":be-=_c;break;case"top":be+=Sc-_c;break;case"hanging":be+=Sc-2*_c;break;case"middle":be+=Sc/2-_c}if((zt=_e.maxWidth||0)>0&&(typeof C=="string"?C=xn.splitTextToSize(C,zt):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce((function(Cr,Er){return Cr.concat(xn.splitTextToSize(Er,zt))}),[]))),qe={text:C,x:re,y:be,options:_e,mutex:{pdfEscape:Ra,activeFontKey:lt,fonts:$e,activeFontSize:Ae}},Xt.publish("preProcessText",qe),C=qe.text,ht=(_e=qe.options).angle,!(Xr instanceof xt)&&ht&&typeof ht=="number"){ht*=Math.PI/180,_e.rotationDirection===0&&(ht=-ht),_===S.ADVANCED&&(ht=-ht);var Nc=Math.cos(ht),Qu=Math.sin(ht);Xr=new xt(Nc,Qu,-Qu,Nc,0,0)}else ht&&ht instanceof xt&&(Xr=ht);_!==S.ADVANCED||Xr||(Xr=En),(Wt=_e.charSpace||xc)!==void 0&&($n+=I(j(Wt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Hr=_e.horizontalScale)!==void 0&&($n+=I(100*Hr)+` Tz
`),_e.lang;var Ba=-1,_g=_e.renderingMode!==void 0?_e.renderingMode:_e.stroke,ed=xn.internal.getCurrentPageInfo().pageContext;switch(_g){case 0:case!1:case"fill":Ba=0;break;case 1:case!0:case"stroke":Ba=1;break;case 2:case"fillThenStroke":Ba=2;break;case 3:case"invisible":Ba=3;break;case 4:case"fillAndAddForClipping":Ba=4;break;case 5:case"strokeAndAddPathForClipping":Ba=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ba=6;break;case 7:case"addToPathForClipping":Ba=7}var w0=ed.usedRenderingMode!==void 0?ed.usedRenderingMode:-1;Ba!==-1?$n+=Ba+` Tr
`:w0!==-1&&($n+=`0 Tr
`),Ba!==-1&&(ed.usedRenderingMode=Ba),kt=_e.align||"left";var hs,Ac=Ae*Ja,S0=xn.internal.pageSize.getWidth(),_0=$e[lt];Wt=_e.charSpace||xc,zt=_e.maxWidth||0,Qt=Object.assign({autoencode:!0,noBOM:!0},_e.flags);var No=[],hl=function(Cr){return xn.getStringUnitWidth(Cr,{font:_0,charSpace:Wt,fontSize:Ae,doKerning:!1})*Ae/di};if(Object.prototype.toString.call(C)==="[object Array]"){var Ua;tt=Ku(C),kt!=="left"&&(hs=tt.map(hl));var ka,Ao=0;if(kt==="right"){re-=hs[0],C=[],ta=tt.length;for(var Ii=0;Ii<ta;Ii++)Ii===0?(ka=ui(re),Ua=Fi(be)):(ka=j(Ao-hs[Ii]),Ua=-Ac),C.push([tt[Ii],ka,Ua]),Ao=hs[Ii]}else if(kt==="center"){re-=hs[0]/2,C=[],ta=tt.length;for(var Li=0;Li<ta;Li++)Li===0?(ka=ui(re),Ua=Fi(be)):(ka=j((Ao-hs[Li])/2),Ua=-Ac),C.push([tt[Li],ka,Ua]),Ao=hs[Li]}else if(kt==="left"){C=[],ta=tt.length;for(var jc=0;jc<ta;jc++)C.push(tt[jc])}else if(kt==="justify"&&_0.encoding==="Identity-H"){C=[],ta=tt.length,zt=zt!==0?zt:S0;for(var Di=0,on=0;on<ta;on++)if(Ua=on===0?Fi(be):-Ac,ka=on===0?ui(re):Di,on<ta-1){var td=j((zt-hs[on])/(tt[on].split(" ").length-1)),Ca=tt[on].split(" ");C.push([Ca[0]+" ",ka,Ua]),Di=0;for(var ms=1;ms<Ca.length;ms++){var kc=(hl(Ca[ms-1]+" "+Ca[ms])-hl(Ca[ms]))*di+td;ms==Ca.length-1?C.push([Ca[ms],kc,0]):C.push([Ca[ms]+" ",kc,0]),Di-=kc}}else C.push([tt[on],ka,Ua]);C.push(["",Di,0])}else{if(kt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],ta=tt.length,zt=zt!==0?zt:S0,on=0;on<ta;on++)Ua=on===0?Fi(be):-Ac,ka=on===0?ui(re):0,on<ta-1?No.push(I(j((zt-hs[on])/(tt[on].split(" ").length-1)))):No.push(0),C.push([tt[on],ka,Ua])}}var N0=typeof _e.R2L=="boolean"?_e.R2L:Oe;N0===!0&&(C=Xu(C,(function(Cr,Er,ln){return[Cr.split("").reverse().join(""),Er,ln]}))),qe={text:C,x:re,y:be,options:_e,mutex:{pdfEscape:Ra,activeFontKey:lt,fonts:$e,activeFontSize:Ae}},Xt.publish("postProcessText",qe),C=qe.text,zs=qe.mutex.isHex||!1;var rd=$e[lt].encoding;rd!=="WinAnsiEncoding"&&rd!=="StandardEncoding"||(C=Xu(C,(function(Cr,Er,ln){return[b0(Cr),Er,ln]}))),tt=Ku(C),C=[];for(var ml,pl,jo,gl=0,Cc=1,xl=Array.isArray(tt[0])?Cc:gl,ko="",nd=function(Cr,Er,ln){var Tn="";return ln instanceof xt?(ln=typeof _e.angle=="number"?Un(ln,new xt(1,0,0,1,Cr,Er)):Un(new xt(1,0,0,1,Cr,Er),ln),_===S.ADVANCED&&(ln=Un(new xt(1,0,0,-1,0,0),ln)),Tn=ln.join(" ")+` Tm
`):Tn=I(Cr)+" "+I(Er)+` Td
`,Tn},ps=0;ps<tt.length;ps++){switch(ko="",xl){case Cc:jo=(zs?"<":"(")+tt[ps][0]+(zs?">":")"),ml=parseFloat(tt[ps][1]),pl=parseFloat(tt[ps][2]);break;case gl:jo=(zs?"<":"(")+tt[ps]+(zs?">":")"),ml=ui(re),pl=Fi(be)}No!==void 0&&No[ps]!==void 0&&(ko=No[ps]+` Tw
`),ps===0?C.push(ko+nd(ml,pl,Xr)+jo):xl===gl?C.push(ko+jo):xl===Cc&&C.push(ko+nd(ml,pl,Xr)+jo)}C=xl===gl?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var gs=`BT
/`;return gs+=lt+" "+Ae+` Tf
`,gs+=I(Ae*Ja)+` TL
`,gs+=dl+`
`,gs+=$n,gs+=C,Z(gs+="ET"),m[lt]=!0,xn};var mg=h.__private__.clip=h.clip=function(C){return Z(C==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return mg("evenodd")},h.__private__.discardPath=h.discardPath=function(){return Z("n"),this};var ci=h.__private__.isValidStyle=function(C){var re=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(re=!0),re};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(C){return ci(C)&&(u=C),this};var f0=h.__private__.getStyle=h.getStyle=function(C){var re=u;switch(C){case"D":case"S":re="S";break;case"F":re="f";break;case"FD":case"DF":re="B";break;case"f":case"f*":case"B":case"B*":re=C}return re},h0=h.close=function(){return Z("h"),this};h.stroke=function(){return Z("S"),this},h.fill=function(C){return pc("f",C),this},h.fillEvenOdd=function(C){return pc("f*",C),this},h.fillStroke=function(C){return pc("B",C),this},h.fillStrokeEvenOdd=function(C){return pc("B*",C),this};var pc=function(C,re){yr(re)==="object"?gg(re,C):Z(C)},Bu=function(C){C===null||_===S.ADVANCED&&C===void 0||(C=f0(C),Z(C))};function pg(C,re,be,_e,Fe){var qe=new Xc(re||this.boundingBox,be||this.xStep,_e||this.yStep,this.gState,Fe||this.matrix);qe.stream=this.stream;var tt=C+"$$"+this.cloneIndex+++"$$";return zn(tt,qe),qe}var gg=function(C,re){var be=Ot[C.key],_e=gt[be];if(_e instanceof Nl)Z("q"),Z(xg(re)),_e.gState&&h.setGState(_e.gState),Z(C.matrix.toString()+" cm"),Z("/"+be+" sh"),Z("Q");else if(_e instanceof Xc){var Fe=new xt(1,0,0,-1,0,_o());C.matrix&&(Fe=Fe.multiply(C.matrix||En),be=pg.call(_e,C.key,C.boundingBox,C.xStep,C.yStep,Fe).id),Z("q"),Z("/Pattern cs"),Z("/"+be+" scn"),_e.gState&&h.setGState(_e.gState),Z(re),Z("Q")}},xg=function(C){switch(C){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Uu=h.moveTo=function(C,re){return Z(I(j(C))+" "+I(B(re))+" m"),this},cl=h.lineTo=function(C,re){return Z(I(j(C))+" "+I(B(re))+" l"),this},wo=h.curveTo=function(C,re,be,_e,Fe,qe){return Z([I(j(C)),I(B(re)),I(j(be)),I(B(_e)),I(j(Fe)),I(B(qe)),"c"].join(" ")),this};h.__private__.line=h.line=function(C,re,be,_e,Fe){if(isNaN(C)||isNaN(re)||isNaN(be)||isNaN(_e)||!ci(Fe))throw new Error("Invalid arguments passed to jsPDF.line");return _===S.COMPAT?this.lines([[be-C,_e-re]],C,re,[1,1],Fe||"S"):this.lines([[be-C,_e-re]],C,re,[1,1]).stroke()},h.__private__.lines=h.lines=function(C,re,be,_e,Fe,qe){var tt,ht,kt,Wt,zt,Qt,Hr,Xr,xn,ca,$n,zs;if(typeof C=="number"&&(zs=be,be=re,re=C,C=zs),_e=_e||[1,1],qe=qe||!1,isNaN(re)||isNaN(be)||!Array.isArray(C)||!Array.isArray(_e)||!ci(Fe)||typeof qe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Uu(re,be),tt=_e[0],ht=_e[1],Wt=C.length,ca=re,$n=be,kt=0;kt<Wt;kt++)(zt=C[kt]).length===2?(ca=zt[0]*tt+ca,$n=zt[1]*ht+$n,cl(ca,$n)):(Qt=zt[0]*tt+ca,Hr=zt[1]*ht+$n,Xr=zt[2]*tt+ca,xn=zt[3]*ht+$n,ca=zt[4]*tt+ca,$n=zt[5]*ht+$n,wo(Qt,Hr,Xr,xn,ca,$n));return qe&&h0(),Bu(Fe),this},h.path=function(C){for(var re=0;re<C.length;re++){var be=C[re],_e=be.c;switch(be.op){case"m":Uu(_e[0],_e[1]);break;case"l":cl(_e[0],_e[1]);break;case"c":wo.apply(this,_e);break;case"h":h0()}}return this},h.__private__.rect=h.rect=function(C,re,be,_e,Fe){if(isNaN(C)||isNaN(re)||isNaN(be)||isNaN(_e)||!ci(Fe))throw new Error("Invalid arguments passed to jsPDF.rect");return _===S.COMPAT&&(_e=-_e),Z([I(j(C)),I(B(re)),I(j(be)),I(j(_e)),"re"].join(" ")),Bu(Fe),this},h.__private__.triangle=h.triangle=function(C,re,be,_e,Fe,qe,tt){if(isNaN(C)||isNaN(re)||isNaN(be)||isNaN(_e)||isNaN(Fe)||isNaN(qe)||!ci(tt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[be-C,_e-re],[Fe-be,qe-_e],[C-Fe,re-qe]],C,re,[1,1],tt,!0),this},h.__private__.roundedRect=h.roundedRect=function(C,re,be,_e,Fe,qe,tt){if(isNaN(C)||isNaN(re)||isNaN(be)||isNaN(_e)||isNaN(Fe)||isNaN(qe)||!ci(tt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ht=4/3*(Math.SQRT2-1);return Fe=Math.min(Fe,.5*be),qe=Math.min(qe,.5*_e),this.lines([[be-2*Fe,0],[Fe*ht,0,Fe,qe-qe*ht,Fe,qe],[0,_e-2*qe],[0,qe*ht,-Fe*ht,qe,-Fe,qe],[2*Fe-be,0],[-Fe*ht,0,-Fe,-qe*ht,-Fe,-qe],[0,2*qe-_e],[0,-qe*ht,Fe*ht,-qe,Fe,-qe]],C+Fe,re,[1,1],tt,!0),this},h.__private__.ellipse=h.ellipse=function(C,re,be,_e,Fe){if(isNaN(C)||isNaN(re)||isNaN(be)||isNaN(_e)||!ci(Fe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var qe=4/3*(Math.SQRT2-1)*be,tt=4/3*(Math.SQRT2-1)*_e;return Uu(C+be,re),wo(C+be,re-tt,C+qe,re-_e,C,re-_e),wo(C-qe,re-_e,C-be,re-tt,C-be,re),wo(C-be,re+tt,C-qe,re+_e,C,re+_e),wo(C+qe,re+_e,C+be,re+tt,C+be,re),Bu(Fe),this},h.__private__.circle=h.circle=function(C,re,be,_e){if(isNaN(C)||isNaN(re)||isNaN(be)||!ci(_e))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,re,be,be,_e)},h.setFont=function(C,re,be){return be&&(re=N(re,be)),lt=c0(C,re,{disableWarning:!1}),this};var vg=h.__private__.getFont=h.getFont=function(){return $e[c0.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var C,re,be={};for(C in Je)if(Je.hasOwnProperty(C))for(re in be[C]=[],Je[C])Je[C].hasOwnProperty(re)&&be[C].push(re);return be},h.addFont=function(C,re,be,_e,Fe){var qe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&qe.indexOf(arguments[3])!==-1?Fe=arguments[3]:arguments[3]&&qe.indexOf(arguments[3])==-1&&(be=N(be,_e)),Fe=Fe||"Identity-H",Du.call(this,C,re,be,Fe)};var ul,zu=e.lineWidth||.200025,gc=h.__private__.getLineWidth=h.getLineWidth=function(){return zu},m0=h.__private__.setLineWidth=h.setLineWidth=function(C){return zu=C,Z(I(j(C))+" w"),this};h.__private__.setLineDash=Ft.API.setLineDash=Ft.API.setLineDashPattern=function(C,re){if(C=C||[],re=re||0,isNaN(re)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map((function(be){return I(j(be))})).join(" "),re=I(j(re)),Z("["+C+"] "+re+" d"),this};var p0=h.__private__.getLineHeight=h.getLineHeight=function(){return Ae*ul};h.__private__.getLineHeight=h.getLineHeight=function(){return Ae*ul};var g0=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(ul=C),this},x0=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ul};g0(e.lineHeight);var ui=h.__private__.getHorizontalCoordinate=function(C){return j(C)},Fi=h.__private__.getVerticalCoordinate=function(C){return _===S.ADVANCED?C:It[D].mediaBox.topRightY-It[D].mediaBox.bottomLeftY-j(C)},yg=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(C){return I(ui(C))},So=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(C){return I(Fi(C))},Us=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return xe(Us)},h.__private__.setStrokeColor=h.setDrawColor=function(C,re,be,_e){return Us=ye({ch1:C,ch2:re,ch3:be,ch4:_e,pdfColorType:"draw",precision:2}),Z(Us),this};var $u=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return xe($u)},h.__private__.setFillColor=h.setFillColor=function(C,re,be,_e){return $u=ye({ch1:C,ch2:re,ch3:be,ch4:_e,pdfColorType:"fill",precision:2}),Z($u),this};var dl=e.textColor||"0 g",bg=h.__private__.getTextColor=h.getTextColor=function(){return xe(dl)};h.__private__.setTextColor=h.setTextColor=function(C,re,be,_e){return dl=ye({ch1:C,ch2:re,ch3:be,ch4:_e,pdfColorType:"text",precision:3}),this};var xc=e.charSpace,wg=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(xc||0)};h.__private__.setCharSpace=h.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return xc=C,this};var Wu=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(C){var re=h.CapJoinStyles[C];if(re===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wu=re,Z(re+" J"),this};var Hu=0;h.__private__.setLineJoin=h.setLineJoin=function(C){var re=h.CapJoinStyles[C];if(re===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Hu=re,Z(re+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(I(j(C))+" M"),this},h.GState=Ym,h.setGState=function(C){(C=typeof C=="string"?yt[tr[C]]:v0(null,C)).equals(fr)||(Z("/"+C.id+" gs"),fr=C)};var v0=function(C,re){if(!C||!tr[C]){var be=!1;for(var _e in yt)if(yt.hasOwnProperty(_e)&&yt[_e].equals(re)){be=!0;break}if(be)re=yt[_e];else{var Fe="GS"+(Object.keys(yt).length+1).toString(10);yt[Fe]=re,re.id=Fe}return C&&(tr[C]=re.id),Xt.publish("addGState",re),re}};h.addGState=function(C,re){return v0(C,re),this},h.saveGraphicsState=function(){return Z("q"),Pt.push({key:lt,size:Ae,color:dl}),this},h.restoreGraphicsState=function(){Z("Q");var C=Pt.pop();return lt=C.key,Ae=C.size,dl=C.color,fr=null,this},h.setCurrentTransformationMatrix=function(C){return Z(C.toString()+" cm"),this},h.comment=function(C){return Z("#"+C),this};var vc=function(C,re){var be=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return be},set:function(qe){isNaN(qe)||(be=parseFloat(qe))}});var _e=re||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return _e},set:function(qe){isNaN(qe)||(_e=parseFloat(qe))}});var Fe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Fe},set:function(qe){Fe=qe.toString()}}),this},qu=function(C,re,be,_e){vc.call(this,C,re),this.type="rect";var Fe=be||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Fe},set:function(tt){isNaN(tt)||(Fe=parseFloat(tt))}});var qe=_e||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return qe},set:function(tt){isNaN(tt)||(qe=parseFloat(tt))}}),this},Gu=function(){this.page=Vt,this.currentPage=D,this.pages=de.slice(0),this.pagesContext=It.slice(0),this.x=Zt,this.y=jt,this.matrix=Mr,this.width=fl(D),this.height=_o(D),this.outputDestination=Ee,this.id="",this.objectNumber=-1};Gu.prototype.restore=function(){Vt=this.page,D=this.currentPage,It=this.pagesContext,de=this.pages,Zt=this.x,jt=this.y,Mr=this.matrix,Vu(D,this.width),Yu(D,this.height),Ee=this.outputDestination};var y0=function(C,re,be,_e,Fe){Ma.push(new Gu),Vt=D=0,de=[],Zt=C,jt=re,Mr=Fe,Mu([be,_e])},Sg=function(C){if(Cn[C])Ma.pop().restore();else{var re=new Gu,be="Xo"+(Object.keys(nr).length+1).toString(10);re.id=be,Cn[C]=be,nr[be]=re,Xt.publish("addFormObject",re),Ma.pop().restore()}};for(var yc in h.beginFormObject=function(C,re,be,_e,Fe){return y0(C,re,be,_e,Fe),this},h.endFormObject=function(C){return Sg(C),this},h.doFormObject=function(C,re){var be=nr[Cn[C]];return Z("q"),Z(re.toString()+" cm"),Z("/"+be.id+" Do"),Z("Q"),this},h.getFormObject=function(C){var re=nr[Cn[C]];return{x:re.x,y:re.y,width:re.width,height:re.height,matrix:re.matrix}},h.save=function(C,re){return C=C||"generated.pdf",(re=re||{}).returnPromise=re.returnPromise||!1,re.returnPromise===!1?(Sl(hc(Oi()),C),typeof Sl.unload=="function"&&Dt.setTimeout&&setTimeout(Sl.unload,911),this):new Promise((function(be,_e){try{var Fe=Sl(hc(Oi()),C);typeof Sl.unload=="function"&&Dt.setTimeout&&setTimeout(Sl.unload,911),be(Fe)}catch(qe){_e(qe.message)}}))},Ft.API)Ft.API.hasOwnProperty(yc)&&(yc==="events"&&Ft.API.events.length?(function(C,re){var be,_e,Fe;for(Fe=re.length-1;Fe!==-1;Fe--)be=re[Fe][0],_e=re[Fe][1],C.subscribe.apply(C,[be].concat(typeof _e=="function"?[_e]:_e))})(Xt,Ft.API.events):h[yc]=Ft.API[yc]);var fl=h.getPageWidth=function(C){return(It[C=C||D].mediaBox.topRightX-It[C].mediaBox.bottomLeftX)/rt},Vu=h.setPageWidth=function(C,re){It[C].mediaBox.topRightX=re*rt+It[C].mediaBox.bottomLeftX},_o=h.getPageHeight=function(C){return(It[C=C||D].mediaBox.topRightY-It[C].mediaBox.bottomLeftY)/rt},Yu=h.setPageHeight=function(C,re){It[C].mediaBox.topRightY=re*rt+It[C].mediaBox.bottomLeftY};return h.internal={pdfEscape:Ra,getStyle:f0,getFont:vg,getFontSize:Pe,getCharSpace:wg,getTextColor:bg,getLineHeight:p0,getLineHeightFactor:x0,getLineWidth:gc,write:Se,getHorizontalCoordinate:ui,getVerticalCoordinate:Fi,getCoordinateString:yg,getVerticalCoordinateString:So,collections:{},newObject:Rr,newAdditionalObject:ve,newObjectDeferred:Kr,newObjectDeferredBegin:se,getFilters:De,putStream:We,events:Xt,scaleFactor:rt,pageSize:{getWidth:function(){return fl(D)},setWidth:function(C){Vu(D,C)},getHeight:function(){return _o(D)},setHeight:function(C){Yu(D,C)}},encryptionOptions:d,encryption:la,getEncryptor:fg,output:mc,getNumberOfPages:og,pages:de,out:Z,f2:q,f3:F,getPageInfo:d0,getPageInfoByObjId:Ut,getCurrentPageInfo:hg,getPDFVersion:g,Point:vc,Rectangle:qu,Matrix:xt,hasHotfix:u0},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return fl(D)},set:function(C){Vu(D,C)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return _o(D)},set:function(C){Yu(D,C)},enumerable:!0,configurable:!0}),sg.call(h,pe),lt="F1",o0(a,r),Xt.publish("initialized"),h}qc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},qc.prototype.toHexString=function(e){return e.split("").map((function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)})).join("")},qc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},qc.prototype.processOwnerPassword=function(e,t){return Iy(Fy(t).substr(0,5),e)},qc.prototype.encryptor=function(e,t){var r=Fy(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Iy(r,n)}},Ym.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||yr(e)!==yr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ft.API={events:[]},Ft.version="2.5.2";var Zr=Ft.API,Mw=1,dc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$t=function(e){return e.toFixed(2)},Mo=function(e){return e.toFixed(5)};Zr.__acroform__={};var Ka=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},BA=function(e){return e*Mw},xi=function(e){var t=new R8,r=wt.internal.getHeight(e)||0,n=wt.internal.getWidth(e)||0;return t.BBox=[0,0,Number($t(n)),Number($t(r))],t},uue=Zr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},due=Zr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},fue=Zr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(e&1<<t)==0?0:1},dn=Zr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return fue(e,t-1)},fn=Zr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return uue(e,t-1)},hn=Zr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return due(e,t-1)},hue=Zr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],s=e[1],i=e[2],o=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+o)||0,c.upperRight_X=r(a+i)||0,c.upperRight_Y=n(s)||0,[Number($t(c.lowerLeft_X)),Number($t(c.lowerLeft_Y)),Number($t(c.upperRight_X)),Number($t(c.upperRight_Y))]},mue=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Ly(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+$t(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=xi(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},Ly=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map((function(F){return F.split(`
`)})):a.map((function(F){return[F]}));var s=r,i=wt.internal.getHeight(e)||0;i=i<0?-i:i;var o=wt.internal.getWidth(e)||0;o=o<0?-o:o;var c=function(F,j,U){if(F+1<a.length){var B=j+" "+a[F+1][0];return Nh(B,e,U).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Nh("3",e,s).height,m=e.multiline?i-s:(i-f)/2,h=m+=2,p=0,g=0,v=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Nh(t,e,s=12).width+", FieldWidth:"+o+`
`;break}for(var b="",S=0,_=0;_<a.length;_++)if(a.hasOwnProperty(_)){var E=!1;if(a[_].length!==1&&v!==a[_].length-1){if((f+2)*(S+2)+2>i)continue e;b+=a[_][v],E=!0,g=_,_--}else{b=(b+=a[_][v]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var P=parseInt(_),N=c(P,b,s),I=_>=a.length-1;if(N&&!I){b+=" ",v=0;continue}if(N||I){if(I)g=P;else if(e.multiline&&(f+2)*(S+2)+2>i)continue e}else{if(!e.multiline||(f+2)*(S+2)+2>i)continue e;g=P}}for(var k="",T=p;T<=g;T++){var q=a[T];if(e.multiline){if(T===g){k+=q[v]+" ",v=(v+1)%q.length;continue}if(T===p){k+=q[q.length-1]+" ";continue}}k+=q[0]+" "}switch(k=k.substr(k.length-1)==" "?k.substr(0,k.length-1):k,d=Nh(k,e,s).width,e.textAlign){case"right":u=o-d-2;break;case"center":u=(o-d)/2;break;case"left":default:u=2}t+=$t(u)+" "+$t(h)+` Td
`,t+="("+dc(k)+`) Tj
`,t+=-$t(u)+` 0 Td
`,h=-(s+2),d=0,p=E?g:g+1,S++,b=""}break}return n.text=t,n.fontSize=s,n},Nh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},pue={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gue=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find((function(n){return n.type===r.type&&n.object===r.object}))===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},xue=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),yr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},vue=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(si.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(pue)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Mw=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new B8,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)})),e.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&gue(s,r)}})(e)})),e.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)})),e.internal.events.subscribe("postPutPages",(function(r){(function(n,a){var s=!n;for(var i in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],c=[],u=o.Rect;if(o.Rect&&(o.Rect=hue(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=wt.createDefaultAppearanceStream(o),yr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=mue(o);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var f="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var h=o.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var i in h)if(h.hasOwnProperty(i)){var p=h[i];typeof p=="function"&&(p=p.call(a,o)),f+="/"+i+" "+p+" ",a.internal.acroformPlugin.xForms.indexOf(p)>=0||a.internal.acroformPlugin.xForms.push(p)}}else typeof(p=h)=="function"&&(p=p.call(a,o)),f+="/"+i+" "+p,a.internal.acroformPlugin.xForms.indexOf(p)>=0||a.internal.acroformPlugin.xForms.push(p);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}s&&xue(a.internal.acroformPlugin.xForms,a)})(r,e)})),e.internal.acroformPlugin.isInitialized=!0}},M8=Zr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(s!==0&&(a+=" "),yr(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+dc(n(e[s].toString()))+")"):a+=e[s].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},X1=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+dc(n(e))+")"},Si=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Si.prototype.toString=function(){return this.objId+" 0 R"},Si.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Si.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter((function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"}));for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:M8(a,this.objId,this.scope)}):a instanceof Si?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var R8=function(){Si.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ka(R8,Si);var B8=function(){Si.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+dc(r(e))+")"}},set:function(r){e=r}})};Ka(B8,Si);var si=function e(){Si.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!dn(t,3)},set:function(b){b?this.F=fn(t,3):this.F=hn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Km)return;s="FieldObject"+e.FieldNum++}var b=function(S){return S};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+dc(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(b){i=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Mw:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Km||this instanceof Rl))return X1(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Kn?m:X1(m,this.objId,this.scope)},set:function(b){b=b.toString(),m=this instanceof Kn?b:b.substr(0,1)==="("?zc(b.substr(1,b.length-2)):zc(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kn?zc(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof Kn?"/"+b:b}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Kn?h:X1(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=this instanceof Kn?b:b.substr(0,1)==="("?zc(b.substr(1,b.length-2)):zc(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kn?zc(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof Kn?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(b){p=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,1)},set:function(b){b?this.Ff=fn(this.Ff,1):this.Ff=hn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,2)},set:function(b){b?this.Ff=fn(this.Ff,2):this.Ff=hn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,3)},set:function(b){b?this.Ff=fn(this.Ff,3):this.Ff=hn(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');v=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(v){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:v=2;break;case"center":case 1:v=1;break;case"left":case 0:default:v=0}}})};Ka(si,Si);var nu=function(){si.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return M8(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=(function(s,i,o){o||(o=1);for(var c,u=[];c=i.exec(s);)u.push(c[o]);return u})(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,18)},set:function(r){r?this.Ff=fn(this.Ff,18):this.Ff=hn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=fn(this.Ff,19):this.Ff=hn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,20)},set:function(r){r?(this.Ff=fn(this.Ff,20),t.sort()):this.Ff=hn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,22)},set:function(r){r?this.Ff=fn(this.Ff,22):this.Ff=hn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(r){r?this.Ff=fn(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,27)},set:function(r){r?this.Ff=fn(this.Ff,27):this.Ff=hn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ka(nu,si);var au=function(){nu.call(this),this.fontName="helvetica",this.combo=!1};Ka(au,nu);var su=function(){au.call(this),this.combo=!0};Ka(su,au);var Ih=function(){su.call(this),this.edit=!0};Ka(Ih,su);var Kn=function(){si.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,15)},set:function(r){r?this.Ff=fn(this.Ff,15):this.Ff=hn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,16)},set:function(r){r?this.Ff=fn(this.Ff,16):this.Ff=hn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,17)},set:function(r){r?this.Ff=fn(this.Ff,17):this.Ff=hn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(r){r?this.Ff=fn(this.Ff,26):this.Ff=hn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+dc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){yr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ka(Kn,si);var Lh=function(){Kn.call(this),this.pushButton=!0};Ka(Lh,Kn);var iu=function(){Kn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ka(iu,Kn);var Km=function(){var e,t;si.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,i=[];for(s in i.push("<<"),n)i.push("/"+s+" ("+dc(a(n[s]))+")");return i.push(">>"),i.join(`
`)},set:function(a){yr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=wt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ka(Km,si),iu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},iu.prototype.createOption=function(e){var t=new Km;return t.Parent=this,t.optionName=e,this.Kids.push(t),yue.call(this.scope,t),t};var Dh=function(){Kn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=wt.CheckBox.createAppearanceStream()};Ka(Dh,Kn);var Rl=function(){si.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,13)},set:function(t){t?this.Ff=fn(this.Ff,13):this.Ff=hn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,21)},set:function(t){t?this.Ff=fn(this.Ff,21):this.Ff=hn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(t){t?this.Ff=fn(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,24)},set:function(t){t?this.Ff=fn(this.Ff,24):this.Ff=hn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,25)},set:function(t){t?this.Ff=fn(this.Ff,25):this.Ff=hn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(t){t?this.Ff=fn(this.Ff,26):this.Ff=hn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ka(Rl,si);var Mh=function(){Rl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,14)},set:function(e){e?this.Ff=fn(this.Ff,14):this.Ff=hn(this.Ff,14)}}),this.password=!0};Ka(Mh,Rl);var wt={CheckBox:{createAppearanceStream:function(){return{N:{On:wt.CheckBox.YesNormal},D:{On:wt.CheckBox.YesPushDown,Off:wt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=Ly(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+$t(wt.internal.getWidth(e))+" "+$t(wt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+$t(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=xi(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=wt.internal.getHeight(e),i=wt.internal.getWidth(e),o=Ly(e,e.caption);return a.push("1 g"),a.push("0 0 "+$t(i)+" "+$t(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+$t(i-1)+" "+$t(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+$t(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$t(wt.internal.getWidth(e))+" "+$t(wt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:wt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=wt.RadioButton.Circle.YesNormal,t.D[e]=wt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=xi(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=wt.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Mo(wt.internal.getWidth(e)/2)+" "+Mo(wt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*wt.internal.Bezier_C).toFixed(5)),i=Number((n*wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Mo(wt.internal.getWidth(e)/2)+" "+Mo(wt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Mo(wt.internal.getWidth(e)/2)+" "+Mo(wt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Mo(wt.internal.getWidth(e)/2)+" "+Mo(wt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:wt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=wt.RadioButton.Cross.YesNormal,t.D[e]=wt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=xi(e);t.scope=e.scope;var r=[],n=wt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+$t(wt.internal.getWidth(e)-2)+" "+$t(wt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push($t(n.x1.x)+" "+$t(n.x1.y)+" m"),r.push($t(n.x2.x)+" "+$t(n.x2.y)+" l"),r.push($t(n.x4.x)+" "+$t(n.x4.y)+" m"),r.push($t(n.x3.x)+" "+$t(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=wt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+$t(wt.internal.getWidth(e))+" "+$t(wt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+$t(wt.internal.getWidth(e)-2)+" "+$t(wt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push($t(r.x1.x)+" "+$t(r.x1.y)+" m"),n.push($t(r.x2.x)+" "+$t(r.x2.y)+" l"),n.push($t(r.x4.x)+" "+$t(r.x4.y)+" m"),n.push($t(r.x3.x)+" "+$t(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=xi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$t(wt.internal.getWidth(e))+" "+$t(wt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};wt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=wt.internal.getWidth(e),r=wt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},wt.internal.getWidth=function(e){var t=0;return yr(e)==="object"&&(t=BA(e.Rect[2])),t},wt.internal.getHeight=function(e){var t=0;return yr(e)==="object"&&(t=BA(e.Rect[3])),t};var yue=Zr.addField=function(e){if(vue(this,e),!(e instanceof si))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Zr.AcroFormChoiceField=nu,Zr.AcroFormListBox=au,Zr.AcroFormComboBox=su,Zr.AcroFormEditBox=Ih,Zr.AcroFormButton=Kn,Zr.AcroFormPushButton=Lh,Zr.AcroFormRadioButton=iu,Zr.AcroFormCheckBox=Dh,Zr.AcroFormTextField=Rl,Zr.AcroFormPasswordField=Mh,Zr.AcroFormAppearance=wt,Zr.AcroForm={ChoiceField:nu,ListBox:au,ComboBox:su,EditBox:Ih,Button:Kn,PushButton:Lh,RadioButton:iu,CheckBox:Dh,TextField:Rl,PasswordField:Mh,Appearance:wt},Ft.AcroForm={ChoiceField:nu,ListBox:au,ComboBox:su,EditBox:Ih,Button:Kn,PushButton:Lh,RadioButton:iu,CheckBox:Dh,TextField:Rl,PasswordField:Mh,Appearance:wt};Ft.AcroForm;function U8(e){return e.reduce((function(t,r,n){return t[r]=n,t}),{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(F,j){var U,B,X,K,ee,Y=t;if((j=j||t)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(N(F))for(ee in r)for(X=r[ee],U=0;U<X.length;U+=1){for(K=!0,B=0;B<X[U].length;B+=1)if(X[U][B]!==void 0&&X[U][B]!==F[B]){K=!1;break}if(K===!0){Y=ee;break}}else for(ee in r)for(X=r[ee],U=0;U<X.length;U+=1){for(K=!0,B=0;B<X[U].length;B+=1)if(X[U][B]!==void 0&&X[U][B]!==F.charCodeAt(B)){K=!1;break}if(K===!0){Y=ee;break}}return Y===t&&j!==t&&(Y=j),Y},a=function F(j){for(var U=this.internal.write,B=this.internal.putStream,X=(0,this.internal.getFilters)();X.indexOf("FlateEncode")!==-1;)X.splice(X.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:j.width}),K.push({key:"Height",value:j.height}),j.colorSpace===v.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===v.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var ee="",Y=0,z=j.transparency.length;Y<z;Y++)ee+=j.transparency[Y]+" "+j.transparency[Y]+" ";K.push({key:"Mask",value:"["+ee+"]"})}j.sMask!==void 0&&K.push({key:"SMask",value:j.objectId+1+" 0 R"});var ne=j.filter!==void 0?["/"+j.filter]:void 0;if(B({data:j.data,additionalKeyValues:K,alreadyAppliedFilters:ne,objectId:j.objectId}),U("endobj"),"sMask"in j&&j.sMask!==void 0){var le="/Predictor "+j.predictor+" /Colors 1 /BitsPerComponent "+j.bitsPerComponent+" /Columns "+j.width,A={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:le,data:j.sMask};"filter"in j&&(A.filter=j.filter),F.call(this,A)}if(j.colorSpace===v.INDEXED){var D=this.internal.newObject();B({data:k(new Uint8Array(j.palette)),objectId:D}),U("endobj")}},s=function(){var F=this.internal.collections.addImage_images;for(var j in F)a.call(this,F[j])},i=function(){var F,j=this.internal.collections.addImage_images,U=this.internal.write;for(var B in j)U("/I"+(F=j[B]).index,F.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",i))},c=function(){var F=this.internal.collections.addImage_images;return o.call(this),F},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(F){return typeof e["process"+F.toUpperCase()]=="function"},f=function(F){return yr(F)==="object"&&F.nodeType===1},m=function(F,j){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var U=""+F.getAttribute("src");if(U.indexOf("data:image/")===0)return Bd(unescape(U).split("base64,").pop());var B=e.loadFile(U,!0);if(B!==void 0)return B}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var X;switch(j){case"PNG":X="image/png";break;case"WEBP":X="image/webp";break;case"JPEG":case"JPG":default:X="image/jpeg"}return Bd(F.toDataURL(X,1).split("base64,").pop())}},h=function(F){var j=this.internal.collections.addImage_images;if(j){for(var U in j)if(F===j[U].alias)return j[U]}},p=function(F,j,U){return F||j||(F=-96,j=-96),F<0&&(F=-1*U.width*72/F/this.internal.scaleFactor),j<0&&(j=-1*U.height*72/j/this.internal.scaleFactor),F===0&&(F=j*U.width/U.height),j===0&&(j=F*U.height/U.width),[F,j]},g=function(F,j,U,B,X,K){var ee=p.call(this,U,B,X),Y=this.internal.getCoordinateString,z=this.internal.getVerticalCoordinateString,ne=c.call(this);if(U=ee[0],B=ee[1],ne[X.index]=X,K){K*=Math.PI/180;var le=Math.cos(K),A=Math.sin(K),D=function(M){return M.toFixed(4)},L=[D(le),D(A),D(-1*A),D(le),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,Y(F),z(j+B),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([Y(U),"0","0",Y(B),"0","0","cm"].join(" "))):this.internal.write([Y(U),"0","0",Y(B),Y(F),z(j+B),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+X.index+" Do"),this.internal.write("Q")},v=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(F){var j,U,B=0;if(typeof F=="string")for(U=F.length,j=0;j<U;j++)B=(B<<5)-B+F.charCodeAt(j),B|=0;else if(N(F))for(U=F.byteLength/2,j=0;j<U;j++)B=(B<<5)-B+F[j],B|=0;return B},_=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var j=!0;return F.length===0&&(j=!1),F.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(j=!1),j},E=e.__addimage__.extractImageFromDataUrl=function(F){var j=(F=F||"").split("base64,"),U=null;if(j.length===2){var B=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(j[0]);Array.isArray(B)&&(U={mimeType:B[1],charset:B[2],data:j[1]})}return U},P=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(F){return P()&&F instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(F){return P()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},I=e.__addimage__.binaryStringToUint8Array=function(F){for(var j=F.length,U=new Uint8Array(j),B=0;B<j;B++)U[B]=F.charCodeAt(B);return U},k=e.__addimage__.arrayBufferToBinaryString=function(F){for(var j="",U=N(F)?F:new Uint8Array(F),B=0;B<U.length;B+=8192)j+=String.fromCharCode.apply(null,U.subarray(B,B+8192));return j};e.addImage=function(){var F,j,U,B,X,K,ee,Y,z;if(typeof arguments[1]=="number"?(j=t,U=arguments[1],B=arguments[2],X=arguments[3],K=arguments[4],ee=arguments[5],Y=arguments[6],z=arguments[7]):(j=arguments[1],U=arguments[2],B=arguments[3],X=arguments[4],K=arguments[5],ee=arguments[6],Y=arguments[7],z=arguments[8]),yr(F=arguments[0])==="object"&&!f(F)&&"imageData"in F){var ne=F;F=ne.imageData,j=ne.format||j||t,U=ne.x||U||0,B=ne.y||B||0,X=ne.w||ne.width||X,K=ne.h||ne.height||K,ee=ne.alias||ee,Y=ne.compression||Y,z=ne.rotation||ne.angle||z}var le=this.internal.getFilters();if(Y===void 0&&le.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(U)||isNaN(B))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var A=T.call(this,F,j,ee,Y);return g.call(this,U,B,X,K,A,z),this};var T=function(F,j,U,B){var X,K,ee;if(typeof F=="string"&&n(F)===t){F=unescape(F);var Y=q(F,!1);(Y!==""||(Y=e.loadFile(F,!0))!==void 0)&&(F=Y)}if(f(F)&&(F=m(F,j)),j=n(F,j),!d(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((ee=U)==null||ee.length===0)&&(U=(function(z){return typeof z=="string"||N(z)?S(z):N(z.data)?S(z.data):null})(F)),(X=h.call(this,U))||(P()&&(F instanceof Uint8Array||j==="RGBA"||(K=F,F=I(F))),X=this["process"+j.toUpperCase()](F,u.call(this),U,(function(z){return z&&typeof z=="string"&&(z=z.toUpperCase()),z in e.image_compression?z:b.NONE})(B),K)),!X)throw new Error("An unknown error occurred whilst processing the image.");return X},q=e.__addimage__.convertBase64ToBinaryString=function(F,j){var U;j=typeof j!="boolean"||j;var B,X="";if(typeof F=="string"){B=(U=E(F))!==null?U.data:F;try{X=Bd(B)}catch(K){if(j)throw _(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};e.getImageProperties=function(F){var j,U,B="";if(f(F)&&(F=m(F)),typeof F=="string"&&n(F)===t&&((B=q(F,!1))===""&&(B=e.loadFile(F)||""),F=B),U=n(F),!d(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(!P()||F instanceof Uint8Array||(F=I(F)),!(j=this["process"+U.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=U,j}})(Ft.API),(function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ft.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,s,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var h=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),S=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(b(n.contents))+")",s+=" /Popup "+v.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(b(S))+") >>",g.content=s;var _=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(s+=" /Open true"),s+=" >>",v.content=s,this.internal.write(g.objId,"0 R",v.objId,"0 R");break;case"freetext":a="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var E=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(p(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var P=this.annotations._nameMap[n.options.name];n.options.pageNumber=P.page,n.options.top=P.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var N=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+N+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,s,i){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:i,type:"link"})},e.textWithLink=function(r,n,a,s){var i,o,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var d=this.splitTextToSize(r,o).length;i=Math.ceil(u*d)}else o=c,i=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,o,i,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(Ft.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var v=0,b=r,S="",_=0;for(v=0;v<g.length;v+=1)b[g.charCodeAt(v)]!==void 0?(_++,typeof(b=b[g.charCodeAt(v)])=="number"&&(S+=String.fromCharCode(b),b=r,_=0),v===g.length-1&&(b=r,S+=g.charAt(v-(_-1)),v-=_-1,_=0)):(b=r,S+=g.charAt(v-_),v-=_,_=0);return S};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(g,v,b){return i(g)?s(g)===!1?-1:!u(g)||!i(v)&&!i(b)||!i(b)&&o(v)||o(g)&&!i(v)||o(g)&&c(v)||o(g)&&o(v)?0:d(g)&&i(v)&&!o(v)&&i(b)&&u(b)?3:o(g)||!i(b)?1:2:-1},h=function(g){var v=0,b=0,S=0,_="",E="",P="",N=(g=g||"").split("\\s+"),I=[];for(v=0;v<N.length;v+=1){for(I.push(""),b=0;b<N[v].length;b+=1)_=N[v][b],E=N[v][b-1],P=N[v][b+1],i(_)?(S=m(_,E,P),I[v]+=S!==-1?String.fromCharCode(t[_.charCodeAt(0)][S]):_):I[v]+=_;I[v]=f(I[v])}return I.join(" ")},p=e.__arabicParser__.processArabic=e.processArabic=function(){var g,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(v)){var S=0;for(b=[],S=0;S<v.length;S+=1)Array.isArray(v[S])?b.push([h(v[S][0]),v[S][1],v[S][2]]):b.push([h(v[S])]);g=b}else g=h(v);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",p])})(Ft.API),Ft.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+t+" 0 R")}))}return this},(function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(Ft.API),(function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(g){p=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,h=0,p=0,g=0,v=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce((function(_,E){return _.concat(v.splitTextToSize(E,b))}),[])):c=Array.isArray(c)?c:[c];for(var S=0;S<c.length;S++)h<(g=this.getStringUnitWidth(c[S],{font:f})*d)&&(h=g);return h!==0&&(p=c.length),{w:h/=m,h:Math.max((p*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,m){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,p,g,v,b=[],S=[],_=[],E={},P={},N=[],I=[],k=(m=m||{}).autoSize||!1,T=m.printHeaders!==!1,q=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,F=m.margins||Object.assign({width:this.getPageWidth()},t),j=typeof m.padding=="number"?m.padding:3,U=m.headerBackgroundColor||"#c8c8c8",B=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=q,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=B,this.setFontSize(q),f==null)S=b=Object.keys(d[0]),_=b.map((function(){return"left"}));else if(Array.isArray(f)&&yr(f[0])==="object")for(b=f.map((function(ne){return ne.name})),S=f.map((function(ne){return ne.prompt||ne.name||""})),_=f.map((function(ne){return ne.align||"left"})),h=0;h<f.length;h+=1)P[f[h].name]=f[h].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(S=b=f,_=b.map((function(){return"left"})));if(k||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<b.length;h+=1){for(E[v=b[h]]=d.map((function(ne){return ne[v]})),this.setFont(void 0,"bold"),N.push(this.getTextDimensions(S[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=E[v],this.setFont(void 0,"normal"),g=0;g<p.length;g+=1)N.push(this.getTextDimensions(p[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[v]=Math.max.apply(null,N)+j+j,N=[]}if(T){var X={};for(h=0;h<b.length;h+=1)X[b[h]]={},X[b[h]].text=S[h],X[b[h]].align=_[h];var K=o.call(this,X,P);I=b.map((function(ne){return new s(c,u,P[ne],K,X[ne].text,void 0,X[ne].align)})),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var ee=f.reduce((function(ne,le){return ne[le.name]=le.align,ne}),{});for(h=0;h<d.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:d[h]},this);var Y=o.call(this,d[h],P);for(g=0;g<b.length;g+=1){var z=d[h][b[g]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:g,data:z},this),i.call(this,new s(c,u,P[b[g]],Y,z,h+2,ee[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var o=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map((function(h){var p=c[h];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,u[h]-d-d)}),this).map((function(h){return this.getLineHeightFactor()*h.length*f/m+d+d}),this).reduce((function(h,p){return Math.max(h,p)}),0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,m.push(d)),d.lineNumber=c;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,d),this.setTextColor(p)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}})(Ft.API);var z8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Dy=U8($8),W8=[100,200,300,400,500,600,700,800,900],bue=U8(W8);function My(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return z8[s=s||"normal"]?s:"normal"})(e.style),n=(function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}})(e.weight),a=(function(s){return typeof Dy[s=s||"normal"]=="number"?s:"normal"})(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function UA(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var wue={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},zA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function $A(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Sue(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},wue,r.genericFontFamilies||{}),s=null,i=null,o=0;o<t.length;++o)if(a[(s=My(t[o])).family]&&(s.family=a[s.family]),e.hasOwnProperty(s.family)){i=e[s.family];break}if(!(i=i||e[n]))throw new Error("Could not find a font-family for the rule '"+$A(s)+"' and default family '"+n+"'.");if(i=(function(c,u){if(u[c])return u[c];var d=Dy[c],f=d<=Dy.normal?-1:1,m=UA(u,$8,d,f);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m})(s.stretch,i),i=(function(c,u){if(u[c])return u[c];for(var d=z8[c],f=0;f<d.length;++f)if(u[d[f]])return u[d[f]];throw new Error("Could not find a matching font-style for "+c)})(s.style,i),!(i=(function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=bue[c],f=UA(u,W8,d,c<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+c);return f})(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+$A(s)+"'.");return i}function WA(e){return e.trimLeft()}function _ue(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Nue(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Ah,HA,qA,J1=["times"];(function(e){var t,r,n,a,s,i,o,c,u,d=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new c,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new i,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new i,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=A;Object.defineProperty(this,"pdf",{get:function(){return D}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(he){L=!!he}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(he){M=!!he}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(he){isNaN(he)||(R=he)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(he){isNaN(he)||(H=he)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(he){var Z;typeof he=="number"?Z=[he,he,he,he]:((Z=new Array(4))[0]=he[0],Z[1]=he.length>=2?he[1]:Z[0],Z[2]=he.length>=3?he[2]:Z[0],Z[3]=he.length>=4?he[3]:Z[1]),u.margin=Z}});var J=!1;Object.defineProperty(this,"autoPaging",{get:function(){return J},set:function(he){J=he}});var G=0;Object.defineProperty(this,"lastBreak",{get:function(){return G},set:function(he){G=he}});var Q=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Q},set:function(he){Q=he}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(he){he instanceof d&&(u=he)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(he){u.path=he}});var de=[];Object.defineProperty(this,"ctxStack",{get:function(){return de},set:function(he){de=he}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(he){var Z;Z=m(he),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(he){var Z=m(he);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(he){["butt","round","square"].indexOf(he)!==-1&&(this.ctx.lineCap=he,this.pdf.setLineCap(he))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(he){isNaN(he)||(this.ctx.lineWidth=he,this.pdf.setLineWidth(he))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(he){["bevel","round","miter"].indexOf(he)!==-1&&(this.ctx.lineJoin=he,this.pdf.setLineJoin(he))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(he){isNaN(he)||(this.ctx.miterLimit=he,this.pdf.setMiterLimit(he))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(he){this.ctx.textBaseline=he}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(he){["right","end","center","left","start"].indexOf(he)!==-1&&(this.ctx.textAlign=he)}});var V=null;function Ee(he,Z){if(V===null){var Se=(function(ge){var pe=[];return Object.keys(ge).forEach((function(Ae){ge[Ae].forEach((function(Le){var Pe=null;switch(Le){case"bold":Pe={family:Ae,weight:"bold"};break;case"italic":Pe={family:Ae,style:"italic"};break;case"bolditalic":Pe={family:Ae,weight:"bold",style:"italic"};break;case"":case"normal":Pe={family:Ae}}Pe!==null&&(Pe.ref={name:Ae,style:Le},pe.push(Pe))}))})),pe})(he.getFontList());V=(function(ge){for(var pe={},Ae=0;Ae<ge.length;++Ae){var Le=My(ge[Ae]),Pe=Le.family,Oe=Le.stretch,Ve=Le.style,et=Le.weight;pe[Pe]=pe[Pe]||{},pe[Pe][Oe]=pe[Pe][Oe]||{},pe[Pe][Oe][Ve]=pe[Pe][Oe][Ve]||{},pe[Pe][Oe][Ve][et]=Le}return pe})(Se.concat(Z))}return V}var we=null;Object.defineProperty(this,"fontFaces",{get:function(){return we},set:function(he){V=null,we=he}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(he){var Z;if(this.ctx.font=he,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(he))!==null){var Se=Z[1],ge=(Z[2],Z[3]),pe=Z[4],Ae=(Z[5],Z[6]),Le=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(pe)[2];pe=Math.floor(Le==="px"?parseFloat(pe)*this.pdf.internal.scaleFactor:Le==="em"?parseFloat(pe)*this.pdf.getFontSize():parseFloat(pe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(pe);var Pe=(function(pt){var lt,rt,Zt=[],jt=pt.trim();if(jt==="")return J1;if(jt in zA)return[zA[jt]];for(;jt!=="";){switch(rt=null,lt=(jt=WA(jt)).charAt(0)){case'"':case"'":rt=_ue(jt.substring(1),lt);break;default:rt=Nue(jt)}if(rt===null||(Zt.push(rt[0]),(jt=WA(rt[1]))!==""&&jt.charAt(0)!==","))return J1;jt=jt.replace(/^,/,"")}return Zt})(Ae);if(this.fontFaces){var Oe=Sue(Ee(this.pdf,this.fontFaces),Pe.map((function(pt){return{family:pt,stretch:"normal",weight:ge,style:Se}})));this.pdf.setFont(Oe.ref.name,Oe.ref.style)}else{var Ve="";(ge==="bold"||parseInt(ge,10)>=700||Se==="bold")&&(Ve="bold"),Se==="italic"&&(Ve+="italic"),Ve.length===0&&(Ve="normal");for(var et="",_t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Tt=0;Tt<Pe.length;Tt++){if(this.pdf.internal.getFont(Pe[Tt],Ve,{noFallback:!0,disableWarning:!0})!==void 0){et=Pe[Tt];break}if(Ve==="bolditalic"&&this.pdf.internal.getFont(Pe[Tt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)et=Pe[Tt],Ve="bold";else if(this.pdf.internal.getFont(Pe[Tt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){et=Pe[Tt],Ve="normal";break}}if(et===""){for(var At=0;At<Pe.length;At++)if(_t[Pe[At]]){et=_t[Pe[At]];break}}et=et===""?"Times":et,this.pdf.setFont(et,Ve)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(he){this.ctx.globalCompositeOperation=he}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(he){this.ctx.globalAlpha=he}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(he){this.ctx.lineDashOffset=he,le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(he){this.ctx.lineDash=he,le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(he){this.ctx.ignoreClearRect=!!he}})};f.prototype.setLineDash=function(A){this.lineDash=A},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){E.call(this,"fill",!1)},f.prototype.stroke=function(){E.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(A,D){if(isNaN(A)||isNaN(D))throw jr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new i(A,D));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(A,D)},f.prototype.closePath=function(){var A=new i(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&yr(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){A=new i(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(A.x,A.y)},f.prototype.lineTo=function(A,D){if(isNaN(A)||isNaN(D))throw jr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new i(A,D));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new i(L.x,L.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},f.prototype.quadraticCurveTo=function(A,D,L,M){if(isNaN(L)||isNaN(M)||isNaN(A)||isNaN(D))throw jr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new i(L,M)),H=this.ctx.transform.applyToPoint(new i(A,D));this.path.push({type:"qct",x1:H.x,y1:H.y,x:R.x,y:R.y}),this.ctx.lastPoint=new i(R.x,R.y)},f.prototype.bezierCurveTo=function(A,D,L,M,R,H){if(isNaN(R)||isNaN(H)||isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M))throw jr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var J=this.ctx.transform.applyToPoint(new i(R,H)),G=this.ctx.transform.applyToPoint(new i(A,D)),Q=this.ctx.transform.applyToPoint(new i(L,M));this.path.push({type:"bct",x1:G.x,y1:G.y,x2:Q.x,y2:Q.y,x:J.x,y:J.y}),this.ctx.lastPoint=new i(J.x,J.y)},f.prototype.arc=function(A,D,L,M,R,H){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M)||isNaN(R))throw jr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var J=this.ctx.transform.applyToPoint(new i(A,D));A=J.x,D=J.y;var G=this.ctx.transform.applyToPoint(new i(0,L)),Q=this.ctx.transform.applyToPoint(new i(0,0));L=Math.sqrt(Math.pow(G.x-Q.x,2)+Math.pow(G.y-Q.y,2))}Math.abs(R-M)>=2*Math.PI&&(M=0,R=2*Math.PI),this.path.push({type:"arc",x:A,y:D,radius:L,startAngle:M,endAngle:R,counterclockwise:H})},f.prototype.arcTo=function(A,D,L,M,R){throw new Error("arcTo not implemented.")},f.prototype.rect=function(A,D,L,M){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M))throw jr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,D),this.lineTo(A+L,D),this.lineTo(A+L,D+M),this.lineTo(A,D+M),this.lineTo(A,D),this.lineTo(A+L,D),this.lineTo(A,D)},f.prototype.fillRect=function(A,D,L,M){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M))throw jr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,D,L,M),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},f.prototype.strokeRect=function(A,D,L,M){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M))throw jr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(A,D,L,M),this.stroke())},f.prototype.clearRect=function(A,D,L,M){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M))throw jr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,D,L,M))},f.prototype.save=function(A){A=typeof A!="boolean"||A;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},f.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(D),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(A){var D,L,M,R;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))D=0,L=0,M=0,R=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(H!==null)D=parseInt(H[1]),L=parseInt(H[2]),M=parseInt(H[3]),R=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)D=parseInt(H[1]),L=parseInt(H[2]),M=parseInt(H[3]),R=parseFloat(H[4]);else{if(R=1,typeof A=="string"&&A.charAt(0)!=="#"){var J=new I8(A);A=J.ok?J.toHex():"#000000"}A.length===4?(D=A.substring(1,2),D+=D,L=A.substring(2,3),L+=L,M=A.substring(3,4),M+=M):(D=A.substring(1,3),L=A.substring(3,5),M=A.substring(5,7)),D=parseInt(D,16),L=parseInt(L,16),M=parseInt(M,16)}}return{r:D,g:L,b:M,a:R,style:A}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(A,D,L,M){if(isNaN(D)||isNaN(L)||typeof A!="string")throw jr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var R=Y(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;j.call(this,{text:A,x:D,y:L,scale:H,angle:R,align:this.textAlign,maxWidth:M})}},f.prototype.strokeText=function(A,D,L,M){if(isNaN(D)||isNaN(L)||typeof A!="string")throw jr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){M=isNaN(M)?void 0:M;var R=Y(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;j.call(this,{text:A,x:D,y:L,scale:H,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:M})}},f.prototype.measureText=function(A){if(typeof A!="string")throw jr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,L=this.pdf.internal.scaleFactor,M=D.internal.getFontSize(),R=D.getStringUnitWidth(A)*M/D.internal.scaleFactor,H=function(J){var G=(J=J||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return G}}),this};return new H({width:R*=Math.round(96*L/72*1e4)/1e4})},f.prototype.scale=function(A,D){if(isNaN(A)||isNaN(D))throw jr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new c(A,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.rotate=function(A){if(isNaN(A))throw jr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.translate=function(A,D){if(isNaN(A)||isNaN(D))throw jr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new c(1,0,0,1,A,D);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.transform=function(A,D,L,M,R,H){if(isNaN(A)||isNaN(D)||isNaN(L)||isNaN(M)||isNaN(R)||isNaN(H))throw jr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var J=new c(A,D,L,M,R,H);this.ctx.transform=this.ctx.transform.multiply(J)},f.prototype.setTransform=function(A,D,L,M,R,H){A=isNaN(A)?1:A,D=isNaN(D)?0:D,L=isNaN(L)?0:L,M=isNaN(M)?1:M,R=isNaN(R)?0:R,H=isNaN(H)?0:H,this.ctx.transform=new c(A,D,L,M,R,H)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(A,D,L,M,R,H,J,G,Q){var de=this.pdf.getImageProperties(A),V=1,Ee=1,we=1,he=1;M!==void 0&&G!==void 0&&(we=G/M,he=Q/R,V=de.width/M*G/M,Ee=de.height/R*Q/R),H===void 0&&(H=D,J=L,D=0,L=0),M!==void 0&&G===void 0&&(G=M,Q=R),M===void 0&&G===void 0&&(G=de.width,Q=de.height);for(var Z,Se=this.ctx.transform.decompose(),ge=Y(Se.rotate.shx),pe=new c,Ae=(pe=(pe=(pe=pe.multiply(Se.translate)).multiply(Se.skew)).multiply(Se.scale)).applyToRectangle(new o(H-D*we,J-L*he,M*V,R*Ee)),Le=v.call(this,Ae),Pe=[],Oe=0;Oe<Le.length;Oe+=1)Pe.indexOf(Le[Oe])===-1&&Pe.push(Le[Oe]);if(_(Pe),this.autoPaging)for(var Ve=Pe[0],et=Pe[Pe.length-1],_t=Ve;_t<et+1;_t++){this.pdf.setPage(_t);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],At=_t===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],rt=_t===1?0:pt+(_t-2)*lt;if(this.ctx.clip_path.length!==0){var Zt=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Z,this.posX+this.margin[3],-rt+At+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=Zt}var jt=JSON.parse(JSON.stringify(Ae));jt=S([jt],this.posX+this.margin[3],-rt+At+this.ctx.prevPageLastElemOffset)[0];var Mr=(_t>Ve||_t<et)&&g.call(this);Mr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,lt,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",jt.x,jt.y,jt.w,jt.h,null,null,ge),Mr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Ae.x,Ae.y,Ae.w,Ae.h,null,null,ge)};var v=function(A,D,L){var M=[];D=D||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":M.push(Math.floor((A.y+R)/L)+1);break;case"arc":M.push(Math.floor((A.y+R-A.radius)/L)+1),M.push(Math.floor((A.y+R+A.radius)/L)+1);break;case"qct":var H=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);M.push(Math.floor((H.y+R)/L)+1),M.push(Math.floor((H.y+H.h+R)/L)+1);break;case"bct":var J=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);M.push(Math.floor((J.y+R)/L)+1),M.push(Math.floor((J.y+J.h+R)/L)+1);break;case"rect":M.push(Math.floor((A.y+R)/L)+1),M.push(Math.floor((A.y+A.h+R)/L)+1)}for(var G=0;G<M.length;G+=1)for(;this.pdf.internal.getNumberOfPages()<M[G];)b.call(this);return M},b=function(){var A=this.fillStyle,D=this.strokeStyle,L=this.font,M=this.lineCap,R=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=D,this.font=L,this.lineCap=M,this.lineWidth=R,this.lineJoin=H},S=function(A,D,L){for(var M=0;M<A.length;M++)switch(A[M].type){case"bct":A[M].x2+=D,A[M].y2+=L;case"qct":A[M].x1+=D,A[M].y1+=L;case"mt":case"lt":case"arc":default:A[M].x+=D,A[M].y+=L}return A},_=function(A){return A.sort((function(D,L){return D-L}))},E=function(A,D){for(var L,M,R=this.fillStyle,H=this.strokeStyle,J=this.lineCap,G=this.lineWidth,Q=Math.abs(G*this.ctx.transform.scaleX),de=this.lineJoin,V=JSON.parse(JSON.stringify(this.path)),Ee=JSON.parse(JSON.stringify(this.path)),we=[],he=0;he<Ee.length;he++)if(Ee[he].x!==void 0)for(var Z=v.call(this,Ee[he]),Se=0;Se<Z.length;Se+=1)we.indexOf(Z[Se])===-1&&we.push(Z[Se]);for(var ge=0;ge<we.length;ge++)for(;this.pdf.internal.getNumberOfPages()<we[ge];)b.call(this);if(_(we),this.autoPaging)for(var pe=we[0],Ae=we[we.length-1],Le=pe;Le<Ae+1;Le++){this.pdf.setPage(Le),this.fillStyle=R,this.strokeStyle=H,this.lineCap=J,this.lineWidth=Q,this.lineJoin=de;var Pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Oe=Le===1?this.posY+this.margin[0]:this.margin[0],Ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=Le===1?0:Ve+(Le-2)*et;if(this.ctx.clip_path.length!==0){var Tt=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(L,this.posX+this.margin[3],-_t+Oe+this.ctx.prevPageLastElemOffset),P.call(this,A,!0),this.path=Tt}if(M=JSON.parse(JSON.stringify(V)),this.path=S(M,this.posX+this.margin[3],-_t+Oe+this.ctx.prevPageLastElemOffset),D===!1||Le===0){var At=(Le>pe||Le<Ae)&&g.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pe,et,null).clip().discardPath()),P.call(this,A,D),At&&this.pdf.restoreGraphicsState()}this.lineWidth=G}else this.lineWidth=Q,P.call(this,A,D),this.lineWidth=G;this.path=V},P=function(A,D){if((A!=="stroke"||D||!p.call(this))&&(A==="stroke"||D||!h.call(this))){for(var L,M,R=[],H=this.path,J=0;J<H.length;J++){var G=H[J];switch(G.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:G,deltas:[],abs:[]});break;case"lt":var Q=R.length;if(H[J-1]&&!isNaN(H[J-1].x)&&(L=[G.x-H[J-1].x,G.y-H[J-1].y],Q>0)){for(;Q>=0;Q--)if(R[Q-1].close!==!0&&R[Q-1].begin!==!0){R[Q-1].deltas.push(L),R[Q-1].abs.push(G);break}}break;case"bct":L=[G.x1-H[J-1].x,G.y1-H[J-1].y,G.x2-H[J-1].x,G.y2-H[J-1].y,G.x-H[J-1].x,G.y-H[J-1].y],R[R.length-1].deltas.push(L);break;case"qct":var de=H[J-1].x+2/3*(G.x1-H[J-1].x),V=H[J-1].y+2/3*(G.y1-H[J-1].y),Ee=G.x+2/3*(G.x1-G.x),we=G.y+2/3*(G.y1-G.y),he=G.x,Z=G.y;L=[de-H[J-1].x,V-H[J-1].y,Ee-H[J-1].x,we-H[J-1].y,he-H[J-1].x,Z-H[J-1].y],R[R.length-1].deltas.push(L);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push(G)}}M=D?null:A==="stroke"?"stroke":"fill";for(var Se=!1,ge=0;ge<R.length;ge++)if(R[ge].arc)for(var pe=R[ge].abs,Ae=0;Ae<pe.length;Ae++){var Le=pe[Ae];Le.type==="arc"?k.call(this,Le.x,Le.y,Le.radius,Le.startAngle,Le.endAngle,Le.counterclockwise,void 0,D,!Se):U.call(this,Le.x,Le.y),Se=!0}else if(R[ge].close===!0)this.pdf.internal.out("h"),Se=!1;else if(R[ge].begin!==!0){var Pe=R[ge].start.x,Oe=R[ge].start.y;B.call(this,R[ge].deltas,Pe,Oe),Se=!0}M&&T.call(this,M),D&&q.call(this)}},N=function(A){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-L;case"top":return A+D-L;case"hanging":return A+D-2*L;case"middle":return A+D/2-L;case"ideographic":return A;case"alphabetic":default:return A}},I=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(D,L){this.colorStops.push([D,L])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(A,D,L,M,R,H,J,G,Q){for(var de=K.call(this,L,M,R,H),V=0;V<de.length;V++){var Ee=de[V];V===0&&(Q?F.call(this,Ee.x1+A,Ee.y1+D):U.call(this,Ee.x1+A,Ee.y1+D)),X.call(this,A,D,Ee.x2,Ee.y2,Ee.x3,Ee.y3,Ee.x4,Ee.y4)}G?q.call(this):T.call(this,J)},T=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},q=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(A,D){this.pdf.internal.out(r(A)+" "+n(D)+" m")},j=function(A){var D;switch(A.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var L=this.pdf.getTextDimensions(A.text),M=N.call(this,A.y),R=I.call(this,M)-L.h,H=this.ctx.transform.applyToPoint(new i(A.x,M)),J=this.ctx.transform.decompose(),G=new c;G=(G=(G=G.multiply(J.translate)).multiply(J.skew)).multiply(J.scale);for(var Q,de,V,Ee=this.ctx.transform.applyToRectangle(new o(A.x,M,L.w,L.h)),we=G.applyToRectangle(new o(A.x,R,L.w,L.h)),he=v.call(this,we),Z=[],Se=0;Se<he.length;Se+=1)Z.indexOf(he[Se])===-1&&Z.push(he[Se]);if(_(Z),this.autoPaging)for(var ge=Z[0],pe=Z[Z.length-1],Ae=ge;Ae<pe+1;Ae++){this.pdf.setPage(Ae);var Le=Ae===1?this.posY+this.margin[0]:this.margin[0],Pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Oe=this.pdf.internal.pageSize.height-this.margin[2],Ve=Oe-this.margin[0],et=this.pdf.internal.pageSize.width-this.margin[1],_t=et-this.margin[3],Tt=Ae===1?0:Pe+(Ae-2)*Ve;if(this.ctx.clip_path.length!==0){var At=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Q,this.posX+this.margin[3],-1*Tt+Le),P.call(this,"fill",!0),this.path=At}var pt=S([JSON.parse(JSON.stringify(we))],this.posX+this.margin[3],-Tt+Le+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*A.scale),V=this.lineWidth,this.lineWidth=V*A.scale);var lt=this.autoPaging!=="text";if(lt||pt.y+pt.h<=Oe){if(lt||pt.y>=Le&&pt.x<=et){var rt=lt?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||et-pt.x)[0],Zt=S([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-Tt+Le+this.ctx.prevPageLastElemOffset)[0],jt=lt&&(Ae>ge||Ae<pe)&&g.call(this);jt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,Ve,null).clip().discardPath()),this.pdf.text(rt,Zt.x,Zt.y,{angle:A.angle,align:D,renderingMode:A.renderingMode}),jt&&this.pdf.restoreGraphicsState()}}else pt.y<Oe&&(this.ctx.prevPageLastElemOffset+=Oe-pt.y);A.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=V)}else A.scale>=.01&&(de=this.pdf.internal.getFontSize(),this.pdf.setFontSize(de*A.scale),V=this.lineWidth,this.lineWidth=V*A.scale),this.pdf.text(A.text,H.x+this.posX,H.y+this.posY,{angle:A.angle,align:D,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(de),this.lineWidth=V)},U=function(A,D,L,M){L=L||0,M=M||0,this.pdf.internal.out(r(A+L)+" "+n(D+M)+" l")},B=function(A,D,L){return this.pdf.lines(A,D,L,null,null)},X=function(A,D,L,M,R,H,J,G){this.pdf.internal.out([t(a(L+A)),t(s(M+D)),t(a(R+A)),t(s(H+D)),t(a(J+A)),t(s(G+D)),"c"].join(" "))},K=function(A,D,L,M){for(var R=2*Math.PI,H=Math.PI/2;D>L;)D-=R;var J=Math.abs(L-D);J<R&&M&&(J=R-J);for(var G=[],Q=M?-1:1,de=D;J>1e-5;){var V=de+Q*Math.min(J,H);G.push(ee.call(this,A,de,V)),J-=Math.abs(V-de),de=V}return G},ee=function(A,D,L){var M=(L-D)/2,R=A*Math.cos(M),H=A*Math.sin(M),J=R,G=-H,Q=J*J+G*G,de=Q+J*R+G*H,V=4/3*(Math.sqrt(2*Q*de)-de)/(J*H-G*R),Ee=J-V*G,we=G+V*J,he=Ee,Z=-we,Se=M+D,ge=Math.cos(Se),pe=Math.sin(Se);return{x1:A*Math.cos(D),y1:A*Math.sin(D),x2:Ee*ge-we*pe,y2:Ee*pe+we*ge,x3:he*ge-Z*pe,y3:he*pe+Z*ge,x4:A*Math.cos(L),y4:A*Math.sin(L)}},Y=function(A){return 180*A/Math.PI},z=function(A,D,L,M,R,H){var J=A+.5*(L-A),G=D+.5*(M-D),Q=R+.5*(L-R),de=H+.5*(M-H),V=Math.min(A,R,J,Q),Ee=Math.max(A,R,J,Q),we=Math.min(D,H,G,de),he=Math.max(D,H,G,de);return new o(V,we,Ee-V,he-we)},ne=function(A,D,L,M,R,H,J,G){var Q,de,V,Ee,we,he,Z,Se,ge,pe,Ae,Le,Pe,Oe,Ve=L-A,et=M-D,_t=R-L,Tt=H-M,At=J-R,pt=G-H;for(de=0;de<41;de++)ge=(Z=(V=A+(Q=de/40)*Ve)+Q*((we=L+Q*_t)-V))+Q*(we+Q*(R+Q*At-we)-Z),pe=(Se=(Ee=D+Q*et)+Q*((he=M+Q*Tt)-Ee))+Q*(he+Q*(H+Q*pt-he)-Se),de==0?(Ae=ge,Le=pe,Pe=ge,Oe=pe):(Ae=Math.min(Ae,ge),Le=Math.min(Le,pe),Pe=Math.max(Pe,ge),Oe=Math.max(Oe,pe));return new o(Math.round(Ae),Math.round(Le),Math.round(Pe-Ae),Math.round(Oe-Le))},le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,D,L=(A=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:D}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(Ft.API),(function(e){var t=function(s){var i,o,c,u,d,f,m,h,p,g;for(o=[],c=0,u=(s+=i="\0\0\0\0".slice(s.length%4||4)).length;u>c;c+=4)(d=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(f=(d=((d=((d=((d=(d-(g=d%85))/85)-(p=d%85))/85)-(h=d%85))/85)-(m=d%85))/85)%85,o.push(f+33,m+33,h+33,p+33,g+33)):o.push(122);return(function(v,b){for(var S=b;S>0;S--)v.pop()})(o,i.length),String.fromCharCode.apply(String,o)+"~>"},r=function(s){var i,o,c,u,d,f=String,m="length",h=255,p="charCodeAt",g="slice",v="replace";for(s[g](-2),s=s[g](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),c=[],u=0,d=(s+=i="uuuuu"[g](s[m]%5||5))[m];d>u;u+=5)o=52200625*(s[p](u)-33)+614125*(s[p](u+1)-33)+7225*(s[p](u+2)-33)+85*(s[p](u+3)-33)+(s[p](u+4)-33),c.push(h&o>>24,h&o>>16,h&o>>8,h&o);return(function(b,S){for(var _=S;_>0;_--)b.pop()})(c,i[m]),f.fromCharCode.apply(f,c)},n=function(s){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),i.test(s)===!1)return"";for(var o="",c=0;c<s.length;c+=2)o+=String.fromCharCode("0x"+(s[c]+s[c+1]));return o},a=function(s){for(var i=new Uint8Array(s.length),o=s.length;o--;)i[o]=s.charCodeAt(o);return s=(i=Py(i)).reduce((function(c,u){return c+String.fromCharCode(u)}),"")};e.processDataByFilters=function(s,i){var o=0,c=s||"",u=[];for(typeof(i=i||[])=="string"&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map((function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)})).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(Ft.API),(function(e){e.loadFile=function(t,r,n){return(function(a,s,i){s=s!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=(function(c,u,d){var f=new XMLHttpRequest,m=0,h=function(p){var g=p.length,v=[],b=String.fromCharCode;for(m=0;m<g;m+=1)v.push(b(255&p.charCodeAt(m)));return v.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)})(a,s,i)}catch{}return o})(t,r,n)},e.loadImageFile=e.loadFile})(Ft.API),(function(e){function t(){return(Dt.html2canvas?Promise.resolve(Dt.html2canvas):jy(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch((function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))})).then((function(i){return i.default?i.default:i}))}function r(){return(Dt.DOMPurify?Promise.resolve(Dt.DOMPurify):jy(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(i){return Promise.reject(new Error("Could not load dompurify: "+i))})).then((function(i){return i.default?i.default:i}))}var n=function(i){var o=yr(i);return o==="undefined"?"undefined":o==="string"||i instanceof String?"string":o==="number"||i instanceof Number?"number":o==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(i,o){var c=document.createElement(i);for(var u in o.className&&(c.className=o.className),o.innerHTML&&o.dompurify&&(c.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)c.style[u]=o.style[u];return c},s=function i(o){var c=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),u=i.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,i,1,[i])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(i,o){return i.__proto__=o||s.prototype,i},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(i,o){return this.then((function(){switch(o=o||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(i)){case"string":return this.then(r).then((function(c){return this.set({src:a("div",{innerHTML:i,dompurify:c})})}));case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}}))},s.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function c(u,d){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),m=u.firstChild;m;m=m.nextSibling)d!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||f.appendChild(c(m,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",(function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft}),!0)),f})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},s.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(t).then((function(o){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,o(this.prop.container,c)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(t).then((function(o){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var h=u[m],p=h.src.find((function(g){return g.format==="truetype"}));p&&c.addFont(p.url,h.ref.name,h.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,c.context2d.save(!0),o(this.prop.container,f)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i}))},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},s.prototype.output=function(i,o,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(i,o):this.outputPdf(i,o)},s.prototype.outputPdf=function(i,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(i,o)}))},s.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}}))},s.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},s.prototype.set=function(i){if(n(i)!=="object")return this;var o=Object.keys(i||{}).map((function(c){if(c in s.template.prop)return function(){this.prop[c]=i[c]};switch(c){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[c]=i[c]}}}),this);return this.then((function(){return this.thenList(o)}))},s.prototype.get=function(i,o){return this.then((function(){var c=i in s.template.prop?this.prop[i]:this.opt[i];return o?o(c):c}))},s.prototype.setMargin=function(i){return this.then((function(){switch(n(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i})).then(this.setPageSize)},s.prototype.setPageSize=function(i){function o(c,u){return Math.floor(c*u/72*96)}return this.then((function(){(i=i||Ft.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:o(i.inner.width,i.k),height:o(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i}))},s.prototype.setProgress=function(i,o,c,u){return i!=null&&(this.progress.val=i),o!=null&&(this.progress.state=o),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(i,o,c,u){return this.setProgress(i?this.progress.val+i:null,o||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(i,o){var c=this;return this.thenCore(i,o,(function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,(function(f){return c.updateProgress(null,u),f})).then(u,d).then((function(f){return c.updateProgress(1),f}))}))},s.prototype.thenCore=function(i,o,c){c=c||Promise.prototype.then,i&&(i=i.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),d=c.call(u,i,o);return s.convert(d,this.__proto__)},s.prototype.thenExternal=function(i,o){return Promise.prototype.then.call(this,i,o)},s.prototype.thenList=function(i){var o=this;return i.forEach((function(c){o=o.thenCore(c)})),o},s.prototype.catch=function(i){i&&(i=i.bind(this));var o=Promise.prototype.catch.call(this,i);return s.convert(o,this)},s.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},s.prototype.error=function(i){return this.then((function(){throw new Error(i)}))},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Ft.getPageSize=function(i,o,c){if(yr(i)==="object"){var u=i;i=u.orientation,o=u.unit||o,c=u.format||c}o=o||"mm",c=c||"a4",i=(""+(i||"P")).toLowerCase();var d,f=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+o}var h,p=0,g=0;if(m.hasOwnProperty(f))p=m[f][1]/d,g=m[f][0]/d;else try{p=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(i==="p"||i==="portrait")i="p",g>p&&(h=g,g=p,p=h);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",p>g&&(h=g,g=p,p=h)}return{width:g,height:p,unit:o,k:d,orientation:i}},e.html=function(i,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(My):null;var c=new s(o);return o.worker?c:c.from(i).doCallback()}})(Ft.API),Ft.API.addJS=function(e){return qA=e,this.internal.events.subscribe("postPutResources",(function(){Ah=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ah+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),HA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+qA+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){Ah!==void 0&&HA!==void 0&&this.internal.out("/Names <</JavaScript "+Ah+" 0 R>>")})),this},(function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var i=a[s],o=n.exec(i);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var m=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var i={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var i=n.children[s];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])})(Ft.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,s,i,o){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=(function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),p=f.length,g={width:0,height:0,numcomponents:1},v=4;v<p;v+=2){if(v+=h,t.indexOf(f.charCodeAt(v+1))!==-1){m=256*f.charCodeAt(v+5)+f.charCodeAt(v+6),g={width:256*f.charCodeAt(v+7)+f.charCodeAt(v+8),height:m,numcomponents:f.charCodeAt(v+9)};break}h=256*f.charCodeAt(v+2)+f.charCodeAt(v+3)}return g})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}})(Ft.API);var $c,jh,GA,VA,YA,Aue=(function(){var e,t,r;function n(s){var i,o,c,u,d,f,m,h,p,g,v,b,S,_;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(i=this.readUInt32(),p=(function(){var E,P;for(P=[],E=0;E<4;++E)P.push(String.fromCharCode(this.data[this.pos++]));return P}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,f.delay=1e3*d/u,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(p==="fdAT"&&(this.pos+=4,i-=4),s=(f!=null?f.data:void 0)||this.imgData,b=0;0<=i?b<i:b>i;0<=i?++b:--b)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((g=c-this.transparency.indexed.length)>0)for(S=0;0<=g?S<g:S>g;0<=g?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":m=(v=this.read(i)).indexOf(0),h=String.fromCharCode.apply(String,v.slice(0,m)),this.text[h]=String.fromCharCode.apply(String,v.slice(m+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var i,o;for(o=[],i=0;0<=s?i<s:i>s;0<=s?++i:--i)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var i=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*i),c=0,u=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function d(f,m,h,p){var g,v,b,S,_,E,P,N,I,k,T,q,F,j,U,B,X,K,ee,Y,z,ne=Math.ceil((u.width-f)/h),le=Math.ceil((u.height-m)/p),A=u.width==ne&&u.height==le;for(j=i*ne,q=A?o:new Uint8Array(j*le),E=s.length,F=0,v=0;F<le&&c<E;){switch(s[c++]){case 0:for(S=X=0;X<j;S=X+=1)q[v++]=s[c++];break;case 1:for(S=K=0;K<j;S=K+=1)g=s[c++],_=S<i?0:q[v-i],q[v++]=(g+_)%256;break;case 2:for(S=ee=0;ee<j;S=ee+=1)g=s[c++],b=(S-S%i)/i,U=F&&q[(F-1)*j+b*i+S%i],q[v++]=(U+g)%256;break;case 3:for(S=Y=0;Y<j;S=Y+=1)g=s[c++],b=(S-S%i)/i,_=S<i?0:q[v-i],U=F&&q[(F-1)*j+b*i+S%i],q[v++]=(g+Math.floor((_+U)/2))%256;break;case 4:for(S=z=0;z<j;S=z+=1)g=s[c++],b=(S-S%i)/i,_=S<i?0:q[v-i],F===0?U=B=0:(U=q[(F-1)*j+b*i+S%i],B=b&&q[(F-1)*j+(b-1)*i+S%i]),P=_+U-B,N=Math.abs(P-_),k=Math.abs(P-U),T=Math.abs(P-B),I=N<=k&&N<=T?_:k<=T?U:B,q[v++]=(g+I)%256;break;default:throw new Error("Invalid filter algorithm: "+s[c-1])}if(!A){var D=((m+F*p)*u.width+f)*i,L=F*j;for(S=0;S<ne;S+=1){for(var M=0;M<i;M+=1)o[D++]=q[L++];D+=(h-1)*i}}F++}}return s=nue(s),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),o},n.prototype.decodePalette=function(){var s,i,o,c,u,d,f,m,h;for(o=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+o.length),c=0,s=0,i=f=0,m=o.length;f<m;i=f+=3)u[c++]=o[i],u[c++]=o[i+1],u[c++]=o[i+2],u[c++]=(h=d[s++])!=null?h:255;return u},n.prototype.copyToImageData=function(s,i){var o,c,u,d,f,m,h,p,g,v,b;if(c=this.colors,g=null,o=this.hasAlphaChannel,this.palette.length&&(g=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),c=4,o=!0),p=(u=s.data||s).length,f=g||i,d=m=0,c===1)for(;d<p;)h=g?4*i[d/4]:m,v=f[h++],u[d++]=v,u[d++]=v,u[d++]=v,u[d++]=o?f[h++]:255,m=h;else for(;d<p;)h=g?4*i[d/4]:m,u[d++]=f[h++],u[d++]=f[h++],u[d++]=f[h++],u[d++]=o?f[h++]:255,m=h},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var a=function(){if(Object.prototype.toString.call(Dt)==="[object Window]"){try{t=Dt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(s){var i;if(a()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(i=new Image).src=t.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var i,o,c,u,d,f,m,h;if(this.animation){for(h=[],o=d=0,f=(m=this.animation.frames).length;d<f;o=++d)i=m[o],c=s.createImageData(i.width,i.height),u=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(c,u),i.imageData=c,h.push(i.image=e(c));return h}},n.prototype.renderFrame=function(s,i){var o,c,u;return o=(c=this.animation.frames)[i],u=c[i-1],i===0&&s.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?s.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&s.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var i,o,c,u,d,f,m=this;return o=0,f=this.animation,u=f.numFrames,c=f.frames,d=f.numPlays,(i=function(){var h,p;if(h=o++%u,p=c[h],m.renderFrame(s,h),u>1&&o/u<d)return m.animation._timeout=setTimeout(i,p.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var i,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,i=s.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(o=i.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),i.putImageData(o,0,0))},n})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function jue(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,i=1<<(7&a)+1;e[t++],e[t++];var o=null,c=null;s&&(o=t,c=i,t+=3*i);var u=!0,d=[],f=0,m=null,h=0,p=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,m=e[t++],(1&g)==0&&(m=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,E=e[t++],P=E>>6&1,N=1<<(7&E)+1,I=o,k=c,T=!1;E>>7&&(T=!0,I=t,k=N,t+=3*N);var q=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}d.push({x:v,y:b,width:S,height:_,has_local_palette:T,palette_offset:I,palette_size:k,data_offset:q,data_length:t-q,transparent_index:m,interlaced:!!P,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return p},this.frameInfo=function(j){if(j<0||j>=d.length)throw new Error("Frame index out of range.");return d[j]},this.decodeAndBlitFrameBGRA=function(j,U){var B=this.frameInfo(j),X=B.width*B.height,K=new Uint8Array(X);KA(e,B.data_offset,K,X);var ee=B.palette_offset,Y=B.transparent_index;Y===null&&(Y=256);var z=B.width,ne=r-z,le=z,A=4*(B.y*r+B.x),D=4*((B.y+B.height)*r+B.x),L=A,M=4*ne;B.interlaced===!0&&(M+=4*r*7);for(var R=8,H=0,J=K.length;H<J;++H){var G=K[H];if(le===0&&(le=z,(L+=M)>=D&&(M=4*ne+4*r*(R-1),L=A+(z+ne)*(R<<1),R>>=1)),G===Y)L+=4;else{var Q=e[ee+3*G],de=e[ee+3*G+1],V=e[ee+3*G+2];U[L++]=V,U[L++]=de,U[L++]=Q,U[L++]=255}--le}},this.decodeAndBlitFrameRGBA=function(j,U){var B=this.frameInfo(j),X=B.width*B.height,K=new Uint8Array(X);KA(e,B.data_offset,K,X);var ee=B.palette_offset,Y=B.transparent_index;Y===null&&(Y=256);var z=B.width,ne=r-z,le=z,A=4*(B.y*r+B.x),D=4*((B.y+B.height)*r+B.x),L=A,M=4*ne;B.interlaced===!0&&(M+=4*r*7);for(var R=8,H=0,J=K.length;H<J;++H){var G=K[H];if(le===0&&(le=z,(L+=M)>=D&&(M=4*ne+4*r*(R-1),L=A+(z+ne)*(R<<1),R>>=1)),G===Y)L+=4;else{var Q=e[ee+3*G],de=e[ee+3*G+1],V=e[ee+3*G+2];U[L++]=Q,U[L++]=de,U[L++]=V,U[L++]=255}--le}}}function KA(e,t,r,n){for(var a=e[t++],s=1<<a,i=s+1,o=i+1,c=a+1,u=(1<<c)-1,d=0,f=0,m=0,h=e[t++],p=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)f|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var v=f&u;if(f>>=c,d-=c,v!==s){if(v===i)break;for(var b=v<o?v:g,S=0,_=b;_>s;)_=p[_]>>8,++S;var E=_;if(m+S+(b!==v?1:0)>n)return void jr.log("Warning, gif stream longer than expected.");r[m++]=E;var P=m+=S;for(b!==v&&(r[m++]=E),_=b;S--;)_=p[_],r[--P]=255&_,_>>=8;g!==null&&o<4096&&(p[o++]=g<<8|E,o>=u+1&&c<12&&(++c,u=u<<1|1)),g=v}else o=i+1,u=(1<<(c=a+1))-1,g=null}return m!==n&&jr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Z1(e){var t,r,n,a,s,i=Math.floor,o=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),p=new Array(64),g=[],v=0,b=7,S=new Array(64),_=new Array(64),E=new Array(64),P=new Array(256),N=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],X=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(A,D){for(var L=0,M=0,R=new Array,H=1;H<=16;H++){for(var J=1;J<=A[H];J++)R[D[M]]=[],R[D[M]][0]=L,R[D[M]][1]=H,M++,L++;L*=2}return R}function ee(A){for(var D=A[0],L=A[1]-1;L>=0;)D&1<<L&&(v|=1<<b),L--,--b<0&&(v==255?(Y(255),Y(0)):Y(v),b=7,v=0)}function Y(A){g.push(A)}function z(A){Y(A>>8&255),Y(255&A)}function ne(A,D,L,M,R){for(var H,J=R[0],G=R[240],Q=(function(pe,Ae){var Le,Pe,Oe,Ve,et,_t,Tt,At,pt,lt,rt=0;for(pt=0;pt<8;++pt){Le=pe[rt],Pe=pe[rt+1],Oe=pe[rt+2],Ve=pe[rt+3],et=pe[rt+4],_t=pe[rt+5],Tt=pe[rt+6];var Zt=Le+(At=pe[rt+7]),jt=Le-At,Mr=Pe+Tt,$e=Pe-Tt,Je=Oe+_t,Pt=Oe-_t,gt=Ve+et,Ot=Ve-et,yt=Zt+gt,tr=Zt-gt,fr=Mr+Je,Vt=Mr-Je;pe[rt]=yt+fr,pe[rt+4]=yt-fr;var It=.707106781*(Vt+tr);pe[rt+2]=tr+It,pe[rt+6]=tr-It;var Xt=.382683433*((yt=Ot+Pt)-(Vt=$e+jt)),rr=.5411961*yt+Xt,nr=1.306562965*Vt+Xt,Cn=.707106781*(fr=Pt+$e),Ma=jt+Cn,xt=jt-Cn;pe[rt+5]=xt+rr,pe[rt+3]=xt-rr,pe[rt+1]=Ma+nr,pe[rt+7]=Ma-nr,rt+=8}for(rt=0,pt=0;pt<8;++pt){Le=pe[rt],Pe=pe[rt+8],Oe=pe[rt+16],Ve=pe[rt+24],et=pe[rt+32],_t=pe[rt+40],Tt=pe[rt+48];var Un=Le+(At=pe[rt+56]),En=Le-At,zn=Pe+Tt,Rr=Pe-Tt,Kr=Oe+_t,se=Oe-_t,ve=Ve+et,ue=Ve-et,fe=Un+ve,xe=Un-ve,ye=zn+Kr,De=zn-Kr;pe[rt]=fe+ye,pe[rt+32]=fe-ye;var We=.707106781*(De+xe);pe[rt+16]=xe+We,pe[rt+48]=xe-We;var Ie=.382683433*((fe=ue+se)-(De=Rr+En)),Be=.5411961*fe+Ie,ze=1.306562965*De+Ie,nt=.707106781*(ye=se+Rr),st=En+nt,ft=En-nt;pe[rt+40]=ft+Be,pe[rt+24]=ft-Be,pe[rt+8]=st+ze,pe[rt+56]=st-ze,rt++}for(pt=0;pt<64;++pt)lt=pe[pt]*Ae[pt],h[pt]=lt>0?lt+.5|0:lt-.5|0;return h})(A,D),de=0;de<64;++de)p[I[de]]=Q[de];var V=p[0]-L;L=p[0],V==0?ee(M[0]):(ee(M[m[H=32767+V]]),ee(f[H]));for(var Ee=63;Ee>0&&p[Ee]==0;)Ee--;if(Ee==0)return ee(J),L;for(var we,he=1;he<=Ee;){for(var Z=he;p[he]==0&&he<=Ee;)++he;var Se=he-Z;if(Se>=16){we=Se>>4;for(var ge=1;ge<=we;++ge)ee(G);Se&=15}H=32767+p[he],ee(R[(Se<<4)+m[H]]),ee(f[H]),he++}return Ee!=63&&ee(J),L}function le(A){A=Math.min(Math.max(A,1),100),s!=A&&((function(D){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var R=i((L[M]*D+50)/100);R=Math.min(Math.max(R,1),255),o[I[M]]=R}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],J=0;J<64;J++){var G=i((H[J]*D+50)/100);G=Math.min(Math.max(G,1),255),c[I[J]]=G}for(var Q=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],de=0,V=0;V<8;V++)for(var Ee=0;Ee<8;Ee++)u[de]=1/(o[I[de]]*Q[V]*Q[Ee]*8),d[de]=1/(c[I[de]]*Q[V]*Q[Ee]*8),de++})(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),s=A)}this.encode=function(A,D){D&&le(D),g=new Array,v=0,b=7,z(65496),z(65504),z(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),z(1),z(1),Y(0),Y(0),(function(){z(65499),z(132),Y(0);for(var Pe=0;Pe<64;Pe++)Y(o[Pe]);Y(1);for(var Oe=0;Oe<64;Oe++)Y(c[Oe])})(),(function(Pe,Oe){z(65472),z(17),Y(8),z(Oe),z(Pe),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)})(A.width,A.height),(function(){z(65476),z(418),Y(0);for(var Pe=0;Pe<16;Pe++)Y(k[Pe+1]);for(var Oe=0;Oe<=11;Oe++)Y(T[Oe]);Y(16);for(var Ve=0;Ve<16;Ve++)Y(q[Ve+1]);for(var et=0;et<=161;et++)Y(F[et]);Y(1);for(var _t=0;_t<16;_t++)Y(j[_t+1]);for(var Tt=0;Tt<=11;Tt++)Y(U[Tt]);Y(17);for(var At=0;At<16;At++)Y(B[At+1]);for(var pt=0;pt<=161;pt++)Y(X[pt])})(),z(65498),z(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var L=0,M=0,R=0;v=0,b=7,this.encode.displayName="_encode_";for(var H,J,G,Q,de,V,Ee,we,he,Z=A.data,Se=A.width,ge=A.height,pe=4*Se,Ae=0;Ae<ge;){for(H=0;H<pe;){for(de=pe*Ae+H,Ee=-1,we=0,he=0;he<64;he++)V=de+(we=he>>3)*pe+(Ee=4*(7&he)),Ae+we>=ge&&(V-=pe*(Ae+1+we-ge)),H+Ee>=pe&&(V-=H+Ee-pe+4),J=Z[V++],G=Z[V++],Q=Z[V++],S[he]=(N[J]+N[G+256>>0]+N[Q+512>>0]>>16)-128,_[he]=(N[J+768>>0]+N[G+1024>>0]+N[Q+1280>>0]>>16)-128,E[he]=(N[J+1280>>0]+N[G+1536>>0]+N[Q+1792>>0]>>16)-128;L=ne(S,u,L,t,n),M=ne(_,d,M,r,a),R=ne(E,d,R,r,a),H+=32}Ae+=8}if(b>=0){var Le=[];Le[1]=b+1,Le[0]=(1<<b+1)-1,ee(Le)}return z(65497),new Uint8Array(g)},e=e||50,(function(){for(var A=String.fromCharCode,D=0;D<256;D++)P[D]=A(D)})(),t=K(k,T),r=K(j,U),n=K(q,F),a=K(B,X),(function(){for(var A=1,D=2,L=1;L<=15;L++){for(var M=A;M<D;M++)m[32767+M]=L,f[32767+M]=[],f[32767+M][1]=L,f[32767+M][0]=M;for(var R=-(D-1);R<=-A;R++)m[32767+R]=L,f[32767+R]=[],f[32767+R][1]=L,f[32767+R][0]=D-1+R;A<<=1,D<<=1}})(),(function(){for(var A=0;A<256;A++)N[A]=19595*A,N[A+256>>0]=38470*A,N[A+512>>0]=7471*A+32768,N[A+768>>0]=-11059*A,N[A+1024>>0]=-21709*A,N[A+1280>>0]=32768*A+8421375,N[A+1536>>0]=-27439*A,N[A+1792>>0]=-5329*A})(),le(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Gs(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function XA(e){function t(k){if(!k)throw Error("assert :P")}function r(k,T,q){for(var F=0;4>F;F++)if(k[T+F]!=q.charCodeAt(F))return!0;return!1}function n(k,T,q,F,j){for(var U=0;U<j;U++)k[T+U]=q[F+U]}function a(k,T,q,F){for(var j=0;j<F;j++)k[T+j]=q}function s(k){return new Int32Array(k)}function i(k,T){for(var q=[],F=0;F<k;F++)q.push(new T);return q}function o(k,T){var q=[];return(function F(j,U,B){for(var X=B[U],K=0;K<X&&(j.push(B.length>U+1?[]:new T),!(B.length<U+1));K++)F(j[K],U+1,B)})(q,0,k),q}var c=function(){var k=this;function T(x,w){for(var O=1<<w-1>>>0;x&O;)O>>>=1;return O?(x&O-1)+O:x}function q(x,w,O,W,te){t(!(W%O));do x[w+(W-=O)]=te;while(0<W)}function F(x,w,O,W,te){if(t(2328>=te),512>=te)var ae=s(512);else if((ae=s(te))==null)return 0;return(function(ie,oe,ce,me,Ne,Me){var Re,Te,Xe=oe,He=1<<ce,je=s(16),Ce=s(16);for(t(Ne!=0),t(me!=null),t(ie!=null),t(0<ce),Te=0;Te<Ne;++Te){if(15<me[Te])return 0;++je[me[Te]]}if(je[0]==Ne)return 0;for(Ce[1]=0,Re=1;15>Re;++Re){if(je[Re]>1<<Re)return 0;Ce[Re+1]=Ce[Re]+je[Re]}for(Te=0;Te<Ne;++Te)Re=me[Te],0<me[Te]&&(Me[Ce[Re]++]=Te);if(Ce[15]==1)return(me=new j).g=0,me.value=Me[0],q(ie,Xe,1,He,me),He;var Ye,Qe=-1,Ke=He-1,mt=0,ct=1,Et=1,ut=1<<ce;for(Te=0,Re=1,Ne=2;Re<=ce;++Re,Ne<<=1){if(ct+=Et<<=1,0>(Et-=je[Re]))return 0;for(;0<je[Re];--je[Re])(me=new j).g=Re,me.value=Me[Te++],q(ie,Xe+mt,Ne,ut,me),mt=T(mt,Re)}for(Re=ce+1,Ne=2;15>=Re;++Re,Ne<<=1){if(ct+=Et<<=1,0>(Et-=je[Re]))return 0;for(;0<je[Re];--je[Re]){if(me=new j,(mt&Ke)!=Qe){for(Xe+=ut,Ye=1<<(Qe=Re)-ce;15>Qe&&!(0>=(Ye-=je[Qe]));)++Qe,Ye<<=1;He+=ut=1<<(Ye=Qe-ce),ie[oe+(Qe=mt&Ke)].g=Ye+ce,ie[oe+Qe].value=Xe-oe-Qe}me.g=Re-ce,me.value=Me[Te++],q(ie,Xe+(mt>>ce),Ne,ut,me),mt=T(mt,Re)}}return ct!=2*Ce[15]-1?0:He})(x,w,O,W,te,ae)}function j(){this.value=this.g=0}function U(){this.value=this.g=0}function B(){this.G=i(5,j),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(ta,U)}function X(x,w,O,W){t(x!=null),t(w!=null),t(2147483648>W),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=w,x.pa=O,x.Jd=w,x.Yc=O+W,x.Zc=4<=W?O+W-4+1:O,H(x)}function K(x,w){for(var O=0;0<w--;)O|=G(x,128)<<w;return O}function ee(x,w){var O=K(x,w);return J(x)?-O:O}function Y(x,w,O,W){var te,ae=0;for(t(x!=null),t(w!=null),t(4294967288>W),x.Sb=W,x.Ra=0,x.u=0,x.h=0,4<W&&(W=4),te=0;te<W;++te)ae+=w[O+te]<<8*te;x.Ra=ae,x.bb=W,x.oa=w,x.pa=O}function z(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Nc-8>>>0,++x.bb,x.u-=8;L(x)&&(x.h=1,x.u=0)}function ne(x,w){if(t(0<=w),!x.h&&w<=_c){var O=D(x)&Sc[w];return x.u+=w,z(x),O}return x.h=1,x.u=0}function le(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(x){return x.Ra>>>(x.u&Nc-1)>>>0}function L(x){return t(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Nc}function M(x,w){x.u=w,x.h=L(x)}function R(x){x.u>=Qu&&(t(x.u>=Qu),z(x))}function H(x){t(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(t(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function J(x){return K(x,1)}function G(x,w){var O=x.Ca;0>x.b&&H(x);var W=x.b,te=O*w>>>8,ae=(x.I>>>W>te)+0;for(ae?(O-=te,x.I-=te+1<<W>>>0):O=te+1,W=O,te=0;256<=W;)te+=8,W>>=8;return W=7^te+Ba[W],x.b-=W,x.Ca=(O<<W)-1,ae}function Q(x,w,O){x[w+0]=O>>24&255,x[w+1]=O>>16&255,x[w+2]=O>>8&255,x[w+3]=O>>0&255}function de(x,w){return x[w+0]<<0|x[w+1]<<8}function V(x,w){return de(x,w)|x[w+2]<<16}function Ee(x,w){return de(x,w)|de(x,w+2)<<16}function we(x,w){var O=1<<w;return t(x!=null),t(0<w),x.X=s(O),x.X==null?0:(x.Mb=32-w,x.Xa=w,1)}function he(x,w){t(x!=null),t(w!=null),t(x.Xa==w.Xa),n(w.X,0,x.X,0,1<<w.Xa)}function Z(){this.X=[],this.Xa=this.Mb=0}function Se(x,w,O,W){t(O!=null),t(W!=null);var te=O[0],ae=W[0];return te==0&&(te=(x*ae+w/2)/w),ae==0&&(ae=(w*te+x/2)/x),0>=te||0>=ae?0:(O[0]=te,W[0]=ae,1)}function ge(x,w){return x+(1<<w)-1>>>w}function pe(x,w){return((4278255360&x)+(4278255360&w)>>>0&4278255360)+((16711935&x)+(16711935&w)>>>0&16711935)>>>0}function Ae(x,w){k[w]=function(O,W,te,ae,ie,oe,ce){var me;for(me=0;me<ie;++me){var Ne=k[x](oe[ce+me-1],te,ae+me);oe[ce+me]=pe(O[W+me],Ne)}}}function Le(){this.ud=this.hd=this.jd=0}function Pe(x,w){return((4278124286&(x^w))>>>1)+(x&w)>>>0}function Oe(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function Ve(x,w){return Oe(x+(x-w+.5>>1))}function et(x,w,O){return Math.abs(w-O)-Math.abs(x-O)}function _t(x,w,O,W,te,ae,ie){for(W=ae[ie-1],O=0;O<te;++O)ae[ie+O]=W=pe(x[w+O],W)}function Tt(x,w,O,W,te){var ae;for(ae=0;ae<O;++ae){var ie=x[w+ae],oe=ie>>8&255,ce=16711935&(ce=(ce=16711935&ie)+((oe<<16)+oe));W[te+ae]=(4278255360&ie)+ce>>>0}}function At(x,w){w.jd=x>>0&255,w.hd=x>>8&255,w.ud=x>>16&255}function pt(x,w,O,W,te,ae){var ie;for(ie=0;ie<W;++ie){var oe=w[O+ie],ce=oe>>>8,me=oe,Ne=255&(Ne=(Ne=oe>>>16)+((x.jd<<24>>24)*(ce<<24>>24)>>>5));me=255&(me=(me=me+((x.hd<<24>>24)*(ce<<24>>24)>>>5))+((x.ud<<24>>24)*(Ne<<24>>24)>>>5)),te[ae+ie]=(4278255360&oe)+(Ne<<16)+me}}function lt(x,w,O,W,te){k[w]=function(ae,ie,oe,ce,me,Ne,Me,Re,Te){for(ce=Me;ce<Re;++ce)for(Me=0;Me<Te;++Me)me[Ne++]=te(oe[W(ae[ie++])])},k[x]=function(ae,ie,oe,ce,me,Ne,Me){var Re=8>>ae.b,Te=ae.Ea,Xe=ae.K[0],He=ae.w;if(8>Re)for(ae=(1<<ae.b)-1,He=(1<<Re)-1;ie<oe;++ie){var je,Ce=0;for(je=0;je<Te;++je)je&ae||(Ce=W(ce[me++])),Ne[Me++]=te(Xe[Ce&He]),Ce>>=Re}else k["VP8LMapColor"+O](ce,me,Xe,He,Ne,Me,ie,oe,Te)}}function rt(x,w,O,W,te){for(O=w+O;w<O;){var ae=x[w++];W[te++]=ae>>16&255,W[te++]=ae>>8&255,W[te++]=ae>>0&255}}function Zt(x,w,O,W,te){for(O=w+O;w<O;){var ae=x[w++];W[te++]=ae>>16&255,W[te++]=ae>>8&255,W[te++]=ae>>0&255,W[te++]=ae>>24&255}}function jt(x,w,O,W,te){for(O=w+O;w<O;){var ae=(ie=x[w++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;W[te++]=ae,W[te++]=ie}}function Mr(x,w,O,W,te){for(O=w+O;w<O;){var ae=(ie=x[w++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;W[te++]=ae,W[te++]=ie}}function $e(x,w,O,W,te){for(O=w+O;w<O;){var ae=x[w++];W[te++]=ae>>0&255,W[te++]=ae>>8&255,W[te++]=ae>>16&255}}function Je(x,w,O,W,te,ae){if(ae==0)for(O=w+O;w<O;)Q(W,((ae=x[w++])[0]>>24|ae[1]>>8&65280|ae[2]<<8&16711680|ae[3]<<24)>>>0),te+=32;else n(W,te,x,w,O)}function Pt(x,w){k[w][0]=k[x+"0"],k[w][1]=k[x+"1"],k[w][2]=k[x+"2"],k[w][3]=k[x+"3"],k[w][4]=k[x+"4"],k[w][5]=k[x+"5"],k[w][6]=k[x+"6"],k[w][7]=k[x+"7"],k[w][8]=k[x+"8"],k[w][9]=k[x+"9"],k[w][10]=k[x+"10"],k[w][11]=k[x+"11"],k[w][12]=k[x+"12"],k[w][13]=k[x+"13"],k[w][14]=k[x+"0"],k[w][15]=k[x+"0"]}function gt(x){return x==jg||x==kg||x==P0||x==Cg}function Ot(){this.eb=[],this.size=this.A=this.fb=0}function yt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function tr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ot,this.f.kb=new yt,this.sd=null}function fr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Vt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function It(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function Xt(x,w){var O=x.T,W=w.ba.f.RGBA,te=W.eb,ae=W.fb+x.ka*W.A,ie=vs[w.ba.S],oe=x.y,ce=x.O,me=x.f,Ne=x.N,Me=x.ea,Re=x.W,Te=w.cc,Xe=w.dc,He=w.Mc,je=w.Nc,Ce=x.ka,Ye=x.ka+x.T,Qe=x.U,Ke=Qe+1>>1;for(Ce==0?ie(oe,ce,null,null,me,Ne,Me,Re,me,Ne,Me,Re,te,ae,null,null,Qe):(ie(w.ec,w.fc,oe,ce,Te,Xe,He,je,me,Ne,Me,Re,te,ae-W.A,te,ae,Qe),++O);Ce+2<Ye;Ce+=2)Te=me,Xe=Ne,He=Me,je=Re,Ne+=x.Rc,Re+=x.Rc,ae+=2*W.A,ie(oe,(ce+=2*x.fa)-x.fa,oe,ce,Te,Xe,He,je,me,Ne,Me,Re,te,ae-W.A,te,ae,Qe);return ce+=x.fa,x.j+Ye<x.o?(n(w.ec,w.fc,oe,ce,Qe),n(w.cc,w.dc,me,Ne,Ke),n(w.Mc,w.Nc,Me,Re,Ke),O--):1&Ye||ie(oe,ce,null,null,me,Ne,Me,Re,me,Ne,Me,Re,te,ae+W.A,null,null,Qe),O}function rr(x,w,O){var W=x.F,te=[x.J];if(W!=null){var ae=x.U,ie=w.ba.S,oe=ie==T0||ie==P0;w=w.ba.f.RGBA;var ce=[0],me=x.ka;ce[0]=x.T,x.Kb&&(me==0?--ce[0]:(--me,te[0]-=x.width),x.j+x.ka+x.T==x.o&&(ce[0]=x.o-x.j-me));var Ne=w.eb;me=w.fb+me*w.A,x=Er(W,te[0],x.width,ae,ce,Ne,me+(oe?0:3),w.A),t(O==ce),x&&gt(ie)&&gs(Ne,me,oe,ae,ce,w.A)}return 0}function nr(x){var w=x.ma,O=w.ba.S,W=11>O,te=O==C0||O==E0||O==T0||O==Ag||O==12||gt(O);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Ju(w.Oa,x,te?11:12))return 0;if(te&&gt(O)&&tt(),x.da)alert("todo:use_scaling");else{if(W){if(w.Ib=It,x.Kb){if(O=x.U+1>>1,w.memory=s(x.U+2*O),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+x.U,w.Mc=w.cc,w.Nc=w.dc+O,w.Ib=Xt,tt()}}else alert("todo:EmitYUV");te&&(w.Jb=rr,W&&Fe())}if(W&&!Vw){for(x=0;256>x;++x)jO[x]=89858*(x-128)+F0>>O0,EO[x]=-22014*(x-128)+F0,CO[x]=-45773*(x-128),kO[x]=113618*(x-128)+F0>>O0;for(x=id;x<Pg;++x)w=76283*(x-16)+F0>>O0,TO[x-id]=Ja(w,255),PO[x-id]=Ja(w+8>>4,15);Vw=1}return 1}function Cn(x){var w=x.ma,O=x.U,W=x.T;return t(!(1&x.ka)),0>=O||0>=W?0:(O=w.Ib(x,w),w.Jb!=null&&w.Jb(x,w,O),w.Dc+=O,1)}function Ma(x){x.ma.memory=null}function xt(x,w,O,W){return ne(x,8)!=47?0:(w[0]=ne(x,14)+1,O[0]=ne(x,14)+1,W[0]=ne(x,1),ne(x,3)!=0?0:!x.h)}function Un(x,w){if(4>x)return x+1;var O=x-2>>1;return(2+(1&x)<<O)+ne(w,O)+1}function En(x,w){return 120<w?w-120:1<=(O=((O=fO[w-1])>>4)*x+(8-(15&O)))?O:1;var O}function zn(x,w,O){var W=D(O),te=x[w+=255&W].g-8;return 0<te&&(M(O,O.u+8),W=D(O),w+=x[w].value,w+=W&(1<<te)-1),M(O,O.u+x[w].g),x[w].value}function Rr(x,w,O){return O.g+=x.g,O.value+=x.value<<w>>>0,t(8>=O.g),x.g}function Kr(x,w,O){var W=x.xc;return t((w=W==0?0:x.vc[x.md*(O>>W)+(w>>W)])<x.Wb),x.Ya[w]}function se(x,w,O,W){var te=x.ab,ae=x.c*w,ie=x.C;w=ie+w;var oe=O,ce=W;for(W=x.Ta,O=x.Ua;0<te--;){var me=x.gc[te],Ne=ie,Me=w,Re=oe,Te=ce,Xe=(ce=W,oe=O,me.Ea);switch(t(Ne<Me),t(Me<=me.nc),me.hc){case 2:w0(Re,Te,(Me-Ne)*Xe,ce,oe);break;case 0:var He=Ne,je=Me,Ce=ce,Ye=oe,Qe=(ut=me).Ea;He==0&&(_g(Re,Te,null,null,1,Ce,Ye),_t(Re,Te+1,0,0,Qe-1,Ce,Ye+1),Te+=Qe,Ye+=Qe,++He);for(var Ke=1<<ut.b,mt=Ke-1,ct=ge(Qe,ut.b),Et=ut.K,ut=ut.w+(He>>ut.b)*ct;He<je;){var ur=Et,hr=ut,ar=1;for(ed(Re,Te,Ce,Ye-Qe,1,Ce,Ye);ar<Qe;){var Jt=(ar&~mt)+Ke;Jt>Qe&&(Jt=Qe),(0,No[ur[hr++]>>8&15])(Re,Te+ +ar,Ce,Ye+ar-Qe,Jt-ar,Ce,Ye+ar),ar=Jt}Te+=Qe,Ye+=Qe,++He&mt||(ut+=ct)}Me!=me.nc&&n(ce,oe-Xe,ce,oe+(Me-Ne-1)*Xe,Xe);break;case 1:for(Xe=Re,je=Te,Qe=(Re=me.Ea)-(Ye=Re&~(Ce=(Te=1<<me.b)-1)),He=ge(Re,me.b),Ke=me.K,me=me.w+(Ne>>me.b)*He;Ne<Me;){for(mt=Ke,ct=me,Et=new Le,ut=je+Ye,ur=je+Re;je<ut;)At(mt[ct++],Et),hl(Et,Xe,je,Te,ce,oe),je+=Te,oe+=Te;je<ur&&(At(mt[ct++],Et),hl(Et,Xe,je,Qe,ce,oe),je+=Qe,oe+=Qe),++Ne&Ce||(me+=He)}break;case 3:if(Re==ce&&Te==oe&&0<me.b){for(je=ce,Re=Xe=oe+(Me-Ne)*Xe-(Ye=(Me-Ne)*ge(me.Ea,me.b)),Te=ce,Ce=oe,He=[],Ye=(Qe=Ye)-1;0<=Ye;--Ye)He[Ye]=Te[Ce+Ye];for(Ye=Qe-1;0<=Ye;--Ye)je[Re+Ye]=He[Ye];hs(me,Ne,Me,ce,Xe,ce,oe)}else hs(me,Ne,Me,Re,Te,ce,oe)}oe=W,ce=O}ce!=O&&n(W,O,oe,ce,ae)}function ve(x,w){var O=x.V,W=x.Ba+x.c*x.C,te=w-x.C;if(t(w<=x.l.o),t(16>=te),0<te){var ae=x.l,ie=x.Ta,oe=x.Ua,ce=ae.width;if(se(x,te,O,W),te=oe=[oe],t((O=x.C)<(W=w)),t(ae.v<ae.va),W>ae.o&&(W=ae.o),O<ae.j){var me=ae.j-O;O=ae.j,te[0]+=me*ce}if(O>=W?O=0:(te[0]+=4*ae.v,ae.ka=O-ae.j,ae.U=ae.va-ae.v,ae.T=W-O,O=1),O){if(oe=oe[0],11>(O=x.ca).S){var Ne=O.f.RGBA,Me=(W=O.S,te=ae.U,ae=ae.T,me=Ne.eb,Ne.A),Re=ae;for(Ne=Ne.fb+x.Ma*Ne.A;0<Re--;){var Te=ie,Xe=oe,He=te,je=me,Ce=Ne;switch(W){case k0:Ua(Te,Xe,He,je,Ce);break;case C0:ka(Te,Xe,He,je,Ce);break;case jg:ka(Te,Xe,He,je,Ce),gs(je,Ce,0,He,1,0);break;case Rw:Li(Te,Xe,He,je,Ce);break;case E0:Je(Te,Xe,He,je,Ce,1);break;case kg:Je(Te,Xe,He,je,Ce,1),gs(je,Ce,0,He,1,0);break;case T0:Je(Te,Xe,He,je,Ce,0);break;case P0:Je(Te,Xe,He,je,Ce,0),gs(je,Ce,1,He,1,0);break;case Ag:Ao(Te,Xe,He,je,Ce);break;case Cg:Ao(Te,Xe,He,je,Ce),Cr(je,Ce,He,1,0);break;case Bw:Ii(Te,Xe,He,je,Ce);break;default:t(0)}oe+=ce,Ne+=Me}x.Ma+=ae}else alert("todo:EmitRescaledRowsYUVA");t(x.Ma<=O.height)}}x.C=w,t(x.C<=x.i)}function ue(x){var w;if(0<x.ua)return 0;for(w=0;w<x.Wb;++w){var O=x.Ya[w].G,W=x.Ya[w].H;if(0<O[1][W[1]+0].g||0<O[2][W[2]+0].g||0<O[3][W[3]+0].g)return 0}return 1}function fe(x,w,O,W,te,ae){if(x.Z!=0){var ie=x.qd,oe=x.rd;for(t(Eo[x.Z]!=null);w<O;++w)Eo[x.Z](ie,oe,W,te,W,te,ae),ie=W,oe=te,te+=ae;x.qd=ie,x.rd=oe}}function xe(x,w){var O=x.l.ma,W=O.Z==0||O.Z==1?x.l.j:x.C;if(W=x.C<W?W:x.C,t(w<=x.l.o),w>W){var te=x.l.width,ae=O.ca,ie=O.tb+te*W,oe=x.V,ce=x.Ba+x.c*W,me=x.gc;t(x.ab==1),t(me[0].hc==3),S0(me[0],W,w,oe,ce,ae,ie),fe(O,W,w,ae,ie,te)}x.C=x.Ma=w}function ye(x,w,O,W,te,ae,ie){var oe=x.$/W,ce=x.$%W,me=x.m,Ne=x.s,Me=O+x.$,Re=Me;te=O+W*te;var Te=O+W*ae,Xe=280+Ne.ua,He=x.Pb?oe:16777216,je=0<Ne.ua?Ne.Wa:null,Ce=Ne.wc,Ye=Me<Te?Kr(Ne,ce,oe):null;t(x.C<ae),t(Te<=te);var Qe=!1;e:for(;;){for(;Qe||Me<Te;){var Ke=0;if(oe>=He){var mt=Me-O;t((He=x).Pb),He.wd=He.m,He.xd=mt,0<He.s.ua&&he(He.s.Wa,He.s.vb),He=oe+mO}if(ce&Ce||(Ye=Kr(Ne,ce,oe)),t(Ye!=null),Ye.Qb&&(w[Me]=Ye.qb,Qe=!0),!Qe)if(R(me),Ye.jc){Ke=me,mt=w;var ct=Me,Et=Ye.pd[D(Ke)&ta-1];t(Ye.jc),256>Et.g?(M(Ke,Ke.u+Et.g),mt[ct]=Et.value,Ke=0):(M(Ke,Ke.u+Et.g-256),t(256<=Et.value),Ke=Et.value),Ke==0&&(Qe=!0)}else Ke=zn(Ye.G[0],Ye.H[0],me);if(me.h)break;if(Qe||256>Ke){if(!Qe)if(Ye.nd)w[Me]=(Ye.qb|Ke<<8)>>>0;else{if(R(me),Qe=zn(Ye.G[1],Ye.H[1],me),R(me),mt=zn(Ye.G[2],Ye.H[2],me),ct=zn(Ye.G[3],Ye.H[3],me),me.h)break;w[Me]=(ct<<24|Qe<<16|Ke<<8|mt)>>>0}if(Qe=!1,++Me,++ce>=W&&(ce=0,++oe,ie!=null&&oe<=ae&&!(oe%16)&&ie(x,oe),je!=null))for(;Re<Me;)Ke=w[Re++],je.X[(506832829*Ke&4294967295)>>>je.Mb]=Ke}else if(280>Ke){if(Ke=Un(Ke-256,me),mt=zn(Ye.G[4],Ye.H[4],me),R(me),mt=En(W,mt=Un(mt,me)),me.h)break;if(Me-O<mt||te-Me<Ke)break e;for(ct=0;ct<Ke;++ct)w[Me+ct]=w[Me+ct-mt];for(Me+=Ke,ce+=Ke;ce>=W;)ce-=W,++oe,ie!=null&&oe<=ae&&!(oe%16)&&ie(x,oe);if(t(Me<=te),ce&Ce&&(Ye=Kr(Ne,ce,oe)),je!=null)for(;Re<Me;)Ke=w[Re++],je.X[(506832829*Ke&4294967295)>>>je.Mb]=Ke}else{if(!(Ke<Xe))break e;for(Qe=Ke-280,t(je!=null);Re<Me;)Ke=w[Re++],je.X[(506832829*Ke&4294967295)>>>je.Mb]=Ke;Ke=Me,t(!(Qe>>>(mt=je).Xa)),w[Ke]=mt.X[Qe],Qe=!0}Qe||t(me.h==L(me))}if(x.Pb&&me.h&&Me<te)t(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&he(x.s.vb,x.s.Wa);else{if(me.h)break e;ie!=null&&ie(x,oe>ae?ae:oe),x.a=0,x.$=Me-O}return 1}return x.a=3,0}function De(x){t(x!=null),x.vc=null,x.yc=null,x.Ya=null;var w=x.Wa;w!=null&&(w.X=null),x.vb=null,t(x!=null)}function We(){var x=new Sg;return x==null?null:(x.a=0,x.xb=$w,Pt("Predictor","VP8LPredictors"),Pt("Predictor","VP8LPredictors_C"),Pt("PredictorAdd","VP8LPredictorsAdd"),Pt("PredictorAdd","VP8LPredictorsAdd_C"),w0=Tt,hl=pt,Ua=rt,ka=Zt,Ao=jt,Ii=Mr,Li=$e,k.VP8LMapColor32b=Ac,k.VP8LMapColor8b=_0,x)}function Ie(x,w,O,W,te){var ae=1,ie=[x],oe=[w],ce=W.m,me=W.s,Ne=null,Me=0;e:for(;;){if(O)for(;ae&&ne(ce,1);){var Re=ie,Te=oe,Xe=W,He=1,je=Xe.m,Ce=Xe.gc[Xe.ab],Ye=ne(je,2);if(Xe.Oc&1<<Ye)ae=0;else{switch(Xe.Oc|=1<<Ye,Ce.hc=Ye,Ce.Ea=Re[0],Ce.nc=Te[0],Ce.K=[null],++Xe.ab,t(4>=Xe.ab),Ye){case 0:case 1:Ce.b=ne(je,3)+2,He=Ie(ge(Ce.Ea,Ce.b),ge(Ce.nc,Ce.b),0,Xe,Ce.K),Ce.K=Ce.K[0];break;case 3:var Qe,Ke=ne(je,8)+1,mt=16<Ke?0:4<Ke?1:2<Ke?2:3;if(Re[0]=ge(Ce.Ea,mt),Ce.b=mt,Qe=He=Ie(Ke,1,0,Xe,Ce.K)){var ct,Et=Ke,ut=Ce,ur=1<<(8>>ut.b),hr=s(ur);if(hr==null)Qe=0;else{var ar=ut.K[0],Jt=ut.w;for(hr[0]=ut.K[0][0],ct=1;ct<1*Et;++ct)hr[ct]=pe(ar[Jt+ct],hr[ct-1]);for(;ct<4*ur;++ct)hr[ct]=0;ut.K[0]=null,ut.K[0]=hr,Qe=1}}He=Qe;break;case 2:break;default:t(0)}ae=He}}if(ie=ie[0],oe=oe[0],ae&&ne(ce,1)&&!(ae=1<=(Me=ne(ce,4))&&11>=Me)){W.a=3;break e}var Ar;if(Ar=ae)t:{var wr,Ht,vn,za=W,yn=ie,$a=oe,mr=Me,Qa=O,es=za.m,Wn=za.s,ra=[null],Ea=1,ys=0,fi=hO[mr];r:for(;;){if(Qa&&ne(es,1)){var Hn=ne(es,3)+2,Bi=ge(yn,Hn),vl=ge($a,Hn),Tc=Bi*vl;if(!Ie(Bi,vl,0,za,ra))break r;for(ra=ra[0],Wn.xc=Hn,wr=0;wr<Tc;++wr){var To=ra[wr]>>8&65535;ra[wr]=To,To>=Ea&&(Ea=To+1)}}if(es.h)break r;for(Ht=0;5>Ht;++Ht){var Jr=Uw[Ht];!Ht&&0<mr&&(Jr+=1<<mr),ys<Jr&&(ys=Jr)}var Og=i(Ea*fi,j),Xw=Ea,Jw=i(Xw,B);if(Jw==null)var L0=null;else t(65536>=Xw),L0=Jw;var od=s(ys);if(L0==null||od==null||Og==null){za.a=1;break r}var D0=Og;for(wr=vn=0;wr<Ea;++wr){var Ws=L0[wr],Pc=Ws.G,Oc=Ws.H,Zw=0,M0=1,Qw=0;for(Ht=0;5>Ht;++Ht){Jr=Uw[Ht],Pc[Ht]=D0,Oc[Ht]=vn,!Ht&&0<mr&&(Jr+=1<<mr);a:{var R0,Fg=Jr,B0=za,ld=od,IO=D0,LO=vn,Ig=0,Po=B0.m,DO=ne(Po,1);if(a(ld,0,0,Fg),DO){var MO=ne(Po,1)+1,RO=ne(Po,1),e5=ne(Po,RO==0?1:8);ld[e5]=1,MO==2&&(ld[e5=ne(Po,8)]=1);var U0=1}else{var t5=s(19),r5=ne(Po,4)+4;if(19<r5){B0.a=3;var z0=0;break a}for(R0=0;R0<r5;++R0)t5[dO[R0]]=ne(Po,3);var Lg=void 0,cd=void 0,n5=B0,BO=t5,$0=Fg,a5=ld,Dg=0,Oo=n5.m,s5=8,i5=i(128,j);n:for(;F(i5,0,7,BO,19);){if(ne(Oo,1)){var UO=2+2*ne(Oo,3);if((Lg=2+ne(Oo,UO))>$0)break n}else Lg=$0;for(cd=0;cd<$0&&Lg--;){R(Oo);var o5=i5[0+(127&D(Oo))];M(Oo,Oo.u+o5.g);var Fc=o5.value;if(16>Fc)a5[cd++]=Fc,Fc!=0&&(s5=Fc);else{var zO=Fc==16,l5=Fc-16,$O=cO[l5],c5=ne(Oo,lO[l5])+$O;if(cd+c5>$0)break n;for(var WO=zO?s5:0;0<c5--;)a5[cd++]=WO}}Dg=1;break n}Dg||(n5.a=3),U0=Dg}(U0=U0&&!Po.h)&&(Ig=F(IO,LO,8,ld,Fg)),U0&&Ig!=0?z0=Ig:(B0.a=3,z0=0)}if(z0==0)break r;if(M0&&uO[Ht]==1&&(M0=D0[vn].g==0),Zw+=D0[vn].g,vn+=z0,3>=Ht){var ud,Mg=od[0];for(ud=1;ud<Jr;++ud)od[ud]>Mg&&(Mg=od[ud]);Qw+=Mg}}if(Ws.nd=M0,Ws.Qb=0,M0&&(Ws.qb=(Pc[3][Oc[3]+0].value<<24|Pc[1][Oc[1]+0].value<<16|Pc[2][Oc[2]+0].value)>>>0,Zw==0&&256>Pc[0][Oc[0]+0].value&&(Ws.Qb=1,Ws.qb+=Pc[0][Oc[0]+0].value<<8)),Ws.jc=!Ws.Qb&&6>Qw,Ws.jc){var W0,Ui=Ws;for(W0=0;W0<ta;++W0){var Fo=W0,Io=Ui.pd[Fo],H0=Ui.G[0][Ui.H[0]+Fo];256<=H0.value?(Io.g=H0.g+256,Io.value=H0.value):(Io.g=0,Io.value=0,Fo>>=Rr(H0,8,Io),Fo>>=Rr(Ui.G[1][Ui.H[1]+Fo],16,Io),Fo>>=Rr(Ui.G[2][Ui.H[2]+Fo],0,Io),Rr(Ui.G[3][Ui.H[3]+Fo],24,Io))}}}Wn.vc=ra,Wn.Wb=Ea,Wn.Ya=L0,Wn.yc=Og,Ar=1;break t}Ar=0}if(!(ae=Ar)){W.a=3;break e}if(0<Me){if(me.ua=1<<Me,!we(me.Wa,Me)){W.a=1,ae=0;break e}}else me.ua=0;var Rg=W,u5=ie,HO=oe,Bg=Rg.s,Ug=Bg.xc;if(Rg.c=u5,Rg.i=HO,Bg.md=ge(u5,Ug),Bg.wc=Ug==0?-1:(1<<Ug)-1,O){W.xb=wO;break e}if((Ne=s(ie*oe))==null){W.a=1,ae=0;break e}ae=(ae=ye(W,Ne,0,ie,oe,oe,null))&&!ce.h;break e}return ae?(te!=null?te[0]=Ne:(t(Ne==null),t(O)),W.$=0,O||De(me)):De(me),ae}function Be(x,w){var O=x.c*x.i,W=O+w+16*w;return t(x.c<=w),x.V=s(W),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+O+w,1)}function ze(x,w){var O=x.C,W=w-O,te=x.V,ae=x.Ba+x.c*O;for(t(w<=x.l.o);0<W;){var ie=16<W?16:W,oe=x.l.ma,ce=x.l.width,me=ce*ie,Ne=oe.ca,Me=oe.tb+ce*O,Re=x.Ta,Te=x.Ua;se(x,ie,te,ae),ln(Re,Te,Ne,Me,me),fe(oe,O,O+ie,Ne,Me,ce),W-=ie,te+=ie*x.c,O+=ie}t(O==w),x.C=x.Ma=w}function nt(){this.ub=this.yd=this.td=this.Rb=0}function st(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ft(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function at(){this.Yb=(function(){var x=[];return(function w(O,W,te){for(var ae=te[W],ie=0;ie<ae&&(O.push(te.length>W+1?[]:0),!(te.length<W+1));ie++)w(O[ie],W+1,te)})(x,0,[3,11]),x})()}function dt(){this.jb=s(3),this.Wc=o([4,8],at),this.Xc=o([4,17],at)}function Bt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function dr(){this.ld=this.La=this.dd=this.tc=0}function br(){this.Na=this.la=0}function gn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ms(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Pi(){this.uc=this.M=this.Nb=0,this.wa=Array(new dr),this.Y=0,this.ya=Array(new Ms),this.aa=0,this.l=new li}function oi(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Rs(){this.cb=this.a=0,this.sc="",this.m=new le,this.Od=new nt,this.Kc=new st,this.ed=new Bt,this.Qa=new ft,this.Ic=this.$c=this.Aa=0,this.D=new Pi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,le),this.ia=0,this.pb=i(4,gn),this.Pa=new dt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new oi),this.Hd=0,this.rb=Array(new br),this.sb=0,this.wa=Array(new dr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ms),this.L=this.aa=0,this.gd=o([4,2],dr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function li(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xa(){var x=new Rs;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,sd||(sd=i0)),x}function sn(x,w,O){return x.a==0&&(x.a=w,x.sc=O,x.cb=0),0}function a0(x,w,O){return 3<=O&&x[w+0]==157&&x[w+1]==1&&x[w+2]==42}function s0(x,w){if(x==null)return 0;if(x.a=0,x.sc="OK",w==null)return sn(x,2,"null VP8Io passed to VP8GetHeaders()");var O=w.data,W=w.w,te=w.ha;if(4>te)return sn(x,7,"Truncated header.");var ae=O[W+0]|O[W+1]<<8|O[W+2]<<16,ie=x.Od;if(ie.Rb=!(1&ae),ie.td=ae>>1&7,ie.yd=ae>>4&1,ie.ub=ae>>5,3<ie.td)return sn(x,3,"Incorrect keyframe parameters.");if(!ie.yd)return sn(x,4,"Frame not displayable.");W+=3,te-=3;var oe=x.Kc;if(ie.Rb){if(7>te)return sn(x,7,"cannot parse picture header");if(!a0(O,W,te))return sn(x,3,"Bad code word");oe.c=16383&(O[W+4]<<8|O[W+3]),oe.Td=O[W+4]>>6,oe.i=16383&(O[W+6]<<8|O[W+5]),oe.Ud=O[W+6]>>6,W+=7,te-=7,x.za=oe.c+15>>4,x.Ub=oe.i+15>>4,w.width=oe.c,w.height=oe.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,a((ae=x.Pa).jb,0,255,ae.jb.length),t((ae=x.Qa)!=null),ae.Cb=0,ae.Bb=0,ae.Fb=1,a(ae.Zb,0,0,ae.Zb.length),a(ae.Lb,0,0,ae.Lb)}if(ie.ub>te)return sn(x,7,"bad partition length");X(ae=x.m,O,W,ie.ub),W+=ie.ub,te-=ie.ub,ie.Rb&&(oe.Ld=J(ae),oe.Kd=J(ae)),oe=x.Qa;var ce,me=x.Pa;if(t(ae!=null),t(oe!=null),oe.Cb=J(ae),oe.Cb){if(oe.Bb=J(ae),J(ae)){for(oe.Fb=J(ae),ce=0;4>ce;++ce)oe.Zb[ce]=J(ae)?ee(ae,7):0;for(ce=0;4>ce;++ce)oe.Lb[ce]=J(ae)?ee(ae,6):0}if(oe.Bb)for(ce=0;3>ce;++ce)me.jb[ce]=J(ae)?K(ae,8):255}else oe.Bb=0;if(ae.Ka)return sn(x,3,"cannot parse segment header");if((oe=x.ed).zd=J(ae),oe.Tb=K(ae,6),oe.wb=K(ae,3),oe.Pc=J(ae),oe.Pc&&J(ae)){for(me=0;4>me;++me)J(ae)&&(oe.vd[me]=ee(ae,6));for(me=0;4>me;++me)J(ae)&&(oe.od[me]=ee(ae,6))}if(x.L=oe.Tb==0?0:oe.zd?1:2,ae.Ka)return sn(x,3,"cannot parse filter header");var Ne=te;if(te=ce=W,W=ce+Ne,oe=Ne,x.Xb=(1<<K(x.m,2))-1,Ne<3*(me=x.Xb))O=7;else{for(ce+=3*me,oe-=3*me,Ne=0;Ne<me;++Ne){var Me=O[te+0]|O[te+1]<<8|O[te+2]<<16;Me>oe&&(Me=oe),X(x.Jc[+Ne],O,ce,Me),ce+=Me,oe-=Me,te+=3}X(x.Jc[+me],O,ce,oe),O=ce<W?0:5}if(O!=0)return sn(x,O,"cannot parse partitions");for(O=K(ce=x.m,7),te=J(ce)?ee(ce,4):0,W=J(ce)?ee(ce,4):0,oe=J(ce)?ee(ce,4):0,me=J(ce)?ee(ce,4):0,ce=J(ce)?ee(ce,4):0,Ne=x.Qa,Me=0;4>Me;++Me){if(Ne.Cb){var Re=Ne.Zb[Me];Ne.Fb||(Re+=O)}else{if(0<Me){x.pb[Me]=x.pb[0];continue}Re=O}var Te=x.pb[Me];Te.Sc[0]=Eg[Ja(Re+te,127)],Te.Sc[1]=Tg[Ja(Re+0,127)],Te.Eb[0]=2*Eg[Ja(Re+W,127)],Te.Eb[1]=101581*Tg[Ja(Re+oe,127)]>>16,8>Te.Eb[1]&&(Te.Eb[1]=8),Te.Qc[0]=Eg[Ja(Re+me,117)],Te.Qc[1]=Tg[Ja(Re+ce,127)],Te.lc=Re+ce}if(!ie.Rb)return sn(x,4,"Not a key frame.");for(J(ae),ie=x.Pa,O=0;4>O;++O){for(te=0;8>te;++te)for(W=0;3>W;++W)for(oe=0;11>oe;++oe)me=G(ae,yO[O][te][W][oe])?K(ae,8):xO[O][te][W][oe],ie.Wc[O][te].Yb[W][oe]=me;for(te=0;17>te;++te)ie.Xc[O][te]=ie.Wc[O][bO[te]]}return x.kc=J(ae),x.kc&&(x.Bd=K(ae,8)),x.cb=1}function i0(x,w,O,W,te,ae,ie){var oe=w[te].Yb[O];for(O=0;16>te;++te){if(!G(x,oe[O+0]))return te;for(;!G(x,oe[O+1]);)if(oe=w[++te].Yb[0],O=0,te==16)return 16;var ce=w[te+1].Yb;if(G(x,oe[O+2])){var me=x,Ne=0;if(G(me,(Re=oe)[(Me=O)+3]))if(G(me,Re[Me+6])){for(oe=0,Me=2*(Ne=G(me,Re[Me+8]))+(Re=G(me,Re[Me+9+Ne])),Ne=0,Re=pO[Me];Re[oe];++oe)Ne+=Ne+G(me,Re[oe]);Ne+=3+(8<<Me)}else G(me,Re[Me+7])?(Ne=7+2*G(me,165),Ne+=G(me,145)):Ne=5+G(me,159);else Ne=G(me,Re[Me+4])?3+G(me,Re[Me+5]):2;oe=ce[2]}else Ne=1,oe=ce[1];ce=ie+gO[te],0>(me=x).b&&H(me);var Me,Re=me.b,Te=(Me=me.Ca>>1)-(me.I>>Re)>>31;--me.b,me.Ca+=Te,me.Ca|=1,me.I-=(Me+1&Te)<<Re,ae[ce]=((Ne^Te)-Te)*W[(0<te)+0]}return 16}function Du(x){var w=x.rb[x.sb-1];w.la=0,w.Na=0,a(x.zc,0,0,x.zc.length),x.ja=0}function sg(x,w){if(x==null)return 0;if(w==null)return sn(x,2,"NULL VP8Io parameter in VP8Decode().");if(!x.cb&&!s0(x,w))return 0;if(t(x.cb),w.ac==null||w.ac(w)){w.ob&&(x.L=0);var O=I0[x.L];if(x.L==2?(x.yb=0,x.zb=0):(x.yb=w.v-O>>4,x.zb=w.j-O>>4,0>x.yb&&(x.yb=0),0>x.zb&&(x.zb=0)),x.Va=w.o+15+O>>4,x.Hb=w.va+15+O>>4,x.Hb>x.za&&(x.Hb=x.za),x.Va>x.Ub&&(x.Va=x.Ub),0<x.L){var W=x.ed;for(O=0;4>O;++O){var te;if(x.Qa.Cb){var ae=x.Qa.Lb[O];x.Qa.Fb||(ae+=W.Tb)}else ae=W.Tb;for(te=0;1>=te;++te){var ie=x.gd[O][te],oe=ae;if(W.Pc&&(oe+=W.vd[0],te&&(oe+=W.od[0])),0<(oe=0>oe?0:63<oe?63:oe)){var ce=oe;0<W.wb&&(ce=4<W.wb?ce>>2:ce>>1)>9-W.wb&&(ce=9-W.wb),1>ce&&(ce=1),ie.dd=ce,ie.tc=2*oe+ce,ie.ld=40<=oe?2:15<=oe?1:0}else ie.tc=0;ie.La=te}}}O=0}else sn(x,6,"Frame setup failed"),O=x.a;if(O=O==0){if(O){x.$c=0,0<x.Aa||(x.Ic=FO);e:{O=x.Ic,W=4*(ce=x.za);var me=32*ce,Ne=ce+1,Me=0<x.L?ce*(0<x.Aa?2:1):0,Re=(x.Aa==2?2:1)*ce;if((ie=W+832+(te=3*(16*O+I0[x.L])/2*me)+(ae=x.Fa!=null&&0<x.Fa.length?x.Kc.c*x.Kc.i:0))!=ie)O=0;else{if(ie>x.Vb){if(x.Vb=0,x.Ec=s(ie),x.Fc=0,x.Ec==null){O=sn(x,1,"no memory during frame initialization.");break e}x.Vb=ie}ie=x.Ec,oe=x.Fc,x.Ac=ie,x.Bc=oe,oe+=W,x.Gd=i(me,oi),x.Hd=0,x.rb=i(Ne+1,br),x.sb=1,x.wa=Me?i(Me,dr):null,x.Y=0,x.D.Nb=0,x.D.wa=x.wa,x.D.Y=x.Y,0<x.Aa&&(x.D.Y+=ce),t(!0),x.oc=ie,x.pc=oe,oe+=832,x.ya=i(Re,Ms),x.aa=0,x.D.ya=x.ya,x.D.aa=x.aa,x.Aa==2&&(x.D.aa+=ce),x.R=16*ce,x.B=8*ce,ce=(me=I0[x.L])*x.R,me=me/2*x.B,x.sa=ie,x.ta=oe+ce,x.qa=x.sa,x.ra=x.ta+16*O*x.R+me,x.Ha=x.qa,x.Ia=x.ra+8*O*x.B+me,x.$c=0,oe+=te,x.mb=ae?ie:null,x.nb=ae?oe:null,t(oe+ae<=x.Fc+x.Vb),Du(x),a(x.Ac,x.Bc,0,W),O=1}}if(O){if(w.ka=0,w.y=x.sa,w.O=x.ta,w.f=x.qa,w.N=x.ra,w.ea=x.Ha,w.Vd=x.Ia,w.fa=x.R,w.Rc=x.B,w.F=null,w.J=0,!A0){for(O=-255;255>=O;++O)Tn[255+O]=0>O?-O:O;for(O=-1020;1020>=O;++O)Mi[1020+O]=-128>O?-128:127<O?127:O;for(O=-112;112>=O;++O)ad[112+O]=-16>O?-16:15<O?15:O;for(O=-255;510>=O;++O)Ec[255+O]=0>O?0:255<O?255:O;A0=1}jc=lg,Di=ig,td=l0,Ca=og,ms=c0,on=o0,kc=$u,N0=dl,rd=wg,ml=Wu,pl=bg,jo=xc,gl=Hu,Cc=v0,xl=x0,ko=ui,nd=Fi,ps=yg,$s[0]=ci,$s[1]=cg,$s[2]=hg,$s[3]=mg,$s[4]=f0,$s[5]=pc,$s[6]=h0,$s[7]=Bu,$s[8]=gg,$s[9]=pg,Co[0]=u0,Co[1]=dg,Co[2]=Oi,Co[3]=hc,Co[4]=la,Co[5]=fg,Co[6]=d0,Ri[0]=wo,Ri[1]=ug,Ri[2]=xg,Ri[3]=Uu,Ri[4]=ul,Ri[5]=vg,Ri[6]=zu,O=1}else O=0}O&&(O=(function(Te,Xe){for(Te.M=0;Te.M<Te.Va;++Te.M){var He,je=Te.Jc[Te.M&Te.Xb],Ce=Te.m,Ye=Te;for(He=0;He<Ye.za;++He){var Qe=Ce,Ke=Ye,mt=Ke.Ac,ct=Ke.Bc+4*He,Et=Ke.zc,ut=Ke.ya[Ke.aa+He];if(Ke.Qa.Bb?ut.$b=G(Qe,Ke.Pa.jb[0])?2+G(Qe,Ke.Pa.jb[2]):G(Qe,Ke.Pa.jb[1]):ut.$b=0,Ke.kc&&(ut.Ad=G(Qe,Ke.Bd)),ut.Za=!G(Qe,145)+0,ut.Za){var ur=ut.Ob,hr=0;for(Ke=0;4>Ke;++Ke){var ar,Jt=Et[0+Ke];for(ar=0;4>ar;++ar){Jt=vO[mt[ct+ar]][Jt];for(var Ar=zw[G(Qe,Jt[0])];0<Ar;)Ar=zw[2*Ar+G(Qe,Jt[Ar])];Jt=-Ar,mt[ct+ar]=Jt}n(ur,hr,mt,ct,4),hr+=4,Et[0+Ke]=Jt}}else Jt=G(Qe,156)?G(Qe,128)?1:3:G(Qe,163)?2:0,ut.Ob[0]=Jt,a(mt,ct,Jt,4),a(Et,0,Jt,4);ut.Dd=G(Qe,142)?G(Qe,114)?G(Qe,183)?1:3:2:0}if(Ye.m.Ka)return sn(Te,7,"Premature end-of-partition0 encountered.");for(;Te.ja<Te.za;++Te.ja){if(Ye=je,Qe=(Ce=Te).rb[Ce.sb-1],mt=Ce.rb[Ce.sb+Ce.ja],He=Ce.ya[Ce.aa+Ce.ja],ct=Ce.kc?He.Ad:0)Qe.la=mt.la=0,He.Za||(Qe.Na=mt.Na=0),He.Hc=0,He.Gc=0,He.ia=0;else{var wr,Ht;if(Qe=mt,mt=Ye,ct=Ce.Pa.Xc,Et=Ce.ya[Ce.aa+Ce.ja],ut=Ce.pb[Et.$b],Ke=Et.ad,ur=0,hr=Ce.rb[Ce.sb-1],Jt=ar=0,a(Ke,ur,0,384),Et.Za)var vn=0,za=ct[3];else{Ar=s(16);var yn=Qe.Na+hr.Na;if(yn=sd(mt,ct[1],yn,ut.Eb,0,Ar,0),Qe.Na=hr.Na=(0<yn)+0,1<yn)jc(Ar,0,Ke,ur);else{var $a=Ar[0]+3>>3;for(Ar=0;256>Ar;Ar+=16)Ke[ur+Ar]=$a}vn=1,za=ct[0]}var mr=15&Qe.la,Qa=15&hr.la;for(Ar=0;4>Ar;++Ar){var es=1&Qa;for($a=Ht=0;4>$a;++$a)mr=mr>>1|(es=(yn=sd(mt,za,yn=es+(1&mr),ut.Sc,vn,Ke,ur))>vn)<<7,Ht=Ht<<2|(3<yn?3:1<yn?2:Ke[ur+0]!=0),ur+=16;mr>>=4,Qa=Qa>>1|es<<7,ar=(ar<<8|Ht)>>>0}for(za=mr,vn=Qa>>4,wr=0;4>wr;wr+=2){for(Ht=0,mr=Qe.la>>4+wr,Qa=hr.la>>4+wr,Ar=0;2>Ar;++Ar){for(es=1&Qa,$a=0;2>$a;++$a)yn=es+(1&mr),mr=mr>>1|(es=0<(yn=sd(mt,ct[2],yn,ut.Qc,0,Ke,ur)))<<3,Ht=Ht<<2|(3<yn?3:1<yn?2:Ke[ur+0]!=0),ur+=16;mr>>=2,Qa=Qa>>1|es<<5}Jt|=Ht<<4*wr,za|=mr<<4<<wr,vn|=(240&Qa)<<wr}Qe.la=za,hr.la=vn,Et.Hc=ar,Et.Gc=Jt,Et.ia=43690&Jt?0:ut.ia,ct=!(ar|Jt)}if(0<Ce.L&&(Ce.wa[Ce.Y+Ce.ja]=Ce.gd[He.$b][He.Za],Ce.wa[Ce.Y+Ce.ja].La|=!ct),Ye.Ka)return sn(Te,7,"Premature end-of-file encountered.")}if(Du(Te),Ce=Xe,Ye=1,He=(je=Te).D,Qe=0<je.L&&je.M>=je.zb&&je.M<=je.Va,je.Aa==0)e:{if(He.M=je.M,He.uc=Qe,Xu(je,He),Ye=1,He=(Ht=je.D).Nb,Qe=(Jt=I0[je.L])*je.R,mt=Jt/2*je.B,Ar=16*He*je.R,$a=8*He*je.B,ct=je.sa,Et=je.ta-Qe+Ar,ut=je.qa,Ke=je.ra-mt+$a,ur=je.Ha,hr=je.Ia-mt+$a,Qa=(mr=Ht.M)==0,ar=mr>=je.Va-1,je.Aa==2&&Xu(je,Ht),Ht.uc)for(es=(yn=je).D.M,t(yn.D.uc),Ht=yn.yb;Ht<yn.Hb;++Ht){vn=Ht,za=es;var Wn=(ra=(Jr=yn).D).Nb;wr=Jr.R;var ra=ra.wa[ra.Y+vn],Ea=Jr.sa,ys=Jr.ta+16*Wn*wr+16*vn,fi=ra.dd,Hn=ra.tc;if(Hn!=0)if(t(3<=Hn),Jr.L==1)0<vn&&ko(Ea,ys,wr,Hn+4),ra.La&&ps(Ea,ys,wr,Hn),0<za&&xl(Ea,ys,wr,Hn+4),ra.La&&nd(Ea,ys,wr,Hn);else{var Bi=Jr.B,vl=Jr.qa,Tc=Jr.ra+8*Wn*Bi+8*vn,To=Jr.Ha,Jr=Jr.Ia+8*Wn*Bi+8*vn;Wn=ra.ld,0<vn&&(N0(Ea,ys,wr,Hn+4,fi,Wn),ml(vl,Tc,To,Jr,Bi,Hn+4,fi,Wn)),ra.La&&(jo(Ea,ys,wr,Hn,fi,Wn),Cc(vl,Tc,To,Jr,Bi,Hn,fi,Wn)),0<za&&(kc(Ea,ys,wr,Hn+4,fi,Wn),rd(vl,Tc,To,Jr,Bi,Hn+4,fi,Wn)),ra.La&&(pl(Ea,ys,wr,Hn,fi,Wn),gl(vl,Tc,To,Jr,Bi,Hn,fi,Wn))}}if(je.ia&&alert("todo:DitherRow"),Ce.put!=null){if(Ht=16*mr,mr=16*(mr+1),Qa?(Ce.y=je.sa,Ce.O=je.ta+Ar,Ce.f=je.qa,Ce.N=je.ra+$a,Ce.ea=je.Ha,Ce.W=je.Ia+$a):(Ht-=Jt,Ce.y=ct,Ce.O=Et,Ce.f=ut,Ce.N=Ke,Ce.ea=ur,Ce.W=hr),ar||(mr-=Jt),mr>Ce.o&&(mr=Ce.o),Ce.F=null,Ce.J=null,je.Fa!=null&&0<je.Fa.length&&Ht<mr&&(Ce.J=Yu(je,Ce,Ht,mr-Ht),Ce.F=je.mb,Ce.F==null&&Ce.F.length==0)){Ye=sn(je,3,"Could not decode alpha data.");break e}Ht<Ce.j&&(Jt=Ce.j-Ht,Ht=Ce.j,t(!(1&Jt)),Ce.O+=je.R*Jt,Ce.N+=je.B*(Jt>>1),Ce.W+=je.B*(Jt>>1),Ce.F!=null&&(Ce.J+=Ce.width*Jt)),Ht<mr&&(Ce.O+=Ce.v,Ce.N+=Ce.v>>1,Ce.W+=Ce.v>>1,Ce.F!=null&&(Ce.J+=Ce.v),Ce.ka=Ht-Ce.j,Ce.U=Ce.va-Ce.v,Ce.T=mr-Ht,Ye=Ce.put(Ce))}He+1!=je.Ic||ar||(n(je.sa,je.ta-Qe,ct,Et+16*je.R,Qe),n(je.qa,je.ra-mt,ut,Ke+8*je.B,mt),n(je.Ha,je.Ia-mt,ur,hr+8*je.B,mt))}if(!Ye)return sn(Te,6,"Output aborted.")}return 1})(x,w)),w.bc!=null&&w.bc(w),O&=1}return O?(x.cb=0,O):0}function Bs(x,w,O,W,te){te=x[w+O+32*W]+(te>>3),x[w+O+32*W]=-256&te?0>te?0:255:te}function fc(x,w,O,W,te,ae){Bs(x,w,0,O,W+te),Bs(x,w,1,O,W+ae),Bs(x,w,2,O,W-ae),Bs(x,w,3,O,W-te)}function Ra(x){return(20091*x>>16)+x}function Mu(x,w,O,W){var te,ae=0,ie=s(16);for(te=0;4>te;++te){var oe=x[w+0]+x[w+8],ce=x[w+0]-x[w+8],me=(35468*x[w+4]>>16)-Ra(x[w+12]),Ne=Ra(x[w+4])+(35468*x[w+12]>>16);ie[ae+0]=oe+Ne,ie[ae+1]=ce+me,ie[ae+2]=ce-me,ie[ae+3]=oe-Ne,ae+=4,w++}for(te=ae=0;4>te;++te)oe=(x=ie[ae+0]+4)+ie[ae+8],ce=x-ie[ae+8],me=(35468*ie[ae+4]>>16)-Ra(ie[ae+12]),Bs(O,W,0,0,oe+(Ne=Ra(ie[ae+4])+(35468*ie[ae+12]>>16))),Bs(O,W,1,0,ce+me),Bs(O,W,2,0,ce-me),Bs(O,W,3,0,oe-Ne),ae++,W+=32}function o0(x,w,O,W){var te=x[w+0]+4,ae=35468*x[w+4]>>16,ie=Ra(x[w+4]),oe=35468*x[w+1]>>16;fc(O,W,0,te+ie,x=Ra(x[w+1]),oe),fc(O,W,1,te+ae,x,oe),fc(O,W,2,te-ae,x,oe),fc(O,W,3,te-ie,x,oe)}function ig(x,w,O,W,te){Mu(x,w,O,W),te&&Mu(x,w+16,O,W+4)}function l0(x,w,O,W){Di(x,w+0,O,W,1),Di(x,w+32,O,W+128,1)}function og(x,w,O,W){var te;for(x=x[w+0]+4,te=0;4>te;++te)for(w=0;4>w;++w)Bs(O,W,w,te,x)}function c0(x,w,O,W){x[w+0]&&Ca(x,w+0,O,W),x[w+16]&&Ca(x,w+16,O,W+4),x[w+32]&&Ca(x,w+32,O,W+128),x[w+48]&&Ca(x,w+48,O,W+128+4)}function lg(x,w,O,W){var te,ae=s(16);for(te=0;4>te;++te){var ie=x[w+0+te]+x[w+12+te],oe=x[w+4+te]+x[w+8+te],ce=x[w+4+te]-x[w+8+te],me=x[w+0+te]-x[w+12+te];ae[0+te]=ie+oe,ae[8+te]=ie-oe,ae[4+te]=me+ce,ae[12+te]=me-ce}for(te=0;4>te;++te)ie=(x=ae[0+4*te]+3)+ae[3+4*te],oe=ae[1+4*te]+ae[2+4*te],ce=ae[1+4*te]-ae[2+4*te],me=x-ae[3+4*te],O[W+0]=ie+oe>>3,O[W+16]=me+ce>>3,O[W+32]=ie-oe>>3,O[W+48]=me-ce>>3,W+=64}function Ru(x,w,O){var W,te=w-32,ae=Za,ie=255-x[te-1];for(W=0;W<O;++W){var oe,ce=ae,me=ie+x[w-1];for(oe=0;oe<O;++oe)x[w+oe]=ce[me+x[te+oe]];w+=32}}function cg(x,w){Ru(x,w,4)}function ug(x,w){Ru(x,w,8)}function dg(x,w){Ru(x,w,16)}function Oi(x,w){var O;for(O=0;16>O;++O)n(x,w+32*O,x,w-32,16)}function hc(x,w){var O;for(O=16;0<O;--O)a(x,w,x[w-1],16),w+=32}function mc(x,w,O){var W;for(W=0;16>W;++W)a(w,O+32*W,x,16)}function u0(x,w){var O,W=16;for(O=0;16>O;++O)W+=x[w-1+32*O]+x[w+O-32];mc(W>>5,x,w)}function la(x,w){var O,W=8;for(O=0;16>O;++O)W+=x[w-1+32*O];mc(W>>4,x,w)}function fg(x,w){var O,W=8;for(O=0;16>O;++O)W+=x[w+O-32];mc(W>>4,x,w)}function d0(x,w){mc(128,x,w)}function Ut(x,w,O){return x+2*w+O+2>>2}function hg(x,w){var O,W=w-32;for(W=new Uint8Array([Ut(x[W-1],x[W+0],x[W+1]),Ut(x[W+0],x[W+1],x[W+2]),Ut(x[W+1],x[W+2],x[W+3]),Ut(x[W+2],x[W+3],x[W+4])]),O=0;4>O;++O)n(x,w+32*O,W,0,W.length)}function mg(x,w){var O=x[w-1],W=x[w-1+32],te=x[w-1+64],ae=x[w-1+96];Q(x,w+0,16843009*Ut(x[w-1-32],O,W)),Q(x,w+32,16843009*Ut(O,W,te)),Q(x,w+64,16843009*Ut(W,te,ae)),Q(x,w+96,16843009*Ut(te,ae,ae))}function ci(x,w){var O,W=4;for(O=0;4>O;++O)W+=x[w+O-32]+x[w-1+32*O];for(W>>=3,O=0;4>O;++O)a(x,w+32*O,W,4)}function f0(x,w){var O=x[w-1+0],W=x[w-1+32],te=x[w-1+64],ae=x[w-1-32],ie=x[w+0-32],oe=x[w+1-32],ce=x[w+2-32],me=x[w+3-32];x[w+0+96]=Ut(W,te,x[w-1+96]),x[w+1+96]=x[w+0+64]=Ut(O,W,te),x[w+2+96]=x[w+1+64]=x[w+0+32]=Ut(ae,O,W),x[w+3+96]=x[w+2+64]=x[w+1+32]=x[w+0+0]=Ut(ie,ae,O),x[w+3+64]=x[w+2+32]=x[w+1+0]=Ut(oe,ie,ae),x[w+3+32]=x[w+2+0]=Ut(ce,oe,ie),x[w+3+0]=Ut(me,ce,oe)}function h0(x,w){var O=x[w+1-32],W=x[w+2-32],te=x[w+3-32],ae=x[w+4-32],ie=x[w+5-32],oe=x[w+6-32],ce=x[w+7-32];x[w+0+0]=Ut(x[w+0-32],O,W),x[w+1+0]=x[w+0+32]=Ut(O,W,te),x[w+2+0]=x[w+1+32]=x[w+0+64]=Ut(W,te,ae),x[w+3+0]=x[w+2+32]=x[w+1+64]=x[w+0+96]=Ut(te,ae,ie),x[w+3+32]=x[w+2+64]=x[w+1+96]=Ut(ae,ie,oe),x[w+3+64]=x[w+2+96]=Ut(ie,oe,ce),x[w+3+96]=Ut(oe,ce,ce)}function pc(x,w){var O=x[w-1+0],W=x[w-1+32],te=x[w-1+64],ae=x[w-1-32],ie=x[w+0-32],oe=x[w+1-32],ce=x[w+2-32],me=x[w+3-32];x[w+0+0]=x[w+1+64]=ae+ie+1>>1,x[w+1+0]=x[w+2+64]=ie+oe+1>>1,x[w+2+0]=x[w+3+64]=oe+ce+1>>1,x[w+3+0]=ce+me+1>>1,x[w+0+96]=Ut(te,W,O),x[w+0+64]=Ut(W,O,ae),x[w+0+32]=x[w+1+96]=Ut(O,ae,ie),x[w+1+32]=x[w+2+96]=Ut(ae,ie,oe),x[w+2+32]=x[w+3+96]=Ut(ie,oe,ce),x[w+3+32]=Ut(oe,ce,me)}function Bu(x,w){var O=x[w+0-32],W=x[w+1-32],te=x[w+2-32],ae=x[w+3-32],ie=x[w+4-32],oe=x[w+5-32],ce=x[w+6-32],me=x[w+7-32];x[w+0+0]=O+W+1>>1,x[w+1+0]=x[w+0+64]=W+te+1>>1,x[w+2+0]=x[w+1+64]=te+ae+1>>1,x[w+3+0]=x[w+2+64]=ae+ie+1>>1,x[w+0+32]=Ut(O,W,te),x[w+1+32]=x[w+0+96]=Ut(W,te,ae),x[w+2+32]=x[w+1+96]=Ut(te,ae,ie),x[w+3+32]=x[w+2+96]=Ut(ae,ie,oe),x[w+3+64]=Ut(ie,oe,ce),x[w+3+96]=Ut(oe,ce,me)}function pg(x,w){var O=x[w-1+0],W=x[w-1+32],te=x[w-1+64],ae=x[w-1+96];x[w+0+0]=O+W+1>>1,x[w+2+0]=x[w+0+32]=W+te+1>>1,x[w+2+32]=x[w+0+64]=te+ae+1>>1,x[w+1+0]=Ut(O,W,te),x[w+3+0]=x[w+1+32]=Ut(W,te,ae),x[w+3+32]=x[w+1+64]=Ut(te,ae,ae),x[w+3+64]=x[w+2+64]=x[w+0+96]=x[w+1+96]=x[w+2+96]=x[w+3+96]=ae}function gg(x,w){var O=x[w-1+0],W=x[w-1+32],te=x[w-1+64],ae=x[w-1+96],ie=x[w-1-32],oe=x[w+0-32],ce=x[w+1-32],me=x[w+2-32];x[w+0+0]=x[w+2+32]=O+ie+1>>1,x[w+0+32]=x[w+2+64]=W+O+1>>1,x[w+0+64]=x[w+2+96]=te+W+1>>1,x[w+0+96]=ae+te+1>>1,x[w+3+0]=Ut(oe,ce,me),x[w+2+0]=Ut(ie,oe,ce),x[w+1+0]=x[w+3+32]=Ut(O,ie,oe),x[w+1+32]=x[w+3+64]=Ut(W,O,ie),x[w+1+64]=x[w+3+96]=Ut(te,W,O),x[w+1+96]=Ut(ae,te,W)}function xg(x,w){var O;for(O=0;8>O;++O)n(x,w+32*O,x,w-32,8)}function Uu(x,w){var O;for(O=0;8>O;++O)a(x,w,x[w-1],8),w+=32}function cl(x,w,O){var W;for(W=0;8>W;++W)a(w,O+32*W,x,8)}function wo(x,w){var O,W=8;for(O=0;8>O;++O)W+=x[w+O-32]+x[w-1+32*O];cl(W>>4,x,w)}function vg(x,w){var O,W=4;for(O=0;8>O;++O)W+=x[w+O-32];cl(W>>3,x,w)}function ul(x,w){var O,W=4;for(O=0;8>O;++O)W+=x[w-1+32*O];cl(W>>3,x,w)}function zu(x,w){cl(128,x,w)}function gc(x,w,O){var W=x[w-O],te=x[w+0],ae=3*(te-W)+Ng[1020+x[w-2*O]-x[w+O]],ie=j0[112+(ae+4>>3)];x[w-O]=Za[255+W+j0[112+(ae+3>>3)]],x[w+0]=Za[255+te-ie]}function m0(x,w,O,W){var te=x[w+0],ae=x[w+O];return xs[255+x[w-2*O]-x[w-O]]>W||xs[255+ae-te]>W}function p0(x,w,O,W){return 4*xs[255+x[w-O]-x[w+0]]+xs[255+x[w-2*O]-x[w+O]]<=W}function g0(x,w,O,W,te){var ae=x[w-3*O],ie=x[w-2*O],oe=x[w-O],ce=x[w+0],me=x[w+O],Ne=x[w+2*O],Me=x[w+3*O];return 4*xs[255+oe-ce]+xs[255+ie-me]>W?0:xs[255+x[w-4*O]-ae]<=te&&xs[255+ae-ie]<=te&&xs[255+ie-oe]<=te&&xs[255+Me-Ne]<=te&&xs[255+Ne-me]<=te&&xs[255+me-ce]<=te}function x0(x,w,O,W){var te=2*W+1;for(W=0;16>W;++W)p0(x,w+W,O,te)&&gc(x,w+W,O)}function ui(x,w,O,W){var te=2*W+1;for(W=0;16>W;++W)p0(x,w+W*O,1,te)&&gc(x,w+W*O,1)}function Fi(x,w,O,W){var te;for(te=3;0<te;--te)x0(x,w+=4*O,O,W)}function yg(x,w,O,W){var te;for(te=3;0<te;--te)ui(x,w+=4,O,W)}function So(x,w,O,W,te,ae,ie,oe){for(ae=2*ae+1;0<te--;){if(g0(x,w,O,ae,ie))if(m0(x,w,O,oe))gc(x,w,O);else{var ce=x,me=w,Ne=O,Me=ce[me-2*Ne],Re=ce[me-Ne],Te=ce[me+0],Xe=ce[me+Ne],He=ce[me+2*Ne],je=27*(Ye=Ng[1020+3*(Te-Re)+Ng[1020+Me-Xe]])+63>>7,Ce=18*Ye+63>>7,Ye=9*Ye+63>>7;ce[me-3*Ne]=Za[255+ce[me-3*Ne]+Ye],ce[me-2*Ne]=Za[255+Me+Ce],ce[me-Ne]=Za[255+Re+je],ce[me+0]=Za[255+Te-je],ce[me+Ne]=Za[255+Xe-Ce],ce[me+2*Ne]=Za[255+He-Ye]}w+=W}}function Us(x,w,O,W,te,ae,ie,oe){for(ae=2*ae+1;0<te--;){if(g0(x,w,O,ae,ie))if(m0(x,w,O,oe))gc(x,w,O);else{var ce=x,me=w,Ne=O,Me=ce[me-Ne],Re=ce[me+0],Te=ce[me+Ne],Xe=j0[112+((He=3*(Re-Me))+4>>3)],He=j0[112+(He+3>>3)],je=Xe+1>>1;ce[me-2*Ne]=Za[255+ce[me-2*Ne]+je],ce[me-Ne]=Za[255+Me+He],ce[me+0]=Za[255+Re-Xe],ce[me+Ne]=Za[255+Te-je]}w+=W}}function $u(x,w,O,W,te,ae){So(x,w,O,1,16,W,te,ae)}function dl(x,w,O,W,te,ae){So(x,w,1,O,16,W,te,ae)}function bg(x,w,O,W,te,ae){var ie;for(ie=3;0<ie;--ie)Us(x,w+=4*O,O,1,16,W,te,ae)}function xc(x,w,O,W,te,ae){var ie;for(ie=3;0<ie;--ie)Us(x,w+=4,1,O,16,W,te,ae)}function wg(x,w,O,W,te,ae,ie,oe){So(x,w,te,1,8,ae,ie,oe),So(O,W,te,1,8,ae,ie,oe)}function Wu(x,w,O,W,te,ae,ie,oe){So(x,w,1,te,8,ae,ie,oe),So(O,W,1,te,8,ae,ie,oe)}function Hu(x,w,O,W,te,ae,ie,oe){Us(x,w+4*te,te,1,8,ae,ie,oe),Us(O,W+4*te,te,1,8,ae,ie,oe)}function v0(x,w,O,W,te,ae,ie,oe){Us(x,w+4,1,te,8,ae,ie,oe),Us(O,W+4,1,te,8,ae,ie,oe)}function vc(){this.ba=new tr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Vt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function qu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Gu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function y0(){this.ua=0,this.Wa=new Z,this.vb=new Z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new B,this.yc=new j}function Sg(){this.xb=this.a=0,this.l=new li,this.ca=new tr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new y0,this.ab=0,this.gc=i(4,Gu),this.Oc=0}function yc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new li,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function fl(x,w,O,W,te,ae,ie){for(x=x==null?0:x[w+0],w=0;w<ie;++w)te[ae+w]=x+O[W+w]&255,x=te[ae+w]}function Vu(x,w,O,W,te,ae,ie){var oe;if(x==null)fl(null,null,O,W,te,ae,ie);else for(oe=0;oe<ie;++oe)te[ae+oe]=x[w+oe]+O[W+oe]&255}function _o(x,w,O,W,te,ae,ie){if(x==null)fl(null,null,O,W,te,ae,ie);else{var oe,ce=x[w+0],me=ce,Ne=ce;for(oe=0;oe<ie;++oe)me=Ne+(ce=x[w+oe])-me,Ne=O[W+oe]+(-256&me?0>me?0:255:me)&255,me=ce,te[ae+oe]=Ne}}function Yu(x,w,O,W){var te=w.width,ae=w.o;if(t(x!=null&&w!=null),0>O||0>=W||O+W>ae)return null;if(!x.Cc){if(x.ga==null){var ie;if(x.ga=new yc,(ie=x.ga==null)||(ie=w.width*w.o,t(x.Gb.length==0),x.Gb=s(ie),x.Uc=0,x.Gb==null?ie=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,ie=1),ie=!ie),!ie){ie=x.ga;var oe=x.Fa,ce=x.P,me=x.qc,Ne=x.mb,Me=x.nb,Re=ce+1,Te=me-1,Xe=ie.l;if(t(oe!=null&&Ne!=null&&w!=null),Eo[0]=null,Eo[1]=fl,Eo[2]=Vu,Eo[3]=_o,ie.ca=Ne,ie.tb=Me,ie.c=w.width,ie.i=w.height,t(0<ie.c&&0<ie.i),1>=me)w=0;else if(ie.$a=oe[ce+0]>>0&3,ie.Z=oe[ce+0]>>2&3,ie.Lc=oe[ce+0]>>4&3,ce=oe[ce+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||ce)w=0;else if(Xe.put=Cn,Xe.ac=nr,Xe.bc=Ma,Xe.ma=ie,Xe.width=w.width,Xe.height=w.height,Xe.Da=w.Da,Xe.v=w.v,Xe.va=w.va,Xe.j=w.j,Xe.o=w.o,ie.$a)e:{t(ie.$a==1),w=We();t:for(;;){if(w==null){w=0;break e}if(t(ie!=null),ie.mc=w,w.c=ie.c,w.i=ie.i,w.l=ie.l,w.l.ma=ie,w.l.width=ie.c,w.l.height=ie.i,w.a=0,Y(w.m,oe,Re,Te),!Ie(ie.c,ie.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&ue(w.s)?(ie.ic=1,oe=w.c*w.i,w.Ta=null,w.Ua=0,w.V=s(oe),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ie.ic=0,w=Be(w,ie.c)),!w))break t;w=1;break e}ie.mc=null,w=0}else w=Te>=ie.c*ie.i;ie=!w}if(ie)return null;x.ga.Lc!=1?x.Ga=0:W=ae-O}t(x.ga!=null),t(O+W<=ae);e:{if(w=(oe=x.ga).c,ae=oe.l.o,oe.$a==0){if(Re=x.rc,Te=x.Vc,Xe=x.Fa,ce=x.P+1+O*w,me=x.mb,Ne=x.nb+O*w,t(ce<=x.P+x.qc),oe.Z!=0)for(t(Eo[oe.Z]!=null),ie=0;ie<W;++ie)Eo[oe.Z](Re,Te,Xe,ce,me,Ne,w),Re=me,Te=Ne,Ne+=w,ce+=w;else for(ie=0;ie<W;++ie)n(me,Ne,Xe,ce,w),Re=me,Te=Ne,Ne+=w,ce+=w;x.rc=Re,x.Vc=Te}else{if(t(oe.mc!=null),w=O+W,t((ie=oe.mc)!=null),t(w<=ie.i),ie.C>=w)w=1;else if(oe.ic||Fe(),oe.ic){oe=ie.V,Re=ie.Ba,Te=ie.c;var He=ie.i,je=(Xe=1,ce=ie.$/Te,me=ie.$%Te,Ne=ie.m,Me=ie.s,ie.$),Ce=Te*He,Ye=Te*w,Qe=Me.wc,Ke=je<Ye?Kr(Me,me,ce):null;t(je<=Ce),t(w<=He),t(ue(Me));t:for(;;){for(;!Ne.h&&je<Ye;){if(me&Qe||(Ke=Kr(Me,me,ce)),t(Ke!=null),R(Ne),256>(He=zn(Ke.G[0],Ke.H[0],Ne)))oe[Re+je]=He,++je,++me>=Te&&(me=0,++ce<=w&&!(ce%16)&&xe(ie,ce));else{if(!(280>He)){Xe=0;break t}He=Un(He-256,Ne);var mt,ct=zn(Ke.G[4],Ke.H[4],Ne);if(R(Ne),!(je>=(ct=En(Te,ct=Un(ct,Ne)))&&Ce-je>=He)){Xe=0;break t}for(mt=0;mt<He;++mt)oe[Re+je+mt]=oe[Re+je+mt-ct];for(je+=He,me+=He;me>=Te;)me-=Te,++ce<=w&&!(ce%16)&&xe(ie,ce);je<Ye&&me&Qe&&(Ke=Kr(Me,me,ce))}t(Ne.h==L(Ne))}xe(ie,ce>w?w:ce);break t}!Xe||Ne.h&&je<Ce?(Xe=0,ie.a=Ne.h?5:3):ie.$=je,w=Xe}else w=ye(ie,ie.V,ie.Ba,ie.c,ie.i,w,ze);if(!w){W=0;break e}}O+W>=ae&&(x.Cc=1),W=1}if(!W)return null;if(x.Cc&&((W=x.ga)!=null&&(W.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+O*te}function C(x,w,O,W,te,ae){for(;0<te--;){var ie,oe=x,ce=w+(O?1:0),me=x,Ne=w+(O?0:3);for(ie=0;ie<W;++ie){var Me=me[Ne+4*ie];Me!=255&&(Me*=32897,oe[ce+4*ie+0]=oe[ce+4*ie+0]*Me>>23,oe[ce+4*ie+1]=oe[ce+4*ie+1]*Me>>23,oe[ce+4*ie+2]=oe[ce+4*ie+2]*Me>>23)}w+=ae}}function re(x,w,O,W,te){for(;0<W--;){var ae;for(ae=0;ae<O;++ae){var ie=x[w+2*ae+0],oe=15&(me=x[w+2*ae+1]),ce=4369*oe,me=(240&me|me>>4)*ce>>16;x[w+2*ae+0]=(240&ie|ie>>4)*ce>>16&240|(15&ie|ie<<4)*ce>>16>>4&15,x[w+2*ae+1]=240&me|oe}w+=te}}function be(x,w,O,W,te,ae,ie,oe){var ce,me,Ne=255;for(me=0;me<te;++me){for(ce=0;ce<W;++ce){var Me=x[w+ce];ae[ie+4*ce]=Me,Ne&=Me}w+=O,ie+=oe}return Ne!=255}function _e(x,w,O,W,te){var ae;for(ae=0;ae<te;++ae)O[W+ae]=x[w+ae]>>8}function Fe(){gs=C,Cr=re,Er=be,ln=_e}function qe(x,w,O){k[x]=function(W,te,ae,ie,oe,ce,me,Ne,Me,Re,Te,Xe,He,je,Ce,Ye,Qe){var Ke,mt=Qe-1>>1,ct=oe[ce+0]|me[Ne+0]<<16,Et=Me[Re+0]|Te[Xe+0]<<16;t(W!=null);var ut=3*ct+Et+131074>>2;for(w(W[te+0],255&ut,ut>>16,He,je),ae!=null&&(ut=3*Et+ct+131074>>2,w(ae[ie+0],255&ut,ut>>16,Ce,Ye)),Ke=1;Ke<=mt;++Ke){var ur=oe[ce+Ke]|me[Ne+Ke]<<16,hr=Me[Re+Ke]|Te[Xe+Ke]<<16,ar=ct+ur+Et+hr+524296,Jt=ar+2*(ur+Et)>>3;ut=Jt+ct>>1,ct=(ar=ar+2*(ct+hr)>>3)+ur>>1,w(W[te+2*Ke-1],255&ut,ut>>16,He,je+(2*Ke-1)*O),w(W[te+2*Ke-0],255&ct,ct>>16,He,je+(2*Ke-0)*O),ae!=null&&(ut=ar+Et>>1,ct=Jt+hr>>1,w(ae[ie+2*Ke-1],255&ut,ut>>16,Ce,Ye+(2*Ke-1)*O),w(ae[ie+2*Ke+0],255&ct,ct>>16,Ce,Ye+(2*Ke+0)*O)),ct=ur,Et=hr}1&Qe||(ut=3*ct+Et+131074>>2,w(W[te+Qe-1],255&ut,ut>>16,He,je+(Qe-1)*O),ae!=null&&(ut=3*Et+ct+131074>>2,w(ae[ie+Qe-1],255&ut,ut>>16,Ce,Ye+(Qe-1)*O)))}}function tt(){vs[k0]=SO,vs[C0]=Ww,vs[Rw]=_O,vs[E0]=Hw,vs[T0]=qw,vs[Ag]=Gw,vs[Bw]=NO,vs[jg]=Ww,vs[kg]=Hw,vs[P0]=qw,vs[Cg]=Gw}function ht(x){return x&-16384?0>x?0:255:x>>AO}function kt(x,w){return ht((19077*x>>8)+(26149*w>>8)-14234)}function Wt(x,w,O){return ht((19077*x>>8)-(6419*w>>8)-(13320*O>>8)+8708)}function zt(x,w){return ht((19077*x>>8)+(33050*w>>8)-17685)}function Qt(x,w,O,W,te){W[te+0]=kt(x,O),W[te+1]=Wt(x,w,O),W[te+2]=zt(x,w)}function Hr(x,w,O,W,te){W[te+0]=zt(x,w),W[te+1]=Wt(x,w,O),W[te+2]=kt(x,O)}function Xr(x,w,O,W,te){var ae=Wt(x,w,O);w=ae<<3&224|zt(x,w)>>3,W[te+0]=248&kt(x,O)|ae>>5,W[te+1]=w}function xn(x,w,O,W,te){var ae=240&zt(x,w)|15;W[te+0]=240&kt(x,O)|Wt(x,w,O)>>4,W[te+1]=ae}function ca(x,w,O,W,te){W[te+0]=255,Qt(x,w,O,W,te+1)}function $n(x,w,O,W,te){Hr(x,w,O,W,te),W[te+3]=255}function zs(x,w,O,W,te){Qt(x,w,O,W,te),W[te+3]=255}function Ja(x,w){return 0>x?0:x>w?w:x}function di(x,w,O){k[x]=function(W,te,ae,ie,oe,ce,me,Ne,Me){for(var Re=Ne+(-2&Me)*O;Ne!=Re;)w(W[te+0],ae[ie+0],oe[ce+0],me,Ne),w(W[te+1],ae[ie+0],oe[ce+0],me,Ne+O),te+=2,++ie,++ce,Ne+=2*O;1&Me&&w(W[te+0],ae[ie+0],oe[ce+0],me,Ne)}}function b0(x,w,O){return O==0?x==0?w==0?6:5:w==0?4:0:O}function Ku(x,w,O,W,te){switch(x>>>30){case 3:Di(w,O,W,te,0);break;case 2:on(w,O,W,te);break;case 1:Ca(w,O,W,te)}}function Xu(x,w){var O,W,te=w.M,ae=w.Nb,ie=x.oc,oe=x.pc+40,ce=x.oc,me=x.pc+584,Ne=x.oc,Me=x.pc+600;for(O=0;16>O;++O)ie[oe+32*O-1]=129;for(O=0;8>O;++O)ce[me+32*O-1]=129,Ne[Me+32*O-1]=129;for(0<te?ie[oe-1-32]=ce[me-1-32]=Ne[Me-1-32]=129:(a(ie,oe-32-1,127,21),a(ce,me-32-1,127,9),a(Ne,Me-32-1,127,9)),W=0;W<x.za;++W){var Re=w.ya[w.aa+W];if(0<W){for(O=-1;16>O;++O)n(ie,oe+32*O-4,ie,oe+32*O+12,4);for(O=-1;8>O;++O)n(ce,me+32*O-4,ce,me+32*O+4,4),n(Ne,Me+32*O-4,Ne,Me+32*O+4,4)}var Te=x.Gd,Xe=x.Hd+W,He=Re.ad,je=Re.Hc;if(0<te&&(n(ie,oe-32,Te[Xe].y,0,16),n(ce,me-32,Te[Xe].f,0,8),n(Ne,Me-32,Te[Xe].ea,0,8)),Re.Za){var Ce=ie,Ye=oe-32+16;for(0<te&&(W>=x.za-1?a(Ce,Ye,Te[Xe].y[15],4):n(Ce,Ye,Te[Xe+1].y,0,4)),O=0;4>O;O++)Ce[Ye+128+O]=Ce[Ye+256+O]=Ce[Ye+384+O]=Ce[Ye+0+O];for(O=0;16>O;++O,je<<=2)Ce=ie,Ye=oe+Yw[O],$s[Re.Ob[O]](Ce,Ye),Ku(je,He,16*+O,Ce,Ye)}else if(Ce=b0(W,te,Re.Ob[0]),Co[Ce](ie,oe),je!=0)for(O=0;16>O;++O,je<<=2)Ku(je,He,16*+O,ie,oe+Yw[O]);for(O=Re.Gc,Ce=b0(W,te,Re.Dd),Ri[Ce](ce,me),Ri[Ce](Ne,Me),je=He,Ce=ce,Ye=me,255&(Re=O>>0)&&(170&Re?td(je,256,Ce,Ye):ms(je,256,Ce,Ye)),Re=Ne,je=Me,255&(O>>=8)&&(170&O?td(He,320,Re,je):ms(He,320,Re,je)),te<x.Ub-1&&(n(Te[Xe].y,0,ie,oe+480,16),n(Te[Xe].f,0,ce,me+224,8),n(Te[Xe].ea,0,Ne,Me+224,8)),O=8*ae*x.B,Te=x.sa,Xe=x.ta+16*W+16*ae*x.R,He=x.qa,Re=x.ra+8*W+O,je=x.Ha,Ce=x.Ia+8*W+O,O=0;16>O;++O)n(Te,Xe+O*x.R,ie,oe+32*O,16);for(O=0;8>O;++O)n(He,Re+O*x.B,ce,me+32*O,8),n(je,Ce+O*x.B,Ne,Me+32*O,8)}}function bc(x,w,O,W,te,ae,ie,oe,ce){var me=[0],Ne=[0],Me=0,Re=ce!=null?ce.kd:0,Te=ce??new qu;if(x==null||12>O)return 7;Te.data=x,Te.w=w,Te.ha=O,w=[w],O=[O],Te.gb=[Te.gb];e:{var Xe=w,He=O,je=Te.gb;if(t(x!=null),t(He!=null),t(je!=null),je[0]=0,12<=He[0]&&!r(x,Xe[0],"RIFF")){if(r(x,Xe[0]+8,"WEBP")){je=3;break e}var Ce=Ee(x,Xe[0]+4);if(12>Ce||4294967286<Ce){je=3;break e}if(Re&&Ce>He[0]-8){je=7;break e}je[0]=Ce,Xe[0]+=12,He[0]-=12}je=0}if(je!=0)return je;for(Ce=0<Te.gb[0],O=O[0];;){e:{var Ye=x;He=w,je=O;var Qe=me,Ke=Ne,mt=Xe=[0];if((ut=Me=[Me])[0]=0,8>je[0])je=7;else{if(!r(Ye,He[0],"VP8X")){if(Ee(Ye,He[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var ct=Ee(Ye,He[0]+8),Et=1+V(Ye,He[0]+12);if(2147483648<=Et*(Ye=1+V(Ye,He[0]+15))){je=3;break e}mt!=null&&(mt[0]=ct),Qe!=null&&(Qe[0]=Et),Ke!=null&&(Ke[0]=Ye),He[0]+=18,je[0]-=18,ut[0]=1}je=0}}if(Me=Me[0],Xe=Xe[0],je!=0)return je;if(He=!!(2&Xe),!Ce&&Me)return 3;if(ae!=null&&(ae[0]=!!(16&Xe)),ie!=null&&(ie[0]=He),oe!=null&&(oe[0]=0),ie=me[0],Xe=Ne[0],Me&&He&&ce==null){je=0;break}if(4>O){je=7;break}if(Ce&&Me||!Ce&&!Me&&!r(x,w[0],"ALPH")){O=[O],Te.na=[Te.na],Te.P=[Te.P],Te.Sa=[Te.Sa];e:{ct=x,je=w,Ce=O;var ut=Te.gb;Qe=Te.na,Ke=Te.P,mt=Te.Sa,Et=22,t(ct!=null),t(Ce!=null),Ye=je[0];var ur=Ce[0];for(t(Qe!=null),t(mt!=null),Qe[0]=null,Ke[0]=null,mt[0]=0;;){if(je[0]=Ye,Ce[0]=ur,8>ur){je=7;break e}var hr=Ee(ct,Ye+4);if(4294967286<hr){je=3;break e}var ar=8+hr+1&-2;if(Et+=ar,0<ut&&Et>ut){je=3;break e}if(!r(ct,Ye,"VP8 ")||!r(ct,Ye,"VP8L")){je=0;break e}if(ur[0]<ar){je=7;break e}r(ct,Ye,"ALPH")||(Qe[0]=ct,Ke[0]=Ye+8,mt[0]=hr),Ye+=ar,ur-=ar}}if(O=O[0],Te.na=Te.na[0],Te.P=Te.P[0],Te.Sa=Te.Sa[0],je!=0)break}O=[O],Te.Ja=[Te.Ja],Te.xa=[Te.xa];e:if(ut=x,je=w,Ce=O,Qe=Te.gb[0],Ke=Te.Ja,mt=Te.xa,ct=je[0],Ye=!r(ut,ct,"VP8 "),Et=!r(ut,ct,"VP8L"),t(ut!=null),t(Ce!=null),t(Ke!=null),t(mt!=null),8>Ce[0])je=7;else{if(Ye||Et){if(ut=Ee(ut,ct+4),12<=Qe&&ut>Qe-12){je=3;break e}if(Re&&ut>Ce[0]-8){je=7;break e}Ke[0]=ut,je[0]+=8,Ce[0]-=8,mt[0]=Et}else mt[0]=5<=Ce[0]&&ut[ct+0]==47&&!(ut[ct+4]>>5),Ke[0]=Ce[0];je=0}if(O=O[0],Te.Ja=Te.Ja[0],Te.xa=Te.xa[0],w=w[0],je!=0)break;if(4294967286<Te.Ja)return 3;if(oe==null||He||(oe[0]=Te.xa?2:1),ie=[ie],Xe=[Xe],Te.xa){if(5>O){je=7;break}oe=ie,Re=Xe,He=ae,x==null||5>O?x=0:5<=O&&x[w+0]==47&&!(x[w+4]>>5)?(Ce=[0],ut=[0],Qe=[0],Y(Ke=new A,x,w,O),xt(Ke,Ce,ut,Qe)?(oe!=null&&(oe[0]=Ce[0]),Re!=null&&(Re[0]=ut[0]),He!=null&&(He[0]=Qe[0]),x=1):x=0):x=0}else{if(10>O){je=7;break}oe=Xe,x==null||10>O||!a0(x,w+3,O-3)?x=0:(Re=x[w+0]|x[w+1]<<8|x[w+2]<<16,He=16383&(x[w+7]<<8|x[w+6]),x=16383&(x[w+9]<<8|x[w+8]),1&Re||3<(Re>>1&7)||!(Re>>4&1)||Re>>5>=Te.Ja||!He||!x?x=0:(ie&&(ie[0]=He),oe&&(oe[0]=x),x=1))}if(!x||(ie=ie[0],Xe=Xe[0],Me&&(me[0]!=ie||Ne[0]!=Xe)))return 3;ce!=null&&(ce[0]=Te,ce.offset=w-ce.w,t(4294967286>w-ce.w),t(ce.offset==ce.ha-O));break}return je==0||je==7&&Me&&ce==null?(ae!=null&&(ae[0]|=Te.na!=null&&0<Te.na.length),W!=null&&(W[0]=ie),te!=null&&(te[0]=Xe),0):je}function Ju(x,w,O){var W=w.width,te=w.height,ae=0,ie=0,oe=W,ce=te;if(w.Da=x!=null&&0<x.Da,w.Da&&(oe=x.cd,ce=x.bd,ae=x.v,ie=x.j,11>O||(ae&=-2,ie&=-2),0>ae||0>ie||0>=oe||0>=ce||ae+oe>W||ie+ce>te))return 0;if(w.v=ae,w.j=ie,w.va=ae+oe,w.o=ie+ce,w.U=oe,w.T=ce,w.da=x!=null&&0<x.da,w.da){if(!Se(oe,ce,O=[x.ib],ae=[x.hb]))return 0;w.ib=O[0],w.hb=ae[0]}return w.ob=x!=null&&x.ob,w.Kb=x==null||!x.Sd,w.da&&(w.ob=w.ib<3*W/4&&w.hb<3*te/4,w.Kb=0),1}function Zu(x){if(x==null)return 2;if(11>x.S){var w=x.f.RGBA;w.fb+=(x.height-1)*w.A,w.A=-w.A}else w=x.f.kb,x=x.height,w.O+=(x-1)*w.fa,w.fa=-w.fa,w.N+=(x-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(x-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(x-1)*w.lb,w.lb=-w.lb);return 0}function wc(x,w,O,W){if(W==null||0>=x||0>=w)return 2;if(O!=null){if(O.Da){var te=O.cd,ae=O.bd,ie=-2&O.v,oe=-2&O.j;if(0>ie||0>oe||0>=te||0>=ae||ie+te>x||oe+ae>w)return 2;x=te,w=ae}if(O.da){if(!Se(x,w,te=[O.ib],ae=[O.hb]))return 2;x=te[0],w=ae[0]}}W.width=x,W.height=w;e:{var ce=W.width,me=W.height;if(x=W.S,0>=ce||0>=me||!(x>=k0&&13>x))x=2;else{if(0>=W.Rd&&W.sd==null){ie=ae=te=w=0;var Ne=(oe=ce*Kw[x])*me;if(11>x||(ae=(me+1)/2*(w=(ce+1)/2),x==12&&(ie=(te=ce)*me)),(me=s(Ne+2*ae+ie))==null){x=1;break e}W.sd=me,11>x?((ce=W.f.RGBA).eb=me,ce.fb=0,ce.A=oe,ce.size=Ne):((ce=W.f.kb).y=me,ce.O=0,ce.fa=oe,ce.Fd=Ne,ce.f=me,ce.N=0+Ne,ce.Ab=w,ce.Cd=ae,ce.ea=me,ce.W=0+Ne+ae,ce.Db=w,ce.Ed=ae,x==12&&(ce.F=me,ce.J=0+Ne+2*ae),ce.Tc=ie,ce.lb=te)}if(w=1,te=W.S,ae=W.width,ie=W.height,te>=k0&&13>te)if(11>te)x=W.f.RGBA,w&=(oe=Math.abs(x.A))*(ie-1)+ae<=x.size,w&=oe>=ae*Kw[te],w&=x.eb!=null;else{x=W.f.kb,oe=(ae+1)/2,Ne=(ie+1)/2,ce=Math.abs(x.fa),me=Math.abs(x.Ab);var Me=Math.abs(x.Db),Re=Math.abs(x.lb),Te=Re*(ie-1)+ae;w&=ce*(ie-1)+ae<=x.Fd,w&=me*(Ne-1)+oe<=x.Cd,w=(w&=Me*(Ne-1)+oe<=x.Ed)&ce>=ae&me>=oe&Me>=oe,w&=x.y!=null,w&=x.f!=null,w&=x.ea!=null,te==12&&(w&=Re>=ae,w&=Te<=x.Tc,w&=x.F!=null)}else w=0;x=w?0:2}}return x!=0||O!=null&&O.fd&&(x=Zu(W)),x}var ta=64,Sc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],_c=24,Nc=32,Qu=8,Ba=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ae("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(x){return x},k.Predictor2=function(x,w,O){return w[O+0]},k.Predictor3=function(x,w,O){return w[O+1]},k.Predictor4=function(x,w,O){return w[O-1]},k.Predictor5=function(x,w,O){return Pe(Pe(x,w[O+1]),w[O+0])},k.Predictor6=function(x,w,O){return Pe(x,w[O-1])},k.Predictor7=function(x,w,O){return Pe(x,w[O+0])},k.Predictor8=function(x,w,O){return Pe(w[O-1],w[O+0])},k.Predictor9=function(x,w,O){return Pe(w[O+0],w[O+1])},k.Predictor10=function(x,w,O){return Pe(Pe(x,w[O-1]),Pe(w[O+0],w[O+1]))},k.Predictor11=function(x,w,O){var W=w[O+0];return 0>=et(W>>24&255,x>>24&255,(w=w[O-1])>>24&255)+et(W>>16&255,x>>16&255,w>>16&255)+et(W>>8&255,x>>8&255,w>>8&255)+et(255&W,255&x,255&w)?W:x},k.Predictor12=function(x,w,O){var W=w[O+0];return(Oe((x>>24&255)+(W>>24&255)-((w=w[O-1])>>24&255))<<24|Oe((x>>16&255)+(W>>16&255)-(w>>16&255))<<16|Oe((x>>8&255)+(W>>8&255)-(w>>8&255))<<8|Oe((255&x)+(255&W)-(255&w)))>>>0},k.Predictor13=function(x,w,O){var W=w[O-1];return(Ve((x=Pe(x,w[O+0]))>>24&255,W>>24&255)<<24|Ve(x>>16&255,W>>16&255)<<16|Ve(x>>8&255,W>>8&255)<<8|Ve(x>>0&255,W>>0&255))>>>0};var _g=k.PredictorAdd0;k.PredictorAdd1=_t,Ae("Predictor2","PredictorAdd2"),Ae("Predictor3","PredictorAdd3"),Ae("Predictor4","PredictorAdd4"),Ae("Predictor5","PredictorAdd5"),Ae("Predictor6","PredictorAdd6"),Ae("Predictor7","PredictorAdd7"),Ae("Predictor8","PredictorAdd8"),Ae("Predictor9","PredictorAdd9"),Ae("Predictor10","PredictorAdd10"),Ae("Predictor11","PredictorAdd11"),Ae("Predictor12","PredictorAdd12"),Ae("Predictor13","PredictorAdd13");var ed=k.PredictorAdd2;lt("ColorIndexInverseTransform","MapARGB","32b",(function(x){return x>>8&255}),(function(x){return x})),lt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(x){return x}),(function(x){return x>>8&255}));var w0,hs=k.ColorIndexInverseTransform,Ac=k.MapARGB,S0=k.VP8LColorIndexInverseTransformAlpha,_0=k.MapAlpha,No=k.VP8LPredictorsAdd=[];No.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var hl,Ua,ka,Ao,Ii,Li,jc,Di,on,td,Ca,ms,kc,N0,rd,ml,pl,jo,gl,Cc,xl,ko,nd,ps,gs,Cr,Er,ln,Tn=s(511),Mi=s(2041),ad=s(225),Ec=s(767),A0=0,Ng=Mi,j0=ad,Za=Ec,xs=Tn,k0=0,C0=1,Rw=2,E0=3,T0=4,Ag=5,Bw=6,jg=7,kg=8,P0=9,Cg=10,lO=[2,3,7],cO=[3,3,11],Uw=[280,256,256,256,40],uO=[0,1,1,1,0],dO=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],fO=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],hO=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],mO=8,Eg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Tg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],sd=null,pO=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],gO=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],zw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xO=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],vO=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],yO=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],bO=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Co=[],$s=[],Ri=[],wO=1,$w=2,Eo=[],vs=[];qe("UpsampleRgbLinePair",Qt,3),qe("UpsampleBgrLinePair",Hr,3),qe("UpsampleRgbaLinePair",zs,4),qe("UpsampleBgraLinePair",$n,4),qe("UpsampleArgbLinePair",ca,4),qe("UpsampleRgba4444LinePair",xn,2),qe("UpsampleRgb565LinePair",Xr,2);var SO=k.UpsampleRgbLinePair,_O=k.UpsampleBgrLinePair,Ww=k.UpsampleRgbaLinePair,Hw=k.UpsampleBgraLinePair,qw=k.UpsampleArgbLinePair,Gw=k.UpsampleRgba4444LinePair,NO=k.UpsampleRgb565LinePair,O0=16,F0=1<<O0-1,id=-227,Pg=482,AO=6,Vw=0,jO=s(256),kO=s(256),CO=s(256),EO=s(256),TO=s(Pg-id),PO=s(Pg-id);di("YuvToRgbRow",Qt,3),di("YuvToBgrRow",Hr,3),di("YuvToRgbaRow",zs,4),di("YuvToBgraRow",$n,4),di("YuvToArgbRow",ca,4),di("YuvToRgba4444Row",xn,2),di("YuvToRgb565Row",Xr,2);var Yw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],I0=[0,2,8],OO=[8,7,6,4,4,2,2,2,1,1,1,1],FO=1;this.WebPDecodeRGBA=function(x,w,O,W,te){var ae=C0,ie=new vc,oe=new tr;ie.ba=oe,oe.S=ae,oe.width=[oe.width],oe.height=[oe.height];var ce=oe.width,me=oe.height,Ne=new fr;if(Ne==null||x==null)var Me=2;else t(Ne!=null),Me=bc(x,w,O,Ne.width,Ne.height,Ne.Pd,Ne.Qd,Ne.format,null);if(Me!=0?ce=0:(ce!=null&&(ce[0]=Ne.width[0]),me!=null&&(me[0]=Ne.height[0]),ce=1),ce){oe.width=oe.width[0],oe.height=oe.height[0],W!=null&&(W[0]=oe.width),te!=null&&(te[0]=oe.height);e:{if(W=new li,(te=new qu).data=x,te.w=w,te.ha=O,te.kd=1,w=[0],t(te!=null),((x=bc(te.data,te.w,te.ha,null,null,null,w,null,te))==0||x==7)&&w[0]&&(x=4),(w=x)==0){if(t(ie!=null),W.data=te.data,W.w=te.w+te.offset,W.ha=te.ha-te.offset,W.put=Cn,W.ac=nr,W.bc=Ma,W.ma=ie,te.xa){if((x=We())==null){ie=1;break e}if((function(Re,Te){var Xe=[0],He=[0],je=[0];t:for(;;){if(Re==null)return 0;if(Te==null)return Re.a=2,0;if(Re.l=Te,Re.a=0,Y(Re.m,Te.data,Te.w,Te.ha),!xt(Re.m,Xe,He,je)){Re.a=3;break t}if(Re.xb=$w,Te.width=Xe[0],Te.height=He[0],!Ie(Xe[0],He[0],1,Re,null))break t;return 1}return t(Re.a!=0),0})(x,W)){if(W=(w=wc(W.width,W.height,ie.Oa,ie.ba))==0){t:{W=x;r:for(;;){if(W==null){W=0;break t}if(t(W.s.yc!=null),t(W.s.Ya!=null),t(0<W.s.Wb),t((O=W.l)!=null),t((te=O.ma)!=null),W.xb!=0){if(W.ca=te.ba,W.tb=te.tb,t(W.ca!=null),!Ju(te.Oa,O,E0)){W.a=2;break r}if(!Be(W,O.width)||O.da)break r;if((O.da||gt(W.ca.S))&&Fe(),11>W.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),W.ca.f.kb.F!=null&&Fe()),W.Pb&&0<W.s.ua&&W.s.vb.X==null&&!we(W.s.vb,W.s.Wa.Xa)){W.a=1;break r}W.xb=0}if(!ye(W,W.V,W.Ba,W.c,W.i,O.o,ve))break r;te.Dc=W.Ma,W=1;break t}t(W.a!=0),W=0}W=!W}W&&(w=x.a)}else w=x.a}else{if((x=new Xa)==null){ie=1;break e}if(x.Fa=te.na,x.P=te.P,x.qc=te.Sa,s0(x,W)){if((w=wc(W.width,W.height,ie.Oa,ie.ba))==0){if(x.Aa=0,O=ie.Oa,t((te=x)!=null),O!=null){if(0<(ce=0>(ce=O.Md)?0:100<ce?255:255*ce/100)){for(me=Ne=0;4>me;++me)12>(Me=te.pb[me]).lc&&(Me.ia=ce*OO[0>Me.lc?0:Me.lc]>>3),Ne|=Me.ia;Ne&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=O.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}sg(x,W)||(w=x.a)}}else w=x.a}w==0&&ie.Oa!=null&&ie.Oa.fd&&(w=Zu(ie.ba))}ie=w}ae=ie!=0?null:11>ae?oe.f.RGBA.eb:oe.f.kb.y}else ae=null;return ae};var Kw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(k,T){for(var q="",F=0;F<4;F++)q+=String.fromCharCode(k[T++]);return q}function d(k,T){return(k[T+0]<<0|k[T+1]<<8|k[T+2]<<16)>>>0}function f(k,T){return(k[T+0]<<0|k[T+1]<<8|k[T+2]<<16|k[T+3]<<24)>>>0}new c;var m=[0],h=[0],p=[],g=new c,v=e,b=(function(k,T){var q={},F=0,j=!1,U=0,B=0;if(q.frames=[],!(function(D,L,M,R){for(var H=0;H<R;H++)if(D[L+H]!=M.charCodeAt(H))return!0;return!1})(k,T,"RIFF",4)){var X,K;for(f(k,T+=4),T+=8;T<k.length;){var ee=u(k,T),Y=f(k,T+=4);T+=4;var z=Y+(1&Y);switch(ee){case"VP8 ":case"VP8L":q.frames[F]===void 0&&(q.frames[F]={}),(A=q.frames[F]).src_off=j?B:T-8,A.src_size=U+Y+8,F++,j&&(j=!1,U=0,B=0);break;case"VP8X":(A=q.header={}).feature_flags=k[T];var ne=T+4;A.canvas_width=1+d(k,ne),ne+=3,A.canvas_height=1+d(k,ne),ne+=3;break;case"ALPH":j=!0,U=z+8,B=T-8;break;case"ANIM":(A=q.header).bgcolor=f(k,T),ne=T+4,A.loop_count=(X=k)[(K=ne)+0]<<0|X[K+1]<<8,ne+=2;break;case"ANMF":var le,A;(A=q.frames[F]={}).offset_x=2*d(k,T),T+=3,A.offset_y=2*d(k,T),T+=3,A.width=1+d(k,T),T+=3,A.height=1+d(k,T),T+=3,A.duration=d(k,T),T+=3,le=k[T++],A.dispose=1&le,A.blend=le>>1&1}ee!="ANMF"&&(T+=z)}return q}})(v,0);b.response=v,b.rgbaoutput=!0,b.dataurl=!1;var S=b.header?b.header:null,_=b.frames?b.frames:null;if(S){S.loop_counter=S.loop_count,m=[S.canvas_height],h=[S.canvas_width];for(var E=0;E<_.length&&_[E].blend!=0;E++);}var P=_[0],N=g.WebPDecodeRGBA(v,P.src_off,P.src_size,h,m);P.rgba=N,P.imgwidth=h[0],P.imgheight=m[0];for(var I=0;I<h[0]*m[0]*4;I++)p[I]=N[I];return this.width=h,this.height=m,this.data=p,this}(function(e){var t=function(){return typeof Py=="function"},r=function(m,h,p,g){var v=4,b=i;switch(g){case e.image_compression.FAST:v=1,b=s;break;case e.image_compression.MEDIUM:v=6,b=o;break;case e.image_compression.SLOW:v=9,b=c}m=n(m,h,p,b);var S=Py(m,{level:v});return e.__addimage__.arrayBufferToBinaryString(S)},n=function(m,h,p,g){for(var v,b,S,_=m.length/h,E=new Uint8Array(m.length+_),P=d(),N=0;N<_;N+=1){if(S=N*h,v=m.subarray(S,S+h),g)E.set(g(v,p,b),S+N);else{for(var I,k=P.length,T=[];I<k;I+=1)T[I]=P[I](v,p,b);var q=f(T.concat());E.set(T[q],S+N)}b=v}return E},a=function(m){var h=Array.apply([],m);return h.unshift(0),h},s=function(m,h){var p,g=[],v=m.length;g[0]=1;for(var b=0;b<v;b+=1)p=m[b-h]||0,g[b+1]=m[b]-p+256&255;return g},i=function(m,h,p){var g,v=[],b=m.length;v[0]=2;for(var S=0;S<b;S+=1)g=p&&p[S]||0,v[S+1]=m[S]-g+256&255;return v},o=function(m,h,p){var g,v,b=[],S=m.length;b[0]=3;for(var _=0;_<S;_+=1)g=m[_-h]||0,v=p&&p[_]||0,b[_+1]=m[_]+256-(g+v>>>1)&255;return b},c=function(m,h,p){var g,v,b,S,_=[],E=m.length;_[0]=4;for(var P=0;P<E;P+=1)g=m[P-h]||0,v=p&&p[P]||0,b=p&&p[P-h]||0,S=u(g,v,b),_[P+1]=m[P]-S+256&255;return _},u=function(m,h,p){if(m===h&&h===p)return m;var g=Math.abs(h-p),v=Math.abs(m-p),b=Math.abs(m+h-p-p);return g<=v&&g<=b?m:v<=b?h:p},d=function(){return[a,s,i,o,c]},f=function(m){var h=m.map((function(p){return p.reduce((function(g,v){return g+Math.abs(v)}),0)}));return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(m,h,p,g){var v,b,S,_,E,P,N,I,k,T,q,F,j,U,B,X=this.decode.FLATE_DECODE,K="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(S=new Aue(m)).imgData,b=S.bits,v=S.colorSpace,E=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){k=(I=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,q=new Uint8Array(k*S.colors),T=new Uint8Array(k);var ee,Y=S.pixelBitlength-S.bits;for(U=0,B=0;U<k;U++){for(j=I[U],ee=0;ee<Y;)q[B++]=j>>>ee&255,ee+=S.bits;T[U]=j>>>ee&255}}if(S.bits===16){k=(I=new Uint32Array(S.decodePixels().buffer)).length,q=new Uint8Array(k*(32/S.pixelBitlength)*S.colors),T=new Uint8Array(k*(32/S.pixelBitlength)),F=S.colors>1,U=0,B=0;for(var z=0;U<k;)j=I[U++],q[B++]=j>>>0&255,F&&(q[B++]=j>>>16&255,j=I[U++],q[B++]=j>>>0&255),T[z++]=j>>>16&255;b=8}g!==e.image_compression.NONE&&t()?(m=r(q,S.width*S.colors,S.colors,g),N=r(T,S.width,1,g)):(m=q,N=T,X=void 0)}if(S.colorType===3&&(v=this.color_spaces.INDEXED,P=S.palette,S.transparency.indexed)){var ne=S.transparency.indexed,le=0;for(U=0,k=ne.length;U<k;++U)le+=ne[U];if((le/=255)===k-1&&ne.indexOf(0)!==-1)_=[ne.indexOf(0)];else if(le!==k){for(I=S.decodePixels(),T=new Uint8Array(I.length),U=0,k=I.length;U<k;U++)T[U]=ne[I[U]];N=r(T,S.width,1)}}var A=(function(D){var L;switch(D){case e.image_compression.FAST:L=11;break;case e.image_compression.MEDIUM:L=13;break;case e.image_compression.SLOW:L=14;break;default:L=12}return L})(g);return X===this.decode.FLATE_DECODE&&(K="/Predictor "+A+" "),K+="/Colors "+E+" /BitsPerComponent "+b+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(N&&this.__addimage__.isArrayBuffer(N)||this.__addimage__.isArrayBufferView(N))&&(N=this.__addimage__.arrayBufferToBinaryString(N)),{alias:p,data:m,index:h,filter:X,decodeParameters:K,transparency:_,palette:P,sMask:N,predictor:A,width:S.width,height:S.height,bitsPerComponent:b,colorSpace:v}}}})(Ft.API),(function(e){e.processGIF89A=function(t,r,n,a){var s=new jue(t),i=s.width,o=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:i,height:o},d=new Z1(100).encode(u,100);return e.processJPEG.call(this,d,r,n,a)},e.processGIF87A=e.processGIF89A})(Ft.API),Gs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Gs.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){jr.log("bit decode error:"+r)}},Gs.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[s>>7-o&1];this.data[i+4*o]=c.blue,this.data[i+4*o+1]=c.green,this.data[i+4*o+2]=c.red,this.data[i+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Gs.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*a*4,o=s>>4,c=15&s,u=this.palette[o];if(this.data[i]=u.blue,this.data[i+1]=u.green,this.data[i+2]=u.red,this.data[i+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[i+4]=u.blue,this.data[i+4+1]=u.green,this.data[i+4+2]=u.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},Gs.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var i=this.palette[a];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Gs.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=u}this.pos+=e}},Gs.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,c=(i>>5&r)/r*255|0,u=(i>>11)/t*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},Gs.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=s,this.data[i+1]=a,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},Gs.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=i}},Gs.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,r,n,a){var s=new Gs(t,!1),i=s.width,o=s.height,c={data:s.getData(),width:i,height:o},u=new Z1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}})(Ft.API),XA.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,r,n,a){var s=new XA(t),i=s.width,o=s.height,c={data:s.getData(),width:i,height:o},u=new Z1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}})(Ft.API),Ft.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),i=new Uint8Array(a/4),o=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],m=n[u+2],h=n[u+3];s[o++]=d,s[o++]=f,s[o++]=m,i[c++]=h}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:p,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ft.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},$c=Ft.API,jh=$c.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,m=0,h=e.length,p=0,g=o[0]||c,v=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?v.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+i*(1e3/s)||0)/1e3):(m=f&&yr(u[n])==="object"&&!isNaN(parseInt(u[n][p],10))?u[n][p]/d:0,v.push((o[n]||g)/c+m)),p=n;return v},GA=$c.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return $c.processArabic&&(e=$c.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:jh.apply(this,arguments).reduce((function(s,i){return s+i}),0)},VA=function(e,t,r,n){for(var a=[],s=0,i=e.length,o=0;s!==i&&o+t[s]<r;)o+=t[s],s++;a.push(e.slice(0,s));var c=s;for(o=0;s!==i;)o+t[s]>n&&(a.push(e.slice(c,s)),o=0,c=s),o+=t[s],s++;return c!==s&&a.push(e.slice(c,s)),a},YA=function(e,t,r){r||(r={});var n,a,s,i,o,c,u,d=[],f=[d],m=r.textIndent||0,h=0,p=0,g=e.split(" "),v=jh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),S=[];g.map((function(E){(E=E.split(/\s*\n/)).length>1?S=S.concat(E.map((function(P,N){return(N&&P.length?`
`:"")+P}))):S.push(E[0])})),g=S,c=GA.apply(this,[b,r])}for(s=0,i=g.length;s<i;s++){var _=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),_=1),m+h+(p=(a=jh.apply(this,[n,r])).reduce((function(E,P){return E+P}),0))>t||_){if(p>t){for(o=VA.apply(this,[n,a,t-(m+h),t]),d.push(o.shift()),d=[o.pop()];o.length;)f.push([o.shift()]);p=a.slice(n.length-(d[0]?d[0].length:0)).reduce((function(E,P){return E+P}),0)}else d=[n];f.push(d),m=p+c,h=v}else d.push(n),m+=h+p,h=v}return u=c?function(E,P){return(P?b:"")+E.join(" ")}:function(E){return E.join(" ")},f.map(u)},$c.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var o,c,u=[];for(o=0,c=n.length;o<c;o++)u=u.concat(YA.apply(this,[n[o],i,s]));return u},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var s=function(f){return"0x"+parseInt(f,10).toString(16)},i=e.__fontmetrics__.compress=function(f){var m,h,p,g,v=["{"];for(var b in f){if(m=f[b],isNaN(parseInt(b,10))?h="'"+b+"'":(b=parseInt(b,10),h=(h=s(b).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof m=="number")m<0?(p=s(m).slice(3),g="-"):(p=s(m).slice(2),g=""),p=g+p.slice(0,-1)+n[p.slice(-1)];else{if(yr(m)!=="object")throw new Error("Don't know what to do with value type "+yr(m)+".");p=i(m)}v.push(h+p)}return v.push("}"),v.join("")},o=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,h,p,g,v={},b=1,S=v,_=[],E="",P="",N=f.length-1,I=1;I<N;I+=1)(g=f[I])=="'"?m?(p=m.join(""),m=void 0):m=[]:m?m.push(g):g=="{"?(_.push([S,p]),S={},p=void 0):g=="}"?((h=_.pop())[0][h[1]]=S,p=void 0,S=h[0]):g=="-"?b=-1:p===void 0?r.hasOwnProperty(g)?(E+=r[g],p=parseInt(E,16)*b,b=1,E=""):E+=g:r.hasOwnProperty(g)?(P+=r[g],S[p]=parseInt(P,16)*b,b=1,p=void 0,P=""):P+=g;return v},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var m=f.font,h=d.Unicode[m.postScriptName];h&&(m.metadata.Unicode={},m.metadata.Unicode.widths=h.widths,m.metadata.Unicode.kerning=h.kerning);var p=u.Unicode[m.postScriptName];p&&(m.metadata.Unicode.encoding=p,m.encoding=p.codePages[0])}])})(Ft.API),(function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Bd(o)),i.metadata=e.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(a,n)}}])})(Ft),(function(e){function t(){return(Dt.canvg?Promise.resolve(Dt.canvg):jy(()=>import("./index.es-DLGXPHiv.js"),__vite__mapDeps([0,1,2]))).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}Ft.API.addSvgAsImage=function(r,n,a,s,i,o,c,u){if(isNaN(n)||isNaN(a))throw jr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(i))throw jr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=s,d.height=i;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then((function(p){return p.fromString(f,r,m)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(p){return p.render(m)})).then((function(){h.addImage(d.toDataURL("image/jpeg",1),n,a,s,i,c,u)}))}})(),Ft.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Ft.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),c=[],u=0,d=0,f=0;function m(p,g){var v,b=!1;for(v=0;v<p.length;v+=1)p[v]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(yr(e)==="object"){for(a in e)if(s=e[a],m(o,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&m(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var p,g=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?g.push("/"+p+" /"+r[p].value):g.push("/"+p+" "+r[p].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+i.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+i+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}})(Ft.API),(function(e){var t=e.API,r=t.pdfEscape16=function(s,i){for(var o,c=i.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,m=s.length;f<m;++f){if(o=i.metadata.characterToGlyph(s.charCodeAt(f)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=s.charCodeAt(f),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(u[4-o.length],o)}return d.join("")},n=function(s){var i,o,c,u,d,f,m;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(o=Object.keys(s).sort((function(h,p){return h-p}))).length;f<m;f++)i=o[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[i]!==void 0&&s[i]!==null&&typeof s[i].toString=="function"&&(u=("0000"+s[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(i){var o=i.font,c=i.out,u=i.newObject,d=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",p=0;p<m.length;p++)h+=String.fromCharCode(m[p]);var g=u();d({data:h,addLength1:!0,objectId:g}),c("endobj");var v=u();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Gc(o.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var S=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Gc(o.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+v+" 0 R"),c("/BaseFont /"+Gc(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+S+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(i){var o=i.font,c=i.out,u=i.newObject,d=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var p=u();d({data:m,addLength1:!0,objectId:p}),c("endobj");var g=u();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var v=u();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+p+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Gc(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=u();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Gc(o.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(s)}]);var a=function(s){var i,o=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},m=f.pdfEscape,h=f.activeFontKey,p=f.fonts,g=h,v="",b=0,S="",_=p[g].encoding;if(p[g].encoding!=="Identity-H")return{text:o,x:c,y:u,options:d,mutex:f};for(S=o,g=h,Array.isArray(o)&&(S=o[0]),b=0;b<S.length;b+=1)p[g].metadata.hasOwnProperty("cmap")&&(i=p[g].metadata.cmap.unicode.codeMap[S[b].charCodeAt(0)]),i||S[b].charCodeAt(0)<256&&p[g].metadata.hasOwnProperty("Unicode")?v+=S[b]:v+="";var E="";return parseInt(g.slice(1))<14||_==="WinAnsiEncoding"?E=m(v,g).split("").map((function(P){return P.charCodeAt(0).toString(16)})).join(""):_==="Identity-H"&&(E=r(v,p[g])),f.isHex=!0,{text:E,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var i=s.text||"",o=[],c={text:i,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(i)){var u=0;for(u=0;u<i.length;u+=1)Array.isArray(i[u])&&i[u].length===3?o.push([a(Object.assign({},c,{text:i[u][0]})).text,i[u][1],i[u][2]]):o.push(a(Object.assign({},c,{text:i[u]})).text);s.text=o}else s.text=a(Object.assign({},c,{text:i})).text}])})(Ft),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(Ft.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,s,i,o,c,u,d,f=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,_=0;this.__bidiEngine__={};var E=function(F){var j=F.charCodeAt(),U=j>>8,B=g[U];return B!==void 0?f[256*B+(255&j)]:U===252||U===253?"AL":b.test(U)?"L":U===8?"R":"N"},P=function(F){for(var j,U=0;U<F.length;U++){if((j=E(F.charAt(U)))==="L")return!1;if(j==="R")return!0}return!1},N=function(F,j,U,B){var X,K,ee,Y,z=j[B];switch(z){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(z="AN");break;case"AL":S=!0,z="R";break;case"WS":z="N";break;case"CS":B<1||B+1>=j.length||(X=U[B-1])!=="EN"&&X!=="AN"||(K=j[B+1])!=="EN"&&K!=="AN"?z="N":S&&(K="AN"),z=K===X?K:"N";break;case"ES":z=(X=B>0?U[B-1]:"B")==="EN"&&B+1<j.length&&j[B+1]==="EN"?"EN":"N";break;case"ET":if(B>0&&U[B-1]==="EN"){z="EN";break}if(S){z="N";break}for(ee=B+1,Y=j.length;ee<Y&&j[ee]==="ET";)ee++;z=ee<Y&&j[ee]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(Y=j.length,ee=B+1;ee<Y&&j[ee]==="NSM";)ee++;if(ee<Y){var ne=F[B],le=ne>=1425&&ne<=2303||ne===64286;if(X=j[ee],le&&(X==="R"||X==="AL")){z="R";break}}}z=B<1||(X=j[B-1])==="B"?"N":U[B-1];break;case"B":S=!1,a=!0,z=_;break;case"S":s=!0,z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":z="N"}return z},I=function(F,j,U){var B=F.split("");return U&&k(B,U,{hiLevel:_}),B.reverse(),j&&j.reverse(),B.join("")},k=function(F,j,U){var B,X,K,ee,Y,z=-1,ne=F.length,le=0,A=[],D=_?h:m,L=[];for(S=!1,a=!1,s=!1,X=0;X<ne;X++)L[X]=E(F[X]);for(K=0;K<ne;K++){if(Y=le,A[K]=N(F,L,A,K),B=240&(le=D[Y][p[A[K]]]),le&=15,j[K]=ee=D[le][5],B>0)if(B===16){for(X=z;X<K;X++)j[X]=1;z=-1}else z=-1;if(D[le][6])z===-1&&(z=K);else if(z>-1){for(X=z;X<K;X++)j[X]=ee;z=-1}L[K]==="B"&&(j[K]=0),U.hiLevel|=ee}s&&(function(M,R,H){for(var J=0;J<H;J++)if(M[J]==="S"){R[J]=_;for(var G=J-1;G>=0&&M[G]==="WS";G--)R[G]=_}})(L,j,ne)},T=function(F,j,U,B,X){if(!(X.hiLevel<F)){if(F===1&&_===1&&!a)return j.reverse(),void(U&&U.reverse());for(var K,ee,Y,z,ne=j.length,le=0;le<ne;){if(B[le]>=F){for(Y=le+1;Y<ne&&B[Y]>=F;)Y++;for(z=le,ee=Y-1;z<ee;z++,ee--)K=j[z],j[z]=j[ee],j[ee]=K,U&&(K=U[z],U[z]=U[ee],U[ee]=K);le=Y}le++}}},q=function(F,j,U){var B=F.split(""),X={hiLevel:_};return U||(U=[]),k(B,U,X),(function(K,ee,Y){if(Y.hiLevel!==0&&d)for(var z,ne=0;ne<K.length;ne++)ee[ne]===1&&(z=v.indexOf(K[ne]))>=0&&(K[ne]=v[z+1])})(B,U,X),T(2,B,j,U,X),T(1,B,j,U,X),B.join("")};return this.__bidiEngine__.doBidiReorder=function(F,j,U){if((function(X,K){if(K)for(var ee=0;ee<X.length;ee++)K[ee]=ee;o===void 0&&(o=P(X)),u===void 0&&(u=P(X))})(F,j),i||!c||u)if(i&&c&&o^u)_=o?1:0,F=I(F,j,U);else if(!i&&c&&u)_=o?1:0,F=q(F,j,U),F=I(F,j);else if(!i||o||c||u){if(i&&!c&&o^u)F=I(F,j),o?(_=0,F=q(F,j,U)):(_=1,F=q(F,j,U),F=I(F,j));else if(i&&o&&!c&&u)_=1,F=q(F,j,U),F=I(F,j);else if(!i&&!c&&o^u){var B=d;o?(_=1,F=q(F,j,U),_=0,d=!1,F=q(F,j,U),d=B):(_=0,F=q(F,j,U),F=I(F,j),_=1,d=!1,F=q(F,j,U),d=B,F=I(F,j))}}else _=0,F=q(F,j,U);else _=o?1:0,F=q(F,j,U);return F},this.__bidiEngine__.setOptions=function(F){F&&(i=F.isInputVisual,c=F.isOutputVisual,o=F.isInputRtl,u=F.isOutputRtl,d=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,s=(n.x,n.y,n.options||{}),i=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(i=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?i.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):i.push([r.doBidiReorder(a[o])]);n.text=i}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])})(Ft),Ft.API.TTFFont=(function(){function e(t){var r;if(this.rawData=t,r=this.contents=new rl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new zue(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new kue(this.contents),this.head=new Eue(this),this.name=new Iue(this),this.cmap=new H8(this),this.toUnicode={},this.hhea=new Tue(this),this.maxp=new Lue(this),this.hmtx=new Due(this),this.post=new Oue(this),this.os2=new Pue(this),this.loca=new Uue(this),this.glyf=new Mue(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,c,u;for(u=[],i=0,o=(c=this.bbox).length;i<o;i++)t=c[i],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),(32768&(r=a>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,s,i,o;for(i=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)a=t.charCodeAt(s),i+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e})();var ii,rl=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,s,i,o,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^i)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*i+256*o+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,s;for(s=[],n=0,a=t.length;n<a;n++)r=t[n],s.push(this.writeByte(r));return s},e})(),kue=(function(){var e;function t(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,s,i,o,c,u,d,f,m,h,p,g;for(g in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),i=Math.floor(f/c),d=16*h-f,(a=new rl).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(i),a.writeShort(d),s=16*h,u=a.pos+s,o=null,p=[],r)for(m=r[g],a.writeString(g),a.writeInt(e(m)),a.writeInt(u),a.writeInt(m.length),p=p.concat(m),g==="head"&&(o=u),u+=m.length;u%4;)p.push(0),u++;return a.write(p),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,s,i;for(r=q8.call(r);r.length%4;)r.push(0);for(s=new rl(r),a=0,n=0,i=r.length;n<i;n=n+=4)a+=s.readUInt32();return 4294967295&a},t})(),Cue={}.hasOwnProperty,Ti=function(e,t){for(var r in t)Cue.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ii=(function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var Eue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new rl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t})(),JA=(function(){function e(t,r){var n,a,s,i,o,c,u,d,f,m,h,p,g,v,b,S,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,s=(function(){var E,P;for(P=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)P.push(t.readUInt16());return P})(),t.pos+=2,g=(function(){var E,P;for(P=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)P.push(t.readUInt16());return P})(),u=(function(){var E,P;for(P=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)P.push(t.readUInt16());return P})(),d=(function(){var E,P;for(P=[],c=E=0;0<=m?E<m:E>m;c=0<=m?++E:--E)P.push(t.readUInt16());return P})(),a=(this.length-t.pos+this.offset)/2,o=(function(){var E,P;for(P=[],c=E=0;0<=a?E<a:E>a;c=0<=a?++E:--E)P.push(t.readUInt16());return P})(),c=b=0,_=s.length;b<_;c=++b)for(v=s[c],n=S=p=g[c];p<=v?S<=v:S>=v;n=p<=v?++S:--S)d[c]===0?i=n+u[c]:(i=o[d[c]/2+(n-p)-(m-c)]||0)!==0&&(i+=u[c]),this.codeMap[n]=65535&i}t.pos=f}return e.encode=function(t,r){var n,a,s,i,o,c,u,d,f,m,h,p,g,v,b,S,_,E,P,N,I,k,T,q,F,j,U,B,X,K,ee,Y,z,ne,le,A,D,L,M,R,H,J,G,Q,de,V;switch(B=new rl,i=Object.keys(t).sort((function(Ee,we){return Ee-we})),r){case"macroman":for(g=0,v=(function(){var Ee=[];for(p=0;p<256;++p)Ee.push(0);return Ee})(),S={0:0},s={},X=0,z=i.length;X<z;X++)S[G=t[a=i[X]]]==null&&(S[G]=++g),s[a]={old:t[a],new:S[t[a]]},v[a]=S[t[a]];return B.writeUInt16(1),B.writeUInt16(0),B.writeUInt32(12),B.writeUInt16(0),B.writeUInt16(262),B.writeUInt16(0),B.write(v),{charMap:s,subtable:B.data,maxGlyphID:g+1};case"unicode":for(j=[],f=[],_=0,S={},n={},b=u=null,K=0,ne=i.length;K<ne;K++)S[P=t[a=i[K]]]==null&&(S[P]=++_),n[a]={old:P,new:S[P]},o=S[P]-a,b!=null&&o===u||(b&&f.push(b),j.push(a),u=o),b=a;for(b&&f.push(b),f.push(65535),j.push(65535),q=2*(T=j.length),k=2*Math.pow(Math.log(T)/Math.LN2,2),m=Math.log(k/2)/Math.LN2,I=2*T-k,c=[],N=[],h=[],p=ee=0,le=j.length;ee<le;p=++ee){if(F=j[p],d=f[p],F===65535){c.push(0),N.push(0);break}if(F-(U=n[F].new)>=32768)for(c.push(0),N.push(2*(h.length+T-p)),a=Y=F;F<=d?Y<=d:Y>=d;a=F<=d?++Y:--Y)h.push(n[a].new);else c.push(U-F),N.push(0)}for(B.writeUInt16(3),B.writeUInt16(1),B.writeUInt32(12),B.writeUInt16(4),B.writeUInt16(16+8*T+2*h.length),B.writeUInt16(0),B.writeUInt16(q),B.writeUInt16(k),B.writeUInt16(m),B.writeUInt16(I),H=0,A=f.length;H<A;H++)a=f[H],B.writeUInt16(a);for(B.writeUInt16(0),J=0,D=j.length;J<D;J++)a=j[J],B.writeUInt16(a);for(Q=0,L=c.length;Q<L;Q++)o=c[Q],B.writeUInt16(o);for(de=0,M=N.length;de<M;de++)E=N[de],B.writeUInt16(E);for(V=0,R=h.length;V<R;V++)g=h[V],B.writeUInt16(g);return{charMap:n,subtable:B.data,maxGlyphID:_+1}}},e})(),H8=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)n=new JA(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,s;return n==null&&(n="macroman"),a=JA.encode(r,n),(s=new rl).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},t})(),Tue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t})(),Pue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a})(),this.charRange=(function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t})(),Oue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var i;for(a=r.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)n=r.readByte(),s.push(this.names.push(r.readString(n)));return s;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,c,u;for(u=[],i=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;i=0<=c?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t})(),Fue=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Iue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,s,i,o,c,u,d,f,m,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),a=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},i=f=0,m=a.length;f<m;i=++f)s=a[i],r.pos=s.offset,d=r.readString(s.length),o=new Fue(d,s),u[h=s.nameID]==null&&(u[h]=[]),u[s.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),Lue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t})(),Due=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,s,i,o,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,f;for(f=[],n=d=0;0<=s?d<s:d>s;n=0<=s?++d:--d)f.push(r.readInt16());return f})(),this.widths=(function(){var d,f,m,h;for(h=[],d=0,f=(m=this.metrics).length;d<f;d++)i=m[d],h.push(i.advance);return h}).call(this),a=this.widths[this.widths.length-1],u=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)u.push(this.widths.push(a));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t})(),q8=[].slice,Mue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,s,i,o,c,u,d,f,m;return r in this.cache?this.cache[r]:(i=this.file.loca,n=this.file.contents,a=i.indexOf(r),(s=i.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(c=new rl(n.read(s))).readShort(),d=c.readShort(),m=c.readShort(),u=c.readShort(),f=c.readShort(),this.cache[r]=o===-1?new Bue(c,d,m,u,f):new Rue(c,o,d,m,u,f),this.cache[r]))},t.prototype.encode=function(r,n,a){var s,i,o,c,u;for(o=[],i=[],c=0,u=n.length;c<u;c++)s=r[n[c]],i.push(o.length),s&&(o=o.concat(s.encode(a)));return i.push(o.length),{table:o,offsets:i}},t})(),Rue=(function(){function e(t,r,n,a,s,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),Bue=(function(){function e(t,r,n,a,s){var i,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new rl(q8.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e})(),Uue=(function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ti(t,ii),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=2)i.push(2*r.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=4)i.push(r.readUInt32());return i}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<a.length;++o)if(a[o]=s,i<n.length&&n[i]==o){++i,a[o]=s;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(s+=u)}for(var d=new Array(4*a.length),f=0;f<a.length;++f)d[4*f+3]=255&a[f],d[4*f+2]=(65280&a[f])>>8,d[4*f+1]=(16711680&a[f])>>16,d[4*f]=(4278190080&a[f])>>24;return d},t})(),zue=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,s,i,o,c;for(a={},i=0,o=t.length;i<o;i++)a[s=t[i]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},e.prototype.encode=function(t,r){var n,a,s,i,o,c,u,d,f,m,h,p,g,v,b;for(a in n=H8.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),h={0:0},b=n.charMap)h[(c=b[a]).old]=c.new;for(p in m=n.maxGlyphID,i)p in h||(h[p]=m++);return d=(function(S){var _,E;for(_ in E={},S)E[S[_]]=_;return E})(h),f=Object.keys(d).sort((function(S,_){return S-_})),g=(function(){var S,_,E;for(E=[],S=0,_=f.length;S<_;S++)o=f[S],E.push(d[o]);return E})(),s=this.font.glyf.encode(i,g,h),u=this.font.loca.encode(s.offsets,g),v={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},e})();Ft.API.PDFObject=(function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,s,i;if(Array.isArray(r))return"["+(function(){var o,c,u;for(u=[],o=0,c=r.length;o<c;o++)n=r[o],u.push(t.convert(n));return u})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)i=r[a],s.push("/"+a+" "+t.convert(i));return s.push(">>"),s.join(`
`)}return""+r},t})();function G8(e,t,r,n,a){n=n||{};var s=1.15,i=a.internal.scaleFactor,o=a.internal.getFontSize()/i,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=o*c,d=/\r\n|\r|\n/g,f="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(d):e,m=f.length||1),r+=o*(2-s),n.valign==="middle"?r-=m/2*u:n.valign==="bottom"&&(r-=m*u),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),f&&m>=1){for(var p=0;p<f.length;p++)a.text(f[p],t-a.getStringUnitWidth(f[p])*h,r),r+=u;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var ZA={},ou=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:ZA=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,s;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,c=i.fontName;if(t.font&&(c=t.font),t.fontStyle){o=t.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),o=u[0])}if(this.jsPDFDocument.setFont(c,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var d=e.unifyColor(t.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=e.unifyColor(t.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=e.unifyColor(t.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,s){return this.jsPDFDocument.rect(t,r,n,a,s)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return ZA||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),Ry=function(e,t){return Ry=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Ry(e,t)};function V8(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ry(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Y8=(function(e){V8(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t})(Array);function $ue(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Wue(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function Xm(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,i){return Math.max(s,i)},0);return a}function K8(e,t,r,n){var a=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:s});var i=X8(a,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function X8(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function ag(e,t){var r,n,a,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(s=e.bottom)!==null&&s!==void 0?s:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function J8(e,t){var r=ag(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Hue(e,t,r,n,a){var s={},i=1.3333333333333333,o=Q1(t,function(_){return a.getComputedStyle(_).backgroundColor});o!=null&&(s.fillColor=o);var c=Q1(t,function(_){return a.getComputedStyle(_).color});c!=null&&(s.textColor=c);var u=Gue(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=i*r,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var h=(parseFloat(m)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var p=Q1(t,function(_){return a.getComputedStyle(_)[d]});p!=null&&(s.lineColor=p);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var v=parseInt(n.fontSize||"");isNaN(v)||(s.fontSize=v/i);var b=que(n);b&&(s.fontStyle=b);var S=(n.fontFamily||"").toLowerCase();return e.indexOf(S)!==-1&&(s.font=S),s}function que(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Q1(e,t){var r=Z8(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Z8(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:Z8(e.parentElement,t):r}function Gue(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(o){return parseInt(o||"0")/n}),i=ag(s,0);return a>i.top&&(i.top=a),a>i.bottom&&(i.bottom=a),i}function Q8(e,t,r,n,a){var s,i;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var c=Object.keys(e.getFontList()),u=e.scaleFactor(),d=[],f=[],m=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:d,body:f,foot:m};for(var h=0;h<o.rows.length;h++){var p=o.rows[h],g=(i=(s=p==null?void 0:p.parentElement)===null||s===void 0?void 0:s.tagName)===null||i===void 0?void 0:i.toLowerCase(),v=Vue(c,u,r,p,n,a);v&&(g==="thead"?d.push(v):g==="tfoot"?m.push(v):f.push(v))}return{head:d,body:f,foot:m}}function Vue(e,t,r,n,a,s){for(var i=new Y8(n),o=0;o<n.cells.length;o++){var c=n.cells[o],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=Hue(e,c,t,u,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:Yue(c)})}}var f=r.getComputedStyle(n);if(i.length>0&&(a||f.display!=="none"))return i}function Yue(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Kue(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Yi(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(s[c]=o[c])}return s}function eO(e,t){var r=new ou(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();Kue(a,n,t);var s=Yi({},a,n,t),i;typeof window<"u"&&(i=window);var o=Xue(a,n,t),c=Jue(a,n,t),u=Zue(r,s),d=ede(r,s,i);return{id:t.tableId,content:d,hooks:c,styles:o,settings:u}}function Xue(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=e[c],d=t[c],f=r[c];n.columnStyles=Yi({},u,d,f)}else{var m=[e,t,r],h=m.map(function(p){return p[c]||{}});n[c]=Yi({},h[0],h[1],h[2])}},s=0,i=Object.keys(n);s<i.length;s++){var o=i[s];a(o)}return n}function Jue(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,i=n;s<i.length;s++){var o=i[s];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function Zue(e,t){var r,n,a,s,i,o,c,u,d,f,m,h,p=ag(t.margin,40/e.scaleFactor()),g=(r=Que(e,t.startY))!==null&&r!==void 0?r:p.top,v;t.showFoot===!0?v="everyPage":t.showFoot===!1?v="never":v=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var b;t.showHead===!0?b="everyPage":t.showHead===!1?b="never":b=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var S=(s=t.useCss)!==null&&s!==void 0?s:!1,_=t.theme||(S?"plain":"striped"),E=!!t.horizontalPageBreak,P=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:S,theme:_,startY:g,margin:p,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=t.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=t.tableWidth)!==null&&d!==void 0?d:"auto",showHead:b,showFoot:v,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(m=t.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:E,horizontalPageBreakRepeat:P,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function Que(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),s=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;s=i===a}return typeof t=="number"?t:(t==null||t===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function ede(e,t,r){var n=t.head||[],a=t.body||[],s=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var o=Q8(e,t.html,r,i,t.useCss)||{};n=o.head||n,a=o.body||n,s=o.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||tde(n,a,s);return{columns:c,head:n,body:a,foot:s}}function tde(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var i=1,o;Array.isArray(n)?o=n[parseInt(s)]:o=n[s],typeof o=="object"&&!Array.isArray(o)&&(i=(o==null?void 0:o.colSpan)||1);for(var c=0;c<i;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var By=(function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),rde=(function(e){V8(t,e);function t(r,n,a,s,i,o){var c=e.call(this,r,n,o)||this;return c.cell=a,c.row=s,c.column=i,c.section=s.section,c}return t})(By),nde=(function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,s,i){for(var o=0,c=r;o<c.length;o++){var u=c[o],d=new rde(t,this,n,a,s,i),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new By(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new By(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),tO=(function(){function e(t,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=t,t instanceof Y8&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,s){var i=n.cells[s.index];if(!i)return 0;var o=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),u=c+o;return u>a?u:a},0)},e})(),rO=(function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var s=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,s=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=s!=null?""+s:"",o=/\r\n|\r|\n/g;this.text=i.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=ag(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e})(),ade=(function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var s=a[n],i=s.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e})();function sde(e,t){ide(e,t);var r=[],n=0;t.columns.forEach(function(s){var i=s.getMaxCustomCellWidth(t);i?s.width=i:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=Uy(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=Uy(r,a,function(s){return s.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.log("Of the table content, ".concat(a," units width could not fit page"))),lde(t),cde(t,e),ode(t)}function ide(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=J8(e,t);t.allRows().forEach(function(s){for(var i=0,o=t.columns;i<o.length;i++){var c=o[i],u=s.cells[c.index];if(u){var d=t.hooks.didParseCell;t.callCellHooks(e,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=Xm(u.text,u.styles,e)+f;var m=Xm(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,e);if(u.minReadableWidth=m+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(s){for(var i=0,o=t.columns;i<o.length;i++){var c=o[i],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Uy(e,t,r){for(var n=t,a=e.reduce(function(h,p){return h+p.wrappedWidth},0),s=0;s<e.length;s++){var i=e[s],o=i.wrappedWidth/a,c=n*o,u=i.width+c,d=r(i),f=u<d?d:u;t-=f-i.width,i.width=f}if(t=Math.round(t*1e10)/1e10,t){var m=e.filter(function(h){return t<0?h.width>r(h):!0});m.length&&(t=Uy(m,t,r))}return t}function ode(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var s=n[a],i=0,o=e.columns;i<o.length;i++){var c=o[i],u=t[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete t[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,m=d.rowSpan>f?f:d.rowSpan;t[c.index]={cell:d,left:m,row:s}}}}}function lde(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,s=0,i=0,o=0;o<e.columns.length;o++){var c=e.columns[o];if(i-=1,i>1&&e.columns[o+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(i=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function cde(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var s=a[n],i=0,o=e.columns;i<o.length;i++){var c=o[i],u=s.cells[c.index];if(u){t.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=t.splitTextToSize(u.text,d+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=QA(u.text,d,u.styles,t,"...");else if(u.styles.overflow==="hidden")u.text=QA(u.text,d,u.styles,t,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var m=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<m*u.rowSpan?r={height:m,count:u.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>s.height&&(s.height=m)}}r.count--}}function QA(e,t,r,n,a){return e.map(function(s){return ude(s,t,r,n,a)})}function ude(e,t,r,n,a){var s=1e4*n.scaleFactor();if(t=Math.ceil(t*s)/s,t>=Xm(e,r,n))return e;for(;t<Xm(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function nO(e,t){var r=new ou(e),n=dde(t,r.scaleFactor()),a=new nde(t,n);return sde(r,a),r.applyStyles(r.userStyles),a}function dde(e,t){var r=e.content,n=hde(r.columns);if(r.head.length===0){var a=ej(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=ej(n,"foot");a&&r.foot.push(a)}var s=e.settings.theme,i=e.styles;return{columns:n,head:ev("head",r.head,n,i,s,t),body:ev("body",r.body,n,i,s,t),foot:ev("foot",r.foot,n,i,s,t)}}function ev(e,t,r,n,a,s){var i={},o=t.map(function(c,u){for(var d=0,f={},m=0,h=0,p=0,g=r;p<g.length;p++){var v=g[p];if(i[v.index]==null||i[v.index].left===0)if(h===0){var b=void 0;Array.isArray(c)?b=c[v.index-m-d]:b=c[v.dataKey];var S={};typeof b=="object"&&!Array.isArray(b)&&(S=(b==null?void 0:b.styles)||{});var _=mde(e,v,u,a,n,s,S),E=new rO(b,_,e);f[v.dataKey]=E,f[v.index]=E,h=E.colSpan-1,i[v.index]={left:E.rowSpan-1,times:h}}else h--,m++;else i[v.index].left--,h=i[v.index].times,d++}return new tO(c,u,e,f)});return o}function ej(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=fde(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function fde(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function hde(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new ade(a,t,r)})}function mde(e,t,r,n,a,s,i){var o=Wue(n),c;e==="head"?c=a.headStyles:e==="body"?c=a.bodyStyles:e==="foot"&&(c=a.footStyles);var u=Yi({},o.table,o[e],a.styles,c),d=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f=e==="body"?d:{},m=e==="body"&&r%2===0?Yi({},o.alternateRow,a.alternateRowStyles):{},h=$ue(s),p=Yi({},h,u,m,f);return Yi(p,i)}function pde(e,t,r){var n;r===void 0&&(r={});var a=J8(e,t),s=new Map,i=[],o=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var h=t.columns.find(function(p){return p.dataKey===m||p.index===m});h&&!s.has(h.index)&&(s.set(h.index,!0),i.push(h.index),o.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<t.columns.length;){if(s.has(d)){d++;continue}var f=t.columns[d].wrappedWidth;if(u||a>=f)u=!1,i.push(d),o.push(t.columns[d]),a-=f;else break;d++}return{colIndexes:i,columns:o,lastIndex:d-1}}function gde(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=pde(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function aO(e,t){var r=t.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+i;if(r.pageBreak==="avoid"){var c=t.body,u=c.reduce(function(m,h){return m+h.height},0);o+=u}var d=new ou(e);(r.pageBreak==="always"||r.startY!=null&&o>d.pageSize().height)&&(iO(d),s.y=a.top),t.callWillDrawPageHooks(d,s);var f=Yi({},s);t.startPageNumber=d.pageNumber(),r.horizontalPageBreak?xde(d,t,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(m){return lo(d,t,m,s,t.columns)}),d.applyStyles(d.userStyles),t.body.forEach(function(m,h){var p=h===t.body.length-1;Jm(d,t,m,p,f,s,t.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(m){return lo(d,t,m,s,t.columns)})),K8(d,t,f,s),t.callEndPageHooks(d,s),t.finalY=s.y,e.lastAutoTable=t,d.applyStyles(d.userStyles)}function xde(e,t,r,n){var a=gde(e,t),s=t.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){e.applyStyles(e.userStyles),d>0?Ud(e,t,r,n,u.columns,!0):tj(e,t,n,u.columns),vde(e,t,r,n,u.columns),tv(e,t,n,u.columns)});else for(var i=-1,o=a[0],c=function(){var u=i;if(o){e.applyStyles(e.userStyles);var d=o.columns;i>=0?Ud(e,t,r,n,d,!0):tj(e,t,n,d),u=rj(e,t,i+1,n,d),tv(e,t,n,d)}var f=u-i;a.slice(1).forEach(function(m){e.applyStyles(e.userStyles),Ud(e,t,r,n,m.columns,!0),rj(e,t,i+1,n,m.columns,f),tv(e,t,n,m.columns)}),i=u};i<t.body.length-1;)c()}function tj(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(s){return lo(e,t,s,r,n)})}function vde(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(s,i){var o=i===t.body.length-1;Jm(e,t,s,o,r,n,a)})}function rj(e,t,r,n,a,s){e.applyStyles(e.userStyles),s=s??t.body.length;var i=Math.min(r+s,t.body.length),o=-1;return t.body.slice(r,i).forEach(function(c,u){var d=r+u===t.body.length-1,f=sO(e,t,d,n);c.canEntireRowFit(f,a)&&(lo(e,t,c,n,a),o=r+u)}),o}function tv(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(s){return lo(e,t,s,r,n)})}function yde(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),s=Math.floor((t-a)/n);return Math.max(0,s)}function bde(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var s=0,i=0,o=r.columns;i<o.length;i++){var c=o[i],u=e.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new rO(u.raw,u.styles,u.section);d=Yi(d,u),d.text=[];var f=yde(u,t,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var m=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(m,h),u.contentHeight>=t&&(u.contentHeight=t,d.styles.minCellHeight-=t),u.contentHeight>e.height&&(e.height=u.contentHeight),d.contentHeight=d.getContentHeight(m,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var p=new tO(e.raw,-1,e.section,a,!0);p.height=s;for(var g=0,v=r.columns;g<v.length;g++){var c=v[g],d=p.cells[c.index];d&&(d.height=p.height);var u=e.cells[c.index];u&&(u.height=e.height)}return p}function wde(e,t,r,n){var a=e.pageSize().height,s=n.settings.margin,i=s.top+s.bottom,o=a-i;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),u=c<r;if(c>o)return console.log("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>o;return f?(d&&console.log("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function Jm(e,t,r,n,a,s,i){var o=sO(e,t,n,s);if(r.canEntireRowFit(o,i))lo(e,t,r,s,i);else if(wde(e,r,o,t)){var c=bde(r,o,t,e);lo(e,t,r,s,i),Ud(e,t,a,s,i),Jm(e,t,c,n,a,s,i)}else Ud(e,t,a,s,i),Jm(e,t,r,n,a,s,i)}function lo(e,t,r,n,a){n.x=t.settings.margin.left;for(var s=0,i=a;s<i.length;s++){var o=i[s],c=r.cells[o.index];if(!c){n.x+=o.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=t.callCellHooks(e,t.hooks.willDrawCell,c,r,o,n);if(u===!1){n.x+=o.width;continue}Sde(e,c,n);var d=c.getTextPos();G8(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,o,n),n.x+=o.width}n.y+=r.height}function Sde(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=X8(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),_de(e,t,r,n.lineWidth))}function _de(e,t,r,n){var a,s,i,o;n.top&&(a=r.x,s=r.y,i=r.x+t.width,o=r.y,n.right&&(i+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,i,o)),n.bottom&&(a=r.x,s=r.y+t.height,i=r.x+t.width,o=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,i,o)),n.left&&(a=r.x,s=r.y,i=r.x,o=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.left,a,s,i,o)),n.right&&(a=r.x+t.width,s=r.y,i=r.x+t.width,o=r.y+t.height,n.top&&(s-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.right,a,s,i,o));function c(u,d,f,m,h){e.getDocument().setLineWidth(u),e.getDocument().line(d,f,m,h,"S")}}function sO(e,t,r,n){var a=t.settings.margin.bottom,s=t.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function Ud(e,t,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!s&&t.foot.forEach(function(o){return lo(e,t,o,n,a)}),t.callEndPageHooks(e,n);var i=t.settings.margin;K8(e,t,r,n),iO(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return lo(e,t,o,n,a)}),e.applyStyles(e.userStyles))}function iO(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Nde(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=eO(this,n),s=nO(this,a);return aO(this,s),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){G8(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return ou.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){ou.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new ou(this),s=Q8(a,t,window,r,!1),i=s.head,o=s.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:o,data:o}}}var rv;function oO(e,t){var r=eO(e,t),n=nO(e,r);aO(e,n)}try{if(typeof window<"u"&&window){var nj=window,aj=nj.jsPDF||((rv=nj.jspdf)===null||rv===void 0?void 0:rv.jsPDF);aj&&Nde(aj)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Fn=({label:e,value:t,color:r="blue"})=>{const n={blue:"bg-blue-50 text-blue-800 border-blue-200",green:"bg-green-50 text-green-800 border-green-200",red:"bg-red-50 text-red-800 border-red-200",purple:"bg-purple-50 text-purple-800 border-purple-200",orange:"bg-orange-50 text-orange-800 border-orange-200"},a=n[r]||n.blue;return l.jsxs("div",{className:`p-4 rounded-lg border ${a} shadow-sm`,children:[l.jsx("p",{className:"text-xs opacity-80 uppercase tracking-wide font-semibold",children:e}),l.jsx("p",{className:"text-xl font-bold mt-1",children:typeof t=="number"?`₹${t.toLocaleString("en-IN")}`:t})]})},Iu=({children:e})=>l.jsx("div",{className:"bg-white p-4 rounded shadow-sm border border-gray-200 mb-6",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:e})}),Lu=e=>{const[t,r]=y.useState(["All"]);return y.useEffect(()=>{if(!e||e==="All"){r(["All"]);return}(async()=>{try{const s=(await ke.get(`/sections?class=${e}`)).data.sections||[];r(["All",...s])}catch(a){console.error("Failed to fetch sections",a),r(["All"])}})()},[e]),t},Zf=(e,t)=>e?e.filter(r=>{var n;return!(t.class&&t.class!=="All"&&r.class!==t.class||t.section&&t.section!=="All"&&r.section!==t.section||t.feeType&&t.feeType!=="All"&&!((n=r.fee_type_str)!=null&&n.includes(t.feeType))||t.mode&&t.mode!=="All"&&r.mode!==t.mode||t.collector&&t.collector!=="All"&&r.collected_by!==t.collector)}):[],Qf=e=>{const t=e.reduce((s,i)=>s+Number(i.amount_paid||i.amount||0),0),r={},n={};e.forEach(s=>{const i=Number(s.amount_paid||s.amount||0),o=s.mode||"Unknown";r[o]=(r[o]||0)+i;const c=s.collected_by||"Unknown";n[c]||(n[c]={count:0,amount:0,branch:s.branch||"-"}),n[c].count+=1,n[c].amount+=i});const a=Object.entries(n).map(([s,i])=>({user:s,...i}));return{total:t,modeMap:r,collectedBySummary:a}},e0=({modeSummary:e,collectedBySummary:t,totalCollection:r})=>l.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mt-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Payment Mode Summary"}),l.jsxs("table",{className:"w-full border text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Payment Mode"}),l.jsx("th",{className:"px-4 py-2 text-right font-semibold",children:"Amount"})]})}),l.jsxs("tbody",{className:"divide-y",children:[Object.entries(e||{}).map(([n,a])=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:n}),l.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:["₹",Number(a).toLocaleString()]})]},n)),l.jsxs("tr",{className:"bg-blue-50 font-bold",children:[l.jsx("td",{className:"px-4 py-2",children:"Total"}),l.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",r.toLocaleString()]})]})]})]})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Collected By Summary"}),l.jsxs("table",{className:"w-full border text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Collected By"}),l.jsx("th",{className:"px-4 py-2 text-left font-semibold",children:"Branch"}),l.jsx("th",{className:"px-4 py-2 text-center font-semibold",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right font-semibold",children:"Amount"})]})}),l.jsxs("tbody",{className:"divide-y",children:[Array.isArray(t)&&t.map((n,a)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:n.user}),l.jsx("td",{className:"px-4 py-2",children:n.branch}),l.jsx("td",{className:"px-4 py-2 text-center",children:n.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:["₹",Number(n.amount).toLocaleString()]})]},a)),l.jsxs("tr",{className:"bg-blue-50 font-bold",children:[l.jsx("td",{colSpan:3,className:"px-4 py-2 text-right",children:"Total"}),l.jsxs("td",{className:"px-4 py-2 text-right",children:["₹",r.toLocaleString()]})]})]})]})]})]}),t0=({receipts:e,onViewReceipt:t,showAllColumns:r=!0})=>!e||e.length===0?l.jsx("div",{className:"bg-red-50 text-red-500 text-center py-8 border rounded mt-4 font-medium",children:"No Records Found"}):l.jsx("div",{className:"bg-white border rounded shadow-sm overflow-x-auto mt-4",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"S.No"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Student Name"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Adm No."}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Class"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Branch"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Rcpt No"}),r&&l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Fee Type"}),r&&l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Tot.Amt"}),r&&l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Concession"}),r&&l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Pay Amt"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Paid"}),l.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Due"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Mode"}),r&&l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Note"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Date/Time"}),l.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Taken By"}),l.jsx("th",{className:"px-3 py-2 text-center font-semibold",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((n,a)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-gray-500 font-medium",children:a+1}),l.jsx("td",{className:"px-3 py-2 font-medium",children:n.student_name}),l.jsx("td",{className:"px-3 py-2 text-blue-600",children:n.admission_no}),l.jsxs("td",{className:"px-3 py-2",children:[n.class," ",n.section]}),l.jsx("td",{className:"px-3 py-2 text-gray-600",children:n.branch}),l.jsx("td",{className:"px-3 py-2",children:n.receipt_no}),r&&l.jsx("td",{className:"px-3 py-2 max-w-[200px] truncate",title:n.fee_type_str,children:n.fee_type_str||"-"}),r&&l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",(n.gross_amount||0).toLocaleString()]}),r&&l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",(n.concession||0).toLocaleString()]}),r&&l.jsxs("td",{className:"px-3 py-2 text-right",children:["₹",(n.net_payable||0).toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right font-bold text-gray-800",children:["₹",(n.amount_paid||n.amount||0).toLocaleString()]}),l.jsxs("td",{className:"px-3 py-2 text-right text-red-500",children:["₹",(n.due_amount||0).toLocaleString()]}),l.jsx("td",{className:"px-3 py-2",children:n.mode}),r&&l.jsx("td",{className:"px-3 py-2 text-xs truncate max-w-[150px]",title:n.note,children:n.note||"-"}),l.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",children:[n.date," ",l.jsx("br",{})," ",n.time]}),l.jsx("td",{className:"px-3 py-2",children:n.collected_by}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("button",{onClick:()=>t(n.receipt_no),className:"text-white bg-violet-600 hover:bg-violet-700 px-3 py-1 rounded text-xs",children:"View"})})]},a))})]})}),r0=(e,t)=>{if(!(e!=null&&e.length))return;const r=e.map((o,c)=>({"S.No":c+1,Student:o.student_name,AdmissionNo:o.admission_no,Class:`${o.class} ${o.section||""}`,Branch:o.branch,ReceiptNo:o.receipt_no,FeeType:o.fee_type_str,TotalAmount:o.gross_amount||o.amount,Concession:o.concession||0,Payable:o.net_payable||o.amount,Paid:o.amount_paid||o.amount,Due:o.due_amount||0,Mode:o.mode,Note:o.note,Date:o.date,Time:o.time,TakenBy:o.collected_by})),n=rn.json_to_sheet(r),a=rn.book_new();rn.book_append_sheet(a,n,"Report");const s=Cf(a,{bookType:"xlsx",type:"array"}),i=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Iw.saveAs(i,`${t}.xlsx`)},n0=(e,t,r)=>{if(!(e!=null&&e.length))return;const n=new Ft("l","mm","a4");n.text(t,14,15);const a=["Student","Adm No","Class","Branch","Receipt","Fee Type","Paid","Due","Mode","Date","Taken By"],s=e.map(i=>[i.student_name,i.admission_no,`${i.class} ${i.section||""}`,i.branch,i.receipt_no,i.fee_type_str||"-",i.amount_paid||i.amount,i.due_amount||0,i.mode,`${i.date} ${i.time}`,i.collected_by]);oO(n,{head:[a],body:s,startY:20,styles:{fontSize:8}}),n.save(`${r}.pdf`)},Ade=({onViewReceipt:e})=>{const[t,r]=y.useState(null),[n,a]=y.useState(!0),[s,i]=y.useState(""),[o,c]=y.useState([]),[u,d]=y.useState([]),[f,m]=y.useState("All"),[h,p]=y.useState("All"),[g,v]=y.useState("All"),[b,S]=y.useState("All"),[_,E]=y.useState("All"),[P,N]=y.useState([]),I=Lu(f),k=["All","Cash","UPI","Card","Bank Transfer","Cheque"];y.useEffect(()=>{(async()=>{try{const X=(await ke.get("/classes")).data.classes||[];c(["All",...X.map(Y=>Y.class_name)]);const K=await ke.get("/fee-types"),ee=Array.isArray(K.data)?K.data:K.data.fee_types||[];d(ee);try{const Y=await ke.get("/users"),z=Y.data.users||Y.data||[];N(["All",...z.map(ne=>ne.name||ne.username)])}catch{N(["All"])}T()}catch(B){console.error("Failed to load initial data",B)}})()},[]);const T=async()=>{var U,B;try{a(!0);const X=new URLSearchParams({class:"All",fee_type:"All",section:"All",mode:"All",collected_by:"All"}),K=await ke.get(`/reports/fees/today?${X.toString()}`);r(K.data)}catch(X){i(((B=(U=X.response)==null?void 0:U.data)==null?void 0:B.error)||"Failed to fetch report")}finally{a(!1)}},q=()=>{T()},F=y.useMemo(()=>t!=null&&t.receipts?Zf(t.receipts,{class:f,section:h,feeType:g,mode:b,collector:_}):[],[t,f,h,g,b,_]),j=y.useMemo(()=>Qf(F),[F]);return n?l.jsx("div",{className:"p-4",children:"Loading today's collection..."}):s?l.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",s]}):l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:g,onChange:U=>v(U.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"All",children:"All Fee Types"}),u.map(U=>l.jsx("option",{value:U.fee_type,children:U.fee_type},U.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:f,onChange:U=>m(U.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:o.map(U=>l.jsx("option",{value:U,children:U==="All"?"All Classes":U},U))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:h,onChange:U=>p(U.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:I.map(U=>l.jsx("option",{value:U,children:U==="All"?"All Sections":U},U))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),l.jsx("select",{value:b,onChange:U=>S(U.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:k.map(U=>l.jsx("option",{value:U,children:U==="All"?"All Modes":U},U))})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:q,className:"bg-indigo-700 text-white px-4 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"REFRESH DATA"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:()=>r0(F,"Today_Collection"),className:"bg-green-600 text-white px-4 py-2 rounded text-sm font-medium hover:bg-green-700 flex items-center gap-2",children:"Download Excel"}),l.jsx("button",{onClick:()=>n0(F,"Today's Collection Report","Today_Collection"),className:"bg-red-600 text-white px-4 py-2 rounded text-sm font-medium hover:bg-red-700 flex items-center gap-2",children:"Download PDF"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx(Fn,{label:"Total Collection",value:j.total,color:"green"}),Object.entries(j.modeMap||{}).map(([U,B])=>l.jsx(Fn,{label:U,value:Number(B),color:"blue"},U))]}),l.jsx(t0,{receipts:F,onViewReceipt:e}),l.jsx(e0,{modeSummary:j.modeMap||{},collectedBySummary:j.collectedBySummary||[],totalCollection:j.total})]})},jde=({onViewReceipt:e})=>{const[t,r]=y.useState(new Date().toISOString().split("T")[0]),[n,a]=y.useState(new Date().toISOString().split("T")[0]),[s,i]=y.useState(null),[o,c]=y.useState(!1),[u,d]=y.useState(""),[f,m]=y.useState([]),[h,p]=y.useState([]),[g,v]=y.useState("All"),[b,S]=y.useState("All"),[_,E]=y.useState("All"),[P,N]=y.useState("All"),[I,k]=y.useState("All"),[T,q]=y.useState([]),F=Lu(g),j=["All","Cash","UPI","Card","Bank Transfer","Cheque"];y.useEffect(()=>{(async()=>{try{const Y=await ke.get("/fee-types"),z=Array.isArray(Y.data)?Y.data:Y.data.fee_types||[],ne=localStorage.getItem("currentBranch")||"All";let le=z;ne!=="All"&&ne!=="All Branches"&&(le=z.filter(L=>!L.branch||L.branch==="All"||L.branch===ne)),p(le);const D=(await ke.get("/classes")).data.classes||[];m(["All",...D.map(L=>L.class_name)]);try{const L=await ke.get("/users"),M=L.data.users||L.data||[];q(["All",...M.map(R=>R.name||R.username)])}catch{q(["All"])}U()}catch(Y){console.error("Failed to load initial data",Y)}})()},[]);const U=async()=>{var ne,le;const ee=new Date(t),Y=new Date(n);if(Math.ceil(Math.abs(Y.getTime()-ee.getTime())/(1e3*60*60*24))>365){alert("Date range cannot exceed 1 year.");return}try{c(!0),d("");const A=new URLSearchParams({start_date:t,end_date:n,class:"All",section:"All",fee_type:"All",mode:"All",collected_by:"All"}),D=await ke.get(`/reports/fees/daily?${A.toString()}`);i(D.data)}catch(A){d(((le=(ne=A.response)==null?void 0:ne.data)==null?void 0:le.error)||"Failed to fetch report"),i(null)}finally{c(!1)}},B=()=>{U()},X=y.useMemo(()=>s!=null&&s.receipts?Zf(s.receipts,{class:g,section:b,feeType:_,mode:P,collector:I}):[],[s,g,b,_,P,I]),K=y.useMemo(()=>Qf(X),[X]);return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{className:"col-span-1 md:col-span-2 grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),l.jsx("input",{type:"date",value:t,onChange:ee=>r(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),l.jsx("input",{type:"date",value:n,onChange:ee=>a(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:_,onChange:ee=>E(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"All",children:"All Fee Types"}),h.map(ee=>l.jsx("option",{value:ee.fee_type,children:ee.fee_type},ee.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:g,onChange:ee=>v(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:f.map(ee=>l.jsx("option",{value:ee,children:ee==="All"?"All Classes":ee},ee))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:b,onChange:ee=>S(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:F.map(ee=>l.jsx("option",{value:ee,children:ee==="All"?"All Sections":ee},ee))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),l.jsx("select",{value:P,onChange:ee=>N(ee.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:j.map(ee=>l.jsx("option",{value:ee,children:ee==="All"?"All Modes":ee},ee))})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:B,className:"bg-indigo-700 text-white px-6 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search Report"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:()=>r0(X,"Daily_Fee_Report"),className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600",children:"📊 Excel"}),l.jsx("button",{onClick:()=>n0(X,"Daily Fee Report","Daily_Fee_Report"),className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600",children:"📄 PDF"})]}),o&&l.jsx("div",{className:"text-center py-4",children:"Loading report..."}),u&&l.jsx("div",{className:"text-center text-red-500 py-4",children:u}),s&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[l.jsx(Fn,{label:"Total Collection",value:K.total,color:"green"}),Object.entries(K.modeMap||{}).map(([ee,Y])=>l.jsx(Fn,{label:ee,value:Number(Y),color:"blue"},ee))]}),l.jsx(t0,{receipts:X,onViewReceipt:e}),l.jsx(e0,{modeSummary:K.modeMap||{},collectedBySummary:K.collectedBySummary||[],totalCollection:K.total})]})]})},kde=({onViewReceipt:e})=>{const[t,r]=y.useState(String(new Date().getMonth()+1)),[n,a]=y.useState(String(new Date().getFullYear())),[s,i]=y.useState(null),[o,c]=y.useState(!1),[u,d]=y.useState(""),[f,m]=y.useState("All"),[h,p]=y.useState("All"),[g,v]=y.useState("All"),[b,S]=y.useState("All"),[_,E]=y.useState("All"),[P,N]=y.useState([]),[I,k]=y.useState([]),[T,q]=y.useState([]),F=Lu(f),j=["All","Cash","UPI","Card","Bank Transfer","Cheque"],U=localStorage.getItem("academicYear")||"",[B,X]=U.split("-"),K=B&&X?[B,X]:[String(new Date().getFullYear())];y.useEffect(()=>{(async()=>{try{const D=await ke.get("/fee-types"),L=Array.isArray(D.data)?D.data:D.data.fee_types||[];N(L);const R=(await ke.get("/classes")).data.classes||[];k(["All",...R.map(H=>H.class_name)]);try{const H=await ke.get("/users"),J=H.data.users||H.data||[];q(["All",...J.map(G=>G.name||G.username)])}catch{q(["All"])}ee()}catch(D){console.error("Failed to load initial data",D)}})()},[]);const ee=async()=>{var A,D;try{c(!0),d("");const L=new URLSearchParams({month:t,year:n,class:"All",section:"All",fee_type:"All",mode:"All",collected_by:"All"}),M=await ke.get(`/reports/fees/monthly?${L.toString()}`);i(M.data)}catch(L){d(((D=(A=L.response)==null?void 0:A.data)==null?void 0:D.error)||"Failed to fetch report")}finally{c(!1)}},Y=()=>{ee()},z=new Date(0,Number(t)-1).toLocaleString("default",{month:"long"}),ne=y.useMemo(()=>s!=null&&s.receipts?Zf(s.receipts,{class:f,section:h,feeType:g,mode:b,collector:_}):[],[s,f,h,g,b,_]),le=y.useMemo(()=>Qf(ne),[ne]);return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{className:"col-span-1 md:col-span-2 grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),l.jsx("select",{value:t,onChange:A=>r(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:Array.from({length:12},(A,D)=>D+1).map(A=>l.jsx("option",{value:A,children:new Date(0,A-1).toLocaleString("default",{month:"long"})},A))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),l.jsx("select",{value:n,onChange:A=>a(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:K.map(A=>l.jsx("option",{value:A,children:A},A))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:g,onChange:A=>v(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"All",children:"All Fee Types"}),P.map(A=>l.jsx("option",{value:A.fee_type,children:A.fee_type},A.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:f,onChange:A=>m(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:I.map(A=>l.jsx("option",{value:A,children:A==="All"?"All Classes":A},A))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:h,onChange:A=>p(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:F.map(A=>l.jsx("option",{value:A,children:A==="All"?"All Sections":A},A))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),l.jsx("select",{value:b,onChange:A=>S(A.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:j.map(A=>l.jsx("option",{value:A,children:A==="All"?"All Modes":A},A))})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:Y,className:"bg-indigo-700 text-white px-6 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search Report"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:()=>r0(ne,`Monthly_Report_${z}_${n}`),className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600",children:"📊 Excel"}),l.jsx("button",{onClick:()=>n0(ne,`Monthly Report - ${z} ${n}`,`Monthly_Report_${z}_${n}`),className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600",children:"📄 PDF"})]}),o&&l.jsx("div",{className:"text-center py-4",children:"Loading report..."}),u&&l.jsx("div",{className:"text-center text-red-500 py-4",children:u}),s&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[l.jsx(Fn,{label:"Total Collection",value:le.total,color:"green"}),Object.entries(le.modeMap||{}).map(([A,D])=>l.jsx(Fn,{label:A,value:Number(D),color:"blue"},A))]}),l.jsx(t0,{receipts:ne,onViewReceipt:e}),l.jsx(e0,{modeSummary:le.modeMap||{},collectedBySummary:le.collectedBySummary||[],totalCollection:le.total})]})]})},Cde=({onViewReceipt:e})=>{const[t,r]=y.useState([]),[n,a]=y.useState(""),[s,i]=y.useState("All"),[o,c]=y.useState("All"),[u,d]=y.useState("All"),[f,m]=y.useState("All"),[h,p]=y.useState(""),[g,v]=y.useState(""),[b,S]=y.useState([]),[_,E]=y.useState([]),[P,N]=y.useState(null),[I,k]=y.useState(!1),[T,q]=y.useState(""),F=Lu(n),j=["All","Cash","UPI","Card","Bank Transfer","Cheque"];y.useEffect(()=>{(async()=>{try{const z=((await ke.get("/classes")).data.classes||[]).map(A=>A.class_name);r(z),z.length>0&&a(z[0]);const ne=await ke.get("/fee-types"),le=Array.isArray(ne.data)?ne.data:ne.data.fee_types||[];S(le);try{const A=await ke.get("/users"),D=A.data.users||A.data||[];E(["All",...D.map(L=>L.name||L.username)])}catch{E(["All"])}}catch(ee){console.error("Failed to load initial data",ee)}})()},[]);const U=async()=>{var K,ee;if(n)try{k(!0),q("");const Y=new URLSearchParams({class:n,section:"All",fee_type:"All",mode:"All",collected_by:"All",...h&&{start_date:h},...g&&{end_date:g}}),z=await ke.get(`/reports/fees/class-wise?${Y.toString()}`);N(z.data)}catch(Y){q(((ee=(K=Y.response)==null?void 0:K.data)==null?void 0:ee.error)||"Error fetching report"),N(null)}finally{k(!1)}},B=y.useMemo(()=>P!=null&&P.receipts?Zf(P.receipts,{class:n,section:s,feeType:o,mode:u,collector:f}):[],[P,n,s,o,u,f]),X=y.useMemo(()=>Qf(B),[B]);return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:n,onChange:K=>a(K.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:t.map(K=>l.jsx("option",{value:K,children:K},K))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:s,onChange:K=>i(K.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:F.map(K=>l.jsx("option",{value:K,children:K==="All"?"All Sections":K},K))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Type"}),l.jsxs("select",{value:o,onChange:K=>c(K.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"All",children:"All Fee Types"}),b.map(K=>l.jsx("option",{value:K.fee_type,children:K.fee_type},K.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),l.jsx("select",{value:u,onChange:K=>d(K.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:j.map(K=>l.jsx("option",{value:K,children:K==="All"?"All Modes":K},K))})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:U,className:"bg-indigo-700 text-white px-6 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search Report"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:()=>r0(B,`ClassWise_Report_${n}`),className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600",children:"📊 Excel"}),l.jsx("button",{onClick:()=>n0(B,`Class ${n} Fee Report`,`ClassWise_Report_${n}`),className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600",children:"📄 PDF"})]}),I&&l.jsx("div",{className:"text-center py-4",children:"Loading..."}),T&&l.jsx("div",{className:"text-red-500 text-center py-4",children:T}),P&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx(Fn,{label:"Total Demand",value:P.total_fee,color:"blue"}),l.jsx(Fn,{label:"Collected (Filtered)",value:X.total,color:"green"}),l.jsx(Fn,{label:"Due Amount",value:P.due,color:"red"}),l.jsx(Fn,{label:"Collection %",value:`${P.total_fee?(X.total/P.total_fee*100).toFixed(1):0}%`,color:"purple"})]}),l.jsx(t0,{receipts:B,onViewReceipt:e}),l.jsx(e0,{modeSummary:X.modeMap||{},collectedBySummary:X.collectedBySummary||[],totalCollection:X.total})]})]})},Ede=({onViewReceipt:e})=>{const[t,r]=y.useState(""),[n,a]=y.useState([]),[s,i]=y.useState("All"),[o,c]=y.useState("All"),[u,d]=y.useState("All"),[f,m]=y.useState("All"),[h,p]=y.useState([]),[g,v]=y.useState([]),[b,S]=y.useState(null),[_,E]=y.useState(!1),[P,N]=y.useState(""),I=Lu(s),k=["All","Cash","UPI","Card","Bank Transfer","Cheque"];y.useEffect(()=>{(async()=>{try{const B=(await ke.get("/installment-schedule")).data.installments||[],X=Array.from(new Set(B.map(Y=>Y.title)));a(X.map((Y,z)=>({id:z,fee_type:Y}))),X.length>0&&r(X[0]);const ee=(await ke.get("/classes")).data.classes||[];p(["All",...ee.map(Y=>Y.class_name)]);try{const Y=await ke.get("/users"),z=Y.data.users||Y.data||[];v(["All",...z.map(ne=>ne.name||ne.username)])}catch{v(["All"])}}catch(U){console.error("Failed to load initial data",U)}})()},[]);const T=async()=>{var j,U;if(t)try{E(!0),N("");const B=new URLSearchParams({installment:t,class:"All",section:"All",mode:"All",collected_by:"All"}),X=await ke.get(`/reports/fees/installment-wise?${B.toString()}`);S(X.data)}catch(B){N(((U=(j=B.response)==null?void 0:j.data)==null?void 0:U.error)||"Error fetching report"),S(null)}finally{E(!1)}},q=y.useMemo(()=>b!=null&&b.receipts?Zf(b.receipts,{class:s,section:o,feeType:"All",mode:u,collector:f}):[],[b,s,o,u,f]),F=y.useMemo(()=>Qf(q),[q]);return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Head"}),l.jsxs("select",{value:t,onChange:j=>r(j.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:[l.jsx("option",{value:"",children:"Select Fee Type"}),n.map(j=>l.jsx("option",{value:j.fee_type,children:j.fee_type},j.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:s,onChange:j=>i(j.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:h.map(j=>l.jsx("option",{value:j,children:j==="All"?"All Classes":j},j))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:o,onChange:j=>c(j.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:I.map(j=>l.jsx("option",{value:j,children:j==="All"?"All Sections":j},j))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Mode"}),l.jsx("select",{value:u,onChange:j=>d(j.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:k.map(j=>l.jsx("option",{value:j,children:j==="All"?"All Modes":j},j))})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:T,className:"bg-indigo-700 text-white px-6 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search Report"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:()=>r0(q,`Installment_Report_${t}`),className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600",children:"📊 Excel"}),l.jsx("button",{onClick:()=>n0(q,`${t} - Fee Report`,`Installment_Report_${t}`),className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600",children:"📄 PDF"})]}),_&&l.jsx("div",{className:"text-center py-4",children:"Loading..."}),P&&l.jsx("div",{className:"text-red-500 text-center py-4",children:P}),b&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[l.jsx(Fn,{label:"Total Demand",value:b.total_demand,color:"blue"}),l.jsx(Fn,{label:"Collected (Filtered)",value:F.total,color:"green"}),l.jsx(Fn,{label:"Due Amount",value:b.due,color:"red"}),l.jsx(Fn,{label:"Paid Students",value:`${b.paid_students} / ${b.total_students}`,color:"purple"}),l.jsx(Fn,{label:"Collection %",value:`${b.total_demand?(F.total/b.total_demand*100).toFixed(1):0}%`,color:"orange"})]}),l.jsx(t0,{receipts:q,onViewReceipt:e}),l.jsx(e0,{modeSummary:F.modeMap||{},collectedBySummary:F.collectedBySummary||[],totalCollection:F.total})]})]})},Tde=()=>{const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,s]=y.useState(!1),[i,o]=y.useState(""),[c,u]=y.useState([]),[d,f]=y.useState("All"),[m,h]=y.useState("All"),[p,g]=y.useState(""),[v,b]=y.useState(""),S=Lu(d);y.useEffect(()=>{(async()=>{try{const q=(await ke.get("/classes")).data.classes||[];u(["All",...q.map(F=>F.class_name)])}catch(T){console.error("Failed to load classes",T)}})(),_()},[]);const _=async()=>{var k,T;try{s(!0),o("");const q=new URLSearchParams({class:d==="All"?"":d,section:m==="All"?"":m,...p&&{min_due:p}}),F=new URLSearchParams;d!=="All"&&F.append("class",d),m!=="All"&&F.append("section",m),p&&F.append("min_due",p);const j=await ke.get(`/reports/fees/due?${F.toString()}`);t(j.data),n(j.data)}catch(q){o(((T=(k=q.response)==null?void 0:k.data)==null?void 0:T.error)||"Error fetching report")}finally{s(!1)}};y.useEffect(()=>{if(!e)return;let k=e;if(d!=="All"&&(k=k.filter(T=>T.class===d)),m!=="All"&&(k=k.filter(T=>T.section===m)),v){const T=v.toLowerCase();k=k.filter(q=>{var F,j,U,B;return(((F=q.name)==null?void 0:F.toLowerCase())||"").includes(T)||(((j=q.admission_no)==null?void 0:j.toLowerCase())||"").includes(T)||(((U=q.adm_no)==null?void 0:U.toLowerCase())||"").includes(T)||((B=q.father_mobile)==null?void 0:B.includes(T))})}n(k)},[v,e,d,m]);const E=r.reduce((k,T)=>k+(T.due_amount||0),0),P=r.reduce((k,T)=>k+(T.total_fee||0),0),N=()=>{if(!r.length)return;const k=r.map(U=>({StudentName:U.name,AdmissionNo:U.admission_no||U.adm_no||U.admissionNo||"-",Class:`${U.class} ${U.section||""}`,FatherName:U.father_name||U.father||U.parent_name||"-",FatherMobile:U.father_mobile,TotalFee:U.total_fee,PaidAmount:U.paid_amount||U.total_fee-U.due_amount,DueAmount:U.due_amount})),T=rn.json_to_sheet(k),q=rn.book_new();rn.book_append_sheet(q,T,"Due Report");const F=Cf(q,{bookType:"xlsx",type:"array"}),j=new Blob([F],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Iw.saveAs(j,"Due_Report.xlsx")},I=()=>{if(!r.length)return;const k=new Ft("l","mm","a4");k.text("Due Fee Report",14,15);const T=["Student","Adm No","Class","Father Name","Mobile","Total Fee","Paid","Due"],q=r.map(F=>[F.name,F.admission_no||F.adm_no||F.admissionNo||"-",`${F.class} ${F.section||""}`,F.father_name||F.father||F.parent_name||"-",F.father_mobile,F.total_fee,F.paid_amount||F.total_fee-F.due_amount,F.due_amount]);oO(k,{head:[T],body:q,startY:20,styles:{fontSize:8}}),k.save("Due_Report.pdf")};return l.jsxs("div",{className:"space-y-4 font-sans",children:[l.jsxs(Iu,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("select",{value:d,onChange:k=>f(k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:c.map(k=>l.jsx("option",{value:k,children:k==="All"?"All Classes":k},k))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),l.jsx("select",{value:m,onChange:k=>h(k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2",children:S.map(k=>l.jsx("option",{value:k,children:k==="All"?"All Sections":k},k))})]}),l.jsxs("div",{className:"col-span-1 md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Student"}),l.jsx("input",{type:"text",placeholder:"Name, admission no, mobile...",value:v,onChange:k=>b(k.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx("button",{onClick:_,className:"bg-indigo-700 text-white px-6 py-2 rounded text-sm font-medium hover:bg-indigo-800 flex items-center gap-2",children:"🔍 Search Report"}),l.jsx("div",{className:"flex-grow"}),l.jsx("button",{onClick:N,className:"bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600",children:"📊 Excel"}),l.jsx("button",{onClick:I,className:"bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600",children:"📄 PDF"})]}),a&&l.jsx("div",{className:"text-center py-4",children:"Loading..."}),i&&l.jsx("div",{className:"text-red-500 text-center py-4",children:i}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx(Fn,{label:"Total Students with Dues",value:r.length,color:"blue"}),l.jsx(Fn,{label:"Total Fee Demand",value:P,color:"purple"}),l.jsx(Fn,{label:"Total Due Amount",value:E,color:"red"}),l.jsx(Fn,{label:"Avg Due per Student",value:r.length?Math.round(E/r.length):0,color:"orange"})]}),l.jsx("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"S.No"}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Student Name"}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Adm No."}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Class"}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Father Name"}),l.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Mobile"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Total Fee"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Paid"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Due Amount"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:r.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:9,className:"bg-green-50 text-green-600 text-center py-8 font-medium",children:"🎉 No students with pending dues!"})}):r.map((k,T)=>{var q,F,j;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-gray-500",children:T+1}),l.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:k.name}),l.jsx("td",{className:"px-4 py-3 text-blue-600",children:k.admission_no||k.adm_no||k.admissionNo||"-"}),l.jsxs("td",{className:"px-4 py-3",children:[k.class," ",k.section]}),l.jsx("td",{className:"px-4 py-3 text-gray-600",children:k.father_name||k.father||k.parent_name||"-"}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("a",{href:`tel:${k.father_mobile}`,className:"text-blue-600 hover:underline",children:k.father_mobile})}),l.jsxs("td",{className:"px-4 py-3 text-right",children:["₹",(q=k.total_fee)==null?void 0:q.toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-4 py-3 text-right text-green-600",children:["₹",(F=k.paid_amount||k.total_fee-k.due_amount)==null?void 0:F.toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-4 py-3 text-right font-bold text-red-600",children:["₹",(j=k.due_amount)==null?void 0:j.toLocaleString("en-IN")]})]},k.student_id||T)})}),r.length>0&&l.jsx("tfoot",{className:"bg-gray-100 font-bold",children:l.jsxs("tr",{children:[l.jsx("td",{colSpan:6,className:"px-4 py-3 text-right",children:"Total:"}),l.jsxs("td",{className:"px-4 py-3 text-right",children:["₹",P.toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-4 py-3 text-right text-green-600",children:["₹",(P-E).toLocaleString("en-IN")]}),l.jsxs("td",{className:"px-4 py-3 text-right text-red-600",children:["₹",E.toLocaleString("en-IN")]})]})})]})}),r.length>0&&l.jsxs("div",{className:"bg-white p-4 rounded-lg border mt-4",children:[l.jsx("h4",{className:"font-semibold mb-3 text-gray-700",children:"Class-wise Due Summary"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:Object.entries(r.reduce((k,T)=>{const q=`${T.class} ${T.section||""}`;return k[q]=(k[q]||0)+(T.due_amount||0),k},{})).map(([k,T])=>l.jsxs("div",{className:"bg-red-50 p-3 rounded border border-red-100",children:[l.jsx("p",{className:"text-xs text-gray-500",children:k}),l.jsxs("p",{className:"font-bold text-red-600",children:["₹",Number(T).toLocaleString("en-IN")]})]},k))})]})]})},Pde=()=>{const[e,t]=y.useState("today"),[r,n]=y.useState(null),[a,s]=y.useState(!1),[i,o]=y.useState(""),c=async d=>{var f,m;try{s(!0),o("");const p=(await ke.get(`/reports/fees/receipt/${d}`)).data.items||[];if(p.length===0){alert("No items found in this receipt.");return}const g=p[0].student_id;let v=[];try{const k=p[0].branch||"All",T=k==="All Branches"||k==="All"?"All":k;v=(await ke.get(`/fees/student-details/${g}?branch=${T}`)).data.installments||[]}catch(k){console.error("Failed to fetch student installments for grouping:",k)}const b=p.map(k=>{const T=v.find(q=>q.title===k.installment||q.title===`${k.installment} Fee`);return{...k,sr:T?T.sr:0}}),S=Ode(b),_=p.reduce((k,T)=>k+parseFloat(T.amount_paid),0),E=p.reduce((k,T)=>k+parseFloat(T.concession_amount),0),P=p.reduce((k,T)=>k+parseFloat(T.gross_amount||0),0)||_+E,N=p.reduce((k,T)=>k+parseFloat(T.due_amount||0),0),I={studentName:p[0].name,fatherName:p[0].fatherName,fatherPhone:p[0].fatherPhone,admissionNo:p[0].admNo,branch:p[0].branch,className:p[0].class,receiptNo:d,paymentDate:p[0].payment_date,paymentMode:p[0].mode,paymentNote:"",items:S.map((k,T)=>({title:k.title,payable:k.payable})),amount:P,concession:E,payable:P-E,paid:_,due:N};n(I)}catch(h){console.error(h),alert(((m=(f=h.response)==null?void 0:f.data)==null?void 0:m.error)||"Failed to load receipt")}finally{s(!1)}},u=[{id:"today",label:"Today's Collection"},{id:"daily",label:"Daily Report"},{id:"monthly",label:"Monthly Report"},{id:"class",label:"Class Wise"},{id:"installment",label:"Installment Wise"},{id:"due",label:"Due Report"}];return l.jsxs("div",{className:"container mx-auto p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[l.jsx("span",{className:"bg-violet-100 text-violet-600 p-2 rounded mr-3",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),"Fee Reports"]}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-8 border-b border-gray-200 pb-1",children:u.map(d=>l.jsx("button",{onClick:()=>t(d.id),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${e===d.id?"bg-violet-600 text-white shadow-md":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:d.label},d.id))}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm min-h-[400px]",children:[e==="today"&&l.jsx(Ade,{onViewReceipt:c}),e==="daily"&&l.jsx(jde,{onViewReceipt:c}),e==="monthly"&&l.jsx(kde,{onViewReceipt:c}),e==="class"&&l.jsx(Cde,{onViewReceipt:c}),e==="installment"&&l.jsx(Ede,{onViewReceipt:c}),e==="due"&&l.jsx(Tde,{})]}),a&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex justify-center items-center z-50",children:l.jsx("div",{className:"bg-white p-4 rounded shadow",children:"Loading Receipt..."})}),r&&l.jsx(mj,{receiptData:r,onClose:()=>n(null)})]})},Ode=e=>{const t=e.filter(s=>s.installment&&s.installment!=="One-Time"&&s.installment!=="None"),r=e.filter(s=>!s.installment||s.installment==="One-Time"||s.installment==="None"),n=[],a={};return t.forEach(s=>{const i=s.fee_type||"Tuition Fee";a[i]||(a[i]=[]),a[i].push(s)}),Object.keys(a).forEach(s=>{const i=a[s].sort((c,u)=>(c.sr||0)-(u.sr||0));if(i.length===0)return;let o=[i[0]];for(let c=1;c<i.length;c++){const u=o[o.length-1],d=i[c],f=u.sr||0,m=d.sr||0;f>0&&m>0&&m===f+1?o.push(d):(n.push(sj(s,o)),o=[d])}o.length>0&&n.push(sj(s,o))}),r.forEach(s=>{n.push({title:s.fee_type==="General"?"One-Time Fee":s.fee_type,amount:parseFloat(s.amount_paid),payable:parseFloat(s.gross_amount||s.amount_paid),originalItems:[s]})}),n},sj=(e,t)=>{const r=t[0].installment.replace(" Fee",""),n=t[t.length-1].installment.replace(" Fee","");let a=`${e} - ${r} Fee`;t.length>1&&(a=`Payment for ${r} Fee to ${n} Fee`);const s=t.reduce((o,c)=>o+parseFloat(c.amount_paid),0),i=t.reduce((o,c)=>o+parseFloat(c.gross_amount||c.amount_paid),0);return{title:a,amount:s,payable:i,originalItems:t}},Fde=e=>{const t=()=>{const o=window.location.hash.replace("#","");return o||null},[r,n]=y.useState(()=>t()||e);y.useEffect(()=>{const o=()=>{const c=t();n(c||e)};return t()||(window.location.hash=e),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[e]);const a=y.useCallback(o=>{o!==r&&(window.location.hash=o)},[r]),s=y.useCallback(()=>{window.history.back()},[]),i=y.useCallback(()=>{window.history.forward()},[]);return{currentPage:r,navigateTo:a,goBack:s,goForward:i,canGoBack:!0,canGoForward:!0}},Ide=({onLogout:e})=>{const[t,r]=y.useState(!0),{currentPage:n,navigateTo:a,goBack:s,goForward:i,canGoBack:o,canGoForward:c}=Fde("dashboard"),u=()=>{r(!t)};return l.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-100",children:[l.jsx(dF,{isOpen:t,toggleSidebar:u,navigateTo:a,currentPage:n}),l.jsxs("div",{className:"flex flex-col flex-1 overflow-y-auto overflow-x-hidden",children:[l.jsx(cF,{toggleSidebar:u,navigateTo:a,onLogout:e,goBack:s,goForward:i,canGoBack:o,canGoForward:c}),l.jsxs("main",{className:"flex-1",children:[n==="dashboard"&&l.jsx(vF,{navigateTo:a}),n==="profile"&&l.jsx(yF,{}),n==="fee"&&l.jsx(bF,{navigateTo:a}),n==="fee-type"&&l.jsx(wF,{}),n==="class-fee-structure"&&l.jsx(SF,{}),n==="assign-special-fee"&&l.jsx(_F,{}),n==="fee-installments"&&l.jsx(NF,{}),n==="take-fee"&&l.jsx(EF,{navigateTo:a}),n==="administration"&&l.jsx(TF,{navigateTo:a}),n==="academic"&&l.jsx(PF,{navigateTo:a}),n==="academics"&&l.jsx(Nce,{}),n==="setup"&&l.jsx(pj,{pageTitle:"Setup Your School"}),n==="student-attendance"&&l.jsx(EA,{navigateTo:a}),n==="attendance-report"&&l.jsx(EA,{navigateTo:a,defaultTab:"absent-report"}),n==="student-administration"&&l.jsx(Dce,{navigateTo:a}),n==="concession-master"&&l.jsx(Mce,{}),n==="student-concession"&&l.jsx(Rce,{}),n==="update-student-fee-structure"&&l.jsx(Bce,{}),n==="fee-reports"&&l.jsx(Pde,{})]})]})]})},Lde=()=>{const[e,t]=y.useState(()=>!!localStorage.getItem("token")),r=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(!1)};return l.jsx(l.Fragment,{children:e?l.jsx(Ide,{onLogout:r}):l.jsx(tF,{onLoginSuccess:()=>t(!0)})})};QO.createRoot(document.getElementById("root")).render(l.jsx(hF,{children:l.jsx(Lde,{})}));export{yr as _};
